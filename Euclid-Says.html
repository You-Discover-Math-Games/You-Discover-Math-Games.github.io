<html>
    <head>
        <title>Euclid Says - You Discover Math</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="icon" type="image/x-icon" href="Favicon.png">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.min.js"></script>
    </head>
    <body style="margin: 0 0; background-color: #c4e6f5;">
        <center>
            <br>
            <h1>Euclid Says</h1>
            <br>
            <!-- Button trigger modal -->            
            <!-- Modal -->
            <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel"></h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    </div>
                    <div class="modal-body" id="exampleModalBody">
                    </div>
                    <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </div>
                </div>
            </div>
            <br>
            <p style="margin: 0% 10%; font-size: 20px;" id="Prompt">If possible draw a (plane) geometric figure and label two angles A and B...</p>
            <ul style="display: none;">
                <li></li>
                <li></li>
                <li></li>
            </ul>
            <br>
            <iframe style="border: 2px black solid;" id="canvas" src="./Desmos.html" width="50%" height="50%"></iframe><br>
            <br>
            <p id="problemNum"></p><br>
            <div style="display: flex; justify-content: center; align-items: center;">
                <div style="margin-right: 5px;">
                    <span>Difficulty: </span>
                    <button class="roll btn btn-success" onclick="roll1()">Easy!</button>
                    <button class="roll btn btn-warning" onclick="roll2()">Medium!</button>
                    <button class="roll btn btn-danger" onclick="roll3()">Hard!</button>
                </div>
                <div style="margin-left: 5px;">
                    <svg data-toggle="modal" data-target="#exampleModal" style="cursor: pointer;" onclick="modalText(0)" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path d="M13 7.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm-3 3.75a.75.75 0 0 1 .75-.75h1.5a.75.75 0 0 1 .75.75v4.25h.75a.75.75 0 0 1 0 1.5h-3a.75.75 0 0 1 0-1.5h.75V12h-.75a.75.75 0 0 1-.75-.75Z"></path><path d="M12 1c6.075 0 11 4.925 11 11s-4.925 11-11 11S1 18.075 1 12 5.925 1 12 1ZM2.5 12a9.5 9.5 0 0 0 9.5 9.5 9.5 9.5 0 0 0 9.5-9.5A9.5 9.5 0 0 0 12 2.5 9.5 9.5 0 0 0 2.5 12Z"></path></svg>
                </div>
            </div>
            <br>
            <div style="display: flex; justify-content: center; align-items: center;">
                <div style="margin-right: 5px;">
                    <input id="cb" type="checkbox" onclick="impossible()">
                    <label onclick="impossible()" style="margin: 0 0;">Impossible</label>
                </div>
                <div style="margin-left: 5px;">
                    <svg data-toggle="modal" data-target="#exampleModal" style="cursor: pointer;" onclick="modalText(1)" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path d="M13 7.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm-3 3.75a.75.75 0 0 1 .75-.75h1.5a.75.75 0 0 1 .75.75v4.25h.75a.75.75 0 0 1 0 1.5h-3a.75.75 0 0 1 0-1.5h.75V12h-.75a.75.75 0 0 1-.75-.75Z"></path><path d="M12 1c6.075 0 11 4.925 11 11s-4.925 11-11 11S1 18.075 1 12 5.925 1 12 1ZM2.5 12a9.5 9.5 0 0 0 9.5 9.5 9.5 9.5 0 0 0 9.5-9.5A9.5 9.5 0 0 0 12 2.5 9.5 9.5 0 0 0 2.5 12Z"></path></svg>
                </div>
            </div><br>
            <p>Enter your reasoning:</p>
            <textarea id="text" style="width: 25%; height: 10%; font-size: 15px;"></textarea><br>
            <br>
            <button onclick="submit()" id="sub" style="filter: brightness(75%);" class="btn btn-info" disabled>Submit!</button>
            <p id="response"></p>
            <button onclick="save()" id="save" style="filter: brightness(75%);" class="btn btn-info" disabled>Save!</button><br><br>
            <br>
            <div style="display: flex; justify-content: center; align-items: center;">
                <div style="margin-right: 5px;">
                    <span>Enter Problem ID (1 - 2148): </span><input id="assign" type="number" min="1" max="2148"><br><br><button id="assignBtn"  class="btn btn-primary" onclick="assign()">Try it!</button>
                </div>
                <div style="margin-left: 5px;">
                    <svg data-toggle="modal" data-target="#exampleModal" style="cursor: pointer;" onclick="modalText(2)" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path d="M13 7.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm-3 3.75a.75.75 0 0 1 .75-.75h1.5a.75.75 0 0 1 .75.75v4.25h.75a.75.75 0 0 1 0 1.5h-3a.75.75 0 0 1 0-1.5h.75V12h-.75a.75.75 0 0 1-.75-.75Z"></path><path d="M12 1c6.075 0 11 4.925 11 11s-4.925 11-11 11S1 18.075 1 12 5.925 1 12 1ZM2.5 12a9.5 9.5 0 0 0 9.5 9.5 9.5 9.5 0 0 0 9.5-9.5A9.5 9.5 0 0 0 12 2.5 9.5 9.5 0 0 0 2.5 12Z"></path></svg>
                </div>
            </div>
            <br><br>
            <canvas id="SaveDiagram" style="display: none;" width="750" height="750" style="border: 2px black solid;">
            </canvas>
        </center>
        <script>
            var cv = document.getElementById("SaveDiagram");
            var ctx = cv.getContext('2d');
            var prompt = document.getElementById("Prompt");
            var sub = document.getElementById("sub");
            var response = document.getElementById("response");
            var card1 = ["one of which is acute and the other of which is right, ", "one of which is acute and the other of which is obtuse, ","one of which is right and the other of which is obtuse, ","both of which are acute, ","both of which are right, ","both of which are obtuse, "];
            var card2 = ["angle A and angle B are complementary","angle A and angle B are congruent","angle A and angle B are vertical","angle A and angle B are adjacent","angle A and angle B are not complementary","angle A and angle B are supplementary","angle A and angle B are not supplementary","angle A and angle B are congruent and complementary","angle A and angle B are congruent and supplementary","angle A and angle B are complementary and not congruent","angle A and angle B are supplementary and not congruent","angle A and angle B are vertical and complementary","angle A and angle B are vertical and supplementary","angle A and angle B are adjacent and congruent","angle A and angle B are adjacent and complementary","angle A and angle B are adjacent and supplementary","angle A and angle B are neither vertical nor adjacent"];
            var card3 = ["the figure contains another angle, C, which is congruent to angle A.","the figure contains another angle, C, which is not congruent to angle A.","the figure contains another angle, C, which is congruent to angle B.","the figure contains another angle, C, which is not congruent to angle B.","the figure contains another angle, C, which is supplementary to angle A.","the figure contains another angle, C, which is not supplementary to angle A.","the figure contains another angle, C, which is supplementary to angle B.","the figure contains another angle, C, which is not supplementary to angle B.","the figure contains another angle, C, which is complementary to angle A.","the figure contains another angle, C, which is not complementary to angle A.","the figure contains another angle, C, which is complementary to angle B.","the figure contains another angle, C, which is not complementary to angle B.","the figure contains another angle, C, which is vertical to angle A.","the figure contains another angle, C, which is not vertical to angle A.","the figure contains another angle, C, which is vertical to angle B.","the figure contains another angle, C, which is not vertical to angle B.","the figure contains another angle, C, which is adjacent to angle A.","the figure contains another angle, C, which is not adjacent to angle A.","the figure contains another angle, C, which is adjacent to angle B.","the figure contains another angle, C, which is not adjacent to angle B."];
            var cards = ["", "", ""];
            var dict1 = ["both", "acute", "right", "obtuse"];
            var dict2 = ["and", "complementary", "congruent", "vertical", "adjacent", "supplementary"];
            var checkbox = document.getElementById("cb");
            var number = document.getElementById("assign");
            var assignBtn = document.getElementById("assignBtn");
            var problemID = -1;
            var problemNum = document.getElementById("problemNum");
            var saveBtn = document.getElementById("save");
            var textArea = document.getElementById("text");
            function modalText(index) {
                var title = ["Difficulty Buttons", "\"Impossible\" Checkmark", "Problem ID's and Choosing Problems"];
                var txt = ["This difficulty represents the number of conditions that Euclid gives when you press the button. Easy gives one, medium gives two, and hard gives three.",
                            "Since Euclid's challenges are random, the combination of conditions might result in an impossible task. If this happens click this checkmark to signal that it is impossible",
                            "If you are playing in a group, a friend might recommend a specific problem. If they give you a problem ID, you can ener it here to play the same problem."];
                document.getElementById("exampleModalLabel").innerHTML = title[index];
                document.getElementById("exampleModalBody").innerHTML = txt[index];
            }
            function save() {
                // Select the element that you want to capture
                const captureElement = document.getElementById("canvas").contentDocument.querySelectorAll(".dcg-grapher")[1];
                html2canvas(captureElement).then((canvas) => {
                    // Get the image data as a base64-encoded string
                    
                    ctx.font = "30px Arial";
                    ctx.textAlign = "center";
                    var lines = fragmentText(prompt.innerHTML.replace("<br>", " "), 750 - parseInt(30,0));
                    lines.forEach(function(line, i) {
                        ctx.fillText(line, 750 / 2, (i + 1) * parseInt(30,0));
                    });

                    ctx.font = "24px Arial";
                    var lines = fragmentText(textArea.value, 750 - parseInt(24,0));
                    lines.forEach(function(line, i) {
                        ctx.fillText(line, 750 / 2, (i + 27) * parseInt(24,0));
                    });
                    ctx.fillText("Explanation:", 750 / 2, 26 * parseInt(24,0));

                    if (checkbox.checked) {
                        ctx.font = "40px Arial";
                        ctx.fillText("IMPOSSIBLE", 375, 375);
                    }
                    else {
                        ctx.drawImage(canvas, 375 - canvas.width/2, 375 - canvas.height/2);
                    }
                    ctx.fillStyle = "#fff";
                    ctx.globalCompositeOperation = 'destination-over'
                    ctx.fillRect(0,0,cv.width,cv.height);


                    const imageData = cv.toDataURL("image/png");
                    // Do something with the image data, such as saving it as a file or sending it to a server
                    // For example, you can create an anchor element and trigger a download action
                    const link = document.createElement("a");
                    link.setAttribute("download", "Problem " + (problemID + 1) + " Solution.png");
                    link.setAttribute("href", imageData);
                    link.click();

                    ctx.clearRect(0, 0,cv.width, cv.height);
                    ctx.fillStyle = "#000";
                    ctx.globalCompositeOperation = 'source-over';
                    saveBtn.disabled = true;
                    saveBtn.style.filter = "brightness(75%)";
                });
            }
            function fragmentText(text, maxWidth) {
                var words = text.split(' '),
                    lines = [],
                    line = "";
                if (ctx.measureText(text).width < maxWidth) {
                    return [text];
                }
                while (words.length > 0) {
                    while (ctx.measureText(words[0]).width >= maxWidth) {
                        var tmp = words[0];
                        words[0] = tmp.slice(0, -1);
                        if (words.length > 1) {
                            words[1] = tmp.slice(-1) + words[1];
                        } else {
                            words.push(tmp.slice(-1));
                        }
                    }
                    if (ctx.measureText(line + words[0]).width < maxWidth) {
                        line += words.shift() + " ";
                    } else {
                        lines.push(line);
                        line = "";
                    }
                    if (words.length === 0) {
                        lines.push(line);
                    }
                }
                return lines;
            }
            function assign() {
                if (number.value == "") {
                    problemNum.innerHTML = "Enter a number between 1 - 2148."
                    return;
                }
                if (problemID == parseInt(number.value-1)) {
                    problemNum.innerHTML = "You just did this problem!";
                    return;
                }
                response.innerHTML = ""; 
                problemID = parseInt(number.value - 1);
                if (problemID < card1.length) {
                    var s1 = card1[problemID];
                    cards[0] = s1;
                    prompt.innerHTML = "If possible draw a (plane) geometric figure and label two angles A and B<br>" + s1.substring(0,s1.length-2) + ".";
                }
                else if (problemID < card1.length + (card1.length - 1)*card2.length + card2.length) {
                    var s1 = card1[Math.floor((problemID - card1.length)/card2.length)];
                    var s2 = card2[(problemID - card1.length)%card2.length];
                    cards[0] = s1;
                    cards[1] = s2;
                    if (s2.indexOf("nor") != -1) {
                        cards[1] = s2.substring(0, s2.indexOf("nor")) + "nand" + s2.substring(s2.indexOf("nor")+3);
                    }
                    prompt.innerHTML = "If possible draw a (plane) geometric figure and label two angles A and B<br>" + s1+ "<br>such that " + s2 + ".";
                }
                else {
                    var s1 = card1[Math.floor((problemID - card1.length*card2.length-card1.length)/(card2.length*card3.length))];
                    var s2 = card2[Math.floor((problemID - card1.length*card2.length-card1.length)/card3.length)%card2.length];
                    var s3 = card3[(problemID - card1.length*card2.length-card1.length)%card3.length];
                    cards[0] = s1;
                    cards[1] = s2;
                    if (s2.indexOf("nor") != -1) {
                        cards[1] = s2.substring(0, s2.indexOf("nor")) + "nand" + s2.substring(s2.indexOf("nor")+3);
                    }
                    cards[2] = s3;
                    prompt.innerHTML = "If possible draw a (plane) geometric figure and label two angles A and B<br>" + s1 + "<br>such that " + s2 + "<br>and such that " + s3;
                }
                sub.disabled = false;
                sub.style.filter = "brightness(100%)";
                checkbox.checked = false;
                impossible();
                $(".roll").prop("disabled", true);
                assignBtn.disabled = true;
                problemNum.innerHTML = "Problem ID: " + (problemID + 1);
            }
            function impossible() {
                var iframe = document.getElementById("canvas");
                if (checkbox.checked) {
                    iframe.style.filter = "brightness(50%)";
                    iframe.style.pointerEvents = "none";
                }
                else {
                    iframe.style.filter = "brightness(100%)";
                    iframe.style.pointerEvents = "auto";
                }
            }
            function check(angles, points) {
                var both = false;
                var success1 = "";
                var overall_success = false;
                for (var k = 0; k < dict1.length; k++) {
                    if (cards[0].indexOf(dict1[k]) != -1) {
                        if (k == 0) {
                            both = true;
                        }
                        else if (k == 1) {
                            if (both) {
                                if (parseFloat(angles[points.indexOf("A")]) < 90 && parseFloat(angles[points.indexOf("B")]) < 90) {
                                    success1 = "AB";
                                    break;
                                }
                            } 
                            else {
                                if (success1 == "") {
                                    if (parseFloat(angles[points.indexOf("A")]) < 90) {
                                        success1 = "B";
                                    }
                                    else if (parseFloat(angles[points.indexOf("B")]) < 90) {
                                        success1 = "A";
                                    }
                                }
                                else {
                                    if (parseFloat(angles[points.indexOf(success1)]) < 90) {
                                        success1 = "AB";
                                        break;
                                    }
                                }
                            }
                        }
                        else if (k == 2) {
                            if (both) {
                                if (parseFloat(angles[points.indexOf("A")]) == 90 && parseFloat(angles[points.indexOf("B")]) == 90) {
                                    success1 = "AB";
                                    break;
                                }
                            } 
                            else {
                                if (success1 == "") {
                                    if (parseFloat(angles[points.indexOf("A")]) == 90) {
                                        success1 = "B";
                                    }
                                    else if (parseFloat(angles[points.indexOf("B")]) == 90) {
                                        success1 = "A";
                                    }
                                }
                                else {
                                    if (parseFloat(angles[points.indexOf(success1)]) == 90) {
                                        success1 = "AB";
                                        break;
                                    }
                                }
                            }
                        }
                        else if (k == 3) {
                            if (both) {
                                if (parseFloat(angles[points.indexOf("A")]) > 90 && parseFloat(angles[points.indexOf("B")]) > 90) {
                                    success1 = "AB";
                                    break;
                                }
                            } 
                            else {
                                if (success1 == "") {
                                    if (parseFloat(angles[points.indexOf("A")]) > 90) {
                                        success1 = "B";
                                    }
                                    else if (parseFloat(angles[points.indexOf("B")]) > 90) {
                                        success1 = "A";
                                    }
                                }
                                else {
                                    if (parseFloat(angles[points.indexOf(success1)]) > 90) {
                                        success1 = "AB";
                                        break;
                                    }
                                }
                            }
                        }
                    }
                }
                if (success1 == "AB") {
                    overall_success = true;
                }
                if (cards[1] != "" && overall_success) {
                    overall_success = false;
                    var success2 = true;
                    var and = [];
                    var and_value = -1;
                    var and_condition = true;
                    for (var k = 0; k < dict2.length; k++) {
                        if (cards[1].indexOf(dict2[k], 15) != -1) {
                            if (k == 0) {
                                if (cards[1][cards[1].indexOf("and") - 1] != "n") {
                                    var conditions = [cards[1].substring(24, cards[1].indexOf("and", 15)-1), cards[1].substring(cards[1].indexOf("and", 15) + 4)];
                                    for (var i = 0; i < 2; i++) {
                                        if (conditions[i].indexOf("not") != -1) {
                                            and.push([dict2.indexOf(conditions[i].substring(4)), false]);
                                            continue;
                                        }
                                        and.push([dict2.indexOf(conditions[i]), true]);
                                    }
                                }
                                else {
                                    var conditions = [cards[1].substring(31, cards[1].indexOf("and", 15)-2), cards[1].substring(cards[1].indexOf("and", 15) + 4)];
                                    and.push([dict2.indexOf(conditions[0]), false]);
                                    and.push([dict2.indexOf(conditions[1]), false]);
                                }
                                and_value = 0;
                            }
                            if (k == 1 || (and_value >= 0 && and[and_value][0] == 1)) {
                                if (and_value < 0) {
                                    if (cards[1].indexOf("not " + dict2[k]) != -1) {
                                        success2 = (parseFloat(angles[points.indexOf("A")]) + parseFloat(angles[points.indexOf("A")]) == 90);
                                    }
                                    else {
                                        success2 = (parseFloat(angles[points.indexOf("A")]) + parseFloat(angles[points.indexOf("A")]) == 90);
                                    }
                                    break;
                                }
                                else {
                                    and_condition = and_condition && ((parseFloat(angles[points.indexOf("A")]) + parseFloat(angles[points.indexOf("A")]) == 90) == and[and_value][1]);
                                    and_value += 1;
                                    if (and_value == 2) {
                                        success2 = and_condition;
                                        break;
                                    }
                                }
                            }
                            if (k == 2 || (and_value >= 0 && and[and_value][0] == 2)) {
                                if (and_value < 0) {
                                    if (cards[1].indexOf("not " + dict2[k]) != -1) {
                                        success2 = (parseFloat(angles[points.indexOf("A")]) != parseFloat(angles[points.indexOf("A")]));
                                    }
                                    else {
                                        success2 = (parseFloat(angles[points.indexOf("A")]) == parseFloat(angles[points.indexOf("A")]));
                                    }
                                    break;
                                }
                                else {
                                    and_condition = and_condition && ((parseFloat(angles[points.indexOf("A")]) == parseFloat(angles[points.indexOf("A")])) == and[and_value][1]);
                                    and_value += 1;
                                    if (and_value == 2) {
                                        success2 = and_condition;
                                        break;
                                    }
                                }
                            }
                            if (k == 4 || (and_value >= 0 && and[and_value][0] == 4)) {
                                if (and_value < 0) {
                                    if (cards[1].indexOf("not " + dict2[k]) != -1) {
                                        success2 = (Math.abs(points.indexOf("A") - points.indexOf("B")) != 1 && Math.abs(points.indexOf("A") - points.indexOf("B")) != points.length - 1) ;
                                    }
                                    else {
                                        success2 = (Math.abs(points.indexOf("A") - points.indexOf("B")) == 1 || Math.abs(points.indexOf("A") - points.indexOf("B")) == points.length - 1) ;
                                    }
                                    break;
                                }
                                else {
                                    and_condition = and_condition && ((Math.abs(points.indexOf("A") - points.indexOf("B")) == 1 || Math.abs(points.indexOf("A") - points.indexOf("B")) == points.length - 1) == and[and_value][1]);
                                    and_value += 1;
                                    if (and_value == 2) {
                                        success2 = and_condition;
                                        break;
                                    }
                                }
                            }
                            if (k == 5 || (and_value >= 0 && and[and_value][0] == 5)) {
                                if (and_value < 0) {
                                    if (cards[1].indexOf("not " + dict2[k]) != -1) {
                                        success2 = (parseFloat(angles[points.indexOf("A")]) + parseFloat(angles[points.indexOf("A")]) != 180);
                                    }
                                    else {
                                        success2 = (parseFloat(angles[points.indexOf("A")]) + parseFloat(angles[points.indexOf("A")]) == 180);
                                    }
                                    break;
                                }
                                else {
                                    and_condition = and_condition && ((parseFloat(angles[points.indexOf("A")]) + parseFloat(angles[points.indexOf("A")]) == 180) == and[and_value][1]);
                                    and_value += 1;
                                    if (and_value == 2) {
                                        success2 = and_condition;
                                        break;
                                    }
                                }
                            }
                        }
                    }
                    if (success2) {
                        overall_success = true;
                    }
                    if (cards[2] != "" && overall_success) {
                        overall_success = false;
                        var success3 = "";
                    }
                }
                return overall_success;
            }
            function roll1() {
                response.innerHTML = "";
                var s1 = card1[Math.floor(Math.random()*card1.length)];
                problemID = card1.indexOf(s1);
                cards[0] = s1;
                prompt.innerHTML = "If possible draw a (plane) geometric figure and label two angles A and B<br>" + s1.substring(0,s1.length-2) + ".";
                sub.disabled = false;
                sub.style.filter = "brightness(100%)";
                checkbox.checked = false;
                impossible();
                $(".roll").prop("disabled", true);
                problemNum.innerHTML = "Problem ID: " + (problemID + 1);
                assignBtn.disabled = true;
                saveBtn.disabled = true;
                saveBtn.style.filter = "brightness(75%)";
            }
            function roll2() {
                response.innerHTML = "";
                var s1 = card1[Math.floor(Math.random()*card1.length)];
                var s2 = card2[Math.floor(Math.random()*card2.length)];
                cards[0] = s1;
                cards[1] = s2;
                problemID = card1.length + card1.indexOf(s1)*card2.length + card2.indexOf(s2);
                if (s2.indexOf("nor") != -1) {
                    cards[1] = s2.substring(0, s2.indexOf("nor")) + "nand" + s2.substring(s2.indexOf("nor")+3);
                }
                prompt.innerHTML = "If possible draw a (plane) geometric figure and label two angles A and B<br>" + s1+ "<br>such that " + s2 + ".";
                sub.disabled = false;
                sub.style.filter = "brightness(100%)";
                checkbox.checked = false;
                impossible();
                $(".roll").prop("disabled", true);
                problemNum.innerHTML = "Problem ID: " + (problemID + 1);
                assignBtn.disabled = true;
                saveBtn.disabled = true;
                saveBtn.style.filter = "brightness(75%)";
            }
            function roll3() {
                response.innerHTML = "";
                var s1 = card1[Math.floor(Math.random()*card1.length)];
                var s2 = card2[Math.floor(Math.random()*card2.length)];
                var s3 = card3[Math.floor(Math.random()*card3.length)];
                cards[0] = s1;
                cards[1] = s2;
                problemID = card1.length + card1.length*card2.length + card1.indexOf(s1)*card2.length*card3.length + card2.indexOf(s2)*card3.length + card3.indexOf(s3);
                if (s2.indexOf("nor") != -1) {
                    cards[1] = s2.substring(0, s2.indexOf("nor")) + "nand" + s2.substring(s2.indexOf("nor")+3);
                }
                cards[2] = s3;
                prompt.innerHTML = "If possible draw a (plane) geometric figure and label two angles A and B<br>" + s1 + "<br>such that " + s2 + "<br>and such that " + s3;
                sub.disabled = false;
                sub.style.filter = "brightness(100%)";
                checkbox.checked = false;
                impossible();
                $(".roll").prop("disabled", true);
                problemNum.innerHTML = "Problem ID: " + (problemID + 1);
                assignBtn.disabled = true;
                saveBtn.disabled = true;
                saveBtn.style.filter = "brightness(75%)";
            }
            function submit() {
                var canvas = document.getElementById("canvas").contentDocument;
                var text = canvas.querySelectorAll(".dcg-label-raw-text");
                var labels = []
                for (var i = 0; i < text.length; i++) {
                    labels.push(text[i].innerHTML);
                }
                var points = [];
                var angles = [];
                for (var j = 0; j < labels.length; j++) {
                    if (labels[j].indexOf("Â°") == -1) {
                        points.push(labels[j]);
                        continue;
                    }
                    angles.push(labels[j])
                }
                
                if (check(angles, points)) {
                    response.innerHTML = "Great job!";
                }
                else {
                    response.innerHTML = "Oops! That's not correct. Try another one!";
                }
                cards = ["", "", ""];
                $(".roll").prop("disabled", false);
                assignBtn.disabled = false;
                saveBtn.disabled = false;
                saveBtn.style.filter = "brightness(100%)";
                sub.disabled = true;
                sub.style.filter = "brightness(75%)";
            }
        </script>
    </body>
</html>