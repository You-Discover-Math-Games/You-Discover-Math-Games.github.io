(() => {
  const __dcg_shared_module_source__ = "// shared.js\n  (() => {\n    const __dcg_chunk_exports__ = {};var ZR=Object.create;var Xp=Object.defineProperty,WR=Object.defineProperties,jR=Object.getOwnPropertyDescriptor,JR=Object.getOwnPropertyDescriptors,QR=Object.getOwnPropertyNames,Yp=Object.getOwnPropertySymbols,KR=Object.getPrototypeOf,tg=Object.prototype.hasOwnProperty,WI=Object.prototype.propertyIsEnumerable;var ZI=(e,t,r)=>t in e?Xp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,W=(e,t)=>{for(var r in t||(t={}))tg.call(t,r)&&ZI(e,r,t[r]);if(Yp)for(var r of Yp(t))WI.call(t,r)&&ZI(e,r,t[r]);return e},ee=(e,t)=>WR(e,JR(t));var SG=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,r)=>(typeof require!=\"undefined\"?require:t)[r]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw Error('Dynamic require of \"'+e+'\" is not supported')});var jI=(e,t)=>{var r={};for(var n in e)tg.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&Yp)for(var n of Yp(e))t.indexOf(n)<0&&WI.call(e,n)&&(r[n]=e[n]);return r};var RG=(e,t)=>()=>(e&&(t=e(e=0)),t);var NG=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ds=(e,t)=>{for(var r in t)Xp(e,r,{get:t[r],enumerable:!0})},eN=(e,t,r,n)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let i of QR(t))!tg.call(e,i)&&i!==r&&Xp(e,i,{get:()=>t[i],enumerable:!(n=jR(t,i))||n.enumerable});return e};var AG=(e,t,r)=>(r=e!=null?ZR(KR(e)):{},eN(t||!e||!e.__esModule?Xp(r,\"default\",{value:e,enumerable:!0}):r,e));var CG=(()=>{for(var e=new Uint8Array(128),t=0;t<64;t++)e[t<26?t+65:t<52?t+71:t<62?t-4:t*4-205]=t;return r=>{for(var n=r.length,i=new Uint8Array((n-(r[n-1]==\"=\")-(r[n-2]==\"=\"))*3/4|0),s=0,o=0;s<n;){var a=e[r.charCodeAt(s++)],u=e[r.charCodeAt(s++)],c=e[r.charCodeAt(s++)],l=e[r.charCodeAt(s++)];i[o++]=a<<2|u>>4,i[o++]=u<<4|c>>2,i[o++]=c<<6|l}return i}})();var JI=function(){{var e=function(){},t=[\"log\",\"info\",\"warn\",\"error\",\"assert\",\"dir\",\"clear\",\"profile\",\"profileEnd\",\"time\",\"timeEnd\",\"group\",\"groupCollapsed\",\"groupEnd\",\"trace\"],r={},n=function(i){typeof window!=\"undefined\"&&window.console&&window.console[i]?r[i]=function(){Function.prototype.apply.call(window.console[i],window.console,arguments)}:r[i]=e};return t.forEach(n),r}}(),LG=JI,{log:wG,warn:FG,error:VG,assert:BG,dir:GG,clear:zG,profile:HG,profileEnd:UG,time:kG,timeEnd:qG,group:YG,groupCollapsed:XG,groupEnd:$G,trace:ZG}=JI;var pf={};Ds(pf,{getFrame:()=>KN});function Xn(e,t,r){return{input:e,start:t,end:r}}function vs(e,t){return Xn(e,t,t)}function Pn(e,t){if(e.input!==t.input)throw new Error(\"Programming Error: cannot form a span on different inputs\");return Xn(e.input,e.start,t.end)}function Gr(e){return e.input.slice(e.start,e.end)}var ko=()=>({type:\"empty\"}),gn=()=>({type:\"unknown\"}),Ii=e=>isNaN(e[0])||isNaN(e[1])||e[1]<e[0]?ko():{type:\"known\",bounds:e},rc=(e,t)=>{if(t===0)return e>0?Os():ko();let r=-e/t,n=t<0?[-1/0,r]:[r,1/0];return Ii(n)},Os=()=>Ii([-1/0,1/0]),Cn=(e,t)=>{if(e.type===\"empty\"||t.type===\"empty\")return ko();if(e.type===\"unknown\"||t.type===\"unknown\")return gn();let r=[Math.max(e.bounds[0],t.bounds[0]),Math.min(e.bounds[1],t.bounds[1])];return Ii(r)},KI=(e,t)=>{if(e.type===\"empty\")return t;if(t.type===\"empty\")return e;if(e.type===\"unknown\"||t.type===\"unknown\")return gn();let r=[Math.min(e.bounds[0],t.bounds[0]),Math.max(e.bounds[1],t.bounds[1])];return Ii(r)};var Fe={};Ds(Fe,{Action:()=>Je,AngleMarker:()=>Ae,Any:()=>Tt,Arc:()=>ue,Bool:()=>he,Circle:()=>de,DirectedAngleMarker:()=>xe,Distribution:()=>Ke,EmptyList:()=>Le,ErrorType:()=>wi,Line:()=>ye,ListOfAngleMarker:()=>Jt,ListOfAny:()=>Bt,ListOfArc:()=>Rr,ListOfBool:()=>zr,ListOfCircle:()=>Sr,ListOfColor:()=>Vr,ListOfDirectedAngleMarker:()=>Qt,ListOfDistribution:()=>ar,ListOfLine:()=>Nr,ListOfNumber:()=>te,ListOfPoint:()=>nt,ListOfPoint3D:()=>Hr,ListOfPolygon:()=>br,ListOfRay:()=>Ar,ListOfSegment:()=>ur,ListOfSegment3D:()=>rn,ListOfSphere3D:()=>nn,ListOfTransformation:()=>tn,ListOfTriangle3D:()=>Ur,ListOfVector:()=>Cr,ListOfVector3D:()=>sn,Number:()=>P,Point:()=>N,Point3D:()=>G,Polygon:()=>we,RGBColor:()=>It,Ray:()=>_e,SeedType:()=>Qe,Segment:()=>Oe,Segment3D:()=>dt,Sphere3D:()=>_r,Transformation:()=>He,Triangle3D:()=>xr,Vector:()=>ge,Vector3D:()=>Re,allListTypes:()=>is,allValueTypes:()=>tN,assertTypeIsOneOf:()=>il,broadcastable:()=>_n,broadcastableArg:()=>iu,elementType:()=>$e,hasListType:()=>Fi,isGeometryType:()=>rl,isList:()=>j,isOneOf:()=>$p,isSubType:()=>Ss,isSubTypeOrCoercible:()=>uo,isTypeOrListOfType:()=>ie,isValidOnLogScales:()=>nl,listType:()=>Tn,maxArity:()=>tl,minArity:()=>ya,prettyPrint:()=>pe,repr:()=>$n,straightTypes:()=>Zp,summableElementTypes:()=>ng,valueTypes:()=>e0,vectorTypes:()=>ig});function v(e,t){return{key:e,vars:t}}var Tt=0,P=1,he=2,N=3,Ke=4,Je=5,Bt=6,te=7,zr=8,nt=9,ar=10,Le=11,wi=12,Qe=13,It=14,Vr=15,we=16,br=17,Oe=18,ur=19,de=20,Sr=21,ue=22,Rr=23,ye=24,Nr=25,_e=26,Ar=27,Ae=28,Jt=29,xe=30,Qt=31,He=32,tn=33,ge=34,Cr=35,G=100,Hr=101,dt=102,rn=103,xr=104,Ur=105,_r=106,nn=107,Re=108,sn=109,e0={Any:Tt,Number:P,Bool:he,Point:N,Point3D:G,Distribution:Ke,Action:Je,ListOfAny:Bt,ListOfNumber:te,ListOfBool:zr,ListOfPoint:nt,ListOfPoint3D:Hr,ListOfDistribution:ar,EmptyList:Le,ErrorType:wi,SeedType:Qe,RGBColor:It,ListOfColor:Vr,Polygon:we,ListOfPolygon:br,Segment:Oe,ListOfSegment:ur,Circle:de,ListOfCircle:Sr,Arc:ue,ListOfArc:Rr,Line:ye,ListOfLine:Nr,Ray:_e,ListOfRay:Ar,Vector:ge,ListOfVector:Cr,AngleMarker:Ae,ListOfAngleMarker:Jt,DirectedAngleMarker:xe,ListOfDirectedAngleMarker:Qt,Transformation:He,ListOfTransformation:tn,Segment3D:dt,ListOfSegment3D:rn,Triangle3D:xr,ListOfTriangle3D:Ur,Sphere3D:_r,ListOfSphere3D:nn,Vector3D:Re,ListOfVector3D:sn},tN=Object.values(e0);function ya(e){return Array.isArray(e)?e.length:e.initial.length}function tl(e){return Array.isArray(e)?e.length:1/0}function iu(e){if(typeof e==\"number\")return Fi(e)?{meta:\"union\",types:[e,Tn(e)]}:e;let t=[];for(let r of e.types){let n=iu(r);typeof n==\"number\"?t.push(n):t.push(...n.types)}return{meta:\"union\",types:t}}function _n(e){return Array.isArray(e)?e.map(iu):{type:\"variadic\",initial:e.initial.map(iu),rest:iu(e.rest)}}function $n(e){switch(e){case Tt:return\"Any\";case P:return\"Number\";case he:return\"Bool\";case N:return\"Point\";case G:return\"Point3D\";case Ke:return\"Distribution\";case Je:return\"Action\";case Bt:return\"ListOfAny\";case te:return\"ListOfNumber\";case zr:return\"ListOfBool\";case nt:return\"ListOfPoint\";case Hr:return\"ListOfPoint3D\";case ar:return\"ListOfDistribution\";case Le:return\"EmptyList\";case wi:return\"ErrorType\";case Qe:return\"SeedType\";case It:return\"RGBColor\";case Vr:return\"ListOfColor\";case we:return\"Polygon\";case br:return\"ListOfPolygon\";case Oe:return\"Segment\";case ur:return\"ListOfSegment\";case de:return\"Circle\";case Sr:return\"ListOfCircle\";case ue:return\"Arc\";case Rr:return\"ListOfArc\";case ye:return\"Line\";case Nr:return\"ListOfLine\";case _e:return\"Ray\";case Ar:return\"ListOfRay\";case ge:return\"Vector\";case Cr:return\"ListOfVector\";case Ae:return\"Angle\";case Jt:return\"ListOfAngle\";case xe:return\"DirectedAngle\";case Qt:return\"ListOfDirectedAngle\";case He:return\"Transformation\";case tn:return\"ListOfTransformation\";case dt:return\"Segment3D\";case rn:return\"ListOfSegment3D\";case Re:return\"Vector3D\";case sn:return\"ListOfVector3D\";case xr:return\"Triangle3D\";case Ur:return\"ListOfTriangle3D\";case _r:return\"Sphere3D\";case nn:return\"ListOfSphere3D\";default:let t=e;throw new Error(`Invalid type: ${t}`)}}function pe(e){switch(e){case Tt:return v(\"shared-calculator-label-value-type-any\");case P:return v(\"shared-calculator-label-value-type-number\");case he:return v(\"shared-calculator-label-value-type-bool\");case N:return v(\"shared-calculator-label-value-type-point\");case G:return v(\"shared-calculator-label-value-type-point3d\");case Ke:return v(\"shared-calculator-label-value-type-distribution\");case Je:return v(\"shared-calculator-label-value-type-action\");case Bt:return v(\"shared-calculator-label-value-type-list-of-any\");case te:return v(\"shared-calculator-label-value-type-list-of-numbers\");case zr:return v(\"shared-calculator-label-value-type-list-of-bool\");case nt:return v(\"shared-calculator-label-value-type-list-of-points\");case Hr:return v(\"shared-calculator-label-value-type-list-of-3d-points\");case ar:return v(\"shared-calculator-label-value-type-list-of-distributions\");case Le:return v(\"shared-calculator-label-value-type-empty-list\");case wi:return v(\"shared-calculator-label-value-type-error\");case Qe:return v(\"shared-calculator-label-value-type-seed\");case It:return v(\"shared-calculator-label-value-type-color\");case Vr:return v(\"shared-calculator-label-value-type-list-of-colors\");case we:return v(\"shared-calculator-label-value-type-polygon\");case br:return v(\"shared-calculator-label-value-type-list-of-polygons\");case Oe:return v(\"shared-calculator-label-value-type-segment\");case ur:return v(\"shared-calculator-label-value-type-list-of-segments\");case de:return v(\"shared-calculator-label-value-type-circle\");case Sr:return v(\"shared-calculator-label-value-type-list-of-circles\");case ue:return v(\"shared-calculator-label-value-type-arc\");case Rr:return v(\"shared-calculator-label-value-type-list-of-arcs\");case ye:return v(\"shared-calculator-label-value-type-line\");case Nr:return v(\"shared-calculator-label-value-type-list-of-lines\");case _e:return v(\"shared-calculator-label-value-type-ray\");case Ar:return v(\"shared-calculator-label-value-type-list-of-rays\");case ge:return v(\"shared-calculator-label-value-type-vector\");case Cr:return v(\"shared-calculator-label-value-type-list-of-vectors\");case Ae:return v(\"shared-calculator-label-value-type-angle\");case Jt:return v(\"shared-calculator-label-value-type-list-of-angles\");case xe:return v(\"shared-calculator-label-value-type-directed-angle\");case Qt:return v(\"shared-calculator-label-value-type-list-of-directed-angles\");case He:return v(\"shared-calculator-label-value-type-transformation\");case tn:return v(\"shared-calculator-label-value-type-list-of-transformations\");case dt:return v(\"shared-calculator-label-value-type-segment3d\");case rn:return v(\"shared-calculator-label-value-type-list-of-segment3d\");case Re:return v(\"shared-calculator-label-value-type-vector3d\");case sn:return v(\"shared-calculator-label-value-type-list-of-vector3d\");case xr:return v(\"shared-calculator-label-value-type-triangle3d\");case Ur:return v(\"shared-calculator-label-value-type-list-of-triangle3d\");case _r:return v(\"shared-calculator-label-value-type-sphere3d\");case nn:return v(\"shared-calculator-label-value-type-list-of-sphere3d\");default:let t=e;throw new Error(`Invalid type: ${t}`)}}var is=[Bt,te,zr,nt,Hr,ar,Le,Vr,br,ur,Sr,Rr,Nr,Ar,Cr,Jt,Qt,tn,rn,sn,Ur,nn],jG={[Bt]:Tt,[Le]:P,[te]:P,[zr]:he,[nt]:N,[Hr]:G,[ar]:Ke,[Vr]:It,[br]:we,[ur]:Oe,[Sr]:de,[Rr]:ue,[Nr]:ye,[Ar]:_e,[Cr]:ge,[Jt]:Ae,[Qt]:xe,[tn]:He,[rn]:dt,[sn]:Re,[Ur]:xr,[nn]:_r};function j(e){switch(e){case void 0:return!1;case Bt:case te:case zr:case nt:case Hr:case ar:case Vr:case br:case ur:case Sr:case Rr:case Nr:case Ar:case Cr:case Jt:case Qt:case tn:case rn:case sn:case Ur:case nn:case Le:return!0;case Tt:case P:case he:case N:case G:case Ke:case wi:case Qe:case It:case Je:case we:case Oe:case de:case ue:case ye:case _e:case ge:case Ae:case xe:case He:case dt:case Re:case xr:case _r:return!1;default:throw new Error(`Invalid type: ${e}`)}}function $e(e){switch(e){case Le:case te:return P;case zr:return he;case nt:return N;case Hr:return G;case ar:return Ke;case Vr:return It;case br:return we;case rn:return dt;case sn:return Re;case Ur:return xr;case nn:return _r;case Bt:return Tt;case ur:return Oe;case Sr:return de;case Rr:return ue;case Nr:return ye;case Ar:return _e;case Cr:return ge;case Jt:return Ae;case Qt:return xe;case tn:return He;case Tt:case P:case he:case N:case G:case Ke:case wi:case Qe:case It:case Je:case we:case Oe:case de:case ue:case ye:case _e:case ge:case Ae:case xe:case He:case dt:case Re:case xr:case _r:throw new Error(\"Type \"+$n(e)+\" does not implement elementType.\");default:let t=e;throw new Error(`Invalid type: ${t}`)}}function Tn(e){switch(e){case Tt:return Bt;case P:return te;case he:return zr;case N:return nt;case G:return Hr;case Ke:return ar;case It:return Vr;case we:return br;case Oe:return ur;case de:return Sr;case ue:return Rr;case ye:return Nr;case _e:return Ar;case ge:return Cr;case Ae:return Jt;case xe:return Qt;case He:return tn;case dt:return rn;case Re:return sn;case xr:return Ur;case _r:return nn;case Le:case te:case zr:case nt:case Hr:case ar:case Vr:case br:case ur:case Sr:case Rr:case Nr:case Ar:case Cr:case Jt:case Qt:case tn:case rn:case sn:case Ur:case nn:case Bt:case wi:case Qe:case Je:throw new Error(\"Type \"+$n(e)+\" does not implement listType.\");default:let t=e;throw new Error(`Invalid type: ${t}`)}}function Fi(e){switch(e){case Tt:case P:case he:case N:case G:case Ke:case It:case we:case Oe:case de:case ue:case ye:case _e:case ge:case Ae:case xe:case He:case dt:case Re:case xr:case _r:return!0;case Le:case te:case zr:case nt:case Hr:case ar:case Vr:case br:case ur:case Sr:case Rr:case Nr:case Ar:case Cr:case Jt:case Qt:case tn:case rn:case sn:case Ur:case nn:case Bt:case Qe:case Je:case wi:return!1;default:throw new Error(`Invalid type: ${e}`)}}function rl(e){if(e===void 0)return!1;switch(e){case N:case we:case Oe:case de:case ue:case ye:case _e:case ge:case Ae:case xe:case He:return!0;default:return!1}}function nl(e){switch(e){case P:case Tt:case he:case N:case Ke:case Je:case Bt:case te:case zr:case nt:case ar:case Le:case wi:case Qe:case It:case Vr:return!0;case G:case Hr:case dt:case rn:case Re:case sn:case xr:case Ur:case _r:case nn:case we:case br:case Oe:case ur:case de:case Sr:case ue:case Rr:case ye:case Nr:case _e:case Ar:case ge:case Cr:case Ae:case Jt:case xe:case Qt:case He:case tn:return!1;default:let t=e;throw new Error(`Invalid type: ${t}`)}}function $p(e,t){for(let r of t)if(e===r)return!0;return!1}function Ss(e,t){return e===Le&&j(t)||t===Bt&&j(e)||t===Tt&&!j(e)?!0:e===t}function uo(e,t){return Ss(e,t)||(e===Ae||e===xe)&&t===P?!0:(e===Jt||e===Qt)&&t===te}var ng=[P,N,G],Zp=[ye,_e,Oe,ge],ig={meta:\"union\",types:[ge,Re]};function ie(e,t){return e===t?!0:j(e)?e===Le?!0:$e(e)===t:!1}function il(e,t){if(!$p(e,t))throw new Error(`Programming error: expected one of ${t.map(pe)} but found ${e} instead.`)}var yt=class{constructor(){this.exportPenalty=0;this._dependencies=[],this._dummyDependencies=[],this._updateSymbols=[],this._substitutionSymbols=[],this._scope={definitions:[],dependencies:[],substitutionDependencies:[],scopes:[]},this._exports=[]}setInputSpan(t){this._inputSpan=t}getInputString(){return this._inputSpan===void 0?\"\":Gr(this._inputSpan)}getInputSpan(){return this._inputSpan}shouldExportAns(){return!1}getAnsVariable(){return this.shouldExportAns()&&this.userData&&this.userData.hasOwnProperty(\"index\")?[\"ans_\"+this.userData.index]:[]}addDependency(t){this._dependencies.indexOf(t)===-1&&this._dependencies.push(t),this._scope.dependencies.indexOf(t)===-1&&this._scope.dependencies.push(t)}addDependencies(t){for(var r=0;r<t.length;r++)this.addDependency(t[r])}addDummyDependency(t){this._dependencies.indexOf(t)===-1&&this._dependencies.push(t),this._dummyDependencies.indexOf(t)===-1&&this._dummyDependencies.push(t)}addDummyDependencies(t){for(var r=0;r<t.length;r++)this.addDummyDependency(t[r])}addUpdateSymbol(t){this._dependencies.indexOf(t)===-1&&this._dependencies.push(t),this._updateSymbols.indexOf(t)===-1&&this._updateSymbols.push(t)}addSubstitutionSymbol(t){this._dummyDependencies.indexOf(t)===-1&&this._dummyDependencies.push(t),this._substitutionSymbols.indexOf(t)===-1&&this._substitutionSymbols.push(t)}addSubstitutionDependencies(t){for(var r=0;r<t.length;r++){var n=t[r];if(this._dependencies.indexOf(n)===-1)throw new Error(\"Programming error: substitution dependency \"+n+\" must also be registered as a regular dependency\");this._scope.substitutionDependencies.indexOf(n)===-1&&this._scope.substitutionDependencies.push(n)}}mergeDependencies(...t){for(var r=0;r<t.length;r++){var n=t[r],i;for(i=0;i<n._dependencies.length;i++)this._dependencies.indexOf(n._dependencies[i])===-1&&this._dependencies.push(n._dependencies[i]);for(i=0;i<n._updateSymbols.length;i++)this._updateSymbols.indexOf(n._updateSymbols[i])===-1&&this._updateSymbols.push(n._updateSymbols[i]);for(i=0;i<n._substitutionSymbols.length;i++)this._substitutionSymbols.indexOf(n._substitutionSymbols[i])===-1&&this._substitutionSymbols.push(n._substitutionSymbols[i]);for(i=0;i<n._scope.dependencies.length;i++)this._scope.dependencies.indexOf(n._scope.dependencies[i])===-1&&this._scope.dependencies.push(n._scope.dependencies[i]);for(i=0;i<n._scope.substitutionDependencies.length;i++)this._scope.substitutionDependencies.indexOf(n._scope.substitutionDependencies[i])===-1&&this._scope.substitutionDependencies.push(n._scope.substitutionDependencies[i]);this.addDummyDependencies(n.getDummyDependencies()),Array.prototype.push.apply(this._scope.scopes,n._scope.scopes)}}mergeDependenciesInScope(t,r,n,i){this.addDummyDependencies(r);var s=n.getScope(),o={kind:t,definitions:r,dependencies:s.dependencies,substitutionDependencies:s.substitutionDependencies,scopes:s.scopes,functionDefinitionSymbol:i==null?void 0:i.functionDefinitionSymbol};this._scope.scopes.push(o);for(var a=0;a<n._dependencies.length;a++)this._dependencies.indexOf(n._dependencies[a])===-1&&this._dependencies.push(n._dependencies[a]);for(a=0;a<n._updateSymbols.length;a++)this._updateSymbols.indexOf(n._updateSymbols[a])===-1&&this._updateSymbols.push(n._updateSymbols[a]);for(a=0;a<n._substitutionSymbols.length;a++)this._substitutionSymbols.indexOf(n._substitutionSymbols[a])===-1&&this._substitutionSymbols.push(n._substitutionSymbols[a]);this.addDummyDependencies(n.getDummyDependencies())}getDependencies(){return this._dependencies}graphmodeDependencies(t,r){return this.getDependencies()}getDummyDependencies(){return this._dummyDependencies}getUpdateSymbols(){return this._updateSymbols}getSubstitutionSymbols(){return this._substitutionSymbols}getScope(){return this._scope}dependsOn(t){return this._dependencies.indexOf(t)>-1}getExports(t){var r=this._exports||[];if(this.userData&&\"id\"in this.userData){var n=this.userData.id;r=r.concat([\"idref_\"+n])}return t.ansEnabled()&&(r=r.concat(this.getAnsVariable())),r}getLegalExports(t){return this.getExports(t).filter(function(r){return!t.assignmentForbidden(r)})}exportsSymbol(t){return this._exports.indexOf(t)>-1}exportTo(t,r,n){for(var i=this.getLegalExports(t),s=0;s<i.length;s++){var o=i[s];if(n[o])return;n[o]=r.blocksExport?r:this}}getOperator(){return this.operator||\"=\"}isInequality(){return!1}isShadeBetween(){return!1}getAllIds(){return this.userData?[this.userData.id]:[]}getEvaluationInfo(){return!1}shouldPromoteToSlider(t){return!1}getSliderVariables(t,r,n){var i=t.sliderVariables(n!=null?n:r.getDependencies());return r.valueType===N||r.valueType===nt||r.valueType===G||r.valueType===Hr?t.is3dPolicy()?i.includes(\"t\")&&!i.includes(\"u\")&&!i.includes(\"v\")?i.filter(s=>s!=\"t\"):!i.includes(\"t\")&&(i.includes(\"u\")||i.includes(\"v\"))?i.filter(s=>s!=\"u\"&&s!=\"v\"):i:i.filter(function(s){return!t.validParametricVariable(s)}):i}getCompiledDerivative(){var t=this.getDependencies(),n=this.takeDerivative(t[0]||\"x\");return n.getCompiledFunction()}asValue(){}boundDomain(t){return gn()}getCursorContext(){}polynomialOrder(t){}getPolynomialCoefficients(t){}asTypedValue(){}substitute(t){}getExpressionType(t,r){}tableInfo(t,r){}analyzeFourFunction(t,r,n){}analyzeScientific(t,r,n){}analyzeSingleExpressionScientific(t,r,n){}getGraphMode(t,r){}};var Q=class extends yt{constructor(r,n){if(!Array.isArray(r))throw new TypeError(\"Argument to expression constructor must be an Array.\");super();this.args=r,(!n||!n.skipRegisterDependencies)&&this.registerDependencies()}shouldExportAns(){return!0}registerDependencies(){for(var r=0;r<this.args.length;r++)this.mergeDependencies(this.args[r])}copyWithArgs(r){return new this.constructor(r)}};function qo(e,t=1e6){if(e===1/0)return{n:1/0,d:1};if(e===-1/0)return{n:-1/0,d:1};if(!isFinite(e))return{n:NaN,d:1};let r,n=0,i=1,s=1,o=0,a,u;for(;r=Math.floor(e),a=r*i+n,u=r*o+s,!(u>t||(n=i,s=o,i=a,o=u,e===r));)e=1/(e-r);return{n:i,d:o}}function t0(e,t,r){if(e=ic(e),r>0){let n=ic(t);return e<n&&(e+=2*Math.PI),(e-n)/r}else{let n=ic(t+r);return e<n&&(e+=2*Math.PI),1+(e-n)/r}}function Wp(e,t,r){e=ic(e);let n=ic(t),i=ic(t+r);if(r<0){let s=n;n=i,i=s}return n<i?n<=e&&e<=i:n<=e||e<=i}function ic(e){let t=2*Math.PI;return(e%t+t)%t}function t2(e,t){if(!(isNaN(e)||isNaN(t)))return e>=0?Math.atan(t/e):Math.atan(t/e)+Math.PI}var ss=Math.hypot;function Yo(e,t){return e>0==t>0?e+.5*(t-e):.5*(e+t)}function nN(e,t,r,n,i,s){return e*n+t*i+r*s}function Rs(e,t,r,n,i,s,o,a,u){let c=ss(o-n,a-i,u-s);return c===0?0:nN((e-n)/c,(t-i)/c,(r-s)/c,(o-n)/c,(a-i)/c,(u-s)/c)}function iN(e,t,r,n,i,s){let o=Rs(e,t,0,r,n,0,i,s,0);return o<=0?[r,n]:o>=1?[i,s]:[r+o*(i-r),n+o*(s-n)]}function n2(e,t,r,n,i,s,o,a){let u=Rs(e,t,0,r,n,0,i,s,0);return u<=0&&!o?[r,n]:u>=1&&!a?[i,s]:[r+u*(i-r),n+u*(s-n)]}function r0(e,t,r,n,i,s){let o=iN(e,t,r,n,i,s);return ss(e-o[0],t-o[1])}function i2(e,t,r,n,i,s,o){var a=Math.atan2(t-n,e-r);if(Wp(a,s,o-s))return[i*Math.cos(a)+r,i*Math.sin(a)+n]}function Ln(e,t,r=1){if(e===t)return!0;if(!isFinite(e)||!isFinite(t))return!1;if(r>50)throw new Error(\"Within \"+(52-r)+\" bits isn't really approximate any more\");let n=Math.max(Math.max(Math.abs(e),Math.abs(t)),1),i=r===1?.5:Math.pow(.5,r);return n===n+i*Math.abs(t-e)}function s2(e){return Math.round(e-.5)+.5}function su(e,t){if(isNaN(e)||isNaN(t))return NaN;if(e=Math.round(e),t=Math.round(t),e<0&&(e=-e),t<0&&(t=-t),t>e){let n=t;t=e,e=n}if(t===0)return e;let r=e%t;for(;r>0;)e=t,t=r,r=e%t;return t}function ou(e,t){if(!isFinite(e)&&t===0)return NaN;if(e>=0||t===Math.floor(t))return Math.pow(e,t);let r=qo(t,100);return Ln(r.n/r.d,t,2)&&r.d%2===1?(r.n%2===0?1:-1)*Math.pow(-e,t):NaN}function sc(e,t){return{n:e,d:t}}function cr(e){return typeof e==\"object\"&&typeof e.n==\"number\"&&typeof e.d==\"number\"}var sl=Math.pow(2,53)-1;function au(e){let t=e.match(/^(-)?(\\d*)?(?:\\.(\\d*))?$/);if(!t)return NaN;let r=t[1],n=t[2],i=t[3];if(!n&&!i)return NaN;let s=!!r;if(i){let o=i.replace(/0+$/,\"\"),a=o.length,u=Math.pow(10,a),c=parseInt(n||\"0\",10)*u+parseInt(o||\"0\",10);return c>sl||u>sl?parseFloat(e):Ce(s?-c:c,u)}else{let o=parseInt(n,10);return o>sl?parseFloat(e):Ce(s?-o:o,1)}}function Y(e){return cr(e)?e.n/e.d:+e}function Ei(e){return cr(e)?!1:isNaN(e)}function Ce(e,t){if(!isFinite(e)||!isFinite(t)||t===0||Math.floor(e)!==e||Math.floor(t)!==t||Math.abs(e)>sl||Math.abs(t)>sl)return e/t;t<0&&(e=-e,t=-t);let r=su(e,t);return sc(e/r,t/r)}function Vi(e){return cr(e)?sc(-e.n,e.d):-e}function n0(e){return cr(e)?sc(Math.abs(e.n),Math.abs(e.d)):Math.abs(e)}function ol(e){return cr(e)?e.n===0?e.d/e.n:sc(e.n<0?-e.d:e.d,Math.abs(e.n)):1/e}function co(e,t){if(!cr(e)||!cr(t))return Y(e)+Y(t);var r=su(e.d,t.d);return Ce(e.n*(t.d/r)+t.n*(e.d/r),e.d/r*t.d)}function lo(e,t){if(!cr(e)||!cr(t))return Y(e)*Y(t);var r=su(e.n,t.d),n=su(t.n,e.d);return Ce(e.n/r*(t.n/n),e.d/n*(t.d/r))}function Ns(e,t){return co(e,Vi(t))}function As(e,t){return!cr(e)||!cr(t)?Y(e)/Y(t):lo(e,ol(t))}function oN(e,t){let r=e,n=t;if(t.n<0&&(n=Vi(t),r=ol(e)),!cr(r)||!cr(n))return ou(Y(e),Y(t));if(e=r,t=n,t.d===1)return Ce(Math.pow(e.n,t.n),Math.pow(e.d,t.n));let i=e.n<0;if(i&&t.d%2!==1)return NaN;let o=(i?-1:1)*Math.round(Math.pow(Math.abs(e.n),1/t.d)),a=Math.round(Math.pow(Math.abs(e.d),1/t.d));return Math.pow(o,t.d)!==e.n||Math.pow(a,t.d)!==e.d?ou(Y(e),Y(t)):Ce(Math.pow(o,t.n),Math.pow(a,t.n))}function sg(e,t){if(!cr(e)||!cr(t))return ou(Y(e),Y(t));let r=oN(e,t);return cr(r)?r:ou(Y(e),Y(t))}function i0(e){if(!cr(e))return Math.sqrt(e);let t=Math.round(Math.sqrt(e.n)),r=Math.round(Math.sqrt(e.d));return t*t!==e.n||r*r!==e.d?Math.sqrt(Y(e)):Ce(t,r)}function jp(e,t){return sg(e,ol(t))}function s0(e,t){if(!cr(e)||!cr(t)){let r=Y(e),n=Y(t);return r-n*Math.floor(r/n)}return Ns(e,lo(t,sc(Math.floor(Y(As(e,t))),1)))}function o0(e){let t=sc(0,1);for(let r of e)t=co(t,r);return t}var fr=class extends Q{constructor(r){super([]);this.isConstant=!0;typeof r==\"number\"&&(r=Ce(r,1)),this._constantValue=r}asValue(){let r=this._constantValue;return typeof r==\"boolean\"?r:Y(r)}asCompilerValue(){return this._constantValue}scalarExprString(){return this.asValue()>0?String(this.asValue()):\"(\"+String(this.asValue())+\")\"}getEvaluationInfo(){return[{val:this.asValue()}]}isNaN(){let r=this.asValue();return typeof r==\"number\"&&isNaN(r)}};var $o={};Ds($o,{canDisplayAsFraction:()=>w0,formatSymbol:()=>J,geoParentToLatex:()=>$N,identifierToHTML:()=>ZN,identifierToLatex:()=>Zr,latexToIdentifier:()=>po,numericLabel:()=>af,point:()=>HN,roundDecimal:()=>YN,trimLatex:()=>fo,truncatedHTMLLabel:()=>XN,truncatedLatexLabel:()=>yg,truncatedPlainmathLabel:()=>mg,value:()=>fg});var Jp=typeof self==\"object\"&&self.self===self&&self||typeof global==\"object\"&&global.global===global&&global||Function(\"return this\")()||{},ef=Array.prototype,ug=Object.prototype,a0=typeof Symbol!=\"undefined\"?Symbol.prototype:null,c2=ef.push,d0=ef.slice,Qp=ug.toString,aN=ug.hasOwnProperty,uN=Array.isArray,u0=Object.keys,c0=Object.create,m0=Jp.isNaN,cN=Jp.isFinite,og=function(){};function on(e){if(e instanceof on)return e;if(!(this instanceof on))return new on(e);this._wrapped=e}var l2=on.VERSION=\"1.10.2\";function tf(e,t,r){if(t===void 0)return e;switch(r==null?3:r){case 1:return function(n){return e.call(t,n)};case 3:return function(n,i,s){return e.call(t,n,i,s)};case 4:return function(n,i,s,o){return e.call(t,n,i,s,o)}}return function(){return e.apply(t,arguments)}}function y0(e,t,r){return e==null?VN:Xo(e)?tf(e,t,r):lc(e)&&!cc(e)?BN(e):O0(e)}on.iteratee=g0;function g0(e,t){return y0(e,t,1/0)}function Cs(e,t,r){return on.iteratee!==g0?on.iteratee(e,t):y0(e,t,r)}function Bi(e,t){return t=t==null?e.length-1:+t,function(){for(var r=Math.max(arguments.length-t,0),n=Array(r),i=0;i<r;i++)n[i]=arguments[i+t];switch(t){case 0:return e.call(this,n);case 1:return e.call(this,arguments[0],n);case 2:return e.call(this,arguments[0],arguments[1],n)}var s=Array(t+1);for(i=0;i<t;i++)s[i]=arguments[i];return s[t]=n,e.apply(this,s)}}function lN(e){if(!lc(e))return{};if(c0)return c0(e);og.prototype=e;var t=new og;return og.prototype=null,t}function h0(e){return function(t){return t==null?void 0:t[e]}}function ac(e,t){return e!=null&&aN.call(e,t)}function b0(e,t){for(var r=t.length,n=0;n<r;n++){if(e==null)return;e=e[t[n]]}return r?e:void 0}var pN=Math.pow(2,53)-1,ha=h0(\"length\");function Gi(e){var t=ha(e);return typeof t==\"number\"&&t>=0&&t<=pN}function uc(e,t,r){t=tf(t,r);var n,i;if(Gi(e))for(n=0,i=e.length;n<i;n++)t(e[n],n,e);else{var s=Zn(e);for(n=0,i=s.length;n<i;n++)t(e[s[n]],s[n],e)}return e}function rf(e,t,r){t=Cs(t,r);for(var n=!Gi(e)&&Zn(e),i=(n||e).length,s=Array(i),o=0;o<i;o++){var a=n?n[o]:o;s[o]=t(e[a],a,e)}return s}function x0(e){var t=function(r,n,i,s){var o=!Gi(r)&&Zn(r),a=(o||r).length,u=e>0?0:a-1;for(s||(i=r[o?o[u]:u],u+=e);u>=0&&u<a;u+=e){var c=o?o[u]:u;i=n(i,r[c],c,r)}return i};return function(r,n,i,s){var o=arguments.length>=3;return t(r,tf(n,s,4),i,o)}}var p2=x0(1),f2=x0(-1);function fN(e,t,r){var n=[];return t=Cs(t,r),uc(e,function(i,s,o){t(i,s,o)&&n.push(i)}),n}function d2(e,t,r){t=Cs(t,r);for(var n=!Gi(e)&&Zn(e),i=(n||e).length,s=0;s<i;s++){var o=n?n[s]:s;if(!t(e[o],o,e))return!1}return!0}function m2(e,t,r){t=Cs(t,r);for(var n=!Gi(e)&&Zn(e),i=(n||e).length,s=0;s<i;s++){var o=n?n[s]:s;if(t(e[o],o,e))return!0}return!1}function oc(e,t,r,n){return Gi(e)||(e=al(e)),(typeof r!=\"number\"||n)&&(r=0),xN(e,t,r)>=0}var y2=Bi(function(e,t,r){var n,i;return Xo(t)?i=t:cc(t)&&(n=t.slice(0,-1),t=t[t.length-1]),rf(e,function(s){var o=i;if(!o){if(n&&n.length&&(s=b0(s,n)),s==null)return;o=s[t]}return o==null?o:o.apply(s,r)})});function P0(e,t){return rf(e,O0(t))}function dN(e,t,r){var n=-1/0,i=-1/0,s,o;if(t==null||typeof t==\"number\"&&typeof e[0]!=\"object\"&&e!=null){e=Gi(e)?e:al(e);for(var a=0,u=e.length;a<u;a++)s=e[a],s!=null&&s>n&&(n=s)}else t=Cs(t,r),uc(e,function(c,l,p){o=t(c,l,p),(o>i||o===-1/0&&n===-1/0)&&(n=c,i=o)});return n}function g2(e,t,r){var n=1/0,i=1/0,s,o;if(t==null||typeof t==\"number\"&&typeof e[0]!=\"object\"&&e!=null){e=Gi(e)?e:al(e);for(var a=0,u=e.length;a<u;a++)s=e[a],s!=null&&s<n&&(n=s)}else t=Cs(t,r),uc(e,function(c,l,p){o=t(c,l,p),(o<i||o===1/0&&n===1/0)&&(n=c,i=o)});return n}function h2(e){return mN(e,1/0)}function mN(e,t,r){if(t==null||r)return Gi(e)||(e=al(e)),e[p0(e.length-1)];var n=Gi(e)?SN(e):al(e),i=ha(n);t=Math.max(Math.min(t,i),0);for(var s=i-1,o=0;o<t;o++){var a=p0(o,s),u=n[o];n[o]=n[a],n[a]=u}return n.slice(0,t)}function b2(e,t,r){var n=0;return t=Cs(t,r),P0(rf(e,function(i,s,o){return{value:i,index:n++,criteria:t(i,s,o)}}).sort(function(i,s){var o=i.criteria,a=s.criteria;if(o!==a){if(o>a||o===void 0)return 1;if(o<a||a===void 0)return-1}return i.index-s.index}),\"value\")}function nf(e,t){return function(r,n,i){var s=t?[[],[]]:{};return n=Cs(n,i),uc(r,function(o,a){var u=n(o,a,r);e(s,o,u)}),s}}var x2=nf(function(e,t,r){ac(e,r)?e[r].push(t):e[r]=[t]}),P2=nf(function(e,t,r){e[r]=t}),T2=nf(function(e,t,r){ac(e,r)?e[r]++:e[r]=1});function I2(e){return e==null?0:Gi(e)?e.length:Zn(e).length}var E2=nf(function(e,t,r){e[r?0:1].push(t)},!0);function uu(e,t,r,n){n=n||[];for(var i=n.length,s=0,o=ha(e);s<o;s++){var a=e[s];if(Gi(a)&&(cc(a)||Kp(a)))if(t)for(var u=0,c=a.length;u<c;)n[i++]=a[u++];else uu(a,t,r,n),i=n.length;else r||(n[i++]=a)}return n}function ul(e,t){return uu(e,t,!1)}var M2=Bi(function(e,t){return cg(e,t)});function cl(e,t,r,n){FN(t)||(n=r,r=t,t=!1),r!=null&&(r=Cs(r,n));for(var i=[],s=[],o=0,a=ha(e);o<a;o++){var u=e[o],c=r?r(u,o,e):u;t&&!r?((!o||s!==c)&&i.push(u),s=c):r?oc(s,c)||(s.push(c),i.push(u)):oc(i,u)||i.push(u)}return i}var D2=Bi(function(e){return cl(uu(e,!0,!0))});var cg=Bi(function(e,t){return t=uu(t,!0,!0),fN(e,function(r){return!oc(t,r)})});function yN(e){for(var t=e&&dN(e,ha).length||0,r=Array(t),n=0;n<t;n++)r[n]=P0(e,n);return r}var v2=Bi(yN);function T0(e){return function(t,r,n){r=Cs(r,n);for(var i=ha(t),s=e>0?0:i-1;s>=0&&s<i;s+=e)if(r(t[s],s,t))return s;return-1}}var gN=T0(1),hN=T0(-1);function bN(e,t,r,n){r=Cs(r,n,1);for(var i=r(t),s=0,o=ha(e);s<o;){var a=Math.floor((s+o)/2);r(e[a])<i?s=a+1:o=a}return s}function I0(e,t,r){return function(n,i,s){var o=0,a=ha(n);if(typeof s==\"number\")e>0?o=s>=0?s:Math.max(s+a,o):a=s>=0?Math.min(s+1,a):s+a+1;else if(r&&s&&a)return s=r(n,i),n[s]===i?s:-1;if(i!==i)return s=t(d0.call(n,o,a),wN),s>=0?s+o:-1;for(s=e>0?o:a-1;s>=0&&s<a;s+=e)if(n[s]===i)return s;return-1}}var xN=I0(1,gN,bN),O2=I0(-1,hN);function S2(e,t){if(t==null||t<1)return[];for(var r=[],n=0,i=e.length;n<i;)r.push(d0.call(e,n,n+=t));return r}function E0(e,t,r,n,i){if(!(n instanceof t))return e.apply(r,i);var s=lN(e.prototype),o=e.apply(s,i);return lc(o)?o:s}var PN=Bi(function(e,t,r){if(!Xo(e))throw new TypeError(\"Bind must be called on a function\");var n=Bi(function(i){return E0(e,n,t,this,r.concat(i))});return n}),sf=Bi(function(e,t){var r=sf.placeholder,n=function(){for(var i=0,s=t.length,o=Array(s),a=0;a<s;a++)o[a]=t[a]===r?arguments[i++]:t[a];for(;i<arguments.length;)o.push(arguments[i++]);return E0(e,n,this,this,o)};return n});sf.placeholder=on;var R2=Bi(function(e,t){t=uu(t,!1,!1);var r=t.length;if(r<1)throw new Error(\"bindAll must be passed function names\");for(;r--;){var n=t[r];e[n]=PN(e[n],e)}});var M0=Bi(function(e,t,r){return setTimeout(function(){return e.apply(null,r)},t)}),N2=sf(M0,on,1);function A2(e,t,r){var n,i,s,o,a=0;r||(r={});var u=function(){a=r.leading===!1?0:f0(),n=null,o=e.apply(i,s),n||(i=s=null)},c=function(){var l=f0();!a&&r.leading===!1&&(a=l);var p=t-(l-a);return i=this,s=arguments,p<=0||p>t?(n&&(clearTimeout(n),n=null),a=l,o=e.apply(i,s),n||(i=s=null)):!n&&r.trailing!==!1&&(n=setTimeout(u,p)),o};return c.cancel=function(){clearTimeout(n),a=0,n=i=s=null},c}function C2(e,t,r){var n,i,s=function(a,u){n=null,u&&(i=e.apply(a,u))},o=Bi(function(a){if(n&&clearTimeout(n),r){var u=!n;n=setTimeout(s,t),u&&(i=e.apply(this,a))}else n=M0(s,t,this,a);return i});return o.cancel=function(){clearTimeout(n),n=null},o}function TN(e){return function(){return!e.apply(this,arguments)}}function IN(e,t){var r;return function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=null),r}}var _2=sf(IN,2),D0=!{toString:null}.propertyIsEnumerable(\"toString\"),l0=[\"valueOf\",\"isPrototypeOf\",\"toString\",\"propertyIsEnumerable\",\"hasOwnProperty\",\"toLocaleString\"];function v0(e,t){var r=l0.length,n=e.constructor,i=Xo(n)&&n.prototype||ug,s=\"constructor\";for(ac(e,s)&&!oc(t,s)&&t.push(s);r--;)s=l0[r],s in e&&e[s]!==i[s]&&!oc(t,s)&&t.push(s)}function Zn(e){if(!lc(e))return[];if(u0)return u0(e);var t=[];for(var r in e)ac(e,r)&&t.push(r);return D0&&v0(e,t),t}function lg(e){if(!lc(e))return[];var t=[];for(var r in e)t.push(r);return D0&&v0(e,t),t}function al(e){for(var t=Zn(e),r=t.length,n=Array(r),i=0;i<r;i++)n[i]=e[t[i]];return n}function EN(e){for(var t={},r=Zn(e),n=0,i=r.length;n<i;n++)t[e[r[n]]]=r[n];return t}function pg(e,t){return function(r){var n=arguments.length;if(t&&(r=Object(r)),n<2||r==null)return r;for(var i=1;i<n;i++)for(var s=arguments[i],o=e(s),a=o.length,u=0;u<a;u++){var c=o[u];(!t||r[c]===void 0)&&(r[c]=s[c])}return r}}var MN=pg(lg),DN=pg(Zn);function vN(e,t,r){return t in r}var ON=Bi(function(e,t){var r={},n=t[0];if(e==null)return r;Xo(n)?(t.length>1&&(n=tf(n,t[1])),t=lg(e)):(n=vN,t=uu(t,!1,!1),e=Object(e));for(var i=0,s=t.length;i<s;i++){var o=t[i],a=e[o];n(a,o,e)&&(r[o]=a)}return r}),L2=Bi(function(e,t){var r=t[0],n;return Xo(r)?(r=TN(r),t.length>1&&(n=t[1])):(t=rf(uu(t,!1,!1),String),r=function(i,s){return!oc(t,s)}),ON(e,r,n)}),w2=pg(lg,!0);function SN(e){return lc(e)?cc(e)?e.slice():MN({},e):e}function RN(e,t){var r=Zn(t),n=r.length;if(e==null)return!n;for(var i=Object(e),s=0;s<n;s++){var o=r[s];if(t[o]!==i[o]||!(o in i))return!1}return!0}function ag(e,t,r,n){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var i=typeof e;return i!==\"function\"&&i!==\"object\"&&typeof t!=\"object\"?!1:NN(e,t,r,n)}function NN(e,t,r,n){e instanceof on&&(e=e._wrapped),t instanceof on&&(t=t._wrapped);var i=Qp.call(e);if(i!==Qp.call(t))return!1;switch(i){case\"[object RegExp]\":case\"[object String]\":return\"\"+e==\"\"+t;case\"[object Number]\":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case\"[object Date]\":case\"[object Boolean]\":return+e==+t;case\"[object Symbol]\":return a0.valueOf.call(e)===a0.valueOf.call(t)}var s=i===\"[object Array]\";if(!s){if(typeof e!=\"object\"||typeof t!=\"object\")return!1;var o=e.constructor,a=t.constructor;if(o!==a&&!(Xo(o)&&o instanceof o&&Xo(a)&&a instanceof a)&&\"constructor\"in e&&\"constructor\"in t)return!1}r=r||[],n=n||[];for(var u=r.length;u--;)if(r[u]===e)return n[u]===t;if(r.push(e),n.push(t),s){if(u=e.length,u!==t.length)return!1;for(;u--;)if(!ag(e[u],t[u],r,n))return!1}else{var c=Zn(e),l;if(u=c.length,Zn(t).length!==u)return!1;for(;u--;)if(l=c[u],!(ac(t,l)&&ag(e[l],t[l],r,n)))return!1}return r.pop(),n.pop(),!0}function ba(e,t){return ag(e,t)}function F2(e){return e==null?!0:Gi(e)&&(cc(e)||AN(e)||Kp(e))?e.length===0:Zn(e).length===0}function zi(e){return function(t){return Qp.call(t)===\"[object \"+e+\"]\"}}var cc=uN||zi(\"Array\");function lc(e){var t=typeof e;return t===\"function\"||t===\"object\"&&!!e}var Kp=zi(\"Arguments\"),Xo=zi(\"Function\"),AN=zi(\"String\"),CN=zi(\"Number\"),V2=zi(\"Date\"),B2=zi(\"RegExp\"),G2=zi(\"Error\"),_N=zi(\"Symbol\"),z2=zi(\"Map\"),H2=zi(\"WeakMap\"),U2=zi(\"Set\"),k2=zi(\"WeakSet\");(function(){Kp(arguments)||(Kp=function(e){return ac(e,\"callee\")})})();var LN=Jp.document&&Jp.document.childNodes;typeof/./!=\"function\"&&typeof Int8Array!=\"object\"&&typeof LN!=\"function\"&&(Xo=function(e){return typeof e==\"function\"||!1});function q2(e){return!_N(e)&&cN(e)&&!m0(parseFloat(e))}function wN(e){return CN(e)&&m0(e)}function FN(e){return e===!0||e===!1||Qp.call(e)===\"[object Boolean]\"}function VN(e){return e}function O0(e){return cc(e)?function(t){return b0(t,e)}:h0(e)}function BN(e){return e=DN({},e),function(t){return RN(t,e)}}function p0(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}var f0=Date.now||function(){return new Date().getTime()},S0={\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#x27;\",\"`\":\"&#x60;\"},GN=EN(S0);function R0(e){var t=function(s){return e[s]},r=\"(?:\"+Zn(e).join(\"|\")+\")\",n=RegExp(r),i=RegExp(r,\"g\");return function(s){return s=s==null?\"\":\"\"+s,n.test(s)?s.replace(i,t):s}}var N0=R0(S0),Y2=R0(GN);var zN=0;function X2(e){var t=++zN+\"\";return e?e+t:t}var $2=on.templateSettings={evaluate:/<%([\\s\\S]+?)%>/g,interpolate:/<%=([\\s\\S]+?)%>/g,escape:/<%-([\\s\\S]+?)%>/g};function A0(e,t){return e._chain?on(t).chain():t}uc([\"pop\",\"push\",\"reverse\",\"shift\",\"sort\",\"splice\",\"unshift\"],function(e){var t=ef[e];on.prototype[e]=function(){var r=this._wrapped;return t.apply(r,arguments),(e===\"shift\"||e===\"splice\")&&r.length===0&&delete r[0],A0(this,r)}});uc([\"concat\",\"join\",\"slice\"],function(e){var t=ef[e];on.prototype[e]=function(){return A0(this,t.apply(this._wrapped,arguments))}});on.prototype.value=function(){return this._wrapped};on.prototype.valueOf=on.prototype.toJSON=on.prototype.value;on.prototype.toString=function(){return String(this._wrapped)};function fg(e,t=e,r=!1){if(isNaN(e)||!isFinite(e))return{string:\"undefined\",latex:\"undefined\",value:e};if(e===0)return{string:\"0\",latex:\"0\",value:e};Math.abs(e)>Math.abs(t)&&(t=e);let n=qo(e/Math.PI,24),i,s,o,a,u,c;if(C0(t)&&Ln(n.n/n.d*Math.PI,e,3))return n.n===0?(i=\"0\",a=\"0\"):n.n===1?(i=\"\\u03C0\",a=\"\\\\pi\"):n.n===-1?(i=\"-\\u03C0\",a=\"-\\\\pi\"):(i=n.n.toString()+\"\\u03C0\",a=n.n.toString()+\"\\\\pi\"),n.d===1?(s=\"\",u=\"\"):(s=\"/\"+n.d.toString(),u=n.d.toString()),o=i+s,u===\"\"?c=a:a[0]===\"-\"?c=`-\\\\frac{${a.slice(1)}}{${u}}`:c=`\\\\frac{${a}}{${u}}`,{string:o,latex:c,value:n.n/n.d*Math.PI};if(!r&&C0(t)||qN(t))return o=kN(_0(e.toFixed(of(t)))),{string:o,latex:o,value:parseFloat(o)};{let p=dg(e.toExponential(of(t/e))).split(\"e\"),f=p[0]===\"1\"&&r?\"10\":p[0]+\"\\xD710\",y=p[1].replace(\"+\",\"\");return o=dg(e.toExponential(of(t/e))).replace(\"+\",\"\"),c=`${p[0]}\\\\times10^{${y}}`,{string:o,latex:c,mantissa:f,superscript:y,value:parseFloat(o)}}}function HN(e,t,r,n){let i=fg(e,t),s=fg(n(i.value),r);return[i,s]}var UN=/\\.?0+$/;function _0(e){return e.indexOf(\".\")===-1?e:e.replace(UN,\"\")}function dg(e){let t=/\\.?0+e/;return e.replace(t,\"e\")}function kN(e){return e===\"-0\"?\"0\":e}function C0(e){return e=Math.abs(e),1e-4<e&&e<1e7}function qN(e){return e=Math.abs(e),.001<e&&e<1e4}function of(e){return e=Math.abs(e),e=Math.max(e,1e-16),Math.max(3,Math.floor(4.5-Math.log(e)/Math.LN10))}function YN(e){return Math.abs(e)>=1e-20?parseFloat(e.toFixed(of(e))):e}function L0(e){return 1e6/Math.sqrt(Math.abs(e))}function w0(e){let t=L0(e);if(t<1||t>1e12)return!1;let{n:r,d:n}=qo(e,t);return n===1?!1:e===e+Math.pow(2,-3)*Math.abs(r/n-e)}function af(e,t){if(t=t||{},isNaN(e)||!isFinite(e))return{type:\"undefined\"};if(e===0||t.zeroCutoff&&Math.abs(e)<t.zeroCutoff)return{type:\"decimal\",value:\"0\"};let r=t.smallCutoff||.001,n=t.bigCutoff||1e6,i=t.digits||10,o=dg(e.toExponential(i-2)).match(/([\\d\\.\\-]+)e\\+?([\\d\\-]+)/);if(!o)return{type:\"undefined\"};let a=parseInt(o[2],10)>=i;if(w0(e)&&t.displayAsFraction){let c=qo(e,L0(e));return{type:\"fraction\",numerator:c.n.toString(),denominator:c.d.toString()}}else{if(Math.abs(e)>n||Math.abs(e)<r||a)return{type:\"scientific\",mantissa:o[1],exponent:o[2]};{let c=_0(e.toPrecision(i));return e!==Number(c)&&t.addEllipses&&(c+=\"...\"),{type:\"decimal\",value:c}}}}function XN(e,t){let r=af(e,t);switch(r.type){case\"undefined\":return\"undefined\";case\"decimal\":return r.value;case\"scientific\":return r.mantissa+\"<span class='dcg-cross'>\\xD7</span>10<sup>\"+r.exponent+\"</sup>\";case\"fraction\":return r.denominator===\"1\"?r.numerator:`${r.numerator}/${r.denominator}`;default:return r}}function mg(e,t){let r=af(e,t);switch(r.type){case\"undefined\":return\"undefined\";case\"decimal\":return r.value;case\"scientific\":return r.mantissa+\" * 10^\"+r.exponent;case\"fraction\":return r.denominator===\"1\"?r.numerator:`${r.numerator}/${r.denominator}`;default:return r}}function yg(e,t){let r=af(e,t);switch(r.type){case\"undefined\":return\"undefined\";case\"decimal\":return r.value;case\"scientific\":return r.mantissa+\"\\\\times10^{\"+r.exponent+\"}\";case\"fraction\":return r.denominator===\"1\"?r.numerator:r.numerator[0]===\"-\"?`-\\\\frac{${r.numerator.slice(1)}}{${r.denominator}}`:`\\\\frac{${r.numerator}}{${r.denominator}}`;default:return r}}function J(e){e=e.replace(\"\\\\\",\"\");let t={pi:\"\\u03C0\",tau:\"\\u03C4\",theta:\"\\u03B8\",phi:\"\\u03D5\",div:\"\\xF7\",cdot:\"\\u22C5\",times:\"\\xD7\",lt:\"<\",gt:\">\",le:\"\\u2264\",ge:\"\\u2265\",sim:\"\\u223C\",ldots:\"\\u2026\",prime:\"\\u2032\",approx:\"\\u2248\",to:\"\\u2192\",\"->\":\"\\u2192\"};return t.hasOwnProperty(e)?t[e]:e}function $N(e){if(!e)return\"\";let t=Zr(e[0]);return e[1]!==void 0&&(t+=\"\\\\left[\"+e[1]+\"\\\\right]\"),t}function Zr(e){let t=e.match(/^\\$(\\d+)$/);if(t)return`\\\\token{${t[1]}}`;let r=e.split(\"_\"),n=\"\";return r[0].length>1&&(n+=\"\\\\\"),n+=r[0],r[1]&&(n+=\"_{\"+r[1]+\"}\"),n}function ZN(e){if(!e)return\"\";let t=e.split(\"_\");t[0]=J(t[0]);let r=t.map(N0);return r[1]&&(r[1]=\"<sub>\"+r[1]+\"</sub>\"),r.join(\"\")}function po(e){let t=e.match(/\\\\token\\{(\\d+)\\}/);return t?`$${t[1]}`:(e=e.replace(/\\\\operatorname\\{(.*)\\}/,\"$1\"),e.replace(/[{}\\\\]/g,\"\"))}function fo(e){return e.replace(/^(\\\\ | |\\\\space)+/,\"\").replace(/(\\\\ | |\\\\space)+$/,\"\")}var gt=class extends Q{constructor(r){super([]);this._symbol=po(r),this._errorSymbol=this._symbol,this.addDependency(this._symbol)}setInputSpan(r){super.setInputSpan(r),this._errorSymbol=po(this.getInputString())}getInputSpan(){return this._inputSpan===void 0?Xn(this._symbol,0,this._symbol.length):this._inputSpan}};var St={};Ds(St,{Action:()=>Ot,Add:()=>Et,And:()=>Ft,BeginBroadcast:()=>et,BeginIntegral:()=>lt,BeginLoop:()=>st,BlockVar:()=>it,BroadcastResult:()=>Te,Constant:()=>k,DeferredListAccess:()=>rt,Distribution:()=>Pt,Divide:()=>zt,EndBroadcast:()=>Yt,EndIntegral:()=>Lt,EndLoop:()=>qt,Equal:()=>xt,Exponent:()=>ut,ExtendSeed:()=>$t,Greater:()=>wt,GreaterEqual:()=>At,InboundsListAccess:()=>mt,Less:()=>Nt,LessEqual:()=>vt,List:()=>tt,ListAccess:()=>pt,LoadArg:()=>ht,MAX_LEAF_OPCODE:()=>gg,Multiply:()=>bt,NativeFunction:()=>ke,Negative:()=>Ht,Noop:()=>dr,Or:()=>Xt,OrderedPair:()=>Mt,OrderedPairAccess:()=>Ut,OrderedTriple:()=>Dt,OrderedTripleAccess:()=>kt,Piecewise:()=>Ue,RawExponent:()=>ct,Subtract:()=>Gt,SymbolicVar:()=>Wr});var dr=0,k=1,ht=2,Wr=3,gg=3,Et=8,Gt=9,bt=10,zt=11,ut=12,ct=13,Ht=14,Mt=15,Dt=16,Ut=17,kt=18,st=19,qt=20,lt=21,Lt=22,et=23,Yt=24,xt=25,Nt=26,wt=27,vt=28,At=29,Xt=31,Ft=32,Ue=33,ke=37,tt=38,pt=39,rt=40,mt=41,Pt=42,$t=44,it=47,Te=48,Ot=49;function WN(e){switch(e){case\"default\":case\"trig\":case\"inverseTrig\":case\"trig2\":case\"never-broadcast\":return[P];case\"reducer\":return[te];case\"doubleReducer\":return[te,te];case\"parameterizedReducer\":return[te,P];case\"color\":return[P,P,P]}}function jN(e){switch(e){case\"default\":case\"trig\":case\"inverseTrig\":case\"trig2\":case\"doubleReducer\":case\"color\":case\"never-broadcast\":return!1;case\"reducer\":case\"parameterizedReducer\":return!0}}function JN(e,t,r){return e===\"reducer\"?1/0:t+r}function C(e,t,r){var l,p,f,y,h;let n=(l=r==null?void 0:r.tag)!=null?l:\"default\",i=(p=r==null?void 0:r.argumentTypes)!=null?p:WN(n),s=r!=null&&r.defaultArguments?r.defaultArguments.length:0,o=i.length-s,a=JN(n,o,s),u=(f=r==null?void 0:r.allowDotCall)!=null?f:jN(n),c=(y=r==null?void 0:r.noPeel)!=null?y:!1;return{module:e,symbol:t,argumentTypes:i,defaultArguments:r==null?void 0:r.defaultArguments,returnType:(h=r==null?void 0:r.returnType)!=null?h:P,tag:n,minArity:o,maxArity:a,allowDotCall:u,noPeel:c}}function Tg(e){if(!cr(e))throw new Error(\"Programming Error: numeric constants should be rational\");return{type:1,valueType:P,value:e}}var cu=Tg(Ce(0,1)),lu=Tg(Ce(1,1)),xg=Tg(Ce(1,2));function xa(e){let t;return e in Pr&&(t=Pr[e].tag),t===\"trig\"||t===\"trig2\"||t===\"inverseTrig\"?!0:e===\"angle\"||e===\"angles\"||e===\"directedangle\"||e===\"directedangles\"||e===\"rotate\"}var Pr={sin:C(\"BuiltIn\",\"sin\",{tag:\"trig\"}),cos:C(\"BuiltIn\",\"cos\",{tag:\"trig\"}),tan:C(\"BuiltIn\",\"tan\",{tag:\"trig\"}),cot:C(\"BuiltIn\",\"cot\",{tag:\"trig\"}),sec:C(\"BuiltIn\",\"sec\",{tag:\"trig\"}),csc:C(\"BuiltIn\",\"csc\",{tag:\"trig\"}),arcsin:C(\"Math\",\"asin\",{tag:\"inverseTrig\"}),arccos:C(\"Math\",\"acos\",{tag:\"inverseTrig\"}),arctan:C(\"Math\",\"atan2\",{argumentTypes:[P,P],defaultArguments:[lu],tag:\"inverseTrig\"}),arccot:C(\"BuiltIn\",\"acot\",{tag:\"inverseTrig\"}),arcsec:C(\"BuiltIn\",\"asec\",{tag:\"inverseTrig\"}),arccsc:C(\"BuiltIn\",\"acsc\",{tag:\"inverseTrig\"}),sinh:C(\"BuiltIn\",\"sinh\"),cosh:C(\"BuiltIn\",\"cosh\"),tanh:C(\"BuiltIn\",\"tanh\"),coth:C(\"BuiltIn\",\"coth\"),sech:C(\"BuiltIn\",\"sech\"),csch:C(\"BuiltIn\",\"csch\"),arcsinh:C(\"BuiltIn\",\"asinh\"),arccosh:C(\"BuiltIn\",\"acosh\"),arctanh:C(\"BuiltIn\",\"atanh\"),arccoth:C(\"BuiltIn\",\"acoth\"),arcsech:C(\"BuiltIn\",\"asech\"),arccsch:C(\"BuiltIn\",\"acsch\"),sqrt:C(\"Math\",\"sqrt\"),rtxsqpone:C(\"BuiltIn\",\"sqrtxsqp1\"),rtxsqmone:C(\"BuiltIn\",\"sqrtxsqm1\"),nthroot:C(\"BuiltIn\",\"nthroot\",{argumentTypes:[P,P]}),hypot:C(\"BuiltIn\",\"hypot\",{argumentTypes:[P,P]}),log:C(\"BuiltIn\",\"common_log\"),logbase:C(\"BuiltIn\",\"log_base\",{argumentTypes:[P,P]}),ln:C(\"BuiltIn\",\"log\"),exp:C(\"Math\",\"exp\"),floor:C(\"Math\",\"floor\"),ceil:C(\"Math\",\"ceil\"),round:C(\"Math\",\"round\"),abs:C(\"Math\",\"abs\"),sign:C(\"BuiltIn\",\"sign\"),mod:C(\"BuiltIn\",\"mod\",{argumentTypes:[P,P]}),nCr:C(\"BuiltIn\",\"nCr\",{argumentTypes:[P,P]}),nPr:C(\"BuiltIn\",\"nPr\",{argumentTypes:[P,P]}),factorial:C(\"BuiltIn\",\"factorial\"),polyGamma:C(\"BuiltIn\",\"polyGamma\",{argumentTypes:[P,P]}),lcm:C(\"BuiltIn\",\"listLCM\",{tag:\"reducer\"}),gcd:C(\"BuiltIn\",\"listGCD\",{tag:\"reducer\"}),distance:C(\"BuiltIn\",\"distance\",{argumentTypes:[N,N]}),polygon:C(\"BuiltIn\",\"polygon\",{tag:\"reducer\",argumentTypes:[nt],returnType:we}),area:C(\"BuiltIn\",\"polygonArea\",{argumentTypes:[we]}),perimeter:C(\"BuiltIn\",\"polygonPerimeter\",{argumentTypes:[we]}),pointDet:C(\"BuiltIn\",\"pointDet\",{argumentTypes:[N,N]}),pointDot:C(\"BuiltIn\",\"pointDot\",{argumentTypes:[N,N]}),pointPerp:C(\"BuiltIn\",\"pointPerp\",{argumentTypes:[N],returnType:N}),segment:C(\"BuiltIn\",\"segment\",{argumentTypes:[N,N],returnType:Oe}),line:C(\"BuiltIn\",\"line\",{argumentTypes:[N,N],returnType:ye}),ray:C(\"BuiltIn\",\"ray\",{argumentTypes:[N,N],returnType:_e}),vector:C(\"BuiltIn\",\"vector\",{argumentTypes:[N,N],returnType:ge}),vectorThreeD:C(\"BuiltIn\",\"vectorThreeD\",{argumentTypes:[G,G],returnType:Re}),mathVector:C(\"BuiltIn\",\"mathVector\",{argumentTypes:[N,N],returnType:ge}),mathVectorThreeD:C(\"BuiltIn\",\"mathVectorThreeD\",{argumentTypes:[G,G],returnType:Re}),vectorDisplacementAsPoint:C(\"BuiltIn\",\"vectorDisplacementAsPoint\",{argumentTypes:[ge],returnType:N}),vectorThreeDDisplacementAsPoint:C(\"BuiltIn\",\"vectorThreeDDisplacementAsPoint\",{argumentTypes:[Re],returnType:G}),basePointFromVector:C(\"BuiltIn\",\"basePointFromVector\",{argumentTypes:[ge],returnType:N}),basePointFromVectorThreeD:C(\"BuiltIn\",\"basePointFromVectorThreeD\",{argumentTypes:[Re],returnType:G}),circle:C(\"BuiltIn\",\"circle\",{argumentTypes:[N,P],returnType:de}),center:C(\"BuiltIn\",\"center\",{argumentTypes:[de],returnType:N,allowDotCall:!0}),radius:C(\"BuiltIn\",\"radius\",{argumentTypes:[de],returnType:P,allowDotCall:!0}),arc:C(\"BuiltIn\",\"arc\",{argumentTypes:[N,N,N],returnType:ue}),arcCenter:C(\"BuiltIn\",\"arcCenter\",{argumentTypes:[ue],returnType:N}),arcOmega:C(\"BuiltIn\",\"arcOmega\",{argumentTypes:[ue],returnType:P}),undirectedAngleMarker:C(\"BuiltIn\",\"undirectedAngleMarker\",{argumentTypes:[xe],returnType:Ae}),directedAngleMarker:C(\"BuiltIn\",\"directedAngleMarker\",{argumentTypes:[N,P,P,P],returnType:xe}),directedCoterminalAngle:C(\"BuiltIn\",\"directedCoterminalAngle\",{argumentTypes:[xe],returnType:xe}),undirectedCoterminalAngle:C(\"BuiltIn\",\"undirectedCoterminalAngle\",{argumentTypes:[Ae],returnType:Ae}),supplement:C(\"BuiltIn\",\"supplementAngle\",{argumentTypes:[xe],returnType:xe}),directedAngleMarkerRawDelta:C(\"BuiltIn\",\"angleMarkerRawDelta\",{argumentTypes:[xe],returnType:P}),undirectedAngleMarkerRawDelta:C(\"BuiltIn\",\"angleMarkerRawDelta\",{argumentTypes:[Ae],returnType:P}),directedAngleMarkerMultiplier:C(\"BuiltIn\",\"angleMarkerMultiplier\",{argumentTypes:[xe],returnType:P}),undirectedAngleMarkerMultiplier:C(\"BuiltIn\",\"angleMarkerMultiplier\",{argumentTypes:[Ae],returnType:P}),polygonInteriorUndirectedAngles:C(\"BuiltIn\",\"polygonInteriorUndirectedAngles\",{argumentTypes:[we,P],returnType:Jt,allowDotCall:!0,tag:\"never-broadcast\"}),polygonInteriorDirectedAngles:C(\"BuiltIn\",\"polygonInteriorDirectedAngles\",{argumentTypes:[we,P],returnType:Qt,allowDotCall:!0,tag:\"never-broadcast\"}),vertices:C(\"BuiltIn\",\"vertices\",{argumentTypes:[we],returnType:nt,allowDotCall:!0,tag:\"never-broadcast\"}),segments:C(\"BuiltIn\",\"polygonEdges\",{argumentTypes:[we],returnType:ur,allowDotCall:!0,tag:\"never-broadcast\"}),scaleTangentSegment:C(\"BuiltIn\",\"scaleTangentSegment\",{argumentTypes:[Oe,P],returnType:Oe}),scaleTangentLine:C(\"BuiltIn\",\"scaleTangentLine\",{argumentTypes:[ye,P],returnType:ye}),scaleTangentRay:C(\"BuiltIn\",\"scaleTangentRay\",{argumentTypes:[_e,P],returnType:_e}),scaleTangentCircle:C(\"BuiltIn\",\"scaleTangentCircle\",{argumentTypes:[de,P],returnType:de}),scaleTangentArc:C(\"BuiltIn\",\"scaleTangentArc\",{argumentTypes:[ue,P],returnType:de}),scaleTangentDirectedAngleMarker:C(\"BuiltIn\",\"scaleTangentAngle\",{argumentTypes:[xe,P],returnType:xe}),scaleTangentUndirectedAngleMarker:C(\"BuiltIn\",\"scaleTangentAngle\",{argumentTypes:[Ae,P],returnType:Ae}),addTangentSegment:C(\"BuiltIn\",\"addTangentSegment\",{argumentTypes:[Oe,Oe],returnType:Oe}),addTangentSegmentThreeD:C(\"BuiltIn\",\"addTangentSegmentThreeD\",{argumentTypes:[dt,dt],returnType:dt}),addTangentLine:C(\"BuiltIn\",\"addTangentLine\",{argumentTypes:[ye,ye],returnType:ye}),addTangentRay:C(\"BuiltIn\",\"addTangentRay\",{argumentTypes:[_e,_e],returnType:_e}),addTangentCircle:C(\"BuiltIn\",\"addTangentCircle\",{argumentTypes:[de,de],returnType:de}),addTangentArc:C(\"BuiltIn\",\"addTangentArc\",{argumentTypes:[ue,ue],returnType:ue}),addTangentDirectedAngleMarker:C(\"BuiltIn\",\"addTangentAngle\",{argumentTypes:[xe,xe],returnType:xe}),addTangentUndirectedAngleMarker:C(\"BuiltIn\",\"addTangentAngle\",{argumentTypes:[Ae,Ae],returnType:Ae}),segmentGlider:C(\"BuiltIn\",\"segmentGlider\",{argumentTypes:[Oe,P],returnType:N}),segmentThreeDGlider:C(\"BuiltIn\",\"segmentThreeDGlider\",{argumentTypes:[dt,P],returnType:G}),lineGlider:C(\"BuiltIn\",\"lineGlider\",{argumentTypes:[ye,P],returnType:N}),rayGlider:C(\"BuiltIn\",\"rayGlider\",{argumentTypes:[_e,P],returnType:N}),circleGlider:C(\"BuiltIn\",\"circleGlider\",{argumentTypes:[de,P],returnType:N}),arcGlider:C(\"BuiltIn\",\"arcGlider\",{argumentTypes:[ue,P],returnType:N}),polygonGlider:C(\"BuiltIn\",\"polygonGlider\",{argumentTypes:[we,P],returnType:N}),chooseNonIncidentPoint:C(\"BuiltIn\",\"chooseNonIncidentPoint\",{argumentTypes:[N,N,N],returnType:N}),circleCircleIntersection:C(\"BuiltIn\",\"circleCircleIntersection\",{argumentTypes:[de,de,P],returnType:N}),circleArcIntersection:C(\"BuiltIn\",\"circleArcIntersection\",{argumentTypes:[de,ue,P],returnType:N}),circleLineIntersection:C(\"BuiltIn\",\"circleLineIntersection\",{argumentTypes:[de,ye,P],returnType:N}),arcCircleIntersection:C(\"BuiltIn\",\"arcCircleIntersection\",{argumentTypes:[ue,de,P],returnType:N}),arcArcIntersection:C(\"BuiltIn\",\"arcArcIntersection\",{argumentTypes:[ue,ue,P],returnType:N}),arcLineIntersection:C(\"BuiltIn\",\"arcLineIntersection\",{argumentTypes:[ue,ye,P],returnType:N}),lineCircleIntersection:C(\"BuiltIn\",\"lineCircleIntersection\",{argumentTypes:[ye,de,P],returnType:N}),lineArcIntersection:C(\"BuiltIn\",\"lineArcIntersection\",{argumentTypes:[ye,ue,P],returnType:N}),lineLineIntersection:C(\"BuiltIn\",\"lineLineIntersection\",{argumentTypes:[ye,ye,P],returnType:N}),lineFromSegment:C(\"BuiltIn\",\"identity\",{argumentTypes:[Oe],returnType:ye}),lineFromRay:C(\"BuiltIn\",\"identity\",{argumentTypes:[_e],returnType:ye}),parallel:C(\"BuiltIn\",\"parallel\",{argumentTypes:[ye,N],returnType:ye}),perpendicular:C(\"BuiltIn\",\"perpendicular\",{argumentTypes:[ye,N],returnType:ye}),translation:C(\"BuiltIn\",\"translation\",{argumentTypes:[N],returnType:He}),dilation:C(\"BuiltIn\",\"dilation\",{argumentTypes:[N,P],returnType:He}),rotation:C(\"BuiltIn\",\"rotation\",{tag:\"trig2\",argumentTypes:[N,P],returnType:He}),reflection:C(\"BuiltIn\",\"reflection\",{argumentTypes:[ye],returnType:He}),compose:C(\"BuiltIn\",\"composeTransformation\",{argumentTypes:[He,He],returnType:He}),inverse:C(\"BuiltIn\",\"invertTransformation\",{argumentTypes:[He],returnType:He}),transformPoint:C(\"BuiltIn\",\"transformPoint\",{argumentTypes:[He,N],returnType:N}),transformSegment:C(\"BuiltIn\",\"transformSegment\",{argumentTypes:[He,Oe],returnType:Oe}),transformLine:C(\"BuiltIn\",\"transformLine\",{argumentTypes:[He,ye],returnType:ye}),transformRay:C(\"BuiltIn\",\"transformRay\",{argumentTypes:[He,_e],returnType:_e}),transformVector:C(\"BuiltIn\",\"transformVector\",{argumentTypes:[He,ge],returnType:ge}),transformCircle:C(\"BuiltIn\",\"transformCircle\",{argumentTypes:[He,de],returnType:de}),transformArc:C(\"BuiltIn\",\"transformArc\",{argumentTypes:[He,ue],returnType:ue}),transformPolygon:C(\"BuiltIn\",\"transformPolygon\",{argumentTypes:[He,we],returnType:we}),transformAngleMarker:C(\"BuiltIn\",\"transformAngleMarker\",{argumentTypes:[He,Ae],returnType:Ae}),transformDirectedAngleMarker:C(\"BuiltIn\",\"transformAngleMarker\",{argumentTypes:[He,xe],returnType:xe}),distanceThreeD:C(\"BuiltIn\",\"distanceThreeD\",{argumentTypes:[G,G]}),segmentThreeD:C(\"BuiltIn\",\"segmentThreeD\",{argumentTypes:[G,G],returnType:dt}),triangle:C(\"BuiltIn\",\"triangle\",{argumentTypes:[G,G,G],returnType:xr}),sphere:C(\"BuiltIn\",\"sphere\",{argumentTypes:[G,P],returnType:_r}),mean:C(\"BuiltIn\",\"mean\",{tag:\"reducer\"}),total:C(\"BuiltIn\",\"total\",{tag:\"reducer\"}),stdev:C(\"BuiltIn\",\"stdev\",{tag:\"reducer\"}),stdevp:C(\"BuiltIn\",\"stdevp\",{tag:\"reducer\"}),mad:C(\"BuiltIn\",\"mad\",{tag:\"reducer\"}),count:C(\"BuiltIn\",\"listLength\",{tag:\"reducer\",argumentTypes:[Bt],noPeel:!0}),min:C(\"BuiltIn\",\"listMin\",{tag:\"reducer\"}),max:C(\"BuiltIn\",\"listMax\",{tag:\"reducer\"}),argmin:C(\"BuiltIn\",\"argMin\",{tag:\"reducer\",noPeel:!0}),argmax:C(\"BuiltIn\",\"argMax\",{tag:\"reducer\",noPeel:!0}),median:C(\"BuiltIn\",\"median\",{tag:\"reducer\"}),var:C(\"BuiltIn\",\"variance\",{tag:\"reducer\"}),varp:C(\"BuiltIn\",\"varp\",{tag:\"reducer\"}),cov:C(\"BuiltIn\",\"cov\",{tag:\"doubleReducer\"}),covp:C(\"BuiltIn\",\"covp\",{tag:\"doubleReducer\"}),corr:C(\"BuiltIn\",\"corr\",{tag:\"doubleReducer\"}),spearman:C(\"BuiltIn\",\"spearman\",{tag:\"doubleReducer\"}),quantile:C(\"BuiltIn\",\"quantile\",{tag:\"parameterizedReducer\"}),quartile:C(\"BuiltIn\",\"quartile\",{tag:\"parameterizedReducer\"}),upperQuantileIndex:C(\"BuiltIn\",\"upperQuantileIndex\",{tag:\"parameterizedReducer\"}),lowerQuantileIndex:C(\"BuiltIn\",\"lowerQuantileIndex\",{tag:\"parameterizedReducer\"}),quartileIndex:C(\"BuiltIn\",\"quartileIndex\",{tag:\"parameterizedReducer\"}),upperQuartileIndex:C(\"BuiltIn\",\"upperQuartileIndex\",{tag:\"parameterizedReducer\"}),lowerQuartileIndex:C(\"BuiltIn\",\"lowerQuartileIndex\",{tag:\"parameterizedReducer\"}),normalcdf:C(\"BuiltIn\",\"normalcdf\",{argumentTypes:[P,P,P,P],defaultArguments:[cu,lu]}),normalpdf:C(\"BuiltIn\",\"normalpdf\",{argumentTypes:[P,P,P],defaultArguments:[cu,lu]}),binomcdf:C(\"BuiltIn\",\"binomcdf\",{argumentTypes:[P,P,P,P],defaultArguments:[xg]}),binompdf:C(\"BuiltIn\",\"binompdf\",{argumentTypes:[P,P,P],defaultArguments:[xg]}),poissoncdf:C(\"BuiltIn\",\"poissoncdf\",{argumentTypes:[P,P,P]}),poissonpdf:C(\"BuiltIn\",\"poissonpdf\",{argumentTypes:[P,P,P]}),uniformcdf:C(\"BuiltIn\",\"uniformcdf\",{argumentTypes:[P,P,P,P],defaultArguments:[cu,lu]}),uniformpdf:C(\"BuiltIn\",\"uniformpdf\",{argumentTypes:[P,P,P],defaultArguments:[cu,lu]}),invT:C(\"BuiltIn\",\"invT\",{argumentTypes:[P,P]}),invPoisson:C(\"BuiltIn\",\"invPoisson\",{argumentTypes:[P,P]}),invBinom:C(\"BuiltIn\",\"invBinom\",{argumentTypes:[P,P,P]}),invUniform:C(\"BuiltIn\",\"invUniform\",{argumentTypes:[P,P,P]}),tpdf:C(\"BuiltIn\",\"tpdf\",{argumentTypes:[P,P]}),tcdf:C(\"BuiltIn\",\"tcdf\",{argumentTypes:[P,P,P]}),erf:C(\"BuiltIn\",\"erf\"),invNorm:C(\"BuiltIn\",\"invNorm\"),tscore:C(\"BuiltIn\",\"tscore\",{tag:\"parameterizedReducer\",defaultArguments:[cu]}),normalSample:C(\"BuiltIn\",\"normalSample\",{argumentTypes:[Qe,P,P]}),uniformSample:C(\"BuiltIn\",\"uniformSample\",{argumentTypes:[Qe,P,P]}),tSample:C(\"BuiltIn\",\"tSample\",{argumentTypes:[Qe,P]}),poissonSample:C(\"BuiltIn\",\"poissonSample\",{argumentTypes:[Qe,P]}),binomSample:C(\"BuiltIn\",\"binomSample\",{argumentTypes:[Qe,P,P]}),rgb:C(\"BuiltIn\",\"rgb\",{returnType:It,tag:\"color\"}),hsv:C(\"BuiltIn\",\"hsv\",{returnType:It,tag:\"color\"}),validateRangeLength:C(\"BuiltIn\",\"validateRangeLength\",{returnType:P,argumentTypes:[te,te,P,P],tag:\"never-broadcast\",noPeel:!0}),validateSampleCount:C(\"BuiltIn\",\"validateSampleCount\",{returnType:P,argumentTypes:[P]}),select:C(\"BuiltIn\",\"select\",{argumentTypes:[Bt,zr],returnType:e=>e[0],tag:\"never-broadcast\",noPeel:!0}),shuffle:C(\"BuiltIn\",\"shuffle\",{argumentTypes:[Qe,Bt],returnType:e=>e[1],tag:\"never-broadcast\"}),sortPerm:C(\"BuiltIn\",\"sortPerm\",{argumentTypes:[te],returnType:te,tag:\"never-broadcast\",noPeel:!0}),elementsAt:C(\"BuiltIn\",\"elementsAt\",{argumentTypes:[Bt,te],returnType:e=>e[0],tag:\"never-broadcast\",noPeel:!0}),uniquePerm:C(\"BuiltIn\",\"uniquePerm\",{argumentTypes:[Bt],returnType:te,tag:\"never-broadcast\",noPeel:!0})};function Ve(e,t){var h,m,b,d,g;let r=t==null?void 0:t.defaultArguments,n=1/0,i=0,s=(h=r==null?void 0:r.length)!=null?h:0;t!=null&&t.noBroadcast||(e=e.map(_n));for(let x of e){let M=ya(x)-s;M<n&&(n=M);let E=tl(x);E>i&&(i=E)}let o=(m=t==null?void 0:t.fallthroughUnlessDistribution)!=null?m:!1,a=(b=t==null?void 0:t.allowDotCall)!=null?b:!1,u=(d=t==null?void 0:t.isSeeded)!=null?d:!1,c=t==null?void 0:t.minArityExampleArgs,l=t==null?void 0:t.maxArityExampleArgs,p=t==null?void 0:t.dotMinArityExampleArgs,f=t==null?void 0:t.dotMaxArityExampleArgs,y=(g=t==null?void 0:t.noPeel)!=null?g:!1;return{minArity:n,argumentTypes:e,maxArity:i,defaultArguments:r,fallthroughUnlessDistribution:o,minArityExampleArgs:c,maxArityExampleArgs:l,dotMinArityExampleArgs:p,dotMaxArityExampleArgs:f,allowDotCall:a,isSeeded:u,noPeel:y}}function _s(){return Ve([{type:\"variadic\",initial:[],rest:Tt}],{})}var uf={meta:\"union\",types:[Oe,de,ye,_e,ue]},hg={meta:\"union\",types:[Oe,ye,_e,ge]},pc={meta:\"union\",types:[N,Oe,de,ye,_e,ge,ue,we,Ae,xe,He]},bg={meta:\"union\",types:[...is.filter(e=>e!==ar),Ke]},Ls={midpoint:Ve([[N,N],[G,G],[Oe],[dt]],{allowDotCall:!0}),segment:Ve([[N,N],[G,G]]),vector:Ve([[N,N],[G,G]]),distance:Ve([[N,N],[G,G]]),glider:Ve([[{meta:\"union\",types:[Oe,de,ye,_e,ue,we]},P]]),circle:Ve([[N,Oe],[N,N],[N,P]],{}),center:Ve([[de],[ue]],{allowDotCall:!0}),radius:Ve([[de],[ue]],{allowDotCall:!0}),intersection:Ve([[uf,uf]]),strictintersection:Ve([[uf,uf]]),parallel:Ve([[hg,N]]),perpendicular:Ve([[hg,N]]),start:Ve([[ge],[Re]],{allowDotCall:!0}),end:Ve([[ge],[Re]],{allowDotCall:!0}),length:Ve([[{meta:\"union\",types:is}],_n([dt]),_n([Re]),_n([Oe]),_n([ue]),{type:\"variadic\",initial:[Tt],rest:Tt}],{allowDotCall:!0,noBroadcast:!0,noPeel:!0}),translate:Ve([[pc,ge],[pc,N,N]]),dilate:Ve([[pc,N,P]]),rotate:Ve([[pc,N,P]]),reflect:Ve([[pc,hg]]),apply:Ve([[He,pc]]),points:Ve([]),lines:Ve([]),circles:Ve([]),arcs:Ve([]),polygons:Ve([]),rays:Ve([]),vectors:Ve([]),angle:Ve([[N,N,N]]),directedangle:Ve([[N,N,N]]),angles:Ve([[we]],{allowDotCall:!0}),directedangles:Ve([[we]],{allowDotCall:!0}),coterminal:Ve([[Ae],[xe]]),round:Ve([[P],[P,P]]),sort:Ve([[te],[{meta:\"union\",types:is},te]],{minArityExampleArgs:\"([3,2,1])\",maxArityExampleArgs:\"([1,2,3],[3,2,1])\",dotMaxArityExampleArgs:\"([3,4])\",allowDotCall:!0}),shuffle:Ve([[Qe,{meta:\"union\",types:is}],[Qe,{meta:\"union\",types:is},P]],{minArityExampleArgs:\"([1,2,3])\",maxArityExampleArgs:\"([1,2,3],2)\",dotMaxArityExampleArgs:\"(2)\",allowDotCall:!0,isSeeded:!0,noBroadcast:!0}),join:Ve([{type:\"variadic\",initial:[Tt,Tt],rest:Tt}],{minArityExampleArgs:\"([1,2],[3,4])\",dotMinArityExampleArgs:\"([3,4])\",allowDotCall:!0}),unique:Ve([[{meta:\"union\",types:is.filter(e=>e!==ar&&e!==Bt)}]],{minArityExampleArgs:\"([1,2,3])\",maxArityExampleArgs:\"([1,2,3])\",allowDotCall:!0}),normaldist:Ve([[P,P]],{defaultArguments:[cu,lu]}),tdist:Ve([[P]]),binomialdist:Ve([[P,P]],{defaultArguments:[xg]}),poissondist:Ve([[P]]),uniformdist:Ve([[P,P]],{defaultArguments:[cu,lu]}),pdf:Ve([[Ke,P]],{allowDotCall:!0}),cdf:Ve([[Ke,P],[Ke,P,P]],{allowDotCall:!0}),median:Ve([[Ke]],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),stdev:Ve([[Ke]],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),var:Ve([[Ke]],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),quantile:Ve([[Ke,P]],{fallthroughUnlessDistribution:!0,allowDotCall:!0,minArityExampleArgs:\"([1,2,3], 1)\",maxArityExampleArgs:\"([1,2,3], 1)\",dotMinArityExampleArgs:\"(x)\",dotMaxArityExampleArgs:\"(x)\"}),random:Ve([[Qe],[Qe,P],[Qe,P,P],[Qe,bg],[Qe,bg,P],[Qe,bg,P,P]],{allowDotCall:!0,isSeeded:!0,noBroadcast:!0}),polygon:Ve([{type:\"variadic\",initial:[],rest:N},[nt],[te,te],[P,te],[te,P]]),total:Ve([P,N,G].map(Pg),{allowDotCall:!0}),mean:Ve([[Ke],...[P,N,G].map(Pg)],{allowDotCall:!0}),histogram:_s(),dotplot:_s(),boxplot:_s(),ttest:_s(),ittest:_s(),stats:_s(),det:_s(),inv:_s(),transpose:_s(),rref:_s(),trace:_s()};function fc(e){return!!Ls[e]}function pl(e){return!!Pr[e]}function fl(e){let t=fc(e)?Ls[e]:void 0;if(!t&&!pl(e))return;let r=[];return t&&(r=[...t.argumentTypes]),pl(e)&&(!t||t.fallthroughUnlessDistribution)&&r.push(...Ig(e)),r}function Pg(e){return _n({type:\"variadic\",initial:[e],rest:e})}function Ig(e){let t=[],r=Pr[e];switch(r.tag){case\"reducer\":{if(Array.isArray(r.argumentTypes)&&typeof r.argumentTypes[0]==\"number\"&&j(r.argumentTypes[0])){let n=r.argumentTypes[0],i=$e(n);t.push(Pg(i))}else throw new Error(`Programming error: declared argumentTypes for built-in function ${e} is not consistent with \"reducer\"`);break}case\"parameterizedReducer\":{t.push(r.argumentTypes),Array.isArray(r.argumentTypes)&&r.argumentTypes.length===2&&t.push([r.argumentTypes[0],iu(r.argumentTypes[1])]);break}case\"doubleReducer\":case\"never-broadcast\":{t.push(r.argumentTypes);break}default:{t.push(_n(r.argumentTypes));break}}return t}var Lr=class extends Q{constructor(r,n){super(n,{skipRegisterDependencies:!0});typeof r==\"string\"&&(r=new gt(r)),this._identifier=r,this._symbol=r._symbol,this._errorSymbol=r._errorSymbol===\"logbase\"?\"log\":r._errorSymbol,this.registerDependencies()}registerDependencies(){this.addDependency(this._symbol),super.registerDependencies(),xa(this._symbol)&&this.addDependency(\"trigAngleMultiplier\")}copyWithArgs(r){return new this.constructor(new gt(this._symbol),r)}};var os=class extends Q{};var cf={pi:new fr(Math.PI),tau:new fr(2*Math.PI),e:new fr(Math.E),trigAngleMultiplier:new fr(Ce(1,1)),infty:new fr(1/0),identityTransformation:new Lr(\"translation\",[new os([new fr(0),new fr(0)])])};var lf=class extends yt{constructor(){super(...arguments);this.isFunction=!0}},mo,Xe={};for(mo in cf)cf.hasOwnProperty(mo)&&(Xe[mo]=cf[mo]);for(mo in Pr)Pr.hasOwnProperty(mo)&&(Xe[mo]=new lf);for(mo in Ls)Ls.hasOwnProperty(mo)&&(Xe[mo]=new lf);function KN(e){var t={};return e.additionalFunctions&&e.additionalFunctions.indexOf(\"sqrt\")!==-1&&(t.sqrt=Xe.sqrt),e.width&&(t.width=e.width),e.height&&(t.height=e.height),t}var Eg={};Ds(Eg,{getFrame:()=>eA});var F0=[\"pi\",\"e\",\"trigAngleMultiplier\"],V0=[\"sqrt\",\"nthroot\",\"abs\",\"ln\",\"sin\",\"cos\",\"tan\",\"log\",\"arcsin\",\"arccos\",\"arctan\",\"mean\",\"round\",\"stdev\",\"stdevp\",\"nCr\",\"nPr\",\"exp\",\"factorial\"];function B0(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(!t.hasOwnProperty(n))throw new Error(\"Programming Error: key '\"+n+`' does not exist in table. Must be one of:\n`+Object.keys(t).join(`\n`))}}B0(F0,Xe);B0(V0,Xe);function eA(e){var t={};return F0.forEach(function(r){t[r]=Xe[r]}),V0.forEach(function(r){e.replaceRoundWithReciprocal&&r===\"round\"||(t[r]=Xe[r])}),e.trigAngleMultiplier&&(t.trigAngleMultiplier=e.trigAngleMultiplier),e.width&&(t.width=e.width),e.height&&(t.height=e.height),t}var Mg={};Ds(Mg,{getFrame:()=>tA});var G0=[\"pi\",\"e\",\"trigAngleMultiplier\"],z0=[\"sqrt\",\"nthroot\",\"abs\",\"ln\",\"sin\",\"cos\",\"tan\",\"log\",\"arcsin\",\"arccos\",\"arctan\",\"exp\",\"factorial\"];function H0(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(!t.hasOwnProperty(n))throw new Error(\"Programming Error: key '\"+n+`' does not exist in table. Must be one of:\n`+Object.keys(t).join(`\n`))}}H0(G0,Xe);H0(z0,Xe);function tA(e){var t={};return G0.forEach(function(r){t[r]=Xe[r]}),z0.forEach(function(r){t[r]=Xe[r]}),e.trigAngleMultiplier&&(t.trigAngleMultiplier=e.trigAngleMultiplier),e.width&&(t.width=e.width),e.height&&(t.height=e.height),t}var dl={};Ds(dl,{getFrame:()=>sA});var U0={segment:!0,line:!0,ray:!0,circle:!0,arc:!0,vector:!0,glider:!0,parallel:!0,perpendicular:!0,center:!0,radius:!0,area:!0,perimeter:!0,start:!0,end:!0,angles:!0,angle:!0,directedangles:!0,directedangle:!0,coterminal:!0,supplement:!0,vertices:!0,segments:!0,intersection:!0,translate:!0,dilate:!0,rotate:!0,reflect:!0,construction:!0,points:!0,lines:!0,circles:!0,arcs:!0,polygons:!0,rays:!0};var k0={segment:!0,triangle:!0,vector:!0,start:!0,end:!0,sphere:!0};var q0=[\"csc\",\"sec\",\"cot\",\"arccsc\",\"arcsec\",\"arccot\",\"csch\",\"sech\",\"coth\",\"arccsch\",\"arcsech\",\"arccoth\",\"mad\",\"cov\",\"covp\",\"distance\",\"midpoint\"],Y0=[\"histogram\",\"dotplot\",\"boxplot\"],rA=[...Y0,\"polygon\"],X0=[\"erf\",\"ttest\",\"tscore\",\"ittest\",\"normaldist\",\"tdist\",\"poissondist\",\"binomialdist\",\"pdf\",\"cdf\",\"random\",...Y0],nA=[\"distance\",\"midpoint\"],iA=[\"det\",\"inv\",\"transpose\",\"rref\",\"trace\"],$0=Object.keys(U0).filter(function(e){return e!==\"construction\"});function Dg(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(!t.hasOwnProperty(n))throw new Error(\"Programming Error: key '\"+n+`' does not exist in table. Must be one of:\n`+Object.keys(t).join(`\n`))}}Dg(q0,Xe);Dg(X0,Xe);Dg($0,Xe);function sA(e){var t={},r;for(r in Xe){if(!Xe.hasOwnProperty(r)||e.restrictedFunctions===!0&&q0.indexOf(r)!==-1&&!(e.forceEnableGeometryFunctions===!0&&nA.indexOf(r)!==-1)||e.distributions===!1&&X0.indexOf(r)!==-1)continue;let n=$0.indexOf(r)!==-1,i=r in k0;if(n&&i){if(!(e.isGeometryCalculator||e.is3DCalculator))continue}else if(n){if(!e.isGeometryCalculator)continue}else if(i){if(!e.is3DCalculator)continue}else if(rA.indexOf(r)!==-1&&e.is3DCalculator)continue;iA.indexOf(r)===-1&&(t[r]=Xe[r])}return e.trigAngleMultiplier&&(t.trigAngleMultiplier=e.trigAngleMultiplier),e.globalRandomSeed&&(t.globalRandomSeed=e.globalRandomSeed),e.initialEvaluation&&(t.initialEvaluation=e.initialEvaluation),e.globalEventCount&&(t.globalEventCount=e.globalEventCount),e.width&&(t.width=e.width),e.height&&(t.height=e.height),t}var _R={};Ds(_R,{parse:()=>ys,setInput:()=>_v});function Z0(e){let t=function(...i){return new e(...i)};t.prototype=e.prototype;var r=Object.getOwnPropertyNames(e);for(var n of r){let i=e[n];if(typeof i==\"function\")try{t[n]=i}catch(s){}}return t}var R=class extends yt{constructor(r){super();this.isError=!0;this._msg=r,this.blocksExport=!0}evaluateOnce(r){return this._msg}getError(){return this._msg}setDependencies(r){return this.addDependencies(r),this}setActionValue(r){this.actionValue=r}allowExport(){return this.blocksExport=!1,this}setCursorContext(r){this.cursorContext=r}getCursorContext(){return this.cursorContext}};var ff=class extends fr{constructor(){super(...arguments);this.is_mixed_number=!0}};var df=class extends gt{};function oA(e){for(var t=1/0,r=0;r<e.length;r++)(e[r].isList||e[r].isBroadcast)&&(t=Math.min(t,e[r].length));return t}var ml=class ml extends Q{constructor(r){super(r);this.isList=!0;this.length=r.length}asValue(){for(var r=[],n=0;n<this.args.length;n++)r.push(this.args[n].asValue());return r}asCompilerValue(){for(var r=[],n=0;n<this.args.length;n++)r.push(this.args[n].asCompilerValue());return r}getEvaluationInfo(){if(this.args.every(function(r){return r.isConstant}))return[{val:this.args.map(function(r){return r.asValue()})}]}};ml.eachArgs=function(r,n){var i=oA(r);if(!isFinite(i)){n(r);return}for(var s=0;s<i;s++){for(var o=[],a=0;a<r.length;a++)o.push(r[a].isList||j(r[a].valueType)?r[a].elementAt(s):r[a]);n(o,s)}},ml.wrap=function(r){return r.isList||j(r.valueType)?r:new ml([r])};var Pa=ml;var mf=class extends Q{constructor(r){super(r);this.beginning=r[0],this.end=r[1]}isHalfEmpty(){return this.end&&this.end.args&&this.end.args.length===0}};var dc=class extends Q{constructor(r){super(r);this.list=r[0],this.index=r[1]}};var Hi=class extends Q{registerDependencies(){if(super.registerDependencies(),this.args[1].type===\"Identifier\"){var t=this.args[1]._symbol;xa(t)&&this.addDependency(\"trigAngleMultiplier\")}}};var yf=class extends Q{constructor(t){var r=t.map(function(n){return new gt(\"\\\\idref_{\"+n+\"}\")});super(r),this._exports.push(\"construction\")}};var gf=class extends os{constructor(r,n,i){super(r);this.isTypedConstant=!0;this.isMovablePoint=!0;this.moveStrategy=n,this.defaultDragMode=i,this.valueType=N}asValue(){return[+this.args[0].asValue(),+this.args[1].asValue()]}asTypedValue(){return{valueType:this.valueType,value:this.asValue()}}asCompilerValue(){return[this.args[0].asCompilerValue(),this.args[1].asCompilerValue()]}};var hf=class e extends Q{constructor(r,n){super(n);this.symbol=r}copyWithArgs(r){return new e(this.symbol,r)}};var mc=class extends Q{};var bf=class extends Q{};var as=class extends Q{};var wn={\"<\":{inclusive:!1,direction:-1},\"!=\":{inclusive:!1,direction:0},\">\":{inclusive:!1,direction:1},\"<=\":{inclusive:!0,direction:-1},\"=\":{inclusive:!0,direction:0},\">=\":{inclusive:!0,direction:1}};function pu(e,t){switch(t){case-1:return e?\"<=\":\"<\";case 0:return e?\"=\":\"!=\";case 1:return e?\">=\":\">\";default:throw\"Programming error.  Comparators must have a direction of -1, 0, or 1\"}}var yo=class e extends Q{constructor(r){super(r);this._difference=wn[this.operator].direction===-1?new as([r[1],r[0]]):new as([r[0],r[1]])}static create(r){class n extends e{}return n.prototype.operator=r,n}asComparator(){return this}isInequality(){return wn[this.operator].direction!==0}};var go={\"<\":yo.create(\"<\"),\">\":yo.create(\">\"),\"<=\":yo.create(\"<=\"),\">=\":yo.create(\">=\"),\"=\":yo.create(\"=\")};var Pf=class extends yt{constructor(r){super();let[n,i,s,o,a]=r;this.args=r,this._symbol=s._symbol,this._operators=[i,o],this._expressions=[n,a];var u=pu(wn[i].inclusive&&wn[r[3]].inclusive,wn[r[1]].direction);this._indicator=new go[u]([r[0],r[4]]),this.addDependency(this._symbol),this.mergeDependencies(this._expressions[0],this._expressions[1])}isInequality(){return!0}isShadeBetween(){return!0}};var Ta=class extends Q{constructor(r){super(r,{skipRegisterDependencies:!0});this._index=r[0],this.registerDependencies()}registerDependencies(){for(let r=1;r<=3;r++)this.mergeDependenciesInScope(this.type,[this._index._symbol],this.args[r])}};var Tf=class extends Ta{constructor(){super(...arguments);this.in_place_operator=\"+=\";this.starting_value=0}evaluateConstant(r){var n=1+Math.round(r[1])-Math.round(r[0]);return n<=0?this.starting_value:n*r[2]}update(r,n){return r+n}};var If=class extends Ta{constructor(){super(...arguments);this.in_place_operator=\"*=\";this.starting_value=1}evaluateConstant(r){var n=1+Math.round(r[1])-Math.round(r[0]);return n<=0?this.starting_value:Math.pow(r[2],n)}update(r,n){return r*n}};var Ef=class extends Q{constructor(r){super(r,{skipRegisterDependencies:!0});this._differential=r[0],this.registerDependencies()}registerDependencies(){for(let r=1;r<=3;r++)this.mergeDependenciesInScope(this.type,[this._differential._symbol],this.args[r])}};var Mf=class extends Q{constructor(t){super(t),this._symbol=t[0]._symbol}};var Df=class extends Q{constructor(r,n,i){super([r,n].concat(i),{skipRegisterDependencies:!0});this._index=r,this._body=n,this._inputLists=i,this.registerDependencies()}registerDependencies(){var r=[];r.push(this._index._symbol);for(let n of this._inputLists){let i=n._symbol;r.push(i)}for(let n of this._inputLists)this.mergeDependenciesInScope(this.type,r,n.args[1]);this.mergeDependenciesInScope(this.type,r,this._body)}};var fu=class extends Lr{constructor(r,n){super(r,n);this.seed=n[0]}};var vf=class extends Q{registerDependencies(){if(super.registerDependencies(),this.args[0].type===\"Identifier\"){var t=this.args[0]._symbol;xa(t)&&this.addDependency(\"trigAngleMultiplier\")}}};var Of=class extends Q{registerDependencies(){if(this.addDependency(\"factorial\"),super.registerDependencies(),this.args[0].type===\"Identifier\"){var t=this.args[0]._symbol;xa(t)&&this.addDependency(\"trigAngleMultiplier\")}}};var Sf=class extends Q{constructor(r,n){super(n);this.order=r}copyWithArgs(r){return new this.constructor(this.order,r)}};var Zo=class e extends Q{static empty(){return new e([new fr(!0),new fr(Ce(1,1)),new fr(NaN)])}};var Rf=class extends Q{constructor(r,n){super(n);r instanceof gt?this._symbol=r._symbol:this._symbol=new gt(r)._symbol,this.addDependency(this._symbol)}};var Nf=class extends Q{constructor(r){super(r,{skipRegisterDependencies:!0});this._symbol=r[0]._symbol,this._expression=r[1],this.registerDependencies()}registerDependencies(){this.addUpdateSymbol(this._symbol),this.mergeDependencies(this._expression)}};var Af=class extends Q{constructor(r,n){super([r].concat(n),{skipRegisterDependencies:!0});this._body=r,this._assignments=n,this.registerDependencies()}registerDependencies(){for(var r=[],n=0;n<this._assignments.length;n++){var i=this._assignments[n],s=i._symbol;this.addSubstitutionSymbol(s),r.push(s);var o=i.args[1];this.mergeDependencies(o),this.addSubstitutionDependencies(o.getDependencies())}this.mergeDependenciesInScope(this.type,r,this._body)}};var Cf=class extends Q{constructor(t){super(t),this._symbol=\"histogram\"}};var _f=class extends Q{constructor(t){super(t),this._symbol=\"dotplot\"}};var Lf=class extends Q{constructor(t){super(t),this._symbol=\"boxplot\"}};var wf=class extends Q{constructor(t){super(t),this._symbol=\"ttest\"}};var Ff=class extends Q{constructor(t){super(t),this._symbol=\"ittest\"}};var Vf=class extends Q{constructor(t){super(t),this._symbol=\"stats\"}};var ho=class extends yt{constructor(r,n){super();this.mergeDependencies(r,n),this._lhs=r,this._rhs=n,this._difference=new as([this._lhs,this._rhs])}asComparator(){return new go[\"=\"]([this._lhs,this._rhs])}};var Wo=class extends yt{constructor(r,n){super();r instanceof gt?this._symbol=r._symbol:this._symbol=r,this.mergeDependencies(n),this._expression=n,this._exports=this.computeExports()}shouldExportAns(){return!0}computeExports(){for(var r=this._symbol,n=this.getDependencies(),i=0;i<n.length;i++)if(n[i]===r)return[];return[r]}isEquation(r,n){let i=this._symbol,s=i===\"x\"||i===\"y\",o=i===\"r\"||i===\"z\",a=this.getDependencies(),u=this.graphmodeDependencies(r,n);return o||s&&a.includes(\"z\")?u.includes(i):a.includes(i)}asEquation(){var r=new ho(new gt(this._symbol),this._expression);return r.userData=this.userData,r.metaData=this.metaData,r}shouldPromoteToSlider(r){if(!this._expression.isConstant||this._expression.is_mixed_number)return!1;let n=this._expression.asValue();return typeof n!=\"number\"||!isFinite(n)?!1:r.isValidSlider(this._symbol)}};var Bf=class extends yt{constructor(r,n){super();this._symbols=r.args.map(i=>i._symbol),this._expression=n,this._concatenatedSymbol=this._symbols.join(\"\"),this.mergeDependencies(n)}asEquation(){let r=new ho(new os(this._symbols.map(n=>new gt(n))),this._expression);return r.userData=this.userData,r.metaData=this.metaData,r}};var er={};Ds(er,{actionMergeFreeVariable:()=>ch,addArgumentsToDefinition:()=>Cl,addTypeError:()=>Rg,adjacentMixedNumber:()=>Kf,adjacentNumbers:()=>Nh,andTypeError:()=>Hf,ansUndefined:()=>$b,assignmentsUnsupported:()=>Bl,badEqualitySlice:()=>us,badImplicitCall:()=>Qf,badIntegralBoundDependency:()=>qb,badListComprehensionInputDependency:()=>Qb,badLogExponent:()=>Wh,badProductBoundDependency:()=>wb,badSampleSize:()=>Xb,badSumBoundDependency:()=>Lb,badSymbolContext:()=>Fl,badTrigExponent:()=>Zh,badTupleDimensions:()=>Rh,binaryOperatorMissingOperand:()=>Rl,blankExpression:()=>Nl,boxplotBreadthInvalid:()=>hh,boxplotOffsetInvalid:()=>gh,cannotAssignColor:()=>yb,cannotRedefine:()=>bc,cannotRestrict:()=>mb,cannotRestrictWithEquality:()=>gb,cannotSubscript:()=>Kh,cdfMaxInvalid:()=>fb,cdfMaxLessThanMin:()=>db,cdfMinInvalid:()=>pb,cdfRequiresArguments:()=>xh,cdfTooManyArguments:()=>Ph,clickableObjectAlreadyAssigned:()=>mA,clickableObjectAssignmentNotDefined:()=>dA,clickableObjectAssignmentNotIdentifier:()=>yA,clickableObjectInvalidExpression:()=>gA,colonMissingCondition:()=>Qh,colorArity:()=>Mh,combineTypeError:()=>Xf,comparatorTypeError:()=>Lg,complicatedDoubleInequality:()=>ld,complicatedPolarImplicit:()=>Ib,constantUnsupported:()=>bu,cycle:()=>od,deeplyNested:()=>dh,dependsOnDeletedGeoObject:()=>ax,derivativeMissingBody:()=>Ub,derivativeTypeError:()=>Jg,derivativeVariableTypeError:()=>Qg,differentialWithSuperscript:()=>Bb,distributionAsFunction:()=>dd,divideTypeError:()=>Ag,domainMaxInvalid:()=>cb,domainMaxLessThanMin:()=>lb,domainMinInvalid:()=>ub,dotLHSTypeError:()=>Hg,duplicateUpdateRules:()=>oh,emptyParen:()=>Yh,emptyPipe:()=>$h,emptyRadical:()=>kh,emptyRadicalIndex:()=>qh,emptySquareBracket:()=>Xh,emptySubscript:()=>ed,emptySuperscript:()=>Bh,equalityAndOtherRestriction:()=>$f,equationRequired:()=>pd,equationsUnsupported:()=>jo,eventHandlerTypeError:()=>Il,exponentTypeError:()=>Cg,featureUnavailable:()=>Iu,fractionEmpty:()=>Vh,fractionMissingDenominator:()=>Fh,fractionMissingNumerator:()=>wh,fractionsUnavailable:()=>xd,functionDefinitionsUnsupported:()=>Gl,functionFreeVariable:()=>uA,functionNotDefined:()=>id,functionTypeError:()=>ci,functionUnsupported:()=>ki,geometryLengthTypeError:()=>Gg,gpuLongProduct:()=>yh,gpuLongSum:()=>mh,gpuMaxListSize:()=>gc,gpuUnsupportedFunction:()=>Dl,gpuUnsupportedIntegral:()=>jf,gpuVariableListLength:()=>yu,gpuVariableProduct:()=>Wf,gpuVariableSum:()=>Zf,heterogeneousList:()=>El,identifierAsFunction:()=>Ch,illegalBinWidth:()=>wl,illegalDotCall:()=>Tl,implicitsDisabled:()=>Tb,incorrectProductLowerBound:()=>_b,incorrectSumLowerBound:()=>Cb,indexTypeError:()=>Pl,inequalitiesDisabled:()=>ad,inequalitiesUnsupported:()=>xu,inequalityChainTooLong:()=>nd,integralArgumentTypeError:()=>jg,integralLowerBoundTypeError:()=>Zg,integralMissingBody:()=>Hb,integralMissingBound:()=>Fb,integralMissingDifferential:()=>Vb,integralUpperBoundTypeError:()=>Wg,internal:()=>ne,invalidDependentFirstTableColumn:()=>aA,invalidDoubleInequality3d:()=>ud,invalidDoubleInequalityVariables:()=>cd,invalidFirstTableColumn:()=>Db,invalidFunctionName:()=>Wb,invalidHalfEmptyRange:()=>Rb,invalidImplicitVariables:()=>hu,invalidInequalityVariables:()=>xb,invalidLHS:()=>hb,invalidOperatorName:()=>zh,invalidRegressionParameter:()=>vb,invalidSubscript:()=>Gh,invalidTableEntry:()=>Pc,invalidTableHeader:()=>Mb,listComprehensionIncorrectInput:()=>Jb,listComprehensionInputListTypeError:()=>jb,listTypeError:()=>mu,logScaleBoxPlot:()=>fh,logScaleDotPlot:()=>ph,logScaleHistogram:()=>lh,logScaleTypeError:()=>Ml,logbaseUnsupported:()=>Zb,malformedList:()=>Sh,malformedPoint:()=>Oh,matrixAddDimensions:()=>bA,matrixAssignment:()=>hA,matrixElementTypeError:()=>EA,matrixFractionalPower:()=>TA,matrixInvalidVariable:()=>MA,matrixMultiplyDimensions:()=>PA,matrixPowerDimensions:()=>IA,matrixSubtractDimensions:()=>xA,maxListSize:()=>vl,methodRequiresList:()=>cs,mismatchedBraces:()=>kb,mismatchedDoubleInequality:()=>Eb,multiplyDefined:()=>xc,multiplyDefinedByTables:()=>eb,multiplyTypeError:()=>gl,multiplyTypeError2D:()=>bl,multiplyTypeError3D:()=>xl,multiplyTypeErrorCross:()=>hl,negativeTypeError:()=>_g,nonArithmeticRange:()=>Ll,nonListDoubleReducer:()=>_l,nonListParameterizedReducer:()=>Sb,nonSquareDeterminant:()=>cA,nonSquareInverse:()=>pA,nonSquareTrace:()=>lA,opaque:()=>yl,optimizationError:()=>Ob,orderedPairAccessTypeError:()=>Fg,parameterAlreadyDefined:()=>hc,pdfWrongArity:()=>bh,percentMissingOf:()=>Yb,piecewiseBranchTypeError:()=>eh,piecewiseConditionTypeError:()=>Kg,piecewiseMissingCondition:()=>jh,piecewisePartMissingCondition:()=>Jh,pointTypeError:()=>wg,pointsUnsupported:()=>Tu,polygonTwoNumbersError:()=>Ol,polygonUnsupportedIn3d:()=>hd,primeWithoutParen:()=>rd,primedFunctionArity:()=>gu,productArgumentTypeError:()=>$g,productInfiniteBoundError:()=>kf,productLowerBoundTypeError:()=>Yg,productMissingBody:()=>zb,productMissingBound:()=>Ab,productUpperBoundTypeError:()=>Xg,randomArity:()=>Ih,randomFromBroadcastDistribution:()=>Eh,regressionTypeError:()=>nh,regressionsUnsupported:()=>Pu,selfReferentialFunction:()=>Al,setLogInternalErrors:()=>Og,shadowedIndex:()=>sd,shadowedIntegrationVariable:()=>md,shadowedListComprehensionInput:()=>zl,singleVariableImplicitEquationsDisabled:()=>Pb,singularInverse:()=>fA,sliderLimitReferencesExport:()=>nb,sliderMaxInvalid:()=>sb,sliderMaxLessThanMin:()=>ob,sliderMinInvalid:()=>ib,sliderStepInvalid:()=>ab,substitutionAmbiguousComma:()=>kl,substitutionBodyAction:()=>vA,substitutionBodyDependsOnLocalVariable:()=>sx,substitutionBodyDependsOnRegression:()=>nx,substitutionDuplicateSymbol:()=>ox,substitutionFunctionLHS:()=>Id,substitutionIllegalLHS:()=>Td,substitutionInvalidAssignments:()=>rx,substitutionLocalLHS:()=>Ul,substitutionNested:()=>Ed,substitutionTypeError:()=>DA,substitutionUndefinedRHS:()=>ix,subtractTypeError:()=>Ng,sumArgumentTypeError:()=>qg,sumInfiniteBoundError:()=>Uf,sumLowerBoundTypeError:()=>Ug,sumMissingBody:()=>Gb,sumMissingBound:()=>Nb,sumUpperBoundTypeError:()=>kg,superscriptWithPrime:()=>Uh,tableCycleWithoutGlobalDefinition:()=>tb,tableEntryTypeError:()=>rh,tableHeaderTypeError:()=>th,tdistWrongArity:()=>Th,threeDLengthTypeError:()=>zg,tickerMinStepNonNegativeNumber:()=>rb,tokenWithSubscript:()=>Ah,tooManyArguments:()=>Jf,tooManyVariables:()=>jt,transformationDefinitionTypeError:()=>Vg,transformationTypeError:()=>Bg,ttestListTooShort:()=>Tc,unaryOperatorMissingLeft:()=>_h,unaryOperatorMissingRight:()=>Lh,unexpectedForKeyword:()=>Pd,unexpectedInequality:()=>Sg,unexpectedPrime:()=>td,unexpectedSubscript:()=>Hh,unexpectedSymbol:()=>In,unplottablePolarFunction:()=>bb,unrecognizedSymbol:()=>zf,updateRuleFunctionLHS:()=>qf,updateRuleIllegalLHS:()=>uh,updateRuleLocalLHS:()=>Yf,updateRuleNonIdentifierLHS:()=>sh,updateRuleTypeError:()=>ih,updateRuleUndefinedLHS:()=>ah,variableAsFunction:()=>fd,variableLengthDistributionList:()=>Hl,variableLengthProductBodyDependsOnIndex:()=>tx,variableLengthSumBodyDependsOnIndex:()=>ex,variableLengthTopLevelList:()=>Kb,variableSeed:()=>yd,variableUnsupported:()=>bd,variablesUnsupported:()=>Vl,writeIntegral:()=>gd,wrongArity:()=>Ui,wrongDoubleReducerArity:()=>Sl,wrongParameterizedReducerArity:()=>Dh,zeroArgReducer:()=>vh});var j0=!1;function Og(e){j0=e}function W0(...e){j0&&console.error(...e)}function ne(e){if(W0){let t=e instanceof Error?e:new Error(`${e}`);W0(t.stack)}return new R(v(\"shared-calculator-error-parse-error\"))}function yl(){return new R(v(\"shared-calculator-error-parse-error\"))}function zf(e){return e=J(e),new R(v(\"shared-calculator-error-unrecognized-symbol\",{symbol:e}))}function Sg(){return new R(v(\"shared-calculator-error-unexpected-inequality\"))}function In(e){return e=J(e),new R(v(\"shared-calculator-error-unexpected-symbol\",{symbol:e}))}function Rg(e){return new R(v(\"shared-calculator-error-add-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function Ng(e){return new R(v(\"shared-calculator-error-subtract-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function gl(e){return new R(v(\"shared-calculator-error-multiply-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function hl(e){return new R(v(\"shared-calculator-error-multiply-type-error-cross\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function bl(e){return new R(v(\"shared-calculator-error-multiply-type-error-2d\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function xl(e){return new R(v(\"shared-calculator-error-multiply-type-error-3d\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function Ag(e){return new R(v(\"shared-calculator-error-divide-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function Cg(e){return new R(v(\"shared-calculator-error-exponent-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function _g(e){return new R(v(\"shared-calculator-error-negative-type-error\",{symbol:e[0]})).allowExport()}function Lg(e){return new R(v(\"shared-calculator-error-comparator-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function Hf(e){return new R(v(\"shared-calculator-error-and-type-error\",{symbol:\"and\",symbol1:e[0],symbol2:e[1]})).allowExport()}function mu(e){return new R(v(\"shared-calculator-error-list-type-error\",{symbol1:e[0]})).allowExport()}function wg(e){return new R(v(\"shared-calculator-error-point-type-error\",{symbol1:e,symbol2:pe(N)})).allowExport()}function Pl(e){return new R(v(\"shared-calculator-error-index-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function Fg(e){return new R(v(\"shared-calculator-error-ordered-pair-access-type-error\",{symbol:e[0]})).allowExport()}function ci(e,t){switch(t.length){case 1:return new R(v(\"shared-calculator-error-function-type-error-1\",{fn:J(e),arg:t[0]})).allowExport();case 2:return new R(v(\"shared-calculator-error-function-type-error-2\",{fn:J(e),arg1:t[0],arg2:t[1]})).allowExport();default:return new R(v(\"shared-calculator-error-function-type-error-many\",{fn:J(e)})).allowExport()}}var vg={translate:\"translation\",rotate:\"rotation\",dilate:\"dilation\",reflect:\"reflection\"};function Vg(e,t,r){let n=[];if(!Array.isArray(r))return ci(e,t);for(let s=1;s<r.length;s++){let o=r[s];typeof o==\"number\"?n.push(pe(o)):n.push(pe(o.types[0]))}let i=\"\";switch(n.length){case 1:i=v(t.length>n.length?\"shared-calculator-error-transformation-definition-expected-types-use-fewer-1\":\"shared-calculator-error-transformation-definition-expected-types-1\",{arg:n[0]});break;case 2:i=v(t.length>n.length?\"shared-calculator-error-transformation-definition-expected-types-use-fewer-2\":\"shared-calculator-error-transformation-definition-expected-types-2\",{arg1:n[0],arg2:n[1]});break}switch(t.length){case 1:return new R(v(t.length<n.length?\"shared-calculator-error-transformation-definition-type-error-use-more-1\":\"shared-calculator-error-transformation-definition-type-error-1\",{fn:J(vg[e]),arg:t[0],expectedTypeMessage:i}));case 2:return new R(v(t.length<n.length?\"shared-calculator-error-transformation-definition-type-error-use-more-2\":\"shared-calculator-error-transformation-definition-type-error-2\",{fn:J(vg[e]),arg1:t[0],arg2:t[1],expectedTypeMessage:i}));default:return new R(v(\"shared-calculator-error-transformation-definition-type-error-many\",{fn:J(vg[e])}))}}function Bg(e,t){switch(t.length){case 1:return new R(v(\"shared-calculator-error-transformation-type-error-1\",{fn:J(e),arg:t[0]})).allowExport();case 2:return new R(v(\"shared-calculator-error-transformation-type-error-2\",{fn:J(e),arg1:t[0],arg2:t[1]})).allowExport();default:return new R(v(\"shared-calculator-error-transformation-type-error-many\",{fn:J(e)})).allowExport()}}function Gg(e,t){let r=J(e),n=J(\"count\");return new R(v(\"shared-calculator-error-geometry-length-type-error\",{fn:r,alternativeFn:n,arg:t})).allowExport()}function zg(e,t){let r=J(e),n=J(\"count\");return new R(v(\"shared-calculator-error-3d-length-type-error\",{fn:r,alternativeFn:n,arg:t})).allowExport()}function Tl(e){return new R(v(\"shared-calculator-error-illegal-dot-call\",{symbol:J(e)}))}function Hg(e,t){return new R(v(\"shared-calculator-error-dot-lhs-type-error\",{symbol:J(e),type:t})).allowExport()}function Ug(e){return new R(v(\"shared-calculator-error-sum-lower-bound-type-error\",{symbol:e[0]})).allowExport()}function kg(e){return new R(v(\"shared-calculator-error-sum-upper-bound-type-error\",{symbol:e[0]})).allowExport()}function Uf(){return new R(v(\"shared-calculator-error-sum-infinite-bound-type-error\"))}function qg(e){return new R(v(\"shared-calculator-error-sum-argument-type-error\",{symbol:e[0]})).allowExport()}function Yg(e){return new R(v(\"shared-calculator-error-product-lower-bound-type-error\",{symbol:e[0]})).allowExport()}function Xg(e){return new R(v(\"shared-calculator-error-product-upper-bound-type-error\",{symbol:e[0]})).allowExport()}function kf(){return new R(v(\"shared-calculator-error-product-infinite-bound-type-error\"))}function $g(e){return new R(v(\"shared-calculator-error-product-argument-type-error\",{symbol:e[0]})).allowExport()}function Zg(e){return new R(v(\"shared-calculator-error-integral-lower-bound-type-error\",{symbol:e[0]})).allowExport()}function Wg(e){return new R(v(\"shared-calculator-error-integral-upper-bound-type-error\",{symbol:e[0]})).allowExport()}function jg(e){return new R(v(\"shared-calculator-error-integral-argument-type-error\",{symbol:e[0]})).allowExport()}function Jg(e){return new R(v(\"shared-calculator-error-derivative-type-error\",{symbol:e[0]})).allowExport()}function Qg(e,t){return new R(v(\"shared-calculator-error-derivative-variable-type-error\",{symbol1:J(e),symbol2:t[0]}))}function Kg(e){return new R(v(\"shared-calculator-error-piecewise-condition-type-error\",{symbol1:pe(he),symbol2:e[0]})).allowExport()}function eh(e){return new R(v(\"shared-calculator-error-piecewise-branch-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function th(e){return new R(v(\"shared-calculator-error-table-header-type-error\",{symbol:e[0]}))}function rh(e){return new R(v(\"shared-calculator-error-table-entry-type-error\",{symbol:e[0]}))}function nh(e){return new R(v(\"shared-calculator-error-regression-type-error\",{symbol1:e[0],symbol2:e[1]}))}function ih(e){return new R(v(\"shared-calculator-error-update-rule-type-error\",{symbol:e}))}function sh(){return new R(v(\"shared-calculator-error-update-rule-non-identifier-lhs\",{arrow:\"\\u2192\",example:\"a\"}))}function oh(e){return new R(v(\"shared-calculator-error-duplicate-update-rules\",{symbol:J(e)}))}function ah(e){return new R(v(\"shared-calculator-error-update-rule-undefined-lhs\",{symbol:J(e)}))}function uh(e){return new R(v(\"shared-calculator-error-update-rule-illegal-lhs\",{symbol:J(e)}))}function qf(e){return new R(v(\"shared-calculator-error-update-rule-function-lhs\",{symbol:J(e)}))}function Yf(e){return new R(v(\"shared-calculator-error-update-rule-local-lhs\",{symbol:J(e)}))}function ch(e){let t=e.filter(r=>r.scope===\"free\").map(r=>r.symbol);return new R(v(\"shared-calculator-error-action-merge-free-variable\",{symbol:J(t[0]||\"\")})).setDependencies(t).allowExport()}function Il(e){return new R(v(\"shared-calculator-error-event-handler-type-error\",{example:\"a\\u2192a+1\"}))}function El(){return new R(v(\"shared-calculator-error-heterogeneous-list\")).allowExport()}function Xf(e){return new R(v(\"shared-calculator-error-combine-type-error\",{symbol1:e[0],symbol2:e[1]})).allowExport()}function Ml(e){return new R(v(\"shared-calculator-error-log-scale-type-error\",{symbol:e})).allowExport()}function lh(){return new R(v(\"shared-calculator-error-log-scale-histogram\"))}function ph(){return new R(v(\"shared-calculator-error-log-scale-dot-plot\"))}function fh(){return new R(v(\"shared-calculator-error-log-scale-box-plot\"))}function dh(){return new R(v(\"shared-calculator-error-deeply-nested\")).allowExport()}function $f(){return new R(v(\"shared-calculator-error-3d-equality-and-other-restriction\")).allowExport()}function us(){return new R(v(\"shared-calculator-error-3d-bad-equality-slice\")).allowExport()}function yu(e){return new R(v(\"shared-calculator-error-gpu-variable-list-length\",{symbol:J(e.filter(t=>t.symbol!==\"globalRandomSeed\")[0].symbol)}))}function Zf(e){return new R(v(\"shared-calculator-error-gpu-variable-sum\",{symbol:J(e[0].symbol)}))}function Wf(e){return new R(v(\"shared-calculator-error-gpu-variable-product\",{symbol:J(e[0].symbol)}))}function Dl(e){return new R(v(\"shared-calculator-error-gpu-function-unsupported\",{symbol:J(e)}))}function jf(){return new R(v(\"shared-calculator-error-gpu-integral-unsupported\"))}function mh(){return new R(v(\"shared-calculator-error-gpu-long-sum\",{maxTermCount:1e3.toLocaleString()}))}function yh(){return new R(v(\"shared-calculator-error-gpu-long-product\",{maxTermCount:1e3.toLocaleString()}))}function gc(){return new R(v(\"shared-calculator-error-gpu-max-list-size\",{maxListSize:100 .toLocaleString()}))}function vl(){return new R(v(\"shared-calculator-error-max-list-size\",{maxListSize:1e4.toLocaleString()})).allowExport()}function Ol(){return new R(v(\"shared-calculator-error-two-numbers-error\"))}function gh(){return new R(v(\"shared-calculator-error-boxplot-offset-invalid\"))}function hh(){return new R(v(\"shared-calculator-error-boxplot-breadth-invalid\"))}function Jf(e,t){return new R(v(\"shared-calculator-error-too-many-arguments\",{symbol:e,max:t}))}function bh(){var e=v(\"shared-calculator-error-pdf-wrong-arity-recommendation\"),t=v(\"shared-calculator-error-pdf-wrong-arity\",{recommendation:e});return new R(t)}function xh(){var e=v(\"shared-calculator-error-cdf-wrong-arity-recommendation\"),t=v(\"shared-calculator-error-cdf-wrong-arity\",{recommendation:e});return new R(t)}function Ph(){var e=v(\"shared-calculator-error-cdf-too-many-arguments-recommendation\"),t=v(\"shared-calculator-error-cdf-too-many-arguments\",{recommendation:e});return new R(t)}function Th(){return new R(v(\"shared-calculator-error-tdist-wrong-arity\"))}function Ih(){return new R(v(\"shared-calculator-error-random-arity\"))}function Eh(){return new R(v(\"shared-calculator-error-random-from-broadcast-distribution\"))}function Mh(e){var t=e===\"rgb\"?[150,30,100]:[180,.5,.5],r=v(\"shared-calculator-error-color-arity-recommendation\",{recommendation:J(e)+\"(\"+t.join(\", \")+\")\"}),n=v(\"shared-calculator-error-color-arity\",{symbol:e,recommendation:r});return new R(n)}function Ui(e,t,r,n){e=J(e);var i,s;if(t===1)n||(n=e+\"(x)\"),s=v(\"shared-calculator-error-wrong-arity-supplement\",{recommendation:n}),r>1?i=v(\"shared-calculator-error-wrong-arity-single-arg-too-many\",{dependency:e,supplement:s}):i=v(\"shared-calculator-error-wrong-arity-single-arg-too-few\",{dependency:e,supplement:s});else{var o=[];if(!n){for(var a=0;a<t;a++)o[a]=a+1;n=J(e)+\"(\"+o.join(\", \")+\")\"}s=v(\"shared-calculator-error-wrong-arity-supplement\",{recommendation:n}),i=v(\"shared-calculator-error-wrong-arity-many-arg\",{dependency:e,assignment_arity:t,supplement:s})}return new R(i)}function Dh(e){return new R(v(\"shared-calculator-error-wrong-two-arg-arity\",{symbol:J(e),recommendation:J(e)+\"([1,2,3], 1)\"}))}function Sl(e){return new R(v(\"shared-calculator-error-wrong-two-arg-arity\",{symbol:J(e),recommendation:J(e)+\"([1,2,3], [3,2,1])\"}))}function gu(){return new R(v(\"shared-calculator-error-primed-function-arity\"))}function vh(e){return new R(v(\"shared-calculator-error-zero-arg-reducer\",{symbol:J(e)}))}function Oh(){return new R(v(\"shared-calculator-error-malformed-point\"))}function Sh(){return new R(v(\"shared-calculator-error-malformed-list\"))}function Rh(e){return new R(v(\"shared-calculator-error-bad-tuple-dimensions\",{symbol:e}))}function Qf(e){return e=J(e),new R(v(\"shared-calculator-error-bad-implicit-call\",{symbol:e}))}function Nh(e,t){return new R(v(\"shared-calculator-error-adjacent-numbers\",{left:e,right:t}))}function Kf(e){return new R(v(\"shared-calculator-error-adjacent-mixed-number\",{mixedNumber:e}))}function Ah(){return new R(v(\"shared-calculator-error-token-with-subscript\"))}function Ch(e){return e=J(e),new R(v(\"shared-calculator-error-identifier-as-function\",{symbol:e}))}function Rl(e){return e=J(e),e===\"%\"&&(e=\"% of\"),new R(v(\"shared-calculator-error-binary-operator-missing-operand\",{symbol:e}))}function _h(e){return e=J(e),new R(v(\"shared-calculator-error-unary-operator-missing-left\",{symbol:e}))}function Lh(e){return e=J(e),new R(v(\"shared-calculator-error-unary-operator-missing-right\",{symbol:e}))}function wh(){return new R(v(\"shared-calculator-error-fraction-missing-numerator\"))}function Fh(){return new R(v(\"shared-calculator-error-fraction-missing-denominator\"))}function Vh(){return new R(v(\"shared-calculator-error-fraction-empty\"))}function ed(){return new R(v(\"shared-calculator-error-empty-subscript\"))}function Bh(){return new R(v(\"shared-calculator-error-empty-superscript\"))}function Gh(e){return e=J(e),new R(v(\"shared-calculator-error-invalid-subscript\",{symbol:e}))}function zh(){return new R(v(\"shared-calculator-error-invalid-operator-name\"))}function Hh(){return new R(v(\"shared-calculator-error-unexpected-subscript\"))}function Uh(){return new R(v(\"shared-calculator-error-superscript-with-prime\"))}function td(){return new R(v(\"shared-calculator-error-unexpected-prime\"))}function rd(){return new R(v(\"shared-calculator-error-prime-without-paren\"))}function kh(){return new R(v(\"shared-calculator-error-empty-radical\"))}function qh(){return new R(v(\"shared-calculator-error-empty-radical-index\"))}function Yh(){return new R(v(\"shared-calculator-error-empty-paren\"))}function Xh(){return new R(v(\"shared-calculator-error-empty-square-bracket\"))}function $h(){return new R(v(\"shared-calculator-error-empty-pipe\"))}function Zh(e){var t=e+\"^2\",r=e+\"^-1\";return new R(v(\"shared-calculator-error-bad-trig-exponent\",{form1:t,form2:r}))}function Wh(e){var t=e+\"^2\";return new R(v(\"shared-calculator-error-bad-log-exponent\",{form:t}))}function nd(){return new R(v(\"shared-calculator-error-inequality-chain-too-long\"))}function jh(){return new R(v(\"shared-calculator-error-piecewise-missing-condition\"))}function Jh(){return new R(v(\"shared-calculator-error-piecewise-part-missing-condition\"))}function Qh(){return new R(v(\"shared-calculator-error-colon-missing-condition\"))}function Nl(){return new R(v(\"shared-calculator-error-blank-expression\"))}function id(e){return e=J(e),new R(v(\"shared-calculator-error-function-not-defined\",{dependency:e}))}function hc(e){return e=J(e),new R(v(\"shared-calculator-error-parameter-already-defined\",{dependency:e}))}function bc(e,t){return e=J(e),t===void 0?new R(v(\"shared-calculator-error-cannot-redefine\",{symbol:e})):new R(v(\"shared-calculator-error-cannot-redefine-root\",{symbol:e,symbolRoot:t}))}function Kh(e){return e=J(e),new R(v(\"shared-calculator-error-cannot-subscript\",{symbol:e}))}function xc(e){return e=J(e),new R(v(\"shared-calculator-error-multiply-defined\",{dependency:e}))}function eb(e){let t=xc(e);return t.isMultiplyDefinedByTables=!0,t}function sd(e){return e=J(e),new R(v(\"shared-calculator-error-shadowed-index\",{symbol:e}))}function od(e){e=e.map(J);var t=e.pop()||\"\";return new R(v(\"shared-calculator-error-dependency-cycle\",{symbols:e.join(\"', '\"),lastSymbol:t}))}function tb(e){let t=od(e);return t.isTableCycleWithoutGlobalDefinition=!0,t}function Al(e){return new R(v(\"shared-calculator-error-self-referential-function\",{symbol:J(e)}))}function rb(){return new R(v(\"shared-calculator-error-ticker-min-step-nonnegative\"))}function nb(e){return new R(v(\"shared-calculator-error-slider-limit-references-export\",{symbol:J(e)}))}function ib(){return new R(v(\"shared-calculator-error-slider-min-invalid\"))}function sb(){return new R(v(\"shared-calculator-error-slider-max-invalid\"))}function ob(){return new R(v(\"shared-calculator-error-slider-max-less-than-min\"))}function ab(){return new R(v(\"shared-calculator-error-slider-step-invalid\"))}function ub(){return new R(v(\"shared-calculator-error-domain-min-invalid\"))}function cb(){return new R(v(\"shared-calculator-error-domain-max-invalid\"))}function lb(){return new R(v(\"shared-calculator-error-domain-max-less-than-min\"))}function pb(){return new R(v(\"shared-calculator-error-cdf-min-invalid\"))}function fb(){return new R(v(\"shared-calculator-error-cdf-max-invalid\"))}function db(){return new R(v(\"shared-calculator-error-cdf-max-less-than-min\"))}function jt(e){if(e=e.map(J),e.length===0)return new R(v(\"shared-calculator-error-too-many-variables-no-symbols\"));var t=e.pop()||\"\";return e.length>0?new R(v(\"shared-calculator-error-too-many-variables-many-symbols\",{variables:e.join(\"', '\"),lastVariable:t})):new R(v(\"shared-calculator-error-too-many-variables-one-symbol\",{variable:t}))}function mb(e){return new R(v(\"shared-calculator-error-cannot-restrict\",{variable:J(e)}))}function yb(e){return new R(v(\"shared-calculator-error-cannot-assign-color\",{variable:J(e)}))}function gb(e){return new R(v(\"shared-calculator-error-cannot-restrict-with-equality\",{variable:J(e)}))}function Cl(e,t,r){e=e.map(J),t=J(t),r=r.map(J);var n=t+\"(\"+r.join(\",\")+\",\"+e.join(\",\")+\")\",i=e.pop()||\"\",s={symbols:e.join(\"', '\"),lastSymbol:i,newSignature:n};return e.length?new R(v(\"shared-calculator-error-add-arguments-to-definition-many\",s)):new R(v(\"shared-calculator-error-add-arguments-to-definition-one\",s))}function hb(e){return e=J(e),new R(v(\"shared-calculator-error-invalid-lhs\",{symbol:e}))}function bb(){return new R(v(\"shared-calculator-error-unplottable-polar-function\"))}function xb(){return new R(v(\"shared-calculator-error-invalid-inequality-variables\"))}function hu(){return new R(v(\"shared-calculator-error-invalid-implicit-variables\"))}function Pb(){return new R(v(\"shared-calculator-error-single-variable-implicit-equations-disabled\"))}function Tb(){return new R(v(\"shared-calculator-error-implicits-disabled\"))}function ad(){return new R(v(\"shared-calculator-error-inequalities-disabled\"))}function Ib(){return new R(v(\"shared-calculator-error-complicated-polar-implicit\"))}function ud(){return new R(v(\"shared-calculator-error-invalid-double-inequality-3d\"))}function cd(){return new R(v(\"shared-calculator-error-invalid-double-inequality-variables\"))}function Eb(){return new R(v(\"shared-calculator-error-mismatched-double-inequality\",{example:\"1 < y < 2\"}))}function ld(){return new R(v(\"shared-calculator-error-complicated-double-inequality\"))}function pd(e){return e?(e=J(e),new R(v(\"shared-calculator-error-equation-required-symbol\",{lhs:e+\"=\"}))):new R(v(\"shared-calculator-error-equation-required\"))}function fd(e){return e=J(e),new R(v(\"shared-calculator-error-variable-as-function\",{dependency:e}))}function dd(e){return e=J(e),new R(v(\"shared-calculator-error-distribution-as-function\",{symbol:e}))}function Mb(e){return new R(v(\"shared-calculator-error-invalid-table-header\",{supplement:e}))}function Pc(e){return new R(v(\"shared-calculator-error-invalid-table-entry\",{supplement:e}))}function Db(){return new R(v(\"shared-calculator-error-invalid-first-table-column\",{most:\"'y', 'r',\",last:\"'\\u03B8'\"}))}function aA(){return new R(v(\"shared-calculator-error-invalid-dependent-first-table-column\"))}function vb(e){return new R(v(\"shared-calculator-error-invalid-regression-parameter\",{symbol:J(e)}))}function Ob(){return new R(v(\"shared-calculator-error-optimization-error\"))}function _l(e){return new R(v(\"shared-calculator-error-non-list-double-reducer\",{symbol:J(e),recommendation:J(e)+\"([1,2,3], [3,2,1])\"})).allowExport()}function Sb(e){return new R(v(\"shared-calculator-error-non-list-parameterized-reducer\",{symbol:J(e),recommendation:J(e)+\"([1,2,3], 1)\"})).allowExport()}function cs(e){return new R(v(\"shared-calculator-error-method-requires-list\",{symbol:J(e),recommendation:J(e)+\"([1,2,3])\"})).allowExport()}function uA(e,t){return new R(v(\"shared-calculator-error-variable-function-free-variable\",{functionSymbol:e,variableSymbol:t})).allowExport()}function Ll(){return new R(v(\"shared-calculator-error-non-arithmetic-range\")).allowExport()}function Rb(){return new R(v(\"shared-calculator-error-invalid-half-empty-range\"))}function Nb(){return new R(v(\"shared-calculator-error-sum-missing-bound\"))}function Ab(){return new R(v(\"shared-calculator-error-product-missing-bound\"))}function Cb(){return new R(v(\"shared-calculator-error-incorrect-sum-lower-bound\"))}function _b(){return new R(v(\"shared-calculator-error-incorrect-product-lower-bound\"))}function Lb(e){return new R(v(\"shared-calculator-error-bad-sum-bound-dependency\",{symbol:J(e)}))}function wb(e){return new R(v(\"shared-calculator-error-bad-product-bound-dependency\",{symbol:J(e)}))}function Fb(){return new R(v(\"shared-calculator-error-integral-missing-bound\"))}function Vb(){return new R(v(\"shared-calculator-error-integral-missing-differential\"))}function Bb(){return new R(v(\"shared-calculator-error-differential-with-superscript\"))}function Gb(){return new R(v(\"shared-calculator-error-sum-missing-body\"))}function zb(){return new R(v(\"shared-calculator-error-product-missing-body\"))}function Hb(){return new R(v(\"shared-calculator-error-integral-missing-body\"))}function Ub(){return new R(v(\"shared-calculator-error-derivative-missing-body\"))}function kb(e,t){return e=J(e),t=J(t),new R(v(\"shared-calculator-error-mismatched-braces\",{symbol1:e,symbol2:t}))}function md(e){return new R(v(\"shared-calculator-error-shadowed-integration-variable\",{symbol:J(e)}))}function qb(e){return new R(v(\"shared-calculator-error-bad-integral-bound-dependency\",{symbol:J(e)}))}function Yb(){return new R(v(\"shared-calculator-error-percent-missing-of\"))}function wl(e){return e=J(e),new R(v(\"shared-calculator-error-illegal-bin-width\",{symbol:e}))}function Tc(e){return e=J(e),new R(v(\"shared-calculator-error-ttest-list-too-short\",{symbol:e}))}function Xb(){return new R(v(\"shared-calculator-error-bad-sample-size\"))}function yd(e){return new R(v(\"shared-calculator-error-variable-seed\",{symbol:J(e[0].symbol)})).setDependencies(e.filter(t=>t.scope===\"free\").map(t=>t.symbol)).allowExport()}function Fl(e){return new R(v(\"shared-calculator-error-bad-symbol-context\",{symbol:J(e)}))}function gd(){return new R(v(\"shared-calculator-error-write-integral\",{command:\"integral\",symbol:\"\\u222B\"}))}function $b(){return new R(v(\"shared-calculator-error-ans-undefined\"))}function Vl(e){return new R(v(\"shared-calculator-error-variables-unsupported\",{variable:J(e)}))}function hd(){return new R(v(\"shared-calculator-error-polygon-unsupported-in-3d\"))}function ki(e,t=!1){return t&&e===\"polygon\"?hd():new R(v(\"shared-calculator-error-function-unsupported\",{symbol:J(e)}))}function Zb(){return new R(v(\"shared-calculator-error-logbase-unsupported\"))}function bu(e){return new R(v(\"shared-calculator-error-constant-unsupported\",{symbol:J(e)}))}function bd(e){return new R(v(\"shared-calculator-error-variable-unsupported\",{symbol:J(e)}))}function Wb(e){return new R(v(\"shared-calculator-error-variable-invalid-function-name\",{symbol:J(e)}))}function Bl(){return new R(v(\"shared-calculator-error-assignments-unsupported\"))}function Gl(){return new R(v(\"shared-calculator-error-function-definition-unsupported\"))}function jo(){return new R(v(\"shared-calculator-error-equations-unsupported\"))}function xu(){return new R(v(\"shared-calculator-error-inequalities-unsupported\"))}function Pu(){return new R(v(\"shared-calculator-error-regressions-unsupported\"))}function Tu(){return new R(v(\"shared-calculator-error-points-unsupported\"))}function Iu(){return new R(v(\"shared-calculator-error-feature-unavailable\"))}function xd(){return new R(v(\"basic-calculator-error-fractions-unavailable\"))}function cA(){return new R(v(\"shared-calculator-error-non-square-determinant\"))}function lA(){return new R(v(\"shared-calculator-error-non-square-trace\"))}function pA(){return new R(v(\"shared-calculator-error-non-square-inverse\"))}function fA(){return new R(v(\"shared-calculator-error-non-singular-inverse\"))}function dA(e){return new R(v(\"shared-calculator-error-clickable-object-assignment-not-defined\",{symbol:e}))}function mA(e){return new R(v(\"shared-calculator-error-multiply-defined\",{dependency:e}))}function yA(){return new R(v(\"shared-calculator-error-clickable-object-assignment-not-identifier\"))}function gA(){return new R(v(\"shared-calculator-error-clickable-object-invalid-expression\"))}function hA(){return new R(v(\"shared-calculator-error-matrix-assignment\"))}function bA(){return new R(v(\"shared-calculator-error-matrix-add-dimensions\"))}function xA(){return new R(v(\"shared-calculator-error-matrix-subtract-dimensions\"))}function PA(){return new R(v(\"shared-calculator-error-matrix-multiply-dimensions\"))}function TA(){return new R(v(\"shared-calculator-error-matrix-fractional-power\"))}function IA(){return new R(v(\"shared-calculator-error-matrix-power-dimensions\"))}function EA(e){return new R(v(\"shared-calculator-error-matrix-element-type-error\",{arg:e[0]}))}function MA(e){return new R(v(\"shared-calculator-error-matrix-invalid-variable\",{symbol:J(e)}))}function jb(e,t){return new R(v(\"shared-calculator-error-list-comprehension-input-type-error\",{identifier:e,actual:t})).allowExport()}function Jb(){return new R(v(\"shared-calculator-error-incorrect-list-comprehension-input\"))}function Pd(){return new R(v(\"shared-calculator-error-unexpected-for-keyword\"))}function zl(e){return e=J(e),new R(v(\"shared-calculator-error-shadowed-list-comprehension-input\",{symbol:e}))}function Qb(e){return e=J(e),new R(v(\"shared-calculator-error-bad-list-comprehension-input-dependency\",{symbol:e}))}function Kb(e){let t=e.filter(r=>r.scope===\"free\").map(r=>r.symbol);return new R(v(\"shared-calculator-error-variable-length-top-level-list\",{symbol:J(t[0]||\"\")})).setDependencies(t).allowExport()}function Hl(e){return new R(v(\"shared-calculator-error-variable-length-distribution-list\",{symbol:e[0].symbol})).setDependencies(e.filter(t=>t.scope===\"free\").map(t=>t.symbol))}function ex(e){return new R(v(\"shared-calculator-error-variable-length-sum-body-depends-on-index\",{symbol:e}))}function tx(e){return new R(v(\"shared-calculator-error-variable-length-product-body-depends-on-index\",{symbol:e}))}function DA(e,t){return new R(v(\"shared-calculator-error-substitution-type-error\",{actual:pe(e),expected:pe(t)}))}function rx(){return new R(v(\"shared-calculator-error-substitution-invalid-assignments\"))}function Ul(e){return new R(v(\"shared-calculator-error-substitution-local-lhs\",{symbol:e}))}function Td(e){return new R(v(\"shared-calculator-error-substitution-illegal-lhs\",{symbol:e}))}function Id(e){return new R(v(\"shared-calculator-error-substitution-function-lhs\",{symbol:e}))}function nx(e){return new R(v(\"shared-calculator-error-substitution-body-regression-parameter-dependency\",{symbol:e}))}function ix(e){let t=e.filter(r=>r.scope===\"free\").map(r=>r.symbol);return new R(v(\"shared-calculator-error-substitution-undefined-rhs\",{symbol:t[0]})).setDependencies(t)}function sx(e){return new R(v(\"shared-calculator-error-substitution-body-local-variable-dependency\",{symbol:e}))}function vA(){return new R(v(\"shared-calculator-error-substitution-body-action\"))}function Ed(){return new R(v(\"shared-calculator-error-substitution-nested\"))}function kl(){return new R(v(\"shared-calculator-error-substitution-ambiguous-comma\"))}function ox(e){return new R(v(\"shared-calculator-error-substitution-duplicate-assignment\",{symbol:e}))}function ax(){return new R(v(\"shared-calculator-error-depends-on-deleted-geo-object\"))}var Jo=class extends yt{constructor(r,n,i){super();this.isFunction=!0;this._symbol=r._symbol,this._argSymbols=n.map(function(s){return s._symbol}),this._exports=[this._symbol],this._expression=i,this.mergeDependenciesInScope(this.type,[this._symbol].concat(this._argSymbols),this._expression,{functionDefinitionSymbol:this._symbol})}getConcreteInvocationTree(r,n,i,s){if(i.length!==this._argSymbols.length)throw Ui(s,this._argSymbols.length,i.length);for(var o=Object.create(n),a=0;a<this._argSymbols.length;a++)o[this._argSymbols[a]]=i[a];return this._expression.getConcreteTree(r,o)}getSliderVariables(r,n){var i=this._argSymbols;return super.getSliderVariables(r,n).filter(function(s){return i.indexOf(s)===-1})}asEquation(){var r=this._argSymbols.map(function(i){return new gt(i)}),n=new ho(new Lr(new gt(this._symbol),r),this._expression);return n.userData=this.userData,n.metaData=this.metaData,n}};var Md=class extends yt{constructor(r,n){super();this.isRegression=!0;this._lhs=r,this.isLhsSimple=r instanceof gt,this._logLhs=new Lr(\"ln\",[r]),this._rhs=n,this._difference=new as([r,n]),this._logDifference=new as([new Lr(\"ln\",[r]),new Lr(\"ln\",[n])]),this.mergeDependencies(r,n)}exportTo(r,n,i){if(!n.isError){for(var s in n.parameters)n.parameters.hasOwnProperty(s)&&(r.assignmentForbidden(s)||(i[s]=i[s]?xc(s):n.parameters[s]));r.assignmentForbidden(n.residualVariable)||(i[n.residualVariable]=n.residuals)}}getSliderVariables(){return[]}};var Dd=class extends yt{constructor(r,n){super();this.isImage=!0;this.center=r.center,this.radianAngle=r.radianAngle,this.width=r.width,this.height=r.height,this.opacity=r.opacity,this.moveStrategy=n,this.mergeDependencies(this.center,this.radianAngle,this.width,this.height,this.opacity)}};var vd=class extends yt{constructor(r){super();this.handler=r.handler,this.minStep=r.minStep,this.mergeDependencies(this.handler),this.mergeDependencies(this.minStep)}};var Od=class extends Wo{constructor(r,n){super(new gt(r._symbol),r._expression);this.isSlider=!0;this.setInputSpan(r._inputSpan),this.sliderAssignment=r,this.sliderMin=n.sliderMin,this.sliderMax=n.sliderMax,this.sliderSoftMin=n.sliderSoftMin,this.sliderSoftMax=n.sliderSoftMax,this.sliderStep=n.sliderStep,this.sliderIsPlayingOnce=n.sliderIsPlayingOnce,this.sliderMin&&this.mergeDependencies(this.sliderMin),this.sliderMax&&this.mergeDependencies(this.sliderMax),this.sliderStep&&this.mergeDependencies(this.sliderStep)}shouldPromoteToSlider(r){return!1}asAssignment(){return new Wo(this._symbol,this._expression)}};var Sd=class extends Q{constructor(r){let n=new fr(r);super([n]);this._constantNode=n}asValue(){return this._constantNode.asValue()}asCompilerValue(){return this._constantNode.asCompilerValue()}};var Rd=class extends yt{constructor(r){super();this.exportPenalty=1;this.isTable=!0;this.columns=r,this.mergeDependencies.apply(this,r)}getExports(r){let n=[];for(var i=0;i<this.columns.length;i++)Array.prototype.push.apply(n,this.columns[i].getExports(r));return n}exportTo(r,n,i){for(var s=0;s<this.columns.length;s++){var o=this.columns[s].getExports(r);if(o.length){var a=o[0];r.assignmentForbidden(a)||i[a]||(n.isError?i[a]=n:this.columns[s].exportTo(r,n.columns[s],i))}}}getAllIds(){return this.columns.map(function(r){return r.header.userData.id})}};function OA(e){return e.isConstant?new fr(e.asCompilerValue()):new fr(NaN)}var Eu=class extends yt{constructor(r,n){super();this.header=r,this.values=n,this.isIndependent=!1,this.registerDependencies(),this._exports=this.computeExports()}registerDependencies(){this.mergeDependencies(this.header),this.mergeDependencies.apply(this,this.values)}computeExports(){return this.header instanceof gt?[this.header._symbol]:[]}_exportSymbolsTo(r,n,i){if(r.length){var s=r[0];if(n.isError)i[s]=n;else try{i[s]=new Pa(n.values.map(OA))}catch(o){if(o instanceof yt)i[s]=o;else throw o}}}exportTo(r,n,i){var s=this.getLegalExports(r);this._exportSymbolsTo(s,n,i)}exportToLocal(r,n,i){this._exportSymbolsTo(this.getExports(r),n,i)}};var Nd=class extends yt{constructor(r,n,i,s){super();this._symbol=r,this._expression=n,this.otherVariableSolutionData=i,this.mergeDependencies(n),this.branchMultiplier=s}};var Ad=class extends yt{constructor(r,n,i,s,o){super();this.parameters=r,this.residuals=n,this.statistics=i,this.model=s,this.isModelValid=o.isModelValid,this.residualVariable=o.residualVariable,this.residualSuggestionId=o.residualSuggestionId,this.shouldSuggestLogMode=o.shouldSuggestLogMode,this.isLinear=o.isLinear,this.parameterWarning=o.parameterWarning,this._exports=[this.residualVariable];for(var a in r)r.hasOwnProperty(a)&&this._exports.push(a);this.mergeDependencies(s)}getCompiledFunction(){return this.model.getCompiledFunction.apply(this.model,arguments)}getCompiledDerivative(){return this.model.getCompiledDerivative.apply(this.model,arguments)}};var Cd=class extends Q{constructor(r){typeof r!=\"string\"&&(r=\"\"+r);super([]);this.isString=!0;this._stringValue=r}asValue(){return this._stringValue}};var _d=class extends Q{constructor(r,n){super(n);this.seed=n[0],this.userSeed=n[1],this.tag=r}asValue(){return this.seed.asValue()+\"::\"+this.tag+this.userSeed.asValue()}copyWithArgs(r){return new this.constructor(this.tag,r)}};function Mu(e){return typeof e!=\"object\"||!e?!1:e.type===\"Action\"}function Zt(e,t){let r=e.getInstruction(t);switch(r.type){case 1:return ws(r.value);default:throw new Error(`Unexpected opcode ${r.type}.`)}}function ws(e){if(Array.isArray(e))return e.map(ws);switch(typeof e){case\"boolean\":case\"number\":case\"string\":return e;case\"object\":if(Mu(e)){let t={};for(let r in e.updateRules){let n=e.updateRules[r];t[r]={value:ws(n.value),valueType:n.valueType}}return{type:\"Action\",updateRules:t}}else return Y(e);default:throw new Error(\"Unexpected value: \"+e)}}function J0(e){switch(e){case he:case P:case N:case G:case dt:case Re:case xr:case _r:case Je:case It:case we:case Oe:case de:case ue:case ye:case _e:case ge:case Ae:case xe:case He:return!0;case Tt:case Ke:case Bt:case te:case zr:case nt:case Hr:case rn:case sn:case Ur:case nn:case ar:case Le:case wi:case Qe:case Vr:case br:case ur:case Sr:case Rr:case Nr:case Ar:case Cr:case Jt:case Qt:case tn:return!1;default:let t=e;throw new Error(`Unexpected valueType: ${t}`)}}function qi(e){switch(e){case P:return NaN;case N:return[NaN,NaN];case G:return[NaN,NaN,NaN];case dt:case Re:return[[NaN,NaN,NaN],[NaN,NaN,NaN]];case xr:return[[NaN,NaN,NaN],[NaN,NaN,NaN],[NaN,NaN,NaN]];case _r:return[[[NaN,NaN,NaN],[NaN,NaN,NaN],[NaN,NaN,NaN]],NaN];case It:return[NaN,NaN,NaN];case Je:return{type:\"Action\",updateRules:{}};case Oe:case _e:case ye:return[[NaN,NaN],[NaN,NaN]];case ge:return[[NaN,NaN],[NaN,NaN]];case de:return[[NaN,NaN],NaN];case ue:return[[NaN,NaN],[NaN,NaN],[NaN,NaN]];case he:return!1;case we:return[];case He:return[[NaN,NaN],[NaN,NaN],!1];case Ae:case xe:return[[NaN,NaN],NaN,NaN,NaN];default:let t=e;throw new Error(`${t} does not have a NaN type.`)}}function RA(e){for(var t=0;t<this.length;t++)e(this.elementAt(t),t)}function NA(e){for(var t=[],r=0;r<this.length;r++)t.push(e(this.elementAt(r),r));return t}var sr=class e extends yt{constructor(r){super();this.isError=!1;this.eachElement=RA;this.mapElements=NA;if(r.getError())throw new Error(\"Programming error: IRExpression should not be constructed with an error chunk\");if(this._chunk=r,this.valueType=r.getReturnType(),this.addDependencies(r.getLiveArgNames()),this.isList=j(this.valueType),this.isList&&(this.length=this._chunk.getConstantListLength(),this.length===void 0))throw Kb(r.getListLengthDependencies());var n=r.isConstant();this.isConstant=n&&(this.valueType===P||this.valueType===he),this.isTypedConstant=n,this.isEmptyAction=n&&this.valueType===Je&&Object.keys(r.asValue().updateRules).length===0}shouldExportAns(){return!0}getCompiledFunction(r){return this._chunk.getCompiledFunction(r)}getRestrictedFunctionForGLSL(r){return this._chunk.getRestrictedFunctionForGLSL(r)}getCapFunction(r){return this._chunk.getCapFunction(r)}polynomialOrder(r){return this._chunk.polynomialOrder(r,{allowRestriction:!0,allowClosedBlockReferences:!1})}getPolynomialCoefficients(r){for(var n=this._chunk.getPolynomialCoefficients(r),i=n.chunk,s=n.coefficients,o=[],a=0;a<s.length;a++){var u=i.copy();u.setReturnIndex(s[a]),u.close(),o.push(new e(u))}return o}takeDerivative(r){var n=this._chunk.copy().takeDerivative(r).close();return new e(n)}gradient(r){var n=this._chunk.copy().gradient(r).close();return new e(n)}toImplicitBool(){let r=this._chunk.copy();return r.GreaterEqual([r.getReturnIndex(),r.Constant(0)]),r.close(),new e(r)}interpretWithParameters(r){let n,i=this._chunk.argNames;if(r.length===i.length)n=r;else{n=[];let s=this.getDependencies();for(let o=0,a=0;o<i.length;o++)s[a]===i[o]?(n.push(r[a]),a+=1):n.push(void 0)}return this._chunk.interpretWithParameters(n)}substituteConstantArguments(r){return new e(this._chunk.substituteConstantArguments(r))}boundDomain(r){return this._chunk.boundDomain(r)}asValue(){if(this._chunk.isConstant())return this._chunk.asValue();if(this.isList){for(var r=[],n=ws(qi($e(this.valueType))),i=0;i<this.length;i++)r.push(n);return r}else return ws(qi(this.valueType))}asTypedValue(){return{valueType:this.valueType,value:this.asValue()}}asCompilerValue(){return this._chunk.asCompilerValue()}isNaN(){return typeof this.asValue()==\"number\"&&isNaN(this.asValue())}getEvaluationInfo(){return this._chunk.isConstant()&&this.getDependencies().length===0&&(ie(this.valueType,P)||ie(this.valueType,he))?[{val:this.asValue()}]:!1}findLinearSubset(r){return this._chunk.findLinearSubset(r)}deriveRegressionRestrictions(){var r=this._chunk.deriveRegressionRestrictions();return r===this._chunk?this:new e(r)}getCursorContext(){return this._chunk.getCursorContext()}};var Ld=class extends Q{};var wd=class extends Q{};var Ic=class extends Q{};var Fd=class extends Q{};var Vd=class extends Q{};var Ec=class extends Q{};var Bd=class extends Q{};var Gd=class extends Q{isInequality(){return this.args[0].isInequality()&&this.args[1].isInequality()}};var zd=class extends Q{};var Hd=class extends Ec{};function se(e,t){let r=Z0(e);return r.prototype.type=t,r}var AA={Base:se(yt,\"Base\"),Expression:se(Q,\"Expression\"),Error:se(R,\"Error\"),Constant:se(fr,\"Constant\"),MixedNumber:se(ff,\"MixedNumber\"),Identifier:se(gt,\"Identifier\"),Ans:se(df,\"Ans\"),List:se(Pa,\"List\"),Range:se(mf,\"Range\"),ListAccess:se(dc,\"ListAccess\"),DotAccess:se(Hi,\"DotAccess\"),Construction:se(yf,\"Construction\"),ParenSeq:se(os,\"ParenSeq\"),MovablePoint:se(gf,\"MovablePoint\"),NamedCoordinateAccess:se(hf,\"NamedCoordinateAccess\"),BareSeq:se(mc,\"BareSeq\"),Norm:se(bf,\"Norm\"),BaseComparator:se(yo,\"BaseComparator\"),DoubleInequality:se(Pf,\"DoubleInequality\"),RepeatedOperator:se(Ta,\"RepeatedOperator\"),Sum:se(Tf,\"Sum\"),Product:se(If,\"Product\"),Integral:se(Ef,\"Integral\"),AssignmentExpression:se(Mf,\"AssignmentExpression\"),ListComprehension:se(Df,\"ListComprehension\"),FunctionCall:se(Lr,\"FunctionCall\"),SeededFunctionCall:se(fu,\"SeededFunctionCall\"),FunctionExponent:se(vf,\"FunctionExponent\"),FunctionFactorial:se(Of,\"FunctionFactorial\"),Prime:se(Sf,\"Prime\"),Piecewise:se(Zo,\"Piecewise\"),Derivative:se(Rf,\"Derivative\"),UpdateRule:se(Nf,\"UpdateRule\"),Substitution:se(Af,\"Substitution\"),Histogram:se(Cf,\"Histogram\"),DotPlot:se(_f,\"DotPlot\"),BoxPlot:se(Lf,\"BoxPlot\"),TTest:se(wf,\"TTest\"),IndependentTTest:se(Ff,\"IndependentTTest\"),Stats:se(Vf,\"Stats\"),Assignment:se(Wo,\"Assignment\"),CoordinateEquation:se(Bf,\"CoordinateEquation\"),FunctionDefinition:se(Jo,\"FunctionDefinition\"),Equation:se(ho,\"Equation\"),Regression:se(Md,\"Regression\"),Image:se(Dd,\"Image\"),Ticker:se(vd,\"Ticker\"),Slider:se(Od,\"Slider\"),RegressionParameter:se(Sd,\"RegressionParameter\"),Table:se(Rd,\"Table\"),TableColumn:se(Eu,\"TableColumn\"),SolvedEquation:se(Nd,\"SolvedEquation\"),OptimizedRegression:se(Ad,\"OptimizedRegression\"),Seed:se(Cd,\"Seed\"),ExtendSeed:se(_d,\"ExtendSeed\"),IRExpression:se(sr,\"IRExpression\"),Add:se(Ld,\"Add\"),Subtract:se(as,\"Subtract\"),Multiply:se(wd,\"Multiply\"),DotMultiply:se(Ic,\"DotMultiply\"),CrossMultiply:se(Fd,\"CrossMultiply\"),Divide:se(Vd,\"Divide\"),Exponent:se(Ec,\"Exponent\"),Negative:se(Bd,\"Negative\"),And:se(Gd,\"And\"),PercentOf:se(zd,\"PercentOf\"),RawExponent:se(Hd,\"RawExponent\"),Comparator:{\"<\":se(go[\"<\"],\"Comparator['<']\"),\">\":se(go[\">\"],\"Comparator['>']\"),\"<=\":se(go[\"<=\"],\"Comparator['<=']\"),\">=\":se(go[\">=\"],\"Comparator['>=']\"),\"=\":se(go[\"=\"],\"Comparator['=']\")}},I=AA;var jr={xmin:-5,xmax:5,ymin:-5,ymax:5,zmin:-5,zmax:5};function ux(e,t){let r=Math.round(1e6*e)/1e6;return Math.abs(r-e)<t?r:e}function Hq(e){let t=!0,r=!0,n=!0;return e.hardMin!==void 0&&e.target<e.hardMin&&(t=!1),e.hardMax!==void 0&&e.target>e.hardMax&&(r=!1),e.step&&Ud({target:e.target,step:e.step,hardMin:t?e.hardMin:void 0,hardMax:r?e.hardMax:void 0})!==e.target&&(n=!1),{min:t,max:r,step:n}}function Ud(e){let{target:t,hardMin:r,hardMax:n,step:i}=e,s=1e-10;if(r!==void 0&&n!==void 0&&(s=Math.min(s,Math.abs(n-r)/1e3)),i&&(s=Math.min(s,i/10)),r!==void 0&&(r=ux(r,s)),n!==void 0&&(n=ux(n,s)),e.forceSliderToMax&&n!==void 0&&(t=n),r>n||t<=r)return r;if(t>=n)return n;if(i){let u=r!==void 0?r:0;var o=Math.round((t-u)/i);t=i*o+u}let a=ux(t,s);return(i||r===a||n===a)&&(t=a),t<=r?r:t>=n?n:t}function Q0(e){let{storedMax:t,sliderValue:r,hardMin:n,step:i}=e,s=e.is3d?jr.xmax:10;if(t>s&&(s=t),r>s&&(s=r),n>s&&(s=n),i){let o=Ud({target:s,hardMin:n,hardMax:void 0,step:i});o>=s?s=o:s=o+i}return s}var lx=I.Constant,_A=I.Identifier;I.Base.prototype.tryGetConcreteTree=function(e,t,r={}){var n;try{n=this.getConcreteTree(e,t,r)}catch(i){i instanceof I.Base?n=i:n=ne(i)}return n};I.Base.prototype.getConcreteTree=function(e,t,r={}){var i;var n=this.buildIRExpression(e,t,{selection:(i=this.parseOptions)==null?void 0:i.selection,coerceToNumber:r.coerceToNumber});if(n.isError)throw n;return n};I.DoubleInequality.prototype.getConcreteTree=function(e,t){return new this.constructor([new I.Piecewise([this._indicator,this._expressions[0],new lx(NaN)]).getConcreteTree(e,t),this._operators[0],new _A(this._symbol),this._operators[1],new I.Piecewise([this._indicator,this._expressions[1],new lx(NaN)]).getConcreteTree(e,t)])};I.Error.prototype.getConcreteTree=function(e,t){return this};function ql(e,t){return e.isError?e:t.indexOf(e.valueType)===-1?yl():e}I.Image.prototype.getConcreteTree=function(e,t){var r=this.center.tryGetConcreteTree(e,t),n=this.radianAngle.tryGetConcreteTree(e,t),i=this.width.tryGetConcreteTree(e,t),s=this.height.tryGetConcreteTree(e,t),o=this.opacity.tryGetConcreteTree(e,t),a=[N,nt,Le],u=[P,te,Le];return r=ql(r,a),n=ql(n,u),i=ql(i,u),s=ql(s,u),o=ql(o,u),new I.Image({center:r,radianAngle:n,width:i,height:s,opacity:o},this.moveStrategy)};I.Ticker.prototype.getConcreteTree=function(e,t){var r=this.handler.tryGetConcreteTree(e,t);!r.isError&&r.valueType!==Je&&(r=Il(pe(r.valueType)));var n=r.getDependencies().filter(function(i){return!(e.graphingEnabled()&&e.validActionVariable(i))});return n.length&&(r=jt(e.sliderVariables(n)).setDependencies(n)),new I.Ticker({handler:r,minStep:this.minStep.tryGetConcreteTree(e,t)})};function cx(e,t,r){if(!t){r.valids[e]=!0;return}var n=t.getDependencies();if(t.isError)r.errors[e]=!0;else if(n.length>0){r.errors[e]=!0;for(var i=0;i<n.length;i++)n[i]===r.exportedSymbol?r.errors.cycle=!0:r.missingVars.push(n[i])}else r.values[e]=+t.asValue();r.valids[e]=isFinite(r.values[e]),r.valids[e]||(r.values[e]=void 0)}function kd(e){return e&&e.valueType===te&&e.length===1&&e.args?e.args[0]:e}I.Slider.prototype.getConcreteTree=function(e,t){var r=this._expression.getConcreteTree(e,t),n=kd(this.sliderMin&&this.sliderMin.tryGetConcreteTree(e,t)),i=kd(this.sliderMax&&this.sliderMax.tryGetConcreteTree(e,t)),s=kd(this.sliderStep&&this.sliderStep.tryGetConcreteTree(e,t)),o={exportedSymbol:this._symbol,errors:{},values:{},valids:{},missingVars:[],errMsg:void 0};if(cx(\"min\",n,o),cx(\"max\",i,o),cx(\"step\",s,o),s&&o.valids.step&&(o.values.step===0?delete o.values.step:o.values.step=Math.abs(o.values.step)),o.errors.cycle?r=nb(o.exportedSymbol):(o.errors.min||!o.valids.min?o.errMsg=ib():o.errors.max||!o.valids.max?o.errMsg=sb():(o.errors.step||!o.valids.step)&&(o.errMsg=ab()),o.values.min>o.values.max&&(o.valids.min=!1,o.valids.max=!1,o.errMsg||(o.errMsg=ob()))),r.isConstant){var a=t.initialEvaluation&&t.initialEvaluation.asValue(),u=a&&this.sliderIsPlayingOnce,c=o.values.max,l=+r.asValue(),p=o.values.min,f=o.values.step;if(u&&!isFinite(c)){var y=kd(this.sliderSoftMax&&this.sliderSoftMax.tryGetConcreteTree(e,t));y&&(c=Q0({storedMax:+y.asValue(),sliderValue:l,step:f,hardMin:p,is3d:e.is3dProduct()}))}var h=Ud({target:l,hardMin:p,hardMax:c,step:f,forceSliderToMax:!!u}),m=au(h.toString()),b=isFinite(Y(m))?m:h;r=new lx(b).getConcreteTree(e,t)}return r.sliderInfo=o,r};function K0(e,t){if(!t[this._symbol])throw ki(this._symbol);var r=this.args.map(function(i){return i.getConcreteTree(e,t)});if(r.length>0){if(r.length===1&&r.push(new I.Constant(1).getConcreteTree(e,t)),r[1].getDependencies().length)throw wl(this._symbol).setDependencies(r[1].getDependencies());if(r[1].valueType!==P)throw wl(this._symbol);var n=r[1].asValue();if(!isFinite(n)||n<=0)throw wl(this._symbol)}return this.typeCheck(e,r),new this.constructor(r)}I.Histogram.prototype.getConcreteTree=K0;I.DotPlot.prototype.getConcreteTree=K0;I.BoxPlot.prototype.getConcreteTree=function(e,t){if(!t[this._symbol])throw ki(this._symbol);var r=this.args.map(function(n){return n.getConcreteTree(e,t)});return this.typeCheck(e,r),r.length===1&&(r[0].valueType===te||r[0].valueType===Le)?new this.constructor(r):ne(\"Failed to copmile BoxPlot\")};function px(e,t){if(!t[this._symbol])throw ki(this._symbol);var r=this.args.map(function(n){return n.getConcreteTree(e,t)});return this.typeCheck(e,r),new this.constructor(r)}I.TTest.prototype.getConcreteTree=px;I.IndependentTTest.prototype.getConcreteTree=px;I.Stats.prototype.getConcreteTree=px;I.Table.prototype.getConcreteTree=function(e,t){for(var r=[],n=Object.create(t),i=0;i<this.columns.length;i++){var s=this.columns[i].getConcreteTree(e,n);s.isIndependent&&this.columns[i].exportToLocal(e,s,n),r.push(s)}return new this.constructor(r)};I.TableColumn.prototype.getConcreteTree=function(e,t){var u;var r=this.header.getConcreteTree(e,t),n,i,s=this.header instanceof I.Identifier&&!t[this.header._symbol];if(s){n=[];for(var o=0;o<this.values.length;o++){if(this.values[o].tableError()){n.push(Pc(this.values[o].tableError()));continue}var a=this.values[o].tryGetConcreteTree(e,t);a.isError?n.push(a):a.tableError()?n.push(Pc(a.tableError())):a.valueType===P?n.push(a):n.push(rh([pe(a.valueType)]))}return i=new this.constructor(r,n),i.isIndependent=!0,i}else return r.isList?n=r.mapElements(function(c){return c}):n=[],!r.isError&&r.valueType!==P&&r.valueType!==te&&r.valueType!==Le&&(r=th([pe((u=r.valueType)!=null?u:Tt)])),i=new this.constructor(r,n),i};function Yl(e,t,r){return{symbolMap:e,symbolNodeMap:t,maxIndex:r}}function fx(e,t){return e.symbolMap[t]}function eE(e,t){return e.symbolNodeMap[t]}function Mi(e,t,r,n){e.symbolNodeMap[t]=n,e.symbolMap[t]=r,e.maxIndex=Math.max(e.maxIndex,r)}function bo(e){return Yl(Object.create(e.symbolMap),Object.create(e.symbolNodeMap),e.maxIndex)}var Gs={};Ds(Gs,{acosh:()=>KE,acot:()=>hC,acoth:()=>DC,acsc:()=>bC,acsch:()=>MC,addTangentAngle:()=>q_,addTangentArc:()=>k_,addTangentCircle:()=>U_,addTangentLine:()=>z_,addTangentRay:()=>H_,addTangentSegment:()=>eP,addTangentSegmentThreeD:()=>G_,angleMarkerMultiplier:()=>N_,angleMarkerRawDelta:()=>R_,arc:()=>O_,arcArcIntersection:()=>Q_,arcCenter:()=>Lc,arcCircleIntersection:()=>J_,arcGlider:()=>LM,arcLineIntersection:()=>BM,arcOmega:()=>wc,argMax:()=>JC,argMin:()=>jC,asec:()=>xC,asech:()=>EC,asinh:()=>eM,atanh:()=>tM,basePointFromVector:()=>x_,basePointFromVectorThreeD:()=>I_,bernoulliTable:()=>aM,binomSample:()=>VC,binomcdf:()=>GC,binompdf:()=>hm,center:()=>D_,chooseNonIncidentPoint:()=>Z_,circle:()=>M_,circleArcIntersection:()=>j_,circleCircleIntersection:()=>sp,circleGlider:()=>X_,circleLineIntersection:()=>iP,clamp:()=>Jr,common_log:()=>fC,composeTransformation:()=>pL,corr:()=>xm,cos:()=>tr,cosh:()=>jE,cot:()=>gC,cotDerivative:()=>uM,coth:()=>IC,cov:()=>KC,covp:()=>DM,csc:()=>yC,csch:()=>TC,dilation:()=>uL,directedAngleMarker:()=>CM,directedCoterminalAngle:()=>_M,distance:()=>Ac,distanceThreeD:()=>n_,elementsAt:()=>IL,erf:()=>UC,erfcx:()=>ta,expm1:()=>nC,factorial:()=>Cu,gamma:()=>ip,gcd:()=>Bx,getArcDetails:()=>Pm,hsv:()=>i_,hypot:()=>Bs,identity:()=>E_,invBinom:()=>gM,invNorm:()=>qx,invPoisson:()=>yM,invT:()=>hM,invUniform:()=>qC,invertTransformation:()=>fL,isDegenerateArc:()=>Qx,itscore:()=>xM,ittest:()=>Xx,lcm:()=>iM,line:()=>g_,lineArcIntersection:()=>VM,lineCircleIntersection:()=>nP,lineGlider:()=>tP,lineLineIntersection:()=>FM,listGCD:()=>aC,listLCM:()=>uC,listLength:()=>YC,listMax:()=>TM,listMin:()=>PM,lnGamma:()=>lC,log:()=>pC,log1p:()=>op,log_base:()=>lM,lowerQuantileIndex:()=>$C,lowerQuartileIndex:()=>WC,mad:()=>QC,mathVector:()=>RM,mathVectorThreeD:()=>NM,md5Spyable:()=>WE,mean:()=>Do,median:()=>EM,mod:()=>nM,nCr:()=>Sa,nPr:()=>cm,normalSample:()=>wC,normalcdf:()=>_C,normalpdf:()=>zx,nthroot:()=>dC,parallel:()=>rL,perpendicular:()=>nL,pointDet:()=>HM,pointDot:()=>iL,pointPerp:()=>sL,poissonSample:()=>BC,poissoncdf:()=>zC,poissonpdf:()=>Nc,polyGamma:()=>cM,polygon:()=>s_,polygonArea:()=>jx,polygonEdges:()=>l_,polygonGlider:()=>$_,polygonInteriorDirectedAngles:()=>y_,polygonInteriorUndirectedAngles:()=>m_,polygonPerimeter:()=>p_,pow:()=>rM,quad:()=>r_,quantile:()=>IM,quartile:()=>_u,quartileIndex:()=>bm,radius:()=>v_,random:()=>Hx,randomPerm:()=>Ux,rank:()=>Lx,ray:()=>h_,rayGlider:()=>wx,reflection:()=>lL,rgb:()=>vM,rotation:()=>cL,scaleTangentAngle:()=>B_,scaleTangentArc:()=>V_,scaleTangentCircle:()=>F_,scaleTangentLine:()=>L_,scaleTangentRay:()=>w_,scaleTangentSegment:()=>Kx,sec:()=>mC,sech:()=>PC,segment:()=>Jx,segmentGlider:()=>rP,segmentThreeD:()=>o_,segmentThreeDGlider:()=>Y_,select:()=>TL,shuffle:()=>LC,sign:()=>Vx,sin:()=>Ct,sinh:()=>JE,sortPerm:()=>Lu,spearman:()=>e_,sphere:()=>u_,sqrtxsqm1:()=>oC,sqrtxsqp1:()=>sC,stats:()=>$x,stdev:()=>lm,stdevp:()=>t_,supplementAngle:()=>C_,tSample:()=>FC,tan:()=>fM,tanh:()=>QE,tcdf:()=>am,toFraction:()=>iC,total:()=>vC,tpdf:()=>gm,transformAngleMarker:()=>PL,transformArc:()=>bL,transformCircle:()=>hL,transformLine:()=>mL,transformPoint:()=>Mo,transformPolygon:()=>xL,transformRay:()=>yL,transformSegment:()=>Tm,transformVector:()=>gL,transformation:()=>oL,translation:()=>aL,triangle:()=>a_,tscore:()=>bM,ttest:()=>Yx,undirectedAngleMarker:()=>S_,undirectedCoterminalAngle:()=>A_,uniformSample:()=>Ra,uniformcdf:()=>HC,uniformpdf:()=>kx,uniquePerm:()=>EL,upperQuantileIndex:()=>XC,upperQuartileIndex:()=>ZC,validateRangeLength:()=>Zx,validateSampleCount:()=>Wx,variance:()=>MM,varp:()=>ap,vector:()=>SM,vectorDisplacementAsPoint:()=>b_,vectorThreeD:()=>P_,vectorThreeDDisplacementAsPoint:()=>T_,vertices:()=>c_});var rE=function(){\"use strict\";function e(m,b){var d=(m&65535)+(b&65535),g=(m>>16)+(b>>16)+(d>>16);return g<<16|d&65535}function t(m,b){return m<<b|m>>>32-b}function r(m,b,d,g,x,M){return e(t(e(e(b,m),e(g,M)),x),d)}function n(m,b,d,g,x,M,E){return r(b&d|~b&g,m,b,x,M,E)}function i(m,b,d,g,x,M,E){return r(b&g|d&~g,m,b,x,M,E)}function s(m,b,d,g,x,M,E){return r(b^d^g,m,b,x,M,E)}function o(m,b,d,g,x,M,E){return r(d^(b|~g),m,b,x,M,E)}function a(m,b){m[b>>5]|=128<<b%32,m[(b+64>>>9<<4)+14]=b;var d,g,x,M,E,T=1732584193,D=-271733879,S=-1732584194,O=271733878;for(d=0;d<m.length;d+=16)g=T,x=D,M=S,E=O,T=n(T,D,S,O,m[d],7,-680876936),O=n(O,T,D,S,m[d+1],12,-389564586),S=n(S,O,T,D,m[d+2],17,606105819),D=n(D,S,O,T,m[d+3],22,-1044525330),T=n(T,D,S,O,m[d+4],7,-176418897),O=n(O,T,D,S,m[d+5],12,1200080426),S=n(S,O,T,D,m[d+6],17,-1473231341),D=n(D,S,O,T,m[d+7],22,-45705983),T=n(T,D,S,O,m[d+8],7,1770035416),O=n(O,T,D,S,m[d+9],12,-1958414417),S=n(S,O,T,D,m[d+10],17,-42063),D=n(D,S,O,T,m[d+11],22,-1990404162),T=n(T,D,S,O,m[d+12],7,1804603682),O=n(O,T,D,S,m[d+13],12,-40341101),S=n(S,O,T,D,m[d+14],17,-1502002290),D=n(D,S,O,T,m[d+15],22,1236535329),T=i(T,D,S,O,m[d+1],5,-165796510),O=i(O,T,D,S,m[d+6],9,-1069501632),S=i(S,O,T,D,m[d+11],14,643717713),D=i(D,S,O,T,m[d],20,-373897302),T=i(T,D,S,O,m[d+5],5,-701558691),O=i(O,T,D,S,m[d+10],9,38016083),S=i(S,O,T,D,m[d+15],14,-660478335),D=i(D,S,O,T,m[d+4],20,-405537848),T=i(T,D,S,O,m[d+9],5,568446438),O=i(O,T,D,S,m[d+14],9,-1019803690),S=i(S,O,T,D,m[d+3],14,-187363961),D=i(D,S,O,T,m[d+8],20,1163531501),T=i(T,D,S,O,m[d+13],5,-1444681467),O=i(O,T,D,S,m[d+2],9,-51403784),S=i(S,O,T,D,m[d+7],14,1735328473),D=i(D,S,O,T,m[d+12],20,-1926607734),T=s(T,D,S,O,m[d+5],4,-378558),O=s(O,T,D,S,m[d+8],11,-2022574463),S=s(S,O,T,D,m[d+11],16,1839030562),D=s(D,S,O,T,m[d+14],23,-35309556),T=s(T,D,S,O,m[d+1],4,-1530992060),O=s(O,T,D,S,m[d+4],11,1272893353),S=s(S,O,T,D,m[d+7],16,-155497632),D=s(D,S,O,T,m[d+10],23,-1094730640),T=s(T,D,S,O,m[d+13],4,681279174),O=s(O,T,D,S,m[d],11,-358537222),S=s(S,O,T,D,m[d+3],16,-722521979),D=s(D,S,O,T,m[d+6],23,76029189),T=s(T,D,S,O,m[d+9],4,-640364487),O=s(O,T,D,S,m[d+12],11,-421815835),S=s(S,O,T,D,m[d+15],16,530742520),D=s(D,S,O,T,m[d+2],23,-995338651),T=o(T,D,S,O,m[d],6,-198630844),O=o(O,T,D,S,m[d+7],10,1126891415),S=o(S,O,T,D,m[d+14],15,-1416354905),D=o(D,S,O,T,m[d+5],21,-57434055),T=o(T,D,S,O,m[d+12],6,1700485571),O=o(O,T,D,S,m[d+3],10,-1894986606),S=o(S,O,T,D,m[d+10],15,-1051523),D=o(D,S,O,T,m[d+1],21,-2054922799),T=o(T,D,S,O,m[d+8],6,1873313359),O=o(O,T,D,S,m[d+15],10,-30611744),S=o(S,O,T,D,m[d+6],15,-1560198380),D=o(D,S,O,T,m[d+13],21,1309151649),T=o(T,D,S,O,m[d+4],6,-145523070),O=o(O,T,D,S,m[d+11],10,-1120210379),S=o(S,O,T,D,m[d+2],15,718787259),D=o(D,S,O,T,m[d+9],21,-343485551),T=e(T,g),D=e(D,x),S=e(S,M),O=e(O,E);return[T,D,S,O]}function u(m){var b,d=\"\",g=m.length*32;for(b=0;b<g;b+=8)d+=String.fromCharCode(m[b>>5]>>>b%32&255);return d}function c(m){var b,d=[];for(d[(m.length>>2)-1]=void 0,b=0;b<d.length;b+=1)d[b]=0;var g=m.length*8;for(b=0;b<g;b+=8)d[b>>5]|=(m.charCodeAt(b/8)&255)<<b%32;return d}function l(m){return u(a(c(m),m.length*8))}function p(m){var b=\"0123456789abcdef\",d=\"\",g,x;for(x=0;x<m.length;x+=1)g=m.charCodeAt(x),d+=b.charAt(g>>>4&15)+b.charAt(g&15);return d}function f(m){return unescape(encodeURIComponent(m))}function y(m){return l(f(m))}function h(m){return p(y(m))}return h}();function Qo(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function Ia(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Po(){}var Ea=.7,Ou=1/Ea,Mc=\"\\\\s*([+-]?\\\\d+)\\\\s*\",Xl=\"\\\\s*([+-]?(?:\\\\d*\\\\.)?\\\\d+(?:[eE][+-]?\\\\d+)?)\\\\s*\",xo=\"\\\\s*([+-]?(?:\\\\d*\\\\.)?\\\\d+(?:[eE][+-]?\\\\d+)?)%\\\\s*\",LA=/^#([0-9a-f]{3,8})$/,wA=new RegExp(`^rgb\\\\(${Mc},${Mc},${Mc}\\\\)$`),FA=new RegExp(`^rgb\\\\(${xo},${xo},${xo}\\\\)$`),VA=new RegExp(`^rgba\\\\(${Mc},${Mc},${Mc},${Xl}\\\\)$`),BA=new RegExp(`^rgba\\\\(${xo},${xo},${xo},${Xl}\\\\)$`),GA=new RegExp(`^hsl\\\\(${Xl},${xo},${xo}\\\\)$`),zA=new RegExp(`^hsla\\\\(${Xl},${xo},${xo},${Xl}\\\\)$`),nE={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Qo(Po,$l,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:iE,formatHex:iE,formatHex8:HA,formatHsl:UA,formatRgb:sE,toString:sE});function iE(){return this.rgb().formatHex()}function HA(){return this.rgb().formatHex8()}function UA(){return pE(this).formatHsl()}function sE(){return this.rgb().formatRgb()}function $l(e){var t,r;return e=(e+\"\").trim().toLowerCase(),(t=LA.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?oE(t):r===3?new an(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?qd(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?qd(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=wA.exec(e))?new an(t[1],t[2],t[3],1):(t=FA.exec(e))?new an(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=VA.exec(e))?qd(t[1],t[2],t[3],t[4]):(t=BA.exec(e))?qd(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=GA.exec(e))?cE(t[1],t[2]/100,t[3]/100,1):(t=zA.exec(e))?cE(t[1],t[2]/100,t[3]/100,t[4]):nE.hasOwnProperty(e)?oE(nE[e]):e===\"transparent\"?new an(NaN,NaN,NaN,0):null}function oE(e){return new an(e>>16&255,e>>8&255,e&255,1)}function qd(e,t,r,n){return n<=0&&(e=t=r=NaN),new an(e,t,r,n)}function Zl(e){return e instanceof Po||(e=$l(e)),e?(e=e.rgb(),new an(e.r,e.g,e.b,e.opacity)):new an}function Su(e,t,r,n){return arguments.length===1?Zl(e):new an(e,t,r,n==null?1:n)}function an(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}Qo(an,Su,Ia(Po,{brighter(e){return e=e==null?Ou:Math.pow(Ou,e),new an(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ea:Math.pow(Ea,e),new an(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new an(vu(this.r),vu(this.g),vu(this.b),Xd(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:aE,formatHex:aE,formatHex8:kA,formatRgb:uE,toString:uE}));function aE(){return`#${Du(this.r)}${Du(this.g)}${Du(this.b)}`}function kA(){return`#${Du(this.r)}${Du(this.g)}${Du(this.b)}${Du((isNaN(this.opacity)?1:this.opacity)*255)}`}function uE(){let e=Xd(this.opacity);return`${e===1?\"rgb(\":\"rgba(\"}${vu(this.r)}, ${vu(this.g)}, ${vu(this.b)}${e===1?\")\":`, ${e})`}`}function Xd(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function vu(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Du(e){return e=vu(e),(e<16?\"0\":\"\")+e.toString(16)}function cE(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Fs(e,t,r,n)}function pE(e){if(e instanceof Fs)return new Fs(e.h,e.s,e.l,e.opacity);if(e instanceof Po||(e=$l(e)),!e)return new Fs;if(e instanceof Fs)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),s=Math.max(t,r,n),o=NaN,a=s-i,u=(s+i)/2;return a?(t===s?o=(r-n)/a+(r<n)*6:r===s?o=(n-t)/a+2:o=(t-r)/a+4,a/=u<.5?s+i:2-s-i,o*=60):a=u>0&&u<1?0:o,new Fs(o,a,u,e.opacity)}function $d(e,t,r,n){return arguments.length===1?pE(e):new Fs(e,t,r,n==null?1:n)}function Fs(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Qo(Fs,$d,Ia(Po,{brighter(e){return e=e==null?Ou:Math.pow(Ou,e),new Fs(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ea:Math.pow(Ea,e),new Fs(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new an(dx(e>=240?e-240:e+120,i,n),dx(e,i,n),dx(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new Fs(lE(this.h),Yd(this.s),Yd(this.l),Xd(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=Xd(this.opacity);return`${e===1?\"hsl(\":\"hsla(\"}${lE(this.h)}, ${Yd(this.s)*100}%, ${Yd(this.l)*100}%${e===1?\")\":`, ${e})`}`}}));function lE(e){return e=(e||0)%360,e<0?e+360:e}function Yd(e){return Math.max(0,Math.min(1,e||0))}function dx(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}var Zd=Math.PI/180,Wd=180/Math.PI;var jd=18,fE=.96422,dE=1,mE=.82521,yE=4/29,Dc=6/29,gE=3*Dc*Dc,qA=Dc*Dc*Dc;function hE(e){if(e instanceof To)return new To(e.l,e.a,e.b,e.opacity);if(e instanceof Ko)return xE(e);e instanceof an||(e=Zl(e));var t=hx(e.r),r=hx(e.g),n=hx(e.b),i=mx((.2225045*t+.7168786*r+.0606169*n)/dE),s,o;return t===r&&r===n?s=o=i:(s=mx((.4360747*t+.3850649*r+.1430804*n)/fE),o=mx((.0139322*t+.0971045*r+.7141733*n)/mE)),new To(116*i-16,500*(s-i),200*(i-o),e.opacity)}function bx(e,t,r,n){return arguments.length===1?hE(e):new To(e,t,r,n==null?1:n)}function To(e,t,r,n){this.l=+e,this.a=+t,this.b=+r,this.opacity=+n}Qo(To,bx,Ia(Po,{brighter(e){return new To(this.l+jd*(e==null?1:e),this.a,this.b,this.opacity)},darker(e){return new To(this.l-jd*(e==null?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,r=isNaN(this.b)?e:e-this.b/200;return t=fE*yx(t),e=dE*yx(e),r=mE*yx(r),new an(gx(3.1338561*t-1.6168667*e-.4906146*r),gx(-.9787684*t+1.9161415*e+.033454*r),gx(.0719453*t-.2289914*e+1.4052427*r),this.opacity)}}));function mx(e){return e>qA?Math.pow(e,1/3):e/gE+yE}function yx(e){return e>Dc?e*e*e:gE*(e-yE)}function gx(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function hx(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function YA(e){if(e instanceof Ko)return new Ko(e.h,e.c,e.l,e.opacity);if(e instanceof To||(e=hE(e)),e.a===0&&e.b===0)return new Ko(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Wd;return new Ko(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function bE(e,t,r,n){return arguments.length===1?YA(e):new Ko(e,t,r,n==null?1:n)}function Ko(e,t,r,n){this.h=+e,this.c=+t,this.l=+r,this.opacity=+n}function xE(e){if(isNaN(e.h))return new To(e.l,0,0,e.opacity);var t=e.h*Zd;return new To(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Qo(Ko,bE,Ia(Po,{brighter(e){return new Ko(this.h,this.c,this.l+jd*(e==null?1:e),this.opacity)},darker(e){return new Ko(this.h,this.c,this.l-jd*(e==null?1:e),this.opacity)},rgb(){return xE(this).rgb()}}));var EE=-.14861,xx=1.78277,Px=-.29227,Jd=-.90649,Wl=1.97294,PE=Wl*Jd,TE=Wl*xx,IE=xx*Px-Jd*EE;function XA(e){if(e instanceof Ru)return new Ru(e.h,e.s,e.l,e.opacity);e instanceof an||(e=Zl(e));var t=e.r/255,r=e.g/255,n=e.b/255,i=(IE*n+PE*t-TE*r)/(IE+PE-TE),s=n-i,o=(Wl*(r-i)-Px*s)/Jd,a=Math.sqrt(o*o+s*s)/(Wl*i*(1-i)),u=a?Math.atan2(o,s)*Wd-120:NaN;return new Ru(u<0?u+360:u,a,i,e.opacity)}function Tx(e,t,r,n){return arguments.length===1?XA(e):new Ru(e,t,r,n==null?1:n)}function Ru(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Qo(Ru,Tx,Ia(Po,{brighter(e){return e=e==null?Ou:Math.pow(Ou,e),new Ru(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ea:Math.pow(Ea,e),new Ru(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*Zd,t=+this.l,r=isNaN(this.s)?0:this.s*t*(1-t),n=Math.cos(e),i=Math.sin(e);return new an(255*(t+r*(EE*n+xx*i)),255*(t+r*(Px*n+Jd*i)),255*(t+r*(Wl*n)),this.opacity)}}));function qr(e,t,r){return e>0==t>0?r===1?t:e+r*(t-e):e*(1-r)+t*r}function hn(e,t,r){return[qr(e[0],t[0],r),qr(e[1],t[1],r)]}function Io(e,t,r){return[qr(e[0],t[0],r),qr(e[1],t[1],r),qr(e[2],t[2],r)]}function Qd(e,t){return[e[0]+t[0],e[1]+t[1]]}function Kd(e,t){return[e[0]-t[0],e[1]-t[1]]}function em(e,t){return[e[0]-t[0],e[1]-t[1],e[2]-t[2]]}function Nu(e,t){return rm(em(e,t))}function tm(e,t,r){return[qr(e[0],t[0],r[0]),qr(e[1],t[1],r[1])]}function rm(e){let[t,r,n]=e;return t*t+r*r+n*n}function vc(e,t){let r=e[1]*t[2]-e[2]*t[1],n=e[2]*t[0]-e[0]*t[2],i=e[0]*t[1]-e[1]*t[0],s=Math.sqrt(r*r+n*n+i*i);return[r/s,n/s,i/s]}function Ma(e,t,r){e=Math.fround(e),t=Math.fround(t),r=Math.fround(r);let n=Math.fround(e*e+t*t+r*r);return isFinite(n)&&n!=0}function Eo([e,t,r]){return isFinite(e)&&isFinite(t)&&isFinite(r)}function Di(e,t){let r;e>t&&(r=e,e=t,t=r);let n=e>0,i=t>0,s=Math.abs(e)>.01,o=Math.abs(t)>.01;if(s||o)return Yo(e,t);if(e===0)return t*Math.abs(t);if(t===0)return e*Math.abs(e);if(n!==i)return 0;let a=n?Math.sqrt(e*t):-Math.sqrt(e*t);return a>=e&&t>=a?a:Yo(e,t)}function vx(e,t,r,n,i){if(!(isNaN(t)||isNaN(n)||t<0==n<0))for(;;){let s=Di(e,r),o=i(s);if(!isFinite(o))return;if(s===e||s===r)return Math.abs(t)<=Math.abs(n)?[e,t]:[r,n];if(o===0)return Jl(e,t,s,o,r,n,i);t<0!=o<0?(r=s,n=o):(e=s,t=o)}}function _E(e,t,r,n,i){if(!(Ix(t)||Ix(n))&&Ex(t,n))for(;;){let s=Di(e,r),o=i(s);if(Ix(o))return;if(s===e||s===r)return s;if(Ex(t,o))r=s,n=o;else if(Ex(o,n))e=s,t=o;else return}}function Ix(e){for(let t of e)if(isNaN(t))return!0;return!1}function Ex(e,t){for(let r=0;r<e.length;r++)if(!$A(e[r],t[r]))return!1;return!0}function $A(e,t){return e<=0&&t>=0||e>=0&&t<=0}function Jl(e,t,r,n,i,s,o){let a;if(!isFinite(n))return;isFinite(t)||(a=Fn(e,t,r,n,o),a!==void 0&&(e=a,t=o(e))),isFinite(s)||(a=Fn(r,n,i,s,o),a!==void 0&&(i=a,s=o(a)));let u,c;t===n?u=[e,t]:u=ME(e,t,r,n,o,n),s===n?c=[i,s]:c=ME(r,n,i,s,o,n);let l;return u&&c&&(l=Di(u[0],c[0])),l!==void 0?[l,o(l)]:void 0}function Fn(e,t,r,n,i){if(isFinite(t)!==isFinite(n))for(;;){let s=Di(e,r),o=i(s);if(s===e||s===r)return isFinite(t)?e:r;isFinite(o)!==isFinite(t)?(r=s,n=o):(e=s,t=o)}}function nm(e,t,r,n,i){if(Eo(t)!==Eo(n))for(;;){let s=Di(e,r),o=i(s);if(s===e||s===r)return Eo(t)?e:r;Eo(o)!==Eo(t)?(r=s,n=o):(e=s,t=o)}}function ME(e,t,r,n,i,s){if(t===s!=(n===s))for(;;){let o=Di(e,r),a=i(o);if(o===e||o===r)return t===s?[e,t]:[r,n];a===s!=(t===s)?(r=o,n=a):(e=o,t=a)}}function LE(e,t,r,n,i,s,o){if(e<r&&r<i&&isFinite(t)&&isFinite(n)&&isFinite(s)&&t!==n&&n!==s&&n>t==n>s)for(;;){let a=Di(e,r),u=o(a),c=Di(r,i),l=o(c);if(!isFinite(u)||!isFinite(l))return;if(a===e||a===r||c===r||c===i)return u>n==n>t?[a,u]:l>n==n>t?[c,l]:[r,n];if(u===n||l===n)return Jl(e,t,r,n,i,s,o);n>t&&u>t&&u>n||n<t&&u<t&&u<n?(i=r,s=n,r=a,n=u):n>t&&l>n&&l>s||n<t&&l<n&&l<s?(e=r,t=n,r=c,n=l):(e=a,t=u,i=c,s=l)}}function Yi([e,t],[r,n]){return(r-e)*(r-e)+(n-t)*(n-t)}function DE(e,t,r,n,i,s){let o=s(e),a=s(t),u=s(r),c=Yi(o,n),l=Yi(a,n),p=Yi(u,n);if(!(t<=e||r<=t)&&!(!isFinite(c)||!isFinite(l)||!isFinite(p))&&!(l>=c||l>=p))for(;;){if(Math.abs(u[0]-o[0])<i&&Math.abs(u[1]-o[1])<i)return[e,r];let f=Di(e,t),y=s(f),h=Yi(y,n),m=Di(t,r),b=s(m),d=Yi(b,n);if(!isFinite(h)||!isFinite(d))return;if(f===e||f===t||m===t||m===r)return h<l&&h<d?[f,f]:d<h&&d<l?[m,m]:[t,t];if((h===l||d===l)&&(t=.5*(f+t),a=s(t),l=Yi(a,n),h===l||d===l))return[e,r];h<l&&h<d?([r,t]=[t,f],[u,a]=[a,y],[p,l]=[l,h]):d<h&&d<l?([e,t]=[t,m],[o,a]=[a,b],[c,l]=[l,d]):([e,r]=[f,m],[o,u]=[y,b],[c,p]=[h,d])}}function vE(e,t,r){return t===void 0&&(t=-1/0),r===void 0&&(r=1/0),Math.min(r,Math.max(t,e))}function Mx(e,t,r,n,i,s){let o;if(n!==void 0&&i!==void 0){let p=.5*(n+i);o=r+.01*(r<p?i-n:n-i)}else o=Math.abs(r)>1?r*1.00001:r+1e-5;let a=e(r),u=e(o),c=Yi(a,t),l=Yi(u,t);if(!(!isFinite(c)||!isFinite(l))){if(c===l)return[r,o];for(l>c&&([r,o]=[o,r],[a,u]=[u,a],[c,l]=[l,c]);isFinite(r)&&isFinite(o)&&r!==o;){if(i!==void 0&&o>i)return[i,i];if(n!==void 0&&o<n)return[n,n];let p=r+3*(o-r),f=e(p),y=Yi(f,t);if(!isFinite(y))return[r,o];if(y===l)return[r,o];if(y>l){let h=o>r?DE(r,o,p,t,s,e):DE(p,o,r,t,s,e);return h&&[vE(h[0],n,i),vE(h[1],n,i)]}[r,c,o,l]=[o,l,p,y]}return[r,o]}}function OE(e,t,r,n){return r?n?Math.min(Yi(e(n[0]),t),Yi(e(n[1]),t))<Math.min(Yi(e(r[0]),t),Yi(e(r[1]),t)):!1:!0}function p8(e,t,r,n,i,s){let o=Mx(e,t,r,n,i,s);if(n!==void 0){let a=Mx(e,t,n,n,i,s);OE(e,t,o,a)&&(o=a)}if(i!==void 0){let a=Mx(e,t,i,n,i,s);OE(e,t,o,a)&&(o=a)}return o}function SE(e,t,r,n,i,s,o,a){let u=Math.abs(n-t),c=Math.abs(s-n),l=Math.abs(a-s);return u>c&&u>l?[e,r]:l>c&&l>u?[i,o]:[r,i]}function Oc(e,t,r,n,i,s,o,a=0){if(!((r-e)*(i-r)<=0)&&!(!isFinite(e)||!isFinite(r)||!isFinite(i))&&!(!isFinite(t)||!isFinite(s))){if(!isFinite(n)){let u=Fn(e,t,r,n,o),c=Fn(r,n,i,s,o);return u===void 0||c===void 0?void 0:[u,c]}if(!(Math.abs(n-((i-r)*t+(r-e)*s)/(i-e))<a))for(;;){let u=Di(e,r),c=o(u),l=Di(r,i),p=o(l),f=Math.abs(c-Yo(t,n)),y=Math.abs(n-Yo(c,p)),h=Math.abs(p-Yo(n,s));if(f<=a&&y<=a&&h<=a)return;if(!isFinite(c)){let m=Fn(e,t,u,c,o),b=Fn(u,c,i,s,o);return m===void 0||b===void 0?void 0:[m,b]}if(!isFinite(p)){let m=Fn(e,t,l,p,o),b=Fn(l,p,i,s,o);return m===void 0||b===void 0?void 0:[m,b]}if((u===e||u===r)&&(l===r||l===i))return Math.abs(n-t)>Math.abs(s-n)?[e,r]:[r,i];if(u===e||u===r)return SE(e,t,r,n,l,p,i,s);if(l===r||l===i)return SE(e,t,u,c,r,n,i,s);f>h&&f>=y?(i=r,s=n,r=u,n=c):h>f&&h>=y?(e=r,t=n,r=l,n=p):(e=u,t=c,i=l,s=p)}}}var ea=(Math.sqrt(5)-1)/2;function jl(e,t){return e>0==t>0?e+ea*(t-e):(1-ea)*e+ea*t}function Da(e,t){let r;e>t&&(r=e,e=t,t=r);let n=e>0,i=t>0,s=Math.abs(e)>.01,o=Math.abs(t)>.01;if(s||o)return jl(e,t);if(e===0)return t*Math.abs(t);if(t===0)return e*Math.abs(e);if(n!==i)return 0;let a=n?Math.sqrt(e*t):-Math.sqrt(e*t);return a>=e&&t>=a?a:jl(e,t)}function wE(e,t,r,n,i,s){if(!isFinite(e)||!isFinite(r)||!isFinite(t)||!isFinite(n))return;e>r&&([e,t,r,n]=[r,n,e,t]);let o=Da(e,r),a=i(o);if(Math.abs(a-jl(t,n))<=s)return;let u=Da(e,o),c=i(u);for(;;){let l=Math.abs(c-jl(t,a)),p=Math.abs(a-jl(n,c));if(l<=s&&p<=s)return;if(l>p){if(r=o,n=a,o=u,a=c,u=Da(e,o),c=i(u),u===e||u===o)return NE(e,t,o,a,r,n);if(!isFinite(c))return RE(e,t,u,c,r,n,i)}else{if(e=u,t=c,u=o,c=a,o=Da(r,o),a=i(o),o===r||o===u)return NE(e,t,u,c,r,n);if(!isFinite(a))return RE(e,t,o,a,r,n,i)}}}function RE(e,t,r,n,i,s,o){let a=Fn(e,t,r,n,o),u=Fn(r,n,i,s,o);if(!(a===void 0||u===void 0))return[a,u]}function NE(e,t,r,n,i,s){return Math.abs(n-t)>Math.abs(s-n)?[e,r]:[r,i]}function Dx(e,t,r){let n=e[0]*(1-ea)+t[0]*ea-r[0],i=e[1]*(1-ea)+t[1]*ea-r[1],s=e[2]*(1-ea)+t[2]*ea-r[2];return n*n+i*i+s*s}function FE(e,t,r,n,i,s){if(!isFinite(e)||!isFinite(r)||!Eo(t)||!Eo(n))return;e>r&&([e,t,r,n]=[r,n,e,t]);let o=Da(e,r),a=i(o),u=s*s;if(Dx(t,n,a)<=u)return;let c=Da(e,o),l=i(c);for(;;){let p=Dx(t,a,l),f=Dx(n,l,a);if(p<=u&&f<=u)return;if(p>f){if(r=o,n=a,o=c,a=l,c=Da(e,o),l=i(c),c===e||c===o)return CE(e,t,o,a,r,n);if(!Eo(l))return AE(e,t,c,l,r,n,i)}else{if(e=c,t=l,c=o,l=a,o=Da(r,o),a=i(o),o===r||o===c)return CE(e,t,c,l,r,n);if(!Eo(a))return AE(e,t,o,a,r,n,i)}}}function AE(e,t,r,n,i,s,o){let a=nm(e,t,r,n,o),u=nm(r,n,i,s,o);if(!(a===void 0||u===void 0))return[a,u]}function CE(e,t,r,n,i,s){return Nu(n,t)>Nu(s,n)?[e,r]:[r,i]}var WA=Oc,im=Fn,jA=3.154019550531224,VE=Math.pow(2,-13),va=VE*VE,BE=va*va,Ox=va,Rx=32,Vs=[],Oa=[];function JA(e,t){for(var r=Rx;r>0;r--){var n=jA/Rx*r,i=Math.sinh(n),s=Math.cosh(Math.PI/2*i),o=1/(Math.exp(Math.PI/2*i)*s),a=Math.cosh(n)/(s*s);e.push(o),t.push(a)}}JA(Vs,Oa);var HE=0;for(sm=0;sm<Oa.length;sm++)HE+=Oa[sm];var sm,om=1/(1+2*HE);function Wn(e,t,r){return .5*(t*(2-r)+e*r)}function QA(e,t,r){var n=.5*(t+r),i=WA(t,e(t),n,e(n),r,e(r),e);return i?.5*(i[0]+i[1]):n}function Ql(e,t,r,n,i){return{x1:e,x2:t,value:r,error:n,minerror:i}}function GE(e,t,r){var n=Math.abs(e(Wn(t,r,va))),i=Math.abs(e(Wn(t,r,2*va))),s=Math.abs(e(Wn(t,r,4*va)));return n<va||i<va?!1:n>1.95*i&&i>1.95*s}function Sx(e,t,r){var n=Wn(r,t,Vs[0]),i=Wn(t,r,Vs[0]),s=e(n),o=e(i),a=Wn(t,r,1),u=e(a),c,l;if(isFinite(u)&&!isFinite(s)){if(c=im(n,s,a,u,e),Math.abs((c-t)/(r-t))>Ox)return Ql(t,r,NaN,NaN,NaN);t=c,s=e(t)}if(isFinite(u)&&!isFinite(o)){if(l=im(a,u,i,o,e),Math.abs((l-r)/(r-t))>Ox)return Ql(t,r,NaN,NaN,NaN);r=l,o=e(r)}if(isFinite(s)&&isFinite(o)&&!isFinite(u)){if(c=im(n,s,a,u,e),l=im(a,u,i,o,e),Math.abs((l-c)/(r-t))>Ox)return Ql(t,r,NaN,NaN,NaN);u=.5*(c+l)}if(GE(e,t,r)||GE(e,r,t))return Ql(t,r,NaN,NaN,NaN);for(var p=u,f=0,y=0,h=0,m=0,b=0,d=0,g=0;g<Rx;g+=4)b=e(Wn(t,r,Vs[g])),d=e(Wn(r,t,Vs[g])),m=Math.max(m,Math.abs(b),Math.abs(d)),f+=Oa[g]*(b+d),b=e(Wn(t,r,Vs[g+1])),d=e(Wn(r,t,Vs[g+1])),m=Math.max(m,Math.abs(b),Math.abs(d)),h+=Oa[g+1]*(b+d),b=e(Wn(t,r,Vs[g+2])),d=e(Wn(r,t,Vs[g+2])),m=Math.max(m,Math.abs(b),Math.abs(d)),y+=Oa[g+2]*(b+d),b=e(Wn(t,r,Vs[g+3])),d=e(Wn(r,t,Vs[g+3])),m=Math.max(m,Math.abs(b),Math.abs(d)),h+=Oa[g+3]*(b+d);var x=p+f,M=x+y,E=M+h,T=Math.abs(y-x),D=Math.abs(h-M),S=om*(r-t)*E,O=om*Math.abs(r-t)*m*Oa[0],A;return T===0?A=om*Math.abs(r-t)*D:A=om*Math.abs(r-t)*D*(D/T)*(D/T),A=Math.max(A,O),Ql(t,r,S,A,O)}function zE(e){for(var t=-1/0,r=-1/0,n=-1,i=0,s=0;s<e.length;s++){var o=e[s];i+=o.value,o.error>t&&(t=o.error,n=s),o.minerror>r&&(r=o.minerror)}return{maxerror:t,maxminerror:r,maxindex:n,totalvalue:i}}function Kl(e,t,r,n=32){if(isNaN(t)||isNaN(r))return NaN;var i=1;if(t>r){var s=t;t=r,r=s,i=-1}if(t===1/0&&r===1/0)return NaN;if(t===-1/0&&r===-1/0)return NaN;if(t===-1/0&&r===1/0)return i*Kl(function(f){return e(f/((1+f)*(1-f)))*(1+f*f)/((1+f)*(1+f)*(1-f)*(1-f))},-1,1,n);if(t===-1/0)return i*Kl(function(f){return-e(r-f/(1-f))/((1-f)*(1-f))},1,0,n);if(r===1/0)return i*Kl(function(f){return e(t+f/(1-f))/((1-f)*(1-f))},0,1,n);for(var o=[Sx(e,t,r)],a=zE(o),u=1;u<n&&!(Math.abs(a.maxerror/a.totalvalue)<=32*BE||a.maxerror<=32*BE||a.maxerror<=32*a.maxminerror||!isFinite(a.maxerror)||!isFinite(a.maxminerror));u++){var c=o[o.length-1];o[o.length-1]=o[a.maxindex],o[a.maxindex]=c;var l=o.pop(),p=QA(e,Wn(l.x2,l.x1,.125),Wn(l.x1,l.x2,.125));o.push(Sx(e,l.x1,p)),o.push(Sx(e,p,l.x2)),a=zE(o)}return!isFinite(a.maxerror)||!isFinite(a.maxminerror)?NaN:Math.abs(a.totalvalue)<=10*a.maxminerror?0:i*a.totalvalue}var ep=class{constructor(t){this.comparator=t;this._data=[]}size(){return this._data.length}queue(t){let r=this._data.length;for(this._data.push(t);r>0;){let n=r-1>>>1;if(this.comparator(this._data[r],this._data[n])<0){let i=this._data[n];this._data[n]=this._data[r],this._data[r]=i,r=n}else break}}dequeue(){let t=this._data[0],r=this._data.pop();if(this._data.length>0&&r!==void 0){this._data[0]=r;let n=0,i=this._data.length-1;for(;;){let s=(n<<1)+1,o=s+1,a=n;if(s<=i&&this.comparator(this._data[s],this._data[a])<0&&(a=s),o<=i&&this.comparator(this._data[o],this._data[a])<0&&(a=o),a!==n){let u=this._data[a];this._data[a]=this._data[n],this._data[n]=u,n=a}else break}}return t}peek(){return this._data[0]}clear(){this._data.length=0}};function eC(e,t){let r=e.start[1]-e.end[1],n=e.end[0]-e.start[0],i=t.start[1]-t.end[1],s=t.end[0]-t.start[0],o=r*e.end[0]+n*e.end[1],a=i*t.end[0]+s*t.end[1],u=r*s-i*n;if(u!==0)return(r*a-i*o)/u}function tC(e,t,r){if(r.xSlope>=t.xSlope)return;if(t.scanlineX===r.scanlineX)return e;let n=t.start[1]>t.end[1]?t.start:t.end,i=r.start[1]>r.end[1]?r.start:r.end,s=n[1];if(i[1]<n[1]){if(s=i[1],Nx(s,t)<i[0])return}else if(n[1]<i[1]){let a=Nx(s,r);if(n[0]<a)return}else if(n[0]<i[0])return;let o=eC(t,r);if(o!==void 0)return Math.max(Math.min(o,s),e)}function Nx(e,t){let r=t.end[0],n=t.start[0],i=t.end[1],s=t.start[1];if(i===e)return r;if(s===e)return n;{let o=(e-i)/(s-i),a=(1-o)*r+o*n;if(r<n){if(a<=r)return r;if(n<=a)return n}else{if(a<=n)return n;if(r<=a)return r}return a}}function Ax(e){let t=0,r=0,n=!1,i=0;for(let{scanlineX:s,isClockwise:o}of e)o?i+=1:i-=1,i!==0&&!n?(n=!0,r=s):i===0&&n&&(n=!1,t+=s-r);return t}var tp=class{constructor(t){this.scanlineY=-1/0;let r=1;this.activeEdges=[],this.events=new ep(function(n,i){return n.y-i.y}),this.scanlineY=-1/0,this.polygonLength=t.length-1;for(let n=t.length-1;n>=1;n--){let i=t[n],s=t[n-1],o={id:r++,index:n-1,end:i,start:s,scanlineX:0,xSlope:1/0,isClockwise:s[1]>i[1],skipIntersectionWith:{}};s[1]>i[1]?(this.events.queue({type:\"+\",y:i[1],edge:o}),this.events.queue({type:\"-\",y:s[1],edge:o}),o.xSlope=(s[0]-i[0])/(s[1]-i[1]),o.scanlineX=i[0]):i[1]>s[1]?(this.events.queue({type:\"+\",y:s[1],edge:o}),this.events.queue({type:\"-\",y:i[1],edge:o}),o.xSlope=(i[0]-s[0])/(i[1]-s[1]),o.scanlineX=s[0]):this.events.queue({type:\"h\",y:s[1],edge:o})}}nextScanline(){var s;let t,r=this.events.peek();if(!r)return;if(r.y<=this.scanlineY)throw new Error(\"Programming error: expected next event to begin a new scanline\");this.scanlineY=r.y,this.updateActiveEdgeScanlineIntersections();let n=Ax(this.activeEdges),i=[];for(;t=this.events.dequeue();)if(t.type===\"x\"?this.swapActiveEdges(t):t.type===\"+\"?this.insertActiveEdge(t):t.type===\"-\"&&this.removeActiveEdge(t),i.push(t),((s=this.events.peek())==null?void 0:s.y)!==this.scanlineY)return{y:this.scanlineY,activeEdges:this.activeEdges,lengthBeforeProcessingEvents:n,events:i}}updateActiveEdgeScanlineIntersections(){let t=-1/0;for(let r of this.activeEdges){let n=Nx(this.scanlineY,r);n<t?n=t:t=n,r.scanlineX=n}}insertActiveEdge(t){let r=this.activeEdges,n=t.edge,i=t.y,{xSlope:s,scanlineX:o}=n;for(var a=0;a<r.length;a++){let u=r[a];if(o<u.scanlineX||o===u.scanlineX&&s<=u.xSlope)break}r.splice(a,0,n),this.checkIntersection(i,r[a-1],n),this.checkIntersection(i,n,r[a+1])}checkIntersection(t,r,n){if(!r||!n||r.index===(n.index+1)%this.polygonLength||n.index===(r.index+1)%this.polygonLength)return;if(r.id<n.id){if(r.skipIntersectionWith[n.id])return}else if(n.skipIntersectionWith[r.id])return;let i=tC(t,r,n);if(i===void 0)return;r.id<n.id?r.skipIntersectionWith[n.id]=!0:n.skipIntersectionWith[r.id]=!0;let s={type:\"x\",y:i,edge1:r,edge2:n};this.events.queue(s)}removeActiveEdge(t){let r=this.activeEdges,n=t.edge,i=t.y,s=r.indexOf(n);r.splice(s,1),this.checkIntersection(i,r[s-1],r[s])}swapActiveEdges(t){let r=this.activeEdges,n=t.edge1,i=t.edge2,s=t.y,o=r.indexOf(n),a=o+1;o===-1||r[a]!==i?n.id<i.id?delete n.skipIntersectionWith[i.id]:delete i.skipIntersectionWith[n.id]:(r[o]=i,r[a]=n,this.checkIntersection(s,r[o-1],i),this.checkIntersection(s,n,r[a+1]))}static debugEvent(t){let r=`y=${t.y} `;return r+=t.type===\"x\"?`[x ${t.edge1.index}/${t.edge2.index}]`:`[${t.type} ${t.edge.index}] (${t.edge.end})-(${t.edge.start})`,r}debugState(){return`y=${this.scanlineY}\n${this.activeEdges.map(t=>`[${t.index}] ${t.scanlineX}`)}`}};function rC(e){let t=e.slice(0,2),r=e.slice(-2);return t[0]!==r[0]||t[1]!==r[1]?[...e,...t]:e}function g8(e,t){if(!e)return!1;let r=rC(e),[n,i]=t,s=0;for(var o=r.length-1;o>=3;o-=2){let a=r[o-3],u=r[o-2],c=r[o-1],l=r[o];u>i!=l>i&&n<(c-a)*(i-u)/(l-u)+a&&(u>l?s+=1:u<l&&(s-=1))}return s!==0}function kE(e){if(e.length<4||e[0][0]!==e[e.length-1][0]||e[0][1]!==e[e.length-1][1])return 0;let t=new tp(e),r,n=0,i;for(;i=t.nextScanline();){let s=i.lengthBeforeProcessingEvents;r&&(n+=.5*(i.y-r.y)*(s+r.length)),r={y:i.y,length:Ax(i.activeEdges)}}return n}function qE(e){if(!e.length)return[];if(e[0][0]!==e[e.length-1][0]||e[0][1]!==e[e.length-1][1])throw new Error(\"Programming error: expected last point to be a duplicate of the first point.\");for(let f=0;f<e.length-1;f++)if(e[f][0]===e[f+1][0]&&e[f][1]===e[f+1][1])throw new Error(`Programming error: unexpected duplicate point at ${f+1}`);let t=new tp(e),r=e.slice(0,-1).map(()=>0),n;for(;n=t.nextScanline();)for(let f of n.events){let y={};if(f.type===\"h\"){let h=f.edge;y[h.index]={xMin:Math.min(h.end[0],h.start[0]),xMax:Math.max(h.end[0],h.start[0]),dx:h.end[0]-h.start[0]}}else if(f.type===\"x\"){let h=f.edge1,m=f.edge2,b=UE([h.start,h.end],[m.start,m.end]),d=b>0?-1:b<0?1:0;r[h.index]+=d,r[m.index]-=d}for(let h of n.activeEdges){let m=h.end[1]-h.start[1];for(let b in y){let{xMin:d,xMax:g,dx:x}=y[b];if(d<h.scanlineX&&h.scanlineX<g){let M=x*m,E=M>0?-1:M<0?1:0;r[b]+=E,r[h.index]-=E}}}}let i=e.slice(0,-1).map(()=>0),s=e[0][1],o=0;for(let f=1;f<e.length;f++)e[f][1]<s&&(s=e[f][1],o=f);let a=e.length-1,u=o>0?o-1:a-1,c=(o+1)%a,p=UE([e[u],e[o]],[e[o],e[c]])>0?1:0;i[o]=p>0?-1:1;for(let f=0;f<a-1;f++){let y=(o+f)%a;p+=r[y],i[(y+1)%a]=p>0?-1:1}return i}function UE(e,t){let r=e[1][0]-e[0][0],n=e[1][1]-e[0][1],i=t[1][0]-t[0][0],s=t[1][1]-t[0][1];return r*s-n*i}var WE={spy:rE},{cosh:jE,sinh:JE,tanh:QE,acosh:KE,asinh:eM,atanh:tM,expm1:nC,log1p:op,sign:Vx,hypot:Bs}=Math,iC=qo,Bx=su,rM=ou,sC=function(e){let t=e*e;return 1+t===1?1:1+t===t?Math.abs(e):Math.sqrt(t+1)},oC=function(e){let t=e*e;return t<1?NaN:t-1===t?Math.abs(e):Math.sqrt(t-1)};function Jr(e,t,r){return Math.max(t,Math.min(r,e))}function nM(e,t){let r=e%t;return e*t<0&&r!==0?r+t:r}function iM(e,t){e=Math.round(e),t=Math.round(t);let r=Bx(e,t);return Math.abs(e/r*t)}function aC(e){if(e.length===0)return NaN;let t=e[0];for(let r=1;r<e.length;r++)t=Bx(t,e[r]);return t}function uC(e){if(e.length===0)return NaN;let t=e[0];for(let r=1;r<e.length;r++)t=iM(t,e[r]);return t}function Sa(e,t){if(isNaN(e))return e;if(isNaN(t))return t;if(!isFinite(e)&&!isFinite(t))return NaN;if(t===0||e===t)return 1;if(e===0)return ls(t);let r=isFinite(e)&&e===Math.round(e),n=isFinite(t)&&t===Math.round(t);if(e<0&&t<0&&e-t<0)return r&&n?0:ls(e-t)*ls(t)/(ls(e)*Sa(-e,-t));if(e<0&&t>0&&e-t<0)return r&&n?Math.pow(-1,t)*Sa(t-e-1,t):ls(e-t)/ls(e)*Sa(-(e-t),t);if(e<0&&t<0&&e-t>0)return r&&n?Math.pow(-1,e-t)*Sa(-t-1,e-t):ls(t)/ls(e)*Sa(-t,-e);if(e>0&&t<0&&e-t>0){let a=Math.abs(e)>Math.abs(t)?-t:e;return ls(t)/Sa(e-t,a)}if(e>0&&t>0&&e-t<0)return ls(e-t)/Sa(t,e);if(e<0||t<0||e-t<0||e<15&&t<15&&e-t<15)return cm(e,t)/Cu(t);let i=vi(e)-vi(t)-vi(e-t)-(e-t)*op(-t/e),s=Math.sqrt(e/(2*Math.PI*t*(e-t)))*Math.pow(e/t,t)*Math.exp(i);return r&&n&&e>0&&t>0&&e-t>0?Math.round(s):s}function cm(e,t){if(isNaN(e))return e;if(isNaN(t))return t;if(!isFinite(e)&&!isFinite(t))return NaN;if(t===0)return 1;if(e===0)return 1/Cu(-t);let r=isFinite(e)&&e===Math.round(e),n=isFinite(t)&&t===Math.round(t);if(e<0&&e-t<0)return r&&n?Math.pow(-1,t)*cm(t-e-1,t):ls(e-t)/ls(e)*cm(-(e-t),t);if(e<0||e-t<0||e<15&&e-t<15)return Cu(e)/Cu(e-t);let i=vi(e)-vi(e-t)-(e-t)*op(-t/e),s=Math.sqrt(e/(e-t))*Math.pow(e/Math.E,t)*Math.exp(i);return r&&n&&e>0&&t>0&&e-t>0?Math.round(s):s}function Cu(e){return ip(e+1)}function ip(e){if(e===-1/0)return NaN;let t=Math.round(e)===e;if(e<0)return t?1/0:Math.PI/(dM(e)*ip(1-e));if(e>170)return 1/0;let r;return e<15?r=sM(e):e<120?r=cC(e):r=Math.exp(oM(e)),t?Math.round(r):r}function sM(e){let t=4.077131788261185,r=7.024675027156382,n=6.657107767450176,i=3.766266976716022,s=1.2792371666711133,o=.24304596436338005,a=.020049769312165774,u=4.154347453162709,c=7.270007565107539,l=6.97805297331391,p=3.989651532924167,f=1.367176195613119,y=.26175627691546965,h=.021742722739397567,m=1+e*(t+e*(r+e*(n+e*(i+e*(s+e*(o+e*a)))))),b=1+e*(u+e*(c+e*(l+e*(p+e*(f+e*(y+e*h))))));return Math.E*Math.pow((1+e)/Math.E,1+e)/(e*Math.sqrt(1+e))*(m/b)}function cC(e){let t=e-1;return Math.pow(t,t)*Math.exp(Gx(t)-t)*Math.sqrt(2*Math.PI*t)}function oM(e){let t=e-1;return t*(Math.log(t)-1)+.5*Math.log(2*Math.PI*t)+Gx(t)}function lC(e){return e<0?NaN:e<15?Math.log(sM(e)):oM(e)}var aM=[1/6,-1/30,1/42,-1/30,5/66,-691/2730,7/6,-3617/510,43867/798,-174611/330,854513/138,-236364091/2730,8553103/6,-23749461029/870];function uM(e,t){if(e!==Math.floor(e))return NaN;if(e<0)return NaN;if(e===0)return 1/fM(t);let r=Ct(t);if(e===1)return-1/(r*r);let n=tr(t);if(e===2)return 2*n/(r*r*r);let i=[0,2],s=[];for(let a=3;a<=e;a++){s=[];for(let u=0;u<a;u++){let c=0,l=0;u>0&&(c=(a-u+1)*i[u-1]),u+2<a&&(l=(u+1)*i[u+1]),s.push(-(c+l))}i=s}let o=0;for(let a=e-1;a>=0;a--)o=s[a]+n*o;return o/Math.pow(r,e+1)}function cM(e,t){if(e<0)return NaN;if(e!==Math.floor(e))return NaN;let r=e%2===0?-1:1;if(t<0)return-r*cM(e,1-t)-Math.pow(Math.PI,e+1)*uM(e,Math.PI*t);let n=Cu(e),i=0,s=Math.pow(t,-(e+1));for(;t<10;)i+=s,t++,s=Math.pow(t,-(e+1));i+=e===0?-Math.log(t):s*t/e,i+=.5*s;let o=aM,a=e+1,u=2,c=s*t*a/u,l=1/(t*t);for(let p=1;p<=14;p++)c*=l,i+=c*o[p-1],a++,u++,c*=a/u,a++,u++,c*=a/u;return n*r*i}function pC(e){let t=Math.log(e);return Math.exp(Math.round(t))===e?Math.round(t):t}function lM(e,t){if(t===0)return NaN;let r;return t===Math.E?r=Math.log(e):t===2&&Math.log2?r=Math.log2(e):t===10&&Math.log10?r=Math.log10(e):r=Math.log(e)/Math.log(t),Math.pow(t,Math.round(r))===e?Math.round(r):r}function fC(e){return lM(e,10)}function dC(e,t){return rM(e,1/t)}var pM=1/Math.PI;function mm(e){return e>1e12?!1:Math.round(pM*e)*Math.PI===e}function ym(e){if(e>1e12)return!1;let t=Math.round(2*pM*e);return t%2===1&&t*Math.PI===2*e}function Ct(e){return mm(Math.abs(e))?0:Math.sin(e)}function tr(e){return ym(Math.abs(e))?0:Math.cos(e)}function fM(e){let t=Math.abs(e);return mm(t)?0:ym(t)?1/0:Math.tan(e)}function mC(e){return ym(Math.abs(e))?1/0:1/Math.cos(e)}function yC(e){return mm(Math.abs(e))?1/0:1/Math.sin(e)}function gC(e){let t=Math.abs(e);return mm(t)?1/0:ym(t)?0:1/Math.tan(e)}function hC(e){return e>0?Math.atan(1/e):Math.PI/2-Math.atan(e)}function bC(e){return Math.asin(1/e)}function xC(e){return Math.acos(1/e)}function PC(e){return 1/jE(e)}function TC(e){return 1/JE(e)}function IC(e){return 1/QE(e)}function EC(e){return KE(1/e)}function MC(e){return eM(1/e)}function DC(e){return tM(1/e)}function dM(e){if(e===0||isNaN(e))return e;if(!isFinite(e))return NaN;if(e===Math.floor(e))return e>0?0:-0;let t=Math.round(2*e),r=-.5*t+e,n=t&2?-1:1,i=t&1?Math.cos(Math.PI*r):Math.sin(Math.PI*r);return n*i}function ls(e){return e===1/0||e===-1/0?0:e===0?1:dM(e)/(Math.PI*e)}function Do(e){let t=0;for(let r=0;r<e.length;r++)t+=e[r];return t/e.length}function vC(e){let t=0;for(let r=0;r<e.length;r++)t+=e[r];return t}function _x(e){return e>50?Math.exp(.5*((1-e)*op(-1/(e-1))-1)+vi(.5*(e-1))-vi(.5*(e-2)))*Math.sqrt((1-1/e)/(2*Math.PI)):ip((e+1)/2)/(ip(e/2)*Math.sqrt(e*Math.PI))}function Rc(e,t,r=e-t){if(Math.abs(r)<.1*(e+t)){let n=r/(e+t),i=r*r/(e+t),s=2*e*n;for(let o=1;o<10;o++){s*=n*n;let a=i+s/(2*o+1);if(a==i)return a;i=a}}return e*Math.log(e/t)+t-e}var OC=[0,.08106146679532726,.0413406959554093,.02767792568499834,.020790672103765093,.016644691189821193,.013876128823070748,.01189670994589177,.010411265261972096,.009255462182712733,.00833056343336287,.007573675487951841,.00694284010720953,.006408994188004207,.0059513701127588475,.005554733551962801];function vi(e){return e>15?Gx(e):e<0?NaN:e===Math.floor(e)?OC[e]:Math.log(Cu(e)/(Math.pow(e,e)*Math.exp(-e)*Math.sqrt(2*Math.PI*e)))}function Gx(e){let t=.08333333333333333,r=.002777777777777778,n=.0007936507936507937,i=.0005952380952380953,s=.0008417508417508417,o=e*e;return(t-(r-(n-(i-s/o)/o)/o)/o)/e}function gm(e,t){return t<=0?NaN:_x(t)*Math.pow(1+e*e/t,-((t+1)/2))}function Au(e,t){if(t>0)return 1-Au(e,-t);if(t===-1/0)return 0;if(t===0)return .5;if(e>=40&&t>-1)return .5+_x(e)*SC(e,t);if(t/e<-1e3){let n=t*t;return _x(e)*Math.pow(e,.5*(e-1))*Math.pow(Math.abs(t),-e)*(1-e*e*(e+1)*(1/(2+e)+e*(e+3)/(4*(4+e)*n))/(2*n))}let r=Math.sqrt(t*t+e);return RC((t+r)/(2*r),e/2,e/2)}function SC(e,t){let r=t*t/e,n=t,i=n;for(let s=1;s<=15;s++)n*=-(2*s-1)/(2*s+1)*(.5*(e+1)+s-1)/s*r,i+=n;return i}function am(e,t,r){return r<=0?NaN:e===-1/0?Au(r,t):e>0&&t>0?Au(r,-e)-Au(r,-t):Au(r,t)-Au(r,e)}function RC(e,t,r){if(e<0||e>1)throw new RangeError(\"First argument must be between 0 and 1.\");if(t===1&&r===1)return e;if(e===0)return 0;if(e===1)return 1;if(t===0)return 1;if(r===0)return 0;{let n=vi(t+r)-vi(t)-vi(r)-Rc(t,(t+r)*e)-Rc(r,(t+r)*(1-e),(t+r)*e-t),i=Math.exp(n)*Math.sqrt(t*r/(2*Math.PI*(t+r)));return e<(t+1)/(t+r+2)?i*YE(e,t,r)/t:1-i*YE(1-e,r,t)/r}}function YE(e,t,r){let n=Math.pow(2,-52),i=1e-300,s=t+r,o=t+1,a=t-1,u=1,c=1-s*e/o;Math.abs(c)<i&&(c=i),c=1/c;let l=c;for(let p=1;p<=100;p++){let f=2*p,y=p*(r-p)*e/((a+f)*(t+f));c=1+y*c,Math.abs(c)<i&&(c=i),u=1+y/u,Math.abs(u)<i&&(u=i),c=1/c,l*=c*u,y=-(t+p)*(s+p)*e/((t+f)*(o+f)),c=1+y*c,Math.abs(c)<i&&(c=i),u=1+y/u,Math.abs(u)<i&&(u=i),c=1/c;let h=c*u;if(l*=h,Math.abs(h-1)<=n)return l}return l}function NC(e,t){let r=Math.pow(2,-52),n=1e-300,i=1,s=e,o=i/s,a=i/n,u=1/s,c=2,l=0,p=s,f=-(e-1),y=0;do f-=1,p+=1,u=u*f*t+p,u===0&&(u=n),a=p+f*t/a,a===0&&(a=n),u=1/u,l=a*u,o=o*l,y+=1,p+=1,u=u*y*t+p,u===0&&(u=n),a=p+y*t/a,a===0&&(a=n),u=1/u,l=a*u,o*=l,c+=2;while(c<100&&Math.abs(l-1)>r);return o}function AC(e,t){let r=Math.pow(2,-52),n=1e-300,i=1,s=t+1-e,o=i/s,a=i/n,u=1/s,c=2,l=0,p=s;do{let f=-(c-1)*(c-e-1);p+=2,u=u*f+p,u===0&&(u=n),a=p+f/a,a===0&&(a=n),u=1/u,l=a*u,o*=l,c+=1}while(c<100&&Math.abs(l-1)>r);return o}function CC(e,t){let r=t/e,n=Vx(t-e)*Math.sqrt(2*Rc(1,r)),i=[1,-.3333333333333333,.08333333333333333,-.014814814814814815,.0011574074074074073,.0003527336860670194,-.0001787551440329218,3919263178522438e-20,-2185448510679992e-21,-185406221071516e-20,8296711340953087e-22,-17665952736826078e-23,6707853543401498e-24,10261809784240309e-24,-4382036018453353e-24,914769958223679e-24,-25514193994946248e-27,-5830772132550426e-26,24361948020667415e-27,-50276692801141755e-28,11004392031956135e-29,3371763262400985e-28,-1392388722418162e-28,28534893807047445e-30,-5139111834242572e-31,-19752288294349442e-31,8099521156704561e-31],s=i.length-2,o=0,a=0,u=0,c=0;for(;s>=0;s--)u=(s+2)*o/e+i[s+1],c=n*c+u,o=a,a=u;if(c=e/(e+o)*c,t<e){let l=Math.exp(-.5*e*n*n)*(.5*ta(-n*Math.sqrt(e/2))-c/Math.sqrt(2*Math.PI*e));return isFinite(l)?1-l:1}else{let l=Math.exp(-.5*e*n*n)*(.5*ta(n*Math.sqrt(e/2))+c/Math.sqrt(2*Math.PI*e));return isFinite(l)?l:0}}function XE(e,t,r){return(e-t)/(Math.SQRT2*Math.abs(r))}function rp(e){return e<0?.5*Math.exp(-e*e)*ta(-e):1-.5*Math.exp(-e*e)*ta(e)}function _C(e,t,r,n){let i=XE(t,r,n);if(e===-1/0)return rp(i);let s=XE(e,r,n);return e>0&&t>0?rp(-s)-rp(-i):rp(i)-rp(s)}function zx(e,t,r){return 1/Math.sqrt(2*Math.PI*r*r)*Math.exp(-(e-t)*(e-t)/(2*r*r))}function Hx(e){let t=WE.spy(e),r=parseInt(t.slice(0,8),16)&2097151,n=parseInt(t.slice(8,16),16);return(r*4294967296+n)/9007199254740992}function mM(e,t){for(let r=t.length-1;r>0;r--){let n=e+\"::sc\"+r,i=Math.floor(Hx(n)*(r+1)),s=t[r];t[r]=t[i],t[i]=s}}function LC(e,t){let r=t.slice();return mM(e,r),r}function Ux(e,t){let r=[];for(let n=0;n<t;n++)r.push(n);return mM(e,r),r}function Ra(e,t,r){return Hx(e)*(r-t)+t}function wC(e,t,r){let n=0,i,s,o,a;do i=e+\"::sc\"+n,n+=1,s=Ra(i,0,1)*2-1,i=e+\"::sc\"+n,n+=1,o=Ra(i,0,1)*2-1,a=s*s+o*o;while(a>=1||a===0);let u=Math.sqrt(-2*Math.log(a)/a);return t+r*s*u}function FC(e,t){if(t<=0)return NaN;let r=0,n,i,s,o;do n=e+\"::sc\"+r,r+=1,i=Ra(n,0,1)*2-1,n=e+\"::sc\"+r,r+=1,s=Ra(n,0,1)*2-1,o=i*i+s*s;while(o>1);let a=i*i/o,u=t*(Math.pow(o,-2/t)-1);return n=e+\"::sc\"+r,r+=1,(Ra(n,0,1)<.5?-1:1)*Math.sqrt(a*u)}function VC(e,t,r){return t=Jr(Math.round(t),0,1/0),t===1/0?NaN:(r=Jr(r,0,1),gM(Ra(e,0,1),t,r))}function BC(e,t){return t<0?NaN:yM(Ra(e,0,1),t)}function um(e,t,r){return e>=t?1:e<0?0:e<Math.floor((t+1)*r)?$E(e,t,r):1-$E(t-e-1,t,1-r)}function $E(e,t,r){let n=(1-r)/r,i=hm(e,t,r),s=i;for(;e>0&&(i*=e/(t-e+1)*n,s+i!==s);e--)s+=i;return s}function GC(e,t,r,n){return r=Jr(Math.round(r),0,1/0),r===1/0?NaN:(n=Jr(n,0,1),t<0?0:(e=Math.ceil(e),t=Math.floor(t),e===-1/0?um(t,r,n):um(t,r,n)-um(e-1,r,n)))}function hm(e,t,r){if(e=Math.round(e),t=Jr(Math.round(t),0,1/0),t===1/0)return NaN;if(r=Jr(r,0,1),e<0||e>t)return 0;if(r===0)return e===0?1:0;if(r===1)return e===t?1:0;if(e===0)return Math.exp(t*op(-r));if(e===t)return Math.pow(r,t);let n=vi(t)-vi(e)-vi(t-e)-Rc(e,t*r)-Rc(t-e,t*(1-r),t*r-e);return Math.exp(n)*Math.sqrt(t/(2*Math.PI*e*(t-e)))}function Nc(e,t){return t<0?NaN:(e=Math.round(e),e<0?0:t===0?e===0?1:0:e===0?Math.exp(-t):Math.exp(-vi(e)-Rc(e,t))/Math.sqrt(2*Math.PI*e))}function np(e,t){if(isNaN(e)||isNaN(t))return NaN;if(e===1/0)return 1;if(e=Math.floor(e),e<0)return 0;if(t===0)return 1;if(e+1>12&&2.35*(e+1)>t&&.3*(e+1)<t)return CC(e+1,t);if(e+1>=t){let r=NC(e+1,t);return isFinite(r)?1-t*Nc(e,t)*r:1}else{let r=AC(e+1,t);return isFinite(r)?t*Nc(e,t)*r:0}}function zC(e,t,r){return r<0?NaN:(e=Math.ceil(e),t=Math.floor(t),t<0?0:e===-1/0?np(t,r):np(t,r)-np(e-1,r))}function kx(e,t,r){return r<=t?NaN:e<t||e>r?0:1/(r-t)}function ZE(e,t,r){return r<=t?NaN:e<t?0:e>r?1:(e-t)/(r-t)}function HC(e,t,r,n){return ZE(t,r,n)-ZE(e,r,n)}function UC(e){let t=-e*e;return t<-750?e>=0?1:-1:e>=.065?1-Math.exp(t)*ta(e):e<=-.065?Math.exp(t)*ta(-e)-1:e*(1.1283791670955126+t*(.37612638903183754+t*(.11283791670955126+t*(.026866170645131252+t*.005223977625442188))))}function ta(e){let t=.9999999999999999,r=2.224574423459406,n=2.444115549920689,i=1.7057986861852539,s=.8257463703357973,o=.28647031042892007,a=.07124513844341643,u=.012296749268608364,c=.001347817214557592,l=7263959403471071e-20,p=1,f=3.352953590554884,y=5.227518529742423,h=5.003720878235473,m=3.266590890998987,b=1.5255421920765353,d=.5185887413188858,g=.12747319185915415,x=.02185979575963238,M=.0023889438122503674,E=.00012875032817508128;if(e<0)return e<-6.1?2*Math.exp(e*e):2*Math.exp(e*e)-ta(-e);if(e>50){let T=.5641895835477563,D=e*e;return e>5e7?T/e:T*(D*(D+4.5)+2)/(e*(D*(D+5)+3.75))}else{let T=t+e*(r+e*(n+e*(i+e*(s+e*(o+e*(a+e*(u+e*(c+e*l)))))))),D=p+e*(f+e*(y+e*(h+e*(m+e*(b+e*(d+e*(g+e*(x+e*(M+e*E)))))))));return T/D}}function qx(e){let t=-39.6968302866538,r=220.946098424521,n=-275.928510446969,i=138.357751867269,s=-30.6647980661472,o=2.50662827745924,a=-54.4760987982241,u=161.585836858041,c=-155.698979859887,l=66.8013118877197,p=-13.2806815528857,f=-.00778489400243029,y=-.322396458041136,h=-2.40075827716184,m=-2.54973253934373,b=4.37466414146497,d=2.93816398269878,g=.00778469570904146,x=.32246712907004,M=2.445134137143,E=3.75440866190742,T=.02425,D,S,O;return e>.5?-qx(1-e):e===.5?0:e<0?NaN:e===0?-1/0:(e<T?(D=Math.sqrt(-2*Math.log(e)),O=(((((f*D+y)*D+h)*D+m)*D+b)*D+d)/((((g*D+x)*D+M)*D+E)*D+1)):(D=e-.5,S=D*D,O=(((((t*S+r)*S+n)*S+i)*S+s)*S+o)*D/(((((a*S+u)*S+c)*S+l)*S+p)*S+1)),O-Math.sqrt(2*Math.PI)*(.5*ta(-O/Math.SQRT2)-Math.exp(.5*O*O)*e))}function yM(e,t){if(t<0||e<0||e>1)return NaN;if(t===0||e===0)return 0;if(e===1)return 1/0;let r=-1,n=Math.ceil(t);for(;np(n,t)<e;)n=2*n;let i=Math.floor(r+(n-r)/2);for(;r<i&&i<n;)np(i,t)<e?r=i:n=i,i=Math.floor(r+(n-r)/2);return n}function gM(e,t,r){if(t!==Math.round(t))return NaN;if(r<0||r>1)return NaN;if(e<0||e>1)return NaN;if(e===0)return 0;if(e===1)return t;if(t===0)return 0;if(r===1)return t;if(r===0)return 0;let n=-1,i=t,s=Math.floor(n+(i-n)/2);for(;n<s&&s<i;)um(s,t,r)<e?n=s:i=s,s=Math.floor(n+(i-n)/2);return i}function hM(e,t){if(isNaN(t)||t<=0||e<0||e>1)return NaN;if(e===0)return-1/0;if(e===1)return 1/0;if(t===1||t===2||t===4)return Cx(t,e);let r,n;if(e===.5)return 0;if(e>.5)r=t>1?qx(e):Cx(1,e),n=t>1?Cx(1,e):Math.pow(gm(0,t)*Math.pow(t,(t-1)/2)/(1-e),1/t);else return-hM(1-e,t);return kC(t,e,r,n)}function Cx(e,t){let r=4*t*(1-t);switch(e){case 1:return Math.tan(Math.PI*(t-.5));case 2:return 2*(t-.5)*Math.sqrt(2/r);case 4:let n=Math.cos(Math.acos(Math.sqrt(r))/3)/Math.sqrt(r);return Vx(t-.5)*2*Math.sqrt(n-1);default:throw new Error(\"_invTSimple() must be called with 1, 2, or 4 df.\")}}function kC(e,t,r,n){if(!isFinite(r)||!isFinite(n))return NaN;let i=r,s=n;for(;;){let o=Di(i,s),a=Au(e,o);if(o===i||o===s)return a>t?i:s;a<t?i=o:s=o}}function qC(e,t,r){return e<0||e>1||r<=t?NaN:e===0?t:e===1?r:t+e*(r-t)}function bM(e,t){let r=lm(e);return(Do(e)-t)*Math.sqrt(e.length)/r}function xM(e,t){let r=e.length,n=Do(e),i=lm(e),s=t.length,o=Do(t),a=lm(t),u=Math.sqrt(((r-1)*i*i+(s-1)*a*a)/(r+s-2));return(n-o)/(u*Math.sqrt(1/r+1/s))}function Sc(e,t,r){return r<0?am(-1/0,e,t):r>0?am(-1/0,-e,t):2*am(-1/0,-Math.abs(e),t)}function Yx(e,t){arguments.length===1&&(t=0);let r=bM(e,t),n=e.length-1;return{lessThan:Sc(r,n,-1),greaterThan:Sc(r,n,1),notEqual:Sc(r,n,0)}}function Xx(e,t){let r=xM(e,t),n=e.length+t.length-2;return{lessThan:Sc(r,n,-1),greaterThan:Sc(r,n,1),notEqual:Sc(r,n,0)}}function $x(e){return{min:PM(e),q1:_u(e,1),median:EM(e),q3:_u(e,3),max:TM(e)}}function YC(e){return e.length}function PM(e){if(e.length<1)return NaN;let t=e[0];if(isNaN(t))return NaN;for(let r=1;r<e.length;r++){if(isNaN(e[r]))return NaN;e[r]<t&&(t=e[r])}return t}function TM(e){if(e.length<1)return NaN;let t=e[0];if(isNaN(t))return NaN;for(let r=1;r<e.length;r++){if(isNaN(e[r]))return NaN;e[r]>=t&&(t=e[r])}return t}function IM(e,t){if(!isFinite(t)||t<0||t>1)return NaN;if(e.some(isNaN))return NaN;if(e.length===0)return NaN;let r=e.length,n=Lu(e),i=t*(r-1);return Math.floor(i)===i?e[n[i]]:(Math.ceil(i)-i)*e[n[Math.floor(i)]]+(i-Math.floor(i))*e[n[Math.ceil(i)]]}function _u(e,t){if(!isFinite(t)||t<0||t>4)return NaN;if(e.some(isNaN))return NaN;let r=Lu(e),n=bm(e,t),i=Math.floor(n),s=Math.ceil(n);return(e[r[i]]+e[r[s]])/2}function Lu(e){let t=e.length,r=[];for(let n=0;n<t;n++)r.push(n);return r.sort(function(n,i){return Y(Ns(e[n],e[i]))}),r}function bm(e,t){t=Math.round(t);let r=e.length,n=r%2===1,i;return r===1?0:(t===0&&(i=0),t===2&&(i=(r-1)/2),t===4&&(i=r-1),t===1&&(i=n?(r+1)/4-1:(r+2)/4-1),t===3&&(i=n?(3*r+3)/4-1:(3*r+2)/4-1),i===void 0?NaN:i)}function XC(e,t){return Lu(e)[Math.ceil(t*(e.length-1))]+1}function $C(e,t){return Lu(e)[Math.floor(t*(e.length-1))]+1}function ZC(e,t){return Lu(e)[Math.ceil(bm(e,t))]+1}function WC(e,t){return Lu(e)[Math.floor(bm(e,t))]+1}function EM(e){return IM(e,.5)}function jC(e){if(e.length<1)return 0;let t=e[0];if(isNaN(t))return 0;let r=0;for(let n=1;n<e.length;n++){if(isNaN(e[n]))return 0;e[n]<t&&(r=n,t=e[n])}return r+1}function JC(e){if(e.length<1)return 0;let t=e[0];if(isNaN(t))return 0;let r=0;for(let n=1;n<e.length;n++)if(e[n]>=t){if(isNaN(e[n]))return 0;r=n,t=e[n]}return r+1}function ap(e){let t=Do(e),r=0;for(let n=0;n<e.length;n++){let i=e[n]-t;r+=i*i}return r/e.length}function QC(e){let t=Do(e),r=0;for(let n=0;n<e.length;n++)r+=Math.abs(e[n]-t);return r/e.length}function MM(e){let t=e.length;return ap(e)*t/(t-1)}function DM(e,t){let r=Math.min(e.length,t.length);e.length!==r&&(e=e.slice(0,r)),t.length!==r&&(t=t.slice(0,r));let n=Do(e),i=Do(t),s=0;for(let o=0;o<r;o++)s+=(e[o]-n)*(t[o]-i);return s/r}function KC(e,t){let r=Math.min(e.length,t.length);return DM(e,t)*r/(r-1)}function xm(e,t){let r=Math.min(e.length,t.length);e.length!==r&&(e=e.slice(0,r)),t.length!==r&&(t=t.slice(0,r));let n=Do(e),i=Do(t),s=0,o=0,a=0;for(let u=0;u<r;u++){let c=e[u]-n,l=t[u]-i;s+=c*c,o+=l*l,a+=c*l}return a/Math.sqrt(s*o)}function Zx(e,t,r,n){let i=e[0];for(let o=2;o<e.length;o++){let a=Y(As(Ns(e[o],i),r));if(!Ln(a,o,10))return 0}let s=Y(n);for(let o=0;o<t.length-1;o++){let a=Y(As(Ns(t[o],i),r));if(!Ln(a,s-t.length+o,10))return 0}return!isFinite(s)||s<e.length||s<t.length?0:s}function Wx(e){return e<0||!isFinite(e)?0:e}function Lx(e){let t=e.length;if(t===0)return[];let r=[],n=[];for(let a=0;a<t;a++)n.push([e[a],a]);n.sort(function(a,u){let c=a[0],l=u[0];return c===1/0&&l===1/0||c===-1/0&&l===-1/0?0:c-l});let i=0,s=1,o=1;for(;i<t;){let a=i;for(;a<t-1&&n[a][0]===n[a+1][0];)a+=1;o=a-i+1;let u;for(a=0;a<o;a++)u=n[i+a][1],r[u]=isNaN(e[u])?NaN:s+.5*(o-1);s+=o,i+=o}return r}function e_(e,t){let r=Math.min(e.length,t.length);return e.length!==r&&(e=e.slice(0,r)),t.length!==r&&(t=t.slice(0,r)),xm(Lx(e),Lx(t))}function lm(e){return Math.sqrt(MM(e))}function t_(e){return Math.sqrt(ap(e))}var r_=Kl;function Ac(e,t){return Bs(t[0]-e[0],t[1]-e[1])}function n_(e,t){return Bs(t[0]-e[0],Bs(t[1]-e[1],t[2]-e[2]))}function vM(e,t,r){return[Jr(Math.round(e),0,255),Jr(Math.round(t),0,255),Jr(Math.round(r),0,255)]}function i_(e,t,r){isFinite(e)||(e=0),t=Jr(t,0,1),r=Jr(r,0,1);let n=r*(1-t/2);n===0||n===1?t=0:t=(r-n)/Math.min(n,1-n);let{r:i,g:s,b:o}=$d(e,t,n).rgb();return vM(i,s,o)}function s_(e){return e}function o_(e,t){return[e,t]}function a_(e,t,r){return[e,t,r]}function u_(e,t){return[e,t]}function c_(e){return e}function l_(e){let t=[];if(e.length===0)return[];for(let r=0;r<e.length-1;r++)t.push([e[r],e[r+1]]);return t.push([e[e.length-1],e[0]]),t}function jx(e){if(e.length==0)return 0;let t=[...e,e[0]];return kE(t)}function p_(e){let t=0;for(let r=0;r<e.length-1;r++){let[n,i]=e[r],[s,o]=e[r+1];t+=ss(s-n,o-i)}if(e.length>1){let[r,n]=e[e.length-1],[i,s]=e[0];t+=ss(i-r,s-n)}return t}function f_(e){let t=!1;for(let r=0;r<e.length;r++){let n=(r+1)%e.length;e[r][0]===e[n][0]&&e[r][1]===e[n][1]&&(t=!0)}return t?e.filter((r,n)=>{let i=e[n===0?e.length-1:n-1];return r[0]!==i[0]||r[1]!==i[1]}):e}function d_(e){let[t,r,n,i]=e;return[t,n>=0?r:r+n,n>=0?n:-n,i]}function OM(e,t,r){if(e.length===0)return[];e=f_(e);let n=qE([...e,e[0]]),i=[];for(let s=0;s<e.length;s++){let o=e[s>0?s-1:e.length-1],a=e[s],u=e[s<e.length-1?s+1:0],c=n[s]===1,l=__(o,a,u,c?\"counterclockwise\":\"clockwise\",r);i.push(t?l:d_(l))}return i}function m_(e,t){return OM(e,!1,t)}function y_(e,t){return OM(e,!0,t)}function Jx(e,t){return[e,t]}var g_=Jx,h_=Jx;function SM(e,t){let r=[t[0]-e[0],t[1]-e[1]],n=[e[0],e[1]];return RM(r,n)}function RM(e,t){return[e,t]}function b_(e){return e[0]}function x_(e){return e[1]}function P_(e,t){let r=[t[0]-e[0],t[1]-e[1],t[2]-e[2]],n=[e[0],e[1],e[2]];return NM(r,n)}function NM(e,t){return[e,t]}function T_(e){return e[0]}function I_(e){return e[1]}function E_(e){return e}function M_(e,t){return[e,t]}function D_(e){return e[0]}function v_(e){return e[1]}function O_(e,t,r){return[e,t,r]}function Lc([e,t,r]){let[n,i]=e,[s,o]=t,[a,u]=r,c=s*s+o*o,l=(n*n+i*i-c)/2,p=(c-a*a-u*u)/2,f=(n-s)*(o-u)-(s-a)*(i-o);f=1/f;let y=(l*(o-u)-p*(i-o))*f,h=((n-s)*p-(s-a)*l)*f;return[y,h]}function wc(e){let[[t,r],[n,i],[s,o]]=e,a=n-t,u=i-r,c=s-n,l=o-i;return 2*Math.atan2(a*l-c*u,a*c+u*l)}function Qx(e){let t=Math.abs(wc(e));return t<1e-9||t>2*Math.PI-1e-9}function AM(e){return Math.abs(e)===Math.PI?Math.PI:nM(e+Math.PI,2*Math.PI)-Math.PI}function CM(e,t,r,n){return[e,AM(t),r,n]}function S_([e,t,r,n]){return[e,t,r,n]}function R_(e){return e[2]}function N_(e){return e[3]}function _M(e){let[t,r,n,i]=e,s=Math.PI*2,o=n===0?s:n>0?n-s:n+s;return[t,r,o,i]}function A_(e){let[t,r,n,i]=_M(e);return[t,r,n,i]}function C_(e){let[t,r,n,i]=e,s=n>=0?Math.PI-n:-Math.PI-n;return[t,AM(r+n),s,i]}function __(e,t,r,n,i){let s=e[0]-t[0],o=e[1]-t[1],a=r[0]-t[0],u=r[1]-t[1],c=Math.atan2(o,s),l=Math.atan2(s*u-o*a,s*a+o*u),p=2*Math.PI;return n===\"clockwise\"?l-=l<0?0:p:n===\"counterclockwise\"&&(l+=l<0?p:0),CM(t,c,l,i)}function Kx(e,t){let[[r,n],[i,s]]=e;return[[t*r,t*n],[t*i,t*s]]}var L_=Kx,w_=Kx;function F_(e,t){let[[r,n],i]=e;return[[t*r,t*n],t*i]}function V_(e,t){let[[r,n],[i,s],[o,a]]=e;return[[t*r,t*n],[t*i,t*s],[t*o,t*a]]}function B_(e,t){let[[r,n],i,s,o]=e;return[[t*r,t*n],t*i,t*s,o]}function eP(e,t){let[[r,n],[i,s]]=e,[[o,a],[u,c]]=t;return[[r+o,n+a],[i+u,s+c]]}function G_(e,t){let[[r,n,i],[s,o,a]]=e,[[u,c,l],[p,f,y]]=t;return[[r+u,n+c,i+l],[s+p,o+f,a+y]]}var z_=eP,H_=eP;function U_(e,t){let[[r,n],i]=e,[[s,o],a]=t;return[[r+s,n+o],i+a]}function k_(e,t){let[[r,n],[i,s],[o,a]]=e,[[u,c],[l,p],[f,y]]=t;return[[r+u,n+c],[i+l,s+p],[o+f,a+y]]}function q_(e,t){let[[r,n],i,s,o]=e,[[a,u],c,l]=t;return[[r+a,n+u],i+c,s+l,o]}function tP(e,t){let[[r,n],[i,s]]=e;return[(1-t)*r+t*i,(1-t)*n+t*s]}function rP(e,t){return tP(e,Jr(t,0,1))}function Y_(e,t){t=Jr(t,0,1);let[[r,n,i],[s,o,a]]=e;return[(1-t)*r+t*s,(1-t)*n+t*o,(1-t)*i+t*a]}function wx(e,t){return tP(e,Jr(t,0,1/0))}function X_(e,t){let[[r,n],i]=e,s=Math.min(1,Math.max(0,t));return[r+i*Math.cos(2*Math.PI*s),n+i*Math.sin(2*Math.PI*s)]}function LM(e,t){let r=Pm(e);if(!r)return[NaN,NaN];if(r.type===\"segment\")return rP([e[0],e[2]],t);if(r.type===\"rays\")return t<=0?wx([r.start1,r.end1],-t):t>=1?wx([r.start2,r.end2],t-1):[NaN,NaN];t=Math.min(1,Math.max(0,t));let n=Lc(e),i=wc(e),s=Math.atan2(e[0][1]-n[1],e[0][0]-n[0]),o=Ac(n,e[0]),a=s+t*i;return[n[0]+o*Math.cos(a),n[1]+o*Math.sin(a)]}function $_(e,t){if(isNaN(t))return[NaN,NaN];if(t<0||t>=e.length)return e[0];let r=Math.floor(t);return rP([e[r],e[(r+1)%e.length]],t-r)}function Pm(e){let[t,r,n]=e,[[i,s],[o,a],[u,c]]=[t,r,n];if(isNaN(i)||isNaN(s)||isNaN(o)||isNaN(a)||isNaN(u)||isNaN(c))return;let l=Lc([t,r,n]),p=Ac(l,t);if(isFinite(p)&&!Qx([t,r,n])){let f=Math.atan2(t[1]-l[1],t[0]-l[0]),y=f+wc([t,r,n]);return{type:\"arc\",center:l,radius:p,startAngle:f,endAngle:y}}else{let f=Rs(o,a,0,i,s,0,u,c,0);return f<0||f>1?{type:\"rays\",start1:[i,s],end1:[i+(i-u),s+(s-c)],start2:[u,c],end2:[u+(u-i),c+(c-s)]}:{type:\"segment\",start:[i,s],end:[u,c]}}}function Z_(e,t,r){let i=Ac(e,t);if(i>1e-9)return t;let s=Ac(e,r);return s>1e-9?r:isNaN(i)&&isNaN(s)?[NaN,NaN]:e}function sp(e,t){let[[r,n],i]=e,[[s,o],a]=t,u=Bs(s-r,o-n),c=i+a,l=i-a,p=u*u,f=Math.sqrt((u+c)*(-u+c)*(u-l)*(u+l))/4,y=i*i,h=a*a;return[(s+r)/2+(s-r)*(y-h)/(2*p)+-2*(o-n)*f/p,(o+n)/2+(o-n)*(y-h)/(2*p)+2*(s-r)*f/p]}function wM(e,t,r){let[[n,i],s]=e,[[o,a],[u,c]]=t,l=o-n,p=u-n,f=a-i,y=c-i,h=p-l,m=y-f,b=h*h+m*m,d=l*y-p*f,g=s*s*b-d*d;if(g<0)return[NaN,NaN];let x=Math.sqrt(g);return x<0?[NaN,NaN]:[n+(d*m+r*h*x)/b,i+(-d*h+r*m*x)/b]}function W_(e,t){let[[r,n],[i,s]]=e,[[o,a],[u,c]]=t,l=s-n,p=r-i,f=c-a,y=o-u,h=l*r+p*n,m=f*o+y*a,b=l*y-f*p;return b===0?[NaN,NaN]:[(y*h-p*m)/b,(l*m-f*h)/b]}function nP(e,t,r=0){let n=wM(t,e,-1);return _c(n,e,r,!0)?n:[NaN,NaN]}function iP(e,t,r=0){let n=wM(e,t,1);return _c(n,t,r,!1)?n:[NaN,NaN]}function FM(e,t,r=0){let n=W_(e,t);return!_c(n,e,r,!0)||!_c(n,t,r,!1)?[NaN,NaN]:n}function j_(e,t,r=0){let n=GM(t,e,r,-1);return Cc(n,t,r,!1)?n:[NaN,NaN]}function VM(e,t,r=0){let n=zM(t,e,r,-1);return!_c(n,e,r,!0)||!Cc(n,t,r,!1)?[NaN,NaN]:n}function J_(e,t,r=0){let n=GM(e,t,r,1);return Cc(n,e,r,!0)?n:[NaN,NaN]}function BM(e,t,r=0){let n=zM(e,t,r,1);return!Cc(n,e,r,!0)||!_c(n,t,r,!1)?[NaN,NaN]:n}function Q_(e,t,r=0){let n=K_(e,t,r);return!Cc(n,e,r,!0)||!Cc(n,t,r,!1)?[NaN,NaN]:n}function K_(e,t,r){let n=fm(e);if(dm(n))return VM(n,t,r);let i=fm(t);return dm(i)?BM(e,i,r):sP(()=>sp(n,i),()=>sp(i,n),s=>oP(-1,pm(e,s),pm(t,s)))}function GM(e,t,r,n){let i=fm(e);return dm(i)?n>0?iP(t,i,r):nP(i,t,r):sP(()=>sp(i,t),()=>sp(t,i),s=>oP(n,pm(e,s),eL(t,s)))}function zM(e,t,r,n){let i=fm(e);return dm(i)?FM(i,t,r):sP(()=>iP(i,t,r),()=>nP(t,i,r),s=>oP(n,pm(e,s),tL(t)))}function sP(e,t,r){let n=e();if(r(n))return n;let i=t();return r(i)?i:[NaN,NaN]}function oP(e,t,r){return e*HM(t,r)>0}function pm(e,[t,r]){let[n,i]=Lc(e);return wc(e)>0?[i-r,t-n]:[r-i,n-t]}function eL([[e,t]],[r,n]){return[t-n,r-e]}function tL([[e,t],[r,n]]){return[r-e,n-t]}function fm(e){let t=Lc(e),r=Ac(t,LM(e,0));return isFinite(r)&&!Qx(e)?[t,r]:[e[0],e[2]]}function dm(e){return Array.isArray(e[1])}function Cc([e,t],r,n,i){let[s,o]=Lc(r);return(i?(n&3)===0:(n&12)===0)||Wp(Math.atan2(t-o,e-s),Math.atan2(r[0][1]-o,r[0][0]-s),wc(r))}function _c([e,t],[[r,n],[i,s]],o,a){let u=Rs(e,t,0,r,n,0,i,s,0),[c,l]=a?[(o&1)===0,(o&2)===0]:[(o&4)===0,(o&8)===0];return!isNaN(u)&&(u>=0||c)&&(u<=1||l)}function rL(e,t){let[[r,n],[i,s]]=e,[o,a]=t;return[[o,a],[o+(i-r),a+(s-n)]]}function nL(e,t){let[[r,n],[i,s]]=e,[o,a]=t;return[[o,a],[o+(s-n),a-(i-r)]]}function HM(e,t){let[r,n]=e,[i,s]=t;return r*s-i*n}function iL(e,t){let[r,n]=e,[i,s]=t;return r*i+n*s}function sL(e){let[t,r]=e;return[-r,t]}function oL(e,t,r){return[e,t,r]}function aL(e){return[[1,0],e,!1]}function uL(e,t){let[r,n]=e;return[[t,0],[(1-t)*r,(1-t)*n],!1]}function cL(e,t){let[r,n]=e,i=Math.cos(t),s=Math.sin(t);return[[i,s],[r*(1-i)+n*s,n*(1-i)-r*s],!1]}function lL(e){let[[t,r],[n,i]]=e,s=n-t,o=i-r,a=s*s+o*o;return[[(s*s-o*o)/a,2*s*o/a],[(1-(s*s-o*o)/a)*t-2*s*o/a*r,(1+(s*s-o*o)/a)*r-2*s*o/a*t],!0]}function pL(e,t){let[[r,n],[i,s],o]=e,[[a,u],[c,l],p]=t;return o&&(u=-u,l=-l,p=!p),[[a*r-u*n,a*n+u*r],[i+r*c-n*l,s+r*l+n*c],p]}function fL(e){let[[t,r],[n,i],s]=e,o=t*t+r*r,a=t/o,u=-r/o,c=-(t/o*n+r/o*i),l=-(t/o*i-r/o*n);return s&&(u=-u,l=-l),[[a,u],[c,l],s]}function Mo(e,t){let[[r,n],[i,s],o]=e,[a,u]=t;return o&&(u=-u),[r*a-n*u+i,r*u+n*a+s]}function dL(e,t){let[r,n,i]=e;return i?-t:t}function Tm(e,t){let[r,n]=t;return[Mo(e,r),Mo(e,n)]}var mL=Tm,yL=Tm;function gL(e,t){let[r,n]=t,i=[n,[n[0]+r[0],n[1]+r[1]]],s=Tm(e,i);return SM(s[0],s[1])}function hL(e,t){let[r,n]=t,[[i,s]]=e;return[Mo(e,r),Bs(i,s)*n]}function bL(e,t){let[r,n,i]=t;return[Mo(e,r),Mo(e,n),Mo(e,i)]}function xL(e,t){let r=[];for(let n of t)r.push(Mo(e,n));return r}function PL(e,t){let[r,n,i]=t,s=Mo(e,r),[o,a,u]=e,[c,l]=Mo([o,[0,0],u],[Math.cos(n),Math.sin(n)]),p=Math.atan2(l,c),f=dL(e,i);return[s,p,f,t[3]]}function TL(e,t){let r=[];for(let n=0;n<Math.min(e.length,t.length);n++)t[n]&&r.push(e[n]);return r}function IL(e,t){let r=[];for(let n of t)r.push(e[n]);return r}function EL(e){let t=[],r={};for(let n=0;n<e.length;n++){let i=e[n],s=Fx(i);r.hasOwnProperty(s)||(r[s]=!0,t.push(n))}return t}function Fx(e){if(Array.isArray(e))return`[${e.map(Fx).join(\",\")}]`;switch(typeof e){case\"string\":return e;case\"boolean\":case\"number\":return e.toString();case\"object\":if(ML(e)){let r=[];for(let n in e.updateRules)r.push(`\"${n}\": ${Fx(e.updateRules[n].value)}`);return`{${r.join(\",\")}}`}else return Y(e).toString();default:return e}}function ML(e){return typeof e!=\"object\"||!e?!1:e.type===\"Action\"}function En(e){if(!zs(e))throw new Error(\"Programming error: expected an array but found \"+typeof e)}function zs(e){return Array.isArray(e)}function UM(e){if(zs(e))for(let{compiled:t}of e)t&&aP(t)}function v8(e){if(zs(e))for(let{compiled:t}of e)t&&DL(t)}function aP(e){delete e.fn}function DL(e){e.fn=uP(e.args,e.source,e.constants)}function uP(e,t,r){let i=\"return (function(\"+e.join(\",\")+'){\"use strict\"; '+t+\"})\";return new Function(\"BuiltIn\",\"ErrorMsg\",\"_C\",i)(Gs,er,r)}function De(e){return e.type<=3}function kM(e){return!De(e)}function jn(e){switch(e.type){case 21:case 23:case 19:return!0;default:return!1}}function un(e){switch(e.type){case 20:case 22:case 24:return!0;default:return!1}}function YM(e){let t=\"\",r=(e.instructionsLength()-1).toString().length,n=0,i=!1;for(let s=0;s<e.instructionsLength();s++){let o=e.getInstruction(s),a=e.comments[s]||\"\",u=o.type===0&&o.removedInstructionForDebuggingOnly;if((un(o)||u&&un(u))&&(n-=1),o.type===0&&!u)i||(t+=`${qM(s,r)}: ${pP(2*n)}...\n`),i=!0;else{i=!1;let c=u?\" [X]\":\"    \";t+=`${qM(s,r)}:${c} ${pP(2*n)}${wu(e,s)}${a?`\t\t# ${a}`:\"\"}\n`}(jn(o)||u&&jn(u))&&(n+=1)}return t}function wu(e,t){let r=e.getInstruction(t);switch(r.type===0&&r.removedInstructionForDebuggingOnly&&(r=r.removedInstructionForDebuggingOnly),r.type){case 0:return Oi(r.type);case 2:return`${Oi(r.type)} ${$n(r.valueType)} ${e.argNames[t]}`;case 3:return`${Oi(r.type)} ${$n(r.valueType)}`;case 1:return`${Oi(r.type)} ${$n(r.valueType)} ${lP(r.value)}`;case 37:case 42:return`${Oi(r.type)} ${$n(r.valueType)} ${r.symbol} ${r.args.join(\" \")}`;case 44:return`${Oi(r.type)} ${$n(r.valueType)} ${r.tag} ${r.args.join(\" \")}`;case 48:return`${Oi(r.type)} ${$n(r.valueType)} ${r.args.join(\" \")}${r.isConstantBroadcast?\" (constant)\":\"\"}`;case 8:case 9:case 10:case 11:case 13:case 12:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 32:case 31:case 33:case 38:case 39:case 40:case 41:case 47:case 49:return`${Oi(r.type)} ${$n(r.valueType)} ${r.args.join(\" \")}`;default:let n=r;throw new Error(`Unexpected opcode ${n.type}`)}}function Oi(e){switch(e){case 0:return\"Noop\";case 1:return\"Constant\";case 8:return\"Add\";case 9:return\"Subtract\";case 10:return\"Multiply\";case 11:return\"Divide\";case 12:return\"Exponent\";case 13:return\"RawExponent\";case 14:return\"Negative\";case 15:return\"OrderedPair\";case 17:return\"OrderedPairAccess\";case 16:return\"OrderedTriple\";case 18:return\"OrderedTripleAccess\";case 19:return\"BeginLoop\";case 20:return\"EndLoop\";case 21:return\"BeginIntegral\";case 22:return\"EndIntegral\";case 23:return\"BeginBroadcast\";case 24:return\"EndBroadcast\";case 25:return\"Equal\";case 26:return\"Less\";case 27:return\"Greater\";case 28:return\"LessEqual\";case 29:return\"GreaterEqual\";case 31:return\"Or\";case 32:return\"And\";case 33:return\"Piecewise\";case 38:return\"List\";case 39:return\"ListAccess\";case 40:return\"DeferredListAccess\";case 41:return\"InboundsListAccess\";case 37:return\"NativeFunction\";case 42:return\"Distribution\";case 2:return\"LoadArg\";case 47:return\"BlockVar\";case 48:return\"BroadcastResult\";case 3:return\"SymbolicVar\";case 44:return\"ExtendSeed\";case 49:return\"Action\";default:let t=e;throw new Error(`Unexpected opcode ${t.type}`)}}function lP(e){if(Array.isArray(e))return`[${e.map(lP).join(\",\")}]`;switch(typeof e){case\"string\":return e;case\"boolean\":case\"number\":return e.toString();case\"object\":if(Mu(e)){let t=[];for(let r in e.updateRules)t.push(`\"${r}\": ${lP(e.updateRules[r].value)}`);return`{${t.join(\", \")}}`}else return`${e.n}/${e.d}`;default:throw new Error(\"Unexpected value: \"+e)}}function qM(e,t){let r=e.toString();return pP(t-r.length)+r}function pP(e){let t=\"\";for(let r=0;r<e;r++)t+=\" \";return t}function Vt(e){return e.type===1}function XM(e){if(!Vt(e))throw new Error(`Programming error: expected constant instruction but found ${Oi(e.type)} instead.`)}function fP(e){return e.type===48&&e.isConstantBroadcast}function Na(e){return Vt(e)||fP(e)}function Im(e,t,r){let n=e.getInstruction(r);if(!De(n)){for(let o of n.args)if(!Na(e.getInstruction(o)))return!0}if(t<r)return!Na(e.getInstruction(t));let i=[!0];for(let o=r+1;o<=t;o++)i.push(!1);let s=[t];for(;s.length;){let o=s.pop();if(i[o-r])continue;i[o-r]=!0;let a=e.getInstruction(o);if(!De(a))for(let u of a.args)if(u<r){if(!Na(e.getInstruction(u)))return!0}else i[u-r]||s.push(u)}return!1}function dP(e,t,r){if(j(t)){let n=[];for(let i=0;i<r.length;i++)n.push(dP(e,$e(t),r[i]));return e.ConstantOfType(t,n)}switch(t){case P:return e.Constant(r);case he:return e.ConstantOfType(t,r);case N:return e.ConstantOfType(t,r);case G:return e.ConstantOfType(t,r);case It:return e.ConstantOfType(t,r);default:throw new Error(\"Cannot reconstitute value of a \"+pe(t)+\".\")}}function Hs(e,t,r){let n=lr(e,t);if(n===void 0)throw new Error(`${r}\nNon-constant instruction: \"${wu(e,bn(e,t))}\"`);return n}function lr(e,t){let r=Fc(e,t);if(!(r<0))return r}function Fc(e,t,r){var o;let n=r&&r[t];if(n)return n;let i=e.getInstruction(t),s;switch(i.type){case 38:s=i.args.length;break;case 1:s=i.value.length;break;case 48:{s=(o=i.constantLength)!=null?o:-1;break}}return s===void 0&&(r=r||{},s=vL(e,i,r)),r&&(r[t]=s),s}function vL(e,t,r){switch(t.type){case 33:{let n=Fc(e,t.args[1],r),i=Fc(e,t.args[2],r);return n===i?n:-1}case 37:switch(t.symbol){case\"elementsAt\":return Fc(e,t.args[1],r);case\"sortPerm\":return Fc(e,t.args[0],r);case\"shuffle\":return Fc(e,t.args[1],r);default:return-1}default:{if(j(t.valueType))return-1;throw new Error(`Programming Error: cannot find the list length of ${Oi(t.type)} ${pe(t.valueType)}.`)}}}function bn(e,t){let r=e.getInstruction(t);if(!j(r.valueType))throw new Error(`Programming Error: cannot find the list length of ${e.printInstruction(t)}`);switch(r.type){case 38:return e.Constant(r.args.length);case 1:return e.Constant(r.value.length);case 48:{let n=e.getInstruction(r.args[0]);return e.getInstruction(n.args[0]).args[0]}case 37:switch(r.symbol){case\"elementsAt\":return bn(e,r.args[1]);case\"sortPerm\":return bn(e,r.args[0]);case\"shuffle\":return bn(e,r.args[1])}}return e.SyntheticNativeFunction(\"count\",[t])}function cp(e,t){let r=[];for(let o of t)j(e.getInstruction(o).valueType)&&r.push(o);if(r.length===0)return;if(r.length===1)return bn(e,r[0]);let n=[];for(let o of r)n.push(lr(e,o));let i,s=1/0;for(let o=0;o<n.length;o++){let a=r[o],u=n[o];if(u===void 0)return e.SyntheticNativeFunction(\"min\",[e.List(r.map(c=>bn(e,c)))]);u<s&&(i=a,s=u)}return i!==void 0?bn(e,i):e.Constant(s)}function $M(e,t){if(j(e)){let r=$e(e);for(let n=0;n<t.length;n++)if(cn(r,t[n]))return!0;return!1}return cn(e,t)}function cn(e,t){switch(e){case P:return Ei(t);case N:{let[r,n]=t;return Ei(r)||Ei(n)}case G:{let[r,n,i]=t;return Ei(r)||Ei(n)||Ei(i)}case It:{let[r,n,i]=t;return Ei(r)||Ei(n)||Ei(i)}case we:{for(let r of t)if(cn(N,r))return!0;return!1}case _r:{let[r,n]=t;return cn(G,r)||cn(P,n)}case xr:{let[r,n,i]=t;return cn(G,r)||cn(G,n)||cn(G,i)}case dt:case Re:{let[r,n]=t;return cn(G,r)||cn(G,n)}case Oe:case ye:case _e:case ge:{let[r,n]=t;return cn(N,r)||cn(N,n)}case de:{let[r,n]=t;return cn(N,r)||cn(P,n)}case ue:{let[r,n,i]=t;return cn(N,r)||cn(N,n)||cn(N,i)}case Ae:case xe:{let[r,n,i]=t;return cn(N,r)||cn(P,n)||cn(P,i)}case Je:return Object.keys(t.updateRules).length===0;case he:case Ke:case Qe:case He:return!1;default:throw new Error(\"Type cannot contain a NaN value: \"+pe(e)+\".\")}}function mP(e,t){return co(e,t)}function yP(e,t){return Ns(e,t)}function gP(e,t){return lo(e,t)}function hP(e,t){return As(e,t)}function lp(e,t){return Y(e)===Math.E?Math.exp(Y(t)):sg(e,t)}var OL=lp;function bP(e){return Vi(e)}function SL(e,t){return[e,t]}function RL(e,t){return e[Y(t)-1]}function NL(e,t,r){return[e,t,r]}function AL(e,t){return e[Y(t)-1]}function xP(e,t){return Y(e)===Y(t)}function PP(e,t){return Y(e)<Y(t)}function TP(e,t){return Y(e)>Y(t)}function IP(e,t){return Y(e)<=Y(t)}function EP(e,t){return Y(e)>=Y(t)}function ZM(e,t){return e||t}function WM(e,t){return e&&t}function CL(e,t,r){let n=Math.floor(Y(r))-1;return!isFinite(n)||n<0||n>=t.length?qi(e):t[n]}function MP(e,t,r){return cr(r)&&(r=Y(r)),`${t}::${e}${r}`}function DP(e,t){switch(e){case\"mod\":return s0(t[0],t[1]);case\"abs\":return n0(t[0]);case\"sqrt\":return i0(t[0]);case\"nthroot\":return jp(t[0],t[1]);case\"total\":return o0(t[0]);case\"count\":return t[0].length;case\"validateRangeLength\":{let r=t[0],n=t[1],i=t[2],s=t[3],o=Zx(r,n,i,s);if(o===0)throw Ll();return o}case\"validateSampleCount\":{let r=ws(t[0]),n=Wx(r);if(n===0&&r!==0)throw Xb();return n}case\"select\":case\"elementsAt\":case\"uniquePerm\":case\"sortPerm\":{let r=Pr[e];return Gs[r.symbol].apply(null,t)}default:{let r=Pr[e];return(r.module===\"Math\"?Math:Gs)[r.symbol].apply(null,ws(t))}}}function Em(e,t){let r=Array(t+1);return qe(e,t,r)}function jM(e,t,r){let n=Array(t+1);for(let i=0;i<r.length;i++)n[i]=r[i];return qe(e,t,n)}function JM(e,t,r){let n=Array(t+1);return Mm(e,t,r,n)}function QM(e,t,r){let n=Array(t+1),i=[];for(let s of r)i.push(Mm(e,t,s,n));return i}function KM(e,t,r){if(t.constantLength)return t.constantLength;let n=t.args[0],s=e.getInstruction(n).args[0],o=e.getInstruction(s);return Y(qe(e,o.args[0],r))}function Mm(e,t,r,n){let i=e.getInstruction(t),s=KM(e,i,n);if(!isFinite(r)||r<0||r>=s)return qi($e(i.valueType));let o=i.args[0],a=t-o,u=e.getInstruction(o),c=u.args[0],l=u.args[a];n[c]=r+1;let p=qe(e,l,n);for(let f=c;f<=o;f++)n[f]=void 0;return p}function _L(e,t,r){let n=e.getInstruction(t),i=KM(e,n,r),s=[];for(let o=i-1;o>=0;o--)s[o]=Mm(e,t,o,r);return s}function eD(e,t,r){let n=qe(e,t.args[1],r),i=t.args[0],s=e.getInstruction(i);if(s.type===48)return Mm(e,i,Y(n)-1,r);if(s.type===33){let o=qe(e,s.args[0],r);return eD(e,ee(W({},t),{args:[o?s.args[1]:s.args[2],t.args[1]]}),r)}else{let o=qe(e,t.args[0],r);return CL(t.valueType,o,n)}}function qe(e,t,r){let n=r[t];if(n!==void 0)return n;let i=LL(e,t,r);return typeof i==\"number\"&&i===Math.floor(i)&&(i=Ce(i,1)),r[t]=i,i}function LL(e,t,r){let n=e.getInstruction(t);switch(n.type){case 1:return n.value;case 8:return mP(qe(e,n.args[0],r),qe(e,n.args[1],r));case 9:return yP(qe(e,n.args[0],r),qe(e,n.args[1],r));case 10:return gP(qe(e,n.args[0],r),qe(e,n.args[1],r));case 11:return hP(qe(e,n.args[0],r),qe(e,n.args[1],r));case 12:return lp(qe(e,n.args[0],r),qe(e,n.args[1],r));case 13:return OL(qe(e,n.args[0],r),qe(e,n.args[1],r));case 14:return bP(qe(e,n.args[0],r));case 15:return SL(qe(e,n.args[0],r),qe(e,n.args[1],r));case 16:return NL(qe(e,n.args[0],r),qe(e,n.args[1],r),qe(e,n.args[2],r));case 17:return RL(qe(e,n.args[0],r),qe(e,n.args[1],r));case 18:return AL(qe(e,n.args[0],r),qe(e,n.args[1],r));case 25:return xP(qe(e,n.args[0],r),qe(e,n.args[1],r));case 26:return PP(qe(e,n.args[0],r),qe(e,n.args[1],r));case 27:return TP(qe(e,n.args[0],r),qe(e,n.args[1],r));case 28:return IP(qe(e,n.args[0],r),qe(e,n.args[1],r));case 29:return EP(qe(e,n.args[0],r),qe(e,n.args[1],r));case 31:return qe(e,n.args[0],r)||qe(e,n.args[1],r);case 32:return qe(e,n.args[0],r)&&qe(e,n.args[1],r);case 44:return MP(n.tag,qe(e,n.args[0],r),qe(e,n.args[1],r));case 33:return qe(e,n.args[0],r)?qe(e,n.args[1],r):qe(e,n.args[2],r);case 37:{let s=[];for(let o of n.args)s.push(qe(e,o,r));return DP(n.symbol,s)}case 38:{let s=[];for(let o of n.args)s.push(qe(e,o,r));return s}case 39:case 40:case 41:return eD(e,n,r);case 48:return _L(e,t,r);case 47:{let s=n.args[0],o=e.getInstruction(s).args[0],a=t-s,c=e.getInstruction(s).args[a],l=[];l[c]=!0;for(let y=c;y>=o;y--){if(!l[y])continue;let h=e.getInstruction(y);if(!De(h))for(let m of h.args)m<o?qe(e,m,r):l[m]=!0}let p=e.copy();p.truncate(o);for(let y=0;y<o;y++){let h=r[y],m=e.getInstruction(y);if(h!==void 0){let b=m.valueType;p.replaceInstructionWithConstant(y,{type:1,valueType:b,value:h})}}p.reopenAllBlocks();let f=[];for(let y=o;y<t;y++){let h=e.getInstruction(y);if(De(h))f.push(p.copyInstruction(h));else{let m=[];for(let b of h.args)m.push(b<o?b:f[b-o]);h.type===40?f.push(p.InboundsListAccess(m)):f.push(p.copyInstructionWithArgs(h,m))}}return p.Noop(),p.replaceInstructionWithBlockVar(p.getReturnIndex(),{type:47,valueType:n.valueType,args:[s<o?s:f[s-o]]}),p.close().getCompiledFunction().fn()}case 19:case 20:case 21:case 22:case 23:case 24:case 42:case 0:case 2:case 3:case 49:throw new Error(`Programming Error: cannot interpret opcode ${n.type}`);default:let i=n;throw new Error(`Programming Error: unexpected opcode ${i.type}`)}}function Mn(e,t){let r=[],n=[];for(let i=0;i<t;i++)n.push(!1);n.push(!0);for(let i=t;i>=0;i--){if(!n[i])continue;let s=e.getInstruction(i);if(s.type===2)r.push({symbol:e.argNames[i],scope:\"free\"});else if(jn(s))switch(s.type){case 21:r.push({symbol:s.callData.indexSymbol,scope:\"integral\"});break;case 19:r.push({symbol:s.callData.indexSymbol,scope:s.callData.type});break;case 23:if(s.listComprehensionCallData)for(let a of s.listComprehensionCallData.inputListSymbols)r.push({symbol:a,scope:\"comprehension\"});break;default:let o=s;throw new Error(`Programming Error: unexpected loop instruction ${o.type}`)}else s.type===3&&s.symbol&&r.push({symbol:s.symbol,scope:\"symbolic-var\"});if(!De(s))for(let o of s.args)n[o]=!0}return r.reverse()}function Br(e,t){let r=e.getInstruction(t);if(r.type!==48)return t;if(r.isConstantBroadcast)return tD(e,t,r);let n=r.args[0],i=e.getInstruction(n),s=i.args[0],o=!1;for(let c=s+1;c<n;c++){let l=e.getInstruction(c);if(l.type===40&&l.args[1]===s){o=!0;break}}if(!o)return t;let a=[];for(let c=s;c<=n+i.args.length-1;c++){let l=e.getInstruction(c);if(De(l))a.push(e.copyInstruction(l));else{let p=[];for(let f of l.args)p.push(f>=s?a[f-s]:f);l.type===40?a.push(e.InboundsListAccess(p)):a.push(e.copyInstructionWithArgs(l,p))}}let u=e.getInstruction(e.getReturnIndex());return u.type===48&&u.isConstantBroadcast?tD(e,e.getReturnIndex(),u):e.getReturnIndex()}function tD(e,t,r){if(r.valueType===ar){let i=lr(e,t);if(i==null)throw Hl(Mn(e,t));let s=[];for(let o=0;o<i;o++){let a=e.InboundsListAccess([t,e.Constant(o+1)]);s.push(a)}return e.List(s)}let n=Em(e,t);return t===e.getReturnIndex()&&e.popInstruction(),e.ConstantOfType(r.valueType,n)}function pp(e,t,r){let n=e.getInstruction(t);if(j(n.valueType)){let i=lr(e,t);if(r=Math.floor(r),isNaN(r)||r<0||i!==void 0&&r>=i){let s=$e(n.valueType);return e.NanOfType(s)}return n.type===38?n.args[r]:n.type===1&&j(n.valueType)?e.ConstantOfType($e(n.valueType),n.value[r]):n.type===48&&n.isConstantBroadcast?e.ConstantOfType($e(n.valueType),JM(e,t,r)):i!==void 0?e.InboundsListAccess([t,e.Constant(r+1)]):e.ListAccess([t,e.Constant(r+1)])}else{if(n.valueType===N)return isNaN(r)||r<0||r>2?e.Constant(NaN):n.type===15?n.args[r]:n.type===1?e.Constant(n.value[r]):e.OrderedPairAccess([t,e.Constant(r+1)]);if(n.valueType===G)return isNaN(r)||r<0||r>3?e.Constant(NaN):n.type===16?n.args[r]:n.type===1?e.Constant(n.value[r]):e.OrderedTripleAccess([t,e.Constant(r+1)]);throw new Error(`Cannot access elements of ${pe(n.valueType)}`)}}function Dm(e,t,r){let n=e.getInstruction(t);if(r.length===0)return e.ConstantOfType(n.valueType,[]);if(n.type===1&&j(n.valueType)){let i=[],s=$e(n.valueType);for(let o of r){let a=Math.floor(o);isNaN(a)||a<0||a>=Hs(e,t,\"Programming error: expected Constant list instruction to have constant length.\")?i.push(qi(s)):i.push(n.value[a])}return e.ConstantOfType(n.valueType,i)}else if(n.type===38){let i=[];for(let s of r){let o=Math.floor(s);if(isNaN(o)||o<0||o>=Hs(e,t,\"Programming error: expected List instruction to have constant length.\")){let a=$e(n.valueType);i.push(e.NanOfType(a))}else i.push(n.args[o])}return e.List(i)}else{if(n.type===48&&n.isConstantBroadcast)return e.ConstantOfType(n.valueType,QM(e,t,r));{let i=[],s=!0,o=lr(e,t);for(let u of r){let c=Math.floor(u);i.push(e.Constant(c+1)),(isNaN(c)||c<0||o===void 0||c>=o)&&(s=!1)}let a=[t,e.List(i)];return s?e.InboundsListAccess(a):e.ListAccess(a)}}}function nD(e){if(e.instructionsLength()-1!==e.getReturnIndex())throw new Error(\"Programming Error: only the final instruction in a chunk can be constant collapsed\");let t=e.getInstruction(e.getReturnIndex());if(De(t))return e.getReturnIndex();switch(t.type){case 8:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(mP(n.value,i.value))):n.type===1&&Y(n.value)===0?(e.popInstruction(),t.args[1]):i.type===1&&Y(i.value)===0?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 9:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(yP(n.value,i.value))):n.type===1&&Y(n.value)===0?(e.popInstruction(),e.Negative([t.args[1]])):i.type===1&&Y(i.value)===0?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 10:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(gP(n.value,i.value))):n.type===1&&Y(n.value)===1?(e.popInstruction(),t.args[1]):i.type===1&&Y(i.value)===1?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 11:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(hP(n.value,i.value))):i.type===1&&Y(i.value)===1?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 12:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);if(n.type===1&&i.type===1)return e.popInstruction(),e.Constant(lp(n.value,i.value));if(n.type===1&&n.valueType===P){let s=Y(n.value);if(s===Math.E)return e.popInstruction(),e.SyntheticNativeFunction(\"exp\",[t.args[1]]);if(s>0)return e.popInstruction(),e.RawExponent(t.args)}if(i.type===1&&i.valueType===P){let s=Y(i.value);if(s===1)return e.popInstruction(),t.args[0];if(s===Math.floor(s))return e.popInstruction(),e.RawExponent(t.args);if(cr(i.value)){let{n:o,d:a}=i.value;if(a%2===1){e.popInstruction();let u=e.RawExponent([e.SyntheticNativeFunction(\"abs\",[t.args[0]]),t.args[1]]);return o%2===0?u:e.Multiply([e.SyntheticNativeFunction(\"sign\",[t.args[0]]),u])}}}return e.getReturnIndex()}case 13:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(lp(n.value,i.value))):i.type===1&&Y(i.value)===1?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 14:{let n=e.getInstruction(t.args[0]);return n.type===1?(e.popInstruction(),e.Constant(bP(n.value))):e.getReturnIndex()}case 25:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(he,xP(n.value,i.value))):e.getReturnIndex()}case 26:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(he,PP(n.value,i.value))):e.getReturnIndex()}case 27:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(he,TP(n.value,i.value))):e.getReturnIndex()}case 28:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(he,IP(n.value,i.value))):e.getReturnIndex()}case 29:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(he,EP(n.value,i.value))):e.getReturnIndex()}case 31:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(he,ZM(n.value,i.value))):e.getReturnIndex()}case 32:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(he,WM(n.value,i.value))):e.getReturnIndex()}case 33:{let n=e.getInstruction(t.args[0]);return n.type===1?(e.popInstruction(),n.value?t.args[1]:t.args[2]):e.getReturnIndex()}case 17:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===15&&i.type===1?(e.popInstruction(),n.args[Y(i.value)-1]):n.type===1&&n.valueType===N&&i.type===1?(e.popInstruction(),e.Constant(n.value[Y(i.value)-1])):e.getReturnIndex()}case 18:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===16&&i.type===1?(e.popInstruction(),n.args[Y(i.value)-1]):n.type===1&&n.valueType===G&&i.type===1?(e.popInstruction(),e.Constant(n.value[Y(i.value)-1])):e.getReturnIndex()}case 38:{if(FL(e,t.args)){e.popInstruction();let n=[];for(let i of t.args)n.push(e.getInstruction(i).value);return e.ConstantOfType(t.valueType,n)}return e.getReturnIndex()}case 39:case 41:{let n=t.args[0],i=e.getInstruction(n),s=e.getInstruction(t.args[1]);if(i.type===33&&s.type===1){let o=t.type===39?e.ListAccess([i.args[1],t.args[1]]):e.InboundsListAccess([i.args[1],t.args[1]]),a=t.type===39?e.ListAccess([i.args[2],t.args[1]]):e.InboundsListAccess([i.args[2],t.args[1]]);return e.Piecewise([i.args[0],o,a])}if(i.type===48){if(s.type===1&&i.isConstantBroadcast&&i.valueType!==ar)return e.ConstantOfType(t.valueType,Em(e,e.getReturnIndex()));e.popInstruction();let o=i.args[0],a=n-o,u=e.getInstruction(o),c=u.args[0],l,p;if(t.type===41)l=t.args[1];else{let y=lr(e,n);if(s.type===1&&s.valueType===P&&y!==void 0){let h=Y(s.value),m=Math.floor(h);if(m<1||m>y)return e.NanOfType(t.valueType);l=h===m?t.args[1]:e.Constant(m)}else{let h=e.Constant(1),b=e.getInstruction(c).args[0],d=e.SyntheticNativeFunction(\"floor\",[t.args[1]]),g=e.GreaterEqual([d,h]),x=e.LessEqual([d,b]);l=e.Piecewise([g,e.Piecewise([x,d,b]),h]),p={one:h,lengthIndex:b,roundedIndex:d,greaterEqualIndex:g,lessEqualIndex:x}}}if(u.args[a]<c)return u.args[a];let f=[l];for(let y=c+1;y<=u.args[a];y++){let h=e.getInstruction(y);if(De(h))f.push(e.copyInstruction(h));else{let m=[];for(let b of h.args)m.push(b>=c?f[b-c]:b);h.type===40?f.push(e.InboundsListAccess(m)):f.push(e.copyInstructionWithArgs(h,m))}}if(p){let{greaterEqualIndex:y,lessEqualIndex:h,lengthIndex:m,one:b}=p,d=$e(i.valueType),g=e.NanOfType(d),x=f[f.length-1],M=e.And([e.And([y,h]),e.GreaterEqual([m,b])]);return e.Piecewise([M,x,g])}else return f[f.length-1]}else if(s.type===1&&s.valueType===P)if(i.type===38){e.popInstruction();let o=Math.floor(Y(s.value))-1;return isNaN(o)||o<0||o>=i.args.length?e.NanOfType(t.valueType):i.args[o]}else if(i.type===1){e.popInstruction();let o=Math.floor(Y(s.value))-1;return isNaN(o)||o<0||o>=i.value.length?e.NanOfType(t.valueType):e.ConstantOfType($e(i.valueType),i.value[o])}else return e.getReturnIndex();else return e.getReturnIndex()}case 47:{let n=e.getInstruction(t.args[0]);if(!un(n)||Im(e,e.getReturnIndex(),n.args[0]))return e.getReturnIndex();let i=e.copy();i.close();let s=i.getCompiledFunction().fn();return e.popInstruction(),dP(e,t.valueType,s)}case 37:switch(t.symbol){case\"nthroot\":{let n=rD(e,t.args);if(n!==void 0)return e.Constant(jp(n[0],n[1]));{let i=e.getInstruction(t.args[1]);if(i.type===1&&i.valueType===P)return e.Exponent([t.args[0],e.Constant(ol(i.value))])}return e.getReturnIndex()}case\"count\":{let n=lr(e,t.args[0]);return n!==void 0?(e.popInstruction(),e.Constant(n)):e.getReturnIndex()}case\"select\":{let n=lr(e,t.args[0]);if(n!==void 0&&Vt(e.getInstruction(t.args[1]))){e.popInstruction();let i=Zt(e,t.args[1]),s=[];for(let o=0;o<Math.min(n,i.length);o++)i[o]&&s.push(o);return Dm(e,t.args[0],s)}else return e.getReturnIndex()}case\"shuffle\":{let n=t.args[0],i=t.args[1],s=lr(e,i);if(s!==void 0&&Vt(e.getInstruction(n))){e.popInstruction();let o=Ux(Zt(e,n),s);return Dm(e,i,o)}else return e.getReturnIndex()}case\"elementsAt\":{let n=t.args[0],i=t.args[1];if(Vt(e.getInstruction(i))){e.popInstruction();let s=Zt(e,i);return Dm(e,n,s)}return e.getReturnIndex()}default:{let n=rD(e,t.args);return n===void 0?e.getReturnIndex():(e.popInstruction(),e.ConstantOfType(t.valueType,DP(t.symbol,n)))}}case 44:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return Vt(n)&&Vt(i)?e.ConstantOfType(Qe,MP(t.tag,Zt(e,t.args[0]),Zt(e,t.args[1]))):e.getReturnIndex()}case 15:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&n.valueType===P&&i.type===1&&i.valueType===P?e.ConstantOfType(N,[n.value,i.value]):e.getReturnIndex()}case 16:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]),s=e.getInstruction(t.args[2]);return n.type===1&&n.valueType===P&&i.type===1&&i.valueType===P&&s.type===1&&s.valueType===P?e.ConstantOfType(G,[n.value,i.value,s.value]):e.getReturnIndex()}case 48:{let n=lr(e,e.getReturnIndex());return n!==void 0&&n===0?(e.popInstruction(),e.ConstantOfType(t.valueType,[])):e.getReturnIndex()}case 49:{for(let i of t.args)if(!Na(e.getInstruction(i)))return e.getReturnIndex();e.popInstruction();let n={};for(let i=0;i<t.symbols.length;i++){let s=t.symbols[i],o=e.getInstruction(t.args[i]);if(o.type===48&&(o=e.getInstruction(Br(e,t.args[i]))),o.type!==1)throw new Error(\"Expected instruction to be constant\");let{valueType:a,value:u}=o;$M(a,u)||(n[s]={value:u,valueType:a})}return e.ConstantOfType(Je,{type:\"Action\",updateRules:n})}case 20:case 22:case 23:case 24:case 40:case 42:case 21:case 19:return e.getReturnIndex();default:let r=t;throw new Error(`Unexpected opcode ${r.type}`)}}function FL(e,t){for(let r of t){let n=e.getInstruction(r);if(!Vt(n))return!1}return!0}function rD(e,t){let r=[];for(let n of t){let i=e.getInstruction(n);if(Vt(i))r.push(i.value);else return}return r}function Wt(e,t,r){switch(t){case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 17:case 18:case 21:case 19:case 23:return P;case 25:case 26:case 27:case 28:case 29:case 31:case 32:return he;case 33:{let i=e.getInstruction(r[1]).valueType,s=e.getInstruction(r[2]).valueType;return i===Le&&j(s)?s:s===Le&&j(i)?i:(i===Ae||i===xe)&&s===P?P:(i===Jt||i===Qt)&&s===te?te:i}case 15:return N;case 16:return G;case 38:{if(r.length===0)return Le;let i=e.getInstruction(r[0]).valueType;if(i===Ae||i===xe){let s=!1,o=!0;for(let a of r){let u=e.getInstruction(a).valueType;if(u===P&&(s=!0),u!==P&&u!==Ae&&u!==xe){o=!1;break}}s&&o&&(i=P)}return Fi(i)?Tn(i):Bt}case 39:case 40:case 41:{let i=e.getInstruction(r[0]).valueType;return j(i)?$e(i):Tt}case 44:return Qe;case 49:return Je;case 1:case 2:case 37:case 42:case 47:case 48:case 3:case 0:case 24:case 22:case 20:return Tt;default:let n=t;throw new Error(`Unexpected opcode ${n}`)}}var iD={segment:!0,ray:!0,vector:!0,line:!0,circle:!0,arc:!0,polygon:!0,glider:!0,midpoint:!0,intersection:!0,strictintersection:!0,perpendicular:!0,parallel:!0,translate:!0,rotate:!0,dilate:!0,reflect:!0,apply:!0,segments:!0,vertices:!0,angle:!0,angles:!0,directedangle:!0,directedangles:!0,clockwise:!0,counterclockwise:!0,reflex:!0,start:!0,end:!0};function VL(e){return e!==void 0&&e in iD}function vP(e){return VL(e)?e===\"rotate\"||e===\"dilate\"||e===\"translate\"||e===\"reflect\"?!0:!1:!1}function vm(e){if(e.type===\"ListAccess\"&&e.list.type===\"Identifier\"&&e.index.type===\"Constant\")return[e.list._symbol,e.index.asValue()];if(e.type===\"Identifier\")return[e._symbol,void 0]}function Om(e){let t={},r=e;if((r instanceof Wo||r instanceof Jo)&&(t.identifier=r._symbol,r=r._expression),r instanceof dc&&r.index instanceof fr&&(t.listAccess=r.index.asValue(),r=r.list),t.identifier&&r instanceof gt){let n=r._symbol,i=t.listAccess;t.assignmentRhsReference=[n,i]}if(r instanceof Lr){let n=r._symbol,i=r.args[0]instanceof gt?r.args[0]._symbol:void 0;if(vP(n)&&e instanceof Jo&&i&&e._argSymbols.some(s=>s===i))t.tree={symbol:n,parents:r.args.slice(1).map(vm)};else if(iD[n])t.tree={symbol:n,parents:r.args.map(vm)};else{let s=[r._symbol,void 0];t.tree={symbol:\"apply\",parents:[s,...r.args.map(vm)]}}}else if(r instanceof Hi){let n=r.args.map(vm);n.length===2&&n[1]&&n[1][0]===\"segments\"?t.tree={symbol:\"segment\",parents:[n[0]]}:n.length===2&&n[1]&&n[1][0]===\"start\"?t.tree={symbol:\"start\",parents:[n[0]]}:n.length===2&&n[1]&&n[1][0]===\"end\"&&(t.tree={symbol:\"end\",parents:[n[0]]})}return t}function sD(e,t,r,n,i){var d,g,x,M;if(!fc(t)&&!pl(t)||vP(t))return;let s,o=!1,a=!1,u=0,c=[],l=[],p=n.map(E=>e.getInstruction(E).valueType),f=fc(t)?Ls[t]:void 0;if(f&&(o=f.isSeeded,s=void 0,c.push(...f.argumentTypes),u=(g=(d=f.defaultArguments)==null?void 0:d.length)!=null?g:0,l=Sm(c,p,u),a=f.allowDotCall),t===\"mean\"&&l.length===0&&p.length>0&&ie(p[0],Ke))c=[[Ke]],u=0,l=[],a=!0;else if(pl(t)&&l.length===0&&!(f!=null&&f.fallthroughUnlessDistribution&&p.length>0&&ie(p[0],Ke))){let E=Pr[t];s=E.tag,c.push(...Ig(t)),u=(M=(x=E.defaultArguments)==null?void 0:x.length)!=null?M:0,l=Sm(c,p,u),a=a||E.allowDotCall}let y=Math.min(...c.map(ya)),h=Math.max(...c.map(tl)),m=n,b=n;if(o&&(b=m=n.slice(1),y-=1,h-=1),i){if(!a)throw Tl(r);let E=e.getInstruction(m[0]).valueType;if(!j(E)&&E!==dt&&E!==Re&&E!==Ke&&(E===N||!rl(E)))throw Hg(r,pe(E));r=\".\"+r,b=m.slice(1),y-=1,h-=1}if(!(l.length>0))throw BL(e,{symbol:t,errorSymbol:r,providedArgs:b,argsWithoutSeed:m,isDotCall:i,minArity:y,maxArity:h,defaultArgumentCount:u,builtInTag:s})}function BL(e,{symbol:t,errorSymbol:r,providedArgs:n,argsWithoutSeed:i,isDotCall:s,minArity:o,maxArity:a,defaultArgumentCount:u,builtInTag:c}){if(c===\"doubleReducer\"&&n.length===2){if(!j(e.getInstruction(n[0]).valueType)||!j(e.getInstruction(n[1]).valueType))throw _l(t)}else if(c===\"parameterizedReducer\"&&n.length===2&&!j(e.getInstruction(n[0]).valueType))throw Sb(t);if(t===\"logbase\"&&n.length!==2)return Ui(\"log\",1,n.length-1);if(t===\"random\")return Ih();if(n.length<o||n.length>a){let{dotMinArityExampleArgs:p,dotMaxArityExampleArgs:f,minArityExampleArgs:y,maxArityExampleArgs:h}=GL(t),m,b;if(n.length<o?(b=o-u,s&&p?m=r+p:y&&(m=r+y)):(b=a,s&&f?m=r+f:h&&(m=r+h)),c===\"reducer\"&&n.length===0)return vh(r);if(c===\"doubleReducer\")return Sl(r);if(c===\"parameterizedReducer\")return Dh(r);if(c===\"color\")return Mh(r);if(fc(t))switch(t){case\"pdf\":return s?Ui(r,b,n.length,m):bh();case\"cdf\":return s?Ui(r,b,n.length,m):n.length<o?xh():Ph();case\"tdist\":return Th();case\"length\":case\"round\":case\"midpoint\":case\"segment\":case\"vector\":case\"distance\":case\"circle\":case\"center\":case\"radius\":case\"glider\":case\"intersection\":case\"strictintersection\":case\"parallel\":case\"perpendicular\":case\"start\":case\"end\":case\"angle\":case\"directedangle\":case\"angles\":case\"directedangles\":case\"apply\":case\"translate\":case\"reflect\":case\"dilate\":case\"rotate\":case\"normaldist\":case\"poissondist\":case\"binomialdist\":case\"uniformdist\":case\"total\":case\"mean\":case\"median\":case\"stdev\":case\"var\":case\"quantile\":case\"sort\":case\"shuffle\":case\"join\":case\"unique\":case\"polygon\":case\"coterminal\":return Ui(r,b,n.length,m);case\"points\":case\"lines\":case\"circles\":case\"polygons\":case\"rays\":case\"vectors\":case\"arcs\":throw In(r);case\"histogram\":case\"dotplot\":case\"boxplot\":case\"ttest\":case\"ittest\":case\"stats\":case\"det\":case\"inv\":case\"transpose\":case\"rref\":case\"trace\":throw ne(`Unexpected arity error for ${t}`);default:let d=t;throw new Error(`Unexpected compiler function ${d}`)}return Ui(r,b,n.length)}if(t===\"polygon\"&&n.length===2&&e.getInstruction(n[0]).valueType===P&&e.getInstruction(n[1]).valueType===P)return Ol();let l=[];for(let p=0;p<i.length;p++){let f=i[p],y=c!==void 0&&c!==\"doubleReducer\"&&c!==\"never-broadcast\"&&!(c===\"parameterizedReducer\"&&p===0)&&t!==\"polygon\",h=e.getInstruction(f).valueType;j(h)&&y&&(h=$e(h)),l.push(pe(h))}return ci(r,l)}function GL(e){return fc(e)?Ls[e]:{}}function Sm(e,t,r){return ra(e,t).filter(n=>t.length+r>=ya(n))}var Fu=ps([[P,P]]),zL=ps([[{meta:\"union\",types:is},{meta:\"union\",types:[he,P]}]]),OP={Negative:ps([[P],[N],[ge],[Re],[G]]),Add:ps([[P,P],[N,N],[ge,ge],[Re,Re],[G,G]]),Subtract:ps([[P,P],[N,N],[ge,ge],[Re,Re],[G,G]]),Multiply:ps([[P,P],[N,P],[P,N],[P,ge],[P,Re],[ge,P],[Re,P],[G,P],[P,G]]),DotMultiply:ps([[P,P],[N,P],[P,N],[ge,ge],[Re,Re],[P,ge],[ge,P],[P,Re],[Re,P],[G,P],[P,G],[G,G]]),CrossMultiply:ps([[P,P],[N,P],[P,N],[ge,P],[P,ge],[Re,P],[P,Re],[Re,Re],[G,G]]),Divide:ps([[P,P],[N,P],[ge,P],[Re,P],[G,P]]),Exponent:Fu,\"Comparator['=']\":Fu,\"Comparator['>']\":Fu,\"Comparator['<']\":Fu,\"Comparator['>=']\":Fu,PercentOf:Fu,\"Comparator['<=']\":Fu,And:ps([[he,he]]),NamedCoordinateAccess:ps([[N],[G]]),Norm:ps([[P],[N],[G],[ge],[Re]]),ListAccess:zL};function na(e,t){let r=[];for(let n of t)r.push(pe(e.getInstruction(n).valueType));return r}function Vu(e,t){let r=[];for(let n of t){let i=e.getInstruction(n).valueType,s=j(i)?$e(i):i;r.push(pe(s))}return r}function Ye(e,t,r){return ie(e.getInstruction(t).valueType,r)}function Rm(e,t){return Array.isArray(e)?t>e.length-1?void 0:e[t]:t<e.initial.length?e.initial[t]:e.rest}function Aa(e,t,r,n){var c,l;let i=r.type;if(i===\"FunctionCall\"||i===\"SeededFunctionCall\"||i===\"DotAccess\"){let p,f;if(r instanceof Hi&&(r.args[1]instanceof gt||r.args[1]instanceof Lr))p=r.args[1]._symbol,f=(c=r.args[1]._errorSymbol)!=null?c:p;else if(r instanceof Lr||r instanceof fu)p=r._symbol,f=(l=r._errorSymbol)!=null?l:p;else return;if(p===\"polygon\"&&t.is3dPolicy())throw hd();sD(e,p,f,n,r instanceof Hi);return}let s=RP(e,t,r,n);if(!s)return;let o=Math.min(...s.map(ya));if(s.length>0&&n.length>=o)return;let a=n.map(p=>e.getInstruction(p).valueType),u=HL(i,a);switch(i){case\"Add\":throw Rg(u);case\"Subtract\":throw Ng(u);case\"CrossMultiply\":throw t.is3dProduct()&&a.length===2&&(ie(a[0],N)&&ie(a[1],N)||ie(a[0],P)&&ie(a[1],G)||ie(a[0],G)&&ie(a[1],P))?hl(u):gl(u);case\"DotMultiply\":throw gl(u);case\"Multiply\":{if(t.is3dProduct()&&a.length===2){if(ie(a[0],G)&&ie(a[1],G))throw xl(u);if(ie(a[0],N)&&ie(a[1],N))throw bl(u)}throw gl(u)}case\"Divide\":throw Ag(u);case\"Exponent\":throw Cg(u);case\"Negative\":throw _g(u);case\"Comparator['=']\":case\"Comparator['>']\":case\"Comparator['<']\":case\"Comparator['>=']\":case\"Comparator['<=']\":throw Lg(u);case\"And\":throw Hf(u);case\"Piecewise\":throw ie(a[0],he)?eh([pe(e.getInstruction(n[1]).valueType),pe(e.getInstruction(n[2]).valueType)]):Kg(u);case\"List\":{oD(e,n);break}case\"ListAccess\":throw Pl(u);case\"Norm\":throw ci(\"abs\",u);case\"ParenSeq\":{let p=a.indexOf(Je)!==-1,f=a.some(h=>h!==Je);if(p&&f)throw Xf([pe(a[0]),pe(a[1])]);if(a.length!==2&&(!t.is3dProduct()||a.length!==3)){let h=t.is3dPolicy()?3:2;throw Rh(h)}let y=a.find(h=>!ie(h,P));throw y!==void 0?wg(pe(y)):ne(\"Unexpected error type checking ParenSeq\")}case\"BareSeq\":{if(a.length<2)throw In(\",\");let p=a[0],f=a.find(y=>y!==p);if(f)throw Xf([pe(p),pe(f)]);if(p===P)throw n.length===2?Oh():Sh();oD(e,n);break}case\"Ans\":case\"Constant\":case\"Assignment\":case\"MixedNumber\":case\"Identifier\":case\"Construction\":case\"Range\":case\"NamedCoordinateAccess\":case\"Sum\":case\"Product\":case\"Integral\":case\"ListComprehension\":case\"FunctionExponent\":case\"FunctionFactorial\":case\"Prime\":case\"Derivative\":case\"UpdateRule\":case\"Substitution\":case\"CoordinateEquation\":case\"FunctionDefinition\":case\"Slider\":case\"RegressionParameter\":case\"Seed\":case\"ExtendSeed\":case\"PercentOf\":return;default:{let p=i;throw new Error(`Unexpected node type: ${p}`)}}}function oD(e,t){if(t.length===0)return;let r=e.getInstruction(t[0]).valueType;if(!Fi(r))throw mu([pe(r)]);for(let n of t){let i=e.getInstruction(n).valueType;if(!Fi(i))throw mu([pe(i)]);if(i!==r)throw El()}}function HL(e,t){let r=n=>j(n)?$e(n):n;switch(e){case\"Add\":case\"Subtract\":case\"Multiply\":case\"Divide\":case\"Exponent\":case\"Negative\":case\"Comparator['<']\":case\"Comparator['>']\":case\"Comparator['=']\":case\"Comparator['<=']\":case\"Comparator['>=']\":case\"NamedCoordinateAccess\":return t.map(r).map(pe);case\"ListAccess\":case\"Constant\":case\"MixedNumber\":case\"Identifier\":case\"Ans\":case\"List\":case\"Range\":case\"Construction\":case\"ParenSeq\":case\"BareSeq\":case\"Norm\":case\"Sum\":case\"Product\":case\"Integral\":case\"ListComprehension\":case\"FunctionExponent\":case\"FunctionFactorial\":case\"Prime\":case\"Piecewise\":case\"Derivative\":case\"UpdateRule\":case\"Substitution\":case\"Assignment\":case\"CoordinateEquation\":case\"FunctionDefinition\":case\"Slider\":case\"RegressionParameter\":case\"Seed\":case\"ExtendSeed\":case\"DotMultiply\":case\"CrossMultiply\":case\"And\":case\"PercentOf\":return t.map(pe);default:{let n=e;throw new Error(`Unexpected node type: ${n}`)}}}function uD(e,t){let r=e.getInstruction(t);if(De(r))return;let n=SP(e,r).expectedTypes;if(r.type===49){for(let a of r.args){let u=e.getInstruction(a).valueType;if(!ie(u,P)&&!ie(u,N)&&!ie(u,G)&&!ie(u,It)&&!ie(u,we)&&!ie(u,Oe)&&!ie(u,ye)&&!ie(u,_e)&&!ie(u,ge)&&!ie(u,de)&&!ie(u,ue)&&!ie(u,Ae)&&!ie(u,xe))throw ih(pe(u))}let o={};for(let a of r.symbols){if(o[a])throw oh(a);o[a]=!0}return}let i=[];for(let o=0;o<r.args.length;o++){let a=e.getInstruction(r.args[o]).valueType,u=Rm(n,o);(u===void 0||!NP(a,u))&&i.push(r.args[o])}if(i.length===0)return;let s=na(e,r.args);switch(r.type){case 32:throw Hf(s);case 17:case 18:throw Fg(s);case 21:{let o=e.getInstruction(r.args[0]).valueType,a=e.getInstruction(r.args[1]).valueType;if(o!==P)throw Zg([pe(o)]);if(a!==P)throw Wg([pe(a)]);return}case 22:{let o=e.getInstruction(r.args[1]).valueType;throw jg([pe(o)])}case 44:{if(e.getInstruction(r.args[0]).valueType!==Qe||e.getInstruction(r.args[1]).valueType!==Qe&&e.getInstruction(r.args[1]).valueType!==P)throw ne(`Unexpected arg types for ExtendSeed: ${na(e,r.args).map(o=>o.key).join(\", \")}`);return}case 31:case 15:case 16:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 25:case 26:case 27:case 28:case 29:case 38:case 39:case 40:case 41:case 37:case 42:case 33:case 48:case 47:case 23:case 24:case 19:case 20:throw ne(`Invalid argument types for opcode ${r.type}`);default:{let o=r;throw new Error(`Unexpected opcode: ${o.type}`)}}}function SP(e,t,r=!1){switch(t.type){case 8:case 9:case 10:case 11:return r&&t.args.length>0&&e.getInstruction(t.args[0]).valueType===N?{expectedTypes:[N,N]}:{expectedTypes:[P,P]};case 12:case 13:case 25:case 26:case 27:case 28:case 29:return{expectedTypes:[P,P]};case 14:return{expectedTypes:[P]};case 31:return{expectedTypes:[he,he]};case 32:return{expectedTypes:[he,he]};case 33:return{expectedTypes:[he,t.valueType,t.valueType]};case 15:case 16:return{expectedTypes:t.args.map(()=>P)};case 17:return{expectedTypes:[N,P]};case 18:return{expectedTypes:[G,P]};case 21:return{expectedTypes:[P,P]};case 22:{let n=e.getInstruction(t.args[1]).valueType;return n===N||n===G?{expectedTypes:[P,n]}:{expectedTypes:[P,P]}}case 38:{let n=t.valueType,i=$e(n);return{expectedTypes:{type:\"variadic\",initial:[],rest:i}}}case 39:case 40:case 41:return{expectedTypes:[Bt,P]};case 37:{let n=t.symbol,i=Pr[n],s=i.argumentTypes;if(i.tag===\"reducer\"&&!UL(e,t.args)&&Array.isArray(s)&&typeof s[0]==\"number\"&&j(s[0]))return{isReducerWithNoListArgs:!0,expectedTypes:{type:\"variadic\",initial:[],rest:$e(s[0])}};if(Array.isArray(s))return{expectedTypes:s};{let{initial:o,rest:a}=s,u=t.args.length-o.length,c=[...o];for(let l=0;l<u;l++)c.push(a);return{expectedTypes:c}}}case 44:return e.getInstruction(t.args[0]).valueType===Qe&&e.getInstruction(t.args[1]).valueType!==Qe?{expectedTypes:[Qe,P]}:{expectedTypes:t.args.map(n=>e.getInstruction(n).valueType)};case 47:return{expectedTypes:t.args.map(n=>e.getInstruction(n).valueType)};case 23:return{expectedTypes:[P]};case 19:return{expectedTypes:t.args.map(n=>{let i=e.getInstruction(n).valueType;return i===he||t.callData.type===\"sum\"&&(i===N||i===G)?i:P})};case 24:case 20:{let n=[P];for(let i=1;i<t.args.length;i++)n.push(e.getInstruction(t.args[i]).valueType);return{expectedTypes:n}}case 42:return{expectedTypes:t.args.map(()=>P)};case 48:case 49:return{expectedTypes:t.args.map(n=>e.getInstruction(n).valueType)};default:{let n=t;throw new Error(`Unexpected opcode: ${n.type}`)}}}function RP(e,t,r,n){let i=[];for(let s of n)i.push(s===void 0?void 0:e.getInstruction(s).valueType);if(r instanceof Pa){let s=n.filter(a=>a!==void 0);if(s.length===0)return;let o=Wt(e,38,s);return j(o)&&o!==Bt?ra([{type:\"variadic\",initial:[],rest:$e(o)}],i):[]}else if(r instanceof Lr||r instanceof fu||r instanceof Hi){let s=r instanceof Hi?r.args[1]._symbol:r._symbol;if(!s)return;let o=fl(s);return o?ra(o,i):void 0}else if(r instanceof Zo){let[s,o,a]=n,u=o&&e.getInstruction(o),c=u==null?void 0:u.valueType,l=a&&e.getInstruction(a),p=l==null?void 0:l.valueType;!(c!==void 0&&p!==void 0&&(uo(c,p)||uo(p,c)))&&l&&Vt(l)&&l.valueType==P&&Ei(l.value)&&(a=void 0,l=void 0,p=void 0);let y;if(c===Le&&p!==void 0&&j(p))y=p;else if(c!==void 0&&(uo(c,P)||uo(c,te)))y=P;else if(c!==void 0)y=c;else if(p!==void 0)y=p;else return;return j(y)&&(y=$e(y)),ra([_n([he,y,y])],[i[0],c,p])}else if(t.is3dProduct()&&r instanceof Ic){let s=[...OP.DotMultiply,_n([N,N])];return ra(s,i)}else if(r instanceof os){let s=[{type:\"variadic\",initial:[Je],rest:Je},_n([P,P])];return t.is3dProduct()&&s.push(_n([P,P,P])),ra(s,i)}else if(r instanceof mc){let s=[{type:\"variadic\",initial:[Je],rest:Je}],o=n.filter(a=>a!==void 0&&e.getInstruction(a).valueType!==P);if(o.length>0){let a=Wt(e,38,o);j(a)&&a!==Bt&&s.push({type:\"variadic\",initial:[],rest:$e(a)})}return ra(s,i)}else if(r.type in OP&&i.some(s=>s!==void 0)){let s=OP[r.type];return s?ra(s,i):void 0}}function ra(e,t){let r=[];for(let n of e)Array.isArray(n)&&n.length<t.length||t.every((i,s)=>{if(i===void 0)return!0;let o=Rm(n,s);return o===void 0?!1:kL(i,o)})&&r.push(n);return r}function UL(e,t){for(let r of t)if(j(e.getInstruction(r).valueType))return!0;return!1}function NP(e,t){return typeof t==\"number\"?Ss(e,t):t.types.some(r=>Ss(e,r))}function kL(e,t){return typeof t==\"number\"?uo(e,t):t.types.some(r=>uo(e,r))}function Nm(e,t){let r=new Set;for(let n of e){let i;if(Array.isArray(n)){if(t>=n.length)continue;i=aD(n[t])}else i=aD(t<n.initial.length?n.initial[t]:n.rest);for(let s of i)r.add(s)}return[...r]}function aD(e){return typeof e==\"number\"?[e]:e.types}function ps(e){return e.map(_n)}function Am(e){let t=[];for(let r=0;r<e.instructionsLength();r++){t.push(0);let n=e.getInstruction(r);if(!De(n))if(un(n)&&n.type!==22)for(let i of n.args)t[i]=1/0;else for(let i of n.args)t[i]+=1}return t}var Lm=AP({sin:Tr(\"isinf(x) || isnan(x) ? NaN : dcg_isPiMultiple(abs(x)) ? 0.0 : sin(x)\"),cos:Tr(\"isinf(x) || isnan(x) ? NaN : dcg_isOddHalfPiMultiple(abs(x)) ? 0.0 : cos(x)\"),tan:vo(ft`float a=abs(x);\n    return isinf(x) || isnan(x) ? NaN\n      : dcg_isPiMultiple(a) ? 0.0\n      : dcg_isOddHalfPiMultiple(a) ? Infinity\n      : tan(x);`),cot:vo(ft`float a=abs(x);\n      return isinf(x) || isnan(x) ? NaN\n        : a < 0.03 ? 1.0/x - x/3.0\n        : dcg_isPiMultiple(a) ? Infinity\n        : dcg_isOddHalfPiMultiple(a) ? 0.0\n        : 1.0 / tan(x);`),sec:Tr(\"isinf(x) || isnan(x) ? NaN : dcg_isOddHalfPiMultiple(abs(x)) ? Infinity: 1.0 / cos(x)\"),csc:vo(ft`float a=abs(x);\n      return isinf(x) || isnan(x) ? NaN\n        : a < 0.03 ? 1.0/x + x/6.0\n        : dcg_isPiMultiple(a) ? Infinity\n        : 1.0 / sin(x);`),arcsin:vo(ft`if (isinf(x) || isnan(x)) { return NaN; }\n    if (x == 1.0) { return dcg_PI/2.0; }\n    if (x == -1.0) { return -dcg_PI/2.0; }\n    if (x > 1.0 || x < -1.0) return NaN;\n    float y0 = asin(x);\n    return y0 + (x - sin(y0)) / cos(y0);`),arccos:vo(ft`if (isinf(x) || isnan(x)) { return NaN; }\n    if (x == 1.0) { return 0.0; }\n    if (x == -1.0) { return dcg_PI; }\n    if (x > 1.0 || x < -1.0) return NaN;\n    float y0 = acos(x);\n    return y0 + (cos(y0) - x) / sin(y0);`),arctan:Cm(ft`isnan(x) || isnan(y) ? NaN\n      : isinf(x) && isinf(y) ?\n        (y > 0.0 ? 0.25 : 0.75) * sign(x) * dcg_PI\n      : x == 0.0 && y == 0.0 ? y\n      : atan(x, y)\n    `),arccot:Tr(\"isnan(x) ? NaN : dcg_PI/2.0 - atan(x)\"),arcsec:Tr(\"isnan(x) ? NaN : dcg_arccos(1.0/x)\"),arccsc:Tr(\"isnan(x) ? NaN : dcg_arcsin(1.0/x)\"),sinh:Tr(\"isinf(x) ? x : isnan(x) ? NaN : sinh(x)\"),cosh:Tr(\"isinf(x) ? Infinity : isnan(x) ? NaN : cosh(x)\"),tanh:Tr(\"abs(x) > 10.0 ? sign(x) : isnan(x) ? NaN : tanh(x)\"),coth:Tr(\"abs(x) > 10.0 ? sign(x) : isnan(x) ? NaN : x == 0.0 ? Infinity : abs(x) < 0.03 ? 1.0/x + x/3.0 : 1.0/tanh(x)\"),sech:Tr(\"isinf(x) ? 0.0 : isnan(x) ? NaN : 1.0/cosh(x)\"),csch:Tr(\"isinf(x) ? 0.0 : isnan(x) ? NaN : x == 0.0 ? Infinity : abs(x) < 0.03 ? 1.0/x - x/6.0 : 1.0/sinh(x)\"),arcsinh:vo(ft`float a=abs(x);\n      return isnan(x) ? NaN : sign(x) * (\n        1.0 + x * x == 1.0\n          ? dcg_log1p(a)\n          : log(a + dcg_rtxsqpone(a))\n      );`),arccosh:Tr(\"x < 1.0 || isnan(x) ? NaN : log(x + dcg_rtxsqmone(x))\"),arctanh:vo(ft`if (isnan(x) || abs(x) > 1.0) { return NaN; }\n      if (x == 1.0) { return Infinity; }\n      if (x == -1.0) { return -Infinity; }\n      float y0 = 0.5*(dcg_log1p(x) - dcg_log1p(-x));\n      float c = cosh(y0);\n      return y0 + (x - tanh(y0)) * c * c;`),arccoth:Tr(\"isnan(x) ? NaN : abs(x) >= 1.0 ? dcg_arctanh(1.0/x) : NaN\"),arcsech:Tr(\"isnan(x) ? NaN : 0.0 < x && x <= 1.0 ? dcg_arccosh(1.0/x) : x == 0.0 ? Infinity : NaN\"),arccsch:Tr(\"isinf(x) ? 0.0 : isnan(x) ? NaN : dcg_arcsinh(1.0/x)\"),sqrt:Tr(\"isnan(x) ? NaN : x >= 0.0 ? sqrt(x) : NaN\"),rtxsqpone:Tr(\"dcg_hypot(x, 1.0)\"),rtxsqmone:vo(\"float t = x*x; return isnan(x) || t < 1.0 ? NaN : t - 1.0 == t ? abs(x) : sqrt(t - 1.0);\"),nthroot:Cm(\"isnan(x) || isnan(y) ? NaN : dcg_pow(x, 1.0/y)\"),hypot:yD(ft`if (isnan(x) || isnan(y)) return NaN;\n      if (isinf(x) || isinf(y)) return Infinity;\n      x = abs(x);\n      y = abs(y);\n      float m = max(x,y);\n      x /= m;\n      y /= m;\n      return m == 0.0 ? 0.0 : sqrt(x*x + y*y) * m;`),log:Tr(\"isnan(x) ? NaN : x > 0.0 ? log(x)*0.4342944819 : x == 0.0 ? -Infinity : NaN\"),logbase:Cm(ft`isnan(x) || isnan(y) ? NaN\n      : y == 1.0 ?\n        (\n          x > 1.0 ? Infinity\n          : x == 1.0 ? NaN\n          : x < 0.0 ? NaN\n          : -Infinity\n        )\n      : y > 0.0 ?\n        (\n          x > 0.0 ? log(x)/log(y)\n          : x == 0.0 && !isinf(y) ? -Infinity\n          : NaN\n        )\n      : NaN`),ln:Tr(\"isnan(x) ? NaN : x > 0.0 ? log(x) : x == 0.0 ? -Infinity : NaN\"),exp:Tr(\"isnan(x) ? NaN : exp(x)\"),floor:Tr(\"isnan(x) ? NaN : floor(x)\"),ceil:Tr(\"isnan(x) ? NaN : ceil(x)\"),round:Tr(\"isinf(x) || isnan(x) ? x : floor(0.5 + x)\"),abs:Tr(\"isnan(x) ? NaN : abs(x)\"),sign:Tr(\"isnan(x) ? NaN : sign(x)\"),mod:Cm(\"isinf(x) || isinf(y) || isnan(x) || isnan(y) || y == 0.0 ? NaN : mod(x, y)\"),distance:Vc(\"float\",\"vec2 a, vec2 b\",ft`\n      if (any(isnan(a)) || any(isnan(b))) return NaN;\n      vec2 d = a-b;\n      return dcg_hypot(d.x, d.y);`),distanceThreeD:Vc(\"float\",\"vec3 a, vec3 b\",ft`\n      if (any(isnan(a)) || any(isnan(b))) return NaN;\n      vec3 d = a-b;\n      return dcg_hypot(dcg_hypot(d.x, d.y), d.z);`),hsv:Vc(\"vec3\",\"float h, float s, float v\",ft`if (isnan(h) || isnan(s) || isnan(v)) {discard;}\n      vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n      if (isinf(h)) h = 0.0;\n      vec3 p = abs(fract(h / 360.0 + K.xyz) * 6.0 - K.www);\n      return vec3(clamp(v, 0.0, 1.0) * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), clamp(s, 0.0, 1.0)));`),rgb:Vc(\"vec3\",\"float r, float g, float b\",ft`if (isnan(r) || isnan(g) || isnan(b)) {discard;}\n    return clamp(vec3(r,g,b),0.0,255.0)/255.0;`),erf:vo(ft`if (isnan(x)) return NaN;\n      float t = abs(x);\n      float n = x*x;\n      float r = -n;\n      return sign(x) * (\n        r < -750.0\n          ? 1.0\n          : t >= 0.065\n          ? 1.0 - exp(r) * (\n            t > 50000000.0\n              ? r / t\n              : t > 50.0\n              ? (r * (n * (n + 4.5) + 2.0)) / (t * (n * (n + 5.0) + 3.75))\n              : ((0.9999999999999999+t*(2.224574423459406+t*(2.444115549920689+\n                t*(1.7057986861852539+t*(0.8257463703357973+\n                  t*(0.28647031042892007+t*(0.07124513844341643+\n                    t*(0.012296749268608364+t*(0.001347817214557592+\n                      0.00007263959403471071*t))))))))\n                )/(1.0+t*(3.352953590554884+t*(5.227518529742423+\n                  t*(5.003720878235473+t*(3.266590890998987+\n                    t*(1.5255421920765353+t*(0.5185887413188858+\n                      t*(0.12747319185915415+t*(0.02185979575963238+\n                        t*(0.0023889438122503674+0.00012875032817508128*t\n                ))))))))))\n              )\n          )\n          : t*(1.1283791670955126+r*(0.37612638903183754+\n              r*(0.11283791670955126+r*(0.026866170645131252+\n                0.005223977625442188*r))))\n      );`)});function Vc(e,t,r){return{type:\"scalar\",value:`${e} dcg_[[name_here]](${t}){ ${r} }`}}function vo(e){return Vc(\"float\",\"float x\",e)}function Tr(e){return vo(`return ${e};`)}function yD(e){return Vc(\"float\",\"float x, float y\",e)}function Cm(e){return yD(`return ${e};`)}function li(e,{outType:t,deps:r}={}){let n=t!=null?t:()=>\"float\";return{type:\"reducer\",value:i=>`${n(i)} dcg_[[name_here]](float[${i}] L) { ${e(i)} }`,deps:r!=null?r:[]}}function _m(e,t=()=>\"float\"){return{type:\"double-reducer\",value:(r,n)=>{let i=Math.min(r,n),s=t(i),o=e(i);return`${s} dcg_[[name_here]](float[${r}] X, float[${n}] Y) { ${o} }`}}}var qL=AP({lcm:li(e=>ft`float g = abs(dcg_round(L[0]));\n      if (isinf(g)) return Infinity;\n      if (isnan(g)) return NaN;\n      for (int i=1; i<${e}; i++) {\n        float v = abs(dcg_round(L[i]));\n        if (isinf(v)) return Infinity;\n        if (isnan(v)) return NaN;\n        g *= dcg_round(v / dcg_gcd2(g, v));\n      }\n      return g;`),gcd:li(e=>ft`float g = abs(dcg_round(L[0]));\n      if (isnan(g)) return NaN;\n      for (int i=1; i<${e}; i++) {\n        float x = L[i];\n        if (isnan(x)) return NaN;\n        g = dcg_gcd2(g, abs(dcg_round(x)));\n      }\n      return g;`),mean:li(e=>ft`float tot = 0.0;\n      for (int i=0; i<${e}; i++) {\n        float x = L[i];\n        if (isnan(x) || (isinf(x) && x == -tot)) return NaN;\n        tot += x;\n      }\n      return tot / ${e}.0;`),total:li(e=>ft`float tot = 0.0;\n      for (int i=0; i<${e}; i++) {\n        float x = L[i];\n        if (isnan(x) || (isinf(x) && x == -tot)) return NaN;\n        tot += x;\n      }\n      return tot;`),stdev:li(e=>lD(e,e-1),{deps:[\"mean\"]}),stdevp:li(e=>lD(e,e),{deps:[\"mean\"]}),mad:li(e=>ft`float mean = dcg_mean(L);\n      if (isnan(mean) || isinf(mean)) return NaN;\n      float tot = 0.0;\n      for (int i=0; i<${e}; i++) {\n        tot += abs(L[i] - mean);\n      }\n      return tot / ${e}.0;`,{deps:[\"mean\"]}),min:li(e=>pD(e,\"min\")),max:li(e=>pD(e,\"max\")),argmin:li(e=>fD(e,\"<\")),argmax:li(e=>fD(e,\">=\")),median:li(e=>e%2===1?`return L[int(dcg_sortPerm(L)[${(e-1)/2}])-1];`:ft`float[${e}] perm = dcg_sortPerm(L);\n          return 0.5*(L[int(perm[${e/2}])-1]+L[int(perm[${e/2-1}])-1]);`,{deps:[\"sortPerm\"]}),varp:li(e=>cD(e,e),{deps:[\"mean\"]}),var:li(e=>cD(e,e-1),{deps:[\"mean\"]}),sortPerm:li(e=>{if(e>100)throw gc();return ft`int[${e}] perm;\n        int[${e}] nextPerm;\n        for (int i=0; i<${e}; i++)\n          perm[i] = i;\n        float lastMin = -Infinity;\n        int lastIndex = -1;\n        for (int i=0; i<${e}; i++) {\n          float currMin = Infinity;\n          int currIndex = -1;\n          int j;\n          for (j=0; j<${e}; j++) {\n            float e = L[j];\n            if (\n              (e > lastMin || (e == lastMin && j > lastIndex))\n              && e < currMin\n            ) {\n              currMin = e;\n              currIndex = j;\n            }\n          }\n          perm[i] = currIndex;\n          lastMin = currMin;\n          lastIndex = currIndex;\n        }\n        float[${e}] permFloat;\n        for (int i=0; i<${e}; i++)\n          permFloat[i] = float(perm[i] + 1);\n        return permFloat;`},{outType:e=>`float[${e}]`})});function cD(e,t){return t===0?\"return NaN;\":ft`float mean = dcg_mean(L);\n    if (isnan(mean) || isinf(mean)) return NaN;\n    float tot = 0.0;\n    for (int i=0; i<${e}; i++) {\n      float delta = L[i] - mean;\n      tot += delta * delta;\n    }\n    return tot / ${t}.0;`}function lD(e,t){return t===0?\"return NaN;\":ft`float mean = dcg_mean(L);\n    if (isnan(mean) || isinf(mean)) return NaN;\n    float tot = 0.0;\n    for (int i=0; i<${e}; i++) {\n      tot = dcg_hypot(tot, L[i] - mean);\n    }\n    return tot / ${Fm(Math.sqrt(t))};`}function pD(e,t){return ft`float m = L[0];\n    if (isnan(m)) return NaN;\n    for (int i=1; i<${e}; i++) {\n      float x = L[i];\n      if (isnan(x)) return NaN;\n      m = ${t}(m, x);\n    }\n    return m;`}function fD(e,t){return ft`if (isnan(L[0])) return 0.0;\n    int arg = 0;\n    float best = L[0];\n    for (int i=1; i<${e}; i++) {\n      float e = L[i];\n      if (isnan(e)) return 0.0;\n      if (e ${t} best) {\n        arg = i;\n        best = e;\n      }\n    }\n    return float(arg + 1);`}var YL=AP({elementsAt:_m(e=>`float[${e}] outList;\n      for (int i=0; i<${e}; i++) {\n        float y = Y[i];\n        outList[i] = isnan(y) || isinf(y) ? NaN : X[int(y)-1];\n      }\n      return outList;`,e=>`float[${e}]`),cov:_m(e=>dD(e,e-1)),covp:_m(e=>dD(e,e)),corr:_m(e=>ft`${gD(e)}\n      float t1 = 0.0;\n      float t2 = 0.0;\n      float tc = 0.0;\n      for (int i=0; i<${e}; i++) {\n        float d1 = X[i] - m1;\n        float d2 = Y[i] - m2;\n        t1 = dcg_hypot(t1, d1);\n        t2 = dcg_hypot(t2, d2);\n        tc += d1 * d2;\n      }\n      return tc / (t1 * t2);`)}),XL=W(W(W({},Lm),qL),YL),wm=XL;function $L(e,t){switch(e.type){case\"scalar\":return e.value.replace(\"[[name_here]]\",t);case\"reducer\":{let r=e.value;return n=>r(n).replace(\"[[name_here]]\",t)}case\"double-reducer\":{let r=e.value;return(n,i)=>r(n,i).replace(\"[[name_here]]\",t)}}}function AP(e){for(let[t,r]of Object.entries(e))r.type!==\"omitted\"&&(r.value=$L(r,t));return e}function dD(e,t){return ft`${gD(e)}\n    float tot = 0.0;\n    for (int i=0; i<${e}; i++) {\n      tot += (X[i] - m1) * (Y[i] - m2);\n    }\n    return tot / ${t}.0;`}function gD(e){return ft`float m1 = 0.0;\n    for (int i=0; i<${e}; i++) {\n      float x = X[i];\n      if (isnan(x) || isinf(x)) return NaN;\n      m1 += x;\n    }\n    m1 /= ${e}.0;\n    float m2 = 0.0;\n    for (int i=0; i<${e}; i++) {\n      float y = Y[i];\n      if (isnan(y) || isinf(y)) return NaN;\n      m2 += y;\n    }\n    m2 /= ${e}.0;`}var ZL=[ft`float dcg_rawpow(float x, float y) {\n    if (isnan(x) || isnan(y)) return NaN;\n    if (isinf(y)) {${\"\"}\n      float a = abs(x);\n      if (a == 1.0) return NaN;\n      if (y > 0.0) {\n        return a > 1.0 ? Infinity : 0.0;\n      } else {\n        return a < 1.0 ? Infinity : 0.0;\n      }\n    }\n    if (x > 0.0) return pow(x, y);\n    else if (x == 0.0) {\n      if (y > 0.0) return 0.0;\n      else if (y == 0.0) return 1.0;\n      else return Infinity;\n    } else {\n      float m = mod(y, 2.0);\n      if (m == 1.0) return -pow(-x, y);\n      else return pow(-x, y);\n    }\n  }`,ft`float dcg_pow(float x, float y) {\n    if (isnan(x) || isnan(y)) return NaN;\n    if (isinf(y)) {\n      float a = abs(x);\n      if (a == 1.0) return NaN;\n      if (y > 0.0) {\n        return a > 1.0 ? Infinity : 0.0;\n      } else {\n        return a < 1.0 ? Infinity : 0.0;\n      }\n    }\n    if (x > 0.0) return pow(x,y);\n    else if (x == 0.0) {\n      if (y > 0.0) return 0.0;\n      if (y == 0.0) return 1.0;\n      if (y < 0.0) return Infinity;\n    } else {\n      float m = mod(y, 2.0);\n      if (m == 0.0) return pow(-x, y);\n      else if (m == 1.0) return -pow(-x, y);\n      else {${\"\"}\n        vec2 a0 = vec2(0.0, 1.0);\n        vec2 a1 = vec2(1.0, 0.0);\n        float approx = y;\n        for (int i=0; i<12; i+=1) {\n          float whole = floor(approx);\n          vec2 a = whole * a1 + a0;\n          if (a.y > 100.0) break;\n          a0 = a1; a1 = a;\n          if (approx == whole) break;\n          approx = 1.0 / (approx - whole);\n        }${\"\"}\n        float r = a1.x / a1.y;\n        float m = max(max(abs(y), abs(r)), 1.0);\n        if (abs(mod(a1.y, 2.0) - 1.0) < 0.01 && abs((r - y)/y) < 0.00001) {\n          return (mod(a1.x, 2.0) == 0.0 ? 1.0 : -1.0) * pow(-x, y);\n        } else {\n          return NaN;\n        }\n      }\n    }\n  }`,ft`float dcg_add(float x, float y) {\n    return isnan(x) || isnan(y) ? NaN\n      : isinf(x) && isinf(y) && x != y ? NaN\n      : x + y;\n  }`,ft`float dcg_sub(float x, float y) {\n    return isnan(x) || isnan(y) ? NaN\n      : isinf(x) && isinf(y) && x != -y ? NaN\n      : x - y;\n  }`,ft`float dcg_mul(float x, float y) {\n    return isnan(x) || isnan(y) ? NaN\n      : isinf(x) && y == 0.0 ? NaN\n      : x == 0.0 && isinf(y) ? NaN\n      : x * y;\n  }`,ft`float dcg_div(float x, float y) {\n    return isnan(x) || isnan(y) ? NaN\n      : isinf(x) && isinf(y) ? NaN\n      : x == 0.0 && y == 0.0 ? NaN\n      : x / y;\n  }`,ft`float dcg_neg(float x) {\n    return isnan(x) ? NaN : -x;\n  }`,ft`float dcg_gcd2(float u, float v) {\n    if (isinf(u)) return v;\n    if (isinf(v)) return u;\n    for (int i=0; i<95; i++) {\n      if (v == 0.0) break;\n      u = mod(u, v);\n      if (u == 0.0) break;\n      v = mod(v, u);\n    }\n    return u+v;\n  }`,ft`float dcg_log1p(float x) {\n    return x - 0.5 * x * x == x ? x : log(1.0 + x);\n  }`,ft`bool dcg_isPiMultiple(float absx) {\n    if (absx > 1.0e5) return false;\n    return floor(0.5 + dcg_PI_INV * absx) * dcg_PI == absx;\n  }`,ft`bool dcg_isOddHalfPiMultiple(float absx) {\n    if (absx > 1.0e5) return false;\n    float n = floor(0.5 + 2.0 * dcg_PI_INV * absx);\n    return mod(n, 2.0) == 1.0 && n * dcg_PI == 2.0 * absx;\n  }`].join(`\n`),mD=[\"round\",\"hypot\",\"rtxsqpone\",\"rtxsqmone\"],WL=mD.map(e=>Lm[e].value).join(`\n`)+Object.keys(Lm).filter(e=>mD.indexOf(e)===-1).map(e=>Lm[e].value).join(`\n`),oY=ft`uniform float NaN;\n    uniform float Infinity;\n    float dcg_const_bust = 1.0;\n    #define dcg_PI 3.141592653589793\n    #define dcg_PI_INV 0.3183098861837907\n    ${ZL}\\n`+WL;function ft(e,...t){let r=e[0];for(let n=0;n<t.length;n++)r+=t[n],r+=e[n+1];return jL(r)}function jL(e){let t=e.split(`\n`);if(/^\\s/.test(t[0][0]))throw new Error(\"Programming error: Expected un-indented first line\");if(t.length<=1)return e;let r=Math.min(...t.slice(1).map(n=>n.match(/^\\s*/)[0].length));return t[0]+`\n`+t.slice(1).map(n=>n.slice(r)).join(`\n`)}function pi(e){return`_${e}`}function Ne(e,t){let r=t[e];return r!==void 0?r:pi(e)}function hD(e){return bD(e,!1)}function Oo(e){return bD(e,!0)}function bD(e,t){let r=Am(e),n=[],i=[],s=PD(e,e.argNames.length,e.instructionsLength()-1,r,t),o=0;for(;o<e.instructionsLength();){let a=e.getInstruction(o),{source:u,nextIdx:c}=xD(e,a,o,r,n,i,t);s+=u,o=c}return s+=`return ${Ne(e.getReturnIndex(),n)};`,{source:s,constants:i,shaderFunctions:t?KL(e):{}}}function xD(e,t,r,n,i,s,o){let a=r+1;switch(t.type){case 0:case 47:case 48:case 22:case 49:return{source:\"\",nextIdx:a};case 21:if(o)throw jf();return{source:QL(e,t,r,n,i,s),nextIdx:t.endIndex};case 2:return i[r]=e.argNames[r],{source:\"\",nextIdx:a};case 23:return{source:ew(e,t,r,i,o),nextIdx:a};case 24:return{source:tw(e,t,r,i,o),nextIdx:a};case 19:return{source:rw(e,t,r,i,o),nextIdx:a};case 20:return{source:nw(e,t,r,i),nextIdx:a};default:{let u=iw(e,t,i,s,o);return n[r]<=1?(i[r]=`(${u})`,{source:\"\",nextIdx:a}):{source:`${pi(r)}=${u};\n`,nextIdx:a}}}}function JL(e,t,r,n,i,s){let{endIndex:o}=t,a=!1,u=`function(${pi(r)}) {\n`;u+=PD(e,r+1,o-1,n,a);let c=r+1;for(;c<o;){let p=e.getInstruction(c),{source:f,nextIdx:y}=xD(e,p,c,n,i,s,a);u+=f,c=y}let l=e.getInstruction(o);return u+=`return ${Ne(l.args[1],i)};\n}`,u}function QL(e,t,r,n,i,s){let o=\"BuiltIn.quad(\";o+=JL(e,t,r,n,i,s),o+=`,${Ne(t.args[0],i)},${Ne(t.args[1],i)})`;let{endIndex:a}=t;return n[a+1]<=1?(i[a+1]=o,\"\"):`${pi(a+1)}=${o};`}function KL(e){let t=e.argNames.length,r=e.instructionsLength()-1,n={};for(let i=t;i<=r;i++){let s=e.getInstruction(i);if(s.type===33){if(j(s.valueType)){let o=ED(e,i),a=`${o} dcg_ternary(bool x, ${o} y, ${o} z) { if (x) return y; return z; }`;n[a]=!0}}else if(s.type===37){let o=wm[s.symbol];if((o==null?void 0:o.type)===\"reducer\"){let a=s.args[0],u=lr(e,a);if(u===void 0)throw yu(Mn(e,a));for(let c of o.deps)n[wm[c].value(u)]=!0;n[o.value(u)]=!0}else if((o==null?void 0:o.type)===\"double-reducer\"){let a=s.args[0],u=s.args[1],c=lr(e,a),l=lr(e,u);if(c===void 0)throw yu(Mn(e,a));if(l===void 0)throw yu(Mn(e,u));n[o.value(c,l)]=!0}}}return n}function PD(e,t,r,n,i){let s=\"\",o=!1;for(let a=t;a<=r;a++){let u=e.getInstruction(a);if(!(u.type===0||u.type===24||u.type===20)){if(u.type===21){if(i)throw jf();let{endIndex:c}=u;a=n[c+1]<=1?c+1:c;continue}n[a]<=1&&!jn(u)&&!un(u)&&u.type!==47&&u.type!==48||(i?(o&&(s+=\";\"),s+=ED(e,a)+\" \"+pi(a)):(s+=o?\",\":\"var \",s+=pi(a)),o=!0)}}return o&&(s+=`;\n`),s}function ew(e,t,r,n,i){let s=pi(r),o=e.getInstruction(t.endIndex),a=Ne(t.args[0],n),u=\"\";for(let l=1;l<o.args.length;l++){let p=t.endIndex+l;if(e.getInstruction(p).type!==48)continue;let y=pi(p);i||(u+=`${y}=[];\n`)}return i||(u+=`if(${a}>${1e4}) throw ErrorMsg.maxListSize();\n`),u+=`for(${s}=1${i?\".0\":\"\"};${s}<=${a};${s}++){\n`,u}function tw(e,t,r,n,i){let s=\"\";for(let o=1;o<t.args.length;o++){let a=r+o;if(a>=e.instructionsLength()||e.getInstruction(a).type!==48)continue;let u=pi(r+o),c=Ne(t.args[o],n);if(i){let l=Ne(t.args[0],n);s+=`${u}[int(${l})-1]=${c};\n`}else s+=`${u}.push(${c});\n`}return s+=`}\n`,s}function rw(e,t,r,n,i){let s=pi(r);if(i){let c=e.getInstruction(t.args[0]),l=e.getInstruction(t.args[1]),p=t.callData.type===\"sum\";if(c.type!==1){let h=Mn(e,t.args[0]);throw p?Zf(h):Wf(h)}if(l.type!==1){let h=Mn(e,t.args[1]);throw p?Zf(h):Wf(h)}if(c.valueType!==P||l.valueType!==P)throw new Error(\"Programming error: non-number in summation bounds\");let f=Y(c.value),y=Y(l.value);if(!isFinite(y-f)||y-f>=1e3)throw p?mh():yh()}let o=`${Ne(t.args[0],n)}`,a=`${Ne(t.args[1],n)}`,u=`if(${o}>${a}){\n`;for(let c=2;c<t.args.length;c++){let l=t.endIndex+c-1;if(l>=e.instructionsLength()||e.getInstruction(l).type!==47)continue;let p=pi(l);u+=`${p}=${Ne(t.args[c],n)};\n`}if(!i){u+=`}else if(!isFinite(${a}-${o})){\n`;for(let c=2;c<t.args.length;c++){let l=t.endIndex+c-1;if(l>=e.instructionsLength())continue;let p=e.getInstruction(l);if(p.type!==47)continue;let f=pi(l);u+=`${f}=${CP(qi(p.valueType),i,t.valueType)};\n`}}u+=`}else{\n`;for(let c=2;c<t.args.length;c++){let l=r+c-1;if(e.getInstruction(l).type!==47)continue;let p=pi(l);u+=`${p}=${Ne(t.args[c],n)};\n`}return u+=`for(${s}=${o};${s}<=${a};${s}++){\n`,u}function nw(e,t,r,n){let i=\"\";for(let s=1;s<t.args.length;s++){let o=t.args[0]+s;if(e.getInstruction(o).type!==47)continue;let a=pi(o);i+=`${a}=${Ne(t.args[s],n)};\n`}i+=`}\n`;for(let s=1;s<t.args.length;s++){let o=r+s;if(o>=e.instructionsLength()||e.getInstruction(o).type!==47)continue;let a=pi(o);i+=`${a}=${Ne(t.args[s],n)};\n`}return i+=`}\n`,i}function iw(e,t,r,n,i){switch(t.type){case 1:return i||t.valueType===P||t.valueType===he||t.valueType===N||t.valueType===G?CP(t.value,i,t.valueType):(n.push(ws(t.value)),`_C[${n.length-1}]`);case 8:{let c=Ne(t.args[0],r),l=Ne(t.args[1],r);return i?`dcg_add(${c},${l})`:`${c}+${l}`}case 9:{let c=Ne(t.args[0],r),l=Ne(t.args[1],r);return i?`dcg_sub(${c},${l})`:`${c}-${l}`}case 10:{let c=Ne(t.args[0],r),l=Ne(t.args[1],r);return i?`dcg_mul(${c},${l})`:`${c}*${l}`}case 11:{let c=Ne(t.args[0],r),l=Ne(t.args[1],r);return i?`dcg_div(${c},${l})`:`${c}/${l}`}case 12:return`${i?\"dcg_\":\"BuiltIn.\"}pow(${Ne(t.args[0],r)},${Ne(t.args[1],r)})`;case 13:return`${i?\"dcg_rawpow\":\"Math.pow\"}(${Ne(t.args[0],r)},${Ne(t.args[1],r)})`;case 14:{let c=Ne(t.args[0],r);return i?`dcg_neg(${c})`:`-${c}`}case 25:return Ne(t.args[0],r)+(i?\"==\":\"===\")+Ne(t.args[1],r);case 26:return`${Ne(t.args[0],r)}<${Ne(t.args[1],r)}`;case 27:return`${Ne(t.args[0],r)}>${Ne(t.args[1],r)}`;case 28:return`${Ne(t.args[0],r)}<=${Ne(t.args[1],r)}`;case 29:return`${Ne(t.args[0],r)}>=${Ne(t.args[1],r)}`;case 31:return`${Ne(t.args[0],r)}||${Ne(t.args[1],r)}`;case 32:return`${Ne(t.args[0],r)}&&${Ne(t.args[1],r)}`;case 33:let s=Ne(t.args[0],r),o=Ne(t.args[1],r),a=Ne(t.args[2],r);return i&&j(t.valueType)?`dcg_ternary(${s},${o},${a})`:`${s}?${o}:${a}`;case 15:return(i?\"vec2(\":\"[\")+Ne(t.args[0],r)+\",\"+Ne(t.args[1],r)+(i?\")\":\"]\");case 16:return(i?\"vec3(\":\"[\")+Ne(t.args[0],r)+\",\"+Ne(t.args[1],r)+\",\"+Ne(t.args[2],r)+(i?\")\":\"]\");case 17:case 18:{let c=Ne(t.args[0],r),l=Ne(t.args[1],r);return i?`${c}.${l===\"(1.0)\"?\"x\":l===\"(2.0)\"?\"y\":\"z\"}`:`${c}[${l}-1]`}case 38:return(i?Vm(t.valueType)+`[${t.args.length}](`:\"[\")+t.args.map(c=>Ne(c,r)).join(\",\")+(i?\")\":\"]\");case 40:case 42:case 3:throw new Error(`Programming Error: expect ${Oi(t.type)} to be removed before emitting code.`);case 39:{let c=Ne(t.args[0],r),l=Ne(t.args[1],r),p=i?\"int\":\"Math.floor\",f=i?lr(e,t.args[0]):`${c}.length`;if(f===void 0)throw yu(Mn(e,t.args[0]));let y=t.valueType;return`(${p}(${l})>=1&&${p}(${l})<=${f})?${c}[${p}(${l})-1]:${CP(qi(y),i,y)}`}case 41:{let c=Ne(t.args[0],r),l=Ne(t.args[1],r);return i?`${c}[int(${l})-1]`:`${c}[${l}-1]`}case 37:{let c=t.args.map(l=>Ne(l,r)).join(\",\");if(i){if(!wm[t.symbol])throw Dl(t.symbol);return`dcg_${t.symbol}(${c})`}else{let l=Pr[t.symbol];return`${l.module}.${l.symbol}(${c})`}}case 44:{if(i)throw Dl(\"random\");return`${Ne(t.args[0],r)}+'::${t.tag}'+${Ne(t.args[1],r)}`}case 2:case 0:case 21:case 22:case 19:case 20:case 23:case 24:case 47:case 48:case 49:throw new Error(`Unexpected opcode ${t.type}`);default:let u=t;throw new Error(`Unexpected opcode ${u.type}`)}}function CP(e,t,r){return t?ID(e,r):TD(e)}function TD(e){if(Array.isArray(e))return`[${e.map(TD).join(\",\")}]`;switch(typeof e){case\"boolean\":case\"number\":return e.toString();case\"string\":return`${JSON.stringify(e)}`;case\"object\":if(Mu(e))throw new Error(\"Action values cannot be compiled\");return Y(e).toString();default:throw new Error(\"Unexpected value: \"+e)}}function ID(e,t){if(Array.isArray(e)){if(e.length>100)throw gc();let r=j(t)?`[${e.length}]`:\"\",n=j(t)?$e(t):t,i=\"dcg_const_bust*\"+e.map(s=>ID(s,n)).join(\",\");return Vm(t)+r+\"(\"+i+\")\"}switch(typeof e){case\"boolean\":return e.toString();case\"number\":return Fm(e);case\"string\":throw Dl(\"random\");case\"object\":if(Mu(e))throw new Error(\"Action values cannot be compiled\");return Fm(Y(e));default:throw new Error(\"Unexpected value: \"+e)}}function Fm(e){let t=e.toString();return/^-?\\d+$/.test(t)?t+\".0\":t}function Vm(e){switch(j(e)?$e(e):e){case he:return\"bool\";case P:return\"float\";case N:return\"vec2\";case It:case G:return\"vec3\";default:throw new Error(\"Unexpected type: \"+$n(e))}}function ED(e,t){let r=e.getInstruction(t);if(j(r.valueType)){let n=lr(e,t);if(n===void 0)throw yu(Mn(e,t));if(n>100)throw gc();return`${Vm(r.valueType)}[${n}]`}else return Vm(r.valueType)}function MD(e){let t=[];for(let r=0;r<e.instructionsLength();r++)t.push(!1);t[e.getReturnIndex()]=!0;for(let r=e.instructionsLength()-1;r>=0;r--){if(!t[r]){e.replaceInstructionWithNoop(r);continue}let n=e.getInstruction(r);if(!De(n))for(let i of n.args)t[i]=!0}}function fs(e,t){return e.pushLeafInstruction(t)}function mr(e,t,r){switch(t.type){case 8:return e.Add(r);case 9:return e.Subtract(r);case 10:return e.Multiply(r);case 11:return e.Divide(r);case 12:return e.Exponent(r);case 13:return e.RawExponent(r);case 14:return e.Negative(r);case 25:return e.Equal(r);case 26:return e.Less(r);case 27:return e.Greater(r);case 28:return e.LessEqual(r);case 29:return e.GreaterEqual(r);case 31:return e.Or(r);case 32:return e.And(r);case 33:return e.Piecewise(r);case 47:return e.BlockVar(t.valueType,r);case 48:return e.BroadcastResult(t.valueType,r);case 15:return e.OrderedPair(r);case 16:return e.OrderedTriple(r);case 17:return e.OrderedPairAccess(r);case 18:return e.OrderedTripleAccess(r);case 37:return e.NativeFunction(t.symbol,t.callData,r);case 42:return e.Distribution(t.symbol,r);case 21:return e.BeginIntegral(t.callData,r);case 22:return e.EndIntegral(r);case 23:return e.BeginBroadcast(r);case 24:return e.EndBroadcast(r);case 19:return e.BeginLoop(t.callData,r);case 20:return e.EndLoop(r);case 38:return e.List(r);case 39:return e.ListAccess(r);case 40:return e.DeferredListAccess(r);case 41:return e.InboundsListAccess(r);case 44:return e.ExtendSeed(t.tag,r);case 49:return e.Action(t.symbols,r);default:let n=t;throw new Error(`Unexpected opcode ${n.type}`)}}function DD(e){if(e.instructionsLength()-1!==e.getReturnIndex())throw new Error(\"Programming Error: only the final instruction in a chunk can be converted to broadcast\");let t=e.getInstruction(e.getReturnIndex());if(De(t))return e.getReturnIndex();switch(t.type){case 8:case 9:case 10:case 11:case 12:case 13:case 25:case 26:case 27:case 28:case 29:case 31:case 32:case 15:case 16:case 14:case 33:case 17:case 18:return Bc(e,t);case 42:return Br(e,Bc(e,t));case 37:{let n=Pr[t.symbol];switch(n.tag){case\"default\":case\"trig\":case\"trig2\":case\"inverseTrig\":case\"color\":return Bc(e,t);case\"never-broadcast\":{let i=[],s=!1;for(let o of t.args){let a=Br(e,o);a!==o?(s=!0,i.push(a)):i.push(o)}return s?e.copyInstructionWithArgs(t,i):e.getReturnIndex()}case\"reducer\":if(sw(e,t.args))if(t.args.length===1){let i=t.args[0],s=Br(e,i);return s!==i?e.copyInstructionWithArgs(t,[s]):e.getReturnIndex()}else return Bc(e,t);else return e.getReturnIndex();case\"doubleReducer\":{if(t.args.length!==2)throw new Error(\"Programming error: double reducers must have two arguments\");let i=Br(e,t.args[0]),s=Br(e,t.args[1]);return i!==t.args[0]||s!==t.args[1]?e.copyInstructionWithArgs(t,[i,s]):e.getReturnIndex()}case\"parameterizedReducer\":{if(t.args.length!==2)throw new Error(\"Programming error: double reducers must have two arguments\");let i=Br(e,t.args[0]);return i===t.args[0]?Bc(e,t,[!1,!0]):e.copyInstructionWithArgs(t,[i,t.args[1]])}default:{let i=n.tag;throw new Error(`Programming Error: unexpected tag ${i}`)}}}case 39:case 40:case 41:return Bc(e,t,[!1,!0]);case 21:case 22:case 19:case 20:return e.getReturnIndex();case 38:case 47:case 23:case 24:case 48:case 44:case 49:return e.getReturnIndex();default:let r=t;throw new Error(`Unexpected opcode ${r.type}`)}}function sw(e,t){for(let r of t)if(j(e.getInstruction(r).valueType))return!0;return!1}function Bc(e,t,r){let n=t.args,i=!1,s=[];for(let y=0;y<n.length;y++){if(r&&!r[y])continue;let h=n[y],m=e.getInstruction(h).valueType;j(m)&&s.indexOf(h)===-1&&s.push(h),m===Le&&(i=!0)}if(s.length===0)return e.getReturnIndex();if(t.type===33&&s.indexOf(t.args[0])==-1&&s.indexOf(t.args[1])>=0&&s.indexOf(t.args[2])>=0){let y=Br(e,t.args[1]),h=Br(e,t.args[2]);return y!==t.args[1]||h!==t.args[2]?mr(e,t,[t.args[0],y,h]):e.getReturnIndex()}e.popInstruction();let o=cp(e,s);if(o===void 0)throw new Error(\"Programming Error: expected minListLength to be defined for \"+s.length+\" lists\");let a=o;if(Vt(e.getInstruction(a))&&Zt(e,a)===0&&i)return e.ConstantOfType(Le,[]);let u=e.BeginBroadcast([a]),c=[];for(let y of s)c.push(Ca(e,y,u));let l=[];for(let y=0;y<n.length;y++){let h=n[y];if(r&&!r[y])l.push(h);else{let m=s.indexOf(h);l.push(m===-1?h:c[m])}}let p=e.copyInstructionWithArgs(t,l),f=e.EndBroadcast([u,p]);return e.BroadcastResult(Tn(e.getInstruction(p).valueType),[f])}function Ca(e,t,r){return e.getInstruction(t).type==48?e.DeferredListAccess([t,r]):e.InboundsListAccess([t,r])}function vD(e){let t=[];t.push(\"digraph {\");for(let r=0;r<e.instructionsLength();r++)e.getInstruction(r).type!==0&&t.push(`${r} [label=\"${r}: ${wu(e,r)}\"];`);for(let r=0;r<e.instructionsLength();r++){let n=e.getInstruction(r);if(kM(n))for(let i of n.args)t.push(`${r} -> ${i};`)}return t.push(\"}\"),t.join(`\n`)}function _a(e,t){let r=[];for(let n=0;n<e.instructionsLength();n++)r.push(!1);r[t]=!0;for(let n=0;n<=1;n++){let i=!1;for(let s=t+1;s<e.instructionsLength();s++){let o=e.getInstruction(s);if(De(o)||r[s])continue;let a=!1;for(let u of o.args)if(r[u]){a=!0;break}r[s]=a,a&&un(o)&&!r[o.args[0]]&&(r[o.args[0]]=!0,i=!0)}if(!i)break}return r}function OD(e,t,r){let n=e.argNames.indexOf(t);if(n===-1)return 0;let i=fi(e,n,r);return Ir(i,e.getReturnIndex())}function fi(e,t,{allowRestriction:r,allowClosedBlockReferences:n}){return{chunk:e,argIndex:t,orderTable:[],mask:_a(e,t),allowRestriction:r,allowClosedBlockReferences:n}}function Ir(e,t){let r=e.orderTable[t];if(r!==void 0)return r;let n=ow(e,t);return e.orderTable[t]=n,n}function ow(e,t){let{chunk:r,mask:n,argIndex:i,allowRestriction:s,allowClosedBlockReferences:o}=e;if(!o&&r.isInClosedBlock(t))return 1/0;if(t===i)return 1;let a=r.getInstruction(t);if(jn(a)||un(a))return 1/0;switch(a.type){case 8:case 9:case 26:case 28:case 27:case 29:{let[c,l]=a.args;return Math.max(Ir(e,c),Ir(e,l))}case 10:{let[c,l]=a.args;return Ir(e,c)+Ir(e,l)}case 14:return Ir(e,a.args[0]);case 11:{let[c,l]=a.args;return Ir(e,l)>0?1/0:Ir(e,c)}case 12:case 13:{let[c,l]=a.args,p=r.getInstruction(l);if(Ir(e,c)===0&&Ir(e,l)===0)return 0;if(p.type===1){let f=Y(p.value);return f===Math.round(f)&&f>0?Ir(e,c)*f:1/0}else return 1/0}case 33:{if(!n[t])return 0;let c=r.getInstruction(a.args[2]);return s&&c.type===1&&isNaN(Y(c.value))?Ir(e,a.args[1]):1/0}case 2:case 0:case 1:case 25:case 32:case 31:case 15:case 17:case 16:case 18:case 38:case 39:case 40:case 41:case 37:case 42:case 48:case 47:case 3:case 44:case 49:return n[t]?1/0:0;default:let u=a;throw new Error(`Unexpected opcode ${u.type}`)}}function SD(e,t){let r=e.argNames.indexOf(t),n=ds(fi(e,r,{allowRestriction:!0,allowClosedBlockReferences:!1}));if(Ir(n.orderCtx,e.getReturnIndex())>2)throw new Error(\"Programming Error: cannot compute polynomial coefficients for polynomials of order greater than 2\");let i=wr(n,e.getReturnIndex()),s=!1;for(let o=0;o<e.instructionsLength();o++)e.getInstruction(o).type===33&&n.mask[o]&&(s=!0);return{chunk:n.newChunk,coefficients:i,mappedArgIndex:n.valueMap[r],mappedReturnIndex:n.valueMap[e.getReturnIndex()],isRestrictedPolynomial:s}}function ds(e){let{chunk:t,argIndex:r}=e;if(t.isInClosedBlock(r))throw new Error(\"Programming Error: cannot find polynomial coefficients of an instruction in a closed block\");let n,i;r>=0&&r<t.argNames.length?(n=t.argNames.slice(),i=t.argTypes.slice(),n.splice(r,1),i.splice(r,1)):(n=t.argNames,i=t.argTypes);let s=new So({argNames:n,argTypes:i}),o=[];for(let p=0;p<t.instructionsLength();p++){let f=t.getInstruction(p);if(f.type===2)p<r||r<0?o.push(p):p===r?o.push(s.SymbolicVar(t.argTypes[p])):o.push(p-1);else if(De(f))o.push(fs(s,f));else{let y=[];for(let h of f.args)y.push(o[h]);o.push(mr(s,f,y))}}let a=[],u=s.Constant(0),c=s.Constant(1),l=s.Constant(NaN);return{chunk:t,newChunk:s,orderCtx:e,coefficientTable:a,mask:e.mask,valueMap:o,argIndex:r,zero:u,one:c,nan:l}}function wr(e,t){let{newChunk:r,orderCtx:n,coefficientTable:i,mask:s,valueMap:o,argIndex:a,zero:u,one:c,nan:l}=e,p=i[t];if(p!==void 0)return p;let f;for(s[t]?t===a?f=[u,c]:Ir(n,t)>2?f=[l]:f=aw(e,t):f=[o[t]];f.length>1;){let y=r.getInstruction(f[f.length-1]);if(y.type===1&&Y(y.value)===0)f.pop();else break}if(f.length===0)throw new Error(\"Programming Error: coefficients cannot be empty\");return i[t]=f,f}function aw(e,t){let r=e.chunk.getInstruction(t),{newChunk:n}=e;switch(r.type){case 8:{let[s,o]=r.args,a=wr(e,s),u=wr(e,o),c=a.length-1,l=u.length-1,p=[];for(let f=0;f<=Math.max(c,l);f++)c>=f&&l>=f?p.push(n.Add([a[f],u[f]])):p.push(c>l?a[f]:u[f]);return p}case 9:case 26:case 28:case 27:case 29:{let[s,o]=r.args;(r.type===26||r.type==28)&&([s,o]=[o,s]);let a=wr(e,s),u=wr(e,o),c=a.length-1,l=u.length-1,p=[];for(let f=0;f<=Math.max(c,l);f++)c>=f&&l>=f?p.push(n.Subtract([a[f],u[f]])):p.push(c>l?a[f]:n.Negative([u[f]]));return p}case 14:{let s=r.args[0],o=wr(e,s),a=[];for(let u=0;u<o.length;u++)a.push(n.Negative([o[u]]));return a}case 10:{let[s,o]=r.args,a=wr(e,s),u=wr(e,o),c=a.length-1,l=u.length-1,p=[];for(let f=0;f<=c;f++)for(let y=0;y<=l;y++){if(f+y>2)continue;let h=n.Multiply([a[f],u[y]]),m=p[f+y];m===void 0?p[f+y]=h:p[f+y]=n.Add([m,h])}return p}case 11:{let[s,o]=r.args,a=wr(e,s),u=wr(e,o),c=[];for(let l=0;l<a.length;l++)c.push(n.Divide([a[l],u[0]]));return c}case 12:case 13:{let[s,o]=r.args,a=wr(e,s),u=wr(e,o);if(a.length-1===0)return[n.RawExponent([a[0],u[0]])];let l=n.getInstruction(u[0]);switch(Y(l.value)){case 0:return[n.Constant(0)];case 1:return a;case 2:return[n.Multiply([a[0],a[0]]),n.Multiply([n.Constant(2),n.Multiply([a[0],a[1]])]),n.Multiply([a[1],a[1]])]}}case 33:return wr(e,r.args[1]);case 0:case 23:case 2:case 1:case 25:case 32:case 31:case 15:case 17:case 16:case 18:case 38:case 39:case 40:case 41:case 37:case 42:case 21:case 22:case 19:case 20:case 24:case 48:case 47:case 3:case 44:case 49:throw new Error(`Cannot find polynomial coefficients of opcode ${r.type} that depends on symbol.`);default:let i=r;throw new Error(`Unexpected opcode ${i.type}`)}}function RD(e){if(e.instructionsLength()-1!==e.getReturnIndex())throw new Error(\"Programming Error: only the final instruction in a chunk can be converted to broadcast\");let t=e.getInstruction(e.getReturnIndex());if(De(t))return e.getReturnIndex();switch(t.type){case 8:if(La(e,t.args[0])&&La(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2);return e.OrderedPair([e.Add([e.OrderedPairAccess([t.args[0],n]),e.OrderedPairAccess([t.args[1],n])]),e.Add([e.OrderedPairAccess([t.args[0],i]),e.OrderedPairAccess([t.args[1],i])])])}else if(wa(e,t.args[0])&&wa(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2),s=e.Constant(3);return e.OrderedTriple([e.Add([e.OrderedTripleAccess([t.args[0],n]),e.OrderedTripleAccess([t.args[1],n])]),e.Add([e.OrderedTripleAccess([t.args[0],i]),e.OrderedTripleAccess([t.args[1],i])]),e.Add([e.OrderedTripleAccess([t.args[0],s]),e.OrderedTripleAccess([t.args[1],s])])])}else return sa(e,t.args)?Fa(e,[e.Add([Vn(e,t.args[0]),Vn(e,t.args[1])]),Us(e,t.args[0])]):e.getReturnIndex();case 9:if(La(e,t.args[0])&&La(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2);return e.OrderedPair([e.Subtract([e.OrderedPairAccess([t.args[0],n]),e.OrderedPairAccess([t.args[1],n])]),e.Subtract([e.OrderedPairAccess([t.args[0],i]),e.OrderedPairAccess([t.args[1],i])])])}else if(wa(e,t.args[0])&&wa(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2),s=e.Constant(3);return e.OrderedTriple([e.Subtract([e.OrderedTripleAccess([t.args[0],n]),e.OrderedTripleAccess([t.args[1],n])]),e.Subtract([e.OrderedTripleAccess([t.args[0],i]),e.OrderedTripleAccess([t.args[1],i])]),e.Subtract([e.OrderedTripleAccess([t.args[0],s]),e.OrderedTripleAccess([t.args[1],s])])])}else return sa(e,t.args)?Fa(e,[e.Subtract([Vn(e,t.args[0]),Vn(e,t.args[1])]),Us(e,t.args[0])]):e.getReturnIndex();case 14:if(La(e,t.args[0])){let n=e.Constant(1),i=e.Constant(2);return e.OrderedPair([e.Negative([e.OrderedPairAccess([t.args[0],n])]),e.Negative([e.OrderedPairAccess([t.args[0],i])])])}else if(wa(e,t.args[0])){let n=e.Constant(1),i=e.Constant(2),s=e.Constant(3);return e.OrderedTriple([e.Negative([e.OrderedTripleAccess([t.args[0],n])]),e.Negative([e.OrderedTripleAccess([t.args[0],i])]),e.Negative([e.OrderedTripleAccess([t.args[0],s])])])}else return sa(e,t.args)?Fa(e,[e.Negative([Vn(e,t.args[0])]),Us(e,t.args[0])]):e.getReturnIndex();case 10:if(La(e,t.args[0])&&ia(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2);return e.OrderedPair([e.Multiply([e.OrderedPairAccess([t.args[0],n]),t.args[1]]),e.Multiply([e.OrderedPairAccess([t.args[0],i]),t.args[1]])])}else if(ia(e,t.args[0])&&La(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2);return e.OrderedPair([e.Multiply([t.args[0],e.OrderedPairAccess([t.args[1],n])]),e.Multiply([t.args[0],e.OrderedPairAccess([t.args[1],i])])])}else{if(sa(e,[t.args[0]])&&ia(e,t.args[1]))return Fa(e,[e.Multiply([Vn(e,t.args[0]),t.args[1]]),Us(e,t.args[0])]);if(ia(e,t.args[0])&&sa(e,[t.args[1]]))return Fa(e,[e.Multiply([t.args[0],Vn(e,t.args[1])]),Us(e,t.args[1])]);if(wa(e,t.args[0])&&ia(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2),s=e.Constant(3);return e.OrderedTriple([e.Multiply([e.OrderedTripleAccess([t.args[0],n]),t.args[1]]),e.Multiply([e.OrderedTripleAccess([t.args[0],i]),t.args[1]]),e.Multiply([e.OrderedTripleAccess([t.args[0],s]),t.args[1]])])}else if(ia(e,t.args[0])&&wa(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2),s=e.Constant(3);return e.OrderedTriple([e.Multiply([t.args[0],e.OrderedTripleAccess([t.args[1],n])]),e.Multiply([t.args[0],e.OrderedTripleAccess([t.args[1],i])]),e.Multiply([t.args[0],e.OrderedTripleAccess([t.args[1],s])])])}else return e.getReturnIndex()}case 11:if(La(e,t.args[0])&&ia(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2);return e.OrderedPair([e.Divide([e.OrderedPairAccess([t.args[0],n]),t.args[1]]),e.Divide([e.OrderedPairAccess([t.args[0],i]),t.args[1]])])}else{if(sa(e,[t.args[0]])&&ia(e,t.args[1]))return Fa(e,[e.Divide([Vn(e,t.args[0]),t.args[1]]),Us(e,t.args[0])]);if(wa(e,t.args[0])&&ia(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2),s=e.Constant(3);return e.OrderedTriple([e.Divide([e.OrderedTripleAccess([t.args[0],n]),t.args[1]]),e.Divide([e.OrderedTripleAccess([t.args[0],i]),t.args[1]]),e.Divide([e.OrderedTripleAccess([t.args[0],s]),t.args[1]])])}else return e.getReturnIndex()}case 12:case 13:case 25:case 26:case 27:case 28:case 29:case 32:case 31:case 15:case 16:case 33:case 17:case 18:case 37:case 42:case 39:case 40:case 41:case 21:case 22:case 19:case 20:case 38:case 47:case 23:case 24:case 48:case 44:case 49:return e.getReturnIndex();default:let r=t;throw new Error(`Unexpected opcode ${r.type}`)}}function La(e,t){return e.getInstruction(t).valueType===N}function wa(e,t){return e.getInstruction(t).valueType===G}function ia(e,t){return e.getInstruction(t).valueType===P}function sa(e,t){return t.every(r=>Ye(e,r,ge))||t.every(r=>Ye(e,r,Re))}function Fa(e,t){return Bu(e,t,\"mathVector\",fp(\"mathVector\",\"mathVectorThreeD\"))}function Us(e,t){return Bu(e,[t],\"start\",[{match:[ge],build:()=>e.SyntheticNativeFunction(\"basePointFromVector\",[t])},{match:[Re],build:()=>e.SyntheticNativeFunction(\"basePointFromVectorThreeD\",[t])}])}function Vn(e,t){return Bu(e,[t],\"displacement\",[{match:[ge],build:()=>e.SyntheticNativeFunction(\"vectorDisplacementAsPoint\",[t])},{match:[Re],build:()=>e.SyntheticNativeFunction(\"vectorThreeDDisplacementAsPoint\",[t])}])}function fp(e,t){return[{match:[N,N],build:(r,n)=>r.SyntheticNativeFunction(e,n)},{match:[G,G],build:(r,n)=>r.SyntheticNativeFunction(t,n)}]}var uw=[\"Sum\",\"Product\",\"Integral\",\"List\",\"Derivative\",\"Piecewise\",\"Exponent\",\"PercentOf\",\"FunctionDefinition\",\"UpdateRule\",\"Substitution\"],_P={isGeometryEnabled(){return!1},is3dProduct(){return!1},is3dPolicy(){return!1},isBeta3d(){return!1},areAllScalesLinear(){return!0},assignmentForbidden(e){return!0},substitutionForbidden(e){return!0},graphingEnabled(){return!1},isValidSlider(e){return!1},sliderVariables(e){return[]},ansEnabled(){return!1},disabledFeatures(){return uw},dimensionVarsEnabled(){return!1}},ND=ee(W({},_P),{isGeometryEnabled(){return!0},is3dProduct(){return!0},is3dPolicy(){return!0},isBeta3d(){return!0}});function AD(e){return 48<=e&&e<=57}function cw(e){return 97<=e&&e<=122}function lw(e){return 65<=e&&e<=90}function Bm(e){return cw(e)||lw(e)}function Gm(e){return e===92}function LP(e){return e===39}function CD(e){if(9<=e&&e<=13||8192<=e&&e<=8202)return!0;switch(e){case 32:case 160:case 5760:case 8232:case 8233:case 8239:case 8287:case 12288:case 65279:return!0;default:return!1}}function Ba(e,t){return Pn(e.token.span,t.prevSpan)}function Va(e,t,r){return{type:e,span:t,val:r}}function pw(e,t,r,n){return{input:e,prevSpan:t,pos:r,token:n}}function _D(e){return LD(e,0,vs(e,0))}function LD(e,t,r){for(;CD(e.charCodeAt(t));)t+=1;let n=mw(e,t);return pw(e,r,t,n)}function ks(e){return LD(e.input,e.token.span.end,e.token.span)}function di(e){return e.token}function Ro(e,t){if(di(e).type!==t)throw`Parse Error: expected ${t}.`;return ks(e)}function wD(e,t){return di(e).type===t}function zm(e){return e.pos>=e.input.length}var fw={\"\\\\left\":\"Left\",\"\\\\right\":\"Right\",\"\\\\sqrt\":\"Sqrt\",\"\\\\frac\":\"Frac\",\"\\\\operatorname\":\"OperatorName\",\"\\\\token\":\"Token\"},dw={\"[\":\"[\",\"]\":\"]\",\"{\":\"{\",\"}\":\"}\",\"^\":\"^\",_:\"_\"};function mw(e,t){let r=t;if(t>=e.length)return Va(\"End\",vs(e,t),\"\");let n=e.charCodeAt(t);if(AD(n)){let i=Xn(e,r,t+1);return Va(\"Digit\",i,e.charAt(r))}else if(Bm(n)){let i=Xn(e,r,t+1);return Va(\"Letter\",i,e.charAt(r))}else if(Gm(n))if(t+=1,Bm(e.charCodeAt(t))){for(;Bm(e.charCodeAt(t));)t+=1;let i=Xn(e,r,t),s=Gr(i),o=fw[s]||\"Cmd\";return Va(o,i,s)}else{t+=1;let i=Xn(e,r,t),s=Gr(i);return Va(\"EscapedSymbol\",i,s)}else if(LP(n)){for(t+=1;LP(e.charCodeAt(t));)t+=1;if(e.charAt(t)===\"^\"){t+=1;let i=Xn(e,r,t),s=Gr(i);return Va(\"Primes^\",i,s)}else{let i=Xn(e,r,t),s=Gr(i);return Va(\"Primes\",i,s)}}else{let i=Xn(e,r,t+1),s=e.charAt(r),o=dw[s]||\"Symbol\";return Va(o,i,s)}}function wP(e,t){return{type:\"Group\",span:e,args:t}}function FD(e,t,r){return{type:\"Sqrt\",span:e,optArg:t,arg:r}}function VD(e,t,r){return{type:\"Frac\",span:e,num:t,den:r}}function BD(e,t,r,n){return{type:\"SupSub\",span:e,sup:t,sub:r,nprimes:n}}function GD(e,t,r,n){return{type:\"LeftRight\",span:e,left:t,right:r,arg:n}}function zD(e,t){return{type:\"OperatorName\",span:e,arg:t}}function HD(e,t){return{type:\"TokenNode\",span:e,arg:t}}function UD(e,t){return{type:\"Symbol\",span:e,val:t}}function kD(e){switch(e){case\"Frac\":return 2;case\"^\":case\"_\":case\"Primes^\":case\"Left\":case\"Sqrt\":case\"OperatorName\":case\"Token\":return 1;default:return 0}}function qD(e){let{state:t,tree:r}=Hm(_D(e),!1);if(!zm(t))throw`Parse error: unexpected ${Gr(di(t).span)}.`;return r}function ms(e,t){return{state:e,tree:t}}function Hm(e,t){let r=e,n=[];e:for(;!zm(e);){let s=di(e);switch(s.type){case\"Cmd\":case\"EscapedSymbol\":case\"Letter\":case\"Digit\":case\"Symbol\":case\"[\":case\"{\":case\"^\":case\"_\":case\"Primes\":case\"Primes^\":case\"Left\":case\"Frac\":case\"Sqrt\":case\"OperatorName\":case\"Token\":case\"]\":{if(s.type===\"]\"&&t)break e;let a;if({state:e,tree:a}=YD(e),a.type===\"Group\")for(let u of a.args)n.push(u);else n.push(a);break}case\"}\":case\"Right\":case\"End\":break e;default:throw`Unexpected token type ${s.type}.`}}let i=Ba(r,e);return ms(e,wP(i,n))}function YD(e){let t=di(e);switch(t.type){case\"Cmd\":case\"EscapedSymbol\":case\"Letter\":case\"Digit\":case\"Symbol\":return e=ks(e),ms(e,t);case\"[\":case\"]\":return e=ks(e),ms(e,UD(t.span,t.val));case\"{\":{e=ks(e);let n;return{state:e,tree:n}=Hm(e,!1),e=Ro(e,\"}\"),ms(e,n)}case\"^\":case\"_\":case\"Primes\":case\"Primes^\":return Tw(e);case\"Left\":return Pw(e);case\"Frac\":return xw(e);case\"Sqrt\":return bw(e);case\"OperatorName\":return gw(e);case\"Token\":return hw(e);case\"}\":case\"Right\":throw`Parse Error: unexpected ${t.val}.`;case\"End\":throw\"Parse Error: unexpected end.\";default:throw`Unexpected token type ${t.type}.`}}function gw(e){let t=e,r=di(e);e=Ro(e,\"OperatorName\");let n;({state:e,tree:n}=Ga(e,r));let i=Ba(t,e);return ms(e,zD(i,n))}function hw(e){let t=e,r=di(e);e=Ro(e,\"Token\");let n;({state:e,tree:n}=Ga(e,r));let i=Ba(t,e);return ms(e,HD(i,n))}function bw(e){let t=e,r=di(e);e=Ro(e,\"Sqrt\");let n;wD(e,\"[\")&&({state:e,tree:n}=Iw(e));let i;({state:e,tree:i}=Ga(e,r));let s=Ba(t,e);return ms(e,FD(s,n,i))}function xw(e){let t=e,r=di(e);e=Ro(e,\"Frac\");let n;({state:e,tree:n}=Ga(e,r));let i;({state:e,tree:i}=Ga(e,r));let s=Ba(t,e);return ms(e,VD(s,n,i))}function Pw(e){let t=e;e=Ro(e,\"Left\");let r=di(e);e=ks(e);let n;({state:e,tree:n}=Hm(e,!1)),e=Ro(e,\"Right\");let i=di(e);e=ks(e);let s=Ba(t,e);return ms(e,GD(s,r,i,n))}function Tw(e){let t=e,r,n,i=0;e:for(;!zm(e);){let o=di(e);switch(o.type){case\"^\":if(e=ks(e),r)throw\"Parse Error: double superscript.\";({state:e,tree:r}=Ga(e,o));break;case\"_\":if(e=ks(e),n)throw\"Parse Error: double subscript.\";({state:e,tree:n}=Ga(e,o));break;case\"Primes\":if(e=ks(e),i>0)throw\"Parse Error: double primes.\";i=o.val.length;break;case\"Primes^\":if(e=ks(e),i>0)throw\"Parse Error: double primes.\";if(r)throw\"Parse Error: double superscript\";i=o.val.length-1,{state:e,tree:r}=Ga(e,o);break;default:break e}}let s=Ba(t,e);return ms(e,BD(s,r,n,i))}function Ga(e,t){let r=kD(t.type),n;if(r<=0)throw new Error(\"Programming Error: greediness must be greater than 0.\");let i=kD(di(e).type);if(i>0&&i<=r){let s=Gr(t.span);throw`Parse Error: can't use ${Gr(di(e).span)} as argument of ${s}. Use {}.`}return{state:e,tree:n}=YD(e),n.type!==\"Group\"&&(n=wP(n.span,[n])),ms(e,n)}function Iw(e){e=Ro(e,\"[\");let t;return{state:e,tree:t}=Hm(e,!0),e=Ro(e,\"]\"),ms(e,t)}var Ew={mcd:\"gcd\",gcf:\"gcd\",mcm:\"lcm\",signum:\"sign\",sgn:\"sign\",stdDevP:\"stdevp\",stddevp:\"stdevp\",stdDev:\"stdev\",stddev:\"stdev\",variance:\"var\",TTest:\"ttest\",TScore:\"tscore\",IndependentTTest:\"ittest\",iTTest:\"ittest\",inverseCdf:\"quantile\",inversecdf:\"quantile\",arsinh:\"arcsinh\",arcosh:\"arccosh\",artanh:\"arctanh\",arcsch:\"arccsch\",arsech:\"arcsech\",arcoth:\"arccoth\"};function XD(e){let t=0;for(;Gm(e.charCodeAt(t));)t+=1;return t>0&&(e=e.slice(t)),Ew[e]||e}function $D(e,t){return{type:\"Equals\",span:e,args:t}}function dp(e,t,r){return{type:\"Inequality\",span:e,symbol:t,args:r}}function ZD(e,t,r){return{type:\"TrailingInequalityPiece\",span:e,symbol:t,args:r}}function WD(e,t,r){return{type:\"InequalityChain\",span:e,first:t,chain:r}}function jD(e,t){return{type:\"Tilde\",span:e,args:t}}function JD(e,t){return{type:\"Pos\",span:e,args:t}}function QD(e,t){return{type:\"Neg\",span:e,args:t}}function KD(e,t){return{type:\"Add\",span:e,args:t}}function e1(e,t){return{type:\"Sub\",span:e,args:t}}function t1(e,t){return{type:\"Mul\",span:e,args:t}}function r1(e,t){return{type:\"DotMul\",span:e,args:t}}function n1(e,t){return{type:\"CrossMul\",span:e,args:t}}function i1(e,t){return{type:\"Div\",span:e,args:t}}function s1(e,t){return{type:\"Bang\",span:e,args:t}}function mp(e,t){return{type:\"Call\",span:e,args:t}}function FP(e,t){return{type:\"ImplicitCall\",span:e,args:t}}function o1(e,t){return{type:\"Index\",span:e,args:t}}function VP(e,t){return{type:\"Paren\",span:e,args:t}}function BP(e,t){return{type:\"List\",span:e,args:t}}function a1(e,t){return{type:\"Pipes\",span:e,args:t}}function GP(e,t){return{type:\"Subscript\",span:e,args:t}}function Um(e,t){return{type:\"Superscript\",span:e,args:t}}function yp(e,t,r){return{type:\"Prime\",span:e,nprimes:t,args:r}}function km(e,t){return{type:\"Seq\",span:e,args:t}}function u1(e,t){return{type:\"Sqrt\",span:e,args:t}}function c1(e,t){return{type:\"Nthroot\",span:e,args:t}}function l1(e,t){return{type:\"Frac\",span:e,args:t}}function p1(e,t){return{type:\"Derivative\",span:e,args:t}}function f1(e,t){return{type:\"Integral\",span:e,args:t}}function d1(e,t){return{type:\"EmptyIntegral\",span:e,args:t}}function m1(e,t){return{type:\"Sum\",span:e,args:t}}function y1(e,t){return{type:\"Product\",span:e,args:t}}function g1(e,t){return{type:\"Piecewise\",span:e,args:t}}function h1(e){return{type:\"EmptyPiecewise\",span:e}}function b1(e){return{type:\"EmptyRangeEnd\",span:e}}function x1(e,t){return{type:\"Colon\",span:e,args:t}}function zP(e,t){return{type:\"Ellipsis\",span:e,args:t}}function P1(e,t){return{type:\"For\",span:e,args:t}}function T1(e,t){return{type:\"With\",span:e,args:t}}function I1(e,t){return{type:\"Dot\",span:e,args:t}}function E1(e,t){return{type:\"PercentOf\",span:e,args:t}}function M1(e,t){return{type:\"RightArrow\",span:e,args:t}}function HP(e,t){return{type:\"Juxt\",span:e,args:t}}function D1(e,t){return{type:\"Letter\",span:e,val:t}}function qm(e,t){return{type:\"Decimal\",span:e,val:t}}function Gu(e,t){return{type:\"Cmd\",span:e,val:XD(t)}}function v1(e,t){return{type:\"Alphanumeric\",span:e,val:t}}function O1(e,t,r,n){return{type:\"MixedNumber\",span:e,whole:t,num:r,den:n}}function ln(e){if(e.type===\"Subscript\"){if(e.args[1].type!==\"Alphanumeric\")return!1;e=e.args[0]}switch(e.type){case\"Cmd\":return!0;case\"Letter\":return!0;default:return!1}}function S1(e){return e.type!==\"Superscript\"?!1:ln(e.args[0])}function R1(e,t){if(e.type!==\"Letter\"||e.val!==\"d\"||t.type!==\"Juxt\")return!1;let[r,n]=t.args;return r.type!==\"Letter\"||r.val!==\"d\"?!1:ln(n)}function pn(e){return e.type===\"Seq\"?e.args:[e]}function Pe(e,t){return{type:\"Err\",span:e,error:t}}function UP(){return{type:\"UnexpectedParseError\"}}function N1(){return{type:\"EmptyInput\"}}function A1(){return{type:\"EmptyGroup\"}}function kP(){return{type:\"EmptySubscript\"}}function C1(){return{type:\"EmptySuperscript\"}}function qP(){return{type:\"EmptyRadical\"}}function _1(){return{type:\"EmptySquareBracket\"}}function L1(){return{type:\"EmptyPipe\"}}function w1(){return{type:\"EmptyRadicalIndex\"}}function YP(){return{type:\"UnexpectedEnd\"}}function za(e){return{type:\"BinaryOperatorMissingRight\",val:e}}function F1(e){return{type:\"BinaryOperatorMissingLeft\",val:e}}function XP(e){return{type:\"UnaryOperatorMissingRight\",val:e}}function $P(e){return{type:\"UnaryOperatorMissingLeft\",val:e}}function V1(e,t){return{type:\"MissingCloseDelimiter\",open:e,close:t}}function gp(e,t){return{type:\"UnexpectedCloseDelimiter\",open:e,close:t}}function B1(){return{type:\"UnexpectedDifferential\"}}function G1(e){return{type:\"UnrecognizedSymbol\",val:e}}function z1(e){return{type:\"InvalidSubscript\",val:e}}function H1(e){return{type:\"UnexpectedSubscript\",base:e}}function ZP(e){return{type:\"FunctionMissingArgument\",val:e}}function U1(){return{type:\"PercentMissingOf\"}}function WP(){return{type:\"PrimeWithoutParen\"}}function k1(){return{type:\"SuperscriptWithPrime\"}}function Ym(){return{type:\"UnexpectedPrime\"}}function q1(){return{type:\"SumMissingBound\"}}function Y1(){return{type:\"ProductMissingBound\"}}function jP(){return{type:\"MissingBound\"}}function X1(){return{type:\"IntegralMissingBound\"}}function $1(){return{type:\"SumMissingBody\"}}function Z1(){return{type:\"ProductMissingBody\"}}function W1(){return{type:\"IntegralMissingBody\"}}function j1(){return{type:\"DerivativeMissingBody\"}}function J1(){return{type:\"IntegralMissingDifferential\"}}function Q1(){return{type:\"DifferentialWithSuperscript\"}}function K1(){return{type:\"FractionMissingNumerator\"}}function ev(){return{type:\"FractionMissingDenominator\"}}function tv(){return{type:\"FractionEmpty\"}}function JP(e){return{type:\"AdjacentNumbers\",args:e}}function rv(){return{type:\"UnexpectedFor\"}}function nv(){return{type:\"TokenWithSubscript\"}}var vw={\"+\":!0,\"-\":!0,\"*\":!0,\"\\\\cdot\":!0,\"\\\\times\":!0,\"/\":!0,\"!\":!0,\"(\":!0,\")\":!0,\"\\\\{\":!0,\"\\\\}\":!0,\"(|\":!0,\"|)\":!0,\"[\":!0,\"]\":!0,\",\":!0,\"...\":!0,\":\":!0,\"=\":!0,\">\":!0,\"<\":!0,\">=\":!0,\"<=\":!0,\"->\":!0,\"~\":!0,\"%\":!0,\".\":!0,for:!0,with:!0,Letter:!0,Decimal:!0,Cmd:!0,TokenNode:!0,Differential:!0,End:!0,Trig:!0,Ln:!0,Log:!0,Int:!0,Sum:!0,Prod:!0,Err:!0},Ha={\"\\\\lt\":\"<\",\"\\\\gt\":\">\",\"\\\\le\":\"<=\",\"\\\\ge\":\">=\",\"\\\\leq\":\"<=\",\"\\\\geq\":\">=\",\"\\\\ldots\":\"...\",\"\\\\sim\":\"~\",\"\\\\to\":\"->\",\"\\\\cdot\":\"\\\\cdot\",\"\\\\times\":\"\\\\times\",\"\\\\div\":\"/\",\"\\\\ln\":\"Ln\",\"\\\\log\":\"Log\",\"\\\\int\":\"Int\",\"\\\\sum\":\"Sum\",\"\\\\prod\":\"Prod\",\"\\\\backslash\":\"Err\",\"\\\\for\":\"for\",\"\\\\with\":\"with\"},Ow=[\"sin\",\"cos\",\"tan\",\"cot\",\"sec\",\"csc\"];for(let e of Ow)Ha[\"\\\\\"+e]=\"Trig\",Ha[\"\\\\\"+e+\"h\"]=\"Trig\",Ha[\"\\\\arc\"+e]=\"Trig\",Ha[\"\\\\arc\"+e+\"h\"]=\"Trig\",Ha[\"\\\\ar\"+e+\"h\"]=\"Trig\";var QP={\"+\":\"+\",\"-\":\"-\",\"*\":\"*\",\"/\":\"/\",\"!\":\"!\",\"(\":\"(\",\")\":\")\",\"[\":\"[\",\"]\":\"]\",\",\":\",\",\"...\":\"...\",\":\":\":\",\"=\":\"=\",\">=\":\">=\",\"<=\":\"<=\",\">\":\">\",\"<\":\"<\",\"~\":\"~\",\".\":\".\"},iv={\"\\\\{\":\"\\\\{\",\"\\\\}\":\"\\\\}\",\"\\\\%\":\"%\"},sv={\"|\":\"(|\",\"\\\\{\":\"\\\\{\",\"[\":\"[\",\"(\":\"(\"},ov={\"|\":\"|)\",\"\\\\}\":\"\\\\}\",\"]\":\"]\",\")\":\")\"},av=Object.keys(vw);function uv(e,t,r,n,i,s,o,a){return{opts:e,input:t,prevSpan:r,startIndex:n,endIndex:i,token:s,mode:o,parent:a}}function oe(e,t){return Pn(e.token.span,t.prevSpan)}function Dr(e,t){return Pn(e,t.prevSpan)}function eT(e){return vs(e.token.span.input,e.token.span.start)}function Sw(e,t){return{type:\"Differential\",span:e,val:t}}function Bn(e,t,r){return{type:e,span:t,val:r}}function oa(e,t){let r=vs(e.span.input,e.span.start);return tT(t,e,0,r,void 0,void 0)}function tT(e,t,r,n,i,s){let o=t.args;if(r>o.length&&s)return cv(s,n);r=hp(o,r);let{token:a,endIndex:u}=lv(t,r,i);if(a.type===\"End\"&&s){let c=s.input.args[s.startIndex];if(c.type===\"LeftRight\"){let l=c.right,p=ov[l.val]||\"Err\",f=Bn(p,l.span,l.val);return uv(e,t,n,r,u,f,i,s)}}else a.type===\"Int\"?i=Rw(i):a.type===\"Differential\"&&(i=Nw(i));return uv(e,t,n,r,u,a,i,s)}function Se(e){let t=e.input.args[e.startIndex],r=e.token.span;return t&&t.type===\"LeftRight\"?tT(e.opts,t.arg,0,r,e.mode,e):cv(e,r)}function cv(e,t){let{input:r,endIndex:n,mode:i,parent:s}=e;return tT(e.opts,r,n+1,t,i,s)}function fn(e){return e.token}function Rw(e){return{type:\"integral\",parent:e}}function Nw(e){if(!e||e.type!==\"integral\")throw new Error(\"Programming Error: expected lexer to be in integral mode.\");return e.parent}function dn(e,t){return fn(e).type===t}function Zm(e){return e.startIndex>=e.input.args.length}function rT(e,t){return t.token.span.start>e.token.span.start}function Yr(e,t){return{token:t,endIndex:e}}function lv(e,t,r){let n=e.args;if(t>=n.length){let o=vs(e.span.input,e.span.end);return Yr(t,Bn(\"End\",o,\"\"))}let i=e.args[t];switch(i.type){case\"Sqrt\":case\"Frac\":case\"SupSub\":return Yr(t,i);case\"Letter\":{if(!r||r.type!==\"integral\"||i.val!=\"d\")return Yr(t,i);let{endIndex:l,token:p}=lv(e,t+1,r);if(p.type===\"Letter\"||p.type===\"Cmd\"){let f=Sw(Pn(i.span,p.span),p.val);return Yr(l,f)}else return Yr(t,i)}case\"LeftRight\":{let l=i.left,p=sv[l.val]||\"Err\";var s=Pn(i.span,l.span);return Yr(t,Bn(p,s,l.val))}case\"OperatorName\":let o=[];for(let l of i.arg.args){if(l.type!==\"Letter\")return Yr(t,Bn(\"Err\",i.span,Gr(i.arg.span)));o.push(l.val)}let a=\"\\\\\"+o.join(\"\"),u=Ha[a]||\"Cmd\";return Yr(t,Bn(u,i.span,a));case\"TokenNode\":{let l=\"$\";if(i.arg.args.length===0)return Yr(t,Bn(\"Err\",i.span,Gr(i.arg.span)));for(let p of i.arg.args){if(p.type!==\"Digit\")return Yr(t,Bn(\"Err\",i.span,Gr(i.arg.span)));l+=p.val}return Yr(t,Bn(\"TokenNode\",i.span,l))}case\"Cmd\":{let l=Ha[i.val]||\"Cmd\";return Yr(t,Bn(l,i.span,i.val))}case\"EscapedSymbol\":{let l=iv[i.val]||\"Err\";return Yr(t,Bn(l,i.span,i.val))}case\"Symbol\":return Aw(e,t,i);case\"Digit\":return pv(e,t);default:throw`Unexpected atom ${i.type}.`}}function Aw(e,t,r){switch(r.val){case\".\":return Cw(e,t);case\"-\":{let i=e.args[t+1];if(i&&Xm(i,\">\")){let s=Bn(\"->\",Pn(r.span,i.span),\"->\");return Yr(t+1,s)}break}case\"<\":{let i=e.args[t+1];if(i&&Xm(i,\"=\")){let s=Bn(\"<=\",Pn(r.span,i.span),\"<=\");return Yr(t+1,s)}break}case\">\":{let i=e.args[t+1];if(i&&Xm(i,\"=\")){let s=Bn(\">=\",Pn(r.span,i.span),\">=\");return Yr(t+1,s)}break}}let n=QP[r.val]||\"Err\";return Yr(t,Bn(n,r.span,r.val))}function Cw(e,t){let r=e.args[t];if(r.type!==\"Symbol\"||r.val!==\".\")throw new Error(\"Programming Error: expected '.'\");if(t+2<e.args.length&&$m(e.args[t+1])&&$m(e.args[t+2])){let s=Pn(r.span,e.args[t+2].span);return Yr(t+2,Bn(\"...\",s,Gr(s)))}let n=hp(e.args,t+1);if(n<e.args.length&&e.args[n].type===\"Digit\")return pv(e,t);let i=QP[r.val]||\"Err\";return Yr(t,Bn(i,r.span,r.val))}function pv(e,t){let r=_w(e,t);if(r)return r;let n=e.args,i=e.args[t].span,s=[],o=!1,a=!1;for(;t<n.length;t++){let c=hp(n,t);if(c>=n.length)break;let l=n[c];if(l.type===\"Digit\")t=c,o=!0,s.push(l.val);else if(!a&&$m(l)){if(c+1<n.length&&$m(e.args[c+1]))break;t=c,a=!0,s.push(\".\")}else break}if(!o)throw new Error(\"Programming Error: decimals must have at least one digit.\");let u=Pn(i,e.args[t-1].span);return Yr(t-1,Bn(\"Decimal\",u,s.join(\"\")))}function _w(e,t){let r=e.args,n=r[t].span,i=[];for(;t<r.length;t++){let c=hp(r,t);if(c>=r.length)break;let l=r[c];if(l.type!==\"Digit\")break;t=c,i.push(l.val)}if(t=hp(r,t),t>=r.length)return;let s=r[t];if(s.type!==\"Frac\")return;let o=[],a=[];for(let c of s.num.args)if(!KP(c)){if(c.type!==\"Digit\")return;o.push(c.val)}for(let c of s.den.args)if(!KP(c)){if(c.type!==\"Digit\")return;a.push(c.val)}let u=Pn(n,s.span);return Yr(t,O1(u,i.join(\"\"),o.join(\"\"),a.join(\"\")))}function KP(e){switch(e.type){case\"Sqrt\":case\"Frac\":case\"SupSub\":case\"LeftRight\":case\"OperatorName\":case\"TokenNode\":case\"Symbol\":case\"Letter\":case\"Digit\":return!1;case\"Cmd\":return e.val===\"\\\\space\";case\"EscapedSymbol\":return e.val===\"\\\\ \"||e.val===\"\\\\:\"||e.val===\"\\\\,\"||e.val===\"\\\\;\";default:throw`Unexpected atom ${e.type}.`}}function hp(e,t){for(;t<e.length&&KP(e[t]);)t+=1;return t}function $m(e){return Xm(e,\".\")}function Xm(e,t){return e.type===\"Symbol\"&&e.val===t}function Gc(e){return{type:\"initial\",tokenType:e}}function bp(e){return{type:\"l\",tokenType:e}}function xp(e){return{type:\"r\",tokenType:e}}function Rt(e){return{type:\"la\",tokenType:e}}function zc(e){return{type:\"ra\",tokenType:e}}function fv(e,t){for(let r of av)if(t[r]===void 0)throw new Error(`Programming Error: token ${r} must be a assigned a ${e} precedence`)}function zu(e,t,r,n){if(t[r]!==void 0)throw new Error(`Programming Error: duplicate ${e} entry for token ${r}.`);t[r]=n}function dv(e){let t={},r={},n={};for(let a=0;a<e.length;a++){let u=e[a];for(let{type:c,tokenType:l}of u)switch(c){case\"initial\":zu(\"initial\",t,l,a);break;case\"l\":zu(\"left\",r,l,a);break;case\"r\":zu(\"right\",n,l,a);break;case\"la\":zu(\"left\",r,l,a),zu(\"right\",n,l,a);break;case\"ra\":zu(\"left\",r,l,a),zu(\"right\",n,l,a-1);break}}fv(\"left\",r),fv(\"right\",n);function i(a){return n[a]}function s(a){return r[a]}function o(a){let u=t[a];return u===void 0?i(a):u}return{rightPrec:i,leftPrec:s,initialPrec:o}}var Hc={},Lw=[\"sin\",\"cos\",\"tan\",\"cot\",\"sec\",\"csc\",\"sinh\",\"cosh\",\"tanh\",\"coth\",\"sech\",\"csch\"];Lw.forEach(function(e){Hc[e]=\"arc\"+e,Hc[\"arc\"+e]=e});var ww=0;function hv(e,t){return Fw(e,t)}function je(e,t){let r=[];for(let n=0;n<t.length;n++)r.push(rr(e,t[n]));return r}function Fw(e,t){return e.setInput(Vw(e,t),t.span)}function bv(e){if(e.type!==\"Call\")return;let[t,r]=e.args,n=pn(r);if(ln(t)&&n.every(ln))return{base:t,args:n}}function xv(e){return bv(e)!==void 0}function Pv(e){return e.type===\"Paren\"&&e.args[0].type===\"Seq\"&&e.args[0].args.every(ln)}function iT(e){return ln(e)||Pv(e)}function Vw(e,t){let r=e.nodes;switch(t.type){case\"Equals\":{let[n,i]=t.args,s=bv(n);if(s){let{base:o,args:a}=s;return r.FunctionDefinition(rr(e,o),je(e,a),rr(e,i))}else if(iT(n)){let o=rr(e,i);return Pv(n)?r.CoordinateEquation(rr(e,n),o):r.Assignment(rr(e,n),o)}return r.Equation(rr(e,n),rr(e,i))}case\"Tilde\":{let[n,i]=je(e,t.args);return r.Regression(n,i)}case\"Inequality\":return Hu(e,t);case\"InequalityChain\":{if(t.chain.length>1)throw nd();let{first:{symbol:n,args:[i,s]},chain:[{symbol:o,args:[a]}]}=t;return ln(s)?r.DoubleInequality([rr(e,i),n,rr(e,s),o,rr(e,a)]):Hu(e,t)}case\"Call\":{let[n,i]=t.args;if(n.type===\"Cmd\")switch(n.val){case\"histogram\":return r.Histogram(je(e,pn(i)));case\"dotplot\":return r.DotPlot(je(e,pn(i)));case\"boxplot\":return r.BoxPlot(je(e,pn(i)));case\"ttest\":return r.TTest(je(e,pn(i)));case\"ittest\":return r.IndependentTTest(je(e,pn(i)));case\"stats\":return r.Stats(je(e,pn(i)));default:return Pp(e,t)}return Pp(e,t)}default:return Pp(e,t)}}function Tv(e){if(e.type!==\"Paren\")return!1;let[t]=e.args;return t.type!==\"Seq\"?!1:t.args.length===2||t.args.length===3}function rr(e,t){return e.setInput(Pp(e,t),t.span)}function Pp(e,t){let r=e.nodes;switch(t.type){case\"Pos\":return rr(e,t.args[0]);case\"Neg\":let n=-1,i=t.args[0];for(;;)if(i.type===\"Pos\"||i.type===\"Paren\"&&!Tv(i))i=i.args[0];else if(i.type===\"Neg\")i=i.args[0],n*=-1;else break;switch(i.type){case\"Decimal\":{let o=yv(i);return r.Constant(n===-1?Vi(o):o)}case\"MixedNumber\":{let o=gv(i);return r.MixedNumber(n===-1?Vi(o):o)}default:return n===-1?r.Negative([rr(e,i)]):rr(e,i)}case\"Add\":return r.Add(je(e,t.args));case\"Sub\":return r.Subtract(je(e,t.args));case\"Mul\":return r.Multiply(je(e,t.args));case\"DotMul\":return r.DotMultiply(je(e,t.args));case\"CrossMul\":return r.CrossMultiply(je(e,t.args));case\"Div\":return r.Divide(je(e,t.args));case\"Bang\":{let[o]=t.args;return o.type===\"Call\"&&!Wm(o.args[0])?r.FunctionFactorial(je(e,o.args)):r.FunctionCall(\"\\\\factorial\",je(e,t.args))}case\"PercentOf\":return r.PercentOf(je(e,t.args));case\"Call\":return mv(e,t);case\"ImplicitCall\":return kw(t),mv(e,t);case\"Dot\":{let o=t.args[1],[a,u]=je(e,t.args);if(Wm(o)){let c=vs(o.span.input,o.span.end),l=e.setInput(Mv(e),c);u=e.setInput(r.SeededFunctionCall(u,[l]),o.span)}else if(o.type===\"Letter\")switch(o.val){case\"x\":case\"y\":case\"z\":return r.NamedCoordinateAccess(o.val,[a]);default:break}else if(o.type===\"Call\"){let c=o.args[0];if(c.type===\"Letter\")switch(c.val){case\"x\":case\"y\":case\"z\":return r.Multiply([e.setInput(r.NamedCoordinateAccess(c.val,[a]),Pn(t.args[0].span,c.span)),rr(e,o.args[1])])}}return r.DotAccess([a,u])}case\"Prime\":{let[o]=t.args;if(o.type===\"Call\"){let[a,u]=o.args,c=pn(u).length;if(a.type===\"Cmd\"&&a.val===\"logbase\"){if(c!==2)throw gu()}else if(c!==1)throw gu();return r.Prime(t.nprimes,je(e,t.args))}else throw o.type===\"ImplicitCall\"?rd():td()}case\"Index\":{let[o,a]=t.args;if(a.type===\"Seq\")return r.ListAccess([rr(e,o),e.setInput(r.List(je(e,a.args)),void 0)]);if(a.type===\"Ellipsis\"){let[u,c]=a.args;return r.ListAccess([rr(e,o),e.setInput(r.Range([e.setInput(r.List(je(e,pn(u))),void 0),e.setInput(r.List(c.type===\"EmptyRangeEnd\"?[]:je(e,pn(c))),void 0)]),void 0)])}return Ev(a)?r.ListAccess([rr(e,o),e.setInput(Hu(e,a),void 0)]):r.ListAccess(je(e,t.args))}case\"Paren\":{let[o]=t.args;if(o.type===\"Seq\"){if(o.args.length===0)throw Yh();return r.ParenSeq(je(e,o.args))}else return rr(e,o)}case\"List\":{if(t.args.length===0)return r.List([]);let o=t.args[0];if(o.type===\"Ellipsis\"){let[a,u]=o.args;return r.Range([e.setInput(r.List(je(e,pn(a))),void 0),e.setInput(r.List(je(e,pn(u))),void 0)])}else if(o.type===\"For\"){let[a,u]=o.args,c=e.setInput(r.Identifier(`_comprehensionIndex_${ww++}`),void 0),l=rr(jm(e,{prefix:\"li\",expr:c}),a),p=[];for(let f of pn(u)){if(!Tp(f))throw Jb();p.push(e.setInput(r.AssignmentExpression(je(e,f.args)),f.span))}return r.ListComprehension(c,l,p)}return r.List(je(e,pn(o)))}case\"Pipes\":{let[o]=t.args;return r.Norm([rr(e,o)])}case\"Subscript\":{let[o,a]=t.args;if(a.val.length===0)throw ed();let u;switch(o.type){case\"Letter\":u=o.val;break;case\"Cmd\":u=o.val;break;default:throw Hh()}if(u===\"ans\")throw In(\"ans\");return r.Identifier(`${u}_${a.val}`)}case\"Superscript\":{let[o,a]=t.args;if(o.type===\"Call\"&&o.args[1].type!==\"Seq\"&&!Wm(o.args[0])&&!qw(o))return r.FunctionExponent(je(e,[o.args[0],o.args[1],a]));if(o.type===\"Dot\"){let u=o.args[1],[c,l]=je(e,o.args),p=rr(e,a);if(u.type===\"Letter\")switch(u.val){case\"x\":case\"y\":case\"z\":return r.Exponent([e.setInput(r.NamedCoordinateAccess(u.val,[c]),o.span),p]);default:break}else if(u.type===\"Call\"){let f=u.args[0];if(f.type===\"Letter\")switch(f.val){case\"x\":case\"y\":case\"z\":return r.Multiply([e.setInput(r.NamedCoordinateAccess(f.val,[c]),Pn(o.args[0].span,f.span)),e.setInput(r.Exponent([rr(e,u.args[1]),p]),Xn(t.span.input,u.args[0].span.end,a.span.end))]);default:break}}return r.Exponent([e.setInput(r.DotAccess([c,l]),o.span),p])}else return r.Exponent(je(e,t.args))}case\"Sqrt\":return r.FunctionCall(\"sqrt\",je(e,t.args));case\"Nthroot\":return r.FunctionCall(\"nthroot\",je(e,[t.args[1],t.args[0]]));case\"Frac\":return r.Divide(je(e,t.args));case\"Derivative\":{let o=je(e,t.args);if(!ln(t.args[0]))throw ne(`Expected identifier in derivative, but found ${t.args[0].type}`);return r.Derivative(o[0],[o[1]])}case\"Integral\":{let[o,a,u,c]=t.args,l=je(e,[o,a,u,c]);return r.Integral(l)}case\"EmptyIntegral\":{let[o,a,u]=je(e,t.args),c=e.setInput(r.Constant(Ce(1,1)),void 0);return r.Integral([o,a,u,c])}case\"Sum\":{let[o,a,u]=t.args;if(!Tp(a))throw Cb();let c=je(e,[a.args[0],a.args[1],u]),l=rr(jm(e,{prefix:\"ro\",expr:c[0]}),o);return r.Sum(c.concat(l))}case\"Product\":{let[o,a,u]=t.args;if(!Tp(a))throw _b();let c=je(e,[a.args[0],a.args[1],u]),l=rr(jm(e,{prefix:\"ro\",expr:c[0]}),o);return r.Product(c.concat(l))}case\"Juxt\":{if(e.writeIntegral){let[u,c]=t.args;if(c.type===\"Letter\"&&c.val===\"t\"&&u.type===\"Juxt\"&&([u,c]=u.args,c.type===\"Letter\"&&c.val===\"n\")){if(u.type===\"Juxt\"){if([u,c]=u.args,c.type===\"Letter\"&&c.val===\"i\")throw gd()}else if(u.type===\"Letter\"&&u.val===\"i\")throw gd()}}let[o,a]=t.args;if(o.type===\"MixedNumber\"&&!(ln(a)||a.type===\"Piecewise\"||a.type===\"Call\"||a.type===\"Paren\"))throw Kf(Jm(o));if(a.type===\"MixedNumber\")throw Kf(Jm(a));return r.Multiply(je(e,t.args))}case\"Letter\":return r.Identifier(t.val);case\"Cmd\":{let o=t.val;switch(o){case\"ans\":{if(e.currentIndex===void 0)throw Fl(\"ans\");return r.Ans(`ans_{${e.currentIndex-1}}`)}case\"approx\":throw zf(o);case\"dt\":{if(!e.allowDt)throw Fl(o);return r.Identifier(o)}case\"index\":{if(!e.allowIndex)throw Fl(o);return r.Identifier(o)}default:return r.Identifier(o)}}case\"With\":{if(e.isSubstitutionRHS)throw Ed();let[o,a]=t.args,u=ee(W({},e),{isSubstitutionRHS:!0});return r.Substitution(rr(u,o),zw(u,a))}case\"Decimal\":return r.Constant(yv(t));case\"MixedNumber\":return r.MixedNumber(gv(t));case\"Piecewise\":return Uw(e,t);case\"RightArrow\":return Hw(e,t);case\"Seq\":return r.BareSeq(je(e,t.args));case\"EmptyPiecewise\":if(!r.Piecewise.empty)throw Iu();return r.Piecewise.empty();case\"Equals\":throw In(\"=\");case\"Inequality\":case\"InequalityChain\":throw Sg();case\"Tilde\":throw In(\"~\");case\"Colon\":throw In(\":\");case\"Ellipsis\":throw In(\"...\");case\"For\":throw Pd();case\"EmptyRangeEnd\":throw Rb();case\"Err\":throw Yw(t.error);default:throw`Unexpected surface node ${t.type}.`}}function nT(e){return Hc.hasOwnProperty(e)}function Iv(e){return e===\"ln\"||e===\"log\"||e===\"logbase\"}function Bw(e){return e.type===\"Decimal\"&&e.val===\"2\"}function Gw(e){return e.type!==\"Neg\"?!1:(e=e.args[0],e.type===\"Decimal\"&&e.val===\"1\")}function mv(e,t){let r=e.nodes,[n,i]=t.args,s=rr(e,n),o=pn(i),a=je(e,o);if(Wm(n)){let u=vs(i.span.input,i.span.start),c=e.setInput(Mv(e),u);return r.SeededFunctionCall(s,[c].concat(a))}if(ln(n))return r.FunctionCall(s,a);if(n.type===\"Superscript\"){let[u,c]=n.args;if(u.type===\"Cmd\"){let l=u.val;if(nT(l)||Iv(l)){if(Bw(c))return r.Exponent([e.setInput(r.FunctionCall(l,a),void 0),rr(e,c)]);if(Gw(c)&&Hc[l]!==void 0)return r.FunctionCall(Hc[l],a);throw nT(l)?Zh(l):Wh(l===\"logbase\"?\"log\":l)}}}return r.Multiply([s,rr(e,i)])}function zw(e,t){let r=e.nodes;if(t.type===\"Seq\"){let s=!1,o=!1;for(let a=0;a<t.args.length;a++){if(t.args[a].type===\"With\")throw kl();Tp(t.args[a])?s=!0:o=!0}if(s&&o)throw kl()}if(t.type===\"With\")throw Ed();let n=pn(t),i=[];for(let s of n){if(!Tp(s))throw rx();let o=e.setInput(r.AssignmentExpression(je(e,s.args)),s.span);i.push(o)}return i}function Hw(e,t){let r=e.nodes;if(!ln(t.args[0]))throw sh();return e=jm(e,{prefix:\"ec\",expr:e.setInput(r.Identifier(\"globalEventCount\"),void 0)}),r.UpdateRule(je(e,t.args))}function Uw(e,t){let r=e.nodes,[n]=t.args,i=pn(n),s,o=[];e:for(s=0;s<i.length;s++){let f=i[s];switch(f.type){case\"Colon\":{let[y,h]=f.args;if(!Ev(y))throw Qh();if(h.type===\"With\"&&h.args[1].type===\"Seq\")throw kl();o.push({condition:e.setInput(Hu(e,y),y.span),if_expr:rr(e,h)});break}case\"Equals\":case\"Inequality\":case\"InequalityChain\":o.push({condition:e.setInput(Hu(e,f),f.span),if_expr:e.setInput(r.Constant(Ce(1,1)),Xn(\"1\",0,1))});break;default:break e}}if(s===0)throw jh();if(s<i.length-1)throw Jh();let a,u;s===i.length-1?(a=Pp(e,i[s]),u=i[s]):a=r.Constant(NaN);let c=a,l=u==null?void 0:u.span,p;for(;o.length;)p=o.pop(),c=r.Piecewise([p.condition,p.if_expr,e.setInput(c,l)]),l=void 0;return c}function Ev(e){return e.type===\"Equals\"||e.type===\"Inequality\"||e.type===\"InequalityChain\"}function Hu(e,t){let r=e.nodes;switch(t.type){case\"Equals\":return r.Comparator[\"=\"](je(e,t.args));case\"Inequality\":return r.Comparator[t.symbol](je(e,t.args));case\"InequalityChain\":if(t.chain.length>1)throw nd();let{first:{symbol:n,args:[i,s]},chain:[{symbol:o,args:[a]}]}=t,u=vs(t.span.input,t.span.start);return r.And([e.setInput(Hu(e,dp(u,n,[i,s])),Pn(i.span,s.span)),e.setInput(Hu(e,dp(u,o,[s,a])),Pn(s.span,a.span))]);default:throw ne(`Unexpected type for condition: ${t.type}`)}}function kw(e){let[t,r]=e.args;if(t.type===\"Superscript\"&&(t=t.args[0]),t.type===\"Cmd\"&&t.val===\"logbase\"&&r.type===\"Seq\"&&r.args.length===2){if(!qs(r.args[0]))throw Qf(\"log\")}else if(!qs(r))throw t.type===\"Cmd\"?Qf(t.val):ne(`Unexpected type for args of implicit call: ${r.type}`)}function yv(e){return au(e.val)}function gv(e){let t=au(e.whole),r=au(e.num),n=au(e.den);return co(t,As(r,n))}function qw(e){if(e.type!==\"Call\")return!1;let t=e.args[0];for(;t.type===\"Superscript\"||t.type===\"Subscript\"||t.type===\"Prime\";)t=t.args[0];return t.type!==\"Cmd\"?!1:nT(t.val)||Iv(t.val)}function Tp(e){return e.type===\"Equals\"&&ln(e.args[0])}function Yw(e){switch(e.type){case\"UnexpectedParseError\":case\"MissingBound\":case\"EmptyGroup\":case\"UnexpectedDifferential\":case\"UnexpectedEnd\":return ne(`Unexpected error type: ${e.type}`);case\"InvalidOperatorName\":return zh();case\"UnexpectedCloseDelimiter\":case\"MissingCloseDelimiter\":return kb(e.open,e.close);case\"UnrecognizedSymbol\":return e.val===\".\"?In(e.val):zf(e.val);case\"EmptyInput\":return Nl();case\"BinaryOperatorMissingRight\":case\"BinaryOperatorMissingLeft\":return Rl(e.val===\"%\"?\"% of\":e.val);case\"UnaryOperatorMissingLeft\":return _h(e.val);case\"UnaryOperatorMissingRight\":return Lh(e.val);case\"UnexpectedSubscript\":return Kh(e.base);case\"PercentMissingOf\":return Yb();case\"SumMissingBound\":return Nb();case\"ProductMissingBound\":return Ab();case\"IntegralMissingBound\":return Fb();case\"SumMissingBody\":return Gb();case\"ProductMissingBody\":return zb();case\"IntegralMissingBody\":return Hb();case\"DerivativeMissingBody\":return Ub();case\"IntegralMissingDifferential\":return Vb();case\"DifferentialWithSuperscript\":return Bb();case\"FractionMissingNumerator\":return wh();case\"FractionMissingDenominator\":return Fh();case\"FractionEmpty\":return Vh();case\"EmptySuperscript\":return Bh();case\"EmptySubscript\":return ed();case\"InvalidSubscript\":return Gh(e.val);case\"SuperscriptWithPrime\":return Uh();case\"PrimeWithoutParen\":return rd();case\"UnexpectedPrime\":return td();case\"EmptyRadical\":return kh();case\"EmptyRadicalIndex\":return qh();case\"EmptySquareBracket\":return Xh();case\"EmptyPipe\":return $h();case\"FunctionMissingArgument\":return Ui(e.val,1,0);case\"AdjacentNumbers\":return Nh(Jm(e.args[0]),Jm(e.args[1]));case\"TokenWithSubscript\":return Ah();case\"UnexpectedFor\":return Pd();default:throw`Unexpected surface node ${e.type}.`}}function Jm(e){switch(e.type){case\"Decimal\":return e.val;case\"MixedNumber\":return`${e.whole} ${e.num}/${e.den}`;default:let t=e;throw new Error(`Unexpected node type ${t.type}`)}}function qs(e){switch(e.type){case\"Letter\":case\"Decimal\":case\"MixedNumber\":case\"Cmd\":case\"EmptyPiecewise\":return!0;case\"Neg\":{let r=e.args[0];for(;;)if(r.type===\"Pos\"||r.type===\"Paren\"&&!Tv(r))r=r.args[0];else if(r.type===\"Neg\")r=r.args[0];else break;return r.type===\"Decimal\"||r.type===\"MixedNumber\"}case\"Pos\":return qs(e.args[0]);case\"Paren\":return qs(e.args[0]);case\"Juxt\":case\"Mul\":case\"DotMul\":case\"CrossMul\":case\"Div\":return qs(e.args[0])&&qs(e.args[1]);case\"Subscript\":return qs(e.args[0]);case\"Superscript\":case\"Frac\":case\"Add\":case\"Sub\":return qs(e.args[0])&&qs(e.args[1]);case\"Piecewise\":{let[r]=e.args;return r.type===\"Equals\"||r.type===\"Inequality\"||r.type===\"InequalityChain\"}case\"Call\":{let[r,n]=e.args;return ln(r)||S1(r)?!1:qs(r)&&qs(n)}case\"Derivative\":case\"Sqrt\":case\"Nthroot\":case\"Pipes\":case\"Bang\":return!1;case\"Equals\":case\"Inequality\":case\"InequalityChain\":case\"Tilde\":case\"ImplicitCall\":case\"Index\":case\"List\":case\"Seq\":case\"Integral\":case\"EmptyIntegral\":case\"Sum\":case\"Product\":case\"Colon\":case\"Ellipsis\":case\"For\":case\"With\":case\"Dot\":case\"PercentOf\":case\"Prime\":case\"EmptyRangeEnd\":case\"RightArrow\":return!1;default:throw`Unexpected surface node ${e.type}.`}}function Wm(e){return e.type!==\"Cmd\"?!1:e.val===\"random\"||e.val===\"shuffle\"}function Mv(e){let t=e.nodes.ExtendSeed(\"\",[e.setInput(e.nodes.Identifier(\"globalRandomSeed\"),void 0),e.setInput(e.nodes.Seed(e.nextSeed()),void 0)]);if(!e.seedExtensions)return t;for(let{prefix:r,expr:n}of e.seedExtensions)t=e.nodes.ExtendSeed(r,[e.setInput(t,void 0),n]);return t}function jm(e,t){let r=e.seedExtensions||[];return ee(W({},e),{seedExtensions:r.concat(t)})}var Xw=[[Gc(\"(\"),Rt(\")\"),Gc(\"\\\\{\"),Rt(\"\\\\}\"),xp(\"[\"),Rt(\"]\"),Gc(\"(|\"),Rt(\"|)\"),Rt(\"Differential\"),Rt(\"End\")],[Rt(\"for\")],[xp(\"with\")],[zc(\"...\")],[Rt(\",\")],[zc(\":\")],[xp(\"->\")],[bp(\"with\")],[Rt(\"=\"),Rt(\">\"),Rt(\"<\"),Rt(\">=\"),Rt(\"<=\"),Rt(\"~\")],[bp(\"->\")],[Rt(\"+\"),Rt(\"-\")],[Rt(\"*\"),Rt(\"\\\\cdot\"),Rt(\"\\\\times\"),Rt(\"/\"),Rt(\"Decimal\"),Rt(\"MixedNumber\"),Rt(\"Letter\"),Rt(\"Cmd\"),Rt(\"TokenNode\"),Rt(\"%\"),xp(\"(\"),Rt(\"\\\\{\"),Rt(\"(|\"),Rt(\"Frac\"),Rt(\"Sqrt\"),Rt(\"Trig\"),Rt(\"Ln\"),Rt(\"Log\"),zc(\"Int\"),zc(\"Sum\"),zc(\"Prod\")],[Gc(\"+\"),Gc(\"-\")],[Rt(\"!\")],[Rt(\"SupSub\")],[bp(\"[\"),Rt(\".\")],[bp(\"(\")],[Rt(\"Err\")]],{leftPrec:Qm,rightPrec:Dv,initialPrec:Rv}=dv(Xw),vv={trailingComma:!1};function Nv(e,t){let r=t?W(W({},vv),t):vv,n=oa(e,r),i=$w(n);return i.type===\"Err\"&&i.error.type===\"EmptyGroup\"?Pe(i.span,N1()):i}function $w(e){return Ua(e,{isToplevel:!0})}function Ua(e,{isToplevel:t}={isToplevel:!1}){if(Zm(e))return Pe(oe(e,e),A1());let{state:r,tree:n}=Fr(e,0,{isToplevel:t});return n.type!==\"Err\"&&!Zm(r)?oT(r).tree:n}function B(e,t){return{state:e,tree:t}}function Fr(e,t,{isToplevel:r}={isToplevel:!1}){let n=e,i;if({state:n,tree:i}=Zw(n),i.type===\"Err\")return B(n,i);if(!rT(e,n))throw new Error(\"Programming Error: parseInitial did not advance state.\");for(;!Zm(n);){let s;if(dn(n,\"(\")&&!Jw(i)?s=Dv(\"(\"):s=Qm(fn(n).type),t>=s)break;let o=n,a=Ww(n,i,r)?Qm(\",\")-1:Dv(fn(n).type);if({state:n,tree:i}=jw(n,i,a),i.type===\"Err\")return B(n,i);if(!rT(o,n))throw new Error(\"Programming Error: parseSuccessor did not advance state.\")}return B(n,i)}function mi(e){return e.type===\"UnexpectedDifferential\"||e.type===\"UnexpectedCloseDelimiter\"||e.type===\"UnexpectedEnd\"||e.type===\"BinaryOperatorMissingLeft\"}function Zw(e){let t=e,r=fn(e),n=Rv(r.type),i;switch(r.type){case\"+\":{if(e=Se(e),{state:e,tree:i}=Fr(e,n),i.type===\"Err\"){if(!mi(i.error))return B(e,i);let o=oe(t,e),a=Pe(o,XP(r.val));return B(e,a)}return B(e,JD(oe(t,e),[i]))}case\"-\":if(e=Se(e),{state:e,tree:i}=Fr(e,n),i.type===\"Err\"){if(!mi(i.error))return B(e,i);let o=oe(t,e),a=Pe(o,XP(r.val));return B(e,a)}else return B(e,QD(oe(t,e),[i]));case\"(\":return Ip(e);case\"\\\\{\":return e=Se(e),dn(e,\"\\\\}\")?(e=Se(e),B(e,h1(oe(t,e)))):({state:e,tree:i}=Fr(e,n),{state:e,tree:i}=Ep(t,e,i,\"\\\\{\",\"\\\\}\"),i.type===\"Err\"?B(e,i):B(e,g1(oe(t,e),[i])));case\"[\":return e=Se(e),dn(e,\"]\")?(e=Se(e),B(e,BP(oe(t,e),[]))):({state:e,tree:i}=Fr(e,n),{state:e,tree:i}=Ep(t,e,i,\"[\",\"]\"),i.type===\"Err\"?B(e,i):B(e,BP(oe(t,e),[i])));case\"(|\":{if(e=Se(e),dn(e,\"|)\")){e=Se(e);let o=oe(t,e);return B(e,Pe(o,L1()))}return{state:e,tree:i}=Fr(e,n),{state:e,tree:i}=Ep(t,e,i,\"(|\",\"|)\"),i.type===\"Err\"?B(e,i):B(e,a1(oe(t,e),[i]))}case\"Frac\":{if(e.opts.disallowFrac)throw xd();e=Se(e);let o=Ua(oa(r.num,e.opts)),a=Ua(oa(r.den,e.opts));if(o.type===\"Err\"&&o.error.type===\"EmptyGroup\"&&a.type===\"Err\"&&a.error.type===\"EmptyGroup\"){let u=oe(t,e),c=Pe(u,tv());return B(e,c)}if(o.type===\"Err\"&&o.error.type===\"EmptyGroup\"){let u=oe(t,e),c=Pe(u,K1());return B(e,c)}if(a.type===\"Err\"&&a.error.type===\"EmptyGroup\"){let u=oe(t,e),c=Pe(u,ev());return B(e,c)}if(o.type===\"Err\")return B(e,o);if(a.type===\"Err\")return B(e,a);if(R1(o,a)&&a.type===\"Juxt\"){let u=a.args[1],c;if({state:e,tree:c}=Fr(e,Qm(\"*\")-1),c.type===\"Err\"){if(mi(c.error)){let l=oe(t,e);return B(e,Pe(l,j1()))}return B(e,c)}return B(e,p1(oe(t,e),[u,c]))}return B(e,l1(oe(t,e),[o,a]))}case\"Sqrt\":if(e=Se(e),r.optArg){let o=Ua(oa(r.optArg,e.opts));if(o.type===\"Err\")return o.error.type===\"EmptyGroup\"?B(e,Pe(o.span,w1())):B(e,o);let a=Ua(oa(r.arg,e.opts));return a.type===\"Err\"?a.error.type===\"EmptyGroup\"?B(e,Pe(a.span,qP())):B(e,a):B(e,c1(oe(t,e),[o,a]))}else{let o=Ua(oa(r.arg,e.opts));return o.type===\"Err\"?o.error.type===\"EmptyGroup\"?B(e,Pe(o.span,qP())):B(e,o):B(e,u1(oe(t,e),[o]))}case\"Trig\":case\"Ln\":{e=Se(e);let o=Gu(oe(t,e),r.val),a=0,u=fn(e);if(u.type===\"SupSub\"){if(e=Se(e),u.sub){let p=oe(t,e),f=Pe(p,H1(o.val));return B(e,f)}let l=Km(u,e.opts);if(l){if(l.type===\"Err\")return B(e,l);o=Um(oe(t,e),[o,l])}a=u.nprimes}let c=dn(e,\"(\");if(c){if({state:e,tree:i}=Ip(e),i.type===\"Err\")return B(e,i);i=mp(oe(t,e),[o,i.args[0]])}else{if({state:e,tree:i}=Fr(e,n-1),i.type===\"Err\")return mi(i.error)?B(e,Pe(oe(t,e),ZP(r.val))):B(e,i);i=FP(oe(t,e),[o,i])}if(a>0){let l=oe(t,e);if(!c){let p=Pe(l,WP());return B(e,p)}i=yp(l,a,[i])}return B(e,i)}case\"Log\":{e=Se(e);let o=oe(t,e),a=Gu(o,r.val),u=0,c,l,p=fn(e);if(p.type===\"SupSub\"&&(e=Se(e),c=Av(p,e.opts),l=Km(p,e.opts),u=p.nprimes),c&&c.type===\"Err\")return B(e,c);if(l&&l.type===\"Err\")return B(e,l);let f=dn(e,\"(\");if(f){if({state:e,tree:i}=Ip(e),i.type===\"Err\")return B(e,i);i=i.args[0]}else if({state:e,tree:i}=Fr(e,n-1),i.type===\"Err\")return mi(i.error)?B(e,Pe(oe(t,e),ZP(r.val))):B(e,i);let y=c?Gu(o,\"\\\\logbase\"):a,h=c?km(oe(t,e),pn(i).concat(c)):i;if(l&&(y=Um(oe(t,e),[y,l])),f?i=mp(oe(t,e),[y,h]):i=FP(oe(t,e),[y,h]),u>0){let m=oe(t,e);if(!f){let b=Pe(m,WP());return B(e,b)}i=yp(m,u,[i])}return B(e,i)}case\"Int\":{e=Se(e);let o=fn(e);e=Se(e);let a=sT(o,t,e);if(a.type===\"Err\")return a.error.type===\"MissingBound\"?B(e,Pe(a.span,X1())):B(e,a);let{sup:u,sub:c}=a,l;if(dn(e,\"Differential\"))return{state:e,tree:l}=Sv(e),l.type===\"Err\"?B(e,l):B(e,d1(oe(t,e),[l,c,u]));if({state:e,tree:i}=Fr(e,n),i.type===\"Err\")return mi(i.error)?B(e,Pe(i.span,W1())):B(e,i);let p=i;return dn(e,\"Differential\")?({state:e,tree:l}=Sv(e),l.type===\"Err\"?B(e,l):B(e,f1(oe(t,e),[l,c,u,p]))):B(e,Pe(oe(t,e),J1()))}case\"Sum\":{e=Se(e);let o=fn(e);e=Se(e);let a=sT(o,t,e);if(a.type===\"Err\")return a.error.type===\"MissingBound\"?B(e,Pe(a.span,q1())):B(e,a);let{sup:u,sub:c}=a;return{state:e,tree:i}=Fr(e,n),i.type===\"Err\"?mi(i.error)?B(e,Pe(i.span,$1())):B(e,i):B(e,m1(oe(t,e),[i,c,u]))}case\"Prod\":{e=Se(e);let o=fn(e);e=Se(e);let a=sT(o,t,e);if(a.type===\"Err\")return a.error.type===\"MissingBound\"?B(e,Pe(a.span,Y1())):B(e,a);let{sup:u,sub:c}=a;return{state:e,tree:i}=Fr(e,n),i.type===\"Err\"?mi(i.error)?B(e,Pe(i.span,Z1())):B(e,i):B(e,y1(oe(t,e),[i,c,u]))}case\"Cmd\":return e=Se(e),i=Gu(oe(t,e),r.val),B(e,i);case\"TokenNode\":{e=Se(e);let o=fn(e);return o.type===\"SupSub\"&&o.sub?(e=Se(e),B(e,Pe(oe(t,e),nv()))):(i=Gu(oe(t,e),r.val),B(e,i))}case\"Letter\":return e=Se(e),i=D1(oe(t,e),r.val),B(e,i);case\"Decimal\":{e=Se(e);let o=qm(oe(t,e),r.val),a=e.token;if(a.type===\"Decimal\"||a.type===\"MixedNumber\"){let u=e;e=Se(e);let c=oe(t,e),l=a.type===\"MixedNumber\"?a:qm(oe(u,e),a.val);return B(e,Pe(c,JP([o,l])))}return B(e,o)}case\"MixedNumber\":{if(e.opts.disallowFrac)throw xd();e=Se(e);let o=e.token;if(o.type===\"Decimal\"||o.type===\"MixedNumber\"){let a=e;e=Se(e);let u=oe(t,e),c=o.type===\"MixedNumber\"?o:qm(oe(a,e),o.val);return B(e,Pe(u,JP([r,c])))}return B(e,r)}case\"*\":case\"\\\\cdot\":case\"\\\\times\":case\"/\":case\",\":case\"=\":case\">\":case\"<\":case\">=\":case\"<=\":case\"->\":case\"~\":case\":\":case\"...\":case\"%\":case\".\":{e=Se(e);let o=oe(t,e),a=Pe(o,F1(r.val));return B(e,a)}case\"for\":{e=Se(e);let o=oe(t,e),a=Pe(o,rv());return B(e,a)}case\"with\":{e=Se(e);let o=oe(t,e),a=Pe(o,UP());return B(e,a)}case\"!\":{e=Se(e);let o=oe(t,e),a=Pe(o,$P(r.val));return B(e,a)}case\"SupSub\":{e=Se(e);let o=\"supsub\";r.sub?o=\"subscript\":r.sup?o=\"superscript\":r.nprimes>0&&(o=\"prime\");let a=oe(t,e),u=Pe(a,$P(o));return B(e,u)}case\")\":case\"\\\\}\":case\"]\":case\"|)\":case\"Differential\":return oT(e);case\"Err\":{e=Se(e);let o=oe(t,e),a=Pe(o,G1(r.val));return B(e,a)}case\"End\":{let o=oe(t,e),a=Pe(o,YP());return B(e,a)}default:throw`Unexpected token type ${r.type}.`}}function Ww(e,t,r){return dn(e,\"=\")&&r&&(xv(t)||iT(t))}function jw(e,t,r){let n=fn(e),i;switch(n.type){case\"+\":case\"-\":case\"*\":case\"\\\\cdot\":case\"\\\\times\":case\"/\":case\"=\":case\"~\":case\":\":case\".\":case\"->\":case\"for\":{if(e=Se(e),{state:e,tree:i}=Fr(e,r),i.type===\"Err\")if(mi(i.error)){let o=Dr(t.span,e),a=Pe(o,za(n.val));return B(e,a)}else return B(e,i);return B(e,Ov(n.type,Dr(t.span,e),[t,i]))}case\"with\":{if(e=Se(e),{state:e,tree:i}=Fr(e,r),i.type===\"Err\")if(mi(i.error)){let o=Dr(t.span,e),a=Pe(o,za(n.val));return B(e,a)}else return B(e,i);return B(e,Ov(n.type,Dr(t.span,e),[t,i]))}case\"%\":{e=Se(e);let o=fn(e);if(o.type!==\"Cmd\"||o.val!==\"of\"&&o.val!==\"\\\\of\"){let a=Pe(n.span,U1());return B(e,a)}if(e=Se(e),{state:e,tree:i}=Fr(e,r),i.type===\"Err\")if(mi(i.error)){let a=Dr(t.span,e),u=Pe(a,za(n.val));return B(e,u)}else return B(e,i);return B(e,E1(Dr(t.span,e),[t,i]))}case\">=\":case\"<=\":case\">\":case\"<\":{let o=n.type;if(e=Se(e),{state:e,tree:i}=Fr(e,r),i.type===\"Err\")if(mi(i.error)){let l=Dr(t.span,e),p=Pe(l,za(n.val));return B(e,p)}else return B(e,i);let a=dp(Dr(t.span,e),o,[t,i]),u=[],c=fn(e).type;for(;c===\">=\"||c===\"<=\"||c===\">\"||c===\"<\";){let l=e;if(o=c,e=Se(e),{state:e,tree:i}=Fr(e,r),i.type===\"Err\")if(mi(i.error)){let p=Dr(t.span,e),f=Pe(p,za(n.val));return B(e,f)}else return B(e,i);u.push(ZD(oe(l,e),o,[i])),c=fn(e).type}return u.length?B(e,WD(Dr(t.span,e),a,u)):B(e,a)}case\"!\":return e=Se(e),B(e,s1(Dr(t.span,e),[t]));case\"[\":{let o=e;if(e=Se(e),dn(e,\"]\")){e=Se(e);let a=oe(o,e);return B(e,Pe(a,_1()))}return{state:e,tree:i}=Fr(e,r),{state:e,tree:i}=Ep(o,e,i,\"[\",\"]\"),i.type===\"Err\"?B(e,i):B(e,o1(Dr(t.span,e),[t,i]))}case\"Sqrt\":case\"Frac\":case\"Letter\":case\"Cmd\":case\"TokenNode\":case\"Trig\":case\"Ln\":case\"Log\":case\"Sum\":case\"Int\":case\"Prod\":case\"Decimal\":case\"MixedNumber\":case\"\\\\{\":case\"(|\":return{state:e,tree:i}=Fr(e,r),i.type===\"Err\"?B(e,i):B(e,HP(Dr(t.span,e),[t,i]));case\"(\":if(ln(t)){if({state:e,tree:i}=Ip(e),i.type===\"Err\")return B(e,i);let o=Dr(t.span,e);return B(e,mp(o,[t,i.args[0]]))}else if(t.type===\"Prime\"&&ln(t.args[0])){if({state:e,tree:i}=Ip(e),i.type===\"Err\")return B(e,i);let o=Dr(t.span,e);return B(e,yp(o,t.nprimes,[mp(o,[t.args[0],i.args[0]])]))}else return{state:e,tree:i}=Fr(e,r),i.type===\"Err\"?B(e,i):B(e,HP(Dr(t.span,e),[t,i]));case\"SupSub\":{e=Se(e);let o=Cv(n),a=Km(n,e.opts);if(o&&o.type===\"Err\")return B(e,o);if(a&&a.type===\"Err\")return B(e,a);if(o&&(t=GP(Dr(t.span,e),[t,o])),a&&(t=Um(Dr(t.span,e),[t,a])),n.nprimes>0){let u=Dr(t.span,e);if(!ln(t)){let c=Pe(u,Ym());return B(e,c)}t=yp(u,n.nprimes,[t])}return B(e,t)}case\",\":{let o=[t];for(;dn(e,\",\")&&(e=Se(e),!(dn(e,\"...\")||e.opts.trailingComma&&Qw(e)));){if({state:e,tree:i}=Fr(e,r),i.type===\"Err\")if(mi(i.error)){let a=Dr(t.span,e),u=Pe(a,za(n.val));return B(e,u)}else return B(e,i);o.push(i)}return B(e,km(Dr(t.span,e),o))}case\"...\":{if(e=Se(e),dn(e,\",\")&&(e=Se(e)),r>=Qm(fn(e).type))return B(e,zP(Dr(t.span,e),[t,b1(eT(e))]));if({state:e,tree:i}=Fr(e,r),i.type===\"Err\")if(mi(i.error)){let o=Dr(t.span,e),a=Pe(o,za(n.val));return B(e,a)}else return B(e,i);return B(e,zP(Dr(t.span,e),[t,i]))}case\"]\":case\")\":case\"\\\\}\":case\"|)\":case\"Differential\":return oT(e);case\"Err\":return Fr(e,r);case\"End\":{let o=oe(e,e),a=Pe(o,YP());return B(e,a)}default:throw`Unexpected token type ${n.type}.`}}function Jw(e){return!!(ln(e)||e.type===\"Prime\"&&ln(e.args[0]))}function Ov(e,t,r){switch(e){case\"+\":return KD(t,r);case\"-\":return e1(t,r);case\"*\":return t1(t,r);case\"\\\\cdot\":return r1(t,r);case\"\\\\times\":return n1(t,r);case\"/\":return i1(t,r);case\"=\":return $D(t,r);case\"~\":return jD(t,r);case\":\":return x1(t,r);case\".\":return I1(t,r);case\"->\":return M1(t,r);case\"for\":return P1(t,r);case\"with\":return T1(t,r);default:throw`Unexpected token type ${e}.`}}function Av(e,t){if(!e.sub)return;let r=e.sub,n=Ua(oa(r,t));return n.type===\"Err\"&&n.error.type===\"EmptyGroup\"?Pe(n.span,kP()):n}function Cv(e){if(!e.sub)return;let t=e.sub;if(t.args.length===0)return Pe(t.span,kP());let r=[];for(let n of t.args)if(n.type===\"Digit\"||n.type===\"Letter\")r.push(n.val);else{let i=n.span;return Pe(i,z1(Gr(i)))}return v1(t.span,r.join(\"\"))}function Km(e,t){if(!e.sup)return;let r=Ua(oa(e.sup,t));return r.type===\"Err\"?r.error.type===\"EmptyGroup\"?Pe(r.span,C1()):r:e.nprimes>0?Pe(e.span,k1()):r}function sT(e,t,r){if(e.type!==\"SupSub\"){let s=oe(t,r);return Pe(s,jP())}if(e.nprimes>0){let s=oe(t,r);return Pe(s,Ym())}let n=Av(e,r.opts),i=Km(e,r.opts);if(!n||n.type===\"Err\"&&n.error.type===\"EmptySubscript\"||!i||i.type===\"Err\"&&i.error.type===\"EmptySuperscript\"){let s=oe(t,r);return Pe(s,jP())}return n.type===\"Err\"?n:i.type===\"Err\"?i:{type:\"Bounds\",sup:i,sub:n}}function Ip(e){let t=e,r=fn(e),n=Rv(r.type);if(dn(e,\"(\"))e=Se(e);else throw new Error(\"Programming Error: expected '(' at start of parseParen.\");if(dn(e,\")\")){let s=km(eT(e),[]);e=Se(e);let o=oe(t,e);return B(e,VP(o,[s]))}let i;return{state:e,tree:i}=Fr(e,n),{state:e,tree:i}=Ep(t,e,i,\"(\",\")\"),i.type===\"Err\"?B(e,i):B(e,VP(oe(t,e),[i]))}function Sv(e){let t=e,r=fn(e);if(r.type!==\"Differential\")throw new Error(\"Programming Error: expected differential\");e=Se(e);let n=Gu(r.span,r.val),i=fn(e);if(i.type===\"SupSub\"){e=Se(e);let s=oe(t,e),o=Cv(i);if(o){if(o.type===\"Err\")return B(e,o);n=GP(s,[n,o])}if(i.sup)return B(e,Pe(s,Q1()));if(i.nprimes>0)return B(e,Pe(s,Ym()))}return B(e,n)}function Ep(e,t,r,n,i){if(r.type===\"Err\"&&r.error.type!==\"UnexpectedEnd\")return B(t,r);if(r.type===\"Err\"||!dn(t,i)){let s=oe(e,t),o=Pe(s,V1(n,i));return B(t,o)}return t=Se(t),B(t,r)}function oT(e){let t=e;switch(fn(e).type){case\")\":{e=Se(e);let n=oe(t,e);return B(e,Pe(n,gp(\"(\",\")\")))}case\"]\":{e=Se(e);let n=oe(t,e);return B(e,Pe(n,gp(\"[\",\"]\")))}case\"\\\\}\":{e=Se(e);let n=oe(t,e);return B(e,Pe(n,gp(\"\\\\{\",\"\\\\}\")))}case\"|)\":{e=Se(e);let n=oe(t,e);return B(e,Pe(n,gp(\"|\",\"|\")))}case\"Differential\":{e=Se(e);let n=oe(t,e);return B(e,Pe(n,B1()))}default:{e=Se(e);let n=oe(t,e);return B(e,Pe(n,UP()))}}}function Qw(e){return dn(e,\")\")||dn(e,\"]\")||dn(e,\"\\\\}\")}function Kw(){throw Iu()}function _v(e,t){return t&&!e._inputSpan&&e.setInputSpan(t),e}function ys(e,t={}){let r=typeof e;if(r!==\"string\")throw new Error(`Type Error: parse can only be called with strings, got ${JSON.stringify(e)} of type ${r}`);let n=I;if(t.disabledFeatures){n=Object.create(n);for(let l of t.disabledFeatures){if(!n[l])throw new Error(`Programming Error: ${l} cannot be disabled because it is not a parsenode.`);n[l]=Kw}}let i=t.seedPrefix===void 0?\"\":t.seedPrefix,s=0,o=()=>{let l=`${i}::vc${s}`;return s+=1,l},a={nodes:n,currentIndex:t.index,setInput:_v,nextSeed:o,allowDt:!!t.allowDt,allowIndex:!!t.allowIndex,writeIntegral:!!t.writeIntegral},u={};t.trailingComma!==void 0&&(u.trailingComma=t.trailingComma),t.disallowFrac&&(u.disallowFrac=!0);function c(l){return l.parseOptions=t,l}if(e===\"\")return c(Nl());try{let l=qD(e),p=Nv(l,u),f=hv(a,p);return f.parseOptions=t,f}catch(l){let p;return l instanceof I.Error?p=l:typeof l==\"string\"?p=new I.Error(l):p=ne(l),c(p)}}function tF(e,t,r){return{chunk:e,argMap:t,start:r}}function ka(e,t,r,n){let i=tF(e,[t],r);return Mp(i,n)}function Mp(e,t){let{chunk:r,argMap:n,start:i}=e;if(t<i)return t;let s=n[t-i];if(s!==void 0)return s;let o=rF(e,t);e.argMap[t-i]=o;let a=r.getInstruction(t);if(jn(a))switch(a.type){case 23:case 21:break;case 19:{let c=a.args.length-2;for(let l=0;l<c;l++)Mp(e,t+1+l);break}default:let u=a;throw new Error(`Programming Error. Unexpected OpCode: ${u.type}`)}else if(un(a)){let u=a.args.length-1;for(let c=0;c<u;c++)Mp(e,t+1+c)}return o}function rF(e,t){let{chunk:r,start:n}=e,i=r.getInstruction(t);if(un(i)){let a=i.args[0];for(let u=a;u<=t;u++){let c=r.getInstruction(u);if(!De(c))for(let l of c.args)l<a&&Mp(e,l)}}if(De(i))return fs(r,i);let s=[];for(let a of i.args)s.push(Mp(e,a));let o=e.argMap[t-n];return o!==void 0?o:mr(r,i,s)}var pr=Symbol(\"FRAME_SENTINEL\");function Uu(e,t){return aT(e,t).freeDependencies}function aT(e,t){let r={};return t.type===\"FunctionDefinition\"&&(t=t._expression),uT(e,t,r)}function Lv(e,t,r){let n=[],i=[],s=[],o=[],a=[];for(let u of t.scopes){let c=Lv(e,u,r);for(let l of c.freeDependencies)n.indexOf(l)===-1&&t.definitions.indexOf(l)===-1&&n.push(l);for(let l of c.substitutionDependencies)o.indexOf(l)===-1&&t.definitions.indexOf(l)===-1&&o.push(l);for(let l of c.substitutionBodyDependencies)a.indexOf(l)===-1&&t.definitions.indexOf(l)===-1&&a.push(l);for(let l of c.updateSymbols)i.indexOf(l)===-1&&i.push(l);for(let l of c.substitutionSymbols)s.indexOf(l)===-1&&s.push(l)}for(let u of t.dependencies){if(t.definitions.indexOf(u)!==-1)continue;let c=nF(e,u,r),l=t.substitutionDependencies.indexOf(u)!==-1;for(let p of c.freeDependencies)n.indexOf(p)===-1&&t.definitions.indexOf(p)===-1&&n.push(p),l&&o.indexOf(p)===-1&&t.definitions.indexOf(p)===-1&&o.push(p),t.kind===\"Substitution\"&&a.indexOf(p)===-1&&t.definitions.indexOf(p)===-1&&a.push(p);for(let p of c.substitutionDependencies)o.indexOf(p)===-1&&t.definitions.indexOf(p)===-1&&o.push(p);for(let p of c.updateSymbols)i.indexOf(p)===-1&&i.push(p);for(let p of c.substitutionSymbols)s.indexOf(p)===-1&&s.push(p)}return{freeDependencies:n,updateSymbols:i,substitutionSymbols:s,substitutionDependencies:o,substitutionBodyDependencies:a}}function uT(e,t,r){if(t.type===\"Slider\"||t.type===\"Assignment\")return uT(e,t._expression,r);{let{freeDependencies:n,substitutionDependencies:i,updateSymbols:s,substitutionSymbols:o,substitutionBodyDependencies:a}=Lv(e,t.getScope(),r),u=t.getUpdateSymbols();if(u.length>0){s=s.slice();for(let l of u)s.indexOf(l)===-1&&s.push(l)}let c=t.getSubstitutionSymbols();if(c.length>0){o=o.slice();for(let l of c)o.indexOf(l)===-1&&o.push(l)}return{freeDependencies:n,updateSymbols:s,substitutionSymbols:o,substitutionDependencies:i,substitutionBodyDependencies:a}}}function nF(e,t,r){if(r[t])return r[t];if(Xe[t])return r[t]={freeDependencies:[],updateSymbols:[],substitutionSymbols:[],substitutionDependencies:[],substitutionBodyDependencies:[]},r[t];let n=e[t];if(n===pr)throw new Error(\"Programming error: _getSymbolFreeDependencies called with a symbol that is defined in a local scope\");return n?(r[t]={freeDependencies:[t],updateSymbols:[],substitutionSymbols:[],substitutionDependencies:[],substitutionBodyDependencies:[]},r[t]=uT(e,n,r),r[t]):(r[t]={freeDependencies:[t],updateSymbols:[],substitutionSymbols:[],substitutionDependencies:[],substitutionBodyDependencies:[]},r[t])}function wv(e,t){for(var r={},n=t.getDependencies().slice();n.length;){var i=n.pop();if(!r.hasOwnProperty(i)){var s=e[i];if(s===pr)return;r[i]=s,s&&s.getDependencies&&Array.prototype.push.apply(n,s.getDependencies())}}return iF(r)}function iF(e){let t=[];for(let r in e)t.push([r,e[r]]);return t}function Fv(e,t){Vv(e,t,{})}function Vv(e,t,r){let n={};for(let i of t.definitions){if(n[i])switch(t.kind){case\"Sum\":case\"Product\":case\"Integral\":throw ne(new Error(`${t.kind} scope is not expected to define multiple symbols`));case\"FunctionDefinition\":break;case\"ListComprehension\":throw zl(i);case\"Substitution\":throw ox(i);default:let s=t.kind;throw ne(new Error(`Unexpected scope kind ${s}`))}n[i]=!0}for(let i of t.definitions){if(e[i])switch(t.kind){case\"Sum\":case\"Product\":throw sd(i);case\"Integral\":throw md(i);case\"FunctionDefinition\":if(i===t.functionDefinitionSymbol)break;throw hc(i);case\"ListComprehension\":throw zl(i);case\"Substitution\":break;default:let s=t.kind;throw ne(new Error(`Unexpected scope kind ${s}`))}if(r[i])switch(t.kind){case\"Sum\":case\"Product\":throw sd(i);case\"Integral\":throw md(i);case\"FunctionDefinition\":throw hc(i);case\"ListComprehension\":throw zl(i);case\"Substitution\":throw Ul(i);default:let s=t.kind;throw ne(new Error(`Unexpected scope kind ${s}`))}}r=Object.create(r);for(let i of t.definitions)r[i]=!0;for(let i of t.scopes)Vv(e,i,r)}function Uc(e,t,r){let n=e.getInstruction(t);if(!ie(n.valueType,P)&&!ie(n.valueType,N)&&!ie(n.valueType,G))throw Jg([pe(n.valueType)]);let i=e.getInstruction(r);if(!ie(i.valueType,P)&&i.type!==0)throw ne(`Unexpected derivative var type ${i.valueType}`);let s=e.Constant(0);if(t<r)return s;let o=e.Constant(1),a=e.Constant(NaN),u=_a(e,r),c=dF(e,t);e.derivativeMaps[r]||(e.derivativeMaps[r]={maxValidReference:e.instructionsLength()-1,map:[]});let{map:l,maxValidReference:p}=e.derivativeMaps[r];for(let m=0;m<l.length;m++){let b=l[m];b!==void 0&&b>p&&(l[m]=void 0)}let f=[],y=!1;for(let m=0;m<r;m++)f[m]=m,l[m]=s;return cT({chunk:e,derivativeVarIndex:r,forwardMask:u,backwardMask:c,valueMap:f,derivativeMap:l,mustCopy:y,ZERO:s,ONE:o,NAN:a},r,t),e.derivativeMaps[r].maxValidReference=e.instructionsLength()-1,l[t]}function cT(e,t,r){let{chunk:n,valueMap:i,derivativeMap:s,backwardMask:o}=e;for(let a=t;a<=r;a++){let u=s[a];if(u!==void 0)if(n.getInstruction(u).type===0)s[a]=void 0;else{i[a]=ey(e,a);continue}if(!o[a]){i[a]=ey(e,a);continue}let c=n.getInstruction(a);if(jn(c)&&c.endIndex!==-1)switch(c.type){case 21:{a=sF(e,a);continue}case 19:case 23:{a=uF(e,a);continue}}i[a]=ey(e,a),s[a]=cF(e,a)}return r}function sF(e,t){let{chunk:r,forwardMask:n,valueMap:i,derivativeMap:s,ZERO:o}=e,a=r.getInstruction(t),u=a.endIndex,c=r.getInstruction(u),l=o;if(n[a.args[1]]){let p=i[a.args[1]];l=r.Add([l,r.Multiply([s[a.args[1]],ka(r,p,t,c.args[1])])])}if(n[a.args[0]]){let p=i[a.args[0]];l=r.Subtract([l,r.Multiply([s[a.args[0]],ka(r,p,t,c.args[1])])])}if(oF(r,t,n)){let p=i.slice();p[t]=mr(r,a,[p[a.args[0]],p[a.args[1]]]),s[t]=o,cT(ee(W({},e),{valueMap:p,mustCopy:!0}),t+1,u-1);let f=mr(r,c,[p[c.args[0]],s[c.args[1]]]);s[u]=f,l=r.Add([l,mr(r,r.getInstruction(u+1),[f])])}else for(let p=t;p<=u;p++)s[p]=o;if(aF(r,t,i)){let p=ee(W({},e),{mustCopy:!0});for(let f=t;f<=u+1;f++)i[f]=ey(p,f)}else for(let p=t;p<=u+1;p++)i[p]=p;return s[u+1]=l,u+c.args.length-1}function oF(e,t,r){let n=e.getInstruction(t),i=e.getInstruction(n.endIndex);if(i.args[1]<t+1)return r[i.args[1]];for(let s=t+1;s<=i.args[1];s++){let o=e.getInstruction(s);if(!De(o)){for(let a of o.args)if(a<t&&r[a])return!0}}return!1}function aF(e,t,r){let n=e.getInstruction(t);for(let i=t;i<=n.endIndex;i++){let s=e.getInstruction(i);if(!De(s)){for(let o of s.args)if(r[o]!==o)return!0}}return!1}function uF(e,t){let{chunk:r,derivativeMap:n,valueMap:i,ZERO:s}=e,o=r.getInstruction(t),a=o.endIndex,u=r.getInstruction(a),c;if(o.type===23)i[t]=mr(r,o,[i[o.args[0]]]),n[t]=s,c=t+1;else{let p=[];p.push(i[o.args[0]],i[o.args[1]]);for(let f=2;f<o.args.length;f++)p.push(i[o.args[f]],n[o.args[f]]);i[t]=mr(r,o,p),n[t]=s;for(let f=2;f<o.args.length;f++)i[t+f-1]=mr(r,r.getInstruction(t+f-1),[i[t]]),n[t+f-1]=mr(r,r.getInstruction(t+f-1),[i[t]]);c=t+o.args.length-1}cT(ee(W({},e),{mustCopy:!0}),c,a-1);let l=[];l.push(i[u.args[0]]);for(let p=1;p<u.args.length;p++)l.push(i[u.args[p]],n[u.args[p]]);i[a]=mr(r,u,l),n[a]=s;for(let p=1;p<u.args.length;p++)i[a+p]=mr(r,r.getInstruction(a+p),[i[a]]),n[a+p]=mr(r,r.getInstruction(a+p),[i[a]]);return a+u.args.length-1}function ey(e,t){let{chunk:r,valueMap:n,mustCopy:i}=e,s=r.getInstruction(t);if(De(s))return i?fs(r,s):t;{let o=[],a=!1;for(let u of s.args)o.push(n[u]),n[u]!==u&&(a=!0);return a||i?mr(r,s,o):t}}function cF(e,t){let{chunk:r,derivativeVarIndex:n,forwardMask:i,valueMap:s,derivativeMap:o,ZERO:a,ONE:u,NAN:c}=e,l=r.getInstruction(t);if(t===n)if(j(l.valueType)){let f=bn(r,t),y=r.BeginBroadcast([f]),h=r.EndBroadcast([y,u]);return r.BroadcastResult(te,[h])}else return u;if(jn(l)||un(l)||l.type===47||l.type===48||l.type===25||l.type===27||l.type===26||l.type===29||l.type===28||l.type===32||l.type===31||l.type===42||l.type===44||l.type===49)return a;if(!i[t]||De(l))return l.valueType!==P?pF(r,[s[t],a]):l.type!==1||isFinite(Y(l.value))?a:c;if(l.type===38||l.type===15||l.type===16){let f=[];for(let y of l.args)f.push(o[y]);return mr(r,l,f)}if(l.type===33)return mr(r,l,[s[l.args[0]],o[l.args[1]],o[l.args[2]]]);let p=a;for(let f=0;f<l.args.length;f++){if(!i[l.args[f]])continue;let y=o[l.args[f]];if(y===a)continue;let h=lF(e,s[t],f,y);h!==a&&(p=p===a?h:fF(r,[h,p]))}return p}function lF(e,t,r,n){let{chunk:i,ZERO:s,ONE:o,NAN:a}=e,u=i.getInstruction(t);switch(u.type){case 8:return n;case 9:switch(r){case 0:return n;default:return i.Negative([n])}case 10:switch(r){case 0:return i.Multiply([n,u.args[1]]);default:return i.Multiply([u.args[0],n])}case 11:switch(r){case 0:return i.Divide([n,u.args[1]]);default:return i.Multiply([u.args[0],i.Divide([i.Negative([n]),i.Multiply([u.args[1],u.args[1]])])])}case 14:return i.Negative([n]);case 12:case 13:switch(r){case 0:return i.Multiply([i.Multiply([u.args[1],i.Exponent([u.args[0],i.Subtract([u.args[1],o])])]),n]);default:return i.Multiply([i.Piecewise([i.Equal([u.args[0],s]),i.Piecewise([i.GreaterEqual([u.args[1],s]),s,a]),i.Multiply([i.SyntheticNativeFunction(\"ln\",[u.args[0]]),t])]),n])}case 37:return mF(i,t,Gv[u.symbol][r],n);case 39:case 40:case 41:case 17:case 18:switch(r){case 0:return mr(i,u,[n,u.args[1]]);default:return s}default:{let c=u;throw new Error(`Unimplemented derivative for opcode ${c.type}`)}}}function pF(e,t){switch(e.getInstruction(t[0]).valueType){case Oe:return e.SyntheticNativeFunction(\"scaleTangentSegment\",t);case ye:return e.SyntheticNativeFunction(\"scaleTangentLine\",t);case _e:return e.SyntheticNativeFunction(\"scaleTangentRay\",t);case de:return e.SyntheticNativeFunction(\"scaleTangentCircle\",t);case ue:return e.SyntheticNativeFunction(\"scaleTangentArc\",t);case Ae:return e.SyntheticNativeFunction(\"scaleTangentUndirectedAngleMarker\",t);case xe:return e.SyntheticNativeFunction(\"scaleTangentDirectedAngleMarker\",t);default:return e.Multiply(t)}}function fF(e,t){switch(e.getInstruction(t[0]).valueType){case Oe:return e.SyntheticNativeFunction(\"addTangentSegment\",t);case dt:return e.SyntheticNativeFunction(\"addTangentSegmentThreeD\",t);case ye:return e.SyntheticNativeFunction(\"addTangentLine\",t);case _e:return e.SyntheticNativeFunction(\"addTangentRay\",t);case de:return e.SyntheticNativeFunction(\"addTangentCircle\",t);case ue:return e.SyntheticNativeFunction(\"addTangentArc\",t);case Ae:return e.SyntheticNativeFunction(\"addTangentUndirectedAngleMarker\",t);case xe:return e.SyntheticNativeFunction(\"addTangentDirectedAngleMarker\",t);default:return e.Add(t)}}function dF(e,t){let r=[];for(let n=0;n<t;n++)r.push(!1);r.push(!0);for(let n=t;n>=0;n--){if(!r[n])continue;let i=e.getInstruction(n);if(!De(i))if(i.type===33)r[i.args[1]]=!0,r[i.args[2]]=!0;else for(let s of i.args)r[s]=!0}return r}function mF(e,t,r,n){let i=Object.create(Xe),s=Yl({},{},-1),a=e.getInstruction(t).args;for(let u=0;u<a.length;u++){let c=yF[u];Mi(s,c,a[u]),i[c]=pr}return Mi(s,\"x_1\",n),i.x_1=pr,Mi(s,\"q\",t),i.q=pr,Be(yi(ND,i,e,s,void 0,{},void 0),r)}var yF=[\"x\",\"y\",\"z\",\"u\"],Bv={exp:[\"q*x_1\"],ln:[\"\\\\{x >= 0: x_1/x \\\\}\"],log:[\"\\\\{x >= 0: x_1/(x*\\\\ln(10)) \\\\}\"],sqrt:[\"x_1/(2*q)\"],rtxsqpone:[\"x*x_1/q\"],rtxsqmone:[\"x*x_1/q\"],sin:[\"\\\\cos(x)*x_1\"],cos:[\"-\\\\sin(x)*x_1\"],tan:[\"(1+q^2)*x_1\"],arcsin:[\"x_1/\\\\sqrt{1 - x^2}\"],arccos:[\"-x_1/\\\\sqrt{1 - x^2}\"],sinh:[\"\\\\cosh(x)*x_1\"],cosh:[\"\\\\sinh(x)*x_1\"],tanh:[\"(\\\\sech(x))^2*x_1\"],arcsinh:[\"x_1/\\\\rtxsqpone(x)\"],arccosh:[\"\\\\{ x > 0: x_1/\\\\rtxsqmone(x) \\\\}\"],arctanh:[\"\\\\{ \\\\abs(x) < 1: x_1/(1 - x^2) \\\\}\"],csc:[\"-\\\\cot(x)*q*x_1\"],sec:[\"\\\\tan(x)*q*x_1\"],cot:[\"-(1+q^2)*x_1\"],arccsc:[\"-x_1/(\\\\abs(x)*\\\\rtxsqmone(x))\"],arcsec:[\"x_1/(\\\\abs(x)*\\\\rtxsqmone(x))\"],arccot:[\"-x_1/(1+x^2)\"],csch:[\"-\\\\coth(x)*q*x_1\"],sech:[\"-\\\\tanh(x)*q*x_1\"],coth:[\"-(\\\\csch(x))^2*x_1\"],arccsch:[\"-x_1/(\\\\abs(x)*\\\\rtxsqpone(x))\"],arcsech:[\"\\\\{ x >= 0: -x_1/(x*\\\\sqrt{1 - x^2}) \\\\}\"],arccoth:[\"\\\\{ \\\\abs(x) > 1 : x_1/(1 - x^2) \\\\}\"],factorial:[\"q*\\\\polyGamma(0, x + 1)*x_1\"],floor:[\"\\\\{ q=x: 0/0, 0*x_1 \\\\}\"],ceil:[\"\\\\{ q=x: 0/0, 0*x_1 \\\\}\"],round:[\"\\\\{ \\\\abs(\\\\mod(x, 1) - 0.5) > 0: 0*x_1 \\\\}\"],abs:[\"\\\\{ x=0: 0/0, \\\\sign(x)*x_1 \\\\}\"],sign:[\"\\\\{ x=0: 0/0, 0*x_1 \\\\}\"],distance:[\"-((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y)/q\",\"((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y)/q\"],distanceThreeD:[\"-((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y+(y.z-x.z)*x_1.z)/q\",\"((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y+(y.z-x.z)*x_1.z)/q\"],segmentThreeD:[\"\\\\segmentThreeD(x_1,(0,0,0))\",\"\\\\segmentThreeD((0,0,0),x_1)\"],vectorThreeD:[\"\\\\vectorThreeD(x_1,(0,0,0))\",\"\\\\vectorThreeD((0,0,0),x_1)\"],triangle:[\"\\\\triangle(x_1,(0,0,0),(0,0,0))\",\"\\\\triangle((0,0,0),x_1,(0,0,0))\",\"\\\\triangle((0,0,0),(0,0,0),x_1)\"],sphere:[\"\\\\sphere(x_1,0)\",\"\\\\sphere((0,0,0),x_1)\"],pointDet:[\"\\\\pointDet(x_1,y)\",\"\\\\pointDet(x,x_1)\"],pointDot:[\"\\\\pointDot(x_1,y)\",\"\\\\pointDot(x,x_1)\"],pointPerp:[\"\\\\pointPerp(x_1)\"],segment:[\"\\\\segment(x_1,(0,0))\",\"\\\\segment((0,0),x_1)\"],line:[\"\\\\line(x_1,(0,0))\",\"\\\\line((0,0),x_1)\"],ray:[\"\\\\ray(x_1,(0,0))\",\"\\\\ray((0,0),x_1)\"],vector:[\"\\\\vector(x_1, (0,0))\",\"\\\\vector((0,0), x_1)\"],mathVector:[\"\\\\mathVector(x_1,(0,0))\",\"\\\\mathVector((0,0),x_1)\"],mathVectorThreeD:[\"\\\\mathVectorThreeD(x_1,(0,0,0))\",\"\\\\mathVectorThreeD((0,0,0),x_1)\"],vectorDisplacementAsPoint:[\"\\\\vectorDisplacementAsPoint(x_1)\"],vectorThreeDDisplacementAsPoint:[\"\\\\vectorThreeDDisplacementAsPoint(x_1)\"],basePointFromVector:[\"\\\\basePointFromVector(x_1)\"],basePointFromVectorThreeD:[\"\\\\basePointFromVectorThreeD(x_1)\"],circle:[\"\\\\circle(x_1,0)\",\"\\\\circle((0,0),x_1)\"],arc:[\"\\\\arc(x_1,(0,0),(0,0))\",\"\\\\arc((0,0),x_1,(0,0))\",\"\\\\arc((0,0),(0,0),x_1)\"],arcCenter:[\"(0/0,0/0)\"],arcOmega:[\"0/0\"],center:[\"\\\\center(x_1)\"],radius:[\"\\\\radius(x_1)\"],undirectedAngleMarker:[\"\\\\undirectedAngleMarker(x_1)\"],directedAngleMarker:[\"\\\\directedAngleMarker(x_1,0,0,0)\",\"\\\\directedAngleMarker((0,0),x_1,0,0)\",\"\\\\directedAngleMarker((0,0),0,x_1,0)\",\"\\\\directedAngleMarker((0,0),0,0,x_1)\"],directedCoterminalAngle:[\"\\\\directedCoterminalAngle(x_1)\"],undirectedCoterminalAngle:[\"\\\\undirectedCoterminalAngle(x_1)\"],supplement:[\"\\\\supplement(x_1)\"],directedAngleMarkerMultiplier:[\"\\\\directedAngleMarkerMultiplier(x_1)\"],undirectedAngleMarkerMultiplier:[\"\\\\undirectedAngleMarkerMultiplier(x_1)\"],directedAngleMarkerRawDelta:[\"\\\\directedAngleMarkerRawDelta(x_1)\"],undirectedAngleMarkerRawDelta:[\"\\\\undirectedAngleMarkerRawDelta(x_1)\"],polygonInteriorUndirectedAngles:[\"\\\\polygonInteriorUndirectedAngles(x_1)\"],polygonInteriorDirectedAngles:[\"\\\\polygonInteriorDirectedAngles(x_1)\"],lineFromSegment:[\"x_1\"],lineFromRay:[\"x_1\"],segmentGlider:[\"\\\\segmentGlider(x_1,y)\",\"\\\\{0<y<1:(\\\\segmentGlider(x,1)-\\\\segmentGlider(x,0))*x_1,(0,0)\\\\}\"],segmentThreeDGlider:[\"\\\\segmentThreeDGlider(x_1,y)\",\"\\\\{0<y<1:(\\\\segmentThreeDGlider(x,1)-\\\\segmentThreeDGlider(x,0))*x_1,(0,0,0)\\\\}\"],rayGlider:[\"\\\\rayGlider(x_1,y)\",\"\\\\{0<y:(\\\\rayGlider(x,1)-\\\\rayGlider(x,0))*x_1,(0,0)\\\\}\"],lineGlider:[\"\\\\lineGlider(x_1,y)\",\"(\\\\lineGlider(x,1)-\\\\lineGlider(x,0))*x_1\"],circleGlider:[\"\\\\circleGlider(x_1,y)\",\"2*\\\\pi*\\\\pointPerp(q-\\\\center(x))*x_1\"],arcGlider:[\"(0/0,0/0)\",\"(0/0,0/0)\"],polygonGlider:[\"(0/0,0/0)\",\"(0/0,0/0)\"],chooseNonIncidentPoint:[\"(0/0,0/0)\"],circleCircleIntersection:[\"(\\\\radius(x)*\\\\radius(x_1)+\\\\pointDot(\\\\center(x_1),(q-\\\\center(x))))/\\\\pointDot(\\\\pointPerp(q-\\\\center(y)),q-\\\\center(x))*\\\\pointPerp(q-\\\\center(y))\",\"(\\\\radius(y)*\\\\radius(x_1)+\\\\pointDot(\\\\center(x_1),(q-\\\\center(y))))/\\\\pointDot(\\\\pointPerp(q-\\\\center(x)),q-\\\\center(y))*\\\\pointPerp(q-\\\\center(x))\"],circleArcIntersection:[\"(0/0,0/0)\"],circleLineIntersection:[\"(\\\\radius(x)*\\\\radius(x_1)+\\\\pointDot(\\\\center(x_1),(q-\\\\center(x))))/\\\\pointDot((\\\\lineGlider(y,1)-\\\\lineGlider(y,0)),q-\\\\center(x))*(\\\\lineGlider(y,1)-\\\\lineGlider(y,0))\",\"(\\\\pointDet(\\\\lineGlider(x_1,0),\\\\lineGlider(y,1))+\\\\pointDet(\\\\lineGlider(y,0),\\\\lineGlider(x_1,1))-\\\\pointDet(q,\\\\lineGlider(x_1,1)-\\\\lineGlider(x_1,0)))/(\\\\pointDet(\\\\pointPerp(q-\\\\center(x)),\\\\lineGlider(y,1)-\\\\lineGlider(y,0)))*(\\\\pointPerp(q-\\\\center(x)))\"],arcCircleIntersection:[\"(0/0,0/0)\"],arcArcIntersection:[\"(0/0,0/0)\"],arcLineIntersection:[\"(0/0,0/0)\"],lineCircleIntersection:[\"(\\\\pointDet(\\\\lineGlider(x_1,0),\\\\lineGlider(x,1))+\\\\pointDet(\\\\lineGlider(x,0),\\\\lineGlider(x_1,1))-\\\\pointDet(q,\\\\lineGlider(x_1,1)-\\\\lineGlider(x_1,0)))/(\\\\pointDet(\\\\pointPerp(q-\\\\center(y)),\\\\lineGlider(x,1)-\\\\lineGlider(x,0)))*(\\\\pointPerp(q-\\\\center(y)))\",\"(\\\\radius(y)*\\\\radius(x_1)+\\\\pointDot(\\\\center(x_1),(q-\\\\center(y))))/\\\\pointDot((\\\\lineGlider(x,1)-\\\\lineGlider(x,0)),q-\\\\center(y))*(\\\\lineGlider(x,1)-\\\\lineGlider(x,0))\"],lineArcIntersection:[\"(0/0,0/0)\"],lineLineIntersection:[\"(\\\\pointDet(\\\\lineGlider(x_1,0),\\\\lineGlider(x,1))+\\\\pointDet(\\\\lineGlider(x,0),\\\\lineGlider(x_1,1))-\\\\pointDet(q,\\\\lineGlider(x_1,1)-\\\\lineGlider(x_1,0)))/(\\\\pointDet(\\\\lineGlider(y,1)-\\\\lineGlider(y,0),\\\\lineGlider(x,1)-\\\\lineGlider(x,0)))*(\\\\lineGlider(y,1)-\\\\lineGlider(y,0))\",\"(\\\\pointDet(\\\\lineGlider(x_1,0),\\\\lineGlider(y,1))+\\\\pointDet(\\\\lineGlider(y,0),\\\\lineGlider(x_1,1))-\\\\pointDet(q,\\\\lineGlider(x_1,1)-\\\\lineGlider(x_1,0)))/(\\\\pointDet(\\\\lineGlider(x,1)-\\\\lineGlider(x,0),\\\\lineGlider(y,1)-\\\\lineGlider(y,0)))*(\\\\lineGlider(x,1)-\\\\lineGlider(x,0))\"],parallel:[\"\\\\parallel(x_1,(0,0))\",\"\\\\parallel(\\\\line((0,0),(0,0)),x_1)\"],perpendicular:[\"\\\\perpendicular(x_1,(0,0))\",\"\\\\perpendicular(\\\\line((0,0),(0,0)),x_1)\"],scaleTangentSegment:[\"\\\\scaleTangentSegment(x_1, y)\",\"\\\\scaleTangentSegment(x, x_1)\"],scaleTangentLine:[\"\\\\scaleTangentLine(x_1, y)\",\"\\\\scaleTangentLine(x, x_1)\"],scaleTangentRay:[\"\\\\scaleTangentRay(x_1, y)\",\"\\\\scaleTangentRay(x, x_1)\"],scaleTangentCircle:[\"\\\\scaleTangentCircle(x_1, y)\",\"\\\\scaleTangentCircle(x, x_1)\"],scaleTangentArc:[\"\\\\scaleTangentArc(x_1, y)\",\"\\\\scaleTangentArc(x, x_1)\"],scaleTangentDirectedAngleMarker:[\"\\\\scaleTangentDirectedAngleMarker(x_1, y)\",\"\\\\scaleTangentDirectedAngleMarker(x, x_1)\"],scaleTangentUndirectedAngleMarker:[\"\\\\scaleTangentUndirectedAngleMarker(x_1, y)\",\"\\\\scaleTangentUndirectedAngleMarker(x, x_1)\"],addTangentSegment:[\"\\\\addTangentSegment(x_1, y)\",\"\\\\addTangentSegment(x, x_1)\"],addTangentSegmentThreeD:[\"\\\\addTangentSegmentThreeD(x_1, y)\",\"\\\\addTangentSegmentThreeD(x, x_1)\"],addTangentLine:[\"\\\\addTangentLine(x_1, y)\",\"\\\\addTangentLine(x, x_1)\"],addTangentRay:[\"\\\\addTangentRay(x_1, y)\",\"\\\\addTangentRay(x, x_1)\"],addTangentCircle:[\"\\\\addTangentCircle(x_1, y)\",\"\\\\addTangentCircle(x, x_1)\"],addTangentArc:[\"\\\\addTangentArc(x_1, y)\",\"\\\\addTangentArc(x, x_1)\"],addTangentDirectedAngleMarker:[\"\\\\addTangentDirectedAngleMarker(x_1, y)\",\"\\\\addTangentDirectedAngleMarker(x, x_1)\"],addTangentUndirectedAngleMarker:[\"\\\\addTangentUndirectedAngleMarker(x_1, y)\",\"\\\\addTangentUndirectedAngleMarker(x, x_1)\"],translation:[\"\\\\translation(x_1)\"],dilation:[\"\\\\dilation(x_1, y)\",\"\\\\dilation(x, x_1)\"],reflection:[\"\\\\reflection(x_1)\"],rotation:[\"\\\\rotation((0/0,0/0),0/0)\"],compose:[\"\\\\reflection(\\\\line((0/0,0/0),(0/0,0/0)))\",\"\\\\reflection(\\\\line((0/0,0/0),(0/0,0/0)))\"],inverse:[\"\\\\reflection(\\\\line((0/0,0/0),(0/0,0/0)))\"],transformPoint:[\"(0/0,0/0)\",\"(0/0,0/0)\"],transformSegment:[\"\\\\segment((0/0,0/0),(0/0,0/0))\",\"\\\\segment((0/0,0/0),(0/0,0/0))\"],transformVector:[\"\\\\vector((0/0,0/0),(0/0,0/0))\",\"\\\\vector((0/0,0/0),(0/0,0/0))\"],transformLine:[\"\\\\line((0/0,0/0),(0/0,0/0))\",\"\\\\line((0/0,0/0),(0/0,0/0))\"],transformRay:[\"\\\\ray((0/0,0/0),(0/0,0/0))\",\"\\\\ray((0/0,0/0),(0/0,0/0))\"],transformCircle:[\"\\\\circle((0/0,0/0),0/0)\",\"\\\\circle((0/0,0/0),0/0)\"],transformArc:[\"\\\\arc((0/0,0/0),(0/0,0/0),(0/0,0/0))\",\"\\\\arc((0/0,0/0),(0/0,0/0),(0/0,0/0))\"],transformPolygon:[\"\\\\polygon([])\",\"\\\\polygon([])\"],transformAngleMarker:[\"\\\\undirectedAngleMarker(directedAngleMarker([0/0,0/0],0/0,0/0,0/0))\",\"\\\\undirectedangleMarker(directedAngleMarker([0/0,0/0],0/0,0/0,0/0))\"],transformDirectedAngleMarker:[\"\\\\directedAngleMarker([0/0,0/0],0/0,0/0,0/0)\",\"\\\\directedangleMarker([0/0,0/0],0/0,0/0,0/0)\"],mean:[\"\\\\mean(x_1)\"],total:[\"\\\\total(x_1)\"],count:[\"0\"],var:[\"2*\\\\cov(x, x_1)\"],varp:[\"2*\\\\cov(x, x_1)*(\\\\count(x)-1)/\\\\count(x)\"],stdev:[\"\\\\cov(x, x_1)/q\"],stdevp:[\"\\\\covp(x, x_1)/q\"],mad:[\"\\\\mean(\\\\sign(x-\\\\mean(x))*(x_1 - \\\\mean(x_1)))\"],min:[\"x_1[\\\\argmin(x)]\"],max:[\"x_1[\\\\argmax(x)]\"],median:[\"0.5*(x_1[\\\\lowerQuantileIndex(x, 0.5)] + x_1[\\\\upperQuantileIndex(x, 0.5)])\"],argmin:[\"0/0\"],argmax:[\"0/0\"],gcd:[\"0/0\"],lcm:[\"0/0\"],erf:[\"\\\\frac{2x_1}{\\\\sqrt{\\\\pi }}\\\\exp(-x^2)\"],invNorm:[\"\\\\frac{x_1}{\\\\pdf(\\\\normaldist(0,1),q)}\"],logbase:[\"\\\\{x > 0: \\\\frac{x_1}{x*\\\\ln(y)} \\\\}\",\"\\\\frac{-q*x_1}{y*\\\\ln(y)}\"],nthroot:[\"x^{1/y - 1}/y*x_1\",\"-\\\\frac{q*\\\\ln(x)*x_1}{y^2}\"],hypot:[\"x_1*x/q\",\"x_1*y/q\"],polyGamma:[\"0/0\",\"\\\\polyGamma(1 + x, y)*x_1\"],mod:[\"\\\\{ q=0: 0/0, x_1 \\\\}\",\"\\\\{ \\\\mod(x/y, 1) > 0: -\\\\floor(x/y)*x_1 \\\\}\"],cov:[\"\\\\cov(x_1, y)\",\"\\\\cov(x, x_1)\"],covp:[\"\\\\covp(x_1, y)\",\"\\\\covp(x, x_1)\"],corr:[\"(\\\\cov(x_1, y) - (\\\\cov(x, y)*\\\\cov(x, x_1)/\\\\var(x)))/(\\\\stdevp(x)\\\\stdevp(y))\",\"(\\\\cov(x, x_1) - (\\\\cov(x, y)*\\\\cov(y, x_1)/\\\\var(y)))/(\\\\stdevp(x)\\\\stdevp(y))\"],spearman:[\"0/0\",\"0/0\"],quantile:[\"\\\\{ \\\\floor(y*(\\\\count(x)-1)) = y*(\\\\count(x)-1) :   x_1[\\\\upperQuantileIndex(x, y)],  (\\\\ceil(y*(\\\\count(x)-1)) - y*(\\\\count(x)-1))*x_1[\\\\lowerQuantileIndex(x, y)] +   (y*(\\\\count(x)-1) - \\\\floor(y*(\\\\count(x)-1)))*x_1[\\\\upperQuantileIndex(x, y)]\\\\}\",\"\\\\{ \\\\floor(y*(\\\\count(x)-1)) < y*(\\\\count(x)-1) :   (\\\\count(x)-1)*(x[\\\\upperQuantileIndex(x, y)] - x[\\\\lowerQuantileIndex(x, y)])*x_1\\\\}\"],quartile:[\"0.5*(x_1[\\\\lowerQuartileIndex(x, y)] + x_1[\\\\upperQuartileIndex(x, y)])\",\"0/0\"],tscore:[\"\\\\frac{\\\\sqrt{\\\\count(x)}(\\\\stdev(x)*\\\\mean(x_1)-(\\\\mean(x)-y)*\\\\frac{\\\\cov(x,x_1)}{\\\\stdev(x)})}{\\\\stdev(x)^2}\",\"-x_1*\\\\sqrt{\\\\count(x)}/\\\\stdev(x)\"],quartileIndex:[\"0/0\",\"0/0\"],upperQuartileIndex:[\"0/0\",\"0/0\"],lowerQuartileIndex:[\"0/0\",\"0/0\"],upperQuantileIndex:[\"0/0\",\"0/0\"],lowerQuantileIndex:[\"0/0\",\"0/0\"],nCr:[\"q*(\\\\polyGamma(0, 1 + x) - \\\\polyGamma(0, 1 + x - y))\",\"q*(\\\\polyGamma(0, 1 + x - y) - \\\\polyGamma(0, 1 + y))\"],nPr:[\"q*(\\\\polyGamma(0, 1 + x) - \\\\polyGamma(0, 1 + x - y))\",\"q*\\\\polyGamma(0, 1 + x - y)\"],arctan:[\"x_1*y/(y^2+x^2)\",\"-x_1*x/(y^2+x^2)\"],poissonpdf:[\"0/0\",\"x_1\\\\frac{\\\\exp(-y)(\\\\floor(x)-y)y^{(\\\\floor(x)-1)}}{(\\\\floor(x))!}\"],invPoisson:[\"0/0\",\"0/0\"],tpdf:[\"x_1*q*\\\\frac{-(y+1)*x}{y+x^2}\",\"x_1*\\\\frac{1}{2}q*(  \\\\frac{x^2-1}{y + x^2} + \\\\ln(\\\\frac{y}{y + x^2}) +   \\\\polyGamma(0, \\\\frac{1+y}{2}) - \\\\polyGamma(0, y/2))\"],invT:[\"x_1/\\\\pdf(\\\\tdist(y),q)\",\"0/0\"],tcdf:[\"-x_1*\\\\pdf(\\\\tdist(z),x)\",\"x_1*\\\\pdf(\\\\tdist(z),y)\",\"0/0\"],poissoncdf:[\"0/0\",\"0/0\",\"x_1\\\\sum _{n=\\\\max(0,\\\\floor(\\\\min(x,y)))}^{\\\\floor(\\\\max(x,y))}\\\\frac{\\\\exp(-z)(n-z)z^{(n-1)}}{n!}\"],normalpdf:[\"-x_1*\\\\frac{x-y}{z^2} q\",\"x_1*\\\\frac{x-y}{z^2} q\",\"x_1*(\\\\frac{(x-y-z)*(x-y+z)}{z^3}) q\"],binompdf:[\"0/0\",\"0/0\",\"\\\\{0<=z<=1: x_1*q*(\\\\frac{\\\\round(x)}{z}-\\\\frac{\\\\round(y)-\\\\round(x)}{1-z}), 0 \\\\}\"],invBinom:[\"0/0\",\"0/0\",\"0/0\"],uniformpdf:[\"0\",\"\\\\{y<=x: \\\\frac{x_1}{(z-y)^2}, 0\\\\}\",\"\\\\{z>=x: -\\\\frac{x_1}{(z-y)^2}, 0\\\\}\"],invUniform:[\"\\\\{y<=x<=z: x_1*(z-y), 0\\\\}\",\"\\\\{y<=x<=z: x_1*(1-x), 0\\\\}\",\"\\\\{y<=x<=z: x_1*x, 0\\\\}\"],normalcdf:[\"-x_1\\\\pdf(\\\\normaldist(z,u), x)\",\"x_1\\\\pdf(\\\\normaldist(z,u), y)\",\"-x_1*(\\\\pdf(\\\\normaldist(z,u), y) - \\\\pdf(\\\\normaldist(z,u), x))\",\"x_1*(  \\\\{\\\\abs(y)=1/0:0,\\\\frac{z-y}{u}\\\\pdf(\\\\normaldist(z,u),y)\\\\} -   \\\\{\\\\abs(x)=1/0:0,\\\\frac{z-x}{u}\\\\pdf(\\\\normaldist(z,u),x)\\\\})\"],binomcdf:[\"0/0\",\"0/0\",\"0/0\",\"\\\\{0<=u<=1: x_1*\\\\sum _{n=\\\\max(0,\\\\round(\\\\min(x,y)))}^{\\\\round(\\\\max(x,y))}(  \\\\pdf(\\\\binomialdist(z,u),n)*(\\\\frac{n}{u}-\\\\frac{\\\\round(z)-n}{1-u})), 0 \\\\}\"],uniformcdf:[\"\\\\{z>u: 0/0, -x_1\\\\pdf(\\\\uniformdist(z,u), x)\\\\}\",\"\\\\{z>u: 0/0, x_1\\\\pdf(\\\\uniformdist(z,u), y)\\\\}\",\"\\\\{z>u: 0/0, x_1*(\\\\frac{\\\\{z<x<u:u-x,0\\\\} + \\\\{z<y<u:y-u,0\\\\}}{(u-z)^2})\\\\}\",\"\\\\{z>u: 0/0, x_1*(\\\\frac{\\\\{z<x<u:x-z,0\\\\} + \\\\{z<y<u:z-y,0\\\\}}{(u-z)^2})\\\\}\"],normalSample:[\"0/0\",\"0/0\",\"0/0\"],uniformSample:[\"0/0\",\"0/0\",\"0/0\"],tSample:[\"0/0\",\"0/0\"],poissonSample:[\"0/0\",\"0/0\"],binomSample:[\"0/0\",\"0/0\",\"0/0\"],rgb:[\"0/0\",\"0/0\",\"0/0\"],hsv:[\"0/0\",\"0/0\",\"0/0\"],polygon:[\"\\\\polygon(x_1)\"],area:[\"0/0\"],perimeter:[\"0/0\"],vertices:[\"\\\\vertices(x_1)\"],segments:[\"\\\\segments(x_1)\"],validateRangeLength:[\"0\",\"0\",\"0\",\"\\\\{q \\\\ge 1: x_1, 0\\\\}\"],validateSampleCount:[\"\\\\{x<0:0,1\\\\}*x_1\"],select:[\"\\\\select(x_1, y)\",\"0*q\"],shuffle:[\"0*y\",\"\\\\shuffle(x, x_1)\"],sortPerm:[\"0*x\"],elementsAt:[\"\\\\elementsAt(x_1, y)\",\"0*q\"],uniquePerm:[\"0*q\"]},Gv={};for(let e in Bv){let t=e,r=Bv[t],n=[];for(let i=0;i<r.length;i++){let s=r[i];n.push(ys(s,{}))}Gv[t]=n}function zv(e,t){e.map.length=Math.min(e.map.length,t),e.maxValidReference=Math.min(e.maxValidReference,t-1)}function Hv(e,t,r){let n=e.argNames.indexOf(t);if(n===-1){let o=e.getInstruction(r);return o.type===1&&o.valueType===P&&isNaN(Y(o.value))?ko():Os()}let i=fi(e,n,{allowRestriction:!0,allowClosedBlockReferences:!1}),s=gF(i);return aa(s,r)}function gF(e){let{chunk:t,mask:r}=e;return{chunk:t,mask:r,orderCtx:e,domainTable:[]}}function aa(e,t){let{domainTable:r}=e,n=r[t];if(n!==void 0)return n;let i=hF(e,t);return r[t]=i,i}function hF(e,t){let{chunk:r,mask:n,orderCtx:i}=e,s=r.getInstruction(t);if(De(s)){if(s.type===1){if(s.valueType==P){if(isNaN(Y(s.value)))return ko()}else if(s.valueType===te){for(let o of s.value)if(isNaN(Y(o)))return gn()}}return Os()}switch(s.type){case 31:return KI(aa(e,s.args[0]),aa(e,s.args[1]));case 32:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 47:case 48:case 15:case 17:case 16:case 18:case 37:case 42:case 21:case 22:case 23:case 24:case 19:case 20:case 39:case 40:case 41:case 44:case 49:{let o=Os();for(let a of s.args)o=Cn(o,aa(e,a));return o}case 38:{if(!n[t])return Os();let o=aa(e,s.args[0]);if(o.type!==\"known\")return gn();for(let a=1;a<s.args.length;a++){let u=aa(e,s.args[a]);if(u.type!==\"known\")return gn();if(u.bounds[0]!==o.bounds[0]||u.bounds[1]!==o.bounds[1])return gn()}return o}case 25:return n[t]?gn():Os();case 33:{let o=r.getInstruction(s.args[2]);return o.type!==1||o.valueType!==P||!isNaN(Y(o.value))?gn():Cn(aa(e,s.args[0]),aa(e,s.args[1]))}case 26:case 27:case 28:case 29:{if(!n[t])return Os();if(Ir(i,t)>1)return gn();let o=e.coefficientCtx;o===void 0&&(o=ds(i),e.coefficientCtx=o);let a=o.newChunk,u=wr(o,t),[c,l]=u;if(!Vt(a.getInstruction(c)))return gn();let p=Zt(a,c);if(isNaN(p))return ko();let f=Os();for(let y of s.args)f=Cn(f,aa(e,y));if(l===void 0)return s.type===28||s.type===29?p>=0?f:ko():p>0?f:ko();{let y=Zt(a,l);return Cn(f,rc(p,y))}}}}function kv(e){let t=[],r=[];for(let n=0;n<e.argNames.length;n++){let i=[],s=[];for(let o=0;o<e.argNames.length;o++)i.push(e.argTypes[o]===P),s.push(n===o);r.push(s),t.push(i)}for(let n=e.argNames.length;n<=e.getReturnIndex();n++)r.push(bF(e,r,n)),t.push(xF(e,r,t,n));return t[e.getReturnIndex()]}function bF(e,t,r){let n=e.getInstruction(r),i=PF(e.argNames.length);if(De(n))return i;for(let s of n.args){let o=t[s];for(let a=0;a<o.length;a++)i[a]=i[a]||o[a]}return i}function xF(e,t,r,n){let i=e.getInstruction(n);if(De(i))return Uv(e.argNames.length);switch(i.type){case 8:case 9:case 14:case 38:{let a=Uv(e.argNames.length);for(let u=0;u<i.args.length;u++){let c=r[i.args[u]];for(let l=0;l<c.length;l++)a[l]=a[l]&&c[l]}return a}case 11:{let a=[],u=r[i.args[0]],c=t[i.args[1]];for(let l=0;l<u.length;l++)a.push(u[l]&&!c[l]);return a}case 10:{let a=r[i.args[0]].slice(),u=r[i.args[1]].slice(),c=t[i.args[0]],l=t[i.args[1]],p=0,f=0;for(let y=0;y<a.length;y++){let h=a[y]&&!l[y],m=u[y]&&!c[y];a[y]=h,u[y]=m,h&&(p+=1),m&&(f+=1)}return p>=f?a:u}case 33:{let a=t[i.args[0]],u=r[i.args[1]],c=r[i.args[2]];for(var s=[],n=0;n<a.length;n++)s.push(!a[n]&&u[n]&&c[n]);return s}case 39:case 40:case 41:{let a=r[i.args[0]],u=t[i.args[1]],c=[];for(var n=0;n<u.length;n++)c.push(a[n]&&!u[n]);return c}case 48:{let a=i.args[0],u=e.getInstruction(a),c=n-a;return r[u.args[c]]}case 15:case 17:case 16:case 18:case 12:case 13:case 26:case 28:case 27:case 29:case 25:case 32:case 31:case 37:case 42:case 21:case 22:case 19:case 20:case 23:case 24:case 47:case 44:case 49:{let a=t[n],u=[];for(let c of a)u.push(!c);return u}default:let o=i;throw new Error(`Unexpected opcode ${o.type}`)}}function PF(e){let t=[];for(let r=0;r<e;r++)t.push(!1);return t}function Uv(e){let t=[];for(let r=0;r<e;r++)t.push(!0);return t}function Yv(e){let t=e.getInstruction(e.getReturnIndex());if(t.type!==48)return e;let r=t.args[0],n=e.getReturnIndex()-r,i=e.getInstruction(r),s=i.args[0],o=i.args[n],a=[],u=[];a.push(s);let c=Hs(e,e.getReturnIndex(),\"Programming error: cannot optimize regression on non-constant-length list\");u.push({min:1,max:c,length:c});let l=!1,p=!1;for(let E=s+1;E<=o;E++){let T=e.getInstruction(E);if(T.type===39||T.type===41||T.type===40){if(T.args[1]!==s)continue;let D=T.args[0];if(e.getInstruction(D).valueType!==te||!Vt(e.getInstruction(D)))continue;let S=Zt(e,D),O=EF(S);if(!isFinite(O.min)||!isFinite(O.max))continue;a.push(E),u.push(O)}else qv(T)?l=!0:(T.type===12||T.type===13)&&(p=!0)}if(a.length===0||!p&&!l)return e;let f=[],y=[];for(let E=0;E<e.argNames.length;E++)y.push(E),f.push(Os());let h=[],m=[];for(let E=0;E<=o;E++)h.push(lT(e,y,h,E)),m.push(lT(e,a,m,E));for(let E=0;E<=o;E++){let T=e.getInstruction(E);if(T.type===33){let D=h[E];for(let S=0;S<D.length;S++)D[S]&&(f[S]=gn())}else if(T.type===12||T.type===13){let D=!1,S=!1;for(let re=0;re<a.length;re++)m[T.args[0]][re]&&(D=!0),m[T.args[1]][re]&&(S=!0);if(D||!S)continue;let O=h[T.args[0]],A=0,_;for(let re=0;re<O.length;re++)O[re]&&(_=re,A+=1);if(A!==1||_===void 0)continue;let L=y[_],H=fi(e.copy().reopenFinalBlock(),L,{allowRestriction:!1,allowClosedBlockReferences:!1});if(Ir(H,T.args[0])!==1)continue;let w=ds(H),[q,$]=wr(w,T.args[0]);if($===void 0)continue;let F=Zt(w.newChunk,$),Z=Zt(w.newChunk,q);f[_]=Cn(f[_],rc(Z,F))}}if(l){let E=e.copy().reopenFinalBlock();for(let T=0;T<a.length;T++){let D=fi(E,a[T],{allowRestriction:!1,allowClosedBlockReferences:!1}),S=ds(D);for(let O=s+1;O<=o;O++){let A=E.getInstruction(O);if(qv(A)){let _=A.args[0];if(Ir(D,_)!==1)continue;let L=wr(S,_)[1];if(L===void 0)continue;let H=IF(S.newChunk,L),w,q=0;for(let me=0;me<H.length;me++)H[me]&&(w=me,q+=1);if(q!==1||w===void 0)continue;let $=fi(S.newChunk,w,{allowRestriction:!1,allowClosedBlockReferences:!1});if(Ir($,L)!==1)continue;let F=ds($),[Z,re]=wr(F,L);if(re===void 0||!Vt(F.newChunk.getInstruction(Z))||!Vt(F.newChunk.getInstruction(re)))continue;let Ee=Zt(F.newChunk,Z),K=Zt(F.newChunk,re),fe=(u[T].max-u[T].min)/Math.min(u[T].length-1,31),at=Math.PI/fe;if(!isFinite(at)||at<=0)continue;f[w]=Cn(f[w],rc(Ee,K)),f[w]=Cn(f[w],rc(at-Ee,-K))}}}}let b=!1;for(let E of f){if(E.type!==\"known\")return e;(E.bounds[0]!==-1/0||E.bounds[1]!==1/0)&&(b=!0)}if(!b)return e;let d=e.copy(),g=e.getReturnIndex(),x=d.Constant(1),M=d.Constant(NaN);for(let E=0;E<d.argNames.length;E++)g=TF(d,f[E],g,E,x,M);return d.close(),d}function TF(e,t,r,n,i,s){if(t.type!==\"known\"||t.bounds[0]===-1/0&&t.bounds[1]===1/0)return r;let o=e.And([e.LessEqual([e.Constant(t.bounds[0]),n]),e.LessEqual([n,e.Constant(t.bounds[1])])]);return e.Multiply([r,e.Piecewise([o,i,s])])}function IF(e,t){let r=[];for(let i=0;i<e.argNames.length;i++)r.push(i);let n=[];for(let i=0;i<=t;i++)n.push(lT(e,r,n,i));return n[t]}function qv(e){return e.type===37&&(e.symbol===\"sin\"||e.symbol===\"cos\")}function EF(e){var t=1/0,r=-1/0,n=e.length;for(let i of e)t=Math.min(t,i),r=Math.max(r,i);return{min:t,max:r,length:n}}function lT(e,t,r,n){let i=e.getInstruction(n),s=MF(t.length);for(let o=0;o<t.length;o++)if(t[o]===n)return s[o]=!0,s;if(De(i))return s;for(let o of i.args){let a=r[o];for(let u=0;u<a.length;u++)s[u]=s[u]||a[u]}return s}function MF(e){let t=[];for(let r=0;r<e;r++)t.push(!1);return t}function Xv(e){let t=e.getInstruction(e.getReturnIndex());if(De(t))return e.getReturnIndex();let r=SP(e,t),n=r.expectedTypes,i=pT(e,t.args,[n]);if(r.isReducerWithNoListArgs){let s=DF(e,i.didCoerce?i.args:t.args),o=Tn(r.expectedTypes.rest);if(Ss(s,o)){i.didCoerce||e.popInstruction();let a=e.List(t.args);return e.copyInstructionWithArgs(t,[a])}}else i.didCoerce&&e.copyInstructionWithArgs(t,i.args);return e.getReturnIndex()}function pT(e,t,r){let n=!1,i=[];for(let s=0;s<t.length;s++){let o=Nm(r,s),a=t[s],u=e.getInstruction(a).valueType,c=a;o.every(l=>!Ss(u,l))&&ie(o[0],P)&&(c=ku(e,a)),c!==a&&(n=!0),i.push(c)}return n?{didCoerce:n,args:i}:{didCoerce:!1}}function ku(e,t){let r=e.getInstruction(t);return r.valueType===Le?t:ie(r.valueType,Ae)?Zv(e,t):ie(r.valueType,xe)?$v(e,t):t}function DF(e,t){let r=e.getInstruction(t[0]).valueType;if(!Fi(r))return Bt;for(let n of t)if(e.getInstruction(n).valueType!==r)return Bt;return Tn(r)}function gs(e){var t=e;if(t&&typeof t.toJSON==\"function\"&&(t=t.toJSON()),!t||typeof t!=\"object\")return t;if(Array.isArray(t))return t.map(gs);var r={};for(var n in t)t.hasOwnProperty(n)&&(r[n]=gs(t[n]));return r}function Wv(e,t){let r=[],n=[],i=[];for(let o=0;o<e.argNames.length;o++)t.hasOwnProperty(e.argNames[o])||(r.push(e.argNames[o]),n.push(e.argTypes[o]));let s=new So({argNames:r,argTypes:n});for(let o=0,a=0;o<e.argNames.length;o++)t.hasOwnProperty(e.argNames[o])?i[o]=s.ConstantOfType(e.argTypes[o],t[e.argNames[o]]):(i[o]=a,a+=1);for(let o=e.argNames.length;o<e.instructionsLength();o++){let a=e.getInstruction(o);if(De(a))i.push(fs(s,a));else{let u=[];for(let c of a.args)u.push(i[c]);i.push(mr(s,a,u))}}return s}function qa(e,t){if(t.type!==33)return!1;let r=e.getInstruction(t.args[2]);return r.type===1&&r.valueType===P&&isNaN(Y(r.value))||qa(e,r)&&jv(e,t.args[1])&&jv(e,r.args[1])}function fT(e,t){let r=[];for(;t.type===33;)r.push(t.args[0]),t=e.getInstruction(t.args[2]);return r}function ty(e,t){return e.getInstruction(t).type===25}function Jv(e,t){let r=e.getInstruction(t);if(r.type!==25)return;let n=r.args[0],i=r.args[1],s=e.getInstruction(n),o=e.getInstruction(i);return s.type===2&&(Vt(o)||fP(o))&&ie(o.valueType,P)?{type:\"constant\",variable:e.argNames[n],index:i}:ie(s.valueType,P)&&ie(o.valueType,P)?{type:\"implicit\",index:e.Subtract([n,i])}:void 0}function jv(e,t){let r=e.getInstruction(t);return r.type===1&&r.valueType===P&&Y(r.value)===1}var dT=class{constructor(t,r,n,i){this.openChunk=t;this.returnIndex=r;this.restrictionIndex=n;this.slices=i}getSliceVariablesOrImplicit(){return this.slices.map(t=>t.type===\"constant\"?t.variable:\"_implicit\")}getValueAndRestrictionChunk(){let t=[];for(let i of this.slices)if(i.type===\"constant\"){let s=this.openChunk.getInstruction(i.index);if(Vt(s)&&s.valueType===P)t.push({type:\"constant\",variable:i.variable,value:Y(s.value)});else throw us()}else if(this.openChunk.getInstruction(i.index).valueType===P){let o=this.openChunk.copy();o.setReturnIndex(i.index),o.close(),t.push({type:\"implicit\",sliceChunk:o})}else throw us();let r=this.openChunk.copy();r.setReturnIndex(this.returnIndex),r.close();let n;return this.restrictionIndex!==void 0&&(n=this.openChunk.copy(),n.setReturnIndex(this.restrictionIndex),n.close()),{valueChunk:r,restrictionChunk:n,slices:t}}};function No(e,t,r){var c,l;let n=new So({argNames:e.argNames,argTypes:e.argTypes}),i={produceNumbers:(c=r==null?void 0:r.produceNumbers)!=null?c:!1,allowSlices:(l=r==null?void 0:r.allowSlices)!=null?l:!1},s=i.produceNumbers?n.Constant(1/0):n.ConstantOfType(he,!0),o=SF(e);NF(e,o,t);let a=ee(W({},i),{chunk:e,newChunk:n,peelable:o,oldIPtoNewIP:[],oldIPToRestriction:[],startTrue:s,slices:[]});Qv(a,0,e.instructionsLength()-1);let u=a.oldIPToRestriction[e.getReturnIndex()];return new dT(a.newChunk,a.oldIPtoNewIP[e.getReturnIndex()],s===u?void 0:u,a.slices)}function Qv(e,t,r){let{chunk:n,newChunk:i,peelable:s,oldIPtoNewIP:o,oldIPToRestriction:a}=e;for(let u=t;u<=r;u++){let c=n.getInstruction(u);if(s[u]&&(c.type===19||c.type===23))u=OF(e,u);else if(c.type===2)o[u]=u,a[u]=e.startTrue;else if(De(c))o[u]=i.copyInstruction(c),a[u]=e.startTrue;else if(s[u]&&qa(n,c)){o[u]=o[c.args[1]];let l=AF(e,c);a[u]=mT(e,c.args.map(p=>a[p]).concat(l))}else o[u]=i.copyInstructionWithArgs(c,c.args.map(l=>o[l])),a[u]=mT(e,c.args.map(l=>a[l]))}}function mT(e,t){let n=[...new Set(t)].filter(i=>!Kv(e,i));return n.length?yT(e,n).reduce((i,s)=>e.produceNumbers?e.newChunk.SyntheticNativeFunction(\"min\",[i,s]):e.newChunk.And([i,s])):e.startTrue}function vF(e,t){let r=[...new Set(t)];return r.some(n=>!Kv(e,n))?yT(e,r).reduce((n,i)=>e.produceNumbers?e.newChunk.SyntheticNativeFunction(\"max\",[n,i]):e.newChunk.Or([n,i])):e.startTrue}function yT(e,t){if(!e.produceNumbers)return t;let r=e.newChunk;return t.map(n=>{let i=r.getInstruction(n);if(i.valueType!==he)return n;switch(i.type){case 27:case 29:return r.Subtract([i.args[0],i.args[1]]);case 26:case 28:return r.Subtract([i.args[1],i.args[0]]);case 25:throw ne(\"convertBoolsToNums on an equality.\");case 32:return r.SyntheticNativeFunction(\"min\",yT(e,i.args));case 1:return r.Constant(i.value?1/0:-1/0);default:throw ne(\"convertBoolsToNums on a non-opcode condition.\")}})}function Kv({newChunk:e},t){let r=e.getInstruction(t);return r.type===1&&(r.valueType===P&&r.value===1/0||r.valueType===he&&r.value)}function OF(e,t){let{chunk:r,newChunk:n,oldIPtoNewIP:i,oldIPToRestriction:s,startTrue:o}=e,a=r.getInstruction(t),u=a.endIndex,c=r.getInstruction(u),l,p;if(a.type===23)i[t]=n.copyInstructionWithArgs(a,[i[a.args[0]]]),s[t]=o,p=t+1;else{let m=a.args.map(b=>i[b]);m.push(o),i[t]=n.copyInstructionWithArgs(a,m),s[t]=o;for(let b=2;b<a.args.length;b++){let d=t+b-1;i[d]=n.copyInstructionWithArgs(r.getInstruction(d),[i[t]]),s[d]=o}l=n.BlockVar(e.produceNumbers?P:he,[i[t]]),p=t+a.args.length-1}Qv(e,p,u-1);let f=c.args.map(m=>i[m]),y=e.slices.filter(m=>p<=m.index&&m.index<u),h=l;if(a.type===19){if(l===void 0)throw new Error(\"Expected restrictionAccumVar to be defined\");h=mT(e,[l,s[c.args[1]]]),f.push(h)}else{f.push(s[c.args[1]]);for(let m of y)f.push(m.index)}i[u]=n.copyInstructionWithArgs(c,f),s[u]=o;for(let m=1;m<c.args.length;m++)i[u+m]=n.copyInstructionWithArgs(r.getInstruction(u+m),[i[u]]);if(a.type===23){let m=n.BroadcastResult(e.produceNumbers?P:he,[i[u]]);for(let b of y)b.index=n.BroadcastResult(P,[i[u]]);for(let b=1;b<c.args.length;b++)s[u+b]=m}else{let m=n.BlockVar(e.produceNumbers?P:he,[i[u]]);l===h&&(m=o);for(let b=1;b<c.args.length;b++)s[u+b]=m}return u+c.args.length-1}function SF(e){let t=[];for(let n=0;n<e.instructionsLength();n++)t.push(!1);t[e.getReturnIndex()]=!0;let r=e.instructionsLength()-1;for(let n=r;n>=0;n--){if(!t[n])continue;let i=e.getInstruction(n);if(!De(i))for(let s of RF(e,i))t[s]=!0}return t}function RF(e,t){switch(t.type){case 14:case 8:case 9:case 26:case 28:case 27:case 29:case 10:case 11:case 12:case 13:case 25:case 32:case 15:case 16:case 38:case 47:case 19:case 39:case 40:case 41:case 23:case 24:case 48:return t.args;case 33:return qa(e,t)?fT(e,t).concat([t.args[1]]):[];case 37:{let n=Pr[t.symbol];return n.noPeel?[]:n.tag===\"reducer\"||n.tag===\"doubleReducer\"||n.tag===\"never-broadcast\"||n.tag===\"parameterizedReducer\"?t.args.filter(i=>e.getInstruction(i).type!==48):t.args}case 20:return t.args.slice(1);case 31:return[];case 17:case 18:case 42:case 21:case 22:case 44:case 49:return[];default:let r=t;throw new Error(`Unexpected opcode ${r.type}`)}}function NF(e,t,r){let n=[];for(let i=0;i<e.argNames.length;i++){let s=e.argNames[i];r.indexOf(s)<0&&n.push(i)}for(let i of n){let s=_a(e,i);for(let o=0;o<e.instructionsLength();o++)t[i]&&(t[i]=!s[o])}}function AF(e,t){let r=fT(e.chunk,t).map(n=>e.oldIPtoNewIP[n]);if(e.allowSlices&&r.length===1){let n=Jv(e.newChunk,r[0]);if(n)return e.slices.push(n),e.startTrue}if(r.some(n=>ty(e.newChunk,n)))throw us();return vF(e,r)}var So=class e{constructor(t){this.derivativeMaps={};if(this.instructions=[],this.blockMask=[],this.comments=[],t.argNames.length!==t.argTypes.length)throw new Error(\"Programming Error: length of argNames must match length of argTypes\");this.argNames=t.argNames,this.argTypes=t.argTypes;for(let r=0;r<this.argTypes.length;r++){let n=this.argTypes[r];this.LoadArg(n)}this.returnIndex=this.Constant(NaN)}setError(t){this.error=t}getError(){return this.error}getReturnIndex(){return this.returnIndex}setReturnIndex(t){if(!(0<=t&&t<this.instructions.length))throw new Error(`Programming Error: out of bounds return index ${t}`);this.returnIndex=t}addComments(t){for(let r in t){let n=this.comments[r]||\"\";this.comments[r]=n+t[r]}return this}instructionsLength(){return this.instructions.length}getInstruction(t){return this.instructions[t]}popInstruction(){this.truncate(this.instructions.length-1)}truncate(t){this.instructions.length=Math.min(t,this.instructions.length),this.blockMask.length=Math.min(t,this.blockMask.length),this.comments.length=Math.min(t,this.comments.length);for(let r in this.derivativeMaps)+r>=t?delete this.derivativeMaps[r]:zv(this.derivativeMaps[r],t);this.setReturnIndex(this.instructions.length-1)}pushInstructionChecked(t){if(this.instructions.length>=32768)throw dh();this.instructions.push(t),this.setReturnIndex(this.instructions.length-1)}pushLeafInstruction(t){return this.pushInstructionChecked(t),this.getReturnIndex()}pushInstruction(t){return this.checkInstructionArguments(t),this.pushInstructionChecked(t),this.setReturnIndex(DD(this)),this.setReturnIndex(RD(this)),this.setReturnIndex(Xv(this)),uD(this,this.getReturnIndex()),this.returnIndex===this.instructions.length-1&&this.setReturnIndex(nD(this)),this.getReturnIndex()}checkInstructionArguments(t){for(let r of t.args)if(this.blockMask[r])throw new Error(\"Programming Error: cannot reference an instruction in a closed block\")}markClosedBlock(t,r){for(let n=t;n<r;n++)this.blockMask[n]=!0}LoadArg(t){return this.pushLeafInstruction({type:2,valueType:t})}BlockVar(t,r){return this.pushInstruction({type:47,valueType:t,args:r})}SymbolicVar(t,r){return this.pushLeafInstruction({type:3,valueType:t,symbol:r})}BroadcastResult(t,r){let n=r[0],i=this.instructions[n],s=i.args[0],o=this.instructions.length-n,a=i.args[o],u=!Im(this,a,s),l=this.getInstruction(s).args[0],p=this.getInstruction(l);return this.pushInstruction({type:48,valueType:t,args:r,isConstantBroadcast:u,constantLength:Vt(p)?Zt(this,l):void 0})}Constant(t){return this.ConstantOfType(P,t)}ConstantOfType(t,r){if(typeof r==\"number\"&&(r=Ce(r,1)),j(t)&&r.length>1e4)throw vl();return this.pushLeafInstruction({type:1,valueType:t,value:r})}NanOfType(t){if(t===Ke){let r=this.Constant(NaN);return this.Distribution(\"uniformdist\",[r,r])}else return this.ConstantOfType(t,qi(t))}Add(t){let r=8,n=Wt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Subtract(t){let r=9,n=Wt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Multiply(t){let r=10,n=Wt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Divide(t){let r=11,n=Wt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Exponent(t){let r=12,n=Wt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}RawExponent(t){let r=13,n=Wt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Negative(t){let r=14,n=Wt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Equal(t){let r=25,n=Wt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Less(t){let r=26,n=Wt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Greater(t){let r=27,n=Wt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}LessEqual(t){let r=28,n=Wt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}GreaterEqual(t){let r=29,n=Wt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Or(t){let r=31,n=Wt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}And(t){let r=32,n=Wt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Piecewise(t){let r=33,n=Wt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}OrderedPair(t){let r=15,n=Wt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}OrderedPairAccess(t){let r=17,n=Wt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}OrderedTriple(t){let r=16,n=Wt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}OrderedTripleAccess(t){let r=18,n=Wt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}List(t){let r=38,n=Wt(this,r,t);if(t.length>1e4)throw vl();return this.pushInstruction({type:r,valueType:n,args:t})}ListAccess(t){let r=39,n=Wt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}DeferredListAccess(t){let r=40,n=Wt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}InboundsListAccess(t){let r=41,n=Wt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}NativeFunction(t,r,n){let i=37,s=Pr[t].returnType,o=typeof s==\"function\"?s(n.map(a=>this.getInstruction(a).valueType)):s;return this.pushInstruction({type:i,valueType:o,args:n,symbol:t,callData:r})}SyntheticNativeFunction(t,r){let n=37,i=Pr[t].returnType,s=typeof i==\"function\"?i(r.map(a=>this.getInstruction(a).valueType)):i,o={errorSymbol:t,providedArity:r.length,isDotCall:!1};return this.pushInstruction({type:n,valueType:s,args:r,symbol:t,callData:o})}Distribution(t,r){let n=42,i=Ke;return this.pushInstruction({type:n,valueType:i,args:r,symbol:t})}BeginIntegral(t,r){let n=21,i=Wt(this,n,[]);return this.pushInstruction({type:n,valueType:i,args:r,endIndex:-1,callData:t})}EndIntegral(t){let r=22,n=Wt(this,r,t),i=t[0],s=this.getInstruction(i);this.instructions[i]={type:s.type,valueType:s.valueType,args:s.args,endIndex:this.instructionsLength(),callData:s.callData};let o=this.pushInstruction({type:r,valueType:n,args:t});return this.markClosedBlock(i,o),o}BeginBroadcast(t,r){let n=23,i=Wt(this,n,[]),s=this.getInstruction(t[0]);if(Vt(s)&&Zt(this,t[0])>1e4)throw vl();return this.pushInstruction({type:n,valueType:i,endIndex:-1,args:t,listComprehensionCallData:r})}EndBroadcast(t){let r=24,n=Wt(this,r,t),i=t[0],s=this.getInstruction(i),o={type:s.type,valueType:s.valueType,args:s.args,endIndex:this.instructionsLength()};this.instructions[i]=o;let a=this.pushInstruction({type:r,valueType:n,args:t});return this.markClosedBlock(i,a),a}BeginLoop(t,r){let n=19,i=Wt(this,n,r);return this.pushInstruction({type:n,valueType:i,args:r,endIndex:-1,callData:t})}EndLoop(t){let r=20,n=Wt(this,r,t),i=t[0],s=this.getInstruction(i);this.instructions[i]={type:s.type,valueType:s.valueType,args:s.args,endIndex:this.instructionsLength(),callData:s.callData};let o=this.pushInstruction({type:r,valueType:n,args:t});return this.markClosedBlock(i,o),o}ExtendSeed(t,r){let n=44,i=Qe;return this.pushInstruction({type:n,valueType:i,args:r,tag:t})}Noop(){let t=0,r=Tt;return this.pushLeafInstruction({type:t,valueType:r})}Action(t,r){return this.pushInstruction({type:49,valueType:Je,args:r,symbols:t})}replaceInstructionWithConstant(t,r){this.instructions[t]=r,this.blockMask[t]=void 0}replaceInstructionWithBlockVar(t,r){this.instructions[t]=r}reopenFinalBlock(){let t=this.getInstruction(this.getReturnIndex());if(t.type!==48)return this;let r=t.args[0],i=this.getInstruction(r).args[0];for(let s=i;s<r;s++)this.blockMask[s]=void 0;return this.truncate(r),this}reopenAllBlocks(){this.blockMask=[]}isInClosedBlock(t){return!!this.blockMask[t]}copy(){let t=new e({argNames:this.argNames,argTypes:this.argTypes});return t.instructions=this.instructions.slice(),t.blockMask=this.blockMask.slice(),t.comments=this.comments.slice(),t.derivativeMaps=gs(this.derivativeMaps),t.setReturnIndex(this.getReturnIndex()),t}close(){return this.setReturnIndex(Br(this,this.getReturnIndex())),MD(this),this}copyInstruction(t){return fs(this,t)}copyInstructionWithArgs(t,r){return mr(this,t,r)}replaceInstructionWithNoop(t){this.instructions[t]={type:0,valueType:Tt}}getReturnType(){return this.instructions[this.getReturnIndex()].valueType}isConstant(){return Vt(this.instructions[this.getReturnIndex()])}asValue(){return Zt(this,this.getReturnIndex())}asCompilerValue(){let t=this.instructions[this.getReturnIndex()];switch(t.type){case 1:return t.value;default:throw new Error(`Unexpected opcode ${t.type}.`)}}getConstantListLength(){return lr(this,this.getReturnIndex())}getListLengthDependencies(){let t=this.copy(),r=bn(t,t.getReturnIndex());return Mn(t,r)}elementAt(t){let r=this.copy(),n=r.getReturnIndex();return r.setReturnIndex(pp(r,n,t)),r.close(),r}substituteConstantArguments(t){return Wv(this,t)}interpretWithParameters(t){return jM(this,this.getReturnIndex(),t)}getCompiledFunction(t){let r;if(t){r=t.slice();for(let s of this.argNames)r.indexOf(s)===-1&&r.push(s)}else r=this.argNames;let{source:n,constants:i}=hD(this);return{args:r,source:n,constants:i,fn:uP(r,n,i)}}getRestrictedFunctionForGLSL(t){let r=No(this,t,{allowSlices:!0}),{restrictionChunk:n,valueChunk:i}=r.getValueAndRestrictionChunk(),s;if(n!==void 0)try{s=Oo(n)}catch(o){}return s===void 0&&r.getSliceVariablesOrImplicit().length==0?{concrete:new sr(this),restriction:void 0}:{concrete:new sr(i),restriction:s}}getCapFunction(t){let{restrictionChunk:r,valueChunk:n}=No(this,t,{produceNumbers:!0}).getValueAndRestrictionChunk();if(r!==void 0)return{concrete:new sr(r),restriction:Oo(n)}}polynomialOrder(t,r){return OD(this,t,r)}getPolynomialCoefficients(t){return SD(this,t)}takeDerivative(t){let r=this.argNames.indexOf(t);return r===-1?this.Constant(0):this.setReturnIndex(Uc(this,this.getReturnIndex(),r)),this}gradient(t){let r=[],n=this.getReturnIndex();for(let i of t){let s=this.argNames.indexOf(i);s===-1?r.push(this.Constant(0)):r.push(Uc(this,n,s))}return this.List(r),this}deriveRegressionRestrictions(){return Yv(this)}boundDomain(t){return Hv(this,t,this.getReturnIndex())}findLinearSubset(t){let r=kv(this),n=[];for(let i of t){let s=this.argNames.indexOf(i);if(s===-1)throw new Error(\"Programming Error: findLinearSubset called with a non-dependency\");n.push(r[s])}return n}print(){return YM(this)}printInstruction(t){return wu(this,t)}toDot(){return vD(this)}getLiveArgNames(){let t=[];for(let r=0;r<this.argNames.length;r++)this.instructions[r].type===2&&t.push(this.argNames[r]);return t}getCursorContext(){return this.cursorContext}setCursorContext(t){this.cursorContext=t}};var Ao={normaldist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"normalpdf\",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"normalcdf\",r.concat(n.args))},mean:function(e,t,r){return e.getInstruction(t).args[0]},median:function(e,t,r){return Ao.normaldist.mean(e,t,r)},stdev:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"abs\",[n.args[1]])},var:function(e,t,r){let n=e.getInstruction(t);return e.Multiply([n.args[1],n.args[1]])},quantile:function(e,t,r){let n=e.getInstruction(t);return e.Add([e.Multiply([e.SyntheticNativeFunction(\"invNorm\",r),e.SyntheticNativeFunction(\"abs\",[n.args[1]])]),n.args[0]])},random:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"normalSample\",[r[0],n.args[0],n.args[1]])}},tdist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"tpdf\",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"tcdf\",r.concat(n.args))},mean:function(e,t,r){return e.Constant(0)},median:function(e,t,r){return e.Constant(0)},stdev:function(e,t,r){return e.SyntheticNativeFunction(\"sqrt\",[Ao.tdist.var(e,t,r)])},var:function(e,t,r){let n=e.getInstruction(t),i=e.Constant(2),s=n.args[0];return e.Piecewise([e.GreaterEqual([s,i]),e.Divide([s,e.Subtract([s,i])]),e.Constant(NaN)])},quantile:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"invT\",[r[0],n.args[0]])},random:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"tSample\",[r[0],n.args[0]])}},poissondist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"poissonpdf\",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"poissoncdf\",r.concat(n.args))},mean:function(e,t,r){return e.getInstruction(t).args[0]},median:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"invPoisson\",[e.Constant(.5),n.args[0]])},stdev:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"sqrt\",[n.args[0]])},var:function(e,t,r){return Ao.poissondist.mean(e,t,r)},quantile:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"invPoisson\",[r[0],n.args[0]])},random:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"poissonSample\",[r[0],n.args[0]])}},binomialdist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"binompdf\",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"binomcdf\",r.concat(n.args))},mean:function(e,t,r){let n=e.getInstruction(t);return e.Multiply([n.args[0],n.args[1]])},median:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"invBinom\",[e.Constant(.5),n.args[0],n.args[1]])},stdev:function(e,t,r){return e.SyntheticNativeFunction(\"sqrt\",[Ao.binomialdist.var(e,t,r)])},var:function(e,t,r){let n=e.getInstruction(t),[i,s]=n.args;return e.Multiply([i,e.Multiply([s,e.Subtract([e.Constant(1),s])])])},quantile:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"invBinom\",[r[0],n.args[0],n.args[1]])},random:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"binomSample\",[r[0],n.args[0],n.args[1]])}},uniformdist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"uniformpdf\",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"uniformcdf\",r.concat(n.args))},mean:function(e,t,r){let n=e.getInstruction(t);return e.Divide([e.Add([n.args[0],n.args[1]]),e.Constant(2)])},median:function(e,t,r){return Ao.uniformdist.mean(e,t,r)},stdev:function(e,t,r){return e.SyntheticNativeFunction(\"sqrt\",[Ao.uniformdist.var(e,t,r)])},var:function(e,t,r){let n=e.getInstruction(t),i=e.Subtract([n.args[1],n.args[0]]);return e.Divide([e.Multiply([i,i]),e.Constant(12)])},quantile:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"invUniform\",[r[0],n.args[0],n.args[1]])},random:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction(\"uniformSample\",[r[0],n.args[0],n.args[1]])}}};function eO(e,t,r){let n=r[0],i=e.Constant(0),s=e.Constant(1);if(lr(e,t)===0)return e.Constant(NaN);let a=bn(e,t);return e.InboundsListAccess([t,e.Add([e.SyntheticNativeFunction(\"floor\",[e.Multiply([e.SyntheticNativeFunction(\"uniformSample\",[n,i,s]),a])]),s])])}function ry(e,t,r){if(t===r)return!0;if(t<r)return!1;let n=[!0];for(let s=r+1;s<=t;s++)n.push(!1);let i=[t];for(;i.length;){let s=i.pop();if(n[s-r])continue;n[s-r]=!0;let o=e.getInstruction(s);if(!De(o))for(let a of o.args){if(a===r)return!0;a<r||n[a-r]||i.push(a)}}return!1}var ua;function tO(e){ua=e}function rO(){ua&&(ua.cacheHits+=1)}function nO(){ua&&(ua.cacheMisses+=1)}function iO(){ua&&(ua.cacheWrites+=1)}function sO(){ua&&(ua.cacheReads+=1)}function uO(e,t,r,n,i){let s=ie(r,de)||ie(r,ue),o=ie(i,de)||ie(i,ue);if(!s&&!o)return;let a=aO(e,t,r),u=aO(e,n,i),c=a.filter(l=>u.some(p=>gT(l,p))&&!!e.lookup(l[0]));for(let l of a)oO(e,l,n)&&c.every(p=>!gT(l,p))&&c.push(l);for(let l of u)oO(e,l,t)&&c.every(p=>!gT(l,p))&&c.push(l);if(c.length===1)return c[0]}function gT(e,t){return e[0]===t[0]&&e[1]===t[1]}function oO(e,[t,r],n){let i=e.lookup(t),s=i&&e.getGeometryTree(i);return((s==null?void 0:s.symbol)===\"glider\"||(s==null?void 0:s.symbol)===\"intersection\"||(s==null?void 0:s.symbol)===\"strictintersection\"||(s==null?void 0:s.symbol)===\"midpoint\")&&(s==null?void 0:s.parents.some(o=>o&&e.resolvesTo(o[0],n)&&(r===void 0||o[1]===void 0||o[1]===r)))}function aO(e,t,r){var s;let n=[],i=((s=e.getGeometryTree(t))==null?void 0:s.parents)||[];for(let o=0;o<i.length;o++){let a=i[o];if(ie(r,de)&&o===0||!a)continue;let u=e.lookup(a[0]);u&&e.isPointOrListOfPoints(u)&&n.push(a)}return n}function hT(e,t,r){if(!t)return;let n=cO(t,r._expression);n===\"start-to-end\"?e.setCursorContext({type:r.type===\"Assignment\"?\"assignment-rhs\":\"function-definition-body\",allowedTypes:[Tt]}):n===\"empty-list\"&&e.setCursorContext({type:\"expression-arguments\",expressionType:\"List\",argIndex:0,argCount:0,isLastValidArg:!1,positionWithinArg:\"start-to-end\",allowedTypesForInsertedArg:[Tt]})}function kc(e,t,r,n,i){let s=CF(e,t,r,n,i);s&&e.setCursorContext(s)}function cO(e,t){let r=t.getInputSpan();return r?e.start===r.start&&e.end===r.end?\"start-to-end\":e.start===e.end&&e.start===r.end?\"end\":e.start===e.end&&e.start===r.start?\"start\":e.start===e.end&&t.type===\"List\"&&t.args.length===0?\"empty-list\":\"not-aligned\":\"not-aligned\"}function bT(e,t){if(!e)return;let r=!1;t instanceof Hi&&t.args[1]instanceof Lr&&(r=!0,t=t.args[1]);let n=t.args;if(n){if(n.length===0){let i=t.getInputSpan();if(!i)return;let s=Gr(i),o=-1;return t.type===\"List\"?o=s.indexOf(\"[\"):(t.type===\"FunctionCall\"||t.type===\"SeededFunctionCall\")&&(o=s.indexOf(\"(\")),o<0?void 0:e.start===i.start+o+1?{argIndex:0,positionWithinArg:\"start-to-end\",isDotCall:r}:void 0}for(let i=0;i<n.length;i++){let s=n[i],o=s.getInputSpan();if((o==null?void 0:o.input)!==e.input)continue;if(e.start<o.start)break;let a=cO(e,s);if(a!==\"not-aligned\")return{argIndex:i,positionWithinArg:a,isDotCall:r}}}}function CF(e,t,r,n,i){if(!r||!n.args)return;let s=bT(r,n);if(s===void 0)return;s.isDotCall&&(n=n.args[1]);let o=s.positionWithinArg===\"end\"?s.argIndex+1:s.argIndex;s.isDotCall&&(o+=1);let a;s.positionWithinArg===\"empty-list\"||s.positionWithinArg===\"start-to-end\"?a=[...i.slice(0,o),void 0,...i.slice(o+1)]:n instanceof Zo?a=o===1?[i[0],void 0,i[1]]:[i[0],i[1],void 0]:a=[...i.slice(0,o),void 0,...i.slice(o)],a=a.map(l=>{if(!(l===void 0||e.getInstruction(l).type===2))return l});let u=RP(e,t,n,a),c=u&&Nm(u,o);if(s.positionWithinArg===\"empty-list\"){let l=c==null?void 0:c.filter(j).map($e);return(l==null?void 0:l.length)===0?void 0:{type:\"expression-arguments\",expressionType:\"List\",argIndex:0,argCount:0,isLastValidArg:!1,positionWithinArg:\"start-to-end\",allowedTypesForInsertedArg:l!=null?l:[Tt]}}else{if((c==null?void 0:c.length)===0)return;let l=!1;if(u){let y=0;for(let h of u){let m=Array.isArray(h)?h.length-1:1/0;y=Math.max(y,m)}l=s.positionWithinArg===\"end\"&&s.argIndex===y-1||s.positionWithinArg===\"start-to-end\"&&s.argIndex===y}let p=n.args.length;if(n instanceof Zo&&n.args.length===3){let y=n.args[2];y instanceof fr&&y.isNaN()&&(p=2)}let f={type:\"expression-arguments\",expressionType:n.type,argIndex:s.argIndex,argCount:p,isLastValidArg:l,positionWithinArg:s.positionWithinArg,allowedTypesForInsertedArg:c!=null?c:[Tt]};if(n instanceof Lr&&(f.functionSymbol=n._symbol,f.isDotCall=s.isDotCall,n instanceof Lr&&n._symbol===\"polygon\")){let y=n.args.filter(h=>!(h instanceof gt&&h._symbol===\"cursor\"));if(y.length>0){let h=y[0].getInputSpan(),m=y[y.length-1].getInputSpan();f.polygonVertices=h&&m?{firstLatex:Gr(h),lastLatex:Gr(m)}:void 0}}return f}}function lO(e){return e.type===\"FunctionDefinition\"}function ny(e){return e.type===\"Identifier\"}function hs(e){return e.type===\"Table\"}function iy(e){return e.type===\"Image\"}function Ys(e){return e.type===\"Error\"}function qc(e){return e.type===\"Regression\"}function _F(e){let t=Yl({},{},-1);for(let r=0;r<e.argNames.length;r++)Mi(t,e.argNames[r],r);return t}function yi(e,t,r,n,i,s,o){return{policy:e,frame:t,chunk:r,scope:n,parentNode:i,substitutionContext:s,selection:o}}function cy(e){let{policy:t,frame:r,argNames:n,argTypes:i,selection:s}=e,o=new So({argNames:n,argTypes:i}),a=_F(o);return yi(t,r,o,a,void 0,{},s)}function Xc(e,t){let{policy:r,frame:n,argNames:i,argTypes:s,selection:o}=e,a=aT(n,t),{freeDependencies:u,updateSymbols:c}=a;if(i||(i=u),!s){s=[];for(let p=0;p<i.length;p++)s.push(P)}let l=cy({policy:r,frame:n,argNames:i,argTypes:s,selection:o});try{Fv(n,t.getScope()),Be(l,t),e.coerceToNumber&&ku(l.chunk,l.chunk.getReturnIndex()),e.wrapInList&&!j(l.chunk.getReturnType())&&l.chunk.List([l.chunk.getReturnIndex()]),l.chunk.close(),wF(l,t,a),LF(l,t,c)}catch(p){let f=p instanceof R?p:ne(p);f.setCursorContext(l.chunk.getCursorContext()),l.chunk.setError(f)}return l.chunk}function LF(e,t,r){if(t.type===\"FunctionDefinition\")for(let i of r){if(t._argSymbols.indexOf(i)!==-1||t._symbol===i)throw Yf(i);if(t._sybmol===i)throw qf(i)}let n=[];for(let i of r)e.frame[i]||n.push(i);if(n.length){let i=IO(e,n[0]).setDependencies(e.chunk.argNames.concat(n));throw e.chunk.isConstant()&&e.chunk.getReturnType()===Je&&i.setActionValue(e.chunk.asValue()),i}}function wF(e,t,{substitutionSymbols:r,substitutionBodyDependencies:n}){if(t.type===\"FunctionDefinition\"){for(let s of r){if(t._argSymbols.indexOf(s)!==-1||t._symbol===s)throw Ul(s);if(t._sybmol===s)throw Id(s)}for(let s of n)if(t._argSymbols.indexOf(s)!==-1||t._symbol===s)throw sx(s)}let i=[];for(let s of r)e.frame[s]||i.push(s);if(i.length){let s=i[0];if(e.policy.substitutionForbidden(s))throw Td(s)}}function Be(e,t){let r;if(sO(),BF(e,t))rO(),r=e.chunk.copyInstruction(t.__IRCache.instruction);else{nO();let n=e.chunk.instructionsLength(),{policy:i,frame:s,chunk:o,scope:a,parentNode:u,substitutionContext:c,selection:l}=e,p=yi(i,s,o,a,t,c,l);if(r=GF(p,t),!xO(t,u)){let f=o.getInstruction(r);f.type===48&&f.isConstantBroadcast&&(r=Br(o,r))}r=FF(e,n,r),VF(e,t,r)}return e.chunk.setReturnIndex(r),r}function FF(e,t,r){let{chunk:n,scope:i}=e;if(r<=t)return r;let s=n.getInstruction(r);return Vt(s)?(n.truncate(Math.max(t,i.maxIndex+1)),fs(n,s)):r}function xO(e,t){if(!t||!e.getScope||!t.getScope)return!1;let r=t.getScope().dependencies,n=e.getScope().dependencies;if(n.length===r.length)return!0;let i=0;for(let o of n)Xe[o]||(i+=1);let s=0;for(let o of r)Xe[o]||(s+=1);return i===s}function VF(e,t,r){let{frame:n,chunk:i,parentNode:s}=e,o=i.getInstruction(r);if(!Vt(o)||xO(t,s))return;let a=wv(n,t);a&&(iO(),t.__IRCache={keys:a,instruction:o})}function BF(e,t){let{frame:r,substitutionContext:n}=e;if(!t.__IRCache)return!1;let i=t.__IRCache.keys;for(let[s,o]of i){let a=r[s];if(a!==o||a&&a.type===\"RegressionParameter\"&&n.body)return!1}return!0}function GF(e,t){var f,y,h,m;let{policy:r,frame:n,chunk:i,scope:s,parentNode:o,substitutionContext:a,selection:u}=e,c=t.type;switch(c){case\"Constant\":{let d=t._constantValue,g=typeof d==\"boolean\"?he:P;return i.ConstantOfType(g,d)}case\"RegressionParameter\":return i.Constant(t._constantNode._constantValue);case\"MixedNumber\":return i.Constant(t._constantValue);case\"Negative\":return i.Negative(xT(e,t,t.args));case\"Add\":return i.Add(Jn(e,t,t.args));case\"Subtract\":return i.Subtract(Jn(e,t,t.args));case\"Multiply\":{let d=Jn(e,t,t.args);if(e.policy.is3dProduct()){let g=i.getInstruction(d[0]).valueType,x=i.getInstruction(d[1]).valueType;if(ie(g,G)&&ie(x,G))throw xl([pe(g),pe(x)]);if(ie(g,N)&&ie(x,N))throw bl([pe(g),pe(x)])}return i.Multiply(d)}case\"DotMultiply\":{let[d,g]=Jn(e,t,t.args);return(y=(f=pO(e,d,g))!=null?f:sa(i,[d,g])?pO(e,Vn(i,d),Vn(i,g),{forcePermitted:!0}):void 0)!=null?y:i.Multiply([d,g])}case\"CrossMultiply\":{let[d,g]=Jn(e,t,t.args);if(!e.policy.is3dPolicy())return i.Multiply([d,g]);if(Ye(i,d,Re)&&Ye(i,g,Re))return Fa(i,[fO(e,Vn(i,d),Vn(i,g)),Us(i,d)]);if(Ye(i,d,G)&&Ye(i,g,G))return fO(e,d,g);if(Ye(i,d,N)&&Ye(i,g,N)||Ye(i,d,P)&&Ye(i,g,G)||Ye(i,d,G)&&Ye(i,g,P)){let x=i.getInstruction(d).valueType,M=i.getInstruction(g).valueType;throw hl([pe(x),pe(M)])}else return i.Multiply([d,g])}case\"Divide\":return i.Divide(Jn(e,t,t.args));case\"Exponent\":return i.Exponent(Jn(e,t,t.args));case\"Comparator['=']\":return i.Equal(Jn(e,t,t.args));case\"Comparator['>']\":return i.Greater(Jn(e,t,t.args));case\"Comparator['<']\":return i.Less(Jn(e,t,t.args));case\"Comparator['>=']\":return i.GreaterEqual(Jn(e,t,t.args));case\"Comparator['<=']\":return i.LessEqual(Jn(e,t,t.args));case\"And\":return i.And(Jn(e,t,t.args));case\"PercentOf\":return i.Divide([i.Multiply(Jn(e,t,t.args)),i.Constant(100)]);case\"ParenSeq\":return qF(e,t);case\"BareSeq\":return YF(e,t);case\"NamedCoordinateAccess\":{let[d]=xT(e,t,t.args),g=t.symbol,x=Ye(i,d,G),M;switch(g){case\"x\":M=i.Constant(1);break;case\"y\":M=i.Constant(2);break;case\"z\":{if(!x)throw In(\".\").allowExport();M=i.Constant(3);break}default:{let E=g;throw new Error(`Programming Error: unexpected named coordinate: '${E}'.`)}}return x?i.OrderedTripleAccess([d,M]):i.OrderedPairAccess([d,M])}case\"Norm\":{let d=xT(e,t,t.args)[0];return(m=(h=TT(e,d))!=null?h:sa(i,[d])?TT(e,Vn(i,d)):void 0)!=null?m:i.SyntheticNativeFunction(\"abs\",[d])}case\"UpdateRule\":{let d=t._symbol;var l=n[d];if(l!==void 0){if(l!==pr&&l.isError)throw l;if(l===pr||l.type!==\"Assignment\"&&l.type!==\"Slider\")throw IO(e,d)}let g=Be(yi(r,n,i,s,o,a,u),t.args[1]);return i.Action([d],[g])}case\"List\":{let d;if(t.getDependencies().length>0)En(t.args),d=i.List(Yc(e,t,t.args));else if(t.args.length===0)kc(i,r,u,t,[]),d=i.ConstantOfType(Le,[]);else{let g=i.instructionsLength(),x=[],M,E;En(t.args);for(let D of t.args){let S=Be(e,D),O=i.getInstruction(S);if(M===void 0){if(M=O.valueType,!Fi(M))throw mu([pe(M)]);E=Tn(M)}else if(O.valueType!==M)throw El();if(O.type!==1)throw new Error(\"Programming error: expected list with no dependencies to constant collapse.\");x.push(O.value),i.truncate(g)}let T=bT(e.selection,t);if(e.selection&&T!==void 0&&E!==void 0&&T.positionWithinArg!==\"empty-list\"){let D=$e(E);i.setCursorContext({type:\"expression-arguments\",expressionType:\"List\",argIndex:T.argIndex,argCount:t.args.length,isLastValidArg:!1,positionWithinArg:T.positionWithinArg,allowedTypesForInsertedArg:[D]})}d=i.ConstantOfType(E,x)}return d}case\"ListAccess\":{let d=Be(e,t.args[0]),g=i.getInstruction(d);if(t.args[1].type===\"Range\"&&t.args[1].args[1].length===0){if(!j(g.valueType))throw Pl([pe(g.valueType),pe(P)]);let x=bn(i,d),M=IT(e,Be(e,t.args[1].args[0]),i.List([x]),{stepMustBePositive:!0});return i.ListAccess([d,M])}else{let x=Be(e,t.args[1]),M=i.getInstruction(x);if(Aa(i,r,t,[d,x]),M.valueType===zr)return i.SyntheticNativeFunction(\"select\",[d,x]);if(M.valueType===he&&j(g.valueType)){let E=i.ConstantOfType(g.valueType,[]);return i.Piecewise([x,d,E])}return i.ListAccess([d,x])}}case\"Range\":{let[d,g]=Jn(e,t,t.args);return IT(e,d,g,{stepMustBePositive:!1})}case\"ListComprehension\":return XF(e,t);case\"Piecewise\":{let d=zF(e,t,t.args),g=i.getInstruction(d[0]),x=i.getInstruction(d[1]),M=i.getInstruction(d[2]),E=Ss(x.valueType,M.valueType)||Ss(M.valueType,x.valueType);if(g.type===1&&g.valueType===he&&E){let T=d[g.value?1:2],D=i.getInstruction(T),S=x.valueType!==Le?x.valueType:M.valueType;return D.valueType===Le&&S!==Le?i.ConstantOfType(S,[]):T}if(!E&&Vt(M)&&M.valueType===P&&Ei(M.value)&&J0(x.valueType)){let T=i.NanOfType(x.valueType);d=[d[0],d[1],T]}return i.Piecewise(d)}case\"Ans\":case\"Identifier\":{let d=t._symbol,g=t._errorSymbol;if(t.type===\"Ans\"&&i.argNames.indexOf(d)!==-1)throw $b();let x=fx(s,d),M=n[d];if(x!==void 0&&(s.symbolMap.hasOwnProperty(d)||M===void 0||M===pr))return x;if(M===void 0){if(Xe[d]){let D=e.policy.is3dPolicy();throw Xe[d].isFunction?ki(g,D):bu(g)}throw new Error(`Programming Error: reached undefined symbol ${d}`)}if(M!==pr&&Ys(M))throw M;if(M===pr||M.isFunction)throw Ch(g);if(a.body&&M.type===\"RegressionParameter\")throw nx(g);let E=yi(r,n,i,s,void 0,a,u),T=Be(E,M);return Mi(s,d,T,M),T}case\"FunctionCall\":case\"SeededFunctionCall\":{En(t.args);let d=Yc(e,t,t.args);return En(d),sy(e,t._symbol,t._errorSymbol,d,t.args)}case\"Substitution\":return QF(e,t);case\"FunctionExponent\":{let d=t.args[0]._symbol,g=n[d];return g!==pr&&(g!=null&&g.isFunction)?Be(e,new I.Exponent([new I.FunctionCall(d,[t.args[1]]),t.args[2]])):Be(e,new I.Multiply([t.args[0],new I.Exponent([t.args[1],t.args[2]])]))}case\"FunctionFactorial\":{let d=t.args[0]._symbol,g=n[d];return g!==pr&&(g!=null&&g.isFunction)?Be(e,new I.FunctionCall(\"\\\\factorial\",[new I.FunctionCall(d,[t.args[1]])])):Be(e,new I.Multiply([t.args[0],new I.FunctionCall(\"\\\\factorial\",[t.args[1]])]))}case\"DotAccess\":{let d=t.args[0],g=t.args[1],x=n[g._symbol];if(d.type===\"Identifier\"&&d._symbol===\"construction\")return KF(e,g);if((g.type===\"Identifier\"||g.type===\"FunctionCall\")&&x!==pr&&(x!=null&&x.isFunction)){let M=g._symbol,E=g._errorSymbol,T=g.type===\"Identifier\"?[d]:[d].concat(g.args),D=Yc(e,t,T);return sy(e,M,E,D,T,{dotLHSIndex:D[0]})}else if(g.type===\"SeededFunctionCall\"){let M=g._symbol,E=g._errorSymbol,T=[g.seed,d].concat(g.args.slice(1)),D=Yc(e,t,T);return sy(e,M,E,D,T,{dotLHSIndex:D[1]})}else throw In(\".\")}case\"Seed\":return i.ConstantOfType(Qe,t._stringValue);case\"ExtendSeed\":return i.ExtendSeed(t.tag,Jn(e,t,t.args));case\"Integral\":{let d=t._differential._symbol,g=Object.create(n);g[d]=qb(d);let x=bo(s),M=yi(r,g,i,x,o,a,u),E=Be(M,t.args[1]),T=Be(M,t.args[2]),D=i.getInstruction(E),S=i.getInstruction(T),O=i.SymbolicVar(P,d),A=bo(s);Mi(A,d,O);let _=Object.create(n);_[d]=pr;let L=Be(yi(r,_,i,A,o,a,u),t.args[3]);if(!ry(i,L,O))return i.Multiply([L,i.Subtract([T,E])]);let H=cp(i,[E,T,L]),w=H!==void 0?i.BeginBroadcast([H]):void 0,q=E;w!==void 0&&j(D.valueType)&&(q=Ca(i,E,w));let $=T;w!==void 0&&j(S.valueType)&&($=Ca(i,T,w));let F=i.getInstruction(L).valueType,Z=j(F)?$e(F):F,re=Z===N?i.BeginBroadcast([i.Constant(2)]):Z===G?i.BeginBroadcast([i.Constant(3)]):void 0,Ee=i.BeginIntegral({indexSymbol:d},[q,$]),K=ka(i,Ee,O,L),fe=i.getInstruction(K);w!==void 0&&j(fe.valueType)&&(K=Ca(i,K,w)),re!==void 0&&(K=Z===N?i.OrderedPairAccess([K,re]):i.OrderedTripleAccess([K,re]));let at=i.EndIntegral([Ee,K]),me=i.BlockVar(P,[at]);if(re!==void 0){let Kt=i.EndBroadcast([re,me]);me=i.BroadcastResult(Z,[Kt]),Br(i,me)}if(w!==void 0){let Kt=i.EndBroadcast([w,me]);return i.BroadcastResult(Tn(Z),[Kt])}else return me}case\"Sum\":case\"Product\":{let d=t._index._symbol,g=t.type===\"Sum\",x=Object.create(n);x[d]=g?Lb(d):wb(d);let M=bo(s),E=yi(r,x,i,M,o,a,u),T=Be(E,t.args[1]);T=ku(E.chunk,T);let D=Be(E,t.args[2]);if(D=ku(E.chunk,D),!Ye(i,T,P)){let ve=Vu(i,[T]);throw g?Ug(ve):Yg(ve)}if(!Ye(i,D,P)){let ve=Vu(i,[D]);throw g?kg(ve):Xg(ve)}let S=i.SyntheticNativeFunction(\"round\",[T]),O=i.SyntheticNativeFunction(\"round\",[D]),A=i.getInstruction(S),_=i.getInstruction(O);if(A.type===1&&A.valueType===P&&!isFinite(Y(A.value)))throw g?Uf():kf();if(_.type===1&&_.valueType===P&&!isFinite(Y(_.value)))throw g?Uf():kf();let L=i.SymbolicVar(P,d),H=bo(s);Mi(H,d,L);let w=Object.create(n);w[d]=pr;let q=Be(yi(r,w,i,H,o,a,u),t.args[3]),$=i.getInstruction(q).valueType,F=j($)?$e($):$,re=(t.type===\"Sum\"?ng:[P]).find(ve=>uo(F,ve));if(re===void 0){let ve=Vu(i,[q]);throw g?qg(ve):$g(ve)}if(!ry(i,q,L)){let ve=i.Add([i.Subtract([O,S]),i.Constant(1)]);ve=i.SyntheticNativeFunction(\"max\",[ve,i.Constant(0)]);let hr=g?i.Multiply([q,ve]):i.Exponent([q,ve]);return i.Piecewise([i.Less([ve,i.Constant(1/0)]),hr,i.NanOfType(re)])}let Ee=cp(i,[S,O,q]);if(Ee!==void 0&&ry(i,Ee,L))throw g?ex(d):tx(d);let K=Ee!==void 0?i.BeginBroadcast([Ee]):void 0,fe=S;K!==void 0&&j(A.valueType)&&(fe=Ca(i,S,K));let at=O;K!=null&&j(_.valueType)&&(at=Ca(i,O,K));let me=i.Constant(g?0:1),Kt=re===N?i.OrderedPair([me,me]):re===G?i.OrderedTriple([me,me,me]):me,Ge=i.BeginLoop({type:g?\"sum\":\"product\",indexSymbol:d},[fe,at,Kt]),Ze=i.BlockVar(re,[Ge]),U=ka(i,Ge,L,q),z=i.getInstruction(U);K!==void 0&&j(z.valueType)&&(U=Ca(i,U,K));let Me=g?i.Add([Ze,U]):i.Multiply([Ze,U]),ae=i.EndLoop([Ge,Me]),be=i.BlockVar(re,[ae]);if(K!==void 0){let ve=i.EndBroadcast([K,be]);return i.BroadcastResult(Tn(re),[ve])}else return be}case\"Derivative\":{let d=t._symbol,g=Be(e,new I.Identifier(d));if(!Ye(i,g,P))throw Qg(d,Vu(i,[g]));let x=i.getInstruction(g),M,E,T=!1;if((x.type===2||x.type===3)&&x.valueType===P)M=e,E=g;else{let A=bo(s);E=i.SymbolicVar(x.valueType),Mi(A,d,E),T=!0;let _=Object.create(n);_[d]=pr,M=yi(r,_,i,A,o,a,u)}let D=1;for(;t.args[0].type===\"Derivative\"&&t.args[0]._symbol===t._symbol;)D+=1,t=t.args[0];let O=Br(i,Be(M,t.args[0]));for(let A=0;A<D;A++)O=Uc(i,O,E);return E===g?O:(T&&delete i.derivativeMaps[E],ka(i,g,E,O))}case\"Prime\":{let d=t.args[0];if(!n[d._symbol])throw id(d._symbol);let g=Be(e,d.args[0]),x=i.getInstruction(g),M=!1,E;(x.type===2||x.type===3)&&x.valueType===P?E=g:(E=i.SymbolicVar(x.valueType),M=!0);let T,D;if(d._symbol===\"logbase\"){if(d.args.length!==2)throw gu();T=[E,Be(e,d.args[1])],D=[d.args[0],d.args[1]]}else{if(d.args.length!==1)throw gu();T=[E],D=[d.args[0]]}let O=Br(i,sy(e,d._symbol,d._errorSymbol,T,D));for(let A=0;A<t.order;A++)O=Uc(i,O,E);return E===g?O:(M&&delete i.derivativeMaps[E],ka(i,g,E,O))}case\"Slider\":return e.chunk.Constant(t.getConcreteTree(r,n).asCompilerValue());case\"Assignment\":return hT(i,e.selection,t),Be(e,t._expression);case\"CoordinateEquation\":return Be(e,t._expression);case\"FunctionDefinition\":{hT(i,e.selection,t);for(var p=0;p<t._argSymbols.length;p++)if(t._argSymbols[p]===t._symbol)throw hc(t._argSymbols[p]);return Be(e,t._expression)}case\"Construction\":throw In(\"construction\");default:let b=c;throw new Error(`Programming error, unimplemented node type ${b}`)}}function xT(e,t,r){let n=[Be(e,r[0])];return kc(e.chunk,e.policy,e.selection,t,n),Aa(e.chunk,e.policy,t,n),n}function Jn(e,t,r){let n=[Be(e,r[0]),Be(e,r[1])];return kc(e.chunk,e.policy,e.selection,t,n),Aa(e.chunk,e.policy,t,n),n}function TT(e,t){let r=e.chunk;return Ye(r,t,G)?r.SyntheticNativeFunction(\"hypot\",[r.OrderedTripleAccess([t,r.Constant(1)]),r.SyntheticNativeFunction(\"hypot\",[r.OrderedTripleAccess([t,r.Constant(2)]),r.OrderedTripleAccess([t,r.Constant(3)])])]):Ye(r,t,N)?r.SyntheticNativeFunction(\"hypot\",[r.OrderedPairAccess([t,r.Constant(1)]),r.OrderedPairAccess([t,r.Constant(2)])]):void 0}function pO(e,t,r,{forcePermitted:n}={forcePermitted:!1}){let i=e.chunk;if((n||e.policy.is3dProduct())&&Ye(i,t,N)&&Ye(i,r,N)){let s=i.Constant(1),o=i.Constant(2);return i.Add([i.Multiply([i.OrderedPairAccess([t,s]),i.OrderedPairAccess([r,s])]),i.Multiply([i.OrderedPairAccess([t,o]),i.OrderedPairAccess([r,o])])])}else if((n||e.policy.is3dProduct())&&Ye(i,t,G)&&Ye(i,r,G)){let s=i.Constant(1),o=i.Constant(2),a=i.Constant(3);return i.Add([i.Add([i.Multiply([i.OrderedTripleAccess([t,s]),i.OrderedTripleAccess([r,s])]),i.Multiply([i.OrderedTripleAccess([t,o]),i.OrderedTripleAccess([r,o])])]),i.Multiply([i.OrderedTripleAccess([t,a]),i.OrderedTripleAccess([r,a])])])}else return}function fO(e,t,r){let n=e.chunk,i=n.Constant(1),s=n.Constant(2),o=n.Constant(3),a=n.OrderedTripleAccess([t,i]),u=n.OrderedTripleAccess([t,s]),c=n.OrderedTripleAccess([t,o]),l=n.OrderedTripleAccess([r,i]),p=n.OrderedTripleAccess([r,s]),f=n.OrderedTripleAccess([r,o]);return n.OrderedTriple([n.Subtract([n.Multiply([u,f]),n.Multiply([c,p])]),n.Subtract([n.Multiply([c,l]),n.Multiply([a,f])]),n.Subtract([n.Multiply([a,p]),n.Multiply([u,l])])])}function zF(e,t,r){let n=[Be(e,r[0]),Be(e,r[1]),Be(e,r[2])];return kc(e.chunk,e.policy,e.selection,t,n),Aa(e.chunk,e.policy,t,n),n}function Yc(e,t,r){let n=[];for(let i of r)n.push(Be(e,i));return kc(e.chunk,e.policy,e.selection,t,n),Aa(e.chunk,e.policy,t,n),n}function sy(e,t,r,n,i,s){let{policy:o,frame:a,chunk:u,scope:c,parentNode:l,substitutionContext:p,selection:f}=e,y=fx(c,t);if(y!==void 0){if(ie(u.getInstruction(y).valueType,He))return uy(e.chunk,[y,...n],r,!0);if(n.length==1)return u.Multiply([y,n[0]]);throw u.getInstruction(y).type===2?id(r):u.getInstruction(y).valueType===Ke?dd(r):fd(r)}let h=a[t];if(h!==pr&&(h!=null&&h.isError))throw h;if(h===void 0||h===pr||!h.isFunction){if(Xe[t]&&Xe[t].isFunction){if(t===\"logbase\"&&a.ln&&a.log)throw Zb();let m=e.policy.is3dPolicy();throw ki(r,m)}if(h&&h!==pr){let m=Be(e,h);if(u.getInstruction(m).valueType===Ke)throw dd(r);if(ie(u.getInstruction(m).valueType,He))return uy(e.chunk,[m,...n],r,!0)}if(n.length==1)return u.Multiply([Be(e,new I.Identifier(t)),n[0]]);throw h?fd(r):new Error(`Programming Error: reached undefined symbol ${t}`)}if(lO(h)){if(s&&s.dotLHSIndex!==void 0)throw Tl(r);if(n.length!==h._argSymbols.length)throw Ui(r,h._argSymbols.length,n.length);let m=bo(c),b=Object.create(a);for(let d=0;d<h._argSymbols.length;d++)Mi(m,h._argSymbols[d],n[d],i[d]),b[h._argSymbols[d]]=pr;return Be(yi(o,b,u,m,l,p,f),h._expression)}else{if(Ls.hasOwnProperty(t))return kF(e,t,r,n,i,s);if(Pr.hasOwnProperty(t))return oy(e,t,r,n,s);{let m=e.policy.is3dPolicy();throw ki(r,m)}}}function HF(e,t){let r=Us(e,t),n=e.Add([r,Vn(e,t)]);return e.SyntheticNativeFunction(\"segment\",[r,n])}function oy(e,t,r,n,i){let{chunk:s}=e,o=Pr[t],a=!!(i&&i.dotLHSIndex!==void 0),u=n.length,{minArity:c,maxArity:l}=o;if(u>l||u<c)throw ne(\"Unexpected arity mismatch\");let p=PO(s,n,o),f={errorSymbol:r,providedArity:u,isDotCall:a};switch(o.tag){case\"default\":case\"reducer\":case\"doubleReducer\":case\"parameterizedReducer\":case\"color\":case\"never-broadcast\":return s.NativeFunction(t,f,p);case\"trig\":{let y=Be(e,new I.Identifier(\"trigAngleMultiplier\")),h=s.Multiply([p[0],y]);return s.NativeFunction(t,f,[h])}case\"trig2\":{let y=Be(e,new I.Identifier(\"trigAngleMultiplier\")),h=s.Multiply([p[1],y]);return s.NativeFunction(t,f,[p[0],h])}case\"inverseTrig\":{let y=Be(e,new I.Identifier(\"trigAngleMultiplier\")),h=s.NativeFunction(t,f,p);return s.Divide([h,y])}default:{let y=o.tag;throw new Error(`Programming Error: unexpected tag ${y}`)}}}function PO(e,t,{minArity:r,defaultArguments:n}){if(!n||!(t.length-r<n.length))return t;let i=t.slice();for(;i.length-r<n.length;)i.push(e.copyInstruction(n[i.length-r]));return i}function UF(e,t,{match:r,noBroadcast:n}){let i=[n?r:_n(r)];return Sm(i,t.map(s=>e.getInstruction(s).valueType),0).length>0}function Bu(e,t,r,n){let i=n.find(s=>UF(e,t,s));if(!i){if(typeof r==\"string\")throw ci(r,na(e,t));return r(e,t)}return i.build(e,t)}function dO(e,t){if(t.length!==2)throw ne(\"Can only take the midpoint of two points\");let r=e.Constant(Ce(1,2));return e.Multiply([r,e.Add(t)])}function kF(e,t,r,n,i,s){let{chunk:o,policy:a}=e,u=Ls[t];if(u.fallthroughUnlessDistribution&&!gO(o,n))return oy(e,t,r,n,s);let{minArity:c,maxArity:l}=u,p=n.length;if(p<c||p>l)throw new Error(\"Programming Error: unexpected arity mismatch\");let f;if(t===\"cdf\")p===2?f=[n[0],o.Constant(-1/0),n[1]]:f=n;else if(t===\"random\")if(p===1||p<4&&!j(o.getInstruction(n[1]).valueType)&&o.getInstruction(n[1]).valueType!==Ke){let m=o.Distribution(\"uniformdist\",[o.Constant(0),o.Constant(1)]);f=[n[0],m].concat(n.slice(1))}else f=n;else f=PO(o,n,u);let y=fl(t);if(y){let m=pT(o,f,y);m.didCoerce&&(f=m.args)}function h(m,b=r){return Bu(o,f,b,m)}switch(t){case\"length\":if(a.isGeometryEnabled()||a.is3dPolicy()){let m=f[0],b=a.is3dPolicy()?zg:Gg;return h([{match:[Le],build:()=>{throw b(r,na(o,f)[0])}},{match:[dt],build:()=>{let d=o.Constant(0),g=o.Constant(1);return o.SyntheticNativeFunction(\"distanceThreeD\",[o.SyntheticNativeFunction(\"segmentThreeDGlider\",[m,d]),o.SyntheticNativeFunction(\"segmentThreeDGlider\",[m,g])])}},{match:[Oe],build:()=>{let d=o.Constant(0),g=o.Constant(1);return o.SyntheticNativeFunction(\"distance\",[o.SyntheticNativeFunction(\"segmentGlider\",[m,d]),o.SyntheticNativeFunction(\"segmentGlider\",[m,g])])}},{match:[ue],build:()=>{let d=o.SyntheticNativeFunction(\"abs\",[o.SyntheticNativeFunction(\"arcOmega\",[f[0]])]),{radius:g,startPoint:x}=EO(o,f[0]),M=o.SyntheticNativeFunction(\"arcGlider\",[f[0],o.Constant(1)]);return o.Piecewise([o.Equal([d,o.Constant(0)]),o.SyntheticNativeFunction(\"distance\",[x,M]),o.Multiply([g,d])])}},{match:[ig],build:()=>TT(e,Vn(o,m))},{match:[Bt],noBroadcast:!0,build:()=>{throw b(r,na(o,f)[0])}}])}else return o.SyntheticNativeFunction(\"count\",f);case\"round\":return h([{match:[P],build:()=>o.SyntheticNativeFunction(\"round\",f)},{match:[P,P],build:()=>{let m=o.SyntheticNativeFunction(\"round\",[f[1]]),b=o.RawExponent([o.Constant(10),m]);return o.Divide([o.SyntheticNativeFunction(\"round\",[o.Multiply([f[0],b])]),b])}}]);case\"midpoint\":return h([{match:[Oe],build:()=>{let m=o.Constant(Ce(1,2));return o.SyntheticNativeFunction(\"segmentGlider\",[f[0],m])}},{match:[dt],build:()=>{let m=o.Constant(Ce(1,2));return o.SyntheticNativeFunction(\"segmentThreeDGlider\",[f[0],m])}},{match:[N,N],build:dO},{match:[G,G],build:dO}]);case\"circle\":return h([{match:[N,Oe],build:()=>{let m=o.Constant(0),b=o.Constant(1);return o.SyntheticNativeFunction(\"circle\",[f[0],o.SyntheticNativeFunction(\"distance\",[o.SyntheticNativeFunction(\"segmentGlider\",[f[1],m]),o.SyntheticNativeFunction(\"segmentGlider\",[f[1],b])])])}},{match:[N,N],build:()=>o.SyntheticNativeFunction(\"circle\",[f[0],o.SyntheticNativeFunction(\"distance\",f)])},{match:[N,P],build:()=>o.SyntheticNativeFunction(\"circle\",f)}]);case\"segment\":return h(fp(\"segment\",\"segmentThreeD\"));case\"vector\":return h(fp(\"vector\",\"vectorThreeD\"));case\"distance\":return h(fp(\"distance\",\"distanceThreeD\"));case\"center\":case\"radius\":return h([{match:[{meta:\"union\",types:[de,ue]}],build:()=>{let m=$F(o,f[0]);return o.SyntheticNativeFunction(t,[m])}}]);case\"glider\":return h([{match:[Oe,P],build:()=>o.SyntheticNativeFunction(\"segmentGlider\",f)},{match:[ye,P],build:()=>o.SyntheticNativeFunction(\"lineGlider\",f)},{match:[_e,P],build:()=>o.SyntheticNativeFunction(\"rayGlider\",f)},{match:[de,P],build:()=>o.SyntheticNativeFunction(\"circleGlider\",f)},{match:[ue,P],build:()=>o.SyntheticNativeFunction(\"arcGlider\",f)},{match:[we,P],build:()=>o.SyntheticNativeFunction(\"polygonGlider\",f)}]);case\"intersection\":case\"strictintersection\":{let m=0;t===\"strictintersection\"&&((Ye(o,f[0],Oe)||Ye(o,f[0],ue))&&(m+=3),(Ye(o,f[1],Oe)||Ye(o,f[1],ue))&&(m+=12)),Ye(o,f[0],_e)&&(m+=1),Ye(o,f[1],_e)&&(m+=4);let b=JF(e,i,f);if(!b)return PT(o,f,m);let d=Be(e,new I.Identifier(b[0]));return b[1]!==void 0&&(d=o.ListAccess([d,o.Constant(b[1])])),o.SyntheticNativeFunction(\"chooseNonIncidentPoint\",[d,PT(o,[f[0],f[1]],m),PT(o,[f[1],f[0]],m<<2&12|m>>2&3)])}case\"parallel\":case\"perpendicular\":return h([{match:[{meta:\"union\",types:Zp},N],build:()=>{let b=[ay(o,f[0]),f[1]];return o.SyntheticNativeFunction(t,b)}}]);case\"start\":return Us(o,f[0]);case\"end\":return o.Add([Us(o,f[0]),Vn(o,f[0])]);case\"translate\":case\"reflect\":case\"rotate\":case\"dilate\":return ZF(e,t,f);case\"apply\":return uy(o,f,r,!1);case\"normaldist\":case\"tdist\":case\"poissondist\":case\"binomialdist\":case\"uniformdist\":return o.Distribution(t,f);case\"pdf\":case\"cdf\":case\"median\":case\"stdev\":case\"var\":case\"quantile\":return yO(o,f,t);case\"total\":case\"mean\":return t===\"mean\"&&gO(o,n)?yO(o,f,t):h([{match:{type:\"variadic\",initial:[],rest:Le},build:()=>oy(e,t,r,f,s)},{match:{type:\"variadic\",initial:[N],rest:N},build:()=>{let b=[1,2].map(g=>o.Constant(g)),d=g=>o.SyntheticNativeFunction(t,f.map(x=>o.OrderedPairAccess([x,b[g-1]])));return o.OrderedPair([d(1),d(2)])}},{match:{type:\"variadic\",initial:[G],rest:G},build:()=>{let b=[1,2,3].map(g=>o.Constant(g)),d=g=>o.SyntheticNativeFunction(t,f.map(x=>o.OrderedTripleAccess([x,b[g-1]])));return o.OrderedTriple([d(1),d(2),d(3)])}}],()=>oy(e,t,r,f,s));case\"random\":{let m=f[0],b=f[1],d=o.getInstruction(f[0]),g=o.getInstruction(b);if(d.valueType!==Qe)throw ne(`Unexpected value type for seed arg: ${d.valueType}`);if(g.valueType===ar)throw Eh();let x;if(j(g.valueType))x=eO;else{if(g.type!==42||g.valueType!==Ke)throw ne('Expected distribution argument to \"random\"');x=Ao[g.symbol][t]}if(f.length>2){let M=f[2],E=o.getInstruction(M);if(E.valueType!==P)throw ne(`Expected numSamples argument to random() to be a number but got ${E.valueType}`);if(f.length===4){let _=o.getInstruction(f[3]);if(_.valueType!==P)throw ne(`Expected userSeed argument to random() to be a number but got ${E.valueType}`);if(!Vt(_))throw yd(Mn(o,f[3]));m=o.ExtendSeed(\"us\",[m,f[3]])}let T=o.Constant(1),D=o.SyntheticNativeFunction(\"round\",[o.SyntheticNativeFunction(\"validateSampleCount\",[M])]),S=o.BeginBroadcast([D]);m=o.ExtendSeed(\"lc\",[m,o.Subtract([S,T])]);let O=x(o,b,[m]),A=o.EndBroadcast([S,O]);return o.BroadcastResult(Tn(o.getInstruction(O).valueType),[A])}return x(o,b,[m])}case\"shuffle\":{let m=f[0],b=f[1],d=f[2];if(!j(o.getInstruction(b).valueType)||d!==void 0&&o.getInstruction(d).valueType!==P)throw ne(`Unexpected args for \"${t}\"`);if(d!==void 0){if(!Vt(o.getInstruction(d)))throw yd(Mn(o,d));m=o.ExtendSeed(\"us\",[m,d])}return o.SyntheticNativeFunction(\"shuffle\",[m,b])}case\"sort\":return h([{match:[te],noBroadcast:!0,build:()=>mO(e,f[0],f[0])},{match:[{meta:\"union\",types:is},te],noBroadcast:!0,build:()=>mO(e,f[0],f[1])}]);case\"join\":{let m=[],b=!0;for(let _ of f){let L=o.getInstruction(_);Na(L)||(b=!1);let H=L.valueType;if(H!==Le)if(j(H))m.push({isList:!0,index:_,elementType:$e(H)});else if(Fi(H))m.push({isList:!1,index:_,elementType:H});else throw ci(r,na(o,n))}if(m.length===0)return o.ConstantOfType(Le,[]);for(let _ of m)if(_.elementType!==m[0].elementType)throw ci(r,na(o,n));if(b){let _=[];for(let L of m){let H=o.getInstruction(Br(o,L.index));XM(H),L.isList?_.push(...H.value):_.push(H.value)}return o.ConstantOfType(Tn(m[0].elementType),_)}let d=o.Constant(0),g=o.Constant(1),x={};for(let _ of m)_.isList&&x[_.index]===void 0&&(x[_.index]=bn(o,_.index));let M=o.SyntheticNativeFunction(\"total\",m.map(_=>_.isList?x[_.index]:g)),E=o.BeginBroadcast([M]),T=d,D=[],S=[];for(let _ of m){let L=_.isList?o.ListAccess([_.index,o.Subtract([E,T])]):_.index;if(S.push(L),_!==m[m.length-1]){let H=_.isList?x[_.index]:g;T=o.Add([T,H]),D.push(o.LessEqual([E,T]))}}let O=S[S.length-1];for(let _=S.length-2;_>=0;_--)O=o.Piecewise([D[_],S[_],O]);let A=o.EndBroadcast([E,O]);return o.BroadcastResult(Tn(m[0].elementType),[A])}case\"unique\":{let m=f[0],b=o.getInstruction(m);if(!j(b.valueType)||b.valueType===ar)throw ne(`Unexpected types for ${t}`);return o.SyntheticNativeFunction(\"elementsAt\",[m,o.SyntheticNativeFunction(\"uniquePerm\",[m])])}case\"polygon\":return h([{match:[],build:()=>{let m=o.ConstantOfType(nt,[]);return o.SyntheticNativeFunction(\"polygon\",[m])}},{match:[P,P],noBroadcast:!0,build:()=>{throw Ol()}},{match:[P,P],build:()=>{let m=o.OrderedPair(f);return o.SyntheticNativeFunction(\"polygon\",[m])}},{match:{type:\"variadic\",initial:[],rest:N},build:()=>o.SyntheticNativeFunction(\"polygon\",f)}]);case\"directedangle\":return hO(e,f,r);case\"angle\":return o.SyntheticNativeFunction(\"undirectedAngleMarker\",[hO(e,f,r)]);case\"angles\":return o.SyntheticNativeFunction(\"polygonInteriorUndirectedAngles\",[f[0],Be(e,new I.Identifier(\"trigAngleMultiplier\"))]);case\"directedangles\":return o.SyntheticNativeFunction(\"polygonInteriorDirectedAngles\",[f[0],Be(e,new I.Identifier(\"trigAngleMultiplier\"))]);case\"coterminal\":{if(Ye(o,f[0],xe))return o.SyntheticNativeFunction(\"directedCoterminalAngle\",f);if(Ye(o,f[0],Ae))return o.SyntheticNativeFunction(\"undirectedCoterminalAngle\",f);throw ne(`Unexpected types for ${t}`)}case\"histogram\":case\"dotplot\":case\"boxplot\":case\"ttest\":case\"ittest\":case\"stats\":case\"det\":case\"inv\":case\"transpose\":case\"rref\":case\"trace\":case\"points\":case\"lines\":case\"circles\":case\"polygons\":case\"rays\":case\"arcs\":case\"vectors\":throw In(r);default:{let m=t;throw new Error(`Programming Error: unexpected compiler function ${m}`)}}}function mO(e,t,r){let{chunk:n}=e;if(lr(n,r)===0)return r;let s=n.SyntheticNativeFunction(\"min\",[bn(n,t),bn(n,r)]);return r=n.ListAccess([r,IT(e,n.List([n.Constant(1)]),n.List([s]),{stepMustBePositive:!0})]),n.SyntheticNativeFunction(\"elementsAt\",[t,n.SyntheticNativeFunction(\"sortPerm\",[r])])}function yO(e,t,r){let n=t[0],i=e.getInstruction(n);if(!ie(i.valueType,Ke))throw ne(`Unexpected args for \"${r}\"`);let s=t.slice(1);for(let o of s)if(!ie(e.getInstruction(o).valueType,P))throw ne(`Unexpected args for \"${r}\"`);if(j(i.valueType)){let o=[],a=1/0;for(let c of t){let l=Br(e,c);o.push(l);let p=e.getInstruction(l);if(j(p.valueType)){let f=lr(e,l);if(f===void 0)throw Hl(Mn(e,l));a=Math.min(a,f)}}let u=[];for(let c=0;c<a;c++){let l=pp(e,o[0],c),p=e.getInstruction(l);if(p.type!==42)throw ne(`Unexpected opcode for distribution arg: ${p.type}`);let f=[];for(let y of o.slice(1))j(e.getInstruction(y).valueType)?f.push(pp(e,y,c)):f.push(y);u.push(Ao[p.symbol][r](e,l,f))}return e.List(u)}else{if(i.type!==42)throw ne(`Unexpected opcode for distribution arg: ${i.type}`);return Ao[i.symbol][r](e,n,s)}}function gO(e,t){return t.length!==0&&e.getInstruction(t[0]).valueType!==Le&&ie(e.getInstruction(t[0]).valueType,Ke)}function qF(e,t){let{chunk:r}=e;En(t.args);let n=Yc(e,t,t.args),i=!1,s=!1;for(let o=0;o<n.length;o++){let u=r.getInstruction(n[o]).valueType;i=i||u===Je,s=s||u!==Je}if(i&&s)throw ne(\"Unexpected mix of actions and non-actions\");if(i)return TO(e,n);if(n.length===2)return r.OrderedPair(n);if(n.length==3)return r.OrderedTriple(n);throw ne(`Unexpected tuple dimensions: ${n.length}`)}function YF(e,t){let{chunk:r}=e;En(t.args);let n=Yc(e,t,t.args);if(n.length<1)throw ne(\"Empty bare sequence\");let i=r.getInstruction(n[0]).valueType;if(i===P)throw ne(\"Ambiguous bare sequence\");return i===Je?TO(e,n):r.List(n)}function TO(e,t){let{chunk:r}=e,n=[],i=[];for(let o of t){let a=r.getInstruction(o);switch(a.type){case 49:{Array.prototype.push.apply(n,a.symbols),Array.prototype.push.apply(i,a.args);break}case 1:{let c=a.value.updateRules;for(let l in c)n.push(l),i.push(r.ConstantOfType(c[l].valueType,c[l].value));break}default:{var s=Mn(r,o);throw s.length>0?ch(s):ne(`Unexpected opcode for action: ${a.type}`)}}}return r.Action(n,i)}function IO(e,t){var r=e.frame[t];return r===pr?Yf(t):e.policy.assignmentForbidden(t)?uh(t):r&&r.type===\"FunctionDefinition\"?qf(t):ah(t).allowExport()}function XF(e,t){let{policy:r,frame:n,chunk:i,scope:s,parentNode:o,substitutionContext:a,selection:u}=e,c=t._body,l=[],p=i.Constant(1),f=Object.create(n);En(t._inputLists);for(let{_symbol:T}of t._inputLists)f[T]=Qb(T);let y=bo(s);for(let T=t._inputLists.length-1;T>=0;T--){let D=t._inputLists[T],S=D._symbol,O=Be(yi(r,f,i,y,o,a,u),D.args[1]),A=i.getInstruction(O);if(!j(A.valueType))throw jb(S,pe(A.valueType));let _=bn(i,O);l.push({symbol:S,assignedList:O,lengthIndex:_}),p=i.Multiply([p,_])}let h=i.Constant(1),m=i.BeginBroadcast([p],{inputListSymbols:l.map(T=>T.symbol)}),b=bo(s);Mi(b,t._index._symbol,m);let d=h;for(let T=l.length-1;T>=0;T--){let{symbol:D,assignedList:S,lengthIndex:O}=l[T],A;if(l.length===1)A=m;else{let _=i.SyntheticNativeFunction(\"floor\",[i.Divide([i.Subtract([m,h]),d])]);A=i.Add([i.SyntheticNativeFunction(\"mod\",[_,O]),h]),T>0&&(d=i.Multiply([d,O]))}Mi(b,D,i.ListAccess([S,A]))}let g=Object.create(n);for(let T of l)g[T.symbol]=pr;let x=Be(yi(r,g,i,b,o,a,u),c),M=i.getInstruction(x);if(!Fi(M.valueType))throw mu([pe(M.valueType)]);let E=i.EndBroadcast([m,x]);return i.BroadcastResult(Tn(M.valueType),[E])}function IT(e,t,r,n){let{stepMustBePositive:i}=n,{chunk:s}=e;t=ku(s,t),r=ku(s,r);let o=s.getInstruction(t),a=s.getInstruction(r),u=Hs(s,t,\"Programming error: expected range start list to have constant length.\"),c=Hs(s,r,\"Programming error: expected range start list to have constant length.\");if(o.valueType!==te||a.valueType!==te)throw Ll();let l=s.Constant(1),p=s.Constant(0),f=s.ListAccess([t,l]),y=s.ListAccess([t,s.Constant(2)]),h=s.ListAccess([r,s.Constant(c)]),m=s.Subtract([h,f]),b=u>1?s.Subtract([y,f]):s.Piecewise([s.GreaterEqual([m,p]),l,s.Constant(-1)]),d=s.Add([l,s.SyntheticNativeFunction(\"round\",[s.Divide([m,b])])]),g=s.SyntheticNativeFunction(\"validateRangeLength\",[t,r,b,d]);i&&(g=s.Piecewise([s.GreaterEqual([b,p]),g,p]));let x=s.BeginBroadcast([g]),M=s.Add([f,s.Multiply([b,s.Subtract([x,l])])]),E=s.EndBroadcast([x,M]);return s.addComments({[f]:\"start\",[y]:\"second\",[h]:\"last\",[d]:\"proposedLength\",[b]:\"step\",[M]:\"body\"}),s.BroadcastResult(Tn(s.getInstruction(M).valueType),[E])}function ay(e,t){return Ye(e,t,Oe)?e.SyntheticNativeFunction(\"lineFromSegment\",[t]):Ye(e,t,ge)?e.SyntheticNativeFunction(\"lineFromSegment\",[HF(e,t)]):Ye(e,t,_e)?e.SyntheticNativeFunction(\"lineFromRay\",[t]):t}function $F(e,t){if(Ye(e,t,ue)){let{center:r,radius:n}=EO(e,t);return e.SyntheticNativeFunction(\"circle\",[r,n])}return t}function EO(e,t){let r=e.SyntheticNativeFunction(\"arcCenter\",[t]),n=e.SyntheticNativeFunction(\"arcGlider\",[t,e.Constant(0)]),i=e.SyntheticNativeFunction(\"distance\",[r,n]);return{center:r,radius:i,startPoint:n}}function hO(e,t,r){let{chunk:n}=e;if(t.length===3&&Ye(n,t[0],N)&&Ye(n,t[1],N)&&Ye(n,t[2],N)){let i=n.Constant(1),s=n.Constant(2),o=t[0],a=t[1],u=t[2],c=n.Subtract([o,a]),l=n.Subtract([u,a]),p=n.OrderedPairAccess([c,i]),f=n.OrderedPairAccess([c,s]),y=n.OrderedPairAccess([l,i]),h=n.OrderedPairAccess([l,s]),m=n.SyntheticNativeFunction(\"arctan\",[f,p]),b=n.Subtract([n.Multiply([p,h]),n.Multiply([f,y])]),d=n.Add([n.Multiply([p,y]),n.Multiply([f,h])]),g=n.SyntheticNativeFunction(\"arctan\",[b,d]),x=n.SyntheticNativeFunction(\"abs\",[g]),M=n.Constant(Math.PI),E=n.Constant(Math.PI*2);g=n.Piecewise([n.Equal([x,M]),M,n.Piecewise([n.Less([x,M]),g,n.Multiply([n.Multiply([n.SyntheticNativeFunction(\"sign\",[g]),n.Constant(-1)]),n.Subtract([E,x])])])]);let T=n.SyntheticNativeFunction(\"directedAngleMarker\",[a,m,g,Be(e,new I.Identifier(\"trigAngleMultiplier\"))]),D=n.Constant(0),S=n.And([n.Equal([b,D]),n.Equal([d,D])]);return n.Piecewise([S,n.NanOfType(xe),T])}else throw ne(`Unexpected types for ${r}`)}function $v(e,t){return e.Divide([e.SyntheticNativeFunction(\"directedAngleMarkerRawDelta\",[t]),e.SyntheticNativeFunction(\"directedAngleMarkerMultiplier\",[t])])}function Zv(e,t){return e.SyntheticNativeFunction(\"abs\",[e.Divide([e.SyntheticNativeFunction(\"undirectedAngleMarkerRawDelta\",[t]),e.SyntheticNativeFunction(\"undirectedAngleMarkerMultiplier\",[t])])])}function ZF(e,t,r){let{chunk:n}=e,i=r.slice(1),s=fl(t);if(!s)throw new Error(`Unexpected transformation type: ${t}`);let o=s.map(c=>{let l=0;for(let p=1;p<r.length;p++){let f=n.getInstruction(r[p]).valueType,y=Rm(c,p);y&&NP(f,y)&&l++}return{signature:c,matchedArgsCount:l,signatureArgsCount:Array.isArray(c)?c.length-1:c.initial.length+1,providedArgsCount:r.length-1}}).sort((c,l)=>l.matchedArgsCount!==c.matchedArgsCount?l.matchedArgsCount-c.matchedArgsCount:c.signatureArgsCount-l.signatureArgsCount),a;switch(t){case\"translate\":{a=[{match:[ge],build:()=>n.SyntheticNativeFunction(\"translation\",[n.SyntheticNativeFunction(\"vectorDisplacementAsPoint\",i)])},{match:[N,N],build:()=>n.SyntheticNativeFunction(\"translation\",[n.Subtract([i[1],i[0]])])}];break}case\"reflect\":{a=[{match:[{meta:\"union\",types:Zp}],build:()=>{let c=ay(n,i[0]);return n.SyntheticNativeFunction(\"reflection\",[c])}}];break}case\"rotate\":{a=[{match:[N,P],build:()=>{let c=Be(e,new I.Identifier(\"trigAngleMultiplier\"));return n.SyntheticNativeFunction(\"rotation\",[i[0],n.Multiply([i[1],c])])}}];break}case\"dilate\":{a=[{match:[N,P],build:()=>n.SyntheticNativeFunction(\"dilation\",i)}];break}default:{let c=t;throw new Error(`Programming error: exhaustive check failed: ${c}`)}}let u=Bu(n,i,()=>{throw Vg(t,na(n,i),o[0].signature)},a);return uy(n,[u,r[0]],t,!0)}function WF(e,t){let{match:r}=e;return ee(W({},e),{match:Array.isArray(r)?[t,...r]:ee(W({},r),{initial:[t,...r.initial]})})}function jF(e){return e.map(([t,r])=>({match:[t],build:(n,i)=>n.SyntheticNativeFunction(r,i)}))}function uy(e,t,r,n){let s=jF([[He,\"compose\"],[N,\"transformPoint\"],[Oe,\"transformSegment\"],[ye,\"transformLine\"],[_e,\"transformRay\"],[ge,\"transformVector\"],[de,\"transformCircle\"],[ue,\"transformArc\"],[we,\"transformPolygon\"],[Ae,\"transformAngleMarker\"],[xe,\"transformDirectedAngleMarker\"]]).map(a=>WF(a,He));function o(){throw n?Bg(r,Vu(e,t.slice(1))):ci(r,Vu(e,t))}return Bu(e,t,o,s)}function PT(e,t,r){let n=ay(e,t[0]),i=ay(e,t[1]),s=[n,i,e.ConstantOfType(P,r)];if(Ye(e,n,de)){if(Ye(e,i,de))return e.SyntheticNativeFunction(\"circleCircleIntersection\",s);if(Ye(e,i,ue))return e.SyntheticNativeFunction(\"circleArcIntersection\",s);if(Ye(e,i,ye))return e.SyntheticNativeFunction(\"circleLineIntersection\",s)}if(Ye(e,n,ue)){if(Ye(e,i,de))return e.SyntheticNativeFunction(\"arcCircleIntersection\",s);if(Ye(e,i,ue))return e.SyntheticNativeFunction(\"arcArcIntersection\",s);if(Ye(e,i,ye))return e.SyntheticNativeFunction(\"arcLineIntersection\",s)}if(Ye(e,n,ye)){if(Ye(e,i,de))return e.SyntheticNativeFunction(\"lineCircleIntersection\",s);if(Ye(e,i,ue))return e.SyntheticNativeFunction(\"lineArcIntersection\",s);if(Ye(e,i,ye))return e.SyntheticNativeFunction(\"lineLineIntersection\",s)}throw ne(\"Invalid intersection types\")}function JF(e,[t,r],[n,i]){let{chunk:s,frame:o}=e,a=s.getInstruction(n).valueType,u=s.getInstruction(i).valueType,c=f=>{let y=o[f];return y&&y!==pr?y:eE(e.scope,f)},l=ny(t)?c(t._symbol):t,p=ny(r)?c(r._symbol):r;if(!(!l||!p))return uO({getGeometryTree:f=>Om(f).tree,lookup:c,isPointOrListOfPoints:f=>{if(f.isFunction)return!1;let y=Be(e,f);return ie(s.getInstruction(y).valueType,N)},resolvesTo:(f,y)=>o[f]===y},l,a,p,u)}function QF(e,t){let{policy:r,frame:n,chunk:i,scope:s,parentNode:o,substitutionContext:a,selection:u}=e,c=t._body,l=bo(s),p=Object.create(n);for(let y=0;y<t._assignments.length;y++){let h=t._assignments[y]._symbol,m=t._assignments[y].args[1],b=n[h];if(b){if(b!==pr&&b.isError)throw b;if(b!==pr&&b.type===\"FunctionDefinition\")throw Id(h);if(r.assignmentForbidden(h))throw Td(h)}let d=Be(e,m),g=Mn(i,d);for(let x of g)if(x.scope===\"free\")throw ix(g).allowExport();Mi(l,h,d,m),p[h]=pr}return Be(yi(r,p,i,l,o,ee(W({},a),{body:!0}),u),c)}var bO={points:nt,lines:Nr,segments:ur,polygons:br,circles:Sr,arcs:Rr,angles:Jt,directedangles:Qt,rays:Ar,vectors:Cr};function KF(e,t){let{chunk:r,frame:n}=e,i=n.construction;if(i.isError)throw i;if(i.type!==\"Construction\")throw ne(`Expected construction node but found ${i.type}}`);if(!ny(t))throw ne(`Expected identifier but found ${t.type}`);let s=t._symbol;if(!(s in bO))throw In(\"construction\");let o=bO[s];if(i.args.length===0)return r.ConstantOfType(o,[]);let a=$e(o),u=[];for(let c of i.args)try{let l=Be(e,c);r.getInstruction(l).valueType===a&&u.push(l)}catch(l){if(l instanceof I.Base)continue;throw l}return r.List(u)}yt.prototype.buildIRExpression=function(e,t,r){var i;var n=Xc({policy:e,frame:t,wrapInList:r&&r.wrapInList,coerceToNumber:r&&r.coerceToNumber,selection:r&&r.selection},this);if(e.isGeometryEnabled()&&n.getLiveArgNames().some(s=>s[0]===\"$\"))throw ax();return(i=n.getError())!=null?i:new sr(n)};R.prototype.buildIRExpression=function(e,t,r){return this};var MO=$p;function ET(e){for(var t=[],r=0;r<e.length;r++)t.push(pe(e[r].valueType));return t}function DO(e,t){var r=t.length,n=t[0];if(r<2)throw cs(this._symbol);if(!MO(n.valueType,[te,Le]))throw cs(this._symbol);if(r>2)throw Jf(this._symbol,2)}I.Histogram.prototype.typeCheck=DO;I.DotPlot.prototype.typeCheck=DO;I.BoxPlot.prototype.typeCheck=function(e,t){var r=t.length,n=t[0];if(r===0)throw cs(this._symbol);if(!MO(n.valueType,[te,Le]))throw cs(this._symbol);if(r>1)throw cs(this._symbol)};I.TTest.prototype.typeCheck=function(e,t){var r=this._symbol;if(t.length===0)throw cs(r);if(t[0].valueType===Le)throw Tc(r);if(t[0].valueType!==te)throw cs(r);if(t.length>2)throw Jf(r,2);if(t[0].length<2)throw Tc(r);if(t[1]&&t[1].valueType!==P)throw ci(r,ET(t))};I.IndependentTTest.prototype.typeCheck=function(e,t){var r=this._symbol;if(t.length!==2)throw Sl(r);if(!j(t[0].valueType)||!j(t[1].valueType))throw _l(r);if(t[0].valueType===Le||t[1].valueType===Le)throw Tc(\"ittest\");if(t[0].valueType!==te||t[1].valueType!==te)throw ci(r,ET(t));if(t[0].length<2||t[1].length<2)throw Tc(\"ittest\")},I.Stats.prototype.typeCheck=function(e,t){var r=t.length,n=t[0];if(r===0)throw cs(this._symbol);if(n.valueType===Le)throw ci(this._symbol,ET(t));if(n.valueType!==te)throw cs(this._symbol);if(r>1)throw cs(this._symbol)};var qu=function(e,t,r){r=r||0;var n=Array(r+1).join(\"  \"),i=n+\"  \";return`[\n`+i+e.map(function(s){return s.repr(t,r+1)}).join(`,\n`+i)+`\n`+n+\"]\"},mn=function(e,t){return t=t||\"\",\"\"+t+e};I.Expression.prototype.repr=function(e,t){return mn(this.type,e)+\"(\"+qu(this.args,e,t)+\")\"};I.IRExpression.prototype.repr=function(e,t){t=t||0;var r=Array(t+1).join(\"  \"),n=r+\"  \",i=this._chunk.print().split(`\n`);return i.pop(),mn(this.type,e)+\"(`\\n\"+n+i.join(`\n`+n)+`\n`+r+\"`)\"};I.DoubleInequality.prototype.repr=function(e,t){t=t||0;var r=Array(t+1).join(\"  \"),n=r+\"  \";return mn(this.type,e)+`([\n`+n+this.args[0].repr(e,t+1)+`,\n`+n+\"'\"+this.args[1]+`',\n`+n+this.args[2].repr(e,t+1)+`,\n`+n+\"'\"+this.args[3]+`',\n`+n+this.args[4].repr(e,t+1)+`\n`+r+\"])\"};I.Identifier.prototype.repr=function(e){return mn(this.type,e)+\"('\"+this._symbol+\"')\"};I.Constant.prototype.repr=function(e){return mn(this.type,e)+\"(\"+this.asValue()+\")\"};I.ExtendSeed.prototype.repr=function(e,t){return mn(this.type,e)+\"('\"+this.tag+\"', \"+qu(this.args,e,t)+\")\"};I.Seed.prototype.repr=function(e){return mn(this.type,e)+\"(\"+this.asValue()+\")\"};I.FunctionCall.prototype.repr=function(e,t){return mn(this.type,e)+\"('\"+this._symbol+\"', \"+qu(this.args,e,t)+\")\"};I.Assignment.prototype.repr=function(e,t){return mn(this.type,e)+\"(\"+new I.Identifier(this._symbol).repr(e,t)+\", \"+this._expression.repr(e,t)+\")\"};I.CoordinateEquation.prototype.repr=function(e,t){return this.asEquation().repr(e,t)};I.Regression.prototype.repr=I.Equation.prototype.repr=function(e,t){return mn(this.type,e)+\"(\"+this._lhs.repr(e,t)+\", \"+this._rhs.repr(e,t)+\")\"};I.FunctionDefinition.prototype.repr=function(e,t){return mn(this.type,e)+\"(\"+new I.Identifier(this._symbol).repr(e,t)+\", \"+qu(this._argSymbols.map(function(r){return new I.Identifier(r)}),e,t)+\", \"+this._expression.repr(e,t)+\")\"};I.Error.prototype.repr=function(e,t){return mn(this.type,e)+\"('\"+this._msg+\"')\"};I.Derivative.prototype.repr=function(e,t){return mn(this.type,e)+\"('\"+this._symbol+\"', \"+qu(this.args,e,t)+\")\"};I.SolvedEquation.prototype.repr=function(e,t){return mn(this.type,e)+\"('\"+this._symbol+\"', \"+this._expression.repr(e,t)+\")\"};I.OptimizedRegression.prototype.repr=function(e,t){return mn(this.type,e)+\"(\"+JSON.stringify(this.parameters)+\", \"+JSON.stringify(this.residuals)+\", \"+JSON.stringify(this.statistics)+\", \"+this.model.repr(e,t+1)+\", \"+JSON.stringify({isModelValid:this.isModelValid,residualVariable:this.residualVariable,residualSuggestionId:this.residualSuggestionId,shouldSuggestLogMode:this.shouldSuggestLogMode,isLinear:this.isLinear,parameterWarning:this.parameterWarning})+\")\"};I.Table.prototype.repr=function(e,t){return mn(this.type,e)+\"(\"+qu(this.columns,e,t)+\")\"};I.TableColumn.prototype.repr=function(e,t){return mn(this.type,e)+\"(\"+this.header.repr(e,t)+\", \"+this.length+\", \"+qu(this.values,e,t)+\")\"};I.Image.prototype.repr=function(e,t){var r=Array(t+1).join(\"  \"),n=r+\"  \";return mn(this.type,e)+`({\n`+n+\"center: \"+this.center.repr(e,t+1)+`,\n`+n+\"radianAngle: \"+this.radianAngle.repr(e,t+1)+`,\n`+n+\"width: \"+this.width.repr(e,t+1)+`,\n`+n+\"height: \"+this.height.repr(e,t+1)+`},\n`+n+\"opacity: \"+this.opacity.repr(e,t+1)+`,\n`+n+JSON.stringify(this.moveStrategy)+`\n`+r+\"})\"};I.Ticker.prototype.repr=function(e,t){var r=Array(t+1).join(\"  \"),n=r+\"  \";return mn(this.type,e)+`({\n`+n+\"handler: \"+this.handler.repr(e,t+1)+`,\n`+n+\"minStep: \"+this.minStep.repr(e,t+1)+`\n`+r+\"})\"};I.Slider.prototype.repr=function(e,t){var r=Array(t+1).join(\"  \"),n=r+\"  \";return mn(this.type,e)+`({\n`+n+\"sliderAssignment: \"+this.sliderAssignment.repr(e,t+1)+`,\n`+n+\"sliderMin: \"+(this.sliderMin&&this.sliderMin.repr(e,t+1))+`,\n`+n+\"sliderMax: \"+(this.sliderMax&&this.sliderMax.repr(e,t+1))+`,\n`+n+\"sliderStep: \"+(this.sliderStep&&this.sliderStep.repr(e,t+1))+`},\n`+r+\")\"};var ly=function(e,t){return e.map(function(r){return r.substitute(t)})};I.Identifier.prototype.substitute=function(e){return e[this._symbol]?e[this._symbol]:this};I.FunctionCall.prototype.substitute=function(e){var t=e[this._symbol];if(t){if(t.type===\"Identifier\")return new I.FunctionCall(t,ly(this.args,e));if(t.type===\"Constant\")return new I.Multiply([t,this.args.length===1?this.args[0].substitute(e):new I.Constant(NaN)])}return I.Expression.prototype.substitute.call(this,e)};I.Constant.prototype.substitute=function(e){return this};I.Expression.prototype.substitute=function(e){return this.copyWithArgs(ly(this.args,e))};I.Derivative.prototype.substitute=function(e){var t=e[this._symbol];if(t){if(t.type===\"Identifier\")return new I.Derivative(t,ly(this.args,e));throw new Error(\"Cannot substitute for a derivative variable with a non-Identifier\")}return new I.Derivative(this._symbol,ly(this.args,e))};I.Expression.prototype.simpleFunctionExpression=function(){return this};I.Assignment.prototype.simpleFunctionExpression=function(){return this._expression};I.CoordinateEquation.prototype.simpleFunctionExpression=function(){return this.asEquation().simpleFunctionExpression()};I.FunctionDefinition.prototype.simpleFunctionExpression=function(){return this._expression};I.Equation.prototype.simpleFunctionExpression=function(){return this.asComparator().simpleFunctionExpression()};function Co(e){return e>=100}function vO(e,t){switch(e){case 106:return 200;case 107:return 201;case 108:return 202;case 103:return 214;case 130:return 215;case 112:return 209;case 113:return 210;case 110:switch(t){case\"z\":return 206;case\"theta\":return 205;case\"x\":case\"y\":case\"r\":case\"_implicit\":return 211;default:return 10}case 109:switch(t){case\"r\":return 203;case\"theta\":return 204;case\"x\":case\"y\":case\"z\":case\"_implicit\":return 213;default:return 10}case 125:case 111:switch(t){case\"theta\":return 207;case\"phi\":return 208;case\"x\":case\"y\":case\"z\":case\"r\":case\"_implicit\":return 212;default:return 10}default:return 10}}function MT(e){switch(e){case 123:case 122:case 121:case 120:case 124:case 125:case 126:case 127:return!0;default:return!1}}var py={normaldist:{type:\"distribution\",symbol:\"normaldist\",params:[\"mean\",\"stdev\"],defaults:[\"0\",\"1\"],discrete:!1},tdist:{type:\"distribution\",symbol:\"tdist\",params:[\"dof\"],defaults:[void 0],discrete:!1},binomialdist:{type:\"distribution\",symbol:\"binomialdist\",params:[\"trials\",\"probsuccess\"],defaults:[void 0,\"0.5\"],discrete:!0},poissondist:{type:\"distribution\",symbol:\"poissondist\",params:[\"mean\"],defaults:[void 0],discrete:!0},uniformdist:{type:\"distribution\",symbol:\"uniformdist\",params:[\"min\",\"max\"],defaults:[\"0\",\"1\"],discrete:!1}},eV={Histogram:{type:\"visualization\",symbol:\"histogram\",params:[\"data\",\"binwidth\"],defaults:[void 0,\"1\"]},DotPlot:{type:\"visualization\",symbol:\"dotplot\",params:[\"data\",\"binwidth\"],defaults:[void 0,\"1\"]},BoxPlot:{type:\"visualization\",symbol:\"boxplot\",params:[\"data\"],defaults:[void 0]}};function OO(e){let t=ys(e,{trailingComma:!0});return ca(t)}function ca(e){let t=e,r=eV[t.type];if(!r)switch(t.type===\"Assignment\"&&(t=t._expression),t.type){case\"FunctionCall\":{r=py[t._symbol];break}default:return}if(!r)return;let n={},i=r.params,s=t.args;for(let o=0;o<i.length;o++){let a=s[o];n[i[o]]=a&&a.getInputString()||\"\"}return ee(W({},r),{span:t.getInputSpan(),values:n})}var rV={X_OR_Y:{points:!1,lines:!0,fill:!1},SINGLE_POINT:{points:!0,lines:!1,fill:!1},POINT_LIST:{points:!0,lines:!1,fill:!1},PARAMETRIC:{points:!1,lines:!0,fill:!1},POLAR:{points:!1,lines:!0,fill:!1},IMPLICIT:{points:!1,lines:!0,fill:!1},POLYGON:{points:!1,lines:!0,fill:!0},HISTOGRAM:{points:!1,lines:!0,fill:!0},DOTPLOT:{points:!0,lines:!1,fill:!1},BOXPLOT:{points:!1,lines:!0,fill:!1},TTEST:{points:!1,lines:!1,fill:!1},STATS:{points:!1,lines:!1,fill:!1},POINT3D:{points:!0,lines:!1,fill:!1},POINT3D_LIST:{points:!0,lines:!1,fill:!1},CURVE3D_xyz_t:{points:!1,lines:!0,fill:!1},SLICE:{points:!1,lines:!0,fill:!1},SLICE_r\\u03B8z_at_z:{points:!1,lines:!0,fill:!1},SLICE_zr\\u03B8_at_r:{points:!1,lines:!0,fill:!1},SLICE_zr\\u03B8_at_\\u03B8:{points:!1,lines:!0,fill:!1},SLICE_zr\\u03B8_at_xyz:{points:!1,lines:!0,fill:!1},SLICE_r\\u03B8\\u03C6_at_\\u03B8:{points:!1,lines:!0,fill:!1},SLICE_r\\u03B8\\u03C6_at_\\u03C6:{points:!1,lines:!0,fill:!1},SLICE_r\\u03B8\\u03C6_at_xyz:{points:!1,lines:!0,fill:!1},SLICE_xyz_uv:{points:!1,lines:!0,fill:!1},SEGMENT3D:{points:!1,lines:!0,fill:!1},VECTOR3D:{points:!1,lines:!0,fill:!1},SPHERE3D:{points:!1,lines:!0,fill:!1},SURFACE_xyz_uv:{points:!1,lines:!0,fill:!1},SURFACE_z_r\\u03B8:{points:!1,lines:!0,fill:!1},SURFACE_r_\\u03B8z:{points:!1,lines:!0,fill:!1},SURFACE_r_\\u03B8\\u03C6:{points:!1,lines:!0,fill:!1},SURFACE_r_\\u03B8z_AMBIGUOUS:{points:!1,lines:!0,fill:!1},SURFACE_r_\\u03B8\\u03C6_AMBIGUOUS:{points:!1,lines:!0,fill:!1},SURFACE:{points:!1,lines:!0,fill:!1},TRIANGLE3D:{points:!1,lines:!0,fill:!1},SURFACE_AMBIGUOUS:{points:!1,lines:!0,fill:!1},SURFACE_CONSTANT_AMBIGUOUS:{points:!1,lines:!0,fill:!1},IMPLICIT_SURFACE:{points:!1,lines:!0,fill:!1},IMPLICIT_SURFACE_AMBIGUOUS:{points:!1,lines:!0,fill:!1}};function SO(e,t){var n,i,s,o,a,u;if(e===void 0)return{points:!1,lines:!1,fill:!1};let r=rV[e];switch(e){case\"SINGLE_POINT\":return{points:!0,lines:!1,fill:!1};case\"POINT_LIST\":case\"POINT3D_LIST\":case\"DOTPLOT\":return{points:(n=t.points)!=null?n:r.points,lines:(i=t.lines)!=null?i:r.lines,fill:!1};case\"POINT3D\":return{points:(s=t.points)!=null?s:r.points,lines:!1,fill:!1};case\"PARAMETRIC\":case\"POLYGON\":case\"X_OR_Y\":case\"POLAR\":case\"IMPLICIT\":case\"HISTOGRAM\":case\"BOXPLOT\":case\"TTEST\":case\"STATS\":case\"CURVE3D_xyz_t\":return{points:!1,lines:(o=t.lines)!=null?o:r.lines,fill:(a=t.fill)!=null?a:r.fill};case\"TRIANGLE3D\":case\"SPHERE3D\":case\"SURFACE\":case\"SURFACE_r_\\u03B8z\":case\"SURFACE_z_r\\u03B8\":case\"SURFACE_r_\\u03B8\\u03C6\":case\"SURFACE_xyz_uv\":case\"IMPLICIT_SURFACE\":case\"SURFACE_AMBIGUOUS\":case\"SURFACE_CONSTANT_AMBIGUOUS\":case\"SURFACE_r_\\u03B8z_AMBIGUOUS\":case\"SURFACE_r_\\u03B8\\u03C6_AMBIGUOUS\":case\"IMPLICIT_SURFACE_AMBIGUOUS\":case\"SEGMENT3D\":case\"VECTOR3D\":case\"SLICE\":case\"SLICE_r\\u03B8z_at_z\":case\"SLICE_zr\\u03B8_at_r\":case\"SLICE_zr\\u03B8_at_\\u03B8\":case\"SLICE_zr\\u03B8_at_xyz\":case\"SLICE_r\\u03B8\\u03C6_at_\\u03B8\":case\"SLICE_r\\u03B8\\u03C6_at_\\u03C6\":case\"SLICE_r\\u03B8\\u03C6_at_xyz\":case\"SLICE_xyz_uv\":return{points:!1,lines:(u=t.lines)!=null?u:r.lines,fill:!1};default:return e}}function RO(e){if(e===void 0)return!1;switch(e){case\"SINGLE_POINT\":case\"POINT_LIST\":case\"PARAMETRIC\":case\"POLYGON\":case\"X_OR_Y\":case\"POLAR\":case\"IMPLICIT\":return!0;case\"SURFACE\":case\"SURFACE_AMBIGUOUS\":case\"SURFACE_CONSTANT_AMBIGUOUS\":case\"SURFACE_r_\\u03B8z\":case\"SURFACE_r_\\u03B8z_AMBIGUOUS\":case\"SURFACE_z_r\\u03B8\":case\"SURFACE_r_\\u03B8\\u03C6\":case\"SURFACE_r_\\u03B8\\u03C6_AMBIGUOUS\":case\"SURFACE_xyz_uv\":case\"IMPLICIT_SURFACE\":case\"IMPLICIT_SURFACE_AMBIGUOUS\":case\"CURVE3D_xyz_t\":case\"SLICE\":case\"SLICE_r\\u03B8z_at_z\":case\"SLICE_zr\\u03B8_at_r\":case\"SLICE_zr\\u03B8_at_\\u03B8\":case\"SLICE_zr\\u03B8_at_xyz\":case\"SLICE_r\\u03B8\\u03C6_at_\\u03B8\":case\"SLICE_r\\u03B8\\u03C6_at_\\u03C6\":case\"SLICE_r\\u03B8\\u03C6_at_xyz\":case\"SLICE_xyz_uv\":case\"POINT3D\":case\"POINT3D_LIST\":case\"TRIANGLE3D\":case\"HISTOGRAM\":case\"BOXPLOT\":case\"DOTPLOT\":case\"TTEST\":case\"STATS\":case\"SEGMENT3D\":case\"VECTOR3D\":case\"SPHERE3D\":return!1;default:return e}}function _o(e){if(typeof e==\"string\")return e;if(e===void 0)return\"\";if(isNaN(e))return\"\\\\frac{0}{0}\";if(e===1/0)return\"\\\\infty\";if(e===-1/0)return\"-\\\\infty\";let t=e+\"\";return t=t.replace(/^1e\\+?([-\\d]+)/,\"10^{$1}\"),t=t.replace(/([-\\d\\.]+)e\\+?([-\\d]+)/,\"$1\\\\cdot 10^{$2}\"),t}function nV(e){let t=e+\"\";if(/\\d+\\.?\\d*e[\\+\\-]*\\d+/i.test(t)){let n=\"0\",i=String(t).toLowerCase().split(\"e\"),s=parseFloat(i[0]),o=parseInt(i[1],10),a=Math.abs(o),u=Math.abs(s).toString().split(\".\");if(o<0)t=\"0.\"+new Array(a).join(n)+u.join(\"\");else{var r=u[1];r&&(a=a-r.length),t=u.join(\"\")+new Array(a+1).join(n)}s<0&&(t=\"-\"+t)}return t}function Q$(e,t=2){var r=nV(e),n=r.indexOf(\".\");if(n===-1)return r;for(var i,s=n+1;s<r.length;s++)if(i){if(r[s]!==i)break}else if(r[s]===\"0\"||r[s]===\"9\")i=r[s];else break;return r.substr(0,Math.max(n+5,s+t))}function Er(e,t){if(j(e)){let r=[];for(let n=0;n<t.length;n++)r.push(Er($e(e),t[n]));return`\\\\left[${r.join(\",\")}\\\\right]`}switch(e){case P:return _o(t);case N:{let[s,o]=t;return`\\\\left(${_o(s)},${_o(o)}\\\\right)`}case G:{let[s,o,a]=t;return`\\\\left(${_o(s)},${_o(o)},${_o(a)}\\\\right)`}case It:return\"\\\\operatorname{rgb}\\\\left(\"+[Er(P,t[0]),Er(P,t[1]),Er(P,t[2])].join(\",\")+\"\\\\right)\";case we:{let s=[];for(let o of t)s.push(Er(N,o));return\"\\\\operatorname{polygon}\\\\left(\"+s.join(\",\")+\"\\\\right)\"}case Oe:return\"\\\\operatorname{segment}\\\\left(\"+[Er(N,t[0]),Er(N,t[1])].join(\",\")+\"\\\\right)\";case ye:return\"\\\\operatorname{line}\\\\left(\"+[Er(N,t[0]),Er(N,t[1])].join(\",\")+\"\\\\right)\";case _e:return\"\\\\operatorname{ray}\\\\left(\"+[Er(N,t[0]),Er(N,t[1])].join(\",\")+\"\\\\right)\";case ge:let r=t[0],n=t[1],i=[n[0]+r[0],n[1]+r[1]];return`\\\\operatorname{vector}\\\\left(${Er(N,n)},${Er(N,i)}\\\\right)`;case de:return\"\\\\operatorname{circle}\\\\left(\"+[Er(N,t[0]),Er(P,t[1])].join(\",\")+\"\\\\right)\";case ue:return\"\\\\operatorname{arc}\\\\left(\"+[Er(N,t[0]),Er(N,t[1]),Er(N,t[2])].join(\",\")+\"\\\\right)\";case Ae:return\"\\\\operatorname{angle}\\\\left(\"+[Er(N,t[0]),Er(P,t[1]),Er(P,t[2])].join(\",\")+\"\\\\right)\";case xe:return\"\\\\operatorname{directedangle}\\\\left(\"+[Er(N,t[0]),Er(P,t[1]),Er(P,t[2])].join(\",\")+\"\\\\right)\";default:throw new Error(\"Cannot serialize a value of type \"+pe(e)+\".\")}}function DT(e){let t={};for(let r in e.updateRules)t[r]=vT(e,r);return t}function vT(e,t){let{valueType:r,value:n}=e.updateRules[t];return`${Zr(t)}=${Er(r,n)}`}var la=class{constructor(t){this.xtolerance=t.xtolerance||t.tolerance||0,this.ytolerance=t.ytolerance||t.tolerance||0,this.ztolerance=t.ztolerance||t.tolerance||0,this.map=t.map,this.segments=[],this.segment=[],this.pivotPoint=void 0,this.pendingPoint=void 0}colinear(t,r,n){this.map&&(t=this.map(t),r=this.map(r),n=this.map(n));var i=Rs(n[0],n[1],n[2]||0,t[0],t[1],t[2]||0,r[0],r[1],r[2]||0);if(i<1)return!1;var s=[t[0]+i*(r[0]-t[0]),t[1]+i*(r[1]-t[1]),t.length===3?t[2]+i*(r[2]-t[2]):0];return Math.abs(n[0]-s[0])<=this.xtolerance&&Math.abs(n[1]-s[1])<=this.ytolerance&&(t.length===2||Math.abs(n[2]-s[2])<=this.ztolerance)}addPoint(t){if(this.dimensions=t.length,this.xtolerance<0&&this.ytolerance<0&&(this.dimensions===2||this.ztolerance<0)){this.segment.push.apply(this.segment,t);return}if(!this.segment.length){this.segment.push.apply(this.segment,t);return}let r=this.dimensions===2?[this.segment[this.segment.length-2],this.segment[this.segment.length-1]]:[this.segment[this.segment.length-3],this.segment[this.segment.length-2],this.segment[this.segment.length-1]];if(!(t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2])){if(!this.pivotPoint||!this.pendingPoint){this.pivotPoint=t,this.pendingPoint=t;return}(!this.colinear(r,this.pivotPoint,t)||ss(r[0]-t[0],r[1]-t[1],(r[2]||0)-(t[2]||0))<ss(r[0]-this.pendingPoint[0],r[1]-this.pendingPoint[1],(r[2]||0)-(this.pendingPoint[2]||0)))&&(this.flushPending(),this.pivotPoint=t),this.pendingPoint=t}}flushPending(){this.pendingPoint&&(this.segment.push.apply(this.segment,this.pendingPoint),this.pivotPoint=void 0,this.pendingPoint=void 0)}breakSegment(){this.flushPending(),this.segment.length>(this.dimensions||2)&&this.segments.push(this.segment),this.segment=[]}getSegments(){return this.breakSegment(),this.segments}finish(){return{segments:this.getSegments(),resolved:!0}}};var AO=5,iV=Math.pow(2,14);function RT(e,t){let r=sV(e,t);return{segments:r.contours.strokeSegments,fillSegments:r.contours.fillSegments,resolved:r.quadTree.resolved}}function sV(e,t){let r=Math.pow(2,-AO),n=NO(t,r),i=NO(t,2*r),s=oV(e,n,i),o=dV(s.root,e,n),a=bV(o,e,n);return{paddedDomain:n,rootDomain:i,quadTree:s,triangles:o,contours:a}}function Zc(e,t,r){return{x:e,y:t,z:r}}function fy(e,t,r){return{x:e,y:t,isZero:r}}function dy(e,t,r){return{vertices:[e,t,r],visited:!1,next:void 0}}function NO(e,t){let{mathToPixels:r}=e,n=r.interpolateX(e.xmin,e.xmax,-t),i=r.interpolateX(e.xmax,e.xmin,-t),s=r.interpolateY(e.ymin,e.ymax,-t),o=r.interpolateY(e.ymax,e.ymin,-t);return ee(W({},e),{xmin:n,ymin:s,xmax:i,ymax:o})}function Dp(e,t){return{depth:e,vertices:t,children:void 0,center:void 0}}function OT(e,t,r){e.center=CO(e.vertices[0],e.vertices[1],e.vertices[2],e.vertices[3],t,r)}function oV(e,t,r){let n=aV(e,r),i=[],s=[];s.push(n);let o=1,a=!0;e:for(;s.length;){let u=i;i=s,s=u;let c;for(;c=i.pop();)if(cV(c,e,t)){if(uV(c,e,t),!c.children){a=!1;break e}if(s.push(c.children[0]),s.push(c.children[1]),s.push(c.children[2]),s.push(c.children[3]),o+=3,o>=iV){a=!1;break e}}else OT(c,e,t)}for(let u=0;u<i.length;u++)OT(i[u],e,t);for(let u=0;u<s.length;u++)OT(s[u],e,t);return{root:n,resolved:a}}function aV(e,t){let r=t.xmin,n=t.xmax,i=t.ymin,s=t.ymax;return Dp(0,[$c(r,s,e),$c(n,s,e),$c(n,i,e),$c(r,i,e)])}function uV(e,t,r){let n=e.depth+1,i=e.vertices[0],s=e.vertices[1],o=e.vertices[2],a=e.vertices[3],u=Gn(i,s,t,r),c=Gn(s,o,t,r),l=Gn(o,a,t,r),p=Gn(a,i,t,r),f=Gn(i,o,t,r);e.children=[Dp(n,[i,u,f,p]),Dp(n,[u,s,c,f]),Dp(n,[f,c,o,l]),Dp(n,[p,f,l,a])]}function cV(e,t,r){if(e.depth<AO)return!0;if(pV(e,r)||lV(e,r))return!1;let n=e.vertices[0],i=e.vertices[1],s=e.vertices[2],o=e.vertices[3];if(isNaN(n.z)&&isNaN(i.z)&&isNaN(s.z)&&isNaN(o.z))return!1;if(isNaN(n.z)||isNaN(i.z)||isNaN(s.z)||isNaN(o.z))return!0;let a=CO(n,i,s,o,t,r),u=wo(n,i,t,r),c=wo(i,s,t,r),l=wo(s,o,t,r),p=wo(o,n,t,r);return Xa(n,u,t,r)||Xa(i,u,t,r)||Xa(i,c,t,r)||Xa(s,c,t,r)||Xa(s,l,t,r)||Xa(o,l,t,r)||Xa(o,p,t,r)||Xa(n,p,t,r)||Ya(n,u,a,t,r)||Ya(u,i,a,t,r)||Ya(i,c,a,t,r)||Ya(c,s,a,t,r)||Ya(s,l,a,t,r)||Ya(l,o,a,t,r)||Ya(o,p,a,t,r)||Ya(p,n,a,t,r)}function Ya(e,t,r,n,i){if(e.z>0==t.z>0&&t.z>0==r.z>0)return!1;let s,o,a,u;if(e.z>0==t.z>0){if(s=Gn(e,t,n,i),s.z>0!=e.z>0)return!0;o=Lo(e,r,n,i),a=Lo(t,r,n,i),u=Lo(s,r,n,i)}else if(t.z>0==r.z>0){if(s=Gn(t,r,n,i),s.z>0!=t.z>0)return!0;o=Lo(t,e,n,i),a=Lo(r,e,n,i),u=Lo(s,e,n,i)}else{if(s=Gn(r,e,n,i),s.z>0!=r.z>0)return!0;o=Lo(r,t,n,i),a=Lo(e,t,n,i),u=Lo(s,t,n,i)}let{mathToPixels:c}=i,[l,p]=c.mapCoordinatePair([u.x,u.y]),[f,y]=c.mapCoordinatePair([o.x,o.y]),[h,m]=c.mapCoordinatePair([a.x,a.y]);return r0(l,p,f,y,h,m)>i.tolerance}function Xa(e,t,r,n){if(isNaN(e.z)&&isNaN(t.z))return!1;if(isNaN(e.z)||isNaN(t.z))return e.z>0||t.z>0;let s=4*Gn(e,t,r,n).z-t.z-3*e.z,o=1e-4,a=(r((1-o)*e.x+o*t.x,(1-o)*e.y+o*t.y)-e.z)/o,u=Math.max(Math.abs(e.z),Math.abs(t.z));return Math.abs(s-a)>.125*u}function lV(e,t){let{mathToPixels:r}=t,[n,i]=r.mapCoordinatePair([e.vertices[1].x,e.vertices[1].y]),[s,o]=r.mapCoordinatePair([e.vertices[0].x,e.vertices[0].y]),[a,u]=r.mapCoordinatePair([e.vertices[3].x,e.vertices[3].y]);return Math.abs(n-s)<10*t.tolerance||Math.abs(o-u)<10*t.tolerance}function pV(e,t){return e.vertices[0].x<t.xmin||e.vertices[0].y>t.ymax||e.vertices[2].x>t.xmax||e.vertices[2].y<t.ymin}function Wc(e,t){return e.x<t.xmin||e.x>t.xmax||e.y<t.ymin||e.y>t.ymax}function $c(e,t,r){return Zc(e,t,r(e,t))}function Gn(e,t,r,n){let{mathToPixels:i}=n;return $c(i.interpolateX(e.x,t.x,.5),i.interpolateY(e.y,t.y,.5),r)}function wo(e,t,r,n){if(Wc(e,n)||Wc(t,n))return Gn(e,t,r,n);if(isNaN(e.z)||isNaN(t.z))return fV(e,t,r,n);if(e.z>0!=t.z>0)return Gn(e,t,r,n);let i=.01,s=r((1-i)*e.x+i*t.x,(1-i)*e.y+i*t.y)-e.z,o=t.z-r(i*e.x+(1-i)*t.x,i*e.y+(1-i)*t.y);return isNaN(s)||isNaN(o)||s>0==o>0?Gn(e,t,r,n):_O(Zc(e.x,e.y,s),Zc(t.x,t.y,o),r,n)}function CO(e,t,r,n,i,s){let o=wo(e,r,i,s);return e.z>0==r.z>0&&o.z>0!=e.z>0||(o=wo(t,n,i,s),t.z>0==n.z>0&&o.z>0!=t.z>0)?o:Gn(e,r,i,s)}function _O(e,t,r,n){if(isNaN(e.z))return t;if(isNaN(t.z))return e;if(!isFinite(e.z)&&!isFinite(t.z))return Gn(e,t,r,n);if(isFinite(e.z))if(isFinite(t.z)){let i=1-e.z/t.z,s=1-t.z/e.z;return $c(e.x/i+t.x/s,e.y/i+t.y/s,r)}else return e;else return t}function Lo(e,t,r,n){let{mathToPixels:i}=n,s=e.x,o=t.x,a=e.y,u=t.y,c=e.z,l=t.z;if(Wc(e,n)||Wc(t,n)){let m=Gn(e,t,r,n);return fy(m.x,m.y,!1)}let[p,f]=i.mapCoordinatePair([s,a]),[y,h]=i.mapCoordinatePair([o,u]);for(;Math.abs(p-y)>n.tolerance||Math.abs(f-h)>n.tolerance;){let m=.5*(s+o),b=.5*(a+u),d=r(m,b);d>0==c>0?(s=m,a=b,c=d):(o=m,u=b,l=d),[p,f]=i.mapCoordinatePair([s,a]),[y,h]=i.mapCoordinatePair([o,u])}if(isNaN(c))return fy(o,u,!1);if(isNaN(l))return fy(s,a,!1);{let m=_O(Zc(s,a,c),Zc(o,u,l),r,n),b=c===0||l===0||m.z===0||m.z>=c==l>=m.z&&Math.abs(m.z)<1e250;return fy(m.x,m.y,b)}}function fV(e,t,r,n){let{mathToPixels:i}=n;if(isNaN(e.z)===isNaN(t.z))return Gn(e,t,r,n);if(isNaN(e.z)){let h=e;e=t,t=h}let s=e.x,o=t.x,a=e.y,u=t.y,c=e.z,[l,p]=i.mapCoordinatePair([s,a]),[f,y]=i.mapCoordinatePair([o,u]);for(;Math.abs(l-f)>n.tolerance||Math.abs(p-y)>n.tolerance;){let h=.5*(s+o),m=.5*(a+u),b=r(h,m);isNaN(b)===isNaN(c)?(s=h,a=m,c=b):(o=h,u=m),[l,p]=i.mapCoordinatePair([s,a]),[f,y]=i.mapCoordinatePair([o,u])}return Zc(s,a,c)}function dV(e,t,r){let n={triangles:[],edgeCache:{},domain:r,fn:t};return vp(e,n),n.triangles}function vp(e,t){e.children&&(vp(e.children[0],t),vp(e.children[1],t),vp(e.children[2],t),vp(e.children[3],t),$a(e.children[0],e.children[1],t),$a(e.children[3],e.children[2],t),Za(e.children[1],e.children[2],t),Za(e.children[0],e.children[3],t))}function $a(e,t,r){e.children&&t.children?($a(e.children[1],t.children[0],r),$a(e.children[2],t.children[3],r)):e.children?($a(e.children[1],t,r),$a(e.children[2],t,r)):t.children?($a(e,t.children[0],r),$a(e,t.children[3],r)):mV(e,t,r)}function Za(e,t,r){e.children&&t.children?(Za(e.children[2],t.children[1],r),Za(e.children[3],t.children[0],r)):e.children?(Za(e.children[2],t,r),Za(e.children[3],t,r)):t.children?(Za(e,t.children[1],r),Za(e,t.children[0],r)):yV(e,t,r)}function mV(e,t,r){if(!e.center||!t.center)return;let n,i;e.depth>=t.depth?(n=wo(e.vertices[1],e.vertices[2],r.fn,r.domain),i=gy(e.vertices[1],t.center,e.vertices[2],e.center,n)):(n=wo(t.vertices[0],t.vertices[3],r.fn,r.domain),i=gy(t.vertices[0],t.center,t.vertices[3],e.center,n)),LO(i,r.edgeCache,r.domain);for(let s=0;s<4;s++)r.triangles.push(i[s])}function yV(e,t,r){if(!e.center||!t.center)return;let n,i;e.depth>=t.depth?(n=wo(e.vertices[3],e.vertices[2],r.fn,r.domain),i=gy(e.vertices[2],t.center,e.vertices[3],e.center,n)):(n=wo(t.vertices[1],t.vertices[0],r.fn,r.domain),i=gy(t.vertices[1],t.center,t.vertices[0],e.center,n)),LO(i,r.edgeCache,r.domain);for(let s=0;s<4;s++)r.triangles.push(i[s])}function gy(e,t,r,n,i){return[dy(e,i,t),dy(t,i,r),dy(r,i,n),dy(n,i,e)]}function Op(e,t,r){return e.z>0&&!Wc(e,r)&&(!(t.z>0)||Wc(t,r))}function my(e,t){return\"\"+e.x+\",\"+e.y+\",\"+t.x+\",\"+t.y}function LO(e,t,r){yy(e[0],e[1],e[2],my(e[1].vertices[2],e[1].vertices[0]),t,r),yy(e[1],e[2],e[3],my(e[2].vertices[0],e[2].vertices[2]),t,r),yy(e[2],e[3],e[0],my(e[3].vertices[2],e[3].vertices[0]),t,r),yy(e[3],e[0],e[1],my(e[0].vertices[0],e[0].vertices[2]),t,r)}function yy(e,t,r,n,i,s){let o=t.vertices[0],a=t.vertices[1],u=t.vertices[2];Op(a,u,s)&&(t.next=r),Op(o,a,s)&&(t.next=e),Op(u,o,s)&&hV(t,n,i),Op(o,u,s)&&gV(t,n,i)}function gV(e,t,r){r[t]?r[t].next=e:r[t]=e}function hV(e,t,r){r[t]?e.next=r[t]:r[t]=e}function bV(e,t,r){let{tolerance:n,mathToPixels:i}=r,s={tolerance:n,map:a=>i.mapCoordinatePair(a)},o={fillAccumulator:new la(s),strokeAccumulator:new la(s),fn:t,domain:r};for(let a=0;a<e.length;a++){let u=e[a];u.next&&!u.visited&&xV(u,o)}return{strokeSegments:o.strokeAccumulator.finish().segments,fillSegments:o.fillAccumulator.finish().segments}}function xV(e,t){for(;;){let r=e.vertices[0],n=e.vertices[1],i=e.vertices[2];if(ST(r,n,t),ST(n,i,t),ST(i,r,t),e.visited||!e.next)break;e.visited=!0,e=e.next}t.strokeAccumulator.breakSegment(),t.fillAccumulator.breakSegment()}function ST(e,t,r){if(Op(e,t,r.domain)){let n=Lo(e,t,r.fn,r.domain);r.fillAccumulator.addPoint([n.x,n.y]),n.isZero?r.strokeAccumulator.addPoint([n.x,n.y]):r.strokeAccumulator.breakSegment()}}var Si={pointsOfInterest:!0,plotSingleVariableImplicitEquations:!0,plotImplicits:!0,plotInequalities:!0,sliders:!0};function NT(e){return Math.abs(e)<5e-8}var Sp=class extends la{constructor(r,n,i){let{tolerance:s,mathToPixels:o}=r;super({tolerance:s,map:a=>o.mapCoordinatePair(a)});this.fn=n,this.mappedFn=a=>o.mapY(n(a)),this.derivative=i,this.poiData={zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}},this.zeroBuffer=[],this.extremumBuffer=[]}getPOI(){return Si.pointsOfInterest?(this.poiData.intercept=this.findIntercept(this.fn),this.poiData):{zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}}}addPoint(r){this.segment.length===0&&NT(r[1])&&(this.poiData.zeros.x.push(r[0]),this.poiData.zeros.y.push(r[1])),this.updateZeroBuffer(r),this.updateExtremumBuffer(r),super.addPoint(r)}updateZeroBuffer(r){let[n,i]=this.map?this.map(r):r;if(!isFinite(n)||!isFinite(i)){this.zeroBuffer.length=0;return}switch(this.zeroBuffer.length){case 0:{if(NT(r[1]))return;this.zeroBuffer.push(r);return}case 1:if(r[1]===0){this.zeroBuffer.push(r);return}else if(r[1]>0!=this.zeroBuffer[0][1]>0){let s=vx(this.zeroBuffer[0][0],this.zeroBuffer[0][1],r[0],r[1],this.fn);s&&(this.poiData.zeros.x.push(s[0]),this.poiData.zeros.y.push(s[1])),this.zeroBuffer.length=0,this.zeroBuffer.push(r);return}else{this.zeroBuffer.length=0,this.zeroBuffer.push(r);return}case 2:{if(r[1]===0)return;if(r[1]>0!=this.zeroBuffer[0][1]>0){let s=Jl(this.zeroBuffer[0][0],this.zeroBuffer[0][1],this.zeroBuffer[1][0],this.zeroBuffer[1][1],r[0],r[1],this.fn);s&&(this.poiData.zeros.x.push(s[0]),this.poiData.zeros.y.push(s[1])),this.zeroBuffer.length=0,this.zeroBuffer.push(r);return}else{this.zeroBuffer.length=0,this.zeroBuffer.push(r);return}}}}updateExtremumBuffer(r){let[n,i]=this.map?this.map(r):r;if(!isFinite(n)||!isFinite(i)){this.extremumBuffer.length=0;return}switch(this.extremumBuffer.length){case 0:{this.extremumBuffer.push(r);return}case 1:{r[1]===this.extremumBuffer[0][1]&&(this.extremumBuffer.length=0),this.extremumBuffer.push(r);return}case 2:if(r[1]===this.extremumBuffer[1][1]){this.extremumBuffer.push(r);return}else if(r[1]>this.extremumBuffer[1][1]!=this.extremumBuffer[1][1]>this.extremumBuffer[0][1]){let s=this.bisectExtremumUsingDerivative(this.extremumBuffer[0][0],this.extremumBuffer[0][1],this.extremumBuffer[1][0],this.extremumBuffer[1][1],r[0],r[1]);s&&(this.poiData.extrema.x.push(s[0]),this.poiData.extrema.y.push(s[1]),!Oc(this.extremumBuffer[0][0],this.mappedFn(this.extremumBuffer[0][0]),s[0],this.mappedFn(s[0]),r[0],this.mappedFn(r[0]),this.mappedFn,this.ytolerance)&&s[0]>this.segment[this.segment.length-2]&&(this.pendingPoint=s)),this.extremumBuffer.shift(),this.extremumBuffer.push(r);return}else{this.extremumBuffer.shift(),this.extremumBuffer.push(r);return}case 3:{if(r[1]===this.extremumBuffer[1][1])return;if(r[1]>this.extremumBuffer[1][1]!=this.extremumBuffer[1][1]>this.extremumBuffer[0][1]){let s,o=.5*(this.extremumBuffer[1][0]+this.extremumBuffer[2][0]),a=this.fn(o);a===this.extremumBuffer[1][1]?s=Jl(this.extremumBuffer[0][0],this.extremumBuffer[0][1],this.extremumBuffer[1][0],this.extremumBuffer[1][1],r[0],r[1],this.fn):s=this.bisectExtremumUsingDerivative(this.extremumBuffer[1][0],this.extremumBuffer[1][1],o,a,this.extremumBuffer[2][0],this.extremumBuffer[2][1]),s&&(this.poiData.extrema.x.push(s[0]),this.poiData.extrema.y.push(s[1])),this.extremumBuffer.shift(),this.extremumBuffer.shift(),this.extremumBuffer.push(r);return}else{this.extremumBuffer.shift(),this.extremumBuffer.shift(),this.extremumBuffer.push(r);return}}}}bisectExtremumUsingDerivative(r,n,i,s,o,a){let u;if(this.derivative){let c=this.derivative(r),l=this.derivative(o);if(!isNaN(c)&&!isNaN(l)&&(s>n&&c>0&&l<0||s<n&&c<0&&l>0)){let p=vx(r,c,o,l,this.derivative);p&&(u=[p[0],this.fn(p[0])])}}return u||(u=LE(r,n,i,s,o,a,this.fn)),u}breakSegment(){this.zeroBuffer.length=0,this.extremumBuffer.length=0,this.flushPending(),this.segment.length>2&&(this.segments.push(this.segment),NT(this.segment[this.segment.length-1])&&(this.poiData.zeros.x.push(this.segment[this.segment.length-2]),this.poiData.zeros.y.push(this.segment[this.segment.length-1]))),this.segment=[]}findIntercept(r){if(!r)return{x:[],y:[]};let n=r(0);return isFinite(n)?{x:[0],y:[r(0)]}:{x:[],y:[]}}finish(){return{segments:this.getSegments(),resolved:!0,poi:this.getPOI()}}};var PV=e=>{for(var t=[],r=[],n=e.length,i=0;i<n;i++)t.push(e[i][0]),r.push(e[i][1]);return{defined:{x:t,y:r}}},xs=PV;var{sin:TV,cos:IV}=Math,nr=class e{constructor(t=0,r=0,n=0){this.x=t;this.y=r;this.z=n}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}set(t,r,n){return this.x=t,this.y=r,this.z=n,this}clone(){return new e(this.x,this.y,this.z)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}isZero(){return this.x===0&&this.y===0&&this.z===0}isFinite(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)}subVectors(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this.z=t.z-r.z,this}addVectors(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this.z=t.z+r.z,this}multiply(t){return this.x*=t,this.y*=t,this.z*=t,this}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){return this.multiply(1/this.magnitude()),this}cross(t){return this.crossVectors(this,t)}crossVectors(t,r){let n=t.x,i=t.y,s=t.z,o=r.x,a=r.y,u=r.z;return this.x=i*u-s*a,this.y=s*o-n*u,this.z=n*a-i*o,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}rotateAroundAxis(t,r){let n=EV(t,r);return new e(n[0]*this.x+n[1]*this.y+n[2]*this.z,n[3]*this.x+n[4]*this.y+n[5]*this.z,n[6]*this.x+n[7]*this.y+n[8]*this.z)}};function EV(e,t){let r=e.x,n=e.y,i=e.z,s=TV(t),o=IV(t),a=1-o;return[a*r*r+o,a*r*n+s*i,a*r*i-s*n,a*n*r-s*i,a*n*n+o,a*n*i+s*r,a*i*r+s*n,a*i*n-s*r,a*i*i+o]}var Ie=class{constructor(t,r){this.min=t;this.max=r}get width(){return this.max-this.min}};function wO(e,t,r,n,i,s=100){if(isFinite(n)||([n,i]=[i,n],[t,r]=[r,t]),isFinite(i))return AT(e,t,r,n,i,s);for(;;){let o=Io(t,r,.5),a=e(...o);if(a===0)return o;if(!isFinite(a))r=o,i=a;else if(n<0==a<0)t=o,n=a;else return r=o,i=a,AT(e,t,r,n,i,s);if(s*=.5,s<1)return}}function FO(e,t,r,n,i,s=100){if(isFinite(n)||([n,i]=[i,n],[t,r]=[r,t]),!isFinite(i))for(;;){let o=Io(t,r,.5),a=e(...o);if(a===0)return{posNeg:o};if(!isFinite(a))r=o,i=a;else if(n<0==a<0)t=o,n=a;else if(n>0){r=o,i=a;break}else return{posNeg:CT(e,o,t,a,n,s),posNaN:MV(e,o,r,s)};if(s*=.5,s<1){let u=Io(t,r,.5);return n>0?{posNaN:u}:{}}}return{posNeg:AT(e,t,r,n,i,s)}}function AT(e,t,r,n,i,s){return n>0?CT(e,t,r,n,i,s):CT(e,r,t,i,n,s)}function CT(e,t,r,n,i,s){let o=n-i;for(;;){let a=Io(t,r,.5),u=e(...a);if(u<0)r=a,i=u;else if(u>0)t=a,n=u;else return u===0?a:void 0;if(s*=.5,s<1){if(n-i<.1*o)return Io(t,r,.5);if(s<1e-6)return}}}function MV(e,t,r,n){for(;;){let i=Io(t,r,.5),s=e(...i);if(!isFinite(s))r=i;else if(s>=0)t=i;else return;if(n*=.5,n<1)return Io(t,r,.5)}}var xy=50;function Yu(e){return e!==void 0&&e!==0}function DV(e){return Yu(e.posNeg)||Yu(e.posNaN)}var Rp={};function _T(e=Rp,t=Rp,r=Rp){return{edge0:e,edge1:t,edge2:r}}var hy=[0,1,0,2,0,3,1,2,2,3,0,4,0,7,3,7,4,7,0,5,1,5,4,5,1,6,2,6,5,6,3,6,6,7,4,6,0,8,1,8,2,8,3,8,4,8,5,8,6,8,7,8],vV=[[1,2,4,21,20,18],[0,1,3,20,19,18],[2,6,7,25,21,18],[5,6,8,25,22,18],[5,9,11,23,22,18],[0,9,10,23,19,18],[10,12,14,24,23,19],[3,12,13,24,20,19],[4,13,15,24,21,20],[15,7,16,25,24,21],[11,17,14,24,23,22],[17,8,16,25,24,22]],OV=[[0,2,3,8],[0,1,2,8],[0,3,7,8],[0,4,7,8],[0,4,5,8],[0,1,5,8],[1,5,6,8],[1,2,6,8],[2,3,6,8],[3,6,7,8],[4,5,6,8],[4,6,7,8]];function VO(e,t,r,n,{isInequality:i}){let s=new LT(e,t,new Ie(r.xmin,r.xmax),new Ie(r.ymin,r.ymax),new Ie(r.zmin,r.zmax),n,{isInequality:i});return s.setupGrids(),s.loopOverUnitCubes()}var LT=class{constructor(t,r,n,i,s,o,{isInequality:a}){this.cubeVertexValue=new Array(9);this.cubeVertex=new Array(9);this.cubeEdge=new Array(26);this.planeA=[];this.planeB=[];this.planeC=[];this.face=_T();this.i=0;this.j=0;this.k=0;this.cubeHasCrossing=!1;this.allNormalsFromGradient=!0;this.normalFromGradient=[];this.edgesMaybeCross=0;this.positions=[];this.uvs=[];this.normals=[];this.triangles=[];this.offset=[[0,0,0],[0,1,0],[1,1,0],[1,0,0],[0,0,1],[0,1,1],[1,1,1],[1,0,1],[.5,.5,.5]];this.gridsize=o,this.isInequality=a,this.f=t,this.gradient=r,this.x=n,this.y=i,this.z=s,this.size=new nr(this.x.width/o,this.y.width/o,this.z.width/o),this.sheet=Array((o+1)*(o+1)),this.strip=Array(o+1);for(let u=0;u<(o+1)*(o+1);u++)this.sheet[u]=_T();for(let u=0;u<o+1;u++)this.strip[u]=_T()}loopOverUnitCubes(){this.positions=[],this.normals=[],this.triangles=[];let t=this.gridsize,r=t+1;for(let o=0;o<t;o++){this.k=o,this.computeLatticeVerticesOnPlanes();for(let a=0;a<t;a++){this.j=a;for(let u=0;u<t;u++){this.i=u;let c=a*r+u;this.cubeVertexValue[0]=this.planeA[c],this.cubeVertexValue[1]=this.planeA[c+r],this.cubeVertexValue[2]=this.planeA[c+r+1],this.cubeVertexValue[3]=this.planeA[c+1],this.cubeVertexValue[4]=this.planeB[c],this.cubeVertexValue[5]=this.planeB[c+r],this.cubeVertexValue[6]=this.planeB[c+r+1],this.cubeVertexValue[7]=this.planeB[c+1],this.cubeVertexValue[8]=this.planeC[a*t+u],this.edgesMaybeCross=0,this.cubeHasCrossing=!1;for(let l=0;l<26;l++){let p=this.cubeVertexValue[hy[l*2]],f=this.cubeVertexValue[hy[l*2+1]];(p===0||f===0)&&(this.cubeHasCrossing=!0),!(p>0&&f>0||p<0&&f<0)&&(isFinite(p)||isFinite(f))&&(this.edgesMaybeCross|=1<<l)}if(this.edgesMaybeCross)for(let l=0;l<9;l++){let p=this.offset[l];this.cubeVertex[l]=[this.x.min+(this.i+p[0])*this.size.x,this.y.min+(this.j+p[1])*this.size.y,this.z.min+(this.k+p[2])*this.size.z]}this.edgesMaybeCross&&this.setEdges(),this.saveEdges(),this.cubeHasCrossing&&this.generateTriangles()}}}let{uvs:n,positions:i,normals:s}=this;if(!this.allNormalsFromGradient)for(let o=0;o<s.length/3;o++){if(this.normalFromGradient[o])continue;let a=s[3*o],u=s[3*o+1],c=s[3*o+2],l=Math.sqrt(a*a+u*u+c*c);s[3*o]=a/l,s[3*o+1]=u/l,s[3*o+2]=c/l}return{positions:i,normals:s,faces:this.triangles,uvs:n,extraAttrs:[]}}setupGrids(){let t=this.gridsize;this.cornersGrid=new by(this.x.min,this.y.min,this.z.min,this.size.x,this.size.y,this.size.z,t+1,t+1,t+1),this.centersGrid=new by(this.x.min+this.size.x/2,this.y.min+this.size.y/2,this.z.min+this.size.z/2,this.size.x,this.size.y,this.size.z,t,t,t)}computeLatticeVerticesOnPlanes(){this.cornersGrid===void 0||this.centersGrid===void 0||(this.planeA=this.k==0?this.evaluateArray(this.cornersGrid,0):this.planeB,this.planeB=this.evaluateArray(this.cornersGrid,this.k+1),this.planeC=this.evaluateArray(this.centersGrid,this.k))}evaluateArray(t,r){let n=Array(t.numX*t.numY),i=t.z0+r*t.dz;for(let s=0;s<t.numX;s++)for(let o=0;o<t.numY;o++){let a=t.x0+s*t.dx,u=t.y0+o*t.dy;n[o*t.numX+s]=this.f(a,u,i)}return n}setEdges(){let{i:t,j:r,k:n,gridsize:i}=this,s=this.sheet[(t+0)*(i+1)+r+0],o=this.sheet[(t+1)*(i+1)+r+0],a=this.sheet[(t+0)*(i+1)+r+1],u=0;n>0&&(this.cubeEdge[0]=s.edge0,this.cubeEdge[1]=s.edge1,this.cubeEdge[2]=s.edge2,this.cubeEdge[3]=a.edge2,this.cubeEdge[4]=o.edge0,u|=31),r>0&&(this.cubeEdge[5]=this.strip[t].edge0,this.cubeEdge[6]=this.strip[t].edge1,this.cubeEdge[7]=this.strip[t+1].edge0,this.cubeEdge[8]=this.strip[t].edge2,u|=480,n==0&&(this.cubeEdge[2]=s.edge2,u|=4)),t>0&&(this.cubeEdge[9]=this.face.edge0,this.cubeEdge[10]=this.face.edge1,this.cubeEdge[11]=this.face.edge2,u|=3584,n==0&&(this.cubeEdge[0]=s.edge0,u|=1),r==0&&(this.cubeEdge[5]=this.strip[t].edge0,u|=32));for(let c=0;c<26;c++){if(~this.edgesMaybeCross>>c&1){this.cubeEdge[c]=Rp;continue}if(u>>c&1){!this.cubeHasCrossing&&(this.cubeEdge[c].posNeg||this.cubeEdge[c].posNaN)&&(this.cubeHasCrossing=!0);continue}let l=this.findSurfaceCrossingEDI(hy[c*2],hy[c*2+1]);this.cubeEdge[c]=l,DV(l)&&(this.cubeHasCrossing=!0)}}saveEdges(){let{i:t,j:r,k:n,gridsize:i}=this;n<i-1&&(this.sheet[(t+0)*(i+1)+r+0].edge0=this.cubeEdge[11],this.sheet[(t+0)*(i+1)+r+0].edge1=this.cubeEdge[17],this.sheet[(t+0)*(i+1)+r+0].edge2=this.cubeEdge[8]),r<i-1&&(this.strip[t].edge0=this.cubeEdge[10],this.strip[t].edge1=this.cubeEdge[12],this.strip[t].edge2=this.cubeEdge[14]),t<i-1&&(this.face.edge0=this.cubeEdge[15],this.face.edge1=this.cubeEdge[13],this.face.edge2=this.cubeEdge[16]),n==0&&(this.sheet[(t+0)*(i+1)+r+1].edge2=this.cubeEdge[3],this.sheet[(t+1)*(i+1)+r+0].edge0=this.cubeEdge[4]),r==0&&(this.strip[t+1].edge0=this.cubeEdge[7]),r==i-1&&(this.sheet[t*(i+1)+i].edge2=this.cubeEdge[14]),t==i-1&&(this.sheet[(i+0)*(i+1)+r].edge0=this.cubeEdge[16],this.strip[i].edge0=this.cubeEdge[13])}findSurfaceCrossingEDI(t,r){let n=this.cubeVertexValue[t],i=this.cubeVertexValue[r];if(n===0||i===0)return Rp;let s=this.cubeVertex[t],o=this.cubeVertex[r];if(this.isInequality){let{posNeg:a,posNaN:u}=FO(this.f,s,o,n,i);return{posNeg:a!==void 0?this.pushPositionWithGradient(...a):void 0,posNaN:u!==void 0?this.pushPositionNoGradient(...u):void 0}}else{let a=wO(this.f,s,o,n,i);return{posNeg:a!==void 0?this.pushPositionWithGradient(...a):void 0}}}pushPositionWithGradient(t,r,n){if(!(isFinite(t)&&isFinite(r)&&isFinite(n)))return 0;let[i,s,o]=this.computeGradient(t,r,n),a=Math.sqrt(i*i+s*s+o*o);return i/=-a,s/=-a,o/=-a,Ma(i,s,o)?(this.normalFromGradient.push(!0),this._pushPositionAndNormal(t,r,n,i,s,o)):this.pushPositionNoGradient(t,r,n)}pushPositionNoGradient(t,r,n){return isFinite(t)&&isFinite(r)&&isFinite(n)?(this.allNormalsFromGradient=!1,this.normalFromGradient.push(!1),this._pushPositionAndNormal(t,r,n,0,0,0)):0}_pushPositionAndNormal(t,r,n,i,s,o){return this.positions.push(t,r,n),this.uvs.push((t-this.x.min)/this.x.width,(r-this.y.min)/this.y.width),this.normals.push(i,s,o),this.positions.length/3}computeGradient(t,r,n){let i=NaN,s=NaN,o=NaN;if(this.gradient&&([i,s,o]=this.gradient(t,r,n),isFinite(i)&&isFinite(s)&&isFinite(o)))return[i,s,o];let a=.001*Math.min(this.size.x,this.size.y,this.size.z),u=this.f(t,r,n);if(isFinite(i)||(i=(this.f(t+a,r,n)-u)/a),isFinite(i)||(i=(u-this.f(t-a,r,n))/a),isFinite(s)||(s=(this.f(t,r+a,n)-u)/a),isFinite(s)||(s=(u-this.f(t,r-a,n))/a),isFinite(o)||(o=(this.f(t,r,n+a)-u)/a),isFinite(o)||(o=(u-this.f(t,r,n-a))/a),isFinite(i)&&isFinite(s)&&isFinite(o))return[i,s,o];let c=NaN,l=NaN,p=NaN,f=NaN,y=NaN,h=NaN,m=a/2;return(!isFinite(i)||!isFinite(s))&&(c=(this.f(t+m,r+m,n)-u)/a,isFinite(c)||(c=(u-this.f(t-m,r-m,n))/a),l=(this.f(t+m,r-m,n)-u)/a,isFinite(l)||(l=(u-this.f(t-m,r+m,n))/a),isFinite(c)&&isFinite(l)&&(isFinite(i)||(i=c+l),isFinite(s)||(s=c-l))),(!isFinite(s)||!isFinite(o))&&(p=(this.f(t,r+m,n+m)-u)/a,isFinite(p)||(p=(u-this.f(t,r-m,n-m))/a),f=(this.f(t,r+m,n-m)-u)/a,isFinite(f)||(f=(u-this.f(t,r-m,n+m))/a),isFinite(p)&&isFinite(f)&&(isFinite(s)||(s=p+f),isFinite(o)||(o=p-f))),(!isFinite(o)||!isFinite(i))&&(y=(this.f(t+m,r,n+m)-u)/a,isFinite(y)||(y=(u-this.f(t-m,r,n-m))/a),h=(this.f(t-m,r,n+m)-u)/a,isFinite(h)||(h=(u-this.f(t+m,r,n-m))/a),isFinite(y)&&isFinite(h)&&(isFinite(i)||(i=y-h),isFinite(o)||(o=y+h))),[i,s,o]}generateTriangles(){for(let t=0;t<12;t++){let r=vV[t],n=[],i=0,s=OV[t],o=0,a=s[0],u=Math.abs(this.cubeVertexValue[a]);u>o&&isFinite(u)&&(o=u);let c=s[1],l=Math.abs(this.cubeVertexValue[c]);l>o&&isFinite(l)&&(o=l);let p=s[2],f=Math.abs(this.cubeVertexValue[p]);f>o&&isFinite(f)&&(o=f);let y=s[3],h=Math.abs(this.cubeVertexValue[y]);h>o&&isFinite(h)&&(o=h);let m=o*Number.EPSILON*32;if(u<=m){i|=35;let d=this.pushPositionWithGradient(...this.cubeVertex[a]);d!==void 0&&n.push(d)}if(l<=m){i|=21;let d=this.pushPositionWithGradient(...this.cubeVertex[c]);d!==void 0&&n.push(d)}if(f<=m){i|=14;let d=this.pushPositionWithGradient(...this.cubeVertex[p]);d!==void 0&&n.push(d)}if(h<=m){i|=56;let d=this.pushPositionWithGradient(...this.cubeVertex[y]);d!==void 0&&n.push(d)}if(n.length===4)continue;let b;for(let d=0;d<4;d++){let g=s[d];if(this.cubeVertexValue[g]>m){b=this.cubeVertex[g];break}}if(b===void 0&&this.isInequality)for(let d=0;d<6;d++){if(i>>d&1)continue;let{posNeg:g,posNaN:x}=this.cubeEdge[r[d]];if(Yu(g)&&Yu(x)){b=Io(this.positions.slice((g-1)*3,g*3),this.positions.slice((x-1)*3,x*3),.5);break}}if(b===void 0)for(let d=0;d<4;d++){let g=s[d];if(!isFinite(this.cubeVertexValue[g])){b=this.cubeVertex[g];break}}if(b!==void 0){if(this.isInequality){let d=[],g=[],x=!1;for(let M=0;M<6;M++){if(i>>M&1)continue;let{posNeg:E,posNaN:T}=this.cubeEdge[r[M]],D=Yu(E),S=Yu(T);D&&d.push(E),S&&g.push(T),D&&S&&(x=!0)}if(x){d.push(...n),this.pushTriangleFromCorners(g,b),this.pushTriangleFromCorners(d,b);continue}}for(let d=0;d<6;d++){if(i>>d&1)continue;let{posNeg:g,posNaN:x}=this.cubeEdge[r[d]],M=g||x;Yu(M)&&n.push(M)}this.pushTriangleFromCorners(n,b)}}}pushTriangleFromCorners(t,r){if(t.length>=3){let n=t[0]-1,i=t[1]-1,s=t[2]-1;this.pushTriangle(n,i,s,r)}if(t.length==4){let n=t[0]-1,i=t[2]-1,s=t[3]-1;this.pushTriangle(n,i,s,r)}}pushTriangle(t,r,n,i){this.allNormalsFromGradient||this.fixBadNormals(t,r,n,i),this.checkWindingOrder(t,r,n)&&([r,n]=[n,r]),this.triangles.push(t,r,n)}fixBadNormals(t,r,n,i){let s=!this.normalFromGradient[t],o=!this.normalFromGradient[r],a=!this.normalFromGradient[n];if(!(s||o||a))return;let u=this.positions,c=this.normals,l=new nr(u[3*t],u[3*t+1],u[3*t+2]),p=new nr(u[3*r],u[3*r+1],u[3*r+2]),f=new nr(u[3*n],u[3*n+1],u[3*n+2]),y=new nr().subVectors(f,l),h=new nr().subVectors(l,p);var m=y.cross(h);let b=new nr().subVectors(l,new nr(...i));m.dot(b)<0&&m.multiply(-1),m.isFinite()&&(s&&(c[3*t+0]+=m.x,c[3*t+1]+=m.y,c[3*t+2]+=m.z),o&&(c[3*r+0]+=m.x,c[3*r+1]+=m.y,c[3*r+2]+=m.z),a&&(c[3*n+0]+=m.x,c[3*n+1]+=m.y,c[3*n+2]+=m.z))}checkWindingOrder(t,r,n){let i=this.positions,s=this.normals,o=i[3*n]-i[3*t],a=i[3*n+1]-i[3*t+1],u=i[3*n+2]-i[3*t+2],c=i[3*t]-i[3*r],l=i[3*t+1]-i[3*r+1],p=i[3*t+2]-i[3*r+2],f=a*p-u*l,y=u*c-o*p,h=o*l-a*c,m=s[3*t],b=s[3*t+1],d=s[3*t+2];return f*m+y*b+h*d<0}},by=class{constructor(t,r,n,i,s,o,a,u,c){this.x0=t;this.y0=r;this.z0=n;this.dx=i;this.dy=s;this.dz=o;this.numX=a;this.numY=u;this.numZ=c}};function Xu(e,t){return[e[0],e[1],t(e)]}function Py(e,t,r,n){let{triangles:i,vertices:s}=SV(n,e,t,r),{extraAttrCount:o}=n,a=new Array(s.length),u=new Array(s.length*3),c=[],l=!1,p=new Array(s.length*3),f=new Array(s.length*2),y=new Array(s.length*o),h=[],m=0;function b(g){let x=s[g],M=n.getVertex(x);if(!M)return null;let E=n.getNormal(x);if(E?(p[3*m]=E[0],p[3*m+1]=E[1],p[3*m+2]=E[2]):(c[m]=!0,l=!0,p[3*m]=0,p[3*m+1]=0,p[3*m+2]=0),u[3*m]=M[0],u[3*m+1]=M[1],u[3*m+2]=M[2],f[2*m]=x[0],f[2*m+1]=x[1],o>0){let T=n.getExtraAttrs(x);for(let D=0;D<o;D++)y[o*m+D]=T[D]}return m++}function d(g){let x=a[g];return x===void 0?a[g]=b(g):x}for(let[g,x,M]of i){let E=d(g),T=d(x),D=d(M);if(E===null||T===null||D===null)continue;h.push(E,T,D);let S=c[E],O=c[T],A=c[D];if(S||O||A){let _=u,L=p,H=new nr(_[3*E],_[3*E+1],_[3*E+2]),w=new nr(_[3*T],_[3*T+1],_[3*T+2]),q=new nr(_[3*D],_[3*D+1],_[3*D+2]),$=new nr().subVectors(q,H),F=new nr().subVectors(H,w),Z=$.cross(F);if(!Z.isFinite())continue;S&&(L[3*E+0]+=Z.x,L[3*E+1]+=Z.y,L[3*E+2]+=Z.z),O&&(L[3*T+0]+=Z.x,L[3*T+1]+=Z.y,L[3*T+2]+=Z.z),A&&(L[3*D+0]+=Z.x,L[3*D+1]+=Z.y,L[3*D+2]+=Z.z)}}if(u.length=m*3,p.length=m*3,f.length=m*2,l)for(let g=0;g<m;g++){if(!c[g])continue;let x=p[3*g],M=p[3*g+1],E=p[3*g+2],T=Math.sqrt(x*x+M*M+E*E);p[3*g]=x/T,p[3*g+1]=M/T,p[3*g+2]=E/T}return{positions:u,normals:p,faces:h,uvs:f,extraAttrs:y}}var wT=class{constructor(t,r,n){this.params=t;this.uRange=r;this.vRange=n;this.vertices=[];this.triangles=[];this.edgeVertices=new Map;this.finiteVertices=new Map}addVertex(t){return this.vertices.push(t)-1}jumpAlongEdge(t,r){let n=[0,1];t>r&&([t,r]=[r,t],n=[1,0]);let i=r*r+t,s=this.edgeVertices.get(i);if(s!==void 0)return[s[n[0]],s[n[1]]];let o=this.params.findJumpBetweenTwo3DPoints(this.vertices[t],this.vertices[r]);if(o===void 0)return;let a=[this.addVertex(o[0]),this.addVertex(o[1])];return this.edgeVertices.set(i,a),[a[n[0]],a[n[1]]]}finiteAlongEdge(t,r){t>r&&([t,r]=[r,t]);let n=r*r+t,i=this.finiteVertices.get(n);if(i!==void 0)return i;let s=this.params.findFiniteBetweenTwoPoints(this.vertices[t],this.vertices[r]);if(s===void 0)return;let o=this.addVertex(s);return this.finiteVertices.set(n,o),o}pushTriangle(t,r,n){this.params.isDegenerate(this.vertices[t],this.vertices[r],this.vertices[n])||this.triangles.push([t,r,n])}getTriangles(){return this.triangles}};function SV(e,t,r,n){let i=n,s=[t.min,r.min],o=[t.max,r.max],{fn:a}=e,u=new wT(e,t,r);function c(d,g,x,M){u.pushTriangle(M[0],x,d),u.pushTriangle(M[1],g,x)}function l(d,g,x,M,E){u.pushTriangle(M[0],x,d),u.pushTriangle(M[0],E[1],x),u.pushTriangle(M[1],g,E[0])}function p(d,g,x){let M=u.jumpAlongEdge(d,g),E=u.jumpAlongEdge(g,x),T=u.jumpAlongEdge(x,d);if(M&&E&&T){let D=u.vertices[d],S=u.vertices[g],O=u.vertices[x],A=u.addVertex(Xu(hn(D,hn(S,O,.5),1e-4),a)),_=u.addVertex(Xu(hn(S,hn(O,D,.5),1e-4),a)),L=u.addVertex(Xu(hn(O,hn(D,S,.5),1e-4),a)),H=u.jumpAlongEdge(A,_),w=u.jumpAlongEdge(_,L),q=u.jumpAlongEdge(L,A);if(H&&w&&q)return;d=A,g=_,x=L,M=H,E=w,T=q}M&&E?l(d,g,x,M,E):E&&T?l(g,x,d,E,T):T&&M?l(x,d,g,T,M):M?c(d,g,x,M):E?c(g,x,d,E):T?c(x,d,g,T):u.pushTriangle(d,g,x)}function f(d,g,x){let M=u.finiteAlongEdge(g,x),E=u.finiteAlongEdge(d,x);E!==void 0&&M!==void 0&&(p(M,d,g),p(M,E,d))}function y(d,g,x){let M=u.finiteAlongEdge(d,g),E=u.finiteAlongEdge(d,x);M!==void 0&&E!==void 0&&p(d,M,E)}function h(d,g,x){let M=u.vertices[d][2],E=u.vertices[g][2],T=u.vertices[x][2],D=e.allowVertex(M),S=e.allowVertex(E),O=e.allowVertex(T);D&&S&&O?p(d,g,x):D&&S?f(d,g,x):S&&O?f(g,x,d):O&&D?f(x,d,g):D?y(d,g,x):S?y(g,x,d):O&&y(x,d,g)}let m=i-1,b=new Array(i*i);b[0]=u.addVertex(Xu(s,a));for(let d=1;d<=m;d++)b[d]=u.addVertex(Xu(tm(s,o,[d/m,0]),a)),b[i*d]=u.addVertex(Xu(tm(s,o,[0,d/m]),a));for(let d=1;d<=m;d++)for(let g=1;g<=m;g++){let x=b[(g-1)*i+(d-1)],M=b[g*i+(d-1)],E=b[(g-1)*i+d],T=u.addVertex(Xu(tm(s,o,[d/m,g/m]),a));b[g*i+d]=T,h(x,T,M),h(x,E,T)}return{triangles:u.getTriangles(),vertices:u.vertices}}var BO=80,pa=30;function Fo(e,t,r,n,i,s){function o(w){return[w[0],w[1],m(w)]}let a=t.xmin*6-t.xmax*5,u=t.xmax*6-t.xmin*5,c=t.ymin*6-t.ymax*5,l=t.ymax*6-t.ymin*5,p=t.zmin*6-t.zmax*5,f=t.zmax*6-t.zmin*5;function y(w){return w}function h(w){return p<=w[2]&&w[2]<=f&&c<=w[1]&&w[1]<=l&&a<=w[0]&&w[0]<=u}let m=w=>e(w[0],w[1]),b=w=>e(w[0],w[1]);function d(w){return r.min<=w[0]&&w[0]<=r.max&&n.min<=w[1]&&w[1]<=n.max}function g(w,q,$){let F=Qd(w,q),Z=em(b(F),$),re=rm(Z),Ee=Kd(w,q),K=em($,b(Ee)),fe=rm(K);return isNaN(fe)?Z:isNaN(re)?K:d(F)?d(Ee)&&re>fe?K:Z:K}let x=r.width/1e4,M=n.width/1e4;function E(w){let q=w[2],$=[w[0],w[1]],F=vc(g($,[x,0],q),g($,[0,M],q));if(Ma(...F))return F;let Z=Math.SQRT1_2;if(F=vc(g($,[Z*x,Z*-M],q),g($,[Z*x,Z*M],q)),Ma(...F))return F}function T(w){if(_(w[2]))return w[2]}function D(w){return w[2].slice(3)}function S(w,q){let $=w[2],F=0,Z=q[2],re=1,Ee=fe=>m(hn(w,q,fe));if(!isFinite($[0])||!isFinite($[1])||!isFinite($[2])||!isFinite($[0])||!isFinite($[1])||!isFinite($[2]))return;let K=FE(F,$,re,Z,Ee,(u-a)*1e-6);if(K)return[o(hn(w,q,qr(K[0],0,1e-5))),o(hn(w,q,qr(K[1],1,1e-5)))]}function O(w){return h(w)?w:[NaN,NaN,NaN]}function A(w,q){let $=Z=>O(m(hn(w,q,Z))),F=nm(0,O(w[2]),1,O(q[2]),$);if(F!==void 0)return o(hn(w,q,F))}function _(w){return h(w)}let L=((t.xmax-t.xmin)*1e-6)**2;function H(w,q,$){let F=w[2],Z=q[2];if(Nu(F,Z)<L)return!0;let re=$[2];return Nu(Z,re)<L||Nu(F,re)<L}return Py(r,n,i,{isDegenerate:H,getNormal:E,getVertex:T,extraAttrCount:s,getExtraAttrs:D,findJumpBetweenTwo3DPoints:S,findFiniteBetweenTwoPoints:A,allowVertex:_,fn:m})}var{floor:RV}=Math,K7=1e3;function NV(e){let t=[];for(let r of e.segments)t.push(...r),t.push(NaN,NaN,NaN);return t}function $u(e,t,r,n){(r===void 0||isNaN(r))&&(r=VT(t.min,t.max)),r=Jr(RV(r),2,2e3);let{xmin:i,xmax:s,ymin:o,ymax:a,zmin:u,zmax:c}=n.viewport;u!=null||(u=jr.zmin),c!=null||(c=jr.zmax);let l=Iy(e,{min:t.min,max:t.max,nInitialSamples:r,xtolerance:(s-i)/1e3,ytolerance:(a-o)/1e3,ztolerance:(c-u)/1e3,map:p=>p});return NV(l)}function Ty(e,t,r,n){let i=n.degreeMode?Math.PI/180:1;return $u(s=>{let o=e(s),a=o[0],u=o[1],c=o[2];return[a*tr(u*i),a*Ct(u*i),c]},t,r,n)}function FT(e,t,r,n){let i=n.degreeMode?Math.PI/180:1;return $u(s=>{let o=e(s),a=o[0],u=o[1],c=o[2];return[a*Ct(c*i)*tr(u*i),a*Ct(c*i)*Ct(u*i),a*tr(c*i)]},t,r,n)}function GO(e,t){return{type:\"linear\",s:e,t}}function zO(e,t){return{type:\"logarithmic\",s:e,t}}function HO(e,t){return{type:\"exponential\",s:e,t}}function AV([e,t],[r,n]){let i=(n-r)/(t-e),s=(r+n)/2-i*(t+e)/2;return GO(i,s)}function CV([e,t],[r,n]){let i=(n-r)/(Math.log(t)-Math.log(e)),s=(Math.log(t)*r-Math.log(e)*n)/(Math.log(t)-Math.log(e));return zO(i,s)}function _V([e,t],[r,n]){let i=(Math.log(n)-Math.log(r))/(t-e),s=(t*Math.log(r)-e*Math.log(n))/(t-e);return HO(i,s)}function BT(e,t,r){switch(e){case\"linear\":return AV(t,r);case\"logarithmic\":return CV(t,r);case\"exponential\":return _V(t,r);default:{let n=e;throw new Error(\"Unexpected scale type: \"+n)}}}function GT({type:e,s:t,t:r},n){switch(e){case\"linear\":return t*n+r;case\"logarithmic\":return t*Math.log(n)+r;case\"exponential\":return Math.exp(t*n+r);default:let i=e;throw new Error(\"Unexpected scale type: \"+i)}}function zT(e,t,r,n){switch(e){case\"linear\":return LV(t,r,n);case\"logarithmic\":return Math.pow(t,1-n)*Math.pow(r,n);case\"exponential\":return n===0?t:n===1?r:Math.log((1-n)*Math.exp(t)+n*Math.exp(r));default:let i=e;throw new Error(\"Unexpected scale type: \"+i)}}function LV(e,t,r){return(1-r)*e+r*t}function HT({type:e,s:t,t:r}){switch(e){case\"linear\":return GO(1/t,-r/t);case\"logarithmic\":return HO(1/t,-r/t);case\"exponential\":return zO(1/t,-r/t);default:let n=e;throw new Error(\"Unexpected scale type: \"+n)}}function UT(e){switch(e){case\"linear\":return\"linear\";case\"logarithmic\":return\"exponential\";case\"exponential\":return\"logarithmic\";default:let t=e;throw new Error(\"Unexpected scale type: \"+t)}}function kT({width:e,height:t}){return{left:0,right:e,top:0,bottom:t}}function Vo({xmin:e,xmax:t,ymin:r,ymax:n}){return{left:e,right:t,bottom:r,top:n}}var Xi=class e{constructor(t,r){this.xScale=t,this.yScale=r}static fromRects(t,r,{xAxisScale:n,yAxisScale:i}){return new e(BT(n,[t.left,t.right],[r.left,r.right]),BT(i,[t.bottom,t.top],[r.bottom,r.top]))}static fromRectsInverse(t,r,{xAxisScale:n,yAxisScale:i}){return e.fromRects(r,t,{xAxisScale:UT(n),yAxisScale:UT(i)})}inverse(){return new e(HT(this.xScale),HT(this.yScale))}mapX(t){return GT(this.xScale,t)}mapY(t){return GT(this.yScale,t)}mapPoint({x:t,y:r}){return{x:this.mapX(t),y:this.mapY(r)}}mapCoordinatePair([t,r]){return[this.mapX(t),this.mapY(r)]}mapRect({top:t,bottom:r,left:n,right:i}){return{left:this.mapX(n),right:this.mapX(i),bottom:this.mapY(r),top:this.mapY(t)}}interpolateX(t,r,n){return zT(this.xScale.type,t,r,n)}interpolateY(t,r,n){return zT(this.yScale.type,t,r,n)}dangerouslyGetXScaleFactor(){if(this.xScale.type!==\"linear\")throw new Error(`Cannot get scale factor a '${this.xScale.type}' scale`);return this.xScale.s}dangerouslyGetYScaleFactor(){if(this.yScale.type!==\"linear\")throw new Error(`Cannot get scale factor a '${this.yScale.type}' scale`);return this.yScale.s}};function qT(e,t){return[e[0],e[1],t(e)]}function Ey(e,t,r,n,i,s=[0,1,2]){let o=new Ie(n.min-5*n.width,n.max+5*n.width),{min:a,max:u}=o,c=n.width/1e3,l=A=>e(A[0],A[1]),p=A=>{let _=l(A);return _<o.min||_>o.max?NaN:_};function f(A,_,L){let H=l(Qd(A,_))-L,w=L-l(Kd(A,_)),q=isNaN(w)?H:isNaN(H)||Math.abs(H)>Math.abs(w)?w:H;return[_[0],_[1],q]}let y=t.width/1e4,h=r.width/1e4,[m,b,d]=s;function g(A){let _=A[2],L=vc(f(A,[y,0],_),f(A,[0,h],_));if(Ma(...L))return[L[m],L[b],L[d]];let H=Math.SQRT1_2;if(L=vc(f(A,[H*y,H*-h],_),f(A,[H*y,H*h],_)),Ma(...L))return[L[m],L[b],L[d]]}function x(A){if(T(A[2]))return[A[m],A[b],A[d]]}function M(A,_){let L=A[2],H=0,w=_[2],q=1,$=Z=>l(hn(A,_,Z));if(!isFinite(L)||!isFinite(w))return;let F=wE(H,L,q,w,$,c);if(F)return[qT(hn(A,_,qr(F[0],0,1e-5)),l),qT(hn(A,_,qr(F[1],1,1e-5)),l)]}function E(A,_){let L=$=>p(hn(A,_,$)),H=A[2],w=_[2],q=Fn(0,a<H&&H<u?H:NaN,1,a<w&&w<u?w:NaN,L);if(q!==void 0)return qT(hn(A,_,q),l)}function T(A){return a<A&&A<u}let D=t.width*1e-6,S=r.width*1e-6;function O(A,_,L){return Math.abs(A[0]-_[0])<D&&Math.abs(A[1]-_[1])<S||Math.abs(_[0]-L[0])<D&&Math.abs(_[1]-L[1])<S||Math.abs(L[0]-A[0])<D&&Math.abs(L[1]-A[1])<S}return Py(t,r,i,{isDegenerate:O,getNormal:g,getExtraAttrs:()=>[],extraAttrCount:0,getVertex:x,findJumpBetweenTwo3DPoints:M,findFiniteBetweenTwoPoints:E,allowVertex:T,fn:l})}var UO=1,kO=2,qO=4,YO=8,XO=15,fZ=12,dZ=3,$O=1,ZO=2,WO=3,jO=4,JO=5,QO=6;function mZ(e,t,r){let n=[],i=e.length;if(r===JO)for(let s=0;s<i;s+=2){let o=t.mapX(e[s]),a=t.mapY(e[s+1]);n.push(o,a)}else if(r===QO)for(let s=0;s<i;s+=2){let o=t.mapX(e[s+1]),a=t.mapY(e[s]);n.push(o,a)}else if(r===$O)for(let s=0;s<e.length;s+=2){let o=e[s],a=e[s+1],u=t.mapX(a*Math.cos(o)),c=t.mapY(a*Math.sin(o));n.push(u,c)}else if(r===ZO)for(let s=0;s<e.length;s+=2){let o=e[s],a=e[s+1];a<0&&(a=0);let u=t.mapX(a*Math.cos(o)),c=t.mapY(a*Math.sin(o));n.push(u,c)}else if(r===WO)for(let s=0;s<e.length;s+=2){let o=e[s]*Math.PI/180,a=e[s+1],u=t.mapX(a*Math.cos(o)),c=t.mapY(a*Math.sin(o));n.push(u,c)}else if(r===jO)for(let s=0;s<e.length;s+=2){let o=e[s]*Math.PI/180,a=e[s+1];a<0&&(a=0);let u=t.mapX(a*Math.cos(o)),c=t.mapY(a*Math.sin(o));n.push(u,c)}return n}function Np(e,t){return FV(e,t,XO,!0)}function yZ(e,t){return VV(e,t,XO,!0)}function My(e,t,r,n){let i=[],s,o,a,u;n?(o=e[0],a=e[1],s=2,u=t(o,a),u&&i.push(o,a)):(o=e[e.length-2],a=e[e.length-1],s=0,u=t(o,a));for(let c=s;c<e.length;c+=2){let l=o,p=a,f=u;o=e[c],a=e[c+1],u=t(o,a),!(!u&&!f)&&(u&&f&&i.push(o,a),u&&!f&&(i.push(...r(o,a,l,p)),i.push(o,a)),!u&&f&&i.push(...r(l,p,o,a)))}return i}function Dy(e,t,r,n){let i=[[]],s=0,o,a,u,c;n?(a=e[0],u=e[1],o=2,c=t(a,u),c&&i[s].push(a,u)):(a=e[e.length-2],u=e[e.length-1],o=0,c=t(a,u));for(let l=o;l<e.length;l+=2){let p=a,f=u,y=c;a=e[l],u=e[l+1],c=t(a,u),!(!c&&!y)&&(c&&y&&i[s].push(a,u),c&&!y&&(i[s].push(...r(a,u,p,f)),i[s].push(a,u)),!c&&y&&(i[s].push(...r(p,f,a,u)),s++,i[s]=[]))}return i.filter(l=>l.length>0)}var KO=e=>function(t,r){return t>=e},eS=e=>function(t,r){return t<=e},tS=e=>function(t,r){return r>=e},rS=e=>function(t,r){return r<=e},nS=e=>function(t,r,n,i){let s=i-r;return[e,r+s*(e-t)/(n-t)]},iS=e=>function(t,r,n,i){let s=i-r;return[e,r+s*(e-t)/(n-t)]},sS=e=>function(t,r,n,i){let s=n-t;return[t+s*(e-r)/(i-r),e]},oS=e=>function(t,r,n,i){let s=n-t;return[t+s*(e-r)/(i-r),e]};function FV(e,t,r,n){let i=e;return r&qO&&(i=My(e,KO(t.xmin),nS(t.xmin),n)),r&kO&&(i=My(i,tS(t.ymin),sS(t.ymin),n)),r&YO&&(i=My(i,eS(t.xmax),iS(t.xmax),n)),r&UO&&(i=My(i,rS(t.ymax),oS(t.ymax),n)),i}function VV(e,t,r,n){let i=[e];return r&qO&&(i=ul(i.map(s=>Dy(s,KO(t.xmin),nS(t.xmin),n)),!0)),r&kO&&(i=ul(i.map(s=>Dy(s,tS(t.ymin),sS(t.ymin),n)),!0)),r&YO&&(i=ul(i.map(s=>Dy(s,eS(t.xmax),iS(t.xmax),n)),!0)),r&UO&&(i=ul(i.map(s=>Dy(s,rS(t.ymax),oS(t.ymax),n)),!0)),i}function gZ(e,t,r){let n=[],i=e[0],s=i+r,o=[];n.push(o);for(let a=0;a<e.length;a+=2){let u=e[a],c=e[a+1];if(c<0&&(c=0),u>=s){for(o=[],n.push(o),i=e[a-2],s=i;u>=s;)s+=r;a-=4}else o.push(u,c)}if(t===0)for(let a=0;a<n.length;a++)n[a].push(0,0);else{let a=r/16,u=t;for(let c=0;c<n.length;c++){let l=n[c];i=l[0],s=l[l.length-2];for(let p=s;p>i;p-=a)l.push(p,u);l.push(i,u)}}return n}function hZ(e,t){return e=e.slice(),e.push(e[e.length-2],t),e.push(e[0],t),[e]}function bZ(e,t,r){switch(e){case 1:return QO;case 8:case 5:case 2:return JO;case 6:return r.degreeMode?t?jO:WO:t?ZO:$O}}var{floor:BV}=Math,aS=1e4,vy=class{constructor(){this.xmin=jr.xmin;this.xmax=jr.xmax;this.ymin=jr.ymin;this.ymax=jr.ymax;this.zmin=jr.zmin;this.zmax=jr.zmax}},GV=0;function Ni(){return\"result_\"+GV++}function zV(){return{zeros:{x:[],y:[]},extrema:{x:[],y:[]},intercept:{x:[],y:[]}}}function dS(e){return{graphMode:15,error:e,segments:[]}}function XT(e,t){let r=e[0]+t.min*e[1],n=e[0]+t.max*e[1],i={zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}};if(!isFinite(r)||!isFinite(n))return{segments:[],poi:i,resolved:!0};let s=[[t.min,r,t.max,n]],o=-e[0]/e[1];return!isNaN(o)&&o>=t.min&&o<=t.max&&(i.zeros.x.push(o),i.zeros.y.push(0)),0>=t.min&&0<=t.max&&(i.intercept.x.push(0),i.intercept.y.push(e[0])),{segments:s,poi:i,resolved:!0}}function HV(e,t){let r=XT(e[0],t),n=XT(e[1],t);return r.segments.length&&n.segments.length&&r.segments[0].length===4&&n.segments[0].length===4?{segments:[[r.segments[0][1],n.segments[0][1],r.segments[0][3],n.segments[0][3]]],resolved:!0}:{segments:[],resolved:!0}}function UV(e,t){let r=e(t);return{segments:[[...r,...r]],resolved:!0}}function uS(e,t,r){let{mappedFn:n,jumpTolerance:i,screen:s}=r,[o,a]=e,[u,c]=t,l=Yo(o,u),p=n(l),f=s.height;if(!(a<0&&c<0&&(a>=p||c>=p))&&!(a>f&&c>f&&(a<=p||c<=p)))return Oc(o,a,l,p,u,c,n,i)}var YT=(e,t,r)=>{let{fn:n,mappedFn:i,jumpTolerance:s,accumulator:o}=r;if(!isFinite(s)||s<=0)return;let a=uS(e,t,r);if(!a)return;let u=(t[0]-e[0])/10,c=[-u,u],l;for(let p=0;p<c.length;p++){let f=e[0]+c[p],y=i(f);isFinite(y)||([f,y]=e,f=e[0],y=e[1]);let h=t[0]+c[p],m=i(h);if(isFinite(m)?l=h:[h,m]=t,uS([f,y],[h,m],r)){let[b,d]=a;o.addPoint([b,n(b)]),o.breakSegment(),o.addPoint([d,n(d)]);return}}return l},$T=class{constructor(t,r,n){let i=s=>r.mathToPixels.mapY(t(s));this.derivative=n,this.accumulator=new Sp(r,t,n),this.fn=t,this.mathToPixels=r.mathToPixels,this.mappedFn=i,this.jumpTolerance=r.tolerance||0,this.screen=r.screen}};function cS(e,t,r,n){let i=r,s=e(i),o=t.mapY(s);return isFinite(o)||(i=r+n,s=e(i),o=t.mapY(s)),isFinite(o)||(i=r-n,s=e(i),o=t.mapY(s)),[i,s,o]}function WT(e,t,r){let n=new $T(e,t,r),{mathToPixels:i,mappedFn:s}=n,o=t.nInitialSamples,a=Math.abs(i.interpolateX(t.min,t.max,1/(o-1))-t.min)/10,[u,c,l]=cS(e,i,t.min,a);isFinite(l)&&n.accumulator.addPoint([u,c]);for(var p=1;p<o;p++){let f=i.interpolateX(t.min,t.max,p/(o-1)),y=Math.abs(u-f)/10,[h,m,b]=cS(e,i,f,y);if(isFinite(b)&&isFinite(l)){let d=YT([u,l],[h,b],n);d!==void 0&&(h=d,m=e(h),b=i.mapY(m)),n.accumulator.addPoint([h,m])}else if(isFinite(b)&&!isFinite(l)){let d=Fn(u,l,h,b,s);if(d!==void 0){d!==h&&n.accumulator.addPoint([d,e(d)]);let g=YT([d,s(d)],[h,b],n);g!==void 0&&(h=g,m=e(h),b=i.mapY(m)),n.accumulator.addPoint([h,m])}}else if(!isFinite(b)&&isFinite(l)){let d=Fn(u,l,h,b,s);if(d!==void 0){let g=YT([u,l],[d,s(d)],n);g!==void 0&&(d=g),d!==u&&n.accumulator.addPoint([d,e(d)]),n.accumulator.breakSegment()}}u=h,c=m,l=b}return n.accumulator.finish()}function kV(e){let{fn:t,min:r,max:n}=e,i=Math.floor(r),s=Math.ceil(n),o=!0;s-i+1>aS&&(s=i+(aS-1),o=!1);let a=[];for(let u=i;u<=s;u++){let c=t(u);!isFinite(u)||!isFinite(c)||a.push([u,c])}return{segments:a,resolved:o}}function qV(e,t,r,n){let i=t.min,s=t.max-t.min,o=t.rtoleranceMath,a=Math.floor(s/(Math.PI/r)),u,c,l;function p(f,y){let h=y%2===0?1:-1;if(!n&&h===-1)return!1;let m=y*(Math.PI/r),b=[i,i+1,i+2,i+3],d=!1;for(let g=0,x=b.length;g<x;g++){let M=f(b[g]),E=f(b[g]+m);if(isFinite(M)&&isFinite(E)&&(d=!0),isFinite(M)!==isFinite(E)||Math.abs(M-h*E)>o)return!1}return!!d}for(u=1;u<=a;u++)if(p(e,u)){for(l=u,c=2;c*u<=a;c++)p(e,c*u)||(l=void 0);if(l)break}return l?l*(Math.PI/r):null}function mS(e){return[e[1]*Math.cos(e[0]),e[1]*Math.sin(e[0])]}function Iy(e,t){if(t.max<t.min)return{segments:[],resolved:!0};let{xtolerance:r,ytolerance:n,ztolerance:i,map:s}=t,o=new la({xtolerance:r,ytolerance:n,ztolerance:i,map:s}),a=10,u=t.min,c=e(u);isFinite(c[0])&&isFinite(c[1])&&o.addPoint(c);let l=t.nInitialSamples;for(let p=1;p<l;p++){let f=p/(l-1),y=(1-f)*t.min+f*t.max,h=e(y);Ap(e,u,c,y,h,a,o,t.screen),u=y,c=h}return o.finish()}function YV(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Ap(e,t,r,n,i,s,o,a){if(n===t)return;let{xtolerance:u,ytolerance:c,ztolerance:l,map:p}=o,f=Yo(t,n),y=e(f),h=p(r),m=p(i),b=p(y),d=isFinite(h[0])&&isFinite(h[1])&&(h.length===2||isFinite(h[2])),g=isFinite(m[0])&&isFinite(m[1])&&(m.length===2||isFinite(m[2])),x=isFinite(b[0])&&isFinite(b[1])&&(b.length===2||isFinite(b[2]));if(s===0||f===t||f===n){o.breakSegment(),g&&o.addPoint(i);return}if(!(!d&&!g)){if(d!==g){let M=t,E=n,T=r,D=i;for(;t!==f&&f!==n;)x==d?(t=f,r=y,h=b,d=x):(n=f,i=y,m=b,g=x),f=t+(n-t)/2,y=e(f),b=p(y),x=isFinite(b[0])&&isFinite(b[1])&&(b.length===2||isFinite(b[2]));d?(Ap(e,M,T,t,r,s-1,o,a),o.breakSegment()):(o.breakSegment(),o.addPoint(i),Ap(e,n,i,E,D,s-1,o,a));return}if(d&&x&&g){let M=YV(h,m),E=Rs(b[0],b[1],b[2]||0,h[0],h[1],h[2]||0,m[0],m[1],m[2]||0),T=E>.2&&E<.8&&Math.abs(b[0]-(h[0]+E*(m[0]-h[0])))<=u&&Math.abs(b[1]-(h[1]+E*(m[1]-h[1])))<=c&&(h.length===2||Math.abs(b[2]-(h[2]+E*(m[2]-h[2])))<=l);if(M||T||a&&XV(h,b,m,a)){o.addPoint(i);return}}Ap(e,t,r,f,y,s-1,o,a),Ap(e,f,y,n,i,s-1,o,a)}}function XV(e,t,r,{width:n,height:i}){return e[0]<0&&r[0]<0&&(e[0]>=t[0]||r[0]>=t[0])||e[0]>n&&r[0]>n&&(e[0]<=t[0]||r[0]<=t[0])||e[1]<0&&r[1]<0&&(e[1]>=t[1]||r[1]>=t[1])||e[1]>i&&r[1]>i&&(e[1]<=t[1]||r[1]<=t[1])}function $V(){return Ci({positions:[],normals:[],faces:[],uvs:[],extraAttrs:[]})}function jT(e,t,r,n,{isInequality:i}){let s=VO(e.fn,t,r,n,{isInequality:i});return Ci(s)}function lS(e,t,r,n,i){let s=Fo(e,t,r,n,i,0);return Ci(s)}function ZV(e,t,r,n,i,s){let o=s?Math.PI/180:1,a=e.fn,u=Fo((c,l)=>{let[p,f,y]=a(c,l);return[p*tr(f*o),p*Ct(f*o),y,p,f]},t,r,n,i,2);return Ci(u)}function WV(e,t,r,n,i,s){let o=s?Math.PI/180:1,a=e.fn,u=Fo((c,l)=>{let[p,f,y]=a(c,l);return[p*Ct(y*o)*tr(f*o),p*Ct(y*o)*Ct(f*o),p*tr(y*o),p,f,y]},t,r,n,i,3);return Ci(u)}function jV(e,t,r){let n=e.fn,i=Ey((s,o)=>n(s,o),new Ie(t.xmin,t.xmax),new Ie(t.ymin,t.ymax),new Ie(t.zmin,t.zmax),r);return Ci(i)}function JV(e,t,r){let n=e.fn,i=Ey((s,o)=>n(s,o),new Ie(t.ymin,t.ymax),new Ie(t.zmin,t.zmax),new Ie(t.xmin,t.xmax),r,[2,0,1]);return Ci(i)}function QV(e,t,r){let n=e.fn,i=Ey((s,o)=>n(o,s),new Ie(t.zmin,t.zmax),new Ie(t.xmin,t.xmax),new Ie(t.ymin,t.ymax),r,[1,2,0]);return Ci(i)}function KV(e,t,r,n,i,s){let o=s?Math.PI/180:1,a=e.fn,u=Fo((c,l)=>[c*tr(l*o),c*Ct(l*o),a(c,l)],t,r,n,i,0);return Ci(u)}function e3(e,t,r,n,i,s){let o=s?Math.PI/180:1,a=e.fn,u=Fo((c,l)=>{let p=a(c,l);return[p*tr(c*o),p*Ct(c*o),l,p]},t,r,n,i,1);return Ci(u)}function t3(e,t,r,n,i,s){let o=s?Math.PI/180:1,a=e.fn,u=Fo((c,l)=>{let p=a(c,l);return[p*Ct(l*o)*tr(c*o),p*Ct(l*o)*Ct(c*o),p*tr(l*o),p]},t,r,n,i,1);return Ci(u)}function Ci(e){let{positions:t,normals:r,faces:n,uvs:i,extraAttrs:s}=e;return{guid:Ni(),positions:new Float32Array(t),normals:new Float32Array(r),faces:new Uint32Array(n),uvs:new Float32Array(i),extraAttrs:new Float32Array(s)}}function pS(e){for(let t of e)if(t!==0)return!1;return!0}function yS(e,t){let{min:r,max:n,mathToPixels:i,nInitialSamples:s}=t,o=i.interpolateX(r,n,0),a=e(o),u=pS(a),c=!1,l=[];for(var p=1;p<s;p++){let f=i.interpolateX(r,n,p/(s-1)),y=e(f),h=pS(y);if(u){o=f,a=y,h||(u=!1);continue}if(h){c?(u=!0,c=!1):c=!0;continue}let m=_E(o,a,f,y,e);m!==void 0&&l.push(m),o=f,a=y}return l}function gS(e){if(!e)return!1;let t=e.viewport.xmin,r=e.viewport.xmax,n=e.viewport.ymin,i=e.viewport.ymax;return!(!isFinite(t)||!isFinite(r)||r<=t||!isFinite(n)||!isFinite(i)||i<=n||!isFinite(e.screen.width)||e.screen.width<=0||!isFinite(e.screen.height)||e.screen.height<=0)}function VT(e,t){let r=t-e;return 1+Math.ceil(r/(r/1e3))}function jc(e,t,r){var q,$,F,Z,re,Ee,K,fe,at;let{viewport:n,screen:i,xAxisScale:s,yAxisScale:o,degreeMode:a}=e,u=a?Math.PI/180:1,c=e.viewport.xmin,l=e.viewport.xmax,p=e.viewport.ymin,f=e.viewport.ymax,y=(q=e.viewport.zmin)!=null?q:jr.zmin,h=($=e.viewport.zmax)!=null?$:jr.zmax,m=((F=t.domain)==null?void 0:F.type)===\"2d\",{uMin:b,uMax:d,vMin:g,vMax:x}=((Z=t.domain)==null?void 0:Z.type)===\"2d\"?t.domain:{uMin:0,uMax:1,vMin:0,vMax:1};var M=t.lineWidth;if(t.willConvertTo3D||M>3){let me=t.willConvertTo3D?200:e.screen.width;var E=M*(l-c)/me;let Kt=t.willConvertTo3D?200:e.screen.height;var T=M*(f-p)/Kt;c-=E,l+=E,p-=T,f+=T}let S=1/4,O=.05,A=kT({width:500,height:500}),_=t.domainBound,L,H=Xi.fromRects(Vo(n),kT(i),{xAxisScale:s,yAxisScale:o}),w={xmin:c,xmax:l,ymin:p,ymax:f,zmin:y,zmax:h};switch(t.graphMode){case 1:switch(L=Cn(Ii([p,f]),_),L.type){case\"empty\":return!1;case\"known\":p=L.bounds[0],f=L.bounds[1]}let me=1+Math.ceil(Math.abs(H.mapY(f)-H.mapY(p))/S),Kt=new Xi(H.yScale,H.xScale);return{min:p,max:f,tolerance:S,nInitialSamples:me,mathToPixels:Kt,screen:{width:i.height,height:i.width}};case 2:{switch(L=Cn(Ii([c,l]),_),L.type){case\"empty\":return!1;case\"known\":c=L.bounds[0],l=L.bounds[1]}let Ge=1+Math.ceil(Math.abs(H.mapX(l)-H.mapX(c))/S);return{min:c,max:l,tolerance:S,nInitialSamples:Ge,mathToPixels:H,screen:i}}case 6:{let Ge=e.degreeMode?Math.PI/180:1;if(((re=t.domain)==null?void 0:re.type)!==\"1d\")throw new Error(\"Expected polar graph to have domain\");let{min:Ze,max:U}=t.domain;switch(L=Cn(Ii([Ze,U]),_),L.type){case\"empty\":return!1;case\"known\":Ze=L.bounds[0],U=L.bounds[1]}let z=1+Math.min(Math.ceil(Ge*Math.abs(U-Ze)/(2*Math.PI)*1e3),12e3),Me=Math.abs(H.mapX(l)-H.mapX(c)),ae=Math.abs(H.mapY(f)-H.mapY(p)),be=Math.hypot(Me,ae),hr=Math.hypot(l-c,f-p)/be,_t={min:Ze,max:U,screen:i,nInitialSamples:z,xtolerance:S,ytolerance:S,rtoleranceMath:hr,map:([or,Xr])=>H.mapCoordinatePair(mS([or,Xr]))};if(!t.domain.isExplicit){let or=qV(r,_t,Ge,t.operator===\"=\");or&&(_t.max=_t.min+or,_t.nInitialSamples=1+Math.min(Math.ceil(Ge*Math.abs(_t.max-_t.min)/(2*Math.PI)*1e3),12e3))}return _t}case 5:case 100:case 101:case 102:{let Ge={min:0,max:1},{min:Ze,max:U}=((Ee=t.domain)==null?void 0:Ee.type)===\"1d\"?t.domain:Ge;switch(L=Cn(Ii([Ze,U]),_),L.type){case\"empty\":return!1;case\"known\":Ze=L.bounds[0],U=L.bounds[1]}return{min:Ze,max:U,screen:i,nInitialSamples:VT(Ze,U),xtolerance:S,ytolerance:S,ztolerance:S,map:([z,Me])=>H.mapCoordinatePair([z,Me])}}case 8:return{xmin:c,xmax:l,ymin:p,ymax:f,mathToPixels:H,tolerance:S};case 106:return ee(W({},w),{u:new Ie(c,l),v:new Ie(p,f)});case 120:case 122:case 107:return ee(W({},w),{u:new Ie(p,f),v:new Ie(y,h)});case 121:case 123:case 108:return ee(W({},w),{u:new Ie(c,l),v:new Ie(y,h)});case 109:return ee(W({},w),{u:new Ie(b,m?d:jr.xmax),v:new Ie(g,m?x:2*Math.PI)});case 124:case 110:{let{min:Ge,max:Ze}=((K=t.domain)==null?void 0:K.type)===\"1d\"?t.domain:{min:0,max:2*Math.PI};return ee(W({},w),{u:new Ie(Ge,Ze),v:new Ie(y,h)})}case 211:{let{min:Ge,max:Ze}=((fe=t.domain)==null?void 0:fe.type)===\"1d\"?t.domain:{min:0,max:2*Math.PI/u},U={xmin:Ge,xmax:Ze,ymin:y,ymax:h};return ee(W(W({},w),U),{u:new Ie(Ge,Ze),v:new Ie(y,h),mathToPixels:Xi.fromRects(Vo(U),A,{xAxisScale:s,yAxisScale:o}),tolerance:O})}case 212:{let Ge=m?d:2*Math.PI/u,Ze=m?x:Math.PI/u,U={xmin:b,xmax:Ge,ymin:g,ymax:Ze};return ee(W(W({},w),U),{u:new Ie(b,Ge),v:new Ie(g,Ze),mathToPixels:Xi.fromRects(Vo(U),A,{xAxisScale:s,yAxisScale:o}),tolerance:O})}case 215:case 214:{let Ge={xmin:b,xmax:d,ymin:g,ymax:x};return ee(W(W({},w),Ge),{u:new Ie(b,d),v:new Ie(g,g),mathToPixels:Xi.fromRects(Vo(Ge),A,{xAxisScale:s,yAxisScale:o}),tolerance:O})}case 213:{let Ge=m?d:jr.xmax,Ze=m?x:2*Math.PI/u,U={xmin:b,xmax:Ge,ymin:g,ymax:Ze};return ee(W(W({},w),U),{u:new Ie(b,Ge),v:new Ie(g,Ze),mathToPixels:Xi.fromRects(Vo(U),A,{xAxisScale:s,yAxisScale:o}),tolerance:O})}case 125:case 111:return ee(W({},w),{u:new Ie(b,m?d:2*Math.PI/u),v:new Ie(g,m?x:Math.PI/u)});case 117:case 118:case 119:case 129:case 130:case 103:case 104:case 105:case 112:case 126:case 113:case 127:case 210:case 114:case 115:case 116:return ee(W({},w),{u:new Ie(b,d),v:new Ie(g,x)});case 200:case 201:case 202:case 206:case 205:case 203:case 204:case 207:case 208:{if(t.graphMode===200&&(t.slice_coordinate===\"z\"||t.slice_coordinate===\"_implicit\"))return{xmin:c,xmax:l,ymin:p,ymax:f,mathToPixels:H,tolerance:S};if(t.graphMode===201&&(t.slice_coordinate===\"x\"||t.slice_coordinate===\"_implicit\")){let U={xmin:p,xmax:f,ymin:y,ymax:h};return ee(W({},U),{mathToPixels:Xi.fromRects(Vo(U),A,{xAxisScale:s,yAxisScale:o}),tolerance:O})}if(t.graphMode===202&&(t.slice_coordinate===\"y\"||t.slice_coordinate===\"_implicit\")){let U={xmin:c,xmax:l,ymin:y,ymax:h};return ee(W({},U),{mathToPixels:Xi.fromRects(Vo(U),A,{xAxisScale:s,yAxisScale:o}),tolerance:O})}let{min:Ge,max:Ze}=((at=t.domain)==null?void 0:at.type)===\"1d\"?t.domain:{min:0,max:2*Math.PI};return{x:new Ie(c,l),y:new Ie(p,f),z:new Ie(y,h),t:new Ie(Ge,Ze),u:new Ie(b,d),v:new Ie(g,x)}}case 209:{if(t.slice_coordinate===\"z\")return{xmin:c,xmax:l,ymin:p,ymax:f,mathToPixels:H,tolerance:O};if(t.slice_coordinate===\"x\"){let Ge={xmin:p,xmax:f,ymin:y,ymax:h};return ee(W({},Ge),{mathToPixels:Xi.fromRects(Vo(Ge),A,{xAxisScale:s,yAxisScale:o}),tolerance:O})}if(t.slice_coordinate===\"y\"){let Ge={xmin:c,xmax:l,ymin:y,ymax:h};return ee(W({},Ge),{mathToPixels:Xi.fromRects(Vo(Ge),A,{xAxisScale:s,yAxisScale:o}),tolerance:O})}return t.slice_coordinate===\"_implicit\"?ee(W({},w),{u:new Ie(c,l),v:new Ie(p,f)}):!1}default:return!1}}function Oy(e){let{viewState:t,graphInfo:r,compiled:n,maxOverride:i,showPoint:s}=e,o=n.fn,a=jc(t,r,o),u;if(!a)u={segments:[],resolved:!0};else{let{min:p,max:f}=a;u=kV({fn:o,min:Math.max(p,0),max:i!==void 0?Math.min(i,f):f})}let{points:c,droppedIndices:l}=Cp(u.segments);return{segments:[c],droppedIndices:l,graphMode:3,color:r.color,style:r.pointStyle,poi:xs(u.segments),showPoint:s}}function r3(e){switch(e){case 120:case 122:return 107;case 121:case 123:return 108;case 124:return 110;case 125:return 111;case 126:return 112;case 127:return 113;default:return e}}function hS(e,t,r){let n=r?Math.PI/180:1;switch(e){case 114:return t;case 115:{let[i,s,o]=t;return[i*tr(s*n),i*Ct(s*n),o]}case 116:{let[i,s,o]=t;return[i*Ct(o*n)*tr(s*n),i*Ct(o*n)*Ct(s*n),i*tr(o*n)]}default:return[0,0,0]}}function fa(e){var m,b,d,g,x,M,E,T,D,S;let{viewState:t,graphInfo:r,compiled:n,derivative:i}=e,s=n.fn,{degreeMode:o}=t,a=o?Math.PI/180:1,u=jc(t,r,s),c,l,p,f=r3(r.graphMode),y=t.xAxisScale===\"linear\"&&t.yAxisScale===\"linear\";if(!u)c={segments:[],resolved:!0};else{switch(f){case 1:case 2:let O=i?i.fn:void 0;c=r.isLinear&&y&&zs(r.linearCoefficients)?XT(r.linearCoefficients,u):WT(s,u,O);break;case 6:c=Iy(q=>[q,s(q)],u);break;case 8:c=RT(s,u);break;case 5:u.max===u.min?c=UV(s,u.min):c=r.isLinear&&y&&zs(r.linearCoefficients)?HV(r.linearCoefficients,u):Iy(s,u);break;case 100:case 101:case 102:let{min:A,max:_}=((m=r.domain)==null?void 0:m.type)===\"1d\"?r.domain:{min:0,max:1},L=new Ie(A,_),H=[],w=n.fn;switch(f){case 100:H=$u(w,L,r.resolution,t);break;case 101:H=Ty(w,L,r.resolution,t);break;case 102:H=FT(w,L,r.resolution,t);break}return{graphMode:100,guid:Ni(),points:H,color:r.color,thickness:r.lineWidth};case 112:case 113:case 130:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:{let q=u,{u:$,v:F}=q,Z=f===112||f===113,re=r.graphMode===122||r.graphMode===123,Ee=Z?xy:re?2:BO,{resolution:K}=r,fe=K===void 0||isNaN(K)?Ee:Jr(BV(K),2,100),at=Ii([$.min,$.max]).type!==\"empty\"&&Ii([F.min,F.max]).type!==\"empty\",me;switch(at&&f){case 103:{let Ze=n.fn;me=lS(Ze,q,$,F,fe);break}case 130:{me=lS((U,z)=>{let[Me,ae]=n.fn(U,z);return[Me,ae,0]},q,$,F,fe);break}case 104:me=ZV(n,q,$,F,fe,o);break;case 105:me=WV(n,q,$,F,fe,o);break;case 106:me=jV(n,q,fe);break;case 107:me=JV(n,q,fe);break;case 108:me=QV(n,q,fe);break;case 109:me=KV(n,q,$,F,fe,o);break;case 110:me=e3(n,q,$,F,fe,o);break;case 111:me=t3(n,q,$,F,fe,o);break;case 112:case 113:me=jT(n,e.gradient,u,fe,{isInequality:(b=e.isImplicit3dInequality)!=null?b:!1});break;case!1:me=$V();break}let Kt=r.graphMode===113||r.graphMode===127;return{meshData:me,color:r.color,fillOpacity:Kt?1:(d=r.fillOpacity)!=null?d:1,uvRange:[$,F],uvArgs:(g=_i[r.graphMode])!=null?g:[],extraMeshArgs:(x=Wu[r.graphMode])!=null?x:[],checkers:(M=r.checkers)!=null?M:pa,graphMode:f,compiled:n,restrictionShader:e.restrictionShader3d}}case 200:case 201:case 202:case 211:case 206:case 205:case 203:case 204:case 213:case 207:case 208:case 212:case 214:case 215:case 209:{let q=(U,z)=>{let Me=RT(U,z);return{segments:Me.segments,resolved:Me.resolved,graphMode:8,color:r.color,lineWidth:r.lineWidth,lineOpacity:r.lineOpacity,listIndex:r.listIndex,operator:r.operator,compiled:n,poi:{}}},$=n.fn,F=(E=r.slice_value)!=null?E:0,Z=(T=r.slice_coordinate)!=null?T:\"\",re=u,Ee,K,fe,at=!0,me=U=>{let z=q(U,u),Me=r.lineWidth;return Ny(z,t,Me,F)},Kt=U=>{for(let z=0;z<U.length/3;z++){let[Me,ae]=[U[3*z+1],U[3*z+2]];U[3*z+1]=ae,U[3*z+2]=Me}},Ge=U=>{for(let z=0;z<U.length/3;z++){let[Me,ae,be]=[U[3*z],U[3*z+1],U[3*z+2]];U[3*z]=be,U[3*z+1]=Me,U[3*z+2]=ae}},Ze=(U,z)=>{var Or;let Me=u,ae=q(U,Me),be=r.lineWidth,ve=t.viewport,{xmin:hr,xmax:_t,ymin:or,ymax:Xr,zmin:vr,zmax:ze}=ve,le=(_t-hr)/100,We=(Xr-or)/100,ui=(ze-vr)/100,$r=[];for(let en=0;en<ae.segments.length;en++){let An=Np(ae.segments[en],Me),io=NaN,so=NaN,ns=NaN,Li=NaN,oo=NaN;for(let ao=0;ao<An.length/2;ao++){let nu=An[2*ao],jy=An[2*ao+1],[Jy,Qy,Ky]=z(nu,jy),kI=Math.abs(Jy-ns),qI=Math.abs(Qy-Li),YI=Math.abs(Ky-oo);if(kI>le||qI>We||YI>ui){let XI=Math.min(100,fS(kI/le,qI/We,YI/ui));for(let eg=1;eg<XI;eg++){let $I=eg/XI,XR=qr(io,nu,$I),$R=qr(so,jy,$I);$r.push(z(XR,$R))}}$r.push([Jy,Qy,Ky]),io=nu,so=jy,ns=Jy,Li=Qy,oo=Ky}en<ae.segments.length-1&&$r.push([NaN,NaN,0])}return at=(Or=ae.resolved)!=null?Or:!0,Zu($r,ve,be)};switch(f){case 200:{if(Z===\"z\")return me((z,Me)=>$(z,Me)-F);if(Z===\"_implicit\"){let z=r.slice_function.fn;fe=Ze((be,ve)=>z(be,ve,$(be,ve)),(be,ve)=>[be,ve,$(be,ve)]);break}let U=Z===\"x\";Ee=U?re.y:re.x,K=U?z=>[F,z,$(F,z)]:z=>[z,F,$(z,F)],fe=$u(K,Ee,r.resolution,t);break}case 201:{if(Z===\"x\"){let z=me((Me,ae)=>$(Me,ae)-F);return Ge(z.points),z}if(Z===\"_implicit\"){let z=r.slice_function.fn;fe=Ze((be,ve)=>z($(be,ve),be,ve),(be,ve)=>[$(be,ve),be,ve]);break}let U=Z===\"y\";Ee=U?re.z:re.y,K=U?z=>[$(F,z),F,z]:z=>[$(z,F),z,F],fe=$u(K,Ee,r.resolution,t);break}case 202:{if(Z===\"y\"){let z=me((Me,ae)=>$(Me,ae)-F);return Kt(z.points),z}if(Z===\"_implicit\"){let z=r.slice_function.fn;fe=Ze((be,ve)=>z(be,$(be,ve),ve),(be,ve)=>[be,$(be,ve),ve]);break}let U=Z===\"x\";Ee=U?re.z:re.x,K=U?z=>[F,$(F,z),z]:z=>[z,$(z,F),F],fe=$u(K,Ee,r.resolution,t);break}case 209:{let U=n.fn;if(Z===\"x\"){let z=me((Me,ae)=>U(F,Me,ae));return Ge(z.points),z}else if(Z===\"y\"){let z=me((Me,ae)=>U(Me,F,ae));return Kt(z.points),z}else{if(Z===\"z\")return me((z,Me)=>U(z,Me,F));if(Z===\"_implicit\")throw us()}throw new Error(\"Programming Error: unexpected slice coordinate\")}case 206:case 205:{let U=Z===\"z\";Ee=U?re.t:re.z,K=U?z=>[$(z,F),z,F]:z=>[$(F,z),F,z],fe=Ty(K,Ee,r.resolution,t);break}case 211:{let U=n.fn,z;switch(Z){case\"x\":z=(ze,le)=>U(ze,le)*tr(ze*a)-F;break;case\"y\":z=(ze,le)=>U(ze,le)*Ct(ze*a)-F;break;case\"r\":z=(ze,le)=>U(ze,le)-F;break;case\"_implicit\":let vr=r.slice_function.fn;z=(ze,le)=>vr(U(ze,le)*tr(ze*a),U(ze,le)*Ct(ze*a),le,U(ze,le),ze);break;default:throw new Error(\"Programming Error: bad slice\")}let Me=Z===\"x\",ae=Z===\"y\",be=u,ve=q(z,be),hr=[],_t=(vr,ze)=>[Me?F:U(vr,ze)*tr(vr*a),ae?F:U(vr,ze)*Ct(vr*a),ze];for(let vr=0;vr<ve.segments.length;vr++){let ze=Np(ve.segments[vr],be),le=NaN,We=NaN,ui=5*(Math.PI/180)/a;for(let $r=0;$r<ze.length/2;$r++){let Or=ze[2*$r],en=ze[2*$r+1],An=Math.abs(Or-le),io=Me?F:U(Or,en)*tr(Or*a),so=ae?F:U(Or,en)*Ct(Or*a);if(An>ui){let ns=Math.min(72,An/ui);for(let Li=1;Li<ns;Li++){let oo=Li/ns,ao=qr(We,en,oo),nu=qr(le,Or,oo);hr.push(_t(nu,ao))}}hr.push([io,so,en]),le=Or,We=en}vr<ve.segments.length-1&&hr.push([NaN,NaN,0])}let or=r.lineWidth,Xr=t.viewport;fe=Zu(hr,Xr,or),at=(D=ve.resolved)!=null?D:!0;break}case 213:{let U=Z===\"x\",z=Z===\"y\",Me=Z===\"z\",ae=n.fn,be;switch(Z){case\"x\":be=(le,We)=>le*tr(We*a)-F;break;case\"y\":be=(le,We)=>le*Ct(We*a)-F;break;case\"z\":be=(le,We)=>ae(le,We)-F;break;case\"_implicit\":let ze=r.slice_function.fn;be=(le,We)=>ze(le*tr(We*a),le*Ct(We*a),ae(le,We),le,We);break;default:throw new Error(\"Programming Error: bad slice\")}let ve=u,hr=q(be,ve),_t=[],or=(ze,le)=>[U?F:ze*tr(le*a),z?F:ze*Ct(le*a),Me?F:ae(ze,le)];for(let ze=0;ze<hr.segments.length;ze++){let le=Np(hr.segments[ze],ve),We=NaN,ui=NaN,$r=5*(Math.PI/180)/a;for(let Or=0;Or<le.length/2;Or++){let en=le[2*Or],An=le[2*Or+1],io=Math.abs(An-We);if(io>$r){let so=Math.min(72,io/$r);for(let ns=1;ns<so;ns++){let Li=ns/so,oo=qr(ui,en,Li),ao=qr(We,An,Li);_t.push(or(oo,ao))}}_t.push(or(en,An)),We=An,ui=en}ze<hr.segments.length-1&&_t.push([NaN,NaN,0])}let Xr=r.lineWidth,vr=t.viewport;fe=Zu(_t,vr,Xr);break}case 212:{let U=Z===\"x\",z=Z===\"y\",Me=Z===\"z\",ae=n.fn,be;switch(Z){case\"x\":be=(le,We)=>ae(le,We)*Ct(We*a)*tr(le*a)-F;break;case\"y\":be=(le,We)=>ae(le,We)*Ct(We*a)*Ct(le*a)-F;break;case\"z\":be=(le,We)=>ae(le,We)*tr(We*a)-F;break;case\"r\":be=(le,We)=>ae(le,We)-F;break;case\"_implicit\":let ze=r.slice_function.fn;be=(le,We)=>ze(ae(le,We)*Ct(We*a)*Ct(le*a),ae(le,We)*Ct(We*a)*tr(le*a),ae(le,We)*tr(We*a),ae(le,We),le,We);break;default:throw new Error(\"Programming Error: bad slice\")}let ve=u,hr=q(be,ve),_t=[],or=(ze,le)=>[U?F:ae(ze,le)*Ct(le*a)*tr(ze*a),z?F:ae(ze,le)*Ct(le*a)*Ct(ze*a),Me?F:ae(ze,le)*tr(le*a)];for(let ze=0;ze<hr.segments.length;ze++){let le=Np(hr.segments[ze],ve),We=NaN,ui=NaN,$r=5*(Math.PI/180)/a;for(let Or=0;Or<le.length/2;Or++){let en=le[2*Or],An=le[2*Or+1],io=Math.abs(en-We),so=Math.abs(An-ui);if(io>$r||so>$r){let ns=Math.min(72,fS(io/$r,so/$r));for(let Li=1;Li<ns;Li++){let oo=Li/ns,ao=qr(We,en,oo),nu=qr(ui,An,oo);_t.push(or(ao,nu))}}_t.push(or(en,An)),We=en,ui=An}ze<hr.segments.length-1&&_t.push([NaN,NaN,0])}let Xr=r.lineWidth,vr=t.viewport;fe=Zu(_t,vr,Xr),at=(S=hr.resolved)!=null?S:!0;break}case 215:case 214:{let U=f===214?n.fn:(Me,ae)=>{let[be,ve]=n.fn(Me,ae);return[be,ve,0]},z;switch(Z){case\"x\":z=(ae,be)=>U(ae,be)[0]-F;break;case\"y\":z=(ae,be)=>U(ae,be)[1]-F;break;case\"z\":z=(ae,be)=>U(ae,be)[2]-F;break;case\"u\":z=(ae,be)=>ae-F;break;case\"v\":z=(ae,be)=>be-F;break;case\"_implicit\":let Me=r.slice_function.fn;z=(ae,be)=>{let[ve,hr,_t]=U(ae,be);return Me(ve,hr,_t,ae,be)};break;default:throw new Error(\"Programming Error: bad slice\")}fe=Ze(z,U);break}case 203:case 204:{let U=Z===\"r\";Ee=U?re.v:re.u,K=U?z=>[F,z,$(F,z)]:z=>[z,F,$(z,F)],fe=Ty(K,Ee,r.resolution,t);break}case 207:case 208:{let U=Z===\"theta\";Ee=U?re.v:re.u,K=U?z=>[$(F,z),F,z]:z=>[$(z,F),z,F],fe=FT(K,Ee,r.resolution,t);break}}return{graphMode:100,guid:Ni(),points:fe,resolved:at,color:r.color,thickness:r.lineWidth}}default:throw new Error(\"Programming Error: unexpected graphmode \"+f)}p=c.poi}if((!p||p.zeros.x.length+p.extrema.x.length+p.intercept.x.length>250)&&(p=zV()),f===1)for(let O in p){if(!p.hasOwnProperty(O))continue;let A=O;l=p[A].y,p[A].y=p[A].x,p[A].x=l}let h={segments:c.segments,resolved:c.resolved,graphMode:f,color:r.color,style:r.lineStyle,lineWidth:r.lineWidth,lineOpacity:r.lineOpacity,listIndex:r.listIndex,operator:r.operator,poi:p,compiled:n};if(f===6){let O=u;h.sampledDomain={min:O.min,max:O.max}}return c.fillSegments&&(h.fillSegments=c.fillSegments),h}function n3(e,t,r){let n,i,s,o,a=[],u=null;switch(r){case 6:u=mS;break;case 1:u=function(c){return[c[1],c[0]]};break}for(n=0;n<e.length;n++)for(o=e[n],i=0;i<o.length;i+=2)s=[o[i],o[i+1]],u&&(s=u(s)),a.push(s[0],s[1]);for(n=t.length-1;n>=0;n--)for(o=t[n],i=o.length-2;i>=0;i-=2)s=[o[i],o[i+1]],u&&(s=u(s)),a.push(s[0],s[1]);return a}function fS(...e){let t=-1/0;for(let r of e)r>t&&(t=r);return t}function Sy(e,t,r){let n=p=>{let f=p[p.length-1];return f[f.length-2]},i=[],s=0,o=0,a=[],u=[],c=-1/0,l=-1/0;for(;;){if(c<=l){if(s>=t.length)break;u.push(t[s++])}if(l<=c){if(o>=e.length)break;a.push(e[o++])}if(c=n(u),l=n(a),Ln(c,l,4)){i.push(n3(a,u,r)),u=[],a=[];let p=Math.max(c,l);c=p,l=p}}return i}function Cp(e){let t=[],r={};for(let n=0;n<e.length;n++){let i=e[n],[s,o]=i;!isNaN(s)&&!isNaN(o)?t.push(i):r[n]=!0}return{points:t,droppedIndices:r}}var _i={[8]:[\"x\",\"y\"],[106]:[\"x\",\"y\"],[120]:[\"y\",\"z\"],[122]:[\"y\",\"z\"],[107]:[\"y\",\"z\"],[121]:[\"x\",\"z\"],[123]:[\"x\",\"z\"],[108]:[\"x\",\"z\"],[109]:[\"r\",\"theta\"],[124]:[\"theta\",\"z\"],[110]:[\"theta\",\"z\"],[125]:[\"theta\",\"phi\"],[111]:[\"theta\",\"phi\"],[130]:[\"u\",\"v\"],[103]:[\"u\",\"v\"],[104]:[\"u\",\"v\"],[105]:[\"u\",\"v\"],[126]:[\"x\",\"y\"],[112]:[\"x\",\"y\",\"z\"],[113]:[\"x\",\"y\",\"z\"],[127]:[\"x\",\"y\"],[201]:[\"y\",\"z\"],[202]:[\"x\",\"z\"],[200]:[\"x\",\"y\"],[206]:[\"theta\",\"z\"],[205]:[\"theta\",\"z\"],[211]:[\"theta\",\"z\"],[203]:[\"r\",\"theta\"],[204]:[\"r\",\"theta\"],[213]:[\"r\",\"theta\"],[207]:[\"theta\",\"phi\"],[208]:[\"theta\",\"phi\"],[212]:[\"theta\",\"phi\"],[214]:[\"u\",\"v\"],[215]:[\"u\",\"v\"],[209]:[\"x\",\"y\",\"z\"],[210]:[\"x\",\"y\",\"z\"]},Wu={[110]:[\"r\"],[111]:[\"r\"],[104]:[\"r\",\"theta\"],[105]:[\"r\",\"theta\",\"phi\"]};function i3(e){return!e||e[0].type===\"none\"&&e[1].type===\"none\"?\"NONE\":e[1].type===\"none\"?\"X\":e[0].type===\"none\"?\"Y\":\"XY\"}function bS(e,t){var r=i3(t);switch(e){case\"NONE\":return\"NONE\";case\"AUTO\":return r;case\"XY\":return r;case\"X\":return r===\"X\"||r===\"XY\"?\"X\":\"NONE\";case\"Y\":return r===\"Y\"||r===\"XY\"?\"Y\":\"NONE\";default:return\"NONE\"}}var s3=(e,t)=>{let r=e.segments[0],n=t.segments[0],i=[[...r,...n]];return ee(W({},e),{segments:i})};function o3(e){let{viewState:t,graphInfo:r,compiled:n,derivative:i,bounds:s}=e,o=gs(r),a=Cn(r.domainBound,Ii(s));if(a.type===\"known\")return o.domainBound=a,o.lineStyle=\"SOLID\",fa({graphInfo:o,viewState:t,compiled:n,derivative:i})}function Wa(e){let{viewState:t,graphInfo:r,compiled:n,bounds:i,included:s,showPoint:o}=e,a=gs(r),u=Cn(r.domainBound,Ii(i));if(u.type===\"known\")return a.domainBound=u,a.pointStyle=s?\"POINT\":\"OPEN\",Oy({graphInfo:a,viewState:t,compiled:n,showPoint:o,maxOverride:void 0})}function TS(e){let{viewState:t,graphInfo:r,compiled:n,bounds:i,maxOverride:s,showPoint:o}=e,[a,u]=i,c=[],l;a=Math.ceil(a),u=Math.floor(u);let p=s!==void 0?s:1/0;if(a===-1/0&&u>=p)l=Wa({bounds:[a,p],included:!0,viewState:t,graphInfo:r,compiled:n,showPoint:o}),c.push(l);else if(a===-1/0&&u<1/0)l=Wa({bounds:[a,u],included:!0,viewState:t,graphInfo:r,compiled:n,showPoint:o}),c.push(l),c.push(Wa({bounds:[u+1,p],included:!1,viewState:t,graphInfo:r,compiled:n,showPoint:o}));else if(a>-1/0&&u>=p)l=Wa({bounds:[a,p],included:!0,viewState:t,graphInfo:r,compiled:n,showPoint:o}),c.push(Wa({bounds:[-1/0,a-1],included:!1,viewState:t,graphInfo:r,compiled:n,showPoint:o})),c.push(l);else{l=Wa({bounds:[a,u],included:!0,viewState:t,graphInfo:r,compiled:n,showPoint:o});let f=Wa({bounds:[-1/0,a-1],included:!1,viewState:t,graphInfo:r,compiled:n,showPoint:o}),y=Wa({bounds:[u+1,p],included:!1,viewState:t,graphInfo:r,compiled:n,showPoint:o});c.push(l);let h;f&&y&&(h=s3(f,y),c.push(h))}return{cdfTopBranch:l,topBranches:c}}var IS=e=>{let{viewState:t,graphInfo:r,compiled:n,derivative:i,bounds:s}=e,[o,a]=s,u=o3({bounds:[o,a],viewState:t,graphInfo:r,compiled:n,derivative:i}),c=[fa({viewState:t,graphInfo:r,compiled:n,derivative:i})];return{cdfTopBranch:u,topBranches:c}};function n9(e){switch(e){case\"LOOP_FORWARD\":return\"dcg-icon-arrow-one-way\";case\"LOOP_FORWARD_REVERSE\":return\"dcg-icon-arrow-two-way\";case\"PLAY_ONCE\":return\"dcg-icon-arrow-once\";case\"PLAY_INDEFINITELY\":return\"dcg-icon-arrow-infinite\"}}function _p(e,t){let r={};for(let n in t)t.hasOwnProperty(n)&&(ba(e[n],t[n])||(r[n]=t[n]));return r}function Ay(e,t){let r,n={};for(let i in t)t.hasOwnProperty(i)&&(ba(e[i],t[i])||(n[i]=t[i],r=n));return r}function a9(e,t){t||(t={});let r={};for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(r[n]=gs(e[n]));for(let n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);return r}function c9({from:e,to:t,props:r}){for(var n in r)r[n]&&e.hasOwnProperty(n)&&(t[n]=gs(e[n]))}function l9(e,t){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])}function MS(e,t){let r={};for(var n in t)t.hasOwnProperty(n)&&(r[n]=e[n]);return r}function p9(e){let t={};for(let r in e)e.hasOwnProperty(r)&&(t[r]=!0);return t}var a3=(n=>(n.NONE=\"NONE\",n.POSITIVE=\"POSITIVE\",n.BOTH=\"BOTH\",n))(a3||{});var DS={collapsed:!1,hidden:!1,secret:!1,readonly:!1,title:\"\"};function m9(e){return W(W({},DS),e)}function y9(e){return _p(DS,e)}var vS=\"**dcg_geo_folder**\";var QT={show:!1,min:\"\",max:\"\"},KT={breadth:\"\",axisOffset:\"\",alignedAxis:\"x\",showBoxplotOutliers:!0,binAlignment:\"center\",dotplotXMode:\"exact\",histogramMode:\"\"},eI={enabled:!1,latex:\"\"};var OS=4e3,Cy={polarDomain:{min:\"\",max:\"\"},parametricDomain:{min:\"\",max:\"\"},parametricDomain3Du:{min:\"\",max:\"\"},parametricDomain3Dv:{min:\"\",max:\"\"},cdf:QT,colorLatex:\"\",description:\"\",fillOpacity:\"\",lineOpacity:\"\",pointOpacity:\"\",pointSize:\"\",lineWidth:\"\",resolution:\"\",checkers:\"\",polarCoordinateSystem:\"\",labelAngle:\"\",vizProps:KT,clickableInfo:eI},SS=ee(W({folderId:\"\",latex:\"\",color:\"\",showLabel:!1,showAngleLabel:!0,label:\"\",hidden:!1,secret:!1,readonly:!1,dragMode:\"AUTO\",labelSize:\"\",labelOrientation:\"default\",suppressTextOutline:!1,interactiveLabel:!1,editableLabelMode:\"NONE\",residualVariable:\"\",isLogModeRegression:!1,pointStyle:\"POINT\",lineStyle:\"SOLID\",arrowMode:\"DEFAULT\",regressionParameters:{},displayEvaluationAsFraction:!1,slider:{},strictIntersection:!1,extendTo3D:!1},Cy),{points:void 0,lines:void 0,fill:void 0}),RS={hardMin:!1,hardMax:!1,animationPeriod:OS,loopMode:\"LOOP_FORWARD_REVERSE\",playDirection:1,isPlaying:!1,min:\"-10\",max:\"10\",step:\"\"},NS={hardMin:!1,hardMax:!1,animationPeriod:OS,loopMode:\"LOOP_FORWARD_REVERSE\",playDirection:1,isPlaying:!1,min:`${jr.xmin}`,max:`${jr.xmax}`,step:\"\"};function R9(e,t){return ee(W(W({},SS),e),{slider:W(W({},t.is3d?NS:RS),e.slider),cdf:W(W({},QT),e.cdf),vizProps:W(W({},KT),e.vizProps),clickableInfo:W(W({},eI),e.clickableInfo)})}function N9(e,t){var r=_p(SS,ee(W({},e),{slider:_p(t.is3d?NS:RS,e.slider)})),n=Ay(QT,e.cdf);n===void 0?delete r.cdf:r.cdf=n;var i=Ay(KT,e.vizProps);i===void 0?delete r.vizProps:r.vizProps=i;var s=Ay(eI,e.clickableInfo);return s===void 0?delete r.clickableInfo:r.clickableInfo=s,r}function u3(e){return MS(e,Cy)}function A9(e,t){for(var r in Cy)if(Cy.hasOwnProperty(r)&&e[r]!==t[r])return!1;return!0}function C9(e){return W({type:\"statement\",id:e.id,latex:e.latex,label:e.label,color:e.color,fill:e.fill,points:e.points,lines:e.lines,extendTo3D:e.extendTo3D,pointStyle:e.pointStyle,lineStyle:e.lineStyle,arrowMode:e.arrowMode,dragMode:e.dragMode,labelSize:e.labelSize,labelOrientation:e.labelOrientation,suppressTextOutline:e.suppressTextOutline,interactiveLabel:e.interactiveLabel,editableLabelMode:e.editableLabelMode,residualVariable:e.residualVariable,regressionParameters:e.regressionParameters,isLogModeRegression:e.isLogModeRegression,showLabel:e.showLabel,showAngleLabel:e.showAngleLabel,shouldGraph:e.hidden,slider:{min:e.slider.hardMin?e.slider.min:\"\",max:e.slider.hardMax?e.slider.max:\"\",softMin:e.slider.hardMin?\"\":e.slider.min,softMax:e.slider.hardMax?\"\":e.slider.max,step:e.slider.step,isPlayingOnce:e.slider.isPlaying&&e.slider.loopMode===\"PLAY_ONCE\"},strictIntersection:e.strictIntersection,isInConstructionsFolder:e.folderId===vS},u3(e))}var m3={};Ds(m3,{colors:()=>ju,colors3d:()=>d3,getDisplayColor:()=>zo,invertColor:()=>l3,isValidHexColor:()=>_y,mutateOpacity:()=>f3,normalizeColor:()=>tI,parseHex:()=>p3,shadeColor:()=>c3});function tI(e){return _y(e)?(e.match(/^#([A-Fa-f0-9]{3})$/g)&&(e=\"#\"+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),e.toLowerCase()):e}function _y(e){return typeof e==\"string\"&&(e.match(/^#([A-Fa-f0-9]{3})$/g)||e.match(/^#([A-Fa-f0-9]{6})$/g))}function c3(e,t){if(e=tI(e),!_y(e))return e;t>1&&(t=1),t<-1&&(t=-1);var r=parseInt(e.slice(1),16),n=t<0?0:255,i=t<0?t*-1:t,s=r>>16,o=r>>8&255,a=r&255;return\"#\"+(16777216+(Math.round((n-s)*i)+s)*65536+(Math.round((n-o)*i)+o)*256+(Math.round((n-a)*i)+a)).toString(16).slice(1)}function l3(e){if(e=tI(e),!_y(e))return e;let t=\"0123456789abcdef\";return\"#\"+e.slice(1).split(\"\").map(r=>t[15-t.indexOf(r)]).join(\"\")}function p3(e){if(e=e.replace(/#/,\"\"),e.length===3)var t=parseInt(e.slice(0,1)+e.slice(0,1),16),r=parseInt(e.slice(1,2)+e.slice(1,2),16),n=parseInt(e.slice(2,3)+e.slice(2,3),16);else if(e.length===6)var t=parseInt(e.slice(0,2),16),r=parseInt(e.slice(2,4),16),n=parseInt(e.slice(4,6),16);else var t=0,r=0,n=0;return{r:t,g:r,b:n}}function f3(e,t){let r=/(rgba\\([\\d]+\\,\\ ?[\\d]+\\,\\ ?[\\d]+\\,\\ ?)[\\d.]+(\\))/;return e.match(r)?e.replace(r,`$1${t}$2`):e}function zo(e,t){if(t&&t.colorLatexValue){var r=t.colorLatexValue;return Array.isArray(r)?r[0]:r}return e.color}var ju={RED:\"#c74440\",BLUE:\"#2d70b3\",GREEN:\"#388c46\",PURPLE:\"#6042a6\",ORANGE:\"#fa7e19\",BLACK:\"#000000\",GRAY:\"#aaaaaa\",FOCUS_OUTLINE:\"#6a93d2\"},d3={RED:ju.RED,BLUE:ju.BLUE,GREEN:ju.GREEN,ORANGE:ju.ORANGE,PURPLE:ju.PURPLE,GRAY:ju.GRAY};function rI(e,t){let r;switch(t){case\"solvedEquation\":r=2;break;case\"baseComparator\":r=4;break;default:r=1;break}return Math.floor(e/r)}function LS(e){let t=[];for(let n=0;n<e.instructionsLength();n++)t.push(!1);let r=[];t[e.getReturnIndex()]=!0;for(let n=e.instructionsLength()-1;n>=0;n--){if(!t[n])continue;let i=e.getInstruction(n);if(i.type===2&&r.push(e.argNames[n]),De(i))continue;let s=qa(e,i)?[i.args[1]]:i.args;for(let o of s)t[o]=!0}return r}var Jc=class{constructor({enableGeometry:t,enable3d:r,beta3d:n,scales:i}){this._isGeometry=!1;this._is3dProduct=!1;this._isBeta3d=!1;this._isGeometry=t,this._is3dProduct=r,this._isBeta3d=n,this._scales=i}isGeometryEnabled(){return this._isGeometry}is3dProduct(){return this._is3dProduct}is3dPolicy(){return!1}isBeta3d(){return this._isBeta3d}areAllScalesLinear(){return this._scales?this._scales.xAxisScale===\"linear\"&&this._scales.yAxisScale===\"linear\":!0}assignmentForbidden(t){return t===\"x\"||t===\"y\"||t===\"theta\"||this.substitutionForbidden(t)}substitutionForbidden(t){return t===\"index\"||t===\"dt\"||t.slice(0,3)===\"tmp\"||Xe.hasOwnProperty(t)}isValidSlider(t){return t===\"x\"||t===\"y\"?!0:!(t.slice(0,3)===\"ans\"||t.slice(0,6)===\"idref_\"||this.assignmentForbidden(t))}sliderVariables(t){return t.indexOf(\"theta\")!==-1&&(t=t.filter(function(r){return r!==\"r\"})),t.filter(r=>!(this.assignmentForbidden(r)||r.slice(0,3)===\"ans\"||r.slice(0,6)===\"idref_\"||r[0]===\"_\"||this.isGeometryEnabled()&&r[0]===\"$\"))}tooManySliderVariables(t,r,n){return n?t.length>=1:t.length>=2&&r.length>=1}graphingEnabled(){return!0}ansEnabled(){return!1}dimensionVarsEnabled(){return!0}validRegressionParameter(t){return t!==\"x\"&&t!==\"y\"}validLHS(t){return t!==\"theta\"&&t.slice(0,6)!==\"idref_\"}unplottablePolarFunction(t,r){return t!==\"theta\"?!1:r.indexOf(\"r\")!==-1}validDoubleInequalitySymbol(t){return t===\"x\"||t===\"y\"}validDoubleInequalityVariables(t){return t.length>2?!1:t.every(this.validDoubleInequalitySymbol)}validExpressionVariables(t){return t.length===1&&t[0]===\"x\"}validSolvedVariable(t){return t===\"x\"||t===\"y\"||t===\"r\"}validImplicitVariables(t){switch(t.length){case 0:return!0;case 1:return t[0]===\"x\"||t[0]===\"y\"||t[0]===\"r\";case 2:return t[0]===\"x\"&&t[1]===\"y\"||t[0]===\"y\"&&t[1]===\"x\"||t[0]===\"r\"&&t[1]===\"theta\"||t[0]===\"theta\"&&t[1]===\"r\";default:return!1}}graphableListVariables(t,r){return t===\"x\"||t===\"y\"||t===\"r\"||r===\"x\"||r===\"y\"}validParametricVariable(t){return t===\"t\"}validParametricVariables(t){return t.length===1&&this.validParametricVariable(t[0])}validInequalityVariables(t){switch(t.length){case 1:return t[0]===\"x\"||t[0]===\"y\"||t[0]===\"r\";case 2:return this.validImplicitVariables(t);default:return!1}}validFirstColumnVariable(t){return t!==\"y\"&&t!==\"r\"&&t!==\"theta\"&&!t.match(/y_(\\d+)/)}validActionVariable(t){return t===\"dt\"||t===\"index\"}validCoordinateEquationSymbol(t){return!1}complicatedPolarImplicit(t,r){return t===\"theta\"||t===\"r\"&&r!==1}graphMode(t,r,n){if(r.length===0)return t===\"x\"?1:t===\"r\"?6:t===\"y\"?2:10;let i=r[0];return i===\"y\"?1:t===\"x\"?1:t===\"r\"&&i===\"theta\"?6:2}functionDefinitionGraphMode(t,r){return this.graphMode(t,r)}tableableAsConstant(t){return!(t===\"x\"||t===\"r\"||t===\"theta\")}implicitIndependent(t){return\"x\"}implicitDependency(t){return t.length!==1?\"y\":t[0]===\"y\"?\"x\":t[0]===\"theta\"?\"r\":\"y\"}disabledFeatures(){return[]}};function Ju(){return new Jc({enableGeometry:!1,enable3d:!0,beta3d:!1,scales:{xAxisScale:\"linear\",yAxisScale:\"linear\"}})}var Ly=class{constructor(t){this._isBeta3d=!1;this._isBeta3d=t}isGeometryEnabled(){return!1}is3dProduct(){return!0}is3dPolicy(){return!0}isBeta3d(){return this._isBeta3d}areAllScalesLinear(){return!0}graphingEnabled(){return!0}ansEnabled(){return!1}dimensionVarsEnabled(){return!1}substitutionForbidden(t){return Ju().substitutionForbidden(t)}validInequalityVariables(t){return this.validImplicitVariables(t)}validFirstColumnVariable(t){return Ju().validFirstColumnVariable(t)}validActionVariable(t){return Ju().validActionVariable(t)}tableableAsConstant(t){return Ju().tableableAsConstant(t)}implicitIndependent(t){return Ju().implicitIndependent(t)}validRegressionParameter(t){return Ju().validRegressionParameter(t)}assignmentForbidden(t){return t===\"x\"||t===\"y\"||t===\"z\"||t===\"r\"||t===\"theta\"||t===\"phi\"||this.substitutionForbidden(t)}sliderVariables(t){return t.filter(r=>!(this.assignmentForbidden(r)||r.slice(0,3)===\"ans\"||r.slice(0,6)===\"idref_\"||r[0]===\"_\"))}tooManySliderVariables(t,r,n){return n?this.isBeta3d()?r.length>=1:t.length>=1:r.length>=1}isValidSlider(t){return!(t.slice(0,3)===\"ans\"||t.slice(0,6)===\"idref_\"||this.assignmentForbidden(t))}validLHS(t){return t!==\"phi\"&&Ju().validLHS(t)}unplottablePolarFunction(t,r){return!1}complicatedPolarImplicit(t,r){return!1}validDoubleInequalitySymbol(t){return!1}validDoubleInequalityVariables(t){return!1}validExpressionVariables(t){return t.length===2&&t.every(r=>r==\"x\"||r==\"y\")}validSolvedVariable(t){return nI(t)||t===\"r\"}validImplicitVariables(t){return t.every(nI)}graphableListVariables(t,r){return t===\"x\"||t===\"y\"||t===\"z\"||t===\"r\"||r===\"x\"||r===\"y\"}validParametricVariable(t){return t===\"t\"||t===\"u\"||t===\"v\"}validParametricVariables(t){return t.length===1&&this.validParametricVariable(t[0])||t.length===2&&t.every(Lp)}validCoordinateEquationSymbol(t){return this.isBeta3d()?t===\"rthetaphi\"||t===\"rthetaz\":!1}functionDefinitionGraphMode(t,r){if(r.length===1)switch(r[0]){case\"x\":return 121;case\"y\":return 120;default:return 10}else if(r.length===2&&r.every(n=>n==\"x\"||n==\"y\"))return 106;return 10}graphMode(t,r,n){var s;let i=(s=n==null?void 0:n.allDependencies)!=null?s:r;if(r.length===0)switch(t){case\"z\":return i.some(o=>o===\"r\"||o===\"theta\")?109:106;case\"y\":return i.includes(\"z\")?108:123;case\"x\":return i.includes(\"z\")?107:122;case\"r\":return i.indexOf(\"r\")>-1?10:wS(n,{prefer:\"Cylindrical\"});case\"rthetaz\":return this.isBeta3d()?115:10;case\"rthetaphi\":return this.isBeta3d()?116:10;default:return 10}switch(t){case\"z\":return r.every(o=>o==\"x\"||o==\"y\")?106:r.every(o=>o==\"r\"||o==\"theta\")?109:10;case\"y\":return r.every(o=>o==\"x\")?i.some(o=>o===\"z\")?108:121:r.every(o=>o==\"x\"||o==\"z\")?108:10;case\"x\":return r.every(o=>o==\"y\")?i.some(o=>o===\"z\")?107:120:r.every(o=>o==\"y\"||o==\"z\")?107:10;case\"r\":return r.every(o=>o==\"theta\")?wS(n,{prefer:\"Cylindrical\"}):r.every(o=>o==\"theta\"||o==\"z\")?110:r.every(o=>o==\"theta\"||o==\"phi\")?111:10;case\"rthetaz\":return this.isBeta3d()?r.length===1&&r[0]===\"t\"?101:r.every(Lp)?104:10:10;case\"rthetaphi\":return this.isBeta3d()?r.length===1&&r[0]===\"t\"?102:r.every(Lp)?105:10:10;default:return 10}}implicitDependency(t){if(t.length!==2)return\"z\";let r=t[0]<t[1]?t[0]+t[1]:t[1]+t[0];return r===\"xy\"?\"z\":r===\"xz\"?\"y\":r===\"yz\"?\"x\":\"z\"}disabledFeatures(){return[]}},nI=e=>e===\"x\"||e===\"y\"||e===\"z\",Lp=e=>e===\"u\"||e===\"v\";function wS(e,{prefer:t}){let r=e.allDependencies.some(i=>nI(i)||i===\"r\"),n=(e==null?void 0:e.polarCoordinateSystem)||t;switch(n){case\"Spherical\":return r?111:125;case\"Cylindrical\":return r?110:124;default:return 10}}I.Base.prototype.getGraphMode=function(e,t){return 10};I.Base.prototype.graphmodeDependencies=rs;function rs(e,t){let r=t.getDependencies();if(e.is3dProduct()&&t instanceof sr){let n=new Set(LS(t._chunk));return r.filter(i=>n.has(i))}else return r}function y3(e,t){var r;return e&&e.hasOwnProperty(\"dragMode\")?e.dragMode===\"AUTO\"?r=t.defaultDragMode:r=e.dragMode:r=t.defaultDragMode,bS(r,t.moveStrategy)}function FS(e,t){let r=e.is3dPolicy();if(t.isMovablePoint&&!r&&y3(this.userData,t)!==\"NONE\")return 4;var n=rs(e,t);switch(t.valueType){case Hr:case G:if(r){if(n.length===0)return 114;if(e.validParametricVariables(n))return n.length==1?100:Qu(103,t)}return 10;case dt:case rn:return r?119:10;case Re:case sn:return r?129:10;case xr:case Ur:return r?117:10;case _r:case nn:return r?118:10;case N:case nt:return n.length===0?3:r&&e.validParametricVariables(n)?n.length===1?5:n.every(Lp)?Qu(130,t):10:e.validParametricVariables(n)?5:10;case P:case te:return!e.is3dPolicy()&&n.length===1?2:r&&n.length===2&&n.indexOf(\"x\")>-1&&n.indexOf(\"y\")>-1?Qu(106,t):10;case we:case br:return 16;case de:case Sr:return 20;case ue:case Rr:return 21;case Oe:case ur:return 17;case ye:case Nr:return 18;case _e:case Ar:return 19;case ge:case Cr:return this instanceof gt&&this.getDependencies().length===1?10:24;case Ae:case Jt:case xe:case Qt:return 23;default:return 10}}I.Expression.prototype.getGraphMode=FS;function VS(e,t){var r=t._expression.getDependencies();if(r.length>1)return 10;if(t._expression.isList&&t._expression.length===0)return 10;var n=t._symbol;return e.graphMode(n,r,{allDependencies:t.getDependencies()})}I.Equation.prototype.getGraphMode=I.BaseComparator.prototype.getGraphMode=function(e,t){if(t.isError)return 10;var r=rs(e,t);let n=t.getDependencies();if(e.is3dPolicy()){let i=10,s=this.type===\"Equation\";return r.length>0&&(n.includes(\"z\")?i=s?112:113:i=s?126:127),Qu(i,t)}return t.isConstant?10:t instanceof I.SolvedEquation?VS(e,t):r.length===1||r.length===2?8:10};function aI(e){var t;return e===106||e===200||e===107||e===201||e===108||e===202?[\"x\",\"y\",\"z\",\"_implicit\"]:e===110||e===211?[\"x\",\"y\",\"z\",\"r\",\"theta\",\"_implicit\"]:e===111||e===212?[\"x\",\"y\",\"z\",\"r\",\"theta\",\"phi\",\"_implicit\"]:e===109||e===213?[\"x\",\"y\",\"z\",\"r\",\"theta\",\"_implicit\"]:e===103||e===214||e===130||e===215?[\"x\",\"y\",\"z\",\"u\",\"v\",\"_implicit\"]:e===113||e===210||e===112||e===209?[\"x\",\"y\",\"z\",\"_implicit\"]:(t=_i[e])!=null?t:[]}function Qu(e,t){let r=aI(e),n=t._chunk;try{let s=No(n,r,{allowSlices:!0}).getSliceVariablesOrImplicit();if(s.length!==1)return e;let o=s[0];return r.indexOf(o)<0?10:vO(e,o)}catch(i){return 10}}I.DoubleInequality.prototype.getGraphMode=function(e,t){return e.graphMode(t._symbol,[],{allDependencies:t.getDependencies()})};I.Assignment.prototype.getGraphMode=function(e,t){if(t instanceof I.SolvedEquation)return VS(e,t);if(this.isEquation(e,t))return this.asEquation().getGraphMode(e,t);let r=rs(e,t),n=this._symbol,i=this.userData&&this.userData.polarCoordinateSystem?this.userData.polarCoordinateSystem:\"\",s=t.getDependencies(),o={polarCoordinateSystem:i,allDependencies:s};switch(t.valueType){case P:case te:case Le:switch(r.length){case 0:{let u=e.graphMode(n,[],o);return e.is3dPolicy()?Qu(u,t):u}case 1:if(t.valueType===te&&!e.graphableListVariables(n,r[0]))return 10;if(this.isSlider)return 10;let a=e.graphMode(n,r,o);return e.is3dPolicy()?Qu(a,t):a;default:return e.is3dPolicy()?Qu(e.graphMode(n,r,o),t):10}case G:if(e.assignmentForbidden(n)||r.length>0&&!e.validParametricVariables(r))return 10;switch(r.length){case 0:return 114;case 1:return 100;case 2:return 103;default:return 10}default:return FS.call(this,e,t)}};I.CoordinateEquation.prototype.getGraphMode=function(e,t){var r=rs(e,t);let n=this._concatenatedSymbol;if(t.valueType!==G)return 10;if(r.length>0&&!e.validParametricVariables(r))return 10;switch(r.length){case 0:switch(n){case\"rthetaphi\":return 116;case\"rthetaz\":return 115;default:return 10}case 1:switch(n){case\"rthetaphi\":return 102;case\"rthetaz\":return 101;default:return 10}case 2:switch(n){case\"rthetaphi\":return 105;case\"rthetaz\":return 104;default:return 10}default:return 10}};I.FunctionDefinition.prototype.getGraphMode=function(e,t){let r=e.is3dPolicy();if(this._argSymbols.length!==1&&!r)return 10;var n=e.functionDefinitionGraphMode(this._symbol,this._argSymbols),i=rs(e,t);switch(t.valueType){case P:case te:if(r)return n;switch(i.length){case 0:return n;case 1:return i[0]!==this._argSymbols[0]?10:n;default:return 10}break;default:return 10}};I.Regression.prototype.getGraphMode=function(e,t){return this.isLhsSimple?t.isModelValid?t.model.getDependencies().length!==1?10:2:10:10};function uI(e,t){return t.isError?10:11}I.Histogram.prototype.getGraphMode=uI;I.DotPlot.prototype.getGraphMode=uI;I.BoxPlot.prototype.getGraphMode=uI;I.Image.prototype.getGraphMode=function(e,t){return this.userData.showPoints?this.center.isError||this.radianAngle.isError||this.width.isError||this.height.isError||this.opacity.isError?10:3:10};function BS(e){let t=0,r=0;for(let n=e.instructionsLength()-1;n>=0;n--){let i=e.getInstruction(n);qa(e,i)&&(t+=1,ty(e,i.args[0])&&(r+=1))}return{numRestrictions:t,numEqualityRestrictions:r}}function Kc(e,t,r){try{return g3(e,t,r)}catch(n){return n instanceof R?n:ne(n)}}function g3(e,t,r){var l,p;if(!e.is3dProduct()||r.isError)return r;if(!(r instanceof sr))return ne(\"Expected peel error to be checked on an IRExpression\");function n(f,y){let h=y.filter(m=>f.indexOf(m)<0);if(h.length)return mb(h[0]).allowExport().setDependencies(h)}function i(){let f=Fy(o),y=h3(e,r);return n(f,y)}function s(){let f=GS(o),y=b3(e,r,o);return n(f,y)}let o=t.getGraphMode(e,r),a=r._chunk,{numRestrictions:u,numEqualityRestrictions:c}=BS(a);if(c!==0)if(c===1){if(u!==c)return $f();let h=No(a,[],{allowSlices:!0}).getSliceVariablesOrImplicit();if(h.length!==1)return us();let m=aI(o),b=h[0];if(m.indexOf(b)<0)return b===\"_implicit\"?us().allowExport():gb(b).allowExport().setDependencies([b])}else return $f();return(p=(l=i())!=null?l:s())!=null?p:r}function h3(e,t){let r=rs(e,t);return t.getDependencies().filter(i=>r.indexOf(i)<0)}function b3(e,t,r){let n=rs(e,t),i=new Set;if(t instanceof sr){let o=t.getRestrictedFunctionForGLSL(Fy(r)).concrete;for(let a of o.getDependencies())n.indexOf(a)>-1||i.add(a)}return[...i]}function Fy(e){var r;if(!Co(e))return[];let t=x3(e)?[\"x\",\"y\",\"z\"]:[];return(e===212||e===211)&&t.push(\"r\"),t.push(...(r=Wu[e])!=null?r:[]),t.push(...GS(e).filter(n=>t.indexOf(n)<0)),t}function x3(e){return P3(e)||e==200||e==201||e==202||e==211||e==212||e==213||e==214||e==215}function P3(e){if(!Co(e))return!1;switch(e){case 106:case 107:case 108:case 110:case 111:case 109:case 122:case 123:case 112:case 113:case 127:case 130:case 103:case 104:case 105:case 210:return!0;case 124:case 125:case 120:case 121:case 126:case 114:case 115:case 116:case 117:case 118:case 119:case 129:case 128:case 100:case 101:case 102:case 200:case 201:case 202:case 206:case 205:case 211:case 203:case 204:case 213:case 207:case 208:case 212:case 214:case 215:case 209:return!1;default:return!1}}function GS(e){var t;return Co(e)?(t=_i[e])!=null?t:[]:[]}function zS(e=void 0){let{xmin:t,xmax:r,ymin:n,ymax:i,zmin:s,zmax:o}=e!=null?e:new vy,a=[t,n,o,t,i,o,r,i,o,r,n,o,t,n,s,t,i,s,r,i,s,r,n,s,t,n,s,t,n,o,t,i,o,t,i,s,r,n,s,r,n,o,r,i,o,r,i,s,r,n,s,r,n,o,t,n,o,t,n,s,r,i,s,r,i,o,t,i,o,t,i,s],u=[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0],c=[0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,0,0,1,0,1,1,0,1,0,1,1,1,1,1,0,1,0,0,0,0,0,1,1,1,1,0,1,0,1],l=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23];return{positions:new Float32Array(a),normals:new Float32Array(u),faces:new Uint16Array(l),uvs:new Float32Array(c)}}function HS(e,t){let{mappedArgIndex:r,mappedReturnIndex:n,solutionIndex:i}=t,s=[],o=_a(e,r),a=I3(e,o,n),u=i,c=e.NanOfType(e.getReturnType());for(let l=0;l<=n;l++){let p=e.getInstruction(l);if(l===r){s.push(i);continue}if(!o[l]&&!e.isInClosedBlock(l)){s.push(l);continue}if(De(p))s.push(e.copyInstruction(p));else{let f=T3(s,p.args);s.push(e.copyInstructionWithArgs(p,f)),p.type===33&&a[l]&&(u=e.Piecewise([f[0],u,c]))}}return u}function T3(e,t){let r=[];for(let n of t)r.push(e[n]);return r}function I3(e,t,r){let n=[];for(let i=0;i<r;i++)n.push(!1);n[r]=t[r];for(let i=r;i>=0;i--){if(!n[i]||!t[i])continue;let s=e.getInstruction(i);if(s.type===33)n[s.args[1]]=!0;else if(!De(s))for(let o of s.args)n[o]=!0}return n}function US(e,t){try{return E3(e,t)}catch(r){return r instanceof I.Base?r:ne(r)}}function cI(e,t){try{let r=new sr(t),n=Uu({},r),i=[];for(let o=0;o<n.length;o++)i.push(P);let s=cy({policy:e,frame:{},argNames:n,argTypes:i,selection:void 0});return s.chunk=t,t.setReturnIndex(Br(t,t.getReturnIndex())),kS({policy:e,ctx:s,isInequality:!1,allowSolvingIn3D:!0},t)}catch(r){return r instanceof I.Base?r:ne(r)}}function E3({policy:e,frame:t},r){let n=Uu(t,r),i=[];for(let y=0;y<n.length;y++)i.push(P);let s=cy({policy:e,frame:t,argNames:n,argTypes:i,selection:void 0}),{chunk:o}=s,a=Be(s,r.args[0]),u=Be(s,r.args[1]),c=r.getOperator(),l=c!==\"=\";switch(Aa(o,e,r,[a,u]),c){case\"<\":o.Less([a,u]);break;case\">\":o.Greater([a,u]);break;case\"<=\":o.LessEqual([a,u]);break;case\">=\":o.GreaterEqual([a,u]);break;case\"=\":o.Equal([a,u]);break}if(o.setReturnIndex(Br(o,o.getReturnIndex())),o.isConstant())return new sr(o.close());let f=o.getInstruction(a).type!==2||Uu(t,r.args[1]).indexOf(o.argNames[a])!==-1;if(!Si.plotImplicits&&f)throw Tb();return wn[c].direction===-1?o.Subtract([u,a]):o.Subtract([a,u]),o.close(),kS({policy:e,ctx:s,isInequality:l,allowSolvingIn3D:!1},o)}function kS({policy:e,ctx:t,isInequality:r,allowSolvingIn3D:n},i){let s=i.getLiveArgNames();if(s.length===0)throw ne(`Unexpected: non-constant node with dependencies: ${s}`);if(s.length===1&&!r&&!Si.plotSingleVariableImplicitEquations)return Pb();let o=y=>y===\"x\"||y===\"y\"||y===\"z\";if(e.is3dPolicy()?!s.every(o):s.length>2)return jt(e.sliderVariables(s)).setDependencies(s);if(r&&!e.validInequalityVariables(s))return xb().setDependencies(s);let{localFrames:a,effectiveOrder:u,variableOfInterest:c}=M3(t,r);if(e.complicatedPolarImplicit(c,u))return Ib().setDependencies(s);if(!e.validImplicitVariables(s))return hu();if(e.is3dPolicy()&&n&&u!==1&&u!==2)return us();if(u>2||e.is3dPolicy()&&!n)return new sr(i.close());let l=[],p=[],f=1;for(let y=0;y<a.length;y++){let h=a[y],m=D3(h,r);f=m.length;for(let d of m){let g=h.chunk.copy();if(g.setReturnIndex(d),h.isRestrictedPolynomial){let{mappedArgIndex:x,mappedReturnIndex:M}=h;g.setReturnIndex(HS(g,{mappedArgIndex:x,mappedReturnIndex:M,solutionIndex:g.getReturnIndex()}))}g.close(),l.push(new sr(g))}let b=!1;for(let d of h.coefficients){let g=h.chunk.getInstruction(d);g.type===1&&g.value!==0&&(b=!0)}if(i.argNames.length!==2||b)p.push(void 0);else{let d=h.chunk.copy(),g=h.coefficients.slice();d.List(g),d.close();let x=j(i.getReturnType())?i.elementAt(y):i.copy(),E=x.argNames.indexOf(c)===0?1:0,T=x.getReturnIndex();x.Add([E,x.Multiply([x.Constant(0),T])]),p.push({coefficients:d,restriction:x})}}return new I.SolvedEquation(c,new I.List(l),p,f)}function M3(e,t){let r=e.chunk,n=e.policy,i=r.argNames,s=j(r.getReturnType()),o=[];e:for(let a=0;a<i.length;a++){let u=i[a],c=i.length>1&&!n.validSolvedVariable(u);o[a]={localFrames:[],effectiveOrder:0,variableOfInterest:u};let l=!t;if(c){o[a].effectiveOrder=1/0;continue}let p=s?r.getConstantListLength():1;if(p==null)throw new Error(\"Programming error: cannot solve a variable-length list expression\");for(let f=0;f<p;f++){let y=s?r.elementAt(f):r;if(y.polynomialOrder(u,{allowRestriction:l,allowClosedBlockReferences:!1})>2){o[a].effectiveOrder=1/0;continue e}let m=y.getPolynomialCoefficients(u);o[a].localFrames.push(m),o[a].effectiveOrder=Math.max(o[a].effectiveOrder,m.coefficients.length-1)}}if(i.length===1)return o[0];if(i.length===2&&!i.includes(\"z\"))return i[0]===\"y\"&&(o=[o[1],o[0]]),o[0].effectiveOrder===0?o[1]:o[1].effectiveOrder===0?o[0]:o[o[0].effectiveOrder<o[1].effectiveOrder?0:1];{let a=o.filter(c=>c.effectiveOrder===1);if(a.length>0)return a[0];let u=o.filter(c=>c.effectiveOrder===2);return u.length>0?u[0]:o[0]}}function D3(e,t){return t?O3(e):v3(e)}function v3({chunk:e,coefficients:t}){let[r,n,i]=t,s=e.Constant(Ce(0,1)),o=e.Constant(NaN);if(i===void 0){n===void 0&&(n=s);let a=e.Negative([e.Divide([r,n])]),u=e.Equal([n,s]);return[e.Piecewise([u,o,a])]}else{let a=e.Constant(Ce(2,1)),u=e.Multiply([a,i]),c=e.Negative([n]),l=e.Subtract([e.Multiply([n,n]),e.Multiply([a,e.Multiply([u,r])])]),p=e.Equal([i,s]),f=e.getInstruction(l);if(f.type===1&&Y(f.value)===0)return[e.Piecewise([p,o,e.Divide([c,u])])];{let y=e.SyntheticNativeFunction(\"sqrt\",[l]),h=e.Less([n,s]),m=e.Greater([n,s]),b=e.Divide([e.Add([c,y]),u]),d=e.Divide([e.Subtract([c,y]),u]),g=e.Negative([e.Divide([r,n])]);return[e.Piecewise([p,e.Piecewise([h,g,o]),d]),e.Piecewise([p,e.Piecewise([m,g,o]),b])]}}}function O3({chunk:e,coefficients:t}){let[r,n,i]=t,s=e.Constant(Ce(0,1));i===void 0&&(i=s),n===void 0&&(n=s),r===void 0&&(r=s);let o=e.Constant(Ce(2,1)),a=e.Constant(NaN),u=e.Constant(Ce(1e305,1)),c=e.Negative([u]),l=e.Multiply([o,i]),p=e.Negative([n]),f=e.Subtract([e.Multiply([n,n]),e.Multiply([o,e.Multiply([l,r])])]),y=e.SyntheticNativeFunction(\"sqrt\",[f]),h=e.Divide([e.Add([p,y]),l]),m=e.Divide([e.Subtract([p,y]),l]),b=e.Negative([e.Divide([r,n])]),d=e.Equal([i,s]),g=e.Greater([i,s]),x=e.Equal([n,s]),M=e.Greater([n,s]),E=e.Less([n,s]),T=e.Greater([r,s]),D=e.Less([f,s]);return[e.Piecewise([d,e.Piecewise([E,b,a]),e.Piecewise([g,m,a])]),e.Piecewise([d,e.Piecewise([x,e.Piecewise([T,c,a]),a]),e.Piecewise([g,e.Piecewise([D,c,a]),h])]),e.Piecewise([d,e.Piecewise([x,e.Piecewise([T,u,a]),a]),e.Piecewise([g,e.Piecewise([D,u,a]),m])]),e.Piecewise([d,e.Piecewise([M,b,a]),e.Piecewise([g,h,a])])]}var R3=!1,Gy=I.List;function Kr(){return{}}function ec(e,t,r){let n=1/0;for(let s of t){let o=e[s];Array.isArray(o)&&o.length<n&&(n=o.length)}let i=1;return r===\"solvedEquation\"?i=2:r===\"baseComparator\"&&(i=4),i*n}function Ho(e,t,r){return Array.isArray(e)?e[rI(t,r)]:e}function N3(e,t){var r=t.viewport.xmax-t.viewport.xmin,n=t.viewport.ymax-t.viewport.ymin;let i=ss(r,n),s=ss(30,30),o=Math.round(2-Math.log(i/s)/Math.LN10);if(o<=0)return Math.round(e)+\"\";{let a=Math.pow(10,o);return Math.round(e*a)/a+\"\"}}function A3(e,t){var r=t.viewport.xmax-t.viewport.xmin,n=t.viewport.ymax-t.viewport.ymin;let i=r*n,s=30*30,o=Math.round(2-Math.log(i/s)/Math.LN10);if(o<=0)return Math.round(e)+\"\";{let a=Math.pow(10,o);return Math.round(e*a)/a+\"\"}}function C3(e,t){return t.degreeMode?Math.round(e/(Math.PI/180)*10)/10+\"\\xB0\":Math.round(e*100)/100+\"\"}function ja(e,t,r){let n=rI(t,r),i=e.userData.lineStyle,s=Ho(e.metaData.computedLineWidth,t,r),o=Ho(e.metaData.computedLineOpacity,t,r),a=Ho(e.metaData.computedFillOpacity,t,r),u=e.metaData.colorLatexValue?Ho(e.metaData.colorLatexValue,t,r):e.userData.color,c=Ho(e.metaData.computedResolution,t,r),l=Ho(e.metaData.computedCheckers,t,r);return{listIndex:n,style:i,lineWidth:s,lineOpacity:o,fillOpacity:a,color:u,resolution:c,checkers:l}}I.Base.prototype._graph=_3;function _3(e,t,r,n,i,s){var y;if(t instanceof I.SolvedEquation){let h=this._graph(e,t._expression,r,n,i,t.branchMultiplier===2?\"solvedEquation\":void 0),m=KS(this,t,r,e);return m&&(h||(h=[]),Array.prototype.push.apply(h,m)),h}function o(h){let m=h.editableLabelMode;return m===\"TEXT\"||m===\"MATH\"}function a(h,m){return\"colorLatex\"in h&&z3(h.colorLatex)?h.colorLatex:m}let u=t.getExpressionType(n.graphMode,t.valueType),c=SO(u,{points:this.userData.points,lines:this.userData.lines,fill:this.userData.fill}),l={lineOpacity:\"computedLineOpacity\",lineWidth:\"computedLineWidth\",color:\"colorLatexValue\",fillOpacity:\"fillOpacity\",resolution:\"resolution\",checkers:\"checkers\"},p=(h,m)=>{let b=ec(this.metaData,Object.keys(h).map(g=>l[g]),s),d=[];return Gy.wrap(t).eachElement((g,x)=>{if(x>=b)return;let M=this.getGraphInfo(e,g);M.graphMode=n.graphMode;let E=ja(this,x,s);M.listIndex=E.listIndex,M.style=E.style,\"lineWidth\"in h&&(M.lineWidth=E.lineWidth),\"lineOpacity\"in h&&(M.lineOpacity=E.lineOpacity),\"fillOpacity\"in h&&(M.fillOpacity=E.fillOpacity),\"color\"in h&&(M.color=a(this.userData,E.color)),\"resolution\"in h&&(M.resolution=E.resolution),\"checkers\"in h&&(M.checkers=E.checkers),d.push(...m(g,M))}),d},f=n.graphMode;switch(f){case 4:{let{points:d,droppedIndices:g}=Cp([t.asValue()]),x=this.userData.shouldGraph&&c.points,M=this.userData.showLabel&&!x;return x?[{segments:[d],graphMode:f,droppedIndices:g,color:zo(this.userData,this.metaData),style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,pointOpacity:this.metaData.computedPointOpacity,suppressTextOutline:this.userData.suppressTextOutline,editableLabel:o(this.userData),labels:this.computedLabels||[],poi:xs(d),movablePointInfo:[]}]:M?[{segments:[d],graphMode:3,color:zo(this.userData,this.metaData),style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,nakedLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,pointOpacity:this.metaData.computedPointOpacity,suppressTextOutline:this.userData.suppressTextOutline,editableLabel:o(this.userData),labels:this.computedLabels||[],poi:xs(d),showPoint:!1}]:[]}case 3:{let d=[],g=this.userData.shouldGraph&&c.points,x=this.userData.shouldGraph&&c.lines,M=[\"colorLatexValue\"];g&&M.push(\"computedPointOpacity\",\"computedPointSize\"),(this.userData.showLabel||g)&&M.push(\"computedLabelSize\",\"computedLabelAngle\");let E=ec(this.metaData,M,s),T=Gy.wrap(t).asValue();En(T),T.length>E&&(T.length=E);let D=this.userData.showLabel&&!g&&!x,S=Cp(T);if(this.userData.showLabel||g){let O={segments:[S.points],graphMode:f,droppedIndices:S.droppedIndices,color:this.metaData.colorLatexValue||this.userData.color,style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,showPoint:g,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,pointSize:this.metaData.computedPointSize,pointOpacity:this.metaData.computedPointOpacity,suppressTextOutline:this.userData.suppressTextOutline,interactiveLabel:!!this.userData.interactiveLabel,editableLabel:o(this.userData),nakedLabel:D,labels:this.computedLabels||[],poi:xs(T)};e.is3dPolicy()?d.push(...V3(O)):d.push(O)}if(x){let O=this.metaData.computedLineWidth,A={segments:WS(T),graphMode:5,color:zo(this.userData,this.metaData),style:this.userData.lineStyle,lineWidth:O,lineOpacity:this.metaData.computedLineOpacity,poi:Kr()};d.push(YS(e,A,r,O))}return d}case 114:case 115:case 116:{let d=[],g=this.userData.shouldGraph&&c.points,x=this.userData.shouldGraph&&c.lines,M=[\"colorLatexValue\"];g&&M.push(\"computedPointOpacity\",\"computedPointSize\");let E=Gy.wrap(t).asValue();En(E);let{degreeMode:T}=r,D=E.map(A=>hS(f,A,T)),S=ec(this.metaData,M,s),O=Math.min(D.length,S);if(g)for(let A=0;A<O;A++){let{color:_,fillOpacity:L}=ja(this,A,s),H=Ho(this.metaData.computedPointSize,A,s);d.push({graphMode:114,position:D[A],radius:.02*H,guid:Ni(),color:_,fillOpacity:L})}if(x){let A=Ho(this.metaData.computedLineWidth,0,s),{color:_}=ja(this,0,s);d.push({graphMode:100,points:Zu(D,r.viewport,A),thickness:A,guid:Ni(),color:_})}return d}case 117:let h=this.metaData.colorLatexValue?!Array.isArray(this.metaData.colorLatexValue):!0,m=this.metaData.computedFillOpacity;if(t.valueType===Ur&&h&&!Array.isArray(m)){let d=[],g=[],x=[],M=[],E=(y=this.metaData.colorLatexValue)!=null?y:this.userData.color,T=this.metaData.computedFillOpacity;return p({color:!0},S=>{if(S.valueType===xr){let[[O,A,_],[L,H,w],[q,$,F]]=S.asValue();if(isNaN(O)||isNaN(A)||isNaN(_)||isNaN(L)||isNaN(H)||isNaN(w)||isNaN(q)||isNaN($)||isNaN(F))return[];let Z=d.length/3;d.push(O,A,_,L,H,w,q,$,F);let re=new nr(O,A,_),Ee=new nr(L,H,w),K=new nr(q,$,F),fe=new nr().subVectors(re,K),at=new nr().subVectors(Ee,re),me=new nr().crossVectors(fe,at);g.push(me.x,me.y,me.z,me.x,me.y,me.z,me.x,me.y,me.z),x.push(Z,Z+1,Z+2),M.push(0,0,0,1,1,0)}return[]}),[{meshData:{guid:Ni(),positions:new Float32Array(d),normals:new Float32Array(g),faces:new Uint32Array(x),uvs:new Float32Array(M),extraAttrs:new Float32Array([])},color:a(this.userData,E),fillOpacity:T!=null?T:1,graphMode:117}]}return p({color:!0,fillOpacity:!0},(d,g)=>{var K;let[[x,M,E],[T,D,S],[O,A,_]]=d.asValue();if(isNaN(x)||isNaN(M)||isNaN(E)||isNaN(T)||isNaN(D)||isNaN(S)||isNaN(O)||isNaN(A)||isNaN(_))return[];let L=[x,M,E,T,D,S,O,A,_],H=new nr(x,M,E),w=new nr(T,D,S),q=new nr(O,A,_),$=new nr().subVectors(H,q),F=new nr().subVectors(w,H),Z=new nr().crossVectors($,F),re=[Z.x,Z.y,Z.z,Z.x,Z.y,Z.z,Z.x,Z.y,Z.z];return[{meshData:{guid:Ni(),positions:new Float32Array(L),normals:new Float32Array(re),faces:new Uint32Array([0,1,2]),uvs:new Float32Array([0,0,0,1,1,0]),extraAttrs:new Float32Array([])},color:a(this.userData,g.color),fillOpacity:(K=g.fillOpacity)!=null?K:1,graphMode:117}]});case 119:case 129:return p({color:!0,lineWidth:!0},(d,g)=>{let{lineWidth:x,color:M}=g,E=d.asValue(),[[T,D,S],[O,A,_]]=E;return isNaN(T)||isNaN(D)||isNaN(S)||isNaN(O)||isNaN(A)||isNaN(_)?[]:[{graphMode:d.valueType===dt?119:129,guid:Ni(),points:d.valueType===dt?[T,D,S,O,A,_]:[O,A,_,T+O,D+A,S+_],color:M,thickness:x}]});case 118:return p({color:!0,resolution:!0,fillOpacity:!0},(d,g)=>{let{color:x,fillOpacity:M,resolution:E}=g,T=d.asValue(),[[D,S,O],A]=T;return isNaN(D)||isNaN(S)||isNaN(O)||isNaN(A)?[]:[{graphMode:118,position:[D,S,O],radius:A,resolution:E,guid:Ni(),color:x,fillOpacity:M!=null?M:1}]});case 5:case 100:case 101:case 102:{let d=this.userData,g=this.metaData,x=[],M=p({color:!0,lineOpacity:!0,lineWidth:!0,resolution:!0},(T,D)=>{if(T.getDependencies().length===0){let{points:O,droppedIndices:A}=Cp([T.asValue()]);return[{segments:[O],graphMode:3,droppedIndices:A,color:zo(d,g),style:d.lineStyle,showPoint:!1,poi:xs(O)}]}else{let O=T.getCompiledFunction();D.domain={type:\"1d\",min:this.metaData.evaluatedDomainMin,max:this.metaData.evaluatedDomainMax};let A=fa({viewState:r,graphInfo:D,compiled:O});return[YS(e,A,r,D.lineWidth)]}}),E=[];for(let T of M)T&&E.push(T);if(c.fill)if(E.forEach((T,D)=>{let{color:S,fillOpacity:O,listIndex:A}=ja(this,D,s);x.push({segments:T.segments,color:S,fillOpacity:O,listIndex:A,graphMode:7,poi:Kr()})}),c.lines)E=E.concat(x);else return x;return E}case 20:return p({lineOpacity:!0,lineWidth:!0,color:!0},(d,g)=>{let[[x,M],E]=d.asValue();return isNaN(x)||isNaN(M)||isNaN(E)?[]:[{segments:[[x,M,E]],resolved:!0,graphMode:g.graphMode,color:g.color,style:g.lineStyle,lineWidth:g.lineWidth,lineOpacity:g.lineOpacity,listIndex:g.listIndex,operator:g.operator,poi:Kr()}]});case 21:return p({color:!0,lineWidth:!0,lineOpacity:!0},(d,g)=>{let x=Pm(d.asValue());if(!x)return[];let M=[];return x.type===\"arc\"?M.push({graphMode:f,segments:[[x.center[0],x.center[1],x.radius,x.startAngle,x.endAngle]],color:g.color,style:g.lineStyle,lineWidth:g.lineWidth,lineOpacity:g.lineOpacity,listIndex:g.listIndex,operator:n.operator,poi:Kr()}):x.type===\"rays\"?M.push({graphMode:19,segments:[[x.start1[0],x.start1[1],x.end1[0],x.end1[1]]],color:g.color,style:g.lineStyle,lineWidth:g.lineWidth,lineOpacity:g.lineOpacity,listIndex:g.listIndex,operator:n.operator,poi:Kr()},{graphMode:19,segments:[[x.start2[0],x.start2[1],x.end2[0],x.end2[1]]],color:g.color,style:g.lineStyle,lineWidth:g.lineWidth,lineOpacity:g.lineOpacity,listIndex:g.listIndex,operator:n.operator,poi:Kr()}):M.push({graphMode:17,segments:[[x.start[0],x.start[1],x.end[0],x.end[1]]],color:g.color,style:g.lineStyle,lineWidth:g.lineWidth,lineOpacity:g.lineOpacity,listIndex:g.listIndex,operator:n.operator,poi:Kr()}),[...M,...$S(M,i)]});case 17:case 18:case 19:return p({color:!0,lineWidth:!0,lineOpacity:!0},(d,g)=>{let[[x,M],[E,T]]=d.asValue();if(isNaN(x)||isNaN(M)||isNaN(E)||isNaN(T))return[];let D=[],S={segments:[[x,M,E,T]],resolved:!0,graphMode:g.graphMode,color:g.color,style:g.lineStyle,arrowMode:g.arrowMode,lineWidth:g.lineWidth,lineOpacity:g.lineOpacity,listIndex:g.listIndex,operator:n.operator,poi:Kr()};if(D.push(XS(e,S,r)),D.push(...$S([S],i)),this.userData.showLabel&&n.graphMode===17){let O=g.listIndex,A=this.computedLabels&&this.computedLabels[O||0];D.push({graphMode:22,objectType:17,segments:[[x,M,E,T]],color:g.color,listIndex:O,showLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,labels:A?[A]:[N3(ss(E-x,T-M),r)]})}return D});case 24:return p({lineOpacity:!0,lineWidth:!0,color:!0},(d,g)=>{let[x,M]=d.asValue(),[[E,T],[D,S]]=[M,[M[0]+x[0],M[1]+x[1]]];if(isNaN(D)||isNaN(S)||isNaN(E)||isNaN(T))return[];let O={segments:[[E,T,D,S]],resolved:!0,graphMode:g.graphMode,color:g.color,style:g.lineStyle,arrowMode:g.arrowMode,lineWidth:g.lineWidth,lineOpacity:g.lineOpacity,listIndex:g.listIndex,operator:n.operator,poi:Kr()};return[XS(e,O,r)]});case 23:return p({lineOpacity:!0,lineWidth:!0,color:!0},(d,g)=>{let{value:x,valueType:M}=d.asTypedValue(),[[E,T],D,S]=x;if(isNaN(E)||isNaN(T)||isNaN(D)||isNaN(S))return[];let O=g.listIndex,A=M===xe,_=A?S:Math.abs(S),L=[];if(L.push({graphMode:23,segments:[[E,T,D,S,A?1:0]],color:g.color,style:g.lineStyle,lineWidth:g.lineWidth,lineOpacity:g.lineOpacity,listIndex:O,operator:n.operator,poi:Kr()}),this.userData.showAngleLabel){let H=this.computedLabels&&this.computedLabels[O||0];L.push({graphMode:22,objectType:23,segments:[[E,T,D,S]],color:g.color,listIndex:O,showLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,labels:H?[H]:[C3(_,r)]})}return L});case 1:case 2:case 8:case 112:case 126:case 113:case 127:case 6:case 130:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 120:case 121:case 122:case 123:case 124:case 125:{let d=t.valueType===P;return p({lineOpacity:!0,lineWidth:!0,resolution:!0,fillOpacity:!0,color:!0,checkers:!0},(g,x)=>{var q,$,F,Z,re,Ee,K,fe,at,me,Kt,Ge;(n.graphMode===6||n.graphMode===110||n.graphMode===124)&&(x.domain={type:\"1d\",min:this.metaData.evaluatedDomainMin,max:this.metaData.evaluatedDomainMax,isExplicit:this.metaData.isExplicitDomain}),(n.graphMode==130||n.graphMode==103||n.graphMode==104||n.graphMode==105||n.graphMode==111||n.graphMode==109||n.graphMode==125)&&(x.domain={type:\"2d\",uMin:this.metaData.evaluatedDomain3DuMin,uMax:this.metaData.evaluatedDomain3DuMax,vMin:this.metaData.evaluatedDomain3DvMin,vMax:this.metaData.evaluatedDomain3DvMax});let M=[],E=(q=_i[n.graphMode])!=null?q:[],T=g.getCompiledFunction(E),D;try{D=g.getCompiledDerivative()}catch(U){}let S=w3(this,g,T,r,x,D,d);if(S)return S;let O=MT(x.graphMode),A=($=this.userData.extendTo3D)!=null?$:!1,_=O&&!A,L=!e.is3dPolicy()||_,H=(F=this.userData.lines)!=null?F:L,w=(Z=this.userData.lines)!=null?Z:!_;if(x.graphMode===127&&!A&&((re=this.userData.lines)==null||re)){let U=(Ee=_i[x.graphMode])!=null?Ee:[],z=g._chunk.copy();z.GreaterEqual([z.getReturnIndex(),z.Constant(0)]),z.close();let Me=g.getCompiledFunction(U),ae=0,be=r.viewport,{xmin:ve,xmax:hr,ymin:_t,ymax:or}=be,Xr=new Ie(ve,hr),vr=new Ie(_t,or),le=Fo(($r,Or)=>[$r,Or,ae],be,Xr,vr,2,0);return[{meshData:Ci(le),color:x.color,fillOpacity:(K=x.fillOpacity)!=null?K:1,uvRange:[Xr,vr],uvArgs:(fe=_i[x.graphMode])!=null?fe:[],extraMeshArgs:(at=Wu[x.graphMode])!=null?at:[],checkers:(me=x.checkers)!=null?me:pa,graphMode:106,compiled:Me,restrictionShader:Oo(z)}]}if(O&&(this.userData.lines===!0?(H=_,w=!_):this.userData.lines===!1&&(H=!1,w=!1)),w&&Co(x.graphMode)){let U=Fy(x.graphMode),z=g.getRestrictedFunctionForGLSL(U),Me=qS(x,z,r);if(M.push(Me),x.graphMode===113||x.graphMode===127){let{positions:ae,normals:be,faces:ve,uvs:hr}=zS(),_t={guid:Ni(),isDomainCube:!0,positions:ae,normals:be,faces:ve,uvs:hr,extraAttrs:new Float32Array([])},or=g.toImplicitBool();M.push({meshData:_t,graphMode:113,color:x.color,fillOpacity:1,uvRange:[new Ie(0,1),new Ie(0,1)],uvArgs:[],extraMeshArgs:[],checkers:(Kt=n.checkers)!=null?Kt:pa,compiled:T,restrictionShader:Oo(or._chunk)});let Xr=or.getCapFunction(U);if(Xr){let vr=qS(x,Xr,r);M.push(vr)}}}if(H&&L3(this,x),!Co(x.graphMode)){let U=fa({viewState:r,graphInfo:x,compiled:T,derivative:D}),z=eR(ca(this),g);if(z&&(U.boundingBox=z),e.is3dPolicy()&&H&&fI(U.graphMode)){let Me=(Ge=x.lineWidth)!=null?Ge:1;M.push(Ny(U,r,Me))}else if(U.fillSegments){let Ze=U,{fillSegments:Me}=Ze,ae=jI(Ze,[\"fillSegments\"]);H||(ae.lineWidth=0),M.push(ae)}else H||(U.lineWidth=0),(H||!Co(n.graphMode))&&M.push(U);x.graphMode===8&&x.operator!==\"=\"&&M.push({graphMode:7,segments:U.fillSegments,poi:Kr(),listIndex:x.listIndex,color:x.color,fillOpacity:x.fillOpacity})}return M})}case 200:case 201:case 202:case 206:case 205:case 211:case 203:case 204:case 213:case 207:case 208:case 212:case 214:case 215:case 209:return p({color:!0,lineWidth:!0,lineOpacity:!0,resolution:!0},(d,g)=>{var x;{switch(f){case 206:case 211:g.domain={type:\"1d\",min:this.metaData.evaluatedDomainMin,max:this.metaData.evaluatedDomainMax,isExplicit:this.metaData.isExplicitDomain};break;case 203:case 204:case 213:case 207:case 208:case 212:case 214:case 215:g.domain={type:\"2d\",uMin:this.metaData.evaluatedDomain3DuMin,uMax:this.metaData.evaluatedDomain3DuMax,vMin:this.metaData.evaluatedDomain3DvMin,vMax:this.metaData.evaluatedDomain3DvMax};break}let M=(x=_i[f])!=null?x:[],E={allowSlices:!0},T=No(d._chunk,M,E),{valueChunk:D,slices:S}=T.getValueAndRestrictionChunk(),O=D.getCompiledFunction(M),A=S[0],_=A.type===\"implicit\",L=_?NaN:A.value,H=_?\"_implicit\":A.variable,w,q=$=>fa({viewState:r,graphInfo:ee(W({},g),{slice_coordinate:H,slice_value:L,slice_function:$}),compiled:O});if(_){let $=[\"x\",\"y\",\"z\"],F=[\"x\",\"y\",\"z\",\"r\",\"theta\"],Z=[\"x\",\"y\",\"z\",\"r\",\"theta\",\"phi\"],re=[\"x\",\"y\",\"z\",\"u\",\"v\"],Ee=A.sliceChunk;switch(f){case 200:case 201:case 202:w=Ee.getCompiledFunction($);break;case 211:case 213:w=Ee.getCompiledFunction(F);break;case 212:w=Ee.getCompiledFunction(Z);break;case 215:case 214:w=Ee.getCompiledFunction(re);break;case 209:{let K=(at,me)=>{let Kt=at._symbol,Ge=at._expression.args,Ze=[];for(let U of Ge){if(!(U instanceof sr))throw ne(\"Programming Error: bad type\");if(Kt===\"x\")O=U._chunk.getCompiledFunction([\"y\",\"z\"]),g.graphMode=201;else if(Kt===\"y\")O=U._chunk.getCompiledFunction([\"x\",\"z\"]),g.graphMode=202;else if(Kt===\"z\")O=U._chunk.getCompiledFunction([\"x\",\"y\"]),g.graphMode=200;else throw ne(\"Programming Error: bad lhs\");Ze.push(q(me))}return Ze},fe=cI(e,D);if(fe instanceof I.SolvedEquation&&!fe.isError)return K(fe,Ee.getCompiledFunction($));if(fe=cI(e,Ee),fe instanceof I.SolvedEquation&&!fe.isError)return K(fe,D.getCompiledFunction($));break}}}return[q(w)]}});case 210:return p({color:!0,fillOpacity:!0,resolution:!0,checkers:!0},(d,g)=>{var x,M,E,T,D,S,O,A,_,L;{let H=(x=_i[f])!=null?x:[],w={allowSlices:!0},q=No(d._chunk,H,w),{valueChunk:$,slices:F}=q.getValueAndRestrictionChunk(),Z=$.copy();Z.GreaterEqual([Z.getReturnIndex(),Z.Constant(0)]),Z.close();let re=$.getCompiledFunction(H);if(F[0].type===\"implicit\"){let _t=F[0].sliceChunk,or;try{or=_t.copy().gradient([\"x\",\"y\",\"z\"]).getCompiledFunction([\"x\",\"y\",\"z\"]).fn}catch(An){}let Xr=(M=g.resolution)!=null?M:NaN;isNaN(Xr)&&(Xr=xy),Xr=Jr(Xr,0,100);let vr=jT(_t.getCompiledFunction(H),or,r.viewport,Xr,{isInequality:!1}),{xmin:ze,xmax:le,ymin:We,ymax:ui}=r.viewport,$r=new Ie(ze,le),Or=new Ie(We,ui);return[{meshData:vr,color:g.color,fillOpacity:(E=g.fillOpacity)!=null?E:1,uvRange:[$r,Or],uvArgs:(T=_i[g.graphMode])!=null?T:[],extraMeshArgs:(D=Wu[g.graphMode])!=null?D:[],checkers:(S=g.checkers)!=null?S:pa,graphMode:f,compiled:re,restrictionShader:Oo(Z)}]}let Ee=F[0].value,K=F[0].variable,fe=r.viewport,{xmin:at,xmax:me,ymin:Kt,ymax:Ge,zmin:Ze,zmax:U}=fe,z,Me,ae;switch(K){case\"x\":{z=new Ie(Kt,Ge),Me=new Ie(Ze,U),ae=(_t,or)=>[Ee,_t,or];break}case\"y\":{z=new Ie(at,me),Me=new Ie(Ze,U),ae=(_t,or)=>[_t,Ee,or];break}case\"z\":{z=new Ie(at,me),Me=new Ie(Kt,Ge),ae=(_t,or)=>[_t,or,Ee];break}default:return[]}let be=Fo(ae,fe,z,Me,2,0);return[{meshData:Ci(be),color:g.color,fillOpacity:(O=g.fillOpacity)!=null?O:1,uvRange:[z,Me],uvArgs:(A=_i[g.graphMode])!=null?A:[],extraMeshArgs:(_=Wu[g.graphMode])!=null?_:[],checkers:(L=g.checkers)!=null?L:pa,graphMode:f,compiled:re,restrictionShader:Oo(Z)}]}});case 16:{let d=[],g=this.userData.lines===void 0?!0:this.userData.lines,x=this.userData.fill===void 0?!0:this.userData.fill;if(!x&&!g)return d;let M=ec(this.metaData,[\"computedLineOpacity\",\"computedLineWidth\",\"colorLatexValue\",\"fillOpacity\"],s),E=t.asValue();j(t.valueType)||(E=[E]);for(let T=0;T<E.length;T++){if(T>M-1)continue;let D=E[T];if(!D.length)continue;let S=this.getGraphInfo(e,t),{listIndex:O,lineWidth:A,lineOpacity:_,fillOpacity:L,color:H}=ja(this,T,s);this.userData.shouldOmitLastPolygonSegment||(D=[...D,D[0]]),En(D);let w=WS(D);if(w.length&&(x&&d.push({segments:w,graphMode:7,poi:Kr(),color:H,fillOpacity:L,style:S.style,listIndex:O}),g&&d.push({segments:w,graphMode:5,poi:Kr(),color:H,style:this.userData.lineStyle,lineWidth:A,lineOpacity:_,listIndex:O}),R3&&this.userData.showLabel)){let q=this.computedLabels&&this.computedLabels[O||0];d.push({graphMode:22,objectType:16,segments:w,color:H,listIndex:O,showLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,labels:q?[q]:[A3(jx(D),r)]})}}return d}case 7:case 11:case 10:case 15:case 22:case 128:return!1;default:let b=f;throw new Error(`Unexpected graphMode: ${b}`)}}function qS(e,t,r){var o;let n=(o=_i[e.graphMode])!=null?o:[],i,s=!1;if(e.graphMode===112||e.graphMode===126||e.graphMode===113){e.operator!==\"=\"&&(s=!0);try{i=t.concrete.gradient([\"x\",\"y\",\"z\"]).getCompiledFunction([\"x\",\"y\",\"z\"]).fn}catch(a){}}return fa({viewState:r,graphInfo:e,compiled:t.concrete.getCompiledFunction(n),restrictionShader3d:t.restriction,isImplicit3dInequality:s,gradient:i})}function L3(e,t){var n,i,s,o;if(MT(t.graphMode))switch(t.graphMode){case 121:case 123:{t.graphMode=2,t.willConvertTo3D=!0,(n=t.lineWidth)!=null||(t.lineWidth=1);break}case 120:case 122:{t.graphMode=1,t.willConvertTo3D=!0,(i=t.lineWidth)!=null||(t.lineWidth=1);break}case 124:let{min:a,max:u}=((s=t.domain)==null?void 0:s.type)===\"1d\"?t.domain:{min:0,max:2*Math.PI};t.graphMode=6,t.domain={type:\"1d\",min:a,max:u,isExplicit:e.metaData.isExplicitDomain};break;case 125:let{uMin:c,uMax:l}=((o=t.domain)==null?void 0:o.type)===\"2d\"?t.domain:{uMin:0,uMax:2*Math.PI};t.graphMode=6,t.domain={type:\"1d\",min:c,max:l,isExplicit:e.metaData.isExplicitDomain};break;case 126:t.graphMode=8;break}}function w3(e,t,r,n,i,s,o){let a=e.metaData.evaluatedCDFMin,u=e.metaData.evaluatedCDFMax,c=ca(e),l=eR(c,t),p=c&&c.discrete;if(a!==void 0&&u!==void 0&&!isNaN(a)&&!isNaN(u)&&o){let f=[];if(p){let y={viewState:n,graphInfo:i,compiled:r,bounds:[a,u],maxOverride:ZS(c,t),showPoint:e.userData.shouldGraph},h=TS(y),m=h.cdfTopBranch,b=h.topBranches;if(b.forEach(function(d){!d||!l||(d.boundingBox=l)}),b.every(d=>d!==void 0)&&(f=b,m&&m.segments[0].length)){let d=[];m.segments[0].forEach(function(g){!isNaN(g[0])&&!isNaN(g[1])&&d.push([g[0],0,g[0],g[1]])}),f.push({graphMode:5,segments:d,boundingBox:l,poi:Kr(),color:i.color})}}else{let h=IS({viewState:n,graphInfo:i,compiled:r,derivative:s,bounds:[a,u]}),m=h.cdfTopBranch,b=h.topBranches;if(b.forEach(function(d){!d||!l||(d.boundingBox=l)}),f=b,m&&m.segments.length){let d,g;for(let x=0;x<m.segments.length;x++){let M=m.segments[x];if(M.length>=4){d=M[0];break}}for(let x=m.segments.length-1;x>=0;x--){let M=m.segments[x];if(M.length>=4){g=M[M.length-2];break}}if(d!==void 0&&g!==void 0&&isFinite(d)&&isFinite(g)){let x=Sy(m.segments,[[d,0,g,0]],m.graphMode);f.push({graphMode:7,segments:x,poi:Kr(),color:i.color})}}}return f}else if(p){let f=Oy({viewState:n,graphInfo:i,compiled:r,showPoint:e.userData.shouldGraph,maxOverride:ZS(c,t)});return l&&(f.boundingBox=l),[f]}else return}function jS(e){return F3(e)||fI(e)||JS(e)}function F3(e){return e===3}function lI(e,t){let r=t!=null?t:{};if(!Array.isArray(e))return()=>e;let n=Object.keys(r).length===0?e:e.filter((i,s)=>!r[s]);return i=>n[i]}function V3(e){var s,o;let t=e.droppedIndices,r=lI((s=e.pointSize)!=null?s:1,t),n=lI(e.color,t),i=lI((o=e.pointOpacity)!=null?o:1,t);return e.segments[0].map(([a,u],c)=>({graphMode:114,position:[a,u,0],radius:.02*r(c),guid:Ni(),color:n(c),fillOpacity:i(c)}))}function YS(e,t,r,n){return e.is3dPolicy()&&fI(t.graphMode)?Ny(t,r,n!=null?n:1):t}function fI(e){switch(e){case 1:case 2:case 6:case 8:case 5:return!0;default:return!1}}function Ny(e,t,r,n=0){var o;let i=QS(e,t,n),s=Zu(i,t.viewport,r);return{graphMode:128,guid:Ni(),points:s,resolved:e.resolved,color:e.color,thickness:(o=e.lineWidth)!=null?o:1}}function XS(e,t,r){return e.is3dPolicy()&&JS(t.graphMode)?B3(t,r):t}function JS(e){switch(e){case 17:case 24:return!0;default:return!1}}function B3(e,t){var n;let r=QS(e,t);return{graphMode:e.graphMode===17?119:e.graphMode===24?129:128,guid:Ni(),points:G3(r),color:e.color,thickness:(n=e.lineWidth)!=null?n:1}}function G3(e){let t=[];for(let[r,n,i]of e)t.push(r,n,i);return t}function QS(e,t,r=0){function n(s,o){if(e.graphMode===1)return[o,s];if(e.graphMode===6){let a=t.degreeMode?s*Math.PI/180:s;return[o*Math.cos(a),o*Math.sin(a)]}else return[s,o]}let i=[];for(let s=0;s<e.segments.length;s++){let o=e.segments[s];for(let a=0;a<o.length/2;a++){let[u,c]=n(o[2*a],o[2*a+1]);i.push([u,c,r])}s<e.segments.length-1&&i.push([NaN,NaN,0])}return i}function Zu(e,t,r){if(t.zmin===void 0||t.zmax===void 0)return[];let{xmin:n,xmax:i,ymin:s,ymax:o,zmin:a,zmax:u}=t,c=i-n,l=o-s,p=u-a,f=r/200,y=[],h=1e-4;for(let d=0;d<e.length;d++){let g=e[d];if(isFinite(g[0])&&isFinite(g[1])&&isFinite(g[2])){let x=y[y.length-1];x!==void 0&&Math.abs(g[0]-x[0])<h*c&&Math.abs(g[1]-x[1])<h*l&&Math.abs(g[2]-x[2])<h*p||y.push(g)}else y.push(void 0)}let m=[],b=y.length;for(let d=0;d<b;d++){let g=y[d];if(!g){m.push(NaN,NaN,NaN);continue}let[x,M,E]=g,T=y[d-1],D=y[d+1];if(T&&D){let[S,O,A]=T,[_,L,H]=D,w=(x-S)/c,q=(_-x)/c,$=(M-O)/l,F=(L-M)/l,Z=(E-A)/p,re=(H-E)/p,Ee=Bs(w,$,Z),K=Bs(q,F,re);if((q*w+F*$+re*Z)/(Ee*K)<.7&&Ee>f&&K>f){let at=.5*(f/Ee),me=.5*(f/K),Kt=Ms(S,x,1-at),Ge=Ms(O,M,1-at),Ze=Ms(A,E,1-at),U=Ms(x,_,me),z=Ms(M,L,me),Me=Ms(E,H,at);m.push(Kt,Ge,Ze),m.push(Ms(Kt,x,.5),Ms(Ge,M,.5),Ms(Ze,E,.5)),m.push(x,M,E),m.push(Ms(x,U,.5),Ms(M,z,.5),Ms(E,Me,.5)),m.push(U,z,Me)}else m.push(x,M,E)}else m.push(x,M,E)}return m}function Ms(e,t,r){return(1-r)*e+r*t}function z3(e){return e===\"gradient_u\"||e===\"gradient_v\"||e===\"checkers\"||e.startsWith(\"shader:\")||e.startsWith(\"data:image\")}function By(e,t,r){return{resolved:!0,graphMode:t,segments:r,operator:e.operator,poi:Kr(),color:e.color,style:\"DASHED\",lineWidth:1,lineOpacity:.5,isIntersectionExtension:!0}}function $S(e,t){var n,i;if(!t)return[];let r=[];for(let s of e)if(s.graphMode===17){let o=t[(n=s.listIndex)!=null?n:0];if(!o)continue;let a=0,u,c=1,l,[p,f,y,h]=s.segments[0];for(let m=0;m<o.length;m++){let[b,d]=o[m],g=Rs(b,d,0,p,f,0,y,h,0);g<a&&(a=g,u=m),s.graphMode===17&&g>c&&(c=g,l=m)}u!==void 0&&r.push(By(s,17,[[p,f,o[u][0],o[u][1]]])),l!==void 0&&r.push(By(s,17,[[y,h,o[l][0],o[l][1]]]))}else if(s.graphMode===21){let o=t[(i=s.listIndex)!=null?i:0];if(!o)continue;let[a,u,c,l,p]=s.segments[0],f=p-l+(p<l?1:-1)*2*Math.PI,y=[];for(let h of o){let[m,b]=h,d=Math.atan2(b-u,m-a),g=t0(d,l,f);0<g&&g<1&&y.push(g)}if(y.length){y.push(0,1),y.sort();let h=0,m=0;for(let g=0;g<y.length-1;g++){let x=y[g+1]-y[g];(h===void 0||x>h)&&(h=x,m=g)}let b=y[m],d=y[m+1];b>0&&r.push(By(s,21,[[a,u,c,l,l+b*f]])),d<1&&r.push(By(s,21,[[a,u,c,p,p-(1-d)*f]]))}}return r}function H3(){throw new Error(\"Programming error: this function is not expected to be called\")}function KS(e,t,r,n){let i=[];for(let s=0;s<t.otherVariableSolutionData.length;s++){let o=t.otherVariableSolutionData[s];if(!o)continue;let{coefficients:a,restriction:u}=o,c=a.argNames[0];if(c!==\"x\"&&c!==\"y\")continue;let l=a.getCompiledFunction().fn,p,f;c===\"y\"?(p=1,f=2):(p=2,f=1);let y=void 0,{listIndex:h,style:m,lineWidth:b,lineOpacity:d,color:g}=ja(e,s,y),x=jc(r,{graphMode:p,domainBound:gn(),lineWidth:b,operator:\"=\"},H3);if(!x)continue;let M=yS(l,x);for(let E of M){let T=new sr(u.substituteConstantArguments({[c]:E})),D=e.getGraphInfo(n,T);D=ee(W({},D),{graphMode:f,lineWidth:b});let S=void 0,O=e._graph(n,T,r,D,S,t.branchMultiplier===2?\"solvedEquation\":void 0);if(zs(O))for(let A of O)i.push(ee(W({},A),{listIndex:h,style:m,lineWidth:b,lineOpacity:d,color:g}))}}return i.length>0?i:!1}I.Base.prototype.tryGraph=function(e,t,r,n){try{return this.graph(e,t,r,n)}catch(i){let s=i instanceof I.Error?i.getError():ne(i).getError();return[dS(s)]}};I.Base.prototype.graph=function(e,t,r,n){let i=this.getGraphInfo(e,t);return this._graph(e,t,r,i,n)};I.BaseComparator.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t),i=n.graphMode,s=\"baseComparator\",o=this.userData.lines===void 0?!0:this.userData.lines;if(i===8||i===112||i===113||i===127||i===210)return this._graph(e,t,r,n);if(i===10||!(t instanceof I.SolvedEquation))return!1;let a=this.getOperator(),u=[],c=[],l=!0;t._expression.eachElement(function(b){u.push(b.getCompiledFunction());try{c.push(b.getCompiledDerivative())}catch(d){l=!1}}),l||(c=void 0);let p=[],f=[-1,0,0,1],y=ec(this.metaData,[\"computedLineWidth\",\"computedLineOpacity\",\"computedFillOpacity\",\"colorLatexValue\"],s),h=Math.min(u.length,y);for(let b=0;b<h;b++){let d=this.getGraphInfo(e,t._expression.args[b]);d.graphMode=i;let{listIndex:g,style:x,color:M,lineWidth:E,lineOpacity:T,fillOpacity:D}=ja(this,b,s);d.listIndex=g,d.style=x,d.color=M,n.graphMode===6&&(d.domain={type:\"1d\",min:this.metaData.evaluatedDomainMin,max:this.metaData.evaluatedDomainMax,isExplicit:this.metaData.isExplicitDomain});let S=fa({viewState:r,graphInfo:d,compiled:u[b],derivative:c?c[b]:void 0});S.lineWidth=E,S.lineOpacity=T,S.fillOpacity=D,S.operator=pu(wn[a].inclusive,f[b%4]),o||(S.lineWidth=0),p.push(S)}for(let b=0;b<h;b+=4){let d=Sy(p[b+1].segments,p[b+2].segments,i);p.push({graphMode:7,listIndex:p[b].listIndex,segments:d,poi:Kr(),fillOpacity:p[b].fillOpacity,color:p[b].color})}let m=KS(this,t,r,e);if(m){for(let b of m)b.operator=pu(wn[a].inclusive,0);Array.prototype.push.apply(p,m)}return p};I.DoubleInequality.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t);if(n.graphMode===10)return!1;let i=[],s=pu(wn[this._operators[0]].inclusive,0),o=pu(wn[this._operators[1]].inclusive,0),a=this.userData,u=this.metaData,c=a.lines===void 0?!0:a.lines,l=[\"colorLatexValue\",\"computedFillOpacity\"];c&&l.push(\"computedLineWidth\",\"computedLineOpacity\");let p=ec(u,l),f=t._expressions;return En(f),Gy.eachArgs(f,(y,h)=>{let m=h;if(m>=p)return;y[0].userData=y[1].userData=a,y[0].metaData=y[1].metaData=u;let b=void 0,{color:d,lineWidth:g,lineOpacity:x,fillOpacity:M}=ja(this,m,b),E=this._graph(e,y[0],r,n)[0];E.listIndex=m,E.operator=s,E.color=d,E.lineWidth=g,E.lineOpacity=x,i.push(E);let T=this._graph(e,y[1],r,n)[0];T.listIndex=m,T.operator=o,T.color=d,T.lineWidth=g,T.lineOpacity=x,i.push(T);let D=E.segments,S=T.segments;En(D),En(S);let O=Sy(D,S,E.graphMode);c||(E.lineWidth=0,T.lineWidth=0),i.push({graphMode:7,listIndex:E.listIndex,segments:O,lineOpacity:x,fillOpacity:M,poi:Kr(),color:d})}),i};I.Regression.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t);return this._graph(e,t.model,r,n)};function dI(e,t){let r=1/0,n=-1/0,i=1/0,s=-1/0;for(let a of t)for(var o=0;o<a.length;o+=2){let u=a[o],c=a[o+1];u<r&&(r=u),u>n&&(n=u),c<i&&(i=c),c>s&&(s=c)}if(isFinite(r)&&isFinite(i))return{type:e,xmin:r,ymin:i,xmax:n,ymax:s}}function eR(e,t){if(!e||!(t instanceof sr))return;let r=t._chunk,n=r.getInstruction(r.getReturnIndex());if(n.type!==37)return;let i=e.discrete?\"discreteDistribution\":\"continuousDistribution\";if(e.symbol===\"binomialdist\"&&n.symbol===\"binompdf\"){let s=Zt(r,n.args[1]),o=Zt(r,n.args[2]),a=hm(o*s,s,o);return{type:i,xmin:0,xmax:s,ymin:0,ymax:a}}if(e.symbol===\"poissondist\"&&n.symbol===\"poissonpdf\"){let s=Zt(r,n.args[1]),o=Math.max(Nc(Math.floor(s),s),Nc(Math.ceil(s),s));return{type:i,xmin:0,xmax:2.5*s,ymin:0,ymax:o}}if(e.symbol===\"normaldist\"&&n.symbol===\"normalpdf\"){let s=Zt(r,n.args[1]),o=Zt(r,n.args[2]),a=zx(s,s,o);return{type:i,xmin:s-2*Math.abs(o),xmax:s+2*Math.abs(o),ymin:0,ymax:a}}if(e.symbol===\"uniformdist\"&&n.symbol===\"uniformpdf\"){let s=Zt(r,n.args[1]),o=Zt(r,n.args[2]),a=(s+o)/2,u=o-s,c=kx(a,s,o);return{type:i,xmin:s-u/3,xmax:o+u/3,ymin:0,ymax:c}}if(e.symbol===\"tdist\"&&n.symbol===\"tpdf\"){let s=Zt(r,n.args[1]),o=gm(0,s);return{type:i,xmin:-3,xmax:3,ymin:0,ymax:o}}}function ZS(e,t){if(e===void 0||e.symbol!==\"binomialdist\"||!(t instanceof sr))return;let r=t._chunk,n=r.getInstruction(r.getReturnIndex());if(n.type===37&&n.symbol===\"binompdf\")return Zt(r,n.args[1])}function tR(e,t,r){let n={};r-=.5*t;for(var i=e.length-1;i>=0;i--){let s=e[i],o=Math.floor((s-r)/t);n[o]?n[o].data.push(s):n[o]={id:o,data:[s],min:o*t+r,max:o*t+r+t,center:o*t+r+t/2}}return n}I.Histogram.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t),i=t.args[0].asValue(),s=t.args[1].asValue(),o=this.userData.vizProps&&this.userData.vizProps.binAlignment===\"left\"?s/2:0;En(i);let a=tR(i,s,o),u=1;this.userData.vizProps&&this.userData.vizProps.histogramMode===\"density\"?u=1/(i.length*s):this.userData.vizProps&&this.userData.vizProps.histogramMode===\"relative\"&&(u=1/i.length);let c=[],l=[];for(let f in a){let y=a[f],h=y.data.length;l.push([y.min,0*u,y.min,h*u,y.max,h*u,y.max,0*u]);let m=0;a[y.id+1]&&(m=a[y.id+1].data.length);let b=[y.min,0*u,y.min,h*u,y.max,h*u];m<h&&b.push(y.max,m*u),c.push(b)}let p=dI(\"histogram\",l);return p&&s&&(p.binWidth=s),[{segments:l,graphMode:7,boundingBox:p,poi:Kr(),color:n.color,fillOpacity:.4},{segments:c,graphMode:2,poi:{zeros:{x:[],y:[]},extrema:{x:[],y:[]},intercept:{x:[],y:[]}},color:n.color}]};I.DotPlot.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t),i=t.args[1].asValue(),s=this.userData.vizProps&&this.userData.vizProps.binAlignment===\"left\"?i/2:0,o=t.args[0].asValue();En(o);let a=tR(o,i,s),u=!1,c,l=[];for(let d in a){let g=a[d];for(var p=g.data.length-1;p>=0;p--)g.center!==g.data[p]&&(u=!0)}if(this.userData.vizProps&&this.userData.vizProps.dotplotXMode===\"exact\")for(let d in a){c=a[d].data,c.reverse();for(let x=0;x<c.length;x++)l.push([c[x],x+1])}else for(let d in a){let g=a[d];c=g.data;for(let x=0;x<c.length;x++)l.push([g.center,x+1])}let f=dI(\"dotplot\",l);f&&i&&(f.ymin=0,f.xmin-=.5*i,f.xmax+=.5*i,f.binWidth=i);let{computedPointOpacity:y,computedPointSize:h}=this.metaData,m=Ho(y,0),b=this.userData.pointSize?Ho(h,0):14;return[{segments:[l],graphMode:3,boundingBox:f,poi:xs(l),color:n.color,style:this.userData.pointStyle,pointSize:b,pointOpacity:m,showPoint:!0,needsDotplotXMode:u}]};I.BoxPlot.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t),i=this.metaData.evaluatedAxisOffset,s=this.metaData.evaluatedBreadth,o=t.args[0].asValue();if(En(o),isNaN(s)||isNaN(i))return!1;let a=Math.min.apply(null,o),u=Math.max.apply(null,o),c=_u(o,1),l=_u(o,2),p=_u(o,3),f=i,y=f-s/2,h=f+s/2,m=s/10,b=[];if(this.userData.vizProps.showBoxplotOutliers){let M=p-c,E=c-1.5*M,T=p+1.5*M;a=1/0,u=-1/0,o.forEach(function(D){E<=D&&D<a&&(a=D),u<D&&D<=T&&(u=D),(D<E||D>T)&&b.push([D,f])})}let d=[[c,y,p,y,p,h,c,h,c,y],[l,y,l,h],[c,f,a,f],[p,f,u,f],[a,f-m,a,f+m],[u,f-m,u,f+m]];if(this.userData.vizProps&&this.userData.vizProps.alignedAxis===\"y\"){for(let M of d)for(var g=0;g<M.length;g+=2){let E=M[g];M[g]=M[g+1],M[g+1]=E}for(let M of b){let E=M[0];M[0]=M[1],M[1]=E}}let x=[{segments:d,graphMode:5,boundingBox:dI(\"boxplot\",d.concat(b)),poi:Kr(),color:n.color}];return b.length&&x.push({segments:[b],graphMode:3,color:n.color,style:\"OPEN\",showPoint:!0,poi:xs(b)}),x};function U3(e){return Array.prototype.concat.apply([],e)}I.Table.prototype.isValueDraggable=function(e,t,r){if(!e.columns[t].isIndependent)return!1;let i=this.columns[t].values,s=i&&i[r];return!!(s&&isFinite(s.asValue())&&s.getDependencies().length===0)};I.Table.prototype.graph=function(e,t,r){let n={};if(t.columns[0].isError)return n;let s=t.columns[0].values;for(let o=1;o<this.columns.length;o++){let a=t.columns[o];if(a.isError)continue;let u=this.columns[o].header.userData,c=this.columns[o].header.metaData;if(u.hidden)continue;let l=ec(c,[\"colorLatexValue\",\"computedPointSize\",\"computedPointOpacity\"]),p=u.dragMode,f=p===\"X\"||p===\"XY\",y=p===\"Y\"||p===\"XY\",h=!!u.points,m=!!u.lines,b=[],d=[],g=[],x=[],M=[],E=[],T=1/0,D=-1/0,S=1/0,O=-1/0,A={};for(let L=0;L<s.length;L++){let H=s[L],w=a.values[L];if(!H||!w||!isFinite(H.asValue())||!isFinite(w.asValue())){A[L]=!0,m&&(E.length>1&&M.push(E),E=[]);continue}let q=H.asValue(),$=w.asValue();if(h){if(L>=l)continue;let F=f&&this.isValueDraggable(t,0,L),Z=y&&this.isValueDraggable(t,o,L);F||Z?(g.push([q,$]),x.push({index:L,dragX:F,dragY:Z})):d.push([q,$])}m&&E.push([q,$]),q<T&&(T=q),q>D&&(D=q),$<S&&(S=$),$>O&&(O=$)}let _={type:\"table\",xmin:T,xmax:D,ymin:S,ymax:O};g.length&&b.push({graphMode:4,segments:[g],color:c.colorLatexValue||u.color,tableId:u.tableId,poi:xs(g),movablePointInfo:x,boundingBox:_,pointOpacity:c.computedPointOpacity}),d.length&&b.push({segments:[d],droppedIndices:A,graphMode:3,showPoint:!0,poi:xs(d),color:c.colorLatexValue||u.color,pointSize:c.computedPointSize,pointOpacity:c.computedPointOpacity,style:u.pointStyle,tableId:u.tableId,boundingBox:_}),(M.length||E.length)&&(M.push(E),b.push({segments:M.map(U3),graphMode:5,poi:Kr(),color:zo(u,c),style:u.lineStyle,lineWidth:Array.isArray(c.computedLineWidth)?c.computedLineWidth[0]:c.computedLineWidth,lineOpacity:Array.isArray(c.computedLineOpacity)?c.computedLineOpacity[0]:c.computedLineOpacity,tableId:u.tableId,boundingBox:_})),b.length&&(n[u.id]=b)}return n};function k3(e,t,r){return e?t===0&&r===0?e[2].type!==\"none\"||e[3].type!==\"none\":t!==0&&r!==0?e[0].type!==\"none\"&&e[1].type!==\"none\":t!==0?e[0].type!==\"none\":r!==0?e[1].type!==\"none\":!1:!1}I.Image.prototype.graph=function(e,t,r){let n=[];if(t.center.valueType!==N||t.center.getDependencies().length!==0||!t.radianAngle.isConstant||!t.width.isConstant||!t.height.isConstant||!t.opacity.isConstant)return n;let i=[],s=[],o=t.width.asValue()/2,a=t.height.asValue()/2,u=t.radianAngle.asValue();for(var c=-1;c<=1;c++)for(var l=-1;l<=1;l++){let[p,f]=t.center.asValue(),y=[p+c*o*Math.cos(u)+l*a*Math.sin(u),f-c*o*Math.sin(u)+l*a*Math.cos(u)];k3(t.moveStrategy,c,l)&&(i.push(y),s.push([c,l]))}return n.push({segments:[i],scaleFactors:[s],graphMode:4,color:zo(this.userData,this.metaData),style:this.userData.style,poi:xs(i),movablePointInfo:[],pointOpacity:1}),n};function WS(e){let t=[],r=[];for(let[n,i]of e)!isNaN(n)&&!isNaN(i)?t.push(n,i):(t.length>=4&&r.push(t),t=[]);return t.length>=4&&r.push(t),r}function q3(e){return e.isError?e.getError():e.asValue()===void 0?\"\":+e.asValue()}function Y3(e,t,r){let n=[];for(var i=0;i<t.columns.length;i++){let s=r.columns[i],o=s.isError?[]:s.values.map(q3),a={dependent:!s.isIndependent,discrete:!!s.isIndependent,values:o};s.isError&&(a.error=s.getError()),n.push(a)}return{column_data:n}}function X3(e,t,r){let n={variables:[],errorMap:{},dimensions:{}};if(e.areAllScalesLinear()||(n.errorMap.scale=!0),r.center.isError&&(n.errorMap.center=!0),r.radianAngle.isError&&(n.errorMap.angle=!0),r.width.isError&&(n.errorMap.width=!0),r.height.isError&&(n.errorMap.height=!0),r.opacity.isError&&(n.errorMap.opacity=!0),Object.keys(n.errorMap).length>0)return n.variables=t.getSliderVariables(e,r),n;n.dimensions.x=[],n.dimensions.y=[],n.dimensions.radianAngle=[],n.dimensions.width=[],n.dimensions.height=[],n.dimensions.opacity=[];let i=[r.center,r.radianAngle,r.width,r.height,r.opacity];return i.some(o=>o&&o.valueType&&j(o.valueType))&&(n.is_concrete_list=!0),I.List.eachArgs(i,function(o){let a=o[0].asValue(),u=+o[1].asValue(),c=Math.atan2(Math.sin(u),Math.cos(u));n.dimensions.x.push(+a[0]),n.dimensions.y.push(+a[1]),n.dimensions.radianAngle.push(c),n.dimensions.width.push(+o[2].asValue()),n.dimensions.height.push(+o[3].asValue()),n.dimensions.opacity.push(Math.max(0,Math.min(1,+o[4].asValue())))}),(e.graphingEnabled()?t.getGraphMode(e,r):10)!==10&&(n.is_graphable=!0),r.moveStrategy&&(n.move_strategy=r.moveStrategy),t.center&&(t.center.type===\"Identifier\"?(n.center_reference_id=t.center.referencedStatementId,n.center_reference_symbol=t.center._symbol):t.center.type===\"ParenSeq\"&&r.center.valueType===N&&(n.center_is_point_literal=!0)),n}function $3(e,t,r){let n=r.handler,i=r.minStep,s={},o={};for(let p of n.getDependencies())e.validActionVariable(p)||(s[p]=!0);for(let p of i.getDependencies())o[p]=!0;let a;if(Ys(i))a={status:\"error\",error:i.getError()};else{let p=i.asValue();typeof p==\"number\"&&!isNaN(p)&&p>=0?a={status:\"valid\",value:p}:a={status:\"error\",error:rb().getError()}}let u=Object.keys(s);u.length>0&&(n=jt(u).setDependencies(n.getDependencies()));let c;n.isError&&!gI(e,n)?c={status:\"error\",error:n.getError()}:n.isEmptyAction?c={status:\"empty\"}:c={status:\"maybe-valid\"};let l={handler:c,minStep:a,variables:[]};return Ka(l,e,W(W({},s),o)),l}function Z3(){return{operator:\"=\",variables:[]}}function rR(e,t,r,n){var c;if(hs(r))return Y3(e,r,n);if(iy(r))return X3(e,r,n);let i=Z3();if(r instanceof I.Ticker)return e.graphingEnabled()?$3(e,r,n):(i.error=ne(\"Ticker without graphing\").getError(),i);if(e.is3dProduct()){let l=e,p=r.getGraphMode(l,n);if((p===100||p===101||p===102||p===5)&&n.getDependencies().length===1){let f=n.getDependencies()[0];(f===\"t\"||f===\"u\"||f===\"v\")&&(i.dependency=f)}}if((c=r.parseOptions)!=null&&c.selection){let l=n.getCursorContext();if(l)i.cursor_context=ee(W({},l),{selection:r.parseOptions.selection});else if(Ys(n)){let p=j3(e,t,r);p&&(i.cursor_context=ee(W({},p),{selection:r.parseOptions.selection}))}}if(n.isError&&!(r instanceof I.FunctionDefinition&&!n.blocksExport)){i.error=n.getError(),i.variables=r.getSliderVariables(e,n),i.is_single_identifier=r instanceof I.Identifier,n.actionValue&&(i.action_value=DT(n.actionValue));let l=mI(e,t,r,n);return Object.keys(l).length>0&&(i.geometry=mI(e,t,r,n)),i}if(n.valueType===It&&n.getDependencies().length===0){let l=n.asValue();i.rgb_value=Su(l[0],l[1],l[2]).formatHex()}n.valueType===Je&&n.getDependencies().length===0&&(i.action_value=DT(n.asValue())),n.moveStrategy&&(i.move_strategy=n.moveStrategy,i.default_drag_mode=n.defaultDragMode),r.isInequality()&&(i.is_inequality=!0),i.operator=r.getOperator(),n instanceof I.SolvedEquation?n._expression.asValue()!==!0&&n._expression.asValue()!==!1&&(i.assignment=n._symbol):r instanceof I.Assignment&&(i.assignment=r._symbol);let s=e.graphingEnabled()?r.getGraphMode(e,n):10;if(e.graphingEnabled()&&e.is3dPolicy()&&!Co(s)&&!jS(s)&&(s=10),s!==10){i.is_graphable=!0,i.expression_type=r.getExpressionType(s,n.valueType),e.is3dPolicy()&&(i.expression_type===\"SINGLE_POINT\"?i.expression_type=\"POINT3D\":i.expression_type===\"POINT_LIST\"&&(i.expression_type=\"POINT3D_LIST\")),n.isShadeBetween()&&(i.is_shade_between=!0);let l=r.tableInfo(e,n);l&&(i.is_tableable=!0,i.table_info=l)}if(n.valueType!==void 0&&j(n.valueType)&&(i.is_concrete_list=!0,n.valueType===Vr&&n.getDependencies().length===0)){let l=n.asValue();l&&(i.rgb_value=l.map(p=>Su(p[0],p[1],p[2]).formatHex()))}if(i.variables=i.is_graphable?[]:r.getSliderVariables(e,n),i.is_single_identifier=r instanceof I.Identifier,n.isTypedConstant){let l=n.asTypedValue();i.typed_constant_value=l,(l.valueType===P||l.valueType===he)&&(i.constant_value=l.value),W3(l.valueType)&&(i.geometry=mI(e,t,r,n))}let o=n.getEvaluationInfo();if(o&&i.operator===\"=\"&&!r.isConstant&&!r.isFunction&&n.valueType!==he&&n.valueType!==zr&&!(r instanceof I.Equation)&&!(r instanceof I.And)&&(i.is_evaluable=!0,i.zero_values=o),n instanceof I.OptimizedRegression){let l=n,p={};for(var a in l.parameters)l.parameters.hasOwnProperty(a)&&(p[Zr(a)]=+l.parameters[a].asValue());i.is_regression=!0,i.regression={parameters:p,residualVariable:Zr(l.residualVariable),residualSuggestionId:l.residualSuggestionId,shouldSuggestLogMode:l.shouldSuggestLogMode,isLinear:l.isLinear,statistics:l.statistics,parameterWarning:l.parameterWarning}}let u=ca(r);return u&&u.discrete&&(i.is_discrete_distribution=!0),i}function W3(e){switch(e){case N:case nt:case ye:case Nr:case Oe:case ur:case _e:case Ar:case ge:case Cr:case de:case Sr:case ue:case Rr:case we:case br:case Ae:case Jt:case xe:case Qt:case He:case tn:return!0;default:return!1}}function mI(e,t,r,n){let i={};n.valueType!==void 0&&(i.valueType=n.valueType),i.valueType&&ie(i.valueType,N)&&e.graphingEnabled()&&r.getGraphMode(e,n)===4&&(i.isMovablePoint=!0);let{identifier:s,listAccess:o,assignmentRhsReference:a,tree:u}=Om(r);if(s&&(i.identifier=s),o&&(i.listAccess=o),a&&(i.assignmentRhsReference=a),u&&(i.call=u,n.valueType&&ie(n.valueType,He)&&r instanceof Jo)){let l=r._expression;i.transformation_preview_info={type:u.symbol,args:l.args.slice(1).map(p=>p.tryGetConcreteTree(e,t).asTypedValue())}}let c=n.moveStrategy&&n.moveStrategy[0];return c&&\"initialValue\"in c&&c.initialValue!==void 0&&(i.gliderParameter=c.initialValue),i}function j3(e,t,r){let n=r.parseOptions;if(!(n!=null&&n.selection))return;let{start:i,end:s,input:o}=n.selection;if(o.trim()===\"\")return{type:\"empty\",allowedTypes:[Tt]};let a=\"\\\\cursor\",u=o.slice(0,i)+a+\" \"+o.slice(s),c={input:u,start:i,end:i+a.length},l=ys(u,ee(W({},r.parseOptions),{selection:c}));return l.isError?void 0:Xc({policy:e,frame:t,selection:c},l).getCursorContext()}function Ka(e,t,r){let n=e.variables;if(n&&n.length){let i={};for(let s of n)i[s]=!0;for(let s in r)i[s]=!0;r=i}e.variables=t.sliderVariables(Object.keys(r))}function gI(e,t){if(t.blocksExport)return!1;let r=t.getDependencies();if(r.length===0)return!1;for(let n of r)if(!e.validActionVariable(n))return!1;return!0}var X=class{constructor(t,r,n,i){this.policy=t,this.rawTree=n,this.concreteTree=i,this.evaluationState=rR(t,r,n,i)}exportTo(t,r){this.rawTree.exportTo(t,this.concreteTree,r)}graph(t,r){return this.rawTree.tryGraph(this.policy,this.concreteTree,t,r)}getGraphMode(){return this.policy.graphingEnabled()?this.rawTree.getGraphMode(this.policy,this.concreteTree):10}getGraphInfo(){return this.rawTree.getGraphInfo(this.policy,this.concreteTree)}shouldIntersect(){if(!this.evaluationState.is_graphable||!this.rawTree.userData.shouldGraph||!Si.pointsOfInterest)return!1;var t=this.getGraphMode();return t===1||t===2}};var V=function(){};V.version=\"1.2.6\";V._myIndexOf=function(t){var r=this.length,n;for(n=0;n<r;++n)if(this[n]===t)return n;return-1};V.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:V._myIndexOf;V.precision=4;V.largeArray=50;V.compile=function(){var e=Array.prototype.slice.call(arguments),t=e.pop();return t=\"return function (\"+e.join(\",\")+\") {\"+t+\"}\",new Function([\"numeric\"],t)(V)};V._dim=function(t){for(var r=[];typeof t==\"object\";)r.push(t.length),t=t[0];return r};V.dim=function(t){var r,n;return typeof t==\"object\"?(r=t[0],typeof r==\"object\"?(n=r[0],typeof n==\"object\"?V._dim(t):[t.length,r.length]):[t.length]):[]};V.mapreduce=function(t,r){return V.compile(\"x\",\"accum\",\"_s\",\"_k\",'if(typeof accum === \"undefined\") accum = '+r+`;\nif(typeof x === \"number\") { var xi = x; `+t+`; return accum; }\nif(typeof _s === \"undefined\") _s = numeric.dim(x);\nif(typeof _k === \"undefined\") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    `+t+`;\n    xi = x[i-1];\n    `+t+`;\n}\nif(i === 0) {\n    xi = x[i];\n    `+t+`\n}\nreturn accum;`)};V.mapreduce2=function(t,r){return V.compile(\"x\",`var n = x.length;\nvar i,xi;\n`+r+`\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    `+t+`\n}\nreturn accum;`)};V.rep=function(t,r,n){typeof n==\"undefined\"&&(n=0);var i=t[n],s=Array(i),o;if(n===t.length-1){for(o=i-2;o>=0;o-=2)s[o+1]=r,s[o]=r;return o===-1&&(s[0]=r),s}for(o=i-1;o>=0;o--)s[o]=V.rep(t,r,n+1);return s};V.dotMMsmall=function(t,r){var n,i,s,o,a,u,c,l,p,f,y,h,m,b;for(o=t.length,a=r.length,u=r[0].length,c=Array(o),n=o-1;n>=0;n--){for(l=Array(u),p=t[n],s=u-1;s>=0;s--){for(f=p[a-1]*r[a-1][s],i=a-2;i>=1;i-=2)y=i-1,f+=p[i]*r[i][s]+p[y]*r[y][s];i===0&&(f+=p[0]*r[0][s]),l[s]=f}c[n]=l}return c};V._getCol=function(t,r,n){var i=t.length,s;for(s=i-1;s>0;--s)n[s]=t[s][r],--s,n[s]=t[s][r];s===0&&(n[0]=t[0][r])};V.dotMMbig=function(t,r){var n=V._getCol,i=r.length,s=Array(i),o=t.length,a=r[0].length,u=new Array(o),c,l=V.dotVV,p,f,y,h;for(--i,--o,p=o;p!==-1;--p)u[p]=Array(a);for(--a,p=a;p!==-1;--p)for(n(r,p,s),f=o;f!==-1;--f)h=0,c=t[f],u[f][p]=l(c,s);return u};V.dotMV=function(t,r){var n=t.length,i=r.length,s,o=Array(n),a=V.dotVV;for(s=n-1;s>=0;s--)o[s]=a(t[s],r);return o};V.dotVM=function(t,r){var n,i,s,o,a,u,c,l,p,f,y,h,m,b,d,g,x,M,E;for(o=t.length,a=r[0].length,c=Array(a),s=a-1;s>=0;s--){for(f=t[o-1]*r[o-1][s],i=o-2;i>=1;i-=2)y=i-1,f+=t[i]*r[i][s]+t[y]*r[y][s];i===0&&(f+=t[0]*r[0][s]),c[s]=f}return c};V.dotVV=function(t,r){var n,i=t.length,s,o=t[i-1]*r[i-1];for(n=i-2;n>=1;n-=2)s=n-1,o+=t[n]*r[n]+t[s]*r[s];return n===0&&(o+=t[0]*r[0]),o};V.dot=function(t,r){var n=V.dim;switch(n(t).length*1e3+n(r).length){case 2002:return r.length<10?V.dotMMsmall(t,r):V.dotMMbig(t,r);case 2001:return V.dotMV(t,r);case 1002:return V.dotVM(t,r);case 1001:return V.dotVV(t,r);case 1e3:return V.mulVS(t,r);case 1:return V.mulSV(t,r);case 0:return t*r;default:throw new Error(\"numeric.dot only works on vectors and matrices\")}};V.diag=function(t){var r,n,i,s=t.length,o=Array(s),a;for(r=s-1;r>=0;r--){for(a=Array(s),n=r+2,i=s-1;i>=n;i-=2)a[i]=0,a[i-1]=0;for(i>r&&(a[i]=0),a[r]=t[r],i=r-1;i>=1;i-=2)a[i]=0,a[i-1]=0;i===0&&(a[0]=0),o[r]=a}return o};V.getDiag=function(e){var t=Math.min(e.length,e[0].length),r,n=Array(t);for(r=t-1;r>=1;--r)n[r]=e[r][r],--r,n[r]=e[r][r];return r===0&&(n[0]=e[0][0]),n};V.identity=function(t){return V.diag(V.rep([t],1))};V.pointwise=function(t,r,n){typeof n==\"undefined\"&&(n=\"\");var i=[],s,o=/\\[i\\]$/,a,u=\"\",c=!1;for(s=0;s<t.length;s++)o.test(t[s])?(a=t[s].substring(0,t[s].length-3),u=a):a=t[s],a===\"ret\"&&(c=!0),i.push(a);return i[t.length]=\"_s\",i[t.length+1]=\"_k\",i[t.length+2]='if(typeof _s === \"undefined\") _s = numeric.dim('+u+`);\nif(typeof _k === \"undefined\") _k = 0;\nvar _n = _s[_k];\nvar i`+(c?\"\":\", ret = Array(_n)\")+`;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee(`+t.join(\",\")+`,_s,_k+1);\n    return ret;\n}\n`+n+`\nfor(i=_n-1;i!==-1;--i) {\n    `+r+`\n}\nreturn ret;`,V.compile.apply(null,i)};V.pointwise2=function(t,r,n){typeof n==\"undefined\"&&(n=\"\");var i=[],s,o=/\\[i\\]$/,a,u=\"\",c=!1;for(s=0;s<t.length;s++)o.test(t[s])?(a=t[s].substring(0,t[s].length-3),u=a):a=t[s],a===\"ret\"&&(c=!0),i.push(a);return i[t.length]=\"var _n = \"+u+`.length;\nvar i`+(c?\"\":\", ret = Array(_n)\")+`;\n`+n+`\nfor(i=_n-1;i!==-1;--i) {\n`+r+`\n}\nreturn ret;`,V.compile.apply(null,i)};V._biforeach=function e(t,r,n,i,s){if(i===n.length-1){s(t,r);return}var o,a=n[i];for(o=a-1;o>=0;o--)e(typeof t==\"object\"?t[o]:t,typeof r==\"object\"?r[o]:r,n,i+1,s)};V._biforeach2=function e(t,r,n,i,s){if(i===n.length-1)return s(t,r);var o,a=n[i],u=Array(a);for(o=a-1;o>=0;--o)u[o]=e(typeof t==\"object\"?t[o]:t,typeof r==\"object\"?r[o]:r,n,i+1,s);return u};V._foreach=function e(t,r,n,i){if(n===r.length-1){i(t);return}var s,o=r[n];for(s=o-1;s>=0;s--)e(t[s],r,n+1,i)};V._foreach2=function e(t,r,n,i){if(n===r.length-1)return i(t);var s,o=r[n],a=Array(o);for(s=o-1;s>=0;s--)a[s]=e(t[s],r,n+1,i);return a};V.ops2={add:\"+\",sub:\"-\",mul:\"*\",div:\"/\",mod:\"%\",and:\"&&\",or:\"||\",eq:\"===\",neq:\"!==\",lt:\"<\",gt:\">\",leq:\"<=\",geq:\">=\",band:\"&\",bor:\"|\",bxor:\"^\",lshift:\"<<\",rshift:\">>\",rrshift:\">>>\"};V.opseq={addeq:\"+=\",subeq:\"-=\",muleq:\"*=\",diveq:\"/=\",modeq:\"%=\",lshifteq:\"<<=\",rshifteq:\">>=\",rrshifteq:\">>>=\",bandeq:\"&=\",boreq:\"|=\",bxoreq:\"^=\"};V.mathfuns=[\"abs\",\"acos\",\"asin\",\"atan\",\"ceil\",\"cos\",\"exp\",\"floor\",\"log\",\"round\",\"sin\",\"sqrt\",\"tan\",\"isNaN\",\"isFinite\"];V.mathfuns2=[\"atan2\",\"pow\",\"max\",\"min\"];V.ops1={neg:\"-\",not:\"!\",bnot:\"~\",clone:\"\"};V.mapreducers={any:[\"if(xi) return true;\",\"var accum = false;\"],all:[\"if(!xi) return false;\",\"var accum = true;\"],sum:[\"accum += xi;\",\"var accum = 0;\"],prod:[\"accum *= xi;\",\"var accum = 1;\"],norm2Squared:[\"accum += xi*xi;\",\"var accum = 0;\"],norminf:[\"accum = max(accum,abs(xi));\",\"var accum = 0, max = Math.max, abs = Math.abs;\"],norm1:[\"accum += abs(xi);\",\"var accum = 0, abs = Math.abs;\"],sup:[\"accum = max(accum,xi);\",\"var accum = -Infinity, max = Math.max;\"],inf:[\"accum = min(accum,xi);\",\"var accum = Infinity, min = Math.min;\"]};(function(){var e,t;for(e=0;e<V.mathfuns2.length;++e)t=V.mathfuns2[e],V.ops2[t]=t;for(e in V.ops2)if(V.ops2.hasOwnProperty(e)){t=V.ops2[e];var r,n,i=\"\";V.myIndexOf.call(V.mathfuns2,e)!==-1?(i=\"var \"+t+\" = Math.\"+t+`;\n`,r=function(s,o,a){return s+\" = \"+t+\"(\"+o+\",\"+a+\")\"},n=function(s,o){return s+\" = \"+t+\"(\"+s+\",\"+o+\")\"}):(r=function(s,o,a){return s+\" = \"+o+\" \"+t+\" \"+a},V.opseq.hasOwnProperty(e+\"eq\")?n=function(s,o){return s+\" \"+t+\"= \"+o}:n=function(s,o){return s+\" = \"+s+\" \"+t+\" \"+o}),V[e+\"VV\"]=V.pointwise2([\"x[i]\",\"y[i]\"],r(\"ret[i]\",\"x[i]\",\"y[i]\"),i),V[e+\"SV\"]=V.pointwise2([\"x\",\"y[i]\"],r(\"ret[i]\",\"x\",\"y[i]\"),i),V[e+\"VS\"]=V.pointwise2([\"x[i]\",\"y\"],r(\"ret[i]\",\"x[i]\",\"y\"),i),V[e]=V.compile(`var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric.`+e+\"VV, VS = numeric.\"+e+\"VS, SV = numeric.\"+e+`SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === \"object\") {\n      if(typeof y === \"object\") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === \"object\") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else `+n(\"x\",\"y\")+`\n}\nreturn x;\n`),V[t]=V[e],V[e+\"eqV\"]=V.pointwise2([\"ret[i]\",\"x[i]\"],n(\"ret[i]\",\"x[i]\"),i),V[e+\"eqS\"]=V.pointwise2([\"ret[i]\",\"x\"],n(\"ret[i]\",\"x\"),i),V[e+\"eq\"]=V.compile(`var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric.`+e+\"eqV, S = numeric.\"+e+`eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === \"object\") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n`)}for(e=0;e<V.mathfuns2.length;++e)t=V.mathfuns2[e],delete V.ops2[t];for(e=0;e<V.mathfuns.length;++e)t=V.mathfuns[e],V.ops1[t]=t;for(e in V.ops1)V.ops1.hasOwnProperty(e)&&(i=\"\",t=V.ops1[e],V.myIndexOf.call(V.mathfuns,e)!==-1&&Math.hasOwnProperty(t)&&(i=\"var \"+t+\" = Math.\"+t+`;\n`),V[e+\"eqV\"]=V.pointwise2([\"ret[i]\"],\"ret[i] = \"+t+\"(ret[i]);\",i),V[e+\"eq\"]=V.compile(\"x\",'if(typeof x !== \"object\") return '+t+`x\nvar i;\nvar V = numeric.`+e+`eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n`),V[e+\"V\"]=V.pointwise2([\"x[i]\"],\"ret[i] = \"+t+\"(x[i]);\",i),V[e]=V.compile(\"x\",'if(typeof x !== \"object\") return '+t+`(x)\nvar i;\nvar V = numeric.`+e+`V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n`));for(e=0;e<V.mathfuns.length;++e)t=V.mathfuns[e],delete V.ops1[t];for(e in V.mapreducers)V.mapreducers.hasOwnProperty(e)&&(t=V.mapreducers[e],V[e+\"V\"]=V.mapreduce2(t[0],t[1]),V[e]=V.compile(\"x\",\"s\",\"k\",t[1]+`if(typeof x !== \"object\") {    xi = x;\n`+t[0]+`\n    return accum;\n}if(typeof s === \"undefined\") s = numeric.dim(x);\nif(typeof k === \"undefined\") k = 0;\nif(k === s.length-1) return numeric.`+e+`V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n`+t[0]+`\n}\nreturn accum;\n`))})();V.inv=function(m){var r=V.dim(m),n=Math.abs,i=r[0],s=r[1],o=V.clone(m),a,u,c=V.identity(i),l,p,f,y,h,m;for(y=0;y<s;++y){var b=-1,d=-1;for(f=y;f!==i;++f)h=n(o[f][y]),h>d&&(b=f,d=h);for(u=o[b],o[b]=o[y],o[y]=u,p=c[b],c[b]=c[y],c[y]=p,m=u[y],h=y;h!==s;++h)u[h]/=m;for(h=s-1;h!==-1;--h)p[h]/=m;for(f=i-1;f!==-1;--f)if(f!==y){for(a=o[f],l=c[f],m=a[y],h=y+1;h!==s;++h)a[h]-=u[h]*m;for(h=s-1;h>0;--h)l[h]-=p[h]*m,--h,l[h]-=p[h]*m;h===0&&(l[0]-=p[0]*m)}}return c};V.det=function(t){var r=V.dim(t);if(r.length!==2||r[0]!==r[1])throw new Error(\"numeric: det() only works on square matrices\");var n=r[0],i=1,s,o,a,u=V.clone(t),c,l,p,f,y,h,m;for(o=0;o<n-1;o++){for(a=o,s=o+1;s<n;s++)Math.abs(u[s][o])>Math.abs(u[a][o])&&(a=s);for(a!==o&&(f=u[a],u[a]=u[o],u[o]=f,i*=-1),c=u[o],s=o+1;s<n;s++){for(l=u[s],p=l[o]/c[o],a=o+1;a<n-1;a+=2)y=a+1,l[a]-=c[a]*p,l[y]-=c[y]*p;a!==n&&(l[a]-=c[a]*p)}if(c[o]===0)return 0;i*=c[o]}return i*u[o][o]};V.transpose=function(t){var r,n,i=t.length,s=t[0].length,o=Array(s),a,u,c;for(n=0;n<s;n++)o[n]=Array(i);for(r=i-1;r>=1;r-=2){for(u=t[r],a=t[r-1],n=s-1;n>=1;--n)c=o[n],c[r]=u[n],c[r-1]=a[n],--n,c=o[n],c[r]=u[n],c[r-1]=a[n];n===0&&(c=o[0],c[r]=u[0],c[r-1]=a[0])}if(r===0){for(a=t[0],n=s-1;n>=1;--n)o[n][0]=a[n],--n,o[n][0]=a[n];n===0&&(o[0][0]=a[0])}return o};V.negtranspose=function(t){var r,n,i=t.length,s=t[0].length,o=Array(s),a,u,c;for(n=0;n<s;n++)o[n]=Array(i);for(r=i-1;r>=1;r-=2){for(u=t[r],a=t[r-1],n=s-1;n>=1;--n)c=o[n],c[r]=-u[n],c[r-1]=-a[n],--n,c=o[n],c[r]=-u[n],c[r-1]=-a[n];n===0&&(c=o[0],c[r]=-u[0],c[r-1]=-a[0])}if(r===0){for(a=t[0],n=s-1;n>=1;--n)o[n][0]=-a[n],--n,o[n][0]=-a[n];n===0&&(o[0][0]=-a[0])}return o};V.norm2=function(t){return Math.sqrt(V.norm2Squared(t))};V.linspace=function(t,r,n){if(typeof n==\"undefined\"&&(n=Math.max(Math.round(r-t)+1,1)),n<2)return n===1?[t]:[];var i,s=Array(n);for(n--,i=n;i>=0;i--)s[i]=(i*r+(n-i)*t)/n;return s};V.getBlock=function(t,r,n){var i=V.dim(t);function s(o,a){var u,c=r[a],l=n[a]-c,p=Array(l);if(a===i.length-1){for(u=l;u>=0;u--)p[u]=o[u+c];return p}for(u=l;u>=0;u--)p[u]=s(o[u+c],a+1);return p}return s(t,0)};V.setBlock=function(t,r,n,i){var s=V.dim(t);function o(a,u,c){var l,p=r[c],f=n[c]-p;if(c===s.length-1)for(l=f;l>=0;l--)a[l+p]=u[l];for(l=f;l>=0;l--)o(a[l+p],u[l],c+1)}return o(t,i,0),t};V.getRange=function(t,r,n){var i=r.length,s=n.length,o,a,u=Array(i),c,l;for(o=i-1;o!==-1;--o)for(u[o]=Array(s),c=u[o],l=t[r[o]],a=s-1;a!==-1;--a)c[a]=l[n[a]];return u};V.blockMatrix=function(t){var r=V.dim(t);if(r.length<4)return V.blockMatrix([t]);var n=r[0],i=r[1],s,o,a,u,c;for(s=0,o=0,a=0;a<n;++a)s+=t[a][0].length;for(u=0;u<i;++u)o+=t[0][u][0].length;var l=Array(s);for(a=0;a<s;++a)l[a]=Array(o);var p=0,f,y,h,m,b;for(a=0;a<n;++a){for(f=o,u=i-1;u!==-1;--u)for(c=t[a][u],f-=c[0].length,h=c.length-1;h!==-1;--h)for(b=c[h],y=l[p+h],m=b.length-1;m!==-1;--m)y[f+m]=b[m];p+=t[a][0].length}return l};V.tensor=function(t,r){if(typeof t==\"number\"||typeof r==\"number\")return V.mul(t,r);var n=V.dim(t),i=V.dim(r);if(n.length!==1||i.length!==1)throw new Error(\"numeric: tensor product is only defined for vectors\");var s=n[0],o=i[0],a=Array(s),u,c,l,p;for(c=s-1;c>=0;c--){for(u=Array(o),p=t[c],l=o-1;l>=3;--l)u[l]=p*r[l],--l,u[l]=p*r[l],--l,u[l]=p*r[l],--l,u[l]=p*r[l];for(;l>=0;)u[l]=p*r[l],--l;a[c]=u}return a};V.epsilon=2220446049250313e-31;V.LU=function(e,t){t=t||!1;var r=Math.abs,n,i,s,o,a,u,c,l,p,f=e.length,y=f-1,h=new Array(f);for(t||(e=V.clone(e)),s=0;s<f;++s){for(c=s,u=e[s],p=r(u[s]),i=s+1;i<f;++i)o=r(e[i][s]),p<o&&(p=o,c=i);for(h[s]=c,c!=s&&(e[s]=e[c],e[c]=u,u=e[s]),a=u[s],n=s+1;n<f;++n)e[n][s]/=a;for(n=s+1;n<f;++n){for(l=e[n],i=s+1;i<y;++i)l[i]-=l[s]*u[i],++i,l[i]-=l[s]*u[i];i===y&&(l[i]-=l[s]*u[i])}}return{LU:e,P:h}};V.LUsolve=function(t,r){var n,i,s=t.LU,o=s.length,a=V.clone(r),u=t.P,c,l,p,f;for(n=o-1;n!==-1;--n)a[n]=r[n];for(n=0;n<o;++n)for(c=u[n],u[n]!==n&&(f=a[n],a[n]=a[c],a[c]=f),l=s[n],i=0;i<n;++i)a[n]-=a[i]*l[i];for(n=o-1;n>=0;--n){for(l=s[n],i=n+1;i<o;++i)a[n]-=a[i]*l[i];a[n]/=l[n]}return a};V.solve=function(t,r,n){return V.LUsolve(V.LU(t,n),r)};var gr=V;function J3(e,t){let r=e.length,n=t.length,i=0,s=0;for(let a=n-r;a<n;a++)i+=e[a+r-n]*t[a],s+=e[a+r-n]*e[a+r-n];let o=i/s;for(let a=n-r;a<n;a++)t[a]=2*o*e[a+r-n]-t[a]}function Q3(e,t,r){let n=e.length,i=t.length,s=0,o=0;for(let u=i-n;u<i;u++)s+=e[u+n-i]*t[u][r],o+=e[u+n-i]*e[u+n-i];let a=s/o;for(let u=i-n;u<i;u++)t[u][r]=2*a*e[u+n-i]-t[u][r]}function K3(e,t,r,n){let i=Array(e.length-t);if(i.length===1)return i[0]=1,i;if(n===0){i[0]=1;for(let o=1;o<i.length;o++)i[o]=0;return i}let s=e[t][r]<0?-1:1;i[0]=e[t][r]+s*Math.sqrt(n);for(let o=t+1;o<e.length;o++)i[o-t]=e[o][r];return i}function eB(e,t,r){let n=0;for(;t<e.length;t++)n+=e[t][r]*e[t][r];return n}function zy(e,t){if(!t||!t.mutateInput){let s=e;e=Array(e.length);for(let o=0;o<s.length;o++)e[o]=s[o].slice()}let r=Math.min(e.length,e[0].length),n=Array(r),i=[];for(let s=0;s<r;s++){let o=-1/0,a=s;for(let c=s;c<e[s].length;c++){let l=eB(e,s,c);l>o&&(o=l,a=c)}if(n[s]=a,a!==s)for(let c=0;c<e.length;c++){let l=e[c][a];e[c][a]=e[c][s],e[c][s]=l}let u=K3(e,s,s,o);for(let c=s;c<e[s].length;c++)Q3(u,e,c);i.push(u)}return{reflectors:i,r:e,p:n}}function nR(e,t,r){let{reflectors:n,r:i,p:s}=e,o=t.slice();for(let c=0;c<n.length;c++)J3(n[c],o);for(let c=n.length;c<i[0].length;c++)o[c]=0;o.length=i[0].length;let a=Math.pow(2,-52),u=r.regularize?a*Math.abs(i[0][0])*Math.max(i.length,i[0].length):0;for(let c=n.length-1;c>=0;c--){let l=i[c];if(Math.abs(l[c])<=u)o[c]=0;else{for(let p=c+1;p<n.length;p++)o[c]-=o[p]*l[p];o[c]/=l[c]}}for(let c=s.length-1;c>=0;c--)if(s[c]!==c){let l=o[c];o[c]=o[s[c]],o[s[c]]=l}return o}function tB(e,t,r){let n=Array(e.r[0].length);for(let s=0;s<n.length;s++)n[s]=Array(t[0].length);let i=Array(t.length);for(let s=0;s<t[0].length;s++){for(let a=0;a<t.length;a++)i[a]=t[a][s];let o=nR(e,i,r);for(let a=0;a<o.length;a++)n[a][s]=o[a]}return n}function tc(e,t,r){return Array.isArray(t[0])?tB(e,t,r):nR(e,t,r)}function rB(e){let t=e.r,r=Math.min(t.length,t[0].length),n=t[0][0],i=t[r-1][r-1];return n===0?1/0:Math.abs(n/i)}function iR(e){let t=Math.pow(2,-52);return Math.max(e.r.length,e.r[0].length)*t*rB(e)<1}var nB=Math.pow(2,-52);function Uy(e){for(let t of e)for(let r of t)if(!cr(r))return!1;return!0}function iB(e){let t=[];for(let r of e)t.push(r.slice());return t}function oR(e){let{numRows:t,numCols:r}=Hy(e),n=[];for(let i=0;i<r;i++)n.push([]);for(let i=0;i<t;i++)for(let s=0;s<r;s++)n[s].push(e[i][s]);return n}function Hy(e){let t=e.length,r=t>0?e[0].length:0;return{numRows:t,numCols:r}}function sB(){throw new Error(\"Matrix dimension mismatch\")}function hI(e,t){let r=Hy(e),n=Hy(t);r.numCols!==n.numRows&&sB();let i=[];for(let s=0;s<r.numRows;s++){let o=[];for(let a=0;a<n.numCols;a++){let u=Ce(0,1);for(let c=0;c<e[s].length;c++)u=co(u,lo(e[s][c],t[c][a]));o.push(u)}i.push(o)}return i}function aR(e){let t=iB(e);return aB(t),t}function oB(e){let t=0;for(let r of e)for(let n of r){let i=Math.abs(Y(n));if(!isFinite(i))return NaN;i>t&&(t=i)}return t}function sR(e){for(let t=0;t<e.length;t++)for(let r=0;r<e[t].length;r++)e[t][r]=NaN}function aB(e){let{numRows:t,numCols:r}=Hy(e),n=oB(e);if(!isFinite(n))return sR(e),{determinant:NaN,rank:0};let i=Math.max(t,r)*n*nB,s=Ce(1,1),o=0,a=0;for(;o<t&&a<r;){let u=o,c=Math.abs(Y(e[o][a]));for(let p=o+1;p<t;p++){let f=Math.abs(Y(e[p][a]));(!isFinite(f)||f>c)&&(c=f,u=p)}if(!isFinite(c))return sR(e),{determinant:NaN,rank:0};if(c===0){s=Ce(0,1),a+=1;continue}if(!cr(e[u][a])&&c<i){for(let p=o;p<t;p++)e[o][p]=0;s=0,a+=1;continue}if(u!==o){s=Vi(s);let p=e[o];e[o]=e[u],e[u]=p}for(let p=0;p<t;p++){if(p===o)continue;let f=As(e[p][a],e[o][a]);e[p][a]=Ce(0,1);for(let y=a+1;y<r;y++)e[p][y]=Ns(e[p][y],lo(f,e[o][y]))}let l=e[o][a];s=lo(s,l),e[o][a]=Ce(1,1);for(let p=a+1;p<r;p++)e[o][p]=As(e[o][p],l);o+=1,a+=1}return{rank:o,determinant:o===t&&o===r?s:Ce(0,1)}}function qy(e,t){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function tu(e,t){let r=eu(e,t),n=0;for(let i of r){let s=i;n+=s*s}return n/r.length}function eu(e,t){return e.apply(void 0,t)}function ky(e,t){let r=[];for(let n of e){let i=n.apply(void 0,t);r.push(i)}return r}function uR(e,t){let r=[];for(let n=0;n<e.length;n++)t[n]&&r.push(e[n]);return r}function bI(e,t,r){let n=[];for(let i=0,s=0;i<e.length;i++){let o=0;r[i]&&(o=t[s],s+=1),n.push(e[i]+o)}return n}function TI(e,t){let r=t.solution.map(u=>Math.abs(u)<1e-6?0:u),n=t.solution.map(()=>0),i=tu(e,r),s=eu(e,r),o=eu(e,n),a=0;for(let u=0;u<s.length;u++){let c=o[u]*1e-15;a+=Math.abs(s[u]*c)+c*c}return a/=s.length,isFinite(a)||(a=0),isFinite(t.MSE)&&!isFinite(i)?t:i<=t.MSE+a?{solution:r,MSE:i}:t}function II(e,t){if(!Uy(t)||!Uy([e]))return;let r=oR(t),n=hI([e],r)[0],i=hI(t,r);for(let c=0;c<n.length;c++)i[c].push(Vi(n[c]));let s=aR(i);if(!Uy(s))return;let o=[],a=n.length,u=0;for(let c of s)for(;u<a;)if(Y(c[u])===1){o.push(c[c.length-1]),u++;break}else o.push(Ce(0,1)),u++;for(;u<a;)o.push(Ce(0,1)),u++;return o}function EI(e,t){let r=qy(0,t.length),n=ky(t,r),i=zy(gr.transpose(n),{mutateInput:!0});for(var s=0;s<2;s++){let c=eu(e,r),l=gr.neg(tc(i,c,{regularize:!1}));r=gr.add(r,l)}let o=tu(e,r);if(iR(i))return{solution:r,MSE:o};let a=qy(0,t.length);for(var s=0;s<2;s++){let l=eu(e,a),p=gr.neg(tc(i,l,{regularize:!0}));a=gr.add(a,p)}let u=tu(e,a);return .999*u<=o?{solution:a,MSE:u}:{solution:r,MSE:o}}function xI(e,t,r,n){let i=n.maxIterations,s=n.linearSubset||qy(!1,r.length),o=gr.not(s),a=uR(t,s),u=uR(t,o),c=2,l=.1,p=r,f=0,y=.001,h;if(gr.any(s)){let d=gr.transpose(ky(a,p)),g=zy(d);h={Jv:d,F:g};let x=eu(e,p),M=gr.neg(tc(g,x,{regularize:!0}));p=bI(p,M,s)}let m=!1,b=tu(e,p);for(;f<i&&!m&&isFinite(b);){let d=eu(e,p),g=ky(u,p),x=gr.transpose(g),M,E;if(h){let{F:S,Jv:O}=h;M=gr.dot(g,gr.sub(d,gr.dot(O,tc(S,d,{regularize:!0})))),E=gr.dot(g,gr.sub(x,gr.dot(O,tc(S,x,{regularize:!0}))))}else M=gr.dot(g,d),E=gr.dot(g,x);let T=p,D=!1;for(;f<i&&!m&&!D;){f+=1;let S=gr.add(E,gr.diag(qy(y,u.length))),O=gr.neg(gr.solve(S,M,!0));T=bI(p,O,o),m=gr.all(gr.eq(T,p));let A;if(h){let L=gr.transpose(ky(a,T)),H=zy(L);A={Jv:L,F:H};let w=eu(e,T),q=gr.neg(tc(H,w,{regularize:!0}));T=bI(T,q,s)}let _=tu(e,T);D=_<b,D?(p=T,b=_,h=A,y*=l):(y=Math.max(y,1e-64),y*=c)}}return{solution:p,MSE:b}}var PI=[18.9,.105,.0113,.089,4.414,.373,.06,.149,1.84,9.26,5,.7,.2,1.13,2.61,1,.007,30,120,1500,4e-4,7.23,-1,-.0081,-.03,-28.6,-1.71,-.4,-6.94,-.777,-500],cB=function(e){let t=e*503%PI.length;return PI[t]},lB=function(e){let t=[];for(let r=0;r<PI.length;r++){let n=[];for(let i=0;i<e;i++)r===0&&e!==1?n[i]=0:r===1&&e!==1?n[i]=1:n[i]=cB(r*e+i);t.push(n)}return t},cR=function(e,t,r,n,i){let s=[];for(let a of r)s.push({soln:xI(e,t,a,i),initialGuess:a});s.sort(function(a,u){return isNaN(a.soln.MSE)?1:isNaN(u.soln.MSE)?-1:a.soln.MSE-u.soln.MSE});let o=[];for(let a=0;a<n;a++)o.push(s[a].initialGuess);return o};function pB(e,t,r,n){if(!t||t.type!==\"known\")return e;let i=t.bounds;return i[0]===-1/0&&i[1]===1/0?e:i[0]===-1/0?i[1]-Math.exp(-e):i[1]===1/0?i[0]+Math.exp(e):r/(n-1)*i[1]+(n-1-r)/(n-1)*i[0]}var lR=[3,5,7,11,13,17,19];function fB(e,t){let r=[];for(let i=0;i<e.length;i++){let s=e[i],o=[];for(let a=0;a<s.length;a++){var n=lR[a%lR.length]*i%e.length;o.push(pB(s[a],t[a],n,e.length))}r.push(o)}return r}function pR(e,t,r){r||(r={});let{linearSubset:n,bounds:i,preferredInitialGuess:s}=r,o=lB(t.length);i&&(o=fB(o,i));let a=cR(e,t,o,5,{maxIterations:3,linearSubset:n}),u=cR(e,t,a,1,{maxIterations:60,linearSubset:n}),c=xI(e,t,u[0],{maxIterations:250,linearSubset:n});if(!s)return c;let l=xI(e,t,s,{maxIterations:100,linearSubset:n});return isFinite(l.MSE)&&(l.MSE<c.MSE||Ln(l.MSE,c.MSE,8))?l:c}function MI(e){return{chunk:e,isLazy:!0}}function fR(e){return e.slice()}function Xy(e){if(!e.isLazy)return e;let t=e.chunk.copy();return t.reopenFinalBlock(),{chunk:t,forwardParameterMap:fR,reverseParameterMap:fR,isLazy:!1,valueMap:bB(e.chunk.instructionsLength()),replacementMask:el(e.chunk.argNames.length)}}function dR(e){let{chunk:t,forwardParameterMap:r,reverseParameterMap:n,isLazy:i,valueMap:s,replacementMask:o,didShiftScale:a}=e;return{chunk:t.copy(),forwardParameterMap:r,reverseParameterMap:n,isLazy:i,valueMap:s.slice(),replacementMask:o.slice(),didShiftScale:a}}function dB(e){var t=1/0,r=-1/0,n=e.length;for(let i of e)t=Math.min(t,i),r=Math.max(r,i);return{min:t,max:r,length:n}}function gR(e){let t=e.getInstruction(e.getReturnIndex());if(t.type!==48)return;let r=t.args[0],n=e.getReturnIndex()-r,i=e.getInstruction(r);if(i.args.length!==2)return;let s=i.args[0],o=i.args[n],a=[],u=[];a.push(s),u.push({min:1,max:Hs(e,e.getReturnIndex(),\"Programming error: cannot optimize regression on non-constant-length list\"),length:Hs(e,e.getReturnIndex(),\"Programming error: cannot optimize regression on non-constant-length list\")});let c=!1,l=!1;for(let b=s+1;b<=o;b++){let d=e.getInstruction(b);if(d.type===39||d.type===41||d.type===40){if(d.args[1]!==s)continue;let g=d.args[0];if(e.getInstruction(g).valueType!==te||!Vt(e.getInstruction(g)))continue;let x=Zt(e,g),M=dB(x);if(!isFinite(M.min)||!isFinite(M.max))continue;a.push(b),u.push(M)}else if(d.type===37)d.symbol===\"exp\"?l=!0:yR(d)&&(c=!0);else if(d.type===12||d.type===13)l=!0;else if(jn(d)||un(d))return}if(a.length===0||!l&&!c)return;let p=[];for(let b=0;b<=o;b++){let d=a.indexOf(b);if(d!==-1){let g=el(a.length);g[d]=!0,p.push(g)}else p.push(Yy(e,p,a.length,b))}let f=[];for(let b=0;b<=e.getReturnIndex();b++)if(e.getInstruction(b).type===2){let g=el(e.argNames.length);g[b]=!0,f.push(g)}else f.push(Yy(e,f,e.argNames.length,b));let y={listAccessDependencyTable:p,listAccesses:a,listStatisticsTable:u},h;for(let b=s+1;b<=e.getReturnIndex();b++){let d=e.getInstruction(b);switch(d.type){case 37:{if(d.symbol===\"exp\"){let q=d.args[0],$=DI(y,q);if($===void 0){da(e,f,h,b);break}let{listStatistics:F,listAccessIndex:Z}=$,re=Bp(MI(e),b,q,Z,F);re?h=[re]:da(e,f,h,b)}break}case 12:case 13:{let[q,$]=d.args,F=DI(y,$);if(F===void 0||mR(y,q)){da(e,f,h,b);break}let{listStatistics:Z,listAccessIndex:re}=F,Ee=yB(MI(e),b,re,Z);Ee?h=[Ee]:da(e,f,h,b);break}case 10:if(h&&h.length>1){da(e,f,h,b);break}let g=h&&h.length>0?h[0]:MI(e),[x,M]=d.args,E=g.isLazy?x:g.valueMap[x],T=g.isLazy?M:g.valueMap[M],D=g.chunk.getInstruction(E),S=g.chunk.getInstruction(T),O,A,_;if(D.type===37)O=x,_=D,A=M;else if(S.type===37)O=M,_=S,A=x;else{da(e,f,h,b);break}let L=DI(y,O);if(L===void 0||mR(y,A)){da(e,f,h,b);break}let{listAccessIndex:H,listStatistics:w}=L;if(_.symbol===\"exp\"){let q=gB(g,b,A,O,H,w);if(q){h=q;break}}else if(yR(_)){let q=mB(g,b,A,O,H);if(q){h=[q];break}}da(e,f,h,b);break;default:{da(e,f,h,b);break}}}if(h===void 0||h.length===0)return;let m=[];for(let b of h)m.push({chunk:b.chunk.close(),forwardParameterMap:b.forwardParameterMap,reverseParameterMap:b.reverseParameterMap});return m}function da(e,t,r,n){if(r===void 0)return;let i=e.getInstruction(n);if(De(i))for(let s of r)s.valueMap[n]=n;else for(let s of r){let{chunk:o,valueMap:a}=s,u=[],c=0;for(let l of i.args){if(a[l]!==l){if(c+=1,c>1){r.length=0;return}}else{let p=t[l];for(let f=0;f<p.length;f++)if(p[f]&&s.replacementMask[f]){r.length=0;return}}u.push(a[l])}a[n]=c>0?mr(o,i,u):n}}function DI(e,t){let{listAccessDependencyTable:r,listAccesses:n,listStatisticsTable:i}=e,s,o=r[t];for(let a=0;a<o.length;a++)if(o[a]){if(s)return;s={listAccessIndex:n[a],listStatistics:i[a]}}return s}function mR(e,t){let{listAccessDependencyTable:r}=e,n=r[t];for(let i of n)if(i)return!0;return!1}function vI(e,t){let r=[];for(let s=0;s<=t;s++)if(e.getInstruction(s).type===2){let a=el(e.argNames.length);a[s]=!0,r.push(a)}else r.push(Yy(e,r,e.argNames.length,s));let n,i=r[t];for(let s=0;s<i.length;s++)if(i[s]){if(n!==void 0)return;n=s}return n}function mB(e,t,r,n,i){let s=e.chunk,o=vI(s,r);if(o===void 0)return;let a=OI(e,r,o);if(a===void 0)return;let u=s.getInstruction(n),c=u.args[0];if(a=hR(a,c,i),a===void 0)return;let{chunk:l,valueMap:p}=a,f=l.getInstruction(p[c]);if(f.type!==8)return;let y=f.args[1],h=l.getInstruction(f.args[0]);if(h.type!==10)return;let[m,b]=h.args,d=o,g=y,x=m,M=b,E=l.Multiply([x,M]),T=l.SyntheticNativeFunction(\"cos\",[E]),D=l.SyntheticNativeFunction(\"sin\",[E]),S=u.symbol===\"sin\"?l.Add([l.Multiply([d,D]),l.Multiply([g,T])]):l.Subtract([l.Multiply([d,T]),l.Multiply([g,D])]);p[t]=S;function O(L){let H=a.forwardParameterMap(L),w=H[o],q=H[y],$=w*Math.cos(q),F=w*Math.sin(q);return H[o]=$,H[y]=F,H}function A(L){let H=L.slice(),w=L[o],q=L[y],$=Bs(w,q),F=Math.atan2(q,w);return H[o]=$,H[y]=F,a.reverseParameterMap(H)}let _=a.replacementMask.slice();return _[o]=!0,_[m]=!0,_[y]=!0,{chunk:l,forwardParameterMap:O,reverseParameterMap:A,valueMap:p,replacementMask:_,isLazy:!1}}function yB(e,t,r,n){let i=e.chunk,s=i.getInstruction(t),[o,a]=s.args,u=i.getInstruction(o);if(u.type===1&&u.valueType===P&&Y(u.value)>0){let g=Xy(e),{chunk:x,valueMap:M}=g,E=x.Multiply([x.SyntheticNativeFunction(\"ln\",[M[o]]),M[a]]);return M[a]=E,M[t]=x.SyntheticNativeFunction(\"exp\",[E]),Bp(g,t,a,r,n)||g}let c=vI(i,o);if(c===void 0)return;let l=OI(e,o,c);if(l===void 0)return;let{chunk:p,valueMap:f}=l,y=p.Multiply([f[o],f[a]]);f[a]=y,f[t]=p.SyntheticNativeFunction(\"exp\",[y]);function h(g){let x=l.forwardParameterMap(g),M=x[c],E=Math.log(M);return x[c]=E,x}function m(g){let x=g.slice(),M=x[c],E=Math.exp(M);return x[c]=E,l.reverseParameterMap(x)}let b=l.replacementMask.slice();b[c]=!0;let d={chunk:p,forwardParameterMap:h,reverseParameterMap:m,isLazy:!1,valueMap:f,replacementMask:b};return Bp(d,t,a,r,n)||d}function gB(e,t,r,n,i,s){if(!e.isLazy&&e.didShiftScale)return;let o=e.isLazy?e:dR(e),a=e.chunk,u=vI(a,r);if(u===void 0)return;let c=OI(e,r,u);if(c===void 0)return;let{chunk:l,valueMap:p}=c,f=l.getInstruction(p[n]).args[0],y=l.Add([f,p[r]]);p[r]=y,p[t]=l.SyntheticNativeFunction(\"exp\",[y]);function h(T){let D=c.forwardParameterMap(T),S=D[u],O=Math.log(S);return D[u]=O,D}function m(T){let D=T.slice(),S=D[u],O=Math.exp(S);return D[u]=O,c.reverseParameterMap(D)}function b(T){let D=c.forwardParameterMap(T),S=D[u],O=Math.log(-S);return D[u]=O,D}function d(T){let D=T.slice(),S=D[u],O=-Math.exp(S);return D[u]=O,c.reverseParameterMap(D)}let g=c.replacementMask.slice();g[u]=!0;let x=Xy(o);x.valueMap[t]=x.chunk.Multiply([x.valueMap[r],x.valueMap[n]]);let M={chunk:l,forwardParameterMap:h,reverseParameterMap:m,isLazy:!1,valueMap:p,replacementMask:g},E=dR(M);return E.forwardParameterMap=b,E.reverseParameterMap=d,M=Bp(M,t,r,i,s)||M,E=Bp(E,t,r,i,s)||E,E.valueMap[t]=E.chunk.Negative([E.valueMap[t]]),[x,M,E]}function Bp(e,t,r,n,i){let s=hB(e,r,n,i);if(s!==void 0)return s.valueMap[t]=s.chunk.SyntheticNativeFunction(\"exp\",[s.valueMap[r]]),s}function hB(e,t,r,n){let i=hR(e,t,r);if(i===void 0)return;let{chunk:s,valueMap:o}=i,a=s.getInstruction(o[t]);if(a.type!==8)return;let u=a.args[1],c=s.getInstruction(a.args[0]);if(c.type!==10)return;let[l,p]=c.args,{min:f,max:y}=n,h=y-f,m=.5*(y+f),b=s.Divide([s.Subtract([p,s.Constant(m)]),s.Constant(h)]),d=s.Add([s.Multiply([l,b]),u]);o[t]=d;function g(M){let E=i.forwardParameterMap(M),T=E[l],D=E[u],S=T*h,O=D+m*T;return E[l]=S,E[u]=O,E}function x(M){let E=M.slice(),T=M[l],D=M[u],S=T/h,O=D-S*m;return E[l]=S,E[u]=O,i.reverseParameterMap(E)}return{chunk:s,forwardParameterMap:g,reverseParameterMap:x,isLazy:!1,valueMap:o,replacementMask:i.replacementMask,didShiftScale:!0}}function OI(e,t,r){let n=e.chunk,i=fi(n,r,{allowRestriction:!1,allowClosedBlockReferences:!1});if(Ir(i,t)!==1)return;let s=ds(i),[o,a]=wr(s,t);if(a===void 0)return;let u=s.newChunk.getInstruction(o);if(u.type!==1||u.valueType!==P)return;let c=s.newChunk.getInstruction(a);if(c.type!==1||c.valueType!==P)return;let l=Xy(e),{chunk:p,valueMap:f}=l,y=Y(u.value),h=Y(c.value);f[t]=r;function m(g){let x=l.forwardParameterMap(g),M=x[r],E=y+h*M;return x[r]=E,x}function b(g){let x=g.slice(),E=(x[r]-y)/h;return x[r]=E,l.reverseParameterMap(x)}let d=l.replacementMask.slice();return d[r]=!0,{chunk:p,forwardParameterMap:m,reverseParameterMap:b,isLazy:!1,valueMap:f,replacementMask:d}}function hR(e,t,r){let n=e.chunk,i=e.isLazy?t:e.valueMap[t],s=fi(n,r,{allowRestriction:!1,allowClosedBlockReferences:!0});if(Ir(s,i)!==1)return;e.isLazy&&(s=fi(n.copy().reopenFinalBlock(),r,{allowRestriction:!1,allowClosedBlockReferences:!1}));let o=ds(s),[a,u]=wr(o,i);if(u===void 0)return;let c=o.newChunk,l=Math.max(u,a),p=[];for(let K=0;K<=l;K++)if(c.getInstruction(K).type===2){let at=el(c.argNames.length);at[K]=!0,p.push(at)}else p.push(Yy(c,p,c.argNames.length,K));let f,y;for(let K=0;K<n.argNames.length;K++)if(p[u][K])if(f===void 0)f=K;else return;else if(p[a][K])if(y===void 0)y=K;else return;if(f===void 0||y===void 0)return;let h=fi(c,f,{allowRestriction:!1,allowClosedBlockReferences:!1});if(Ir(h,u)!==1)return;let m=fi(c,y,{allowRestriction:!1,allowClosedBlockReferences:!1});if(Ir(m,a)!==1)return;let b=ds(h),d=ds(m),[g,x]=wr(b,u),M=b.newChunk.getInstruction(g);if(M.type!==1||M.valueType!==P)return;let E=b.newChunk.getInstruction(x);if(E.type!==1||E.valueType!==P)return;let T=Xy(e),{chunk:D,valueMap:S}=T,O=D.Add([D.Multiply([f,r]),y]);S[t]=O;let A=c.copy();A.List([u,a]);let _=A.close().getCompiledFunction().fn;function L(K){let fe=T.forwardParameterMap(K),[at,me]=_.apply(null,fe);return fe[f]=at,fe[y]=me,fe}let H=Y(M.value),w=Y(E.value),[q,$]=wr(d,a),F=d.newChunk.copy();F.List([q,$]);let Z=F.close().getCompiledFunction().fn;function re(K){let fe=K.slice(),at=K[f],me=K[y],Kt=(at-H)/w,Ge=K.slice();Ge[f]=Kt,Ge.splice(y,1);let[Ze,U]=Z.apply(null,Ge),z=(me-Ze)/U;return fe[f]=Kt,fe[y]=z,T.reverseParameterMap(fe)}let Ee=T.replacementMask.slice();return Ee[f]=!0,Ee[y]=!0,{chunk:D,forwardParameterMap:L,reverseParameterMap:re,isLazy:!1,valueMap:S,replacementMask:Ee}}function Yy(e,t,r,n){let i=e.getInstruction(n),s=el(r);if(De(i))return s;for(let o of i.args){let a=t[o];for(let u=0;u<a.length;u++)s[u]=s[u]||a[u]}return s}function el(e){let t=[];for(let r=0;r<e;r++)t.push(!1);return t}function bB(e){let t=[];for(let r=0;r<e;r++)t.push(r);return t}function yR(e){return e.type===37&&(e.symbol===\"sin\"||e.symbol===\"cos\")}function ot(e,t){switch(e){case P:case he:return new I.Constant(t);case Qe:return new I.Seed(t);case N:return new I.ParenSeq([ot(P,t[0]),ot(P,t[1])]);case G:return new I.ParenSeq([ot(P,t[0]),ot(P,t[1]),ot(P,t[2])]);case dt:return new I.FunctionCall(\"segment\",[ot(G,t[0]),ot(G,t[1])]);case Re:return new I.FunctionCall(\"vector\",[ot(G,t[0]),ot(G,t[1])]);case xr:return new I.FunctionCall(\"triangle\",[ot(G,t[0]),ot(G,t[1]),ot(G,t[2])]);case _r:return new I.FunctionCall(\"sphere\",[ot(G,t[0]),ot(P,t[1])]);case It:return new I.FunctionCall(\"rgb\",[ot(P,t[0]),ot(P,t[1]),ot(P,t[2])]);case we:return new I.FunctionCall(\"polygon\",[ot(nt,t)]);case Oe:return new I.FunctionCall(\"segment\",[ot(N,t[0]),ot(N,t[1])]);case ye:return new I.FunctionCall(\"line\",[ot(N,t[0]),ot(N,t[1])]);case _e:return new I.FunctionCall(\"ray\",[ot(N,t[0]),ot(N,t[1])]);case ge:return new I.FunctionCall(\"mathVector\",[ot(N,t[0]),ot(N,t[1])]);case de:return new I.FunctionCall(\"circle\",[ot(N,t[0]),ot(P,t[1])]);case ue:return new I.FunctionCall(\"arc\",[ot(N,t[0]),ot(N,t[1]),ot(N,t[2])]);case Ae:return new I.FunctionCall(\"angle\",[ot(N,t[0]),ot(P,t[1]),ot(P,t[2])]);case xe:return new I.FunctionCall(\"directedangle\",[ot(N,t[0]),ot(P,t[1]),ot(P,t[2])]);case Le:case te:case zr:case nt:case Vr:case br:case ur:case Nr:case Ar:case Cr:case Jt:case Qt:case Sr:case Rr:case Hr:case rn:case sn:case Ur:case nn:{let n=[],i=$e(e);for(let s of t)n.push(ot(i,s));return new I.List(n)}case Tt:case Ke:case Bt:case ar:case Je:case He:case tn:case wi:throw new Error(`Programming error: cannot create parse node from valueType: ${$n(e)}`);default:let r=e;throw new Error(`Programming error: unexpected valueType: ${$n(r)}`)}}function MR(e,t){try{return xB(e,t)}catch(r){return r instanceof I.Error?r:ne(r)}}function xB(e,t){let{policy:r,frame:n,exportFrame:i,lastExportFrame:s,priorAnalysis:o}=e,a=t._lhs.buildIRExpression(r,n,{coerceToNumber:!0}),u=t._rhs.buildIRExpression(r,n,{coerceToNumber:!0});if(a.isError)throw a;if(u.isError)throw u;if(a.valueType!==P&&a.valueType!==te||u.valueType!==P&&u.valueType!==te)throw nh([pe(a.valueType),pe(u.valueType)]);let c=t._difference.buildIRExpression(r,n,{wrapInList:!0,coerceToNumber:!0});if(c.isError)throw c;for(let E of c.getDependencies())if(!r.validRegressionParameter(E))throw vb(E);let l=TB(c.getDependencies(),t.userData.regressionParameters,s),{parameters:p,residuals:f,isLinear:y,parameterWarning:h}=ER(l,c),m={policy:r,frame:n},b=bR(m,t,p),d=MB(t,a,b),g;if(t.userData.isLogModeRegression&&(d===qn.LOGLIN||d===qn.LOGLOG)){let E=t._logDifference.buildIRExpression(r,n,{wrapInList:!0,coerceToNumber:!0});if(E.isError)throw E;let T=t._logLhs.buildIRExpression(r,n,{wrapInList:!0,coerceToNumber:!0});if(T.isError)throw T;({parameters:p,isLinear:y,parameterWarning:h}=ER(l,E)),b=bR(m,t,p),f=IR(m,t._difference,p);let D=IR(m,t._logDifference,p);g=TR(t,T,b,D,t.userData.isLogModeRegression,d)}else g=TR(t,a,b,f,t.userData.isLogModeRegression,d);let x=PB(t,i),M=EB(t,x,o,r);return t.userData.residualVariable=Zr(x),new I.OptimizedRegression(p,ot(te,f),g,b.substituted,{isModelValid:b.isValid,residualVariable:x,residualSuggestionId:M,shouldSuggestLogMode:d!==qn.NONE,isLinear:y,parameterWarning:h})}function PB(e,t){if(e.userData&&e.userData.residualVariable){let s=po(e.userData.residualVariable);if(!t[s])return s}let r=e.getDependencies().filter(s=>s[0]!==\"_\"),n;for(let s of r){let o=s.match(/_(.*)/);if(o&&(n=\"e_\"+o[1],!t[n]))return n}let i=1;for(;;){if(n=\"e_\"+i,!t[n])return n;i++}}function bR({policy:e,frame:t},r,n){let i=r._rhs.getDependencies(),s,o;for(let p of i){if(n.hasOwnProperty(p))continue;let f=t[p];if(!f||(f.type===\"Assignment\"&&(f=f._expression),!f.buildIRExpression))continue;let y=f.buildIRExpression(e,t,{coerceToNumber:!0});if(!y.isError&&y.valueType===te){if(s!==void 0){s=void 0,o=void 0;break}y.getDependencies().length===0&&(s=p,o=y)}}let a=Object.create(t);s!==void 0&&(a[s]=void 0);let u=r._rhs.buildIRExpression(e,a,{coerceToNumber:!0}),c=Object.create(a);for(let p in n)c[p]=n[p];let l=r._rhs.buildIRExpression(e,c,{coerceToNumber:!0});return o?{node:u,substituted:l,listNode:o,isValid:!0}:{node:u,substituted:l,listNode:o,isValid:!1}}function TB(e,t,r){let n=[];t||(t={}),r||(r={});for(let i of e){let s=Zr(i);r[i]&&isFinite(r[i].asValue())?n.push(+r[i].asValue()):t.hasOwnProperty(s)&&isFinite(+t[s])?n.push(+t[s]):n.push(1)}return n}function xR(e,t){let r=t.getDependencies(),n=t.getCompiledFunction(r).fn;if(r.length){let i=t.findLinearSubset(r),s=i.every(a=>a),o=[];for(let a of r)o.push(t.takeDerivative(a).getCompiledFunction(r).fn);if(s){let a=r.map(()=>Ce(0,1)),u=t.interpretWithParameters(a),c=[];for(let y of r)c.push(t.takeDerivative(y).interpretWithParameters(a));let l=II(u,c);if(l){let y=t.interpretWithParameters(l);return{solution:l,residuals:y,MSE:RI(y),isLinear:s}}let{solution:p,MSE:f}=TI(n,EI(n,o));return{solution:p,residuals:n.apply(void 0,p),MSE:f,isLinear:s}}else{let a=[];for(let p of r)a.push(t.boundDomain(p));let u={linearSubset:i,bounds:a,preferredInitialGuess:e},{solution:c,MSE:l}=TI(n,pR(n,o,u));return{solution:c,residuals:n.apply(void 0,c),MSE:l,isLinear:s}}}else return{solution:[],residuals:t.interpretWithParameters([]),MSE:tu(n,[]),isLinear:!0}}function PR(e,t){let r={},n=t.getDependencies();for(let i=0;i<n.length;i++){let s=new I.RegressionParameter(e[i]);r[n[i]]=s}return r}function TR(e,t,r,n,i,s){let o=RI(n);if(!isFinite(o))throw Ob();if(t.getDependencies().length>0)return{RMSE:Math.sqrt(o)};let a=j(t.valueType)?ap(t.asValue()):0;if(t.getDependencies().length||!isFinite(a)||a<=0||!e.isLhsSimple)return{RMSE:Math.sqrt(o)};{let u=1-o/a;if(r.isValid){let c=[],l=[],p=i&&(s===qn.LINLOG||s===qn.LOGLOG);I.List.eachArgs([r.listNode,t],function(y){let h=y[0].isConstant?y[0].asCompilerValue():NaN,m=y[1].isConstant?y[1].asCompilerValue():NaN;c.push(p?Math.log(Y(h)):h),l.push(m)});let f=xm(c.map(y=>Y(y)),l.map(y=>Y(y)));if(Ln(IB(c,l).MSE,o,8))return{r:f,rsquared:f*f}}return{Rsquared:u}}}function IB(e,t){let r=t,n=[e.map(a=>Vi(a)),e.map(()=>Ce(-1,1))],i=II(r,n);if(i){let[a,u]=i,c=[];for(let l=0;l<t.length;l++)c.push(Ns(t[l],co(lo(a,e[l]),u)));return{solution:i,MSE:RI(c)}}function s(a,u){let c=[];for(let l=0;l<e.length;l++)c.push(Y(t[l])-(a*Y(e[l])+u));return c}return EI(s,[function(){return e.map(function(a){return-Y(a)})},function(){return e.map(function(){return-1})}])}function EB(e,t,r,n){let i=e._rhs.getDependencies(),s;for(let o in r){if(!r.hasOwnProperty(o))continue;let a=r[o].concreteTree;if(!hs(a)||!a.columns[0])continue;let u=r[o].rawTree.columns;if(!u||!u.length)continue;let c=u[0].getExports(n);if(c.length===1&&i.indexOf(c[0])!==-1){for(let l=1;l<u.length;l++)if(u[l].getDependencies().indexOf(t)!==-1)return;s=s||o}}return s||void 0}function SI(e,t){let r=e.length,n=e[0],i=t[0],s=e[r-1],o=t[r-1];if(!isFinite(n)||!isFinite(s)||!isFinite(i)||!isFinite(o)||o-i===0)return!1;let a=s-n;if(a===0)return!1;for(let u=1;u<r-1;u++){let c=e[u],l=t[u],p=(o*(c-n)+i*(s-c))/a;if(!Ln(l,p,5))return!1}return!0}var qn={NONE:0,LOGLIN:1,LOGLOG:2,LINLOG:3};function MB(e,t,r){if(!e.isLhsSimple||!r.isValid)return qn.NONE;let n=r.substituted;if(n.isError||n.valueType!==P)return qn.NONE;let i=n.getDependencies();if(i.length!==1||isFinite(r.node.polynomialOrder(i[0])))return qn.NONE;let s=n.getCompiledFunction(i).fn,o=r.listNode;if(n.valueType!==P)return qn.NONE;let a=o.mapElements(f=>+f.asValue());if(a.length<3)return qn.NONE;a.sort(function(f,y){return f-y});let u=a.map(s),c=u.map(Math.log),l=a.map(Math.log),p=!0;return I.List.wrap(t).eachElement(f=>{isFinite(Math.log(+f.asValue()))||(p=!1)}),SI(a,c)&&p?qn.LOGLIN:SI(l,c)&&p?qn.LOGLOG:SI(l,u)?qn.LINLOG:qn.NONE}function IR({policy:e,frame:t},r,n){let i=Object.create(t);for(let a in n)n.hasOwnProperty(a)&&(i[a]=n[a]);let s=Xc({policy:e,frame:i,wrapInList:!0},r),o=s.getError();if(o)throw o;return s.asCompilerValue()}function RI(e){let t=0;for(let r of e){let n=Y(r);t+=n*n}return t/e.length}function ER(e,t){let r,n,i=t._chunk;if(i&&(n=gR(i)),!n||n.length===0)return t=t.deriveRegressionRestrictions(),r=xR(e,t),{parameters:PR(r.solution,t),residuals:r.residuals,isLinear:r.isLinear,parameterWarning:!1};let s=t.getDependencies(),o=t.getCompiledFunction(s).fn,a=1/0,u={},c,l=!1;for(let p of n){let f=new sr(p.chunk);if(f=f.deriveRegressionRestrictions(),r=xR(p.forwardParameterMap(e),f),r.MSE<a){let y=p.reverseParameterMap(r.solution.map(m=>Y(m))),h=tu(o,y);if(u&&(!isFinite(h)||h>=a)){isFinite(h)||(l=!0);continue}a=r.MSE,u=PR(y,t),c=o.apply(void 0,y)}}return{parameters:u,residuals:c,isLinear:!1,parameterWarning:l}}I.Base.prototype.analyze=function(e,t){return Rn(this)?Nn(e,t,this):new X(e,t,this,this.tryGetConcreteTree(e,t))};function $y(e,t,r,n){if(n.isError)return new X(e,t,r,n);if(!e.areAllScalesLinear()&&!nl(n.valueType)){let u=Ml(pe(n.valueType));return u.setCursorContext(n.getCursorContext()),new X(e,t,r,u)}var i=rs(e,n),s=n.getDependencies();let o;switch(n.valueType){case Ke:case ar:case Le:{o=n;break}case It:case Vr:case Oe:case ur:case de:case Sr:case ue:case Rr:case ye:case Nr:case _e:case Ar:case ge:case Cr:case Ae:case Jt:case xe:case Qt:case He:case tn:case Je:case we:case br:case dt:case rn:case Re:case sn:case xr:case Ur:case _r:case nn:i.length?o=jt(r.getSliderVariables(e,n)).setDependencies(i):o=n;break;case N:case G:case nt:case Hr:if(i.length)if(e.validParametricVariables(i))o=n;else{var a=r.getSliderVariables(e,n);o=jt(a).setDependencies(a)}else o=n;break;case P:case te:i.length===0?o=n:i.length<=(e.is3dPolicy()?2:1)?e.is3dPolicy()&&s.length>i.length&&!e.validImplicitVariables(s)?o=jt(r.getSliderVariables(e,n)).setDependencies(s):e.validExpressionVariables(i)?o=n:o=pd(e.implicitDependency(i)).setDependencies(i):e.validImplicitVariables(i)?o=pd().setDependencies(i):o=jt(r.getSliderVariables(e,n)).setDependencies(s);break;default:o=ne(`Programming error: unexpected value type ${n.valueType}`)}return Ys(o)&&o.setCursorContext(n.getCursorContext()),o=Kc(e,r,o),new X(e,t,r,o)}function DR(e){return new I.FunctionCall(\"pdf\",[e,new I.Identifier(\"x\")])}I.Identifier.prototype.analyze=function(e,t){let r=this.tryGetConcreteTree(e,t,{coerceToNumber:!0}),n=$y(e,t,this,r);return Rn(this)&&!AI(n)?Nn(e,t,this):n};I.FunctionCall.prototype.analyze=function(e,t,r){var n;py[this._symbol]&&Uu(t,this).length===0&&!e.is3dPolicy()?n=DR(this).tryGetConcreteTree(e,t):n=this.tryGetConcreteTree(e,t);var i=$y(e,t,this,n);if(Rn(this)&&!AI(i))return Nn(e,t,this);var s=this.getMoveStrategy(e,t,n,r,this.userData);if(s){var o=this.getDefaultDragMode(s),a=n.asCompilerValue(),u=[new I.Constant(a[0]),new I.Constant(a[1])];return new X(e,t,this,new I.MovablePoint(u,s,o))}return i};I.Expression.prototype.analyze=function(e,t){var r=$y(e,t,this,this.tryGetConcreteTree(e,t));return Rn(this)&&!AI(r)?Nn(e,t,this):r};I.FunctionDefinition.prototype.analyze=function(e,t){if(Rn(this))return Nn(e,t,this);if(Xe[this._symbol])return this.asEquation().analyze(e,t);var r=this._symbol.split(\"_\")[0];if(Xe[r]&&Xe[r].isFunction)return new X(e,t,this,bc(this._symbol,r));var n=this.tryGetConcreteTree(e,t);if(n instanceof I.Error&&!n.blocksExport&&this._argSymbols.length===1){let u=Object.create(t);u[this._argSymbols[0]]=new gt(\"identityTransformation\");let c=this._expression.tryGetConcreteTree(e,u);if(!(c instanceof I.Error))return new X(e,t,this,c)}if(n.isError)return new X(e,t,this,n);var i=this._argSymbols,s=n.getDependencies();if(s.indexOf(this._symbol)!==-1)return new X(e,t,this,Al(this._symbol));var o=s.filter(function(u){return i.indexOf(u)===-1});if(e.unplottablePolarFunction(this._symbol,s))return new X(e,t,this,bb());if(e.is3dPolicy()&&e.assignmentForbidden(this._symbol))return new X(e,t,this,Wb(this._symbol));if(o.some(function(u){return e.assignmentForbidden(u)}))return new X(e,t,this,Cl(o,this._symbol,i).setDependencies(s));if(o.length){var a=this.getSliderVariables(e,n);return new X(e,t,this,jt(a).setDependencies(a))}return!e.areAllScalesLinear()&&!nl(n.valueType)?new X(e,t,this,Ml(pe(n.valueType))):(n=Kc(e,this,n),new X(e,t,this,n))};I.Assignment.prototype.analyze=function(e,t,r){if(Rn(this))return Nn(e,t,this);var n=this._symbol;if(!e.validLHS(n))return new X(e,t,this,hb(n));if(Xe[n])return this.asEquation().analyze(e,t);var i;if(this._expression instanceof I.FunctionCall&&py[this._expression._symbol]&&Uu(t,this).length===0&&!e.is3dPolicy())i=DR(this._expression).tryGetConcreteTree(e,t);else{var s=Object.create(t);s[n]=e.validSolvedVariable(n)?void 0:hu(),i=this.tryGetConcreteTree(e,s)}if(i.isError)return new X(e,t,this,i);if(!e.areAllScalesLinear()&&!nl(i.valueType))return new X(e,t,this,Ml(pe(i.valueType)));if(this.isEquation(e,i))return this.asEquation().analyze(e,t);let o=i.valueType===It||i.valueType===Vr;if(e.assignmentForbidden(n)&&o){let h=yb(n).allowExport().setDependencies([n]);return new X(e,t,this,h)}let a=i.getDependencies(),u=rs(e,i),c=u.includes(\"x\")||u.includes(\"y\"),l=u.includes(\"r\")||u.includes(\"theta\"),p=this.getSliderVariables(e,i,a);if(e.tooManySliderVariables(a,p,o)||c&&l){let h=jt(p).allowExport().setDependencies(p);return new X(e,t,this,h)}var f=this.getMoveStrategy(e,t,i,r,this.userData);if(f){var y=this.getDefaultDragMode(f);return i=new I.MovablePoint([i.elementAt(0),i.elementAt(1)],f,y),new X(e,t,this,i)}return i=Kc(e,this,i),new X(e,t,this,i)};I.CoordinateEquation.prototype.analyze=function(e,t){if(!e.validCoordinateEquationSymbol(this._concatenatedSymbol))return this.asEquation().analyze(e,t);if(Rn(this))return Nn(e,t,this);let r=this.tryGetConcreteTree(e,t);return r=Kc(e,this,r),new X(e,t,this,r)};I.Regression.prototype.analyze=function(e,t,r,n,i){if(Rn(this))return Nn(e,t,this);var s={policy:e,frame:t,exportFrame:r,lastExportFrame:n,priorAnalysis:i};return new X(e,t,this,MR(s,this))};function NI(e,t){var r=this.tryGetConcreteTree(e,t),n=r.getDependencies();return n.length?new X(e,t,this,jt(this.getSliderVariables(e,r)).setDependencies(n)):new X(e,t,this,this.tryGetConcreteTree(e,t))}I.Histogram.prototype.analyze=function(e,t){return Rn(this)?Nn(e,t,this):e.areAllScalesLinear()?NI.call(this,e,t):new X(e,t,this,lh())};I.DotPlot.prototype.analyze=function(e,t){return Rn(this)?Nn(e,t,this):e.areAllScalesLinear()?NI.call(this,e,t):new X(e,t,this,ph())};I.BoxPlot.prototype.analyze=function(e,t){return Rn(this)?Nn(e,t,this):e.areAllScalesLinear()?NI.call(this,e,t):new X(e,t,this,fh())};function vR(e){return function(t,r){if(Rn(this))return Nn(t,r,this);var n=this.tryGetConcreteTree(t,r),i=n.getDependencies();if(i.length)return new X(t,r,this,jt(this.getSliderVariables(t,n)).setDependencies(i));var s=new X(t,r,this,this.tryGetConcreteTree(t,r));if(!n.isError){s.evaluationState.expression_type=\"TTEST\";var o=n.args.map(function(a){return a.asValue()});s.evaluationState.ttest_results=e.apply(null,o)}return s}}I.TTest.prototype.analyze=vR(Yx);I.IndependentTTest.prototype.analyze=vR(Xx);I.Stats.prototype.analyze=function(e,t){if(Rn(this))return Nn(e,t,this);var r=this.tryGetConcreteTree(e,t),n=r.getDependencies();if(n.length)return new X(e,t,this,jt(this.getSliderVariables(e,r)).setDependencies(n));var i=new X(e,t,this,this.tryGetConcreteTree(e,t));if(!r.isError){i.evaluationState.expression_type=\"STATS\";var s=r.args.map(function(o){return o.asValue()});i.evaluationState.stats_results=$x.apply(null,s)}return i};I.Equation.prototype.analyze=I.BaseComparator.prototype.analyze=function(e,t){if(Rn(this))return Nn(e,t,this);var r=this.getOperator()!==\"=\";if(r&&!Si.plotInequalities)return new X(e,t,this,ad());var n=US({policy:e,frame:t},this.asComparator());if(n.isError)return new X(e,t,this,n);let i=rs(e,n);if(n instanceof I.SolvedEquation&&i.length){var s=i.concat(n._symbol);if(!e.validImplicitVariables(s))return new X(e,t,this,hu().setDependencies(s))}return this.getGraphMode(e,n)===8&&!e.validImplicitVariables(i)?new X(e,t,this,hu().setDependencies(i)):(n=Kc(e,this,n),new X(e,t,this,n))};I.DoubleInequality.prototype.analyze=function(e,t){if(Rn(this))return Nn(e,t,this);if(!Si.plotInequalities)return new X(e,t,this,ad());var r=this.tryGetConcreteTree(e,t);if(r.isError)return new X(e,t,this,r);var n=r.getDependencies();return e.is3dPolicy()?new X(e,t,this,ud()):wn[this._operators[0]].direction!==wn[this._operators[1]].direction?new X(e,t,this,Eb()):e.validDoubleInequalitySymbol(r._symbol)?e.validDoubleInequalityVariables(n)?n.length>2?new X(e,t,this,jt(this.getSliderVariables(e,r)).setDependencies(n)):r._expressions[0].getDependencies().indexOf(r._symbol)!==-1||r._expressions[1].getDependencies().indexOf(r._symbol)!==-1?new X(e,t,this,ld().setDependencies(n)):new X(e,t,this,r):new X(e,t,this,cd().setDependencies(n)):new X(e,t,this,cd().setDependencies(n))};I.And.prototype.analyze=function(e,t){if(Rn(this))return Nn(e,t,this);var r=this.tryGetConcreteTree(e,t);if(r.isError)return new X(e,t,this,r);var n=r.getDependencies();return n.length?e.is3dPolicy()?new X(e,t,this,ud()):e.validDoubleInequalityVariables(n)?new X(e,t,this,ld().setDependencies(n)):new X(e,t,this,jt(this.getSliderVariables(e,r)).setDependencies(n)):new X(e,t,this,r)};I.ParenSeq.prototype.analyze=function(e,t,r){if(Rn(this))return Nn(e,t,this);var n=this.tryGetConcreteTree(e,t);if(n.isError)return new X(e,t,this,n);var i=this.getMoveStrategy(e,t,n,r,this.userData);if(i){var s=this.getDefaultDragMode(i),o=n.asCompilerValue(),a=[new I.Constant(o[0]),new I.Constant(o[1])];return new X(e,t,this,new I.MovablePoint(a,i,s))}return $y(e,t,this,n)};function DB(e,t){return e.filter(function(r){return!t[r]})}function vB(e){for(var t={},r=0;r<e.length;r++){var n=e[r];if(n instanceof Eu&&n.header instanceof I.Identifier){var i=n.header._symbol;t[i]===void 0&&(t[i]=0),t[i]+=1}}return t}I.Table.prototype.analyze=function(e,t){var r=Object.create(t),n=[],i=vB(this.columns),s;for(s=0;s<this.columns.length;s++){var o=this.columns[s];if(o instanceof Eu&&o.header instanceof I.Identifier){var a=o.header._symbol,u=r[a],c=i[a]>1;u&&u.isError&&(u.isTableCycleWithoutGlobalDefinition||u.isMultiplyDefinedByTables&&!c)&&(r[a]=void 0)}var l=o.analyze(e,r);if(s===0&&l.concreteTree.isIndependent){var p=l.concreteTree.getDependencies()[0];e.validFirstColumnVariable(p)||(l=new X(e,t,o,Db()))}if(l.concreteTree.isIndependent)l.rawTree.exportToLocal(e,l.concreteTree,r);else if(!l.concreteTree.isError){var f=l.concreteTree.header.getDependencies(),y=DB(f,r);y.length&&(l=new X(e,t,o,jt(y).setDependencies(y)))}n.push(l.concreteTree)}var h=1;for(s=0;s<n.length;s++)n[s].isError||(h=Math.max(n[s].values.length,h));for(s=0;s<n.length;s++)if(!n[s].isError&&n[s].header.isConstant){for(var m=[],b=0;b<h;b++)m.push(n[s].header);n[s]=new I.TableColumn(n[s].header,m)}var d=new I.Table(n),g=new X(e,t,this,d);return g.evaluationState.is_graphable=!0,g};I.TableColumn.prototype.analyze=function(e,t){var r=this.header.tableError();if(r)return new X(e,t,this,Mb(r));var n=this.tryGetConcreteTree(e,t);if(n.isError)return new X(e,t,this,n);if(n.header.isError)return new X(e,t,this,n.header);if(n.values.isError)return new X(e,t,this,n.values);for(var i=0;i<n.values.length;i++)if(!n.values[i].isError){var s=this.values[i]&&this.values[i].tableError();if(s){n.values[i]=Pc(s);continue}var o=n.values[i].getDependencies();o.length&&(n.values[i]=jt(o).setDependencies(o))}return new X(e,t,this,n)};I.Image.prototype.analyze=function(e,t,r){var n=this.tryGetConcreteTree(e,t);if(n.radianAngle.isError||n.center.isError||n.width.isError||n.height.isError||n.opacity.isError)return new X(e,t,this,n);var i=n.center.getDependencies(),s=n.radianAngle.getDependencies(),o=n.width.getDependencies(),a=n.height.getDependencies(),u=n.opacity.getDependencies();return i.length||s.length||o.length||a.length||u.length?new X(e,t,this,new I.Image({center:i.length?jt(s).setDependencies(i):n.center,radianAngle:s.length?jt(s).setDependencies(s):n.radianAngle,width:o.length?jt(o).setDependencies(o):n.width,height:a.length?jt(a).setDependencies(a):n.height,opacity:u.length?jt(u).setDependencies(u):n.opacity})):(n.moveStrategy=this.getMoveStrategy(e,t,n,r,this.userData),new X(e,t,this,n))};I.Slider.prototype.analyze=function(e,t){if(Rn(this))return Nn(e,t,this);var r=this.tryGetConcreteTree(e,t),n=r.sliderInfo,i;if(n.missingVars.length){var s=cl(n.missingVars);i=new X(e,t,this,jt(e.sliderVariables(s)).setDependencies(s).allowExport())}else i=new X(e,t,this,r);var o=i.evaluationState;if(Si.sliders){o.assignment=n.exportedSymbol,o.slider_min_number=n.values.min,o.slider_max_number=n.values.max,o.slider_step_number=n.values.step,o.slider_min_valid=n.valids.min,o.slider_max_valid=n.valids.max,o.slider_step_valid=n.valids.step;var a=o.slider_min_valid&&o.slider_max_valid&&o.slider_step_valid;o.is_slider=!0,o.raw_slider_latex=this.getInputString(),o.is_slidable=a,o.is_animatable=o.is_slidable&&!o.is_graphable,n.errMsg&&(o.error=n.errMsg.getError())}return delete o.is_evaluable,delete o.zero_values,i};function Rn(e){return\"latex\"in e.userData&&fo(e.userData.latex).slice(-1)===\"=\"}function Nn(e,t,r){return new X(e,t,r,Rl(\"=\"))}function AI(e){return e.concreteTree.isConstant&&e.concreteTree.valueType===P}I.Base.prototype.analyzeFourFunction=function(e,t){var r=this.tryGetConcreteTree(e,t);return r.isError?new X(e,t,this,r):new X(e,t,this,ne(`Unexpected node type ${this.type}`))};I.Expression.prototype.analyzeFourFunction=function(e,t){var r=this.tryGetConcreteTree(e,t);if(r.isError)return new X(e,t,this,r);var n=r.getDependencies();if(n.length>0){var i=n[0],s,o=Xe[i];return o?s=o.isFunction?ki(i):bu(i):s=Vl(i),new X(e,t,this,s)}return new X(e,t,this,r)};I.Assignment.prototype.analyzeFourFunction=function(e,t){return new X(e,t,this,Bl())};I.FunctionDefinition.prototype.analyzeFourFunction=function(e,t){return new X(e,t,this,Gl())};I.Equation.prototype.analyzeFourFunction=function(e,t){return new X(e,t,this,jo())};function CI(e,t){return new X(e,t,this,xu())}I.And.prototype.analyzeFourFunction=CI;I.DoubleInequality.prototype.analyzeFourFunction=CI;I.BaseComparator.prototype.analyzeFourFunction=CI;I.Regression.prototype.analyzeFourFunction=function(e,t){return new X(e,t,this,Pu())};I.ParenSeq.prototype.analyzeFourFunction=function(e,t){return new X(e,t,this,Tu())};I.Base.prototype.analyzeScientific=function(e,t){var r=this.tryGetConcreteTree(e,t);return r.isError?new X(e,t,this,r):new X(e,t,this,ne(`Unexpected node type ${this.type}`))};I.Expression.prototype.analyzeScientific=function(e,t){var r=this.tryGetConcreteTree(e,t);if(r.isError)return new X(e,t,this,r);var n=r.getDependencies();return n.length>0?new X(e,t,this,jt(n)):new X(e,t,this,r)};I.Assignment.prototype.analyzeScientific=function(e,t){var r=this._symbol;if(Xe[r])return new X(e,t,this,bc(r));var n=Object.create(t);n[r]=jo();var i=this.tryGetConcreteTree(e,n);if(i.isError)return new X(e,t,this,i);var s=i.getDependencies();return this.isEquation(e,i)?new X(e,t,this,jo()):s.length>0?new X(e,t,this,jt(s)):new X(e,t,this,i)};I.FunctionDefinition.prototype.analyzeScientific=function(e,t){if(Xe[this._symbol])return new X(e,t,this,bc(this._symbol));var r=this.tryGetConcreteTree(e,t);if(r.isError)return new X(e,t,this,r);var n=this._argSymbols,i=r.getDependencies();if(i.indexOf(this._symbol)!==-1)return new X(e,t,this,Al(this._symbol));var s=i.filter(function(o){return n.indexOf(o)===-1});return s.length?new X(e,t,this,Cl(s,this._symbol,n)):new X(e,t,this,r)};I.Equation.prototype.analyzeScientific=function(e,t){return new X(e,t,this,jo())};function _I(e,t){return new X(e,t,this,xu())}I.And.prototype.analyzeScientific=_I;I.DoubleInequality.prototype.analyzeScientific=_I;I.BaseComparator.prototype.analyzeScientific=_I;I.Regression.prototype.analyzeScientific=function(e,t){return new X(e,t,this,Pu())};I.ParenSeq.prototype.analyzeScientific=function(e,t){return new X(e,t,this,Tu())};I.Base.prototype.analyzeSingleExpressionScientific=function(e,t){var r=this.tryGetConcreteTree(e,t);return r.isError?new X(e,t,this,r):new X(e,t,this,ne(`Unexpected node type ${this.type}`))};I.Expression.prototype.analyzeSingleExpressionScientific=function(e,t){var r=this.tryGetConcreteTree(e,t);if(r.isError)return new X(e,t,this,r);var n=r.getDependencies();if(n.length>0){var i=n[0],s,o=Xe[i];return o?s=o.isFunction?ki(i):bu(i):s=Vl(i),new X(e,t,this,s)}return new X(e,t,this,r)};I.Assignment.prototype.analyzeSingleExpressionScientific=function(e,t){return new X(e,t,this,Bl())};I.FunctionDefinition.prototype.analyzeSingleExpressionScientific=function(e,t){return new X(e,t,this,Gl())};I.Equation.prototype.analyzeSingleExpressionScientific=function(e,t){return new X(e,t,this,jo())};function LI(e,t){return new X(e,t,this,xu())}I.And.prototype.analyzeSingleExpressionScientific=LI;I.DoubleInequality.prototype.analyzeSingleExpressionScientific=LI;I.BaseComparator.prototype.analyzeSingleExpressionScientific=LI;I.Regression.prototype.analyzeSingleExpressionScientific=function(e,t){return new X(e,t,this,Pu())};I.ParenSeq.prototype.analyzeSingleExpressionScientific=function(e,t){return new X(e,t,this,Tu())};I.Base.prototype.getGraphInfo=function(e,t){var r=t.getDependencies(),n,i;switch(r.length){case 0:n=OR(t),i=t.boundDomain(\"x\");break;case 1:i=t.boundDomain(r[0]),i.type===\"known\"&&(n=OR(t));break;default:i=gn();break}return{graphMode:this.getGraphMode(e,t),color:zo(this.userData,this.metaData),pointStyle:this.userData.pointStyle,lineStyle:this.userData.lineStyle,arrowMode:this.userData.arrowMode,operator:this.getOperator(),isLinear:!!n,linearCoefficients:n,domainBound:i}};function OR(e){switch(e.valueType){case P:return wI(e);case N:{var t=wI(e.elementAt(0)),r=wI(e.elementAt(1));return!t||!r?void 0:[t,r]}default:return}}function wI(e){var t=e.getDependencies();switch(t.length){case 0:return[+e.asValue(),0];case 1:if(e.polynomialOrder(t[0])>1)return;var r=e.getPolynomialCoefficients(t[0]);return[r[0]?+r[0].asValue():0,r[1]?+r[1].asValue():0];default:return}}var SR=new I.Constant(Ce(0,1));I.Base.prototype.getMoveStrategy=function(){};I.Assignment.prototype.getMoveStrategy=function(e,t,r,n,i){return this._expression.getMoveStrategy(e,t,r,n,i)};function OB(e){return{type:\"updateSliderNonlinear\",id:e.id,initialValue:e.initialValue,min:e.min,max:e.max,compiled:e.compiled,movesOn:e.movesOn,hasLinearComponent:e.hasLinearComponent}}function SB(e){return{type:\"updateGliderParameter\",span:e.span,movesOn:e.movesOn}}function RB(e){return{type:\"updateSliderForGlider\",id:e.sliderId,movesOn:e.movesOn,min:e.min,max:e.max}}function RR(e,t,r,n,i,s){var o=t.getDependencies();for(let b of o)if(i[b])return;for(var a=o.length-1;a>=0;a--){var u=o[a];if(!s[u]){var c=n[u];if(c!==void 0){var l=r[u];if(l.order===1){var p=l.tree,f=p.getPolynomialCoefficients(u),y=f[1]||SR,h=f[0]||SR;if(!(!h.isConstant||!y.isConstant)&&!(!isFinite(h.asValue())||!isFinite(y.asValue()))&&y.asValue()!==0){var m=[-h.asValue()/y.asValue(),1/y.asValue()];return{symbol:u,id:c,coefficients:m}}}}}}}function NB(e,t){for(var r in t){var n=t[r].evaluationState,i=n.assignment;if(i===e)return r}}function AB(e){for(var t={},r=0;r<e.length;r++)t[e[r]]=!0;return t}function FI(e,t){var r=AB(e),n={};for(var i in t){var s=t[i].evaluationState.assignment;t[i].evaluationState.is_slidable&&r[s]&&(n[s]=i)}return n}function NR(e,t,r,n){for(var i=[],s=0;s<r.length;s++){var o=r[s],a={};i.push(a);for(var u=0;u<n.length;u++){var c=n[u],l=Object.create(t);l[c]=void 0;var p=o.tryGetConcreteTree(e,l);if(p.isError){a[c]={tree:p,order:1/0};continue}else a[c]={tree:p,order:p.polynomialOrder(c)}}}return i}function AR(e,t,r){for(var n=0;n<e.length;n++){var i=e[n];t[i].order!==0&&(r[i]=!0)}}I.ParenSeq.prototype.getMoveStrategy=function(e,t,r,n,i){if(r.valueType!==N||r.getDependencies().length!==0)return;for(var s=this.getDependencies(),o=FI(s,n),a=Object.keys(o),u=this.args,c=NR(e,t,u,a),l=[],p={},f={},y=0;y<2;y++){var h=u[y];let D=h.getInputSpan();if(h.isConstant){l[y]=D?{type:\"updateCoordinate\",inputSpan:D}:{type:\"none\"};continue}var m=RR(e,h,c[y],o,p,f);m&&(l[y]={type:\"updateSlider\",id:m.id,coefficients:m.coefficients},p[m.symbol]=!0,AR(a,c[y],f)),l[y]||(l[y]={type:\"none\"})}let[b,d]=l,g;if(b.type===\"none\"&&d.type===\"none\"&&a.length===1&&(g=a[0]),!g)return b.type!==\"none\"||d.type!==\"none\"?l:void 0;var x=o[g],M;try{var E=Object.create(t);E[g]=void 0,M=this.getConcreteTree(e,E).getCompiledFunction()}catch(D){return}aP(M);var T=n[x].evaluationState;return[OB({id:x,initialValue:T.constant_value,min:T.slider_min_number,max:T.slider_max_number,compiled:M,hasLinearComponent:b.type===\"updateSlider\"||d.type===\"updateSlider\"}),{type:\"none\"}]};I.FunctionCall.prototype.getMoveStrategy=function(e,t,r,n,i){if(this._symbol===\"glider\"&&!(!r.isTypedConstant||r.valueType!==N)){var s,o,a;switch(this.args[1].type){case\"Constant\":{var u=this.args[1].asValue();if(typeof u!=\"number\"||(s=this.args[0].getConcreteTree(e,t),!s.isTypedConstant))return;a=s.asTypedValue();let h=this.args[1].getInputSpan();return[h?SB({span:h,movesOn:a}):{type:\"none\"},{type:\"none\"}]}case\"Identifier\":{var c=this.args[1]._symbol,l=FI([c],n),p=l[c];if(p===void 0)return;var f=n[p].evaluationState,y=Object.create(t);return y[c]=void 0,s=this.args[0].getConcreteTree(e,y),s.isTypedConstant?(a=s.asTypedValue(),o={min:f.slider_min_number,max:f.slider_max_number},[RB({min:o.min,max:o.max,movesOn:a,sliderId:p}),{type:\"none\"}]):void 0}default:return}}};I.Image.prototype.getMoveStrategy=function(e,t,r,n,i){if(!(r.center.valueType!==N||r.center.getDependencies().length!==0||!r.width.isConstant||!r.height.isConstant||!r.radianAngle.isConstant||!r.opacity.isConstant)){var s=this.getDependencies(),o=FI(s,n),a=Object.keys(o),u=[this.width,this.height];this.center.type===\"ParenSeq\"?u.push(this.center.args[0],this.center.args[1]):this.center.type===\"Identifier\"&&(this.center.referencedStatementId=NB(this.center._symbol,n));for(var c={},l={},p=NR(e,t,u,a),f=[],y=[2,3,0,1],h=0;h<y.length;h++){var m=y[h],b=u[m];if(!b){f[m]={type:\"none\"};continue}if(b.isConstant){let g=b.getInputSpan();f[m]=g?{type:\"updateCoordinate\",inputSpan:g}:{type:\"none\"};continue}var d=RR(e,b,p[m],o,c,l);d&&(f[m]={type:\"updateSlider\",id:d.id,coefficients:d.coefficients},c[d.symbol]=!0,AR(a,p[m],l)),f[m]||(f[m]={type:\"none\"})}if(!(f[0].type===\"none\"&&f[1].type===\"none\"&&f[2].type===\"none\"&&f[3].type===\"none\"))return f}};I.Base.prototype.getDefaultDragMode=function(e){return\"NONE\"};I.Assignment.prototype.getDefaultDragMode=function(e){return e[0].type!==\"none\"&&e[1].type!==\"none\"?\"XY\":e[0].type!==\"none\"?\"X\":e[1].type!==\"none\"?\"Y\":\"NONE\"};I.ParenSeq.prototype.getDefaultDragMode=function(e){return e[0].type===\"updateSlider\"&&e[1].type===\"updateSlider\"?\"XY\":e[0].type===\"updateSlider\"?\"X\":e[1].type===\"updateSlider\"?\"Y\":e[0].type===\"updateSliderNonlinear\"&&e[0].hasLinearComponent?\"X\":\"NONE\"};I.FunctionCall.prototype.getDefaultDragMode=function(e){return this._symbol!==\"glider\"?\"NONE\":I.Assignment.prototype.getDefaultDragMode.call(this,e)};var CB=I.List;I.Base.prototype.tableInfo=function(e,t){return!1};I.Identifier.prototype.tableInfo=function(e,t){return e.validFirstColumnVariable(this._symbol)?{independent_variable:this._symbol,dependent_column:this.getInputString(),by_reference:!1}:!1};I.Expression.prototype.tableInfo=function(e,t){var r=t.getDependencies();if(ca(this))return!1;switch(t.valueType){case N:case nt:if(r.length!==0||t.isMovablePoint&&(t.moveStrategy[0].type===\"updateSlider\"||t.moveStrategy[1].type===\"updateSlider\"))return!1;var n=CB.wrap(t).asValue();return{independent_variable:\"x\",dependent_column:\"y\",by_reference:!1,values:n};case P:if(r.length!==1)return!1;var i=r[0];return e.validFirstColumnVariable(i)?{independent_variable:i,dependent_column:this.getInputString(),by_reference:!1}:!1;default:return!1}};I.Assignment.prototype.tableInfo=function(e,t){if(t instanceof I.SolvedEquation||!this.getInputString().length||ca(this)||rl(t.valueType))return!1;let r=t.getDependencies();if(r.length>1)return!1;let n;if(r.length===0){if(!e.tableableAsConstant(this._symbol))return!1;n=e.implicitIndependent(this._symbol)}else n=r[0];if(!e.validFirstColumnVariable(n))return!1;let i=e.assignmentForbidden(this._symbol)?fo(this.getInputString().replace(/[^=]*=/,\"\")):fo(this.getInputString().split(\"=\")[0]);return{independent_variable:n,dependent_column:i,by_reference:!e.assignmentForbidden(this._symbol)}};I.FunctionDefinition.prototype.tableInfo=function(e,t){if(this._argSymbols.length!==1||!this.getInputString().length)return!1;var r=t.getDependencies();if(r.length>1)return!1;var n=this._argSymbols[0];if(!e.validFirstColumnVariable(n))return!1;var i=e.assignmentForbidden(this._symbol),s=i?fo(this.getInputString().replace(/[^=]*=/,\"\")):fo(this.getInputString().split(\"=\")[0]);return{independent_variable:n,dependent_column:s,by_reference:!i}};I.BaseComparator.prototype.tableInfo=function(e,t){return!1};I.DoubleInequality.prototype.tableInfo=function(e,t){return!1};I.Equation.prototype.tableInfo=function(e,t){return!1};I.Base.prototype.tableError=function(){return this.isInequality()?v(\"shared-calculator-error-table-inequality-supplement\"):!(this instanceof I.Expression)&&!(this instanceof I.IRExpression)?v(\"shared-calculator-error-table-generic-supplement\"):!1};I.List.prototype.tableError=function(){return v(\"shared-calculator-error-table-list-supplement\")};I.Equation.prototype.tableError=I.Assignment.prototype.tableError=function(){return v(\"shared-calculator-error-table-equation-supplement\")};I.FunctionDefinition.prototype.tableError=function(){return v(\"shared-calculator-error-table-function-definition-supplement\")};I.Regression.prototype.tableError=function(){return v(\"shared-calculator-error-table-regression-supplement\")};I.List.prototype.elementAt=function(e){return e=Math.floor(e),e>=0&&e<this.args.length?this.args[e]:new I.Constant(NaN)};I.List.prototype.eachElement=function(t){for(var r=0;r<this.length;r++)t(this.elementAt(r),r)};I.List.prototype.mapElements=function(t){for(var r=[],n=0;n<this.length;n++)r.push(t(this.elementAt(n),n));return r};I.IRExpression.prototype.elementAt=function(e){var t=this._chunk.elementAt(e);return new sr(t)};I.ParenSeq.prototype.elementAt=function(e){return e<0||e>this.args.length-1?new I.Constant(NaN):this.args[e]};function _B(){return Zr(this._symbol)+\" \"}I.Identifier.prototype.printLatex=_B;I.Constant.prototype.printLatex=function(){return _o(this.asValue())};I.Ticker.prototype.printLatex=function(){return\"\\\\ticker\\\\left(\"+this.args.map(Yn).join(\", \")+\"\\\\right)\"};I.Negative.prototype.printLatex=function(){return\"-\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\"};I.Add.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)+\\\\left(\"+this.args[1].printLatex()+\"\\\\right)\"};I.PercentOf.prototype.printLatex=function(){return this.args[0].printLatex()+\" \\\\% \\\\operatorname{of} \"+this.args[1].printLatex()};I.Subtract.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)-\\\\left(\"+this.args[1].printLatex()+\"\\\\right)\"};I.Multiply.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)*\\\\left(\"+this.args[1].printLatex()+\"\\\\right)\"};I.DotMultiply.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\\\\cdot\\\\left(\"+this.args[1].printLatex()+\"\\\\right)\"};I.CrossMultiply.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\\\\times\\\\left(\"+this.args[1].printLatex()+\"\\\\right)\"};I.Divide.prototype.printLatex=function(){return\"\\\\frac{\"+this.args[0].printLatex()+\"}{\"+this.args[1].printLatex()+\"}\"};I.Exponent.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)^{\"+this.args[1].printLatex()+\"}\"};I.Assignment.prototype.printLatex=function(){return Zr(this._symbol)+\"=\"+this._expression.printLatex()};I.CoordinateEquation.prototype.printLatex=function(){return\"\\\\left(\"+this._symbols.map(e=>Zr(e)).join(\",\")+\"\\\\right)=\"+this._expression.printLatex()};I.Equation.prototype.printLatex=function(){return this._lhs.printLatex()+\"=\"+this._rhs.printLatex()};function Gp(e){switch(e){case\">\":return\">\";case\"<\":return\"<\";case\">=\":return\"\\\\ge \";case\"<=\":return\"\\\\le \";case\"=\":return\"=\"}return\"\"}I.BaseComparator.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\"+Gp(this.operator)+\"\\\\left(\"+this.args[1].printLatex()+\"\\\\right)\"};I.DoubleInequality.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\"+Gp(this.args[1])+this.args[2].printLatex()+Gp(this.args[3])+\"\\\\left(\"+this.args[4].printLatex()+\"\\\\right)\"};I.And.prototype.printLatex=function(){if(!(this.args[0]instanceof I.BaseComparator)||!(this.args[1]instanceof I.BaseComparator))throw new Error(\"Not implemented\");if(this.args[0].args[1].printLatex()!==this.args[1].args[0].printLatex())throw new Error(\"Not implemented\");return\"\\\\left(\"+this.args[0].args[0].printLatex()+\"\\\\right)\"+Gp(this.args[0].operator)+\"\\\\left(\"+this.args[0].args[1].printLatex()+\"\\\\right)\"+Gp(this.args[1].operator)+\"\\\\left(\"+this.args[1].args[1].printLatex()+\"\\\\right)\"};function Yn(e){return e.printLatex()}function LB(){switch(this._symbol){case\"sqrt\":return\"\\\\sqrt{\"+this.args[0].printLatex()+\"}\";case\"nthroot\":return\"\\\\sqrt[\"+this.args[1].printLatex()+\"]{\"+this.args[0].printLatex()+\"}\";case\"logbase\":return\"\\\\log_{\"+this.args[1].printLatex()+\"}\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\";default:return Zr(this._symbol)+\"\\\\left(\"+this.args.map(Yn).join(\", \")+\"\\\\right)\"}}I.FunctionCall.prototype.printLatex=LB;I.SeededFunctionCall.prototype.printLatex=function(){return Zr(this._symbol)+\"\\\\left(\"+this.args.slice(1).map(Yn).join(\", \")+\"\\\\right)\"};I.DotAccess.prototype.printLatex=function(){return\"(\"+this.args[0].printLatex()+\").(\"+this.args[1].printLatex()+\")\"};I.Prime.prototype.printLatex=function(){switch(this.args[0]._symbol){case\"logbase\":return\"\\\\log_{\"+this.args[0].args[1].printLatex()+\"}\"+Array(this.order+1).join(\"'\")+\"\\\\left(\"+this.args[0].args[0].printLatex()+\"\\\\right)\";default:return Zr(this.args[0]._symbol)+Array(this.order+1).join(\"'\")+\"\\\\left(\"+this.args[0].args.map(Yn).join(\", \")+\"\\\\right)\"}};I.List.prototype.printLatex=function(){return\"\\\\left[\"+this.args.map(Yn).join(\", \")+\"\\\\right]\"};I.Range.prototype.printLatex=function(){return\"\\\\left[\"+this.args[0].args.map(Yn).join(\", \")+\" ... \"+this.args[1].args.map(Yn).join(\", \")+\"\\\\right]\"};I.UpdateRule.prototype.printLatex=function(){return this.args[0].printLatex()+\"\\\\to(\"+this.args[1].printLatex()+\")\"};I.ListAccess.prototype.printLatex=function(){return\"\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\\\\left[\"+this.args[1].printLatex()+\"\\\\right]\"};I.ParenSeq.prototype.printLatex=function(){return\"\\\\left(\"+this.args.map(Yn).join(\", \")+\"\\\\right)\"};I.BareSeq.prototype.printLatex=function(){return this.args.map(Yn).join(\", \")};I.NamedCoordinateAccess.prototype.printLatex=function(){return\"\\\\left(\\\\left(\"+this.args[0].printLatex()+\"\\\\right).\"+this.symbol+\"\\\\right)\"};I.Norm.prototype.printLatex=function(){return\"\\\\left|\"+this.args[0].printLatex()+\"\\\\right|\"};I.Sum.prototype.printLatex=function(){return\"\\\\sum_{\"+this.args[0].printLatex()+\"=\"+this.args[1].printLatex()+\"}^{\"+this.args[2].printLatex()+\"}\\\\left(\"+this.args[3].printLatex()+\"\\\\right)\"};I.Product.prototype.printLatex=function(){return\"\\\\prod_{\"+this.args[0].printLatex()+\"=\"+this.args[1].printLatex()+\"}^{\"+this.args[2].printLatex()+\"}\\\\left(\"+this.args[3].printLatex()+\"\\\\right)\"};I.Integral.prototype.printLatex=function(){return\"\\\\int_{\"+this.args[1].printLatex()+\"}^{\"+this.args[2].printLatex()+\"}\\\\left(\"+this.args[3].printLatex()+\"\\\\right)d\"+this.args[0].printLatex()};I.FunctionExponent.prototype.printLatex=function(){return this.args[0].printLatex()+\"\\\\left(\"+this.args[1].printLatex()+\"\\\\right)^{\"+this.args[2].printLatex()+\"}\"};I.FunctionFactorial.prototype.printLatex=function(){return this.args[0].printLatex()+\"\\\\left(\"+this.args[1].printLatex()+\"\\\\right)!\"};function CR(e){return e.isConstant&&e.asValue()===!0}function wB(e){return e.isConstant&&e.isNaN()}I.Piecewise.prototype.printLatex=function(){var e=this;if(CR(e.args[0]))return e.args[1].printLatex();for(var t=[\"\\\\left\\\\{\"];;){if(CR(e.args[0])){t.push(e.args[1].printLatex());break}if(t.push(e.args[0].printLatex(),\": \"),wB(e.args[2])){t.push(e.args[1].printLatex());break}if(t.push(e.args[1].printLatex(),\", \"),!(e.args[2]instanceof I.Piecewise)){t.push(e.args[2].printLatex());break}e=e.args[2]}return t.push(\"\\\\right\\\\}\"),t.join(\"\")};I.FunctionDefinition.prototype.printLatex=function(){return Zr(this._symbol)+\"\\\\left(\"+this._argSymbols.map(Zr).join(\", \")+\"\\\\right) = \"+this._expression.printLatex()};I.Derivative.prototype.printLatex=function(){return\"\\\\frac{d}{d\"+Zr(this._symbol)+\"}\\\\left(\"+this.args[0].printLatex()+\"\\\\right)\"};I.Regression.prototype.printLatex=function(){return\"\\\\left(\"+this._lhs.printLatex()+\"\\\\right)\\\\sim\\\\left(\"+this._rhs.printLatex()+\"\\\\right)\"};I.Histogram.prototype.printLatex=function(){return\"\\\\histogram\\\\left(\"+this.args.map(Yn).join(\", \")+\"\\\\right)\"};I.DotPlot.prototype.printLatex=function(){return\"\\\\dotplot\\\\left(\"+this.args.map(Yn).join(\", \")+\"\\\\right)\"};I.BoxPlot.prototype.printLatex=function(){return\"\\\\boxplot\\\\left(\"+this.args.map(Yn).join(\", \")+\"\\\\right)\"};I.TTest.prototype.printLatex=function(){return\"\\\\TTest\\\\left(\"+this.args.map(Yn).join(\", \")+\"\\\\right)\"};I.IndependentTTest.prototype.printLatex=function(){return\"\\\\IndependentTTest\\\\left(\"+this.args.map(Yn).join(\", \")+\"\\\\right)\"};I.Stats.prototype.printLatex=function(){return\"\\\\Stats\\\\left(\"+this.args.map(Yn).join(\", \")+\"\\\\right)\"};I.AssignmentExpression.prototype.printLatex=function(){return Zr(this._symbol)+\"=\"+this.args[1].printLatex()};I.ListComprehension.prototype.printLatex=function(){return\"\\\\left[\"+this._body.printLatex()+\"\\\\operatorname{for}\"+this._inputLists.map(Yn).join(\", \")+\"\\\\right]\"};I.Substitution.prototype.printLatex=function(){return\"\\\\left(\\\\left(\"+this._body.printLatex()+\"\\\\right)\\\\operatorname{with}\"+this._assignments.map(Yn).join(\", \")+\"\\\\right)\"};I.Construction.prototype.printLatex=function(){return\"\\\\construction \"};I.Base.prototype.getExpressionType=function(e,t){switch(e){case 114:case 115:case 116:return t&&j(t)?\"POINT3D_LIST\":\"POINT3D\";case 100:case 101:case 102:case 128:return\"CURVE3D_xyz_t\";case 119:return\"SEGMENT3D\";case 129:return\"VECTOR3D\";case 130:case 103:case 104:case 105:return\"SURFACE_xyz_uv\";case 110:return\"SURFACE_r_\\u03B8z\";case 124:return\"SURFACE_r_\\u03B8z_AMBIGUOUS\";case 109:return\"SURFACE_z_r\\u03B8\";case 111:return\"SURFACE_r_\\u03B8\\u03C6\";case 125:return\"SURFACE_r_\\u03B8\\u03C6_AMBIGUOUS\";case 107:case 108:case 106:return\"SURFACE\";case 118:return\"SPHERE3D\";case 117:return\"TRIANGLE3D\";case 120:case 121:return\"SURFACE_AMBIGUOUS\";case 122:case 123:return\"SURFACE_CONSTANT_AMBIGUOUS\";case 112:case 113:case 210:return\"IMPLICIT_SURFACE\";case 126:case 127:return\"IMPLICIT_SURFACE_AMBIGUOUS\";case 3:case 4:return t&&j(t)?\"POINT_LIST\":\"SINGLE_POINT\";case 1:case 2:return\"X_OR_Y\";case 5:return\"PARAMETRIC\";case 6:return\"POLAR\";case 8:return\"IMPLICIT\";case 200:case 201:case 202:case 205:case 209:return\"SLICE\";case 211:case 206:return\"SLICE_r\\u03B8z_at_z\";case 203:return\"SLICE_zr\\u03B8_at_r\";case 204:return\"SLICE_zr\\u03B8_at_\\u03B8\";case 213:return\"SLICE_zr\\u03B8_at_xyz\";case 207:return\"SLICE_r\\u03B8\\u03C6_at_\\u03B8\";case 208:return\"SLICE_r\\u03B8\\u03C6_at_\\u03C6\";case 212:return\"SLICE_r\\u03B8\\u03C6_at_xyz\";case 214:case 215:return\"SLICE_xyz_uv\";default:return t!==void 0&&ie(t,we)?\"POLYGON\":\"X_OR_Y\"}};I.Histogram.prototype.getExpressionType=function(e,t){return\"HISTOGRAM\"};I.DotPlot.prototype.getExpressionType=function(e,t){return\"DOTPLOT\"};I.BoxPlot.prototype.getExpressionType=function(e,t){return\"BOXPLOT\"};function VI(e,t,r){let n=[],i={},s={},o={},a={},u={},c={},l={},p=0,f=[],y=[];if(!r){r=[];for(let d in t)t.hasOwnProperty(d)&&r.push(d)}for(let d in t){if(!t.hasOwnProperty(d))continue;let g=t[d].exportPenalty||0;for(;n.length<g+1;)n.push([]);n[g].push(d)}for(let d of n){let g={};for(let x of d){let M=t[x],E=t[x].exportPenalty||0,T=hs(M),D=M.getLegalExports(e);for(let S of D)Xe[S]||i[S]||(T&&(u[S]=!0),E===0&&(a[S]=!0),g[S]=g[S]||[],g[S].push(x),g[S].length>1&&(!s[S]&&T&&(o[S]=!0),s[S]=!0))}for(let x in g)o[x]||(i[x]=g[x])}for(let d of r)l.hasOwnProperty(d)||h(d);function h(d){l[d]=l[d]||{};let g=l[d],x;g.id=d,g.index=p,g.lowlink=p,f.push(g),g.instack=!0,p++;let M=t[d].getDependencies();for(let E of M){if(!i.hasOwnProperty(E))continue;let T=i[E];for(let D of T)l.hasOwnProperty(D)?(x=l[D],x.instack&&(g.lowlink=Math.min(g.lowlink,x.index))):(h(D),x=l[D],g.lowlink=Math.min(g.lowlink,x.lowlink))}if(g.lowlink===g.index)if(x=f.pop(),x.instack=!1,x===g)m(g);else{let E=[x];for(;x=f.pop(),x.instack=!1,E.push(x),x!==g;);b(E)}}function m(d){y.push(d.id)}function b(d){let g=[];for(let x=d.length-1;x>=0;x--){let M=d[x],E=t[M.id].getLegalExports(e);Array.prototype.push.apply(g,E),g.push(E[0]),y.push(M.id)}g=cl(g),g.sort();for(let x of g)c[x]=g}return{resolved:y,globallyDefined:a,tableDefined:u,multiplyDefined:s,multiplyDefinedByTables:o,cyclicallyDefined:c}}var FB=100;function Zy(e){for(var t=[],r=0;r<e;r++)t[r]={x:[],y:[],intersects:[]};return t}function VB(e,t,r,n){return r===1&&n===1||r===2&&n===2?function(i){return t(i)-e(i)}:r===1&&n===2||r===2&&n===1?function(i){return i-t(e(i))}:!1}function LR(e,t){t instanceof I.SolvedEquation?t=t._expression:t instanceof I.OptimizedRegression&&(t=t.model);var r=[],n=[];return t instanceof I.DoubleInequality?I.List.eachArgs(t._expressions,function(i){r.push(i[0].getCompiledFunction()),n.push(i[0].isConstant&&i[1].isNaN()),r.push(i[1].getCompiledFunction()),n.push(i[1].isConstant&&i[1].isNaN())}):I.List.wrap(t).eachElement(function(i){r.push(i.getCompiledFunction()),n.push(i.isConstant&&i.isNaN())}),{functions:r,skipIntersecting:n}}function BB(e,t){var r=[];for(var n in e)if(e.hasOwnProperty(n)&&String(n)!==String(t)&&e[n].shouldIntersect()){var i=e[n],s=LR(i.policy,i.concreteTree);r.push({id:n,graphMode:i.getGraphMode(),functions:s.functions,skipIntersecting:s.skipIntersecting})}return r}function GB(e,t){e.intersects=Array(e.x.length);for(var r=0;r<e.x.length;r++)e.intersects[r]=t}function zB(e,t){if(t===1){var r=e.y;e.y=e.x,e.x=r}}function HB(e,t){Array.prototype.push.apply(e.x,t.x),Array.prototype.push.apply(e.y,t.y),e.intersects&&t.intersects&&Array.prototype.push.apply(e.intersects,t.intersects)}function UB(e,t,r){var n=WT(e,t),i=n.poi.zeros,s=n.poi.extrema,o=[],a=0,u=0;for(a=0;a<i.x.length;a++){for(;u<s.x.length&&s.x[u]<i.x[a];u++)Ln(s.y[u],0)&&o.push(s.x[u]);o.push(i.x[a])}for(;u<s.x.length;u++)Ln(s.y[u],0)&&o.push(s.x[u]);return{x:o,y:o.map(r)}}function wR(e,t,r){var n=e[r],i=n.getGraphInfo(),s=n.getGraphMode(),o,a,u;try{o=LR(n.policy,n.concreteTree),a=Zy(o.functions.length),u=BB(e,r)}catch(x){return Zy(0)}if(!u)return a;for(var c=0,l=0;l<u.length;l++)for(var p=u[l],f=0;f<o.functions.length;f++)if(!o.skipIntersecting[f]){for(var y=o.functions[f].fn,h=jc(t,i,y),m=0;m<p.functions.length;m++)if(!u[l].skipIntersecting[m]){var b=p.functions[m].fn,d=VB(y,b,s,p.graphMode);if(d){var g;try{g=UB(d,h,y)}catch(x){return Zy(0)}if(c+=g.x.length,c>FB)return Zy(o.functions.length);GB(g,p.id),zB(g,s),HB(a[f],g)}}}return a}function kB(e){if(e.length<2)return\"text\";let t=e.split(\"`\").length-1;return t<2?\"text\":t===2&&e[0]===\"`\"&&e[e.length-1]===\"`\"?\"latex\":\"mixed\"}function qB(e){if(e.length===0)return[\"\"];let t=[],r=e.split(/(`)/),n=!1,i=\"\";for(let s=0;s<r.length;s++){let o=r[s];o.length&&(o===\"`\"?(i+=\"`\",n=!n,n||(t.push(i),i=\"\")):(i+=o,n||(t.push(i),i=\"\")))}return i.length&&t.push(i),t}function BI(e){return qB(e).map(YB)}function YB(e){let r=\"\\\\$({\"+[\"[a-zA-Z][0-9]*\",\"[a-zA-Z]_[a-zA-Z0-9]+\",\"[a-zA-Z]_\\\\{[a-zA-Z0-9]+\\\\}\",\"\\\\\\\\[a-zA-Z]+\",\"\\\\\\\\[a-zA-Z]+_{[a-zA-Z0-9]+}\",\"\\\\\\\\[a-zA-Z]+_[a-zA-Z0-9]+\"].join(\"})|\\\\$({\")+\"})\",n=new RegExp(r,\"g\"),i=[],s=0,o=0,a;for(;a=n.exec(e);){o=a.index,o>s&&i.push(e.substr(s,o-s));let u=a[0],c=u.replace(/[{}\\$]/g,\"\").replace(/^([a-zA-Z])([0-9]+)$/,\"$1_$2\");i.push({symbol:c,str:u}),s=a.index+u.length}return s<e.length&&i.push(e.substr(s)),{raw:e,parts:i}}function FR(e,t){return t?\"{\"+yg(e,{bigCutoff:1e7,digits:8})+\"}\":mg(e,{bigCutoff:1e7,digits:8})}function GI(e,t,r){return e.map(n=>XB(n,t,r)).join(\"\")}function XB(e,t,r){let n=[],i=kB(e.raw)===\"latex\";for(let s of e.parts)if(typeof s==\"string\")n.push(s);else{let o=new I.Identifier(s.symbol).tryGetConcreteTree(_P,t);if(o.valueType===P&&o.getDependencies().length===0){let a=o.asValue();if(typeof a==\"number\"){n.push(FR(a,i));continue}}else if(o.valueType===te&&r<o.length&&o.getDependencies().length===0){let a=o.elementAt(r).asValue();if(typeof a==\"number\"){n.push(FR(a,i));continue}}i?n.push(\"{?}\"):n.push(\"?\")}return n.join(\"\")}function VR(){let e={},t={},r={},n=[];for(let i in this.statements){if(!this.statements.hasOwnProperty(i))continue;let s=this.statements[i];if(!(s.type===\"Construction\"&&!this.policy.isGeometryEnabled()))switch(s.type){case\"Error\":break;case\"Regression\":{r[i]=[],n.push(i);break}default:{let o=s.getLegalExports(this.policy);if(o){for(let u of o)s.exportPenalty!==void 0&&s.exportPenalty>0?t[u]=i:e[u]=i;let a=[];for(let u of s.getDependencies())a.push(u);r[i]=cg(a,s.getDummyDependencies(),o)}break}}}for(let i of n){let s=this.statements[i],o=po(s.userData.residualVariable);o&&(t[o]=i);let a=s.getDependencies().slice(),u={},c;for(;c=a.pop();){if(u[c])continue;u[c]=!0;let l=e[c]||t[c];if(l){a.push(...r[l]),r[i].push(c);continue}t[c]=i}}return{exportMap:e,weakExportMap:t,dependencyMap:r}}var zp=class{constructor(){this.data={}}getChildIntersections(t){return this.data[t]||{count:0}}addListParent(t,r,n){if(il(n.valueType,[N,nt]),r!==void 0)n.valueType===nt?this.addPoint(t,r,n.value[r]):this.addPoint(t,r,n.value);else{il(n.valueType,[nt]);for(let i=0;i<n.value.length;i++)this.addPoint(t,i,n.value[i])}}addPrimitiveParent(t,r){if(il(r.valueType,[N,nt]),r.valueType===N)this.addPoint(t,0,r.value);else for(let n=0;n<r.value.length;n++)this.addPoint(t,0,r.value[n])}addPoint(t,r,n){var s;let i=this.data[t]||{count:0};this.data[t]||(this.data[t]=i),i[r]||(i[r]=[]),(s=i[r])==null||s.push(n),i.count++}};var Hp=class{constructor(t){this.singleExpression=t.singleExpression}isGeometryEnabled(){return!1}is3dProduct(){return!1}is3dPolicy(){return!1}isBeta3d(){return!1}areAllScalesLinear(){return!0}assignmentForbidden(t){return this.substitutionForbidden(t)}substitutionForbidden(t){return t.slice(0,3)!==\"ans\"}isValidSlider(t){return!1}sliderVariables(){return[]}graphingEnabled(){return!1}ansEnabled(){return!this.singleExpression}dimensionVarsEnabled(){return!1}disabledFeatures(){return[\"Sum\",\"Product\",\"Integral\",\"List\",\"Derivative\",\"Piecewise\",\"Exponent\",\"PercentOf\",\"Substitution\"]}};var Up=class{constructor(t){this.singleExpression=t.singleExpression}isGeometryEnabled(){return!1}is3dProduct(){return!1}is3dPolicy(){return!1}isBeta3d(){return!1}areAllScalesLinear(){return!0}assignmentForbidden(t){return this.substitutionForbidden(t)}substitutionForbidden(t){return this.singleExpression?t.slice(0,3)!==\"ans\":t.slice(0,3)===\"tmp\"}isValidSlider(t){return!1}sliderVariables(){return[]}graphingEnabled(){return!1}ansEnabled(){return!this.singleExpression}dimensionVarsEnabled(){return!1}disabledFeatures(){return this.singleExpression?[\"Sum\",\"Product\",\"Integral\",\"Derivative\",\"Piecewise\",\"Substitution\",\"PercentOf\"]:[\"Sum\",\"Product\",\"Integral\",\"Derivative\",\"Piecewise\",\"Substitution\"]}};var ma=typeof performance!=\"undefined\"?()=>performance.now():()=>Date.now();typeof self!=\"undefined\"&&self.WorkerGlobalScope&&(self.Fragile={countReferences:Am,Opcodes:St,Types:Fe,getConstantListLength:lr,ParsenodeError:R});var{Constant:no,Seed:GR,FunctionCall:nG,Image:iG,Slider:sG,Table:oG,TableColumn:aG,Construction:uG}=I;function cG(e,t,r,n){switch(e){case\"fourFunction\":return new Hp({singleExpression:!1});case\"singleExpressionFourFunction\":return new Hp({singleExpression:!0});case\"scientific\":return new Up({singleExpression:!1});case\"singleExpressionScientific\":return new Up({singleExpression:!0});case\"graphing\":return new Jc({enableGeometry:!1,enable3d:t,beta3d:r,scales:n});case\"geometry\":return new Jc({enableGeometry:!0,enable3d:!1,beta3d:!1,scales:n});case\"graphing_3d\":return new Ly(r)}}var lG={fourFunction:pf,singleExpressionFourFunction:pf,scientific:Eg,singleExpressionScientific:Mg,graphing:dl,graphing_3d:dl,geometry:dl},to=\"**geo_construction_statement_id**\";function ai(e,t){var r=ys(e,t);return r.isError||r instanceof I.Expression?r:yl()}function pG(e){let t=e.rawTree.userData,r=e.rawTree.metaData;return!!(t.cdf&&t.cdf.show&&r.distributionSpec)}function fG(e){let t=e.evaluationState.expression_type,r=e.rawTree.userData;return!r.clickableInfo||!r.clickableInfo.enabled?!1:iy(e.rawTree)?!0:e.getGraphMode()===4?!1:RO(t)}function ir(e,t){let r=\"id\"+e;for(let[n,i]of t||[])r+=\"::\"+n+i;return r}var dG=new no(Ce(0,1)),mG=new no(Ce(1,1)),yG=new no(NaN);function ro(e,t){return e?e===\"0\"?dG:e===\"1\"?mG:ai(e,t):yG}function ru(e,t){if(e)return ai(e,t)}function gG(e){return e.slice(0,3)!==\"ans\"}function hG(e){return e.slice(0,6)!==\"idref_\"}function zR(e,t){let{multiplyDefined:r,multiplyDefinedByTables:n,cyclicallyDefined:i}=e;for(let s in i){if(!i.hasOwnProperty(s))continue;let o=e.tableDefined[s]&&!e.globallyDefined[s],a=i[s].filter(gG).filter(hG);t[s]=o?tb(a):od(a)}for(let s in r)r.hasOwnProperty(s)&&(t[s]=n[s]?eb(s):xc(s))}function qp(e,t,r){for(let n of r)e[n]||(e[n]=[]),e[n].push(t)}function HR(e,t,r){if(r.extraDepNodes)for(let n of r.extraDepNodes)n&&qp(e,t,n.getDependencies());r.clickHandler&&qp(e,t,r.clickHandler.getDependencies())}function bG(e,t,r){let n=e.evaluationState,i=e.rawTree,s=i.metaData.cdfMin,o=i.metaData.cdfMax,a={},u=i.type===\"Assignment\"?i._expression:i,c=u&&u.metaData&&u.metaData.distributionSpec,l=Uo(t,r,s,a,-1/0),p=Uo(t,r,o,a,1/0),f=!0,y=!0;if(isNaN(l)&&(f=!1,l=NaN),isNaN(p)&&(y=!1,p=NaN),f?y?l>p&&(f=!1,y=!1,n.error=db().getError()):n.error=fb().getError():n.error=pb().getError(),f&&y){let b=new nG(\"cdf\",[u,new no(l),new no(p)]);n.cdf_evaluation=+b.tryGetConcreteTree(t,r).asValue()}let h=-1/0,m=1/0;if(c&&(c.discrete&&(h=0),c.symbol===\"binomialdist\"&&u.args&&u.args[0])){let b=+u.args[0].asValue();isFinite(b)&&(m=b)}i.metaData.evaluatedCDFMin=l,i.metaData.evaluatedCDFMax=p,n.cdf_min_valid=f,n.cdf_max_valid=y,n.cdf_min_default=h,n.cdf_max_default=m,n.is_single_identifier=!1,Ka(n,t,a)}function xG(e,t,r,n){let i={},s=!0,o=NaN,a,u=!1;if(r){let c=r.tryGetConcreteTree(e,t);a=c.getDependencies().length===0?c.asValue():NaN,u=Array.isArray(a),o=u?a:+a;for(let l of c.getDependencies())i[l]=!0}if(u){for(let c of o)if(!isFinite(+c)){s=!1,o=NaN;break}}else isFinite(+o)||(s=!1,o=NaN);return r||(s=!0,n!==void 0&&(o=n)),{value:o,valid:s,missingVarsMap:i}}var kp={lineWidth:{parseNode:\"lineWidth\",valueOutputProp:\"computedLineWidth\",formulaOutputProp:\"\",validOutputProp:\"line_width_valid\",default:(e,t,r,n)=>{let i=r.isGeometryEnabled(),s=r.is3dPolicy(),o=n!==void 0&&ie(n,we);return i&&o?2:s?1:2.5},transform:void 0,shouldEvaluate:void 0,seed:\"lw\"},resolution:{parseNode:\"resolution\",valueOutputProp:\"computedResolution\",formulaOutputProp:\"\",validOutputProp:\"resolution_valid\",default:()=>{},transform:void 0,shouldEvaluate:void 0,seed:\"re\"},checkers:{parseNode:\"checkers\",valueOutputProp:\"computedCheckers\",formulaOutputProp:\"\",validOutputProp:\"checkers_valid\",default:()=>pa,transform:void 0,shouldEvaluate:void 0,seed:\"ch\"},lineOpacity:{parseNode:\"lineOpacity\",valueOutputProp:\"computedLineOpacity\",formulaOutputProp:\"\",validOutputProp:\"line_opacity_valid\",default:(e,t,r,n)=>{let i=r.isGeometryEnabled(),s=n!==void 0&&ie(n,we);return i&&s?.6:.9},transform:void 0,shouldEvaluate:void 0,seed:\"lo\"},pointOpacity:{parseNode:\"pointOpacity\",valueOutputProp:\"computedPointOpacity\",formulaOutputProp:\"\",validOutputProp:\"point_opacity_valid\",default:(e,t,r)=>!e||!t?.9:e.getGraphMode(r,t)===4?1:.9,transform:void 0,shouldEvaluate:void 0,seed:\"po\"},pointSize:{parseNode:\"pointSize\",valueOutputProp:\"computedPointSize\",formulaOutputProp:\"\",validOutputProp:\"point_size_valid\",default:(e,t,r)=>r.is3dProduct()?3:9,shouldEvaluate:void 0,transform:void 0,seed:\"ps\"},fillOpacity:{parseNode:\"fillOpacity\",valueOutputProp:\"computedFillOpacity\",formulaOutputProp:\"\",validOutputProp:\"fill_opacity_valid\",default:(e,t,r,n)=>{let i=r.isGeometryEnabled(),s=n!==void 0&&ie(n,we);return i&&s?.2:r.is3dProduct()?1:.4},transform:void 0,shouldEvaluate:e=>{if(!e)return!1;let{expression_type:t,is_inequality:r}=e.evaluationState;return!!(t===\"POLYGON\"||t===\"PARAMETRIC\"||t===\"CURVE3D_xyz_t\"||t===\"SURFACE\"||t===\"SPHERE3D\"||t===\"SURFACE_AMBIGUOUS\"||t===\"SURFACE_CONSTANT_AMBIGUOUS\"||t===\"IMPLICIT_SURFACE\"||t===\"IMPLICIT_SURFACE_AMBIGUOUS\"||t===\"SURFACE_xyz_uv\"||t===\"SURFACE_z_r\\u03B8\"||t===\"SURFACE_r_\\u03B8z\"||t===\"SURFACE_r_\\u03B8\\u03C6\"||t===\"SURFACE_r_\\u03B8z_AMBIGUOUS\"||t===\"SURFACE_r_\\u03B8\\u03C6_AMBIGUOUS\"||t===\"TRIANGLE3D\"||r)},seed:\"fo\"},labelSize:{parseNode:\"labelSize\",valueOutputProp:\"computedLabelSize\",formulaOutputProp:\"\",validOutputProp:\"label_size_valid\",transform:void 0,default:()=>1,shouldEvaluate:void 0,seed:\"ls\"},labelAngle:{parseNode:\"labelAngle\",valueOutputProp:\"computedLabelAngle\",formulaOutputProp:\"label_angle_value\",validOutputProp:\"label_angle_valid\",default:()=>0,transform:e=>`-\\\\trigAngleMultiplier*(${e})`,shouldEvaluate:void 0,seed:\"la\"}};function UR(e,t,r,n,i,s,o){let a=kp[s],u;e&&(u=e.tryGetConcreteTree(n,i));let c=a.default&&a.default(e,u,n,o),l=xG(n,i,r[a.parseNode],c);r[a.valueOutputProp]=l.value,a.formulaOutputProp&&(t[a.formulaOutputProp]=l.value),t[a.validOutputProp]=l.valid,Ka(t,n,l.missingVarsMap)}function PG(e,t,r,n){let i,s,o;if(hs(e.rawTree)&&e.evaluationState.column_data&&e.rawTree.columns)for(let a=0;a<e.evaluationState.column_data.length;a++){i=e.evaluationState.column_data[a];let u=e.rawTree.columns[a];Ys(u)||(s=u.header.metaData,o=s[n],UR(o,i,s,t,r,n,e.concreteTree.valueType))}else i=e.evaluationState,s=e.rawTree.metaData,o=s[n],UR(o,i,s,t,r,n,e.concreteTree.valueType)}function kR(e){return Su(e[0],e[1],e[2]).formatHex()}function qR(e,t,r,n,i){let s;if(e){let o=e.tryGetConcreteTree(n,i),a=o.getDependencies().length>0?void 0:o.asValue(),{valueType:u}=o;if(s=!!(a&&(u===It||u===Vr)),s){let c=o&&o.valueType===It?kR(a):a.map(kR);t.colorLatexValue=c,r.color_latex_value=c}else delete t.colorLatexValue,delete r.color_latex_value}else s=!0;r.color_latex_valid=s}function TG(e,t,r){let n,i,s;if(hs(e.rawTree)&&e.evaluationState.column_data&&e.rawTree.columns)for(let o=0;o<e.evaluationState.column_data.length;o++){n=e.evaluationState.column_data[o];let a=e.rawTree.columns[o];Ys(a)||(i=a.header.metaData,s=i.colorLatex,qR(s,i,n,t,r))}else n=e.evaluationState,i=e.rawTree.metaData,s=i.colorLatex,qR(s,i,n,t,r)}function IG(e){if(e.concreteTree.valueType===It&&e.concreteTree.getDependencies().length>0){let t=e.concreteTree._chunk;try{e.evaluationState.shader=Oo(t)}catch(r){e.evaluationState.error=r instanceof I.Error?r.getError():ne(r).getError()}}}function EG(e,t,r){let n=e.evaluationState,i=e.rawTree,s={},o=i.metaData.clickHandler;if(!o)return;let a=o.tryGetConcreteTree(t,r);!a.isError&&a.valueType!==Je&&(a=Il(pe(a.valueType)));for(let c of a.getDependencies())t.validActionVariable(c)||(s[c]=!0);let u=Object.keys(s);u.length>0&&(a=jt(u).setDependencies(a.getDependencies())),a.isError&&!gI(t,a)?n.click_handler={status:\"error\",error:a.getError()}:a.isEmptyAction?n.click_handler={status:\"empty\"}:n.click_handler={status:\"maybe-valid\"},Ka(n,t,s)}function MG(e,t,r){let n=e.evaluationState,i=e.rawTree,s=n.expression_type===\"POLAR\"||n.expression_type===\"SURFACE_r_\\u03B8z\"||n.expression_type===\"SURFACE_r_\\u03B8z_AMBIGUOUS\"||n.expression_type===\"SLICE_r\\u03B8z_at_z\"?i.metaData.polarDomainMin:i.metaData.parametricDomainMin,o=n.expression_type===\"POLAR\"||n.expression_type===\"SURFACE_r_\\u03B8z\"||n.expression_type===\"SURFACE_r_\\u03B8z_AMBIGUOUS\"||n.expression_type===\"SLICE_r\\u03B8z_at_z\"?i.metaData.polarDomainMax:i.metaData.parametricDomainMax,a={},u=!!(s||o),c=Uo(t,r,s,a,0),l=NaN;o?l=Uo(t,r,o,a,NaN):n.expression_type===\"PARAMETRIC\"||n.expression_type===\"CURVE3D_xyz_t\"?l=1:n.expression_type===\"POLAR\"?l=Math.PI*12/+r.trigAngleMultiplier.asValue():(n.expression_type===\"SURFACE_r_\\u03B8z\"||n.expression_type===\"SURFACE_r_\\u03B8z_AMBIGUOUS\"||n.expression_type===\"SLICE_r\\u03B8z_at_z\")&&(l=Math.PI*2/+r.trigAngleMultiplier.asValue());let p=UI(c,l,n);({min:c,max:l}=p),i.metaData.evaluatedDomainMin=c,i.metaData.evaluatedDomainMax=l,(n.expression_type===\"POLAR\"||n.expression_type===\"SURFACE_r_\\u03B8z\"||n.expression_type===\"SURFACE_r_\\u03B8z_AMBIGUOUS\"||n.expression_type===\"SLICE_r\\u03B8z_at_z\")&&(i.metaData.isExplicitDomain=u),n.domain_min_number=c,n.domain_max_number=l,n.domain_min_valid=p.minValid,n.domain_max_valid=p.maxValid,n.expression_type===\"PARAMETRIC\"&&delete a.t,n.expression_type===\"CURVE3D_xyz_t\"&&(delete a.t,delete a.u,delete a.v),Ka(n,t,a)}function DG(e,t,r){let n=e.evaluationState,i=n.expression_type,s=e.rawTree,o=s.metaData.parametricDomain3DuMin,a=s.metaData.parametricDomain3DuMax,u=s.metaData.parametricDomain3DvMin,c=s.metaData.parametricDomain3DvMax,l={},p=0,f=1,y=0,h=1;i===\"SURFACE_r_\\u03B8\\u03C6\"||i===\"SURFACE_r_\\u03B8\\u03C6_AMBIGUOUS\"||i===\"SLICE_r\\u03B8\\u03C6_at_\\u03B8\"||i===\"SLICE_r\\u03B8\\u03C6_at_\\u03C6\"||i===\"SLICE_r\\u03B8\\u03C6_at_xyz\"?(f=2*Math.PI/+r.trigAngleMultiplier.asValue(),h=Math.PI/+r.trigAngleMultiplier.asValue()):(i===\"SURFACE_z_r\\u03B8\"||i===\"SLICE_zr\\u03B8_at_r\"||i===\"SLICE_zr\\u03B8_at_\\u03B8\"||i===\"SLICE_zr\\u03B8_at_xyz\")&&(f=jr.xmax,h=2*Math.PI/+r.trigAngleMultiplier.asValue()),p=Uo(t,r,o,l,p),f=Uo(t,r,a,l,f),y=Uo(t,r,u,l,y),h=Uo(t,r,c,l,h);let m=UI(p,f,n);({min:p,max:f}=m);let b=UI(y,h,n);({min:y,max:h}=b),s.metaData.evaluatedDomain3DuMin=p,s.metaData.evaluatedDomain3DuMax=f,s.metaData.evaluatedDomain3DvMin=y,s.metaData.evaluatedDomain3DvMax=h,n.domain_min_u_valid=m.minValid,n.domain_max_u_valid=m.maxValid,n.domain_min_v_valid=b.minValid,n.domain_max_v_valid=b.maxValid,(n.expression_type===\"SURFACE_xyz_uv\"||n.expression_type===\"SLICE_xyz_uv\")&&(delete l.u,delete l.v),Ka(n,t,l)}function Uo(e,t,r,n,i){if(r){let s=r.tryGetConcreteTree(e,t);for(let o of s.getDependencies())n[o]=!0;return s.isConstant?+s.asValue():NaN}else return i}function UI(e,t,r){let n=!0,i=!0;return isFinite(e)||(n=!1,e=NaN),isFinite(t)||(i=!1,t=NaN),n?i?e>t&&(n=!1,i=!1,r.error=lb().getError()):r.error=cb().getError():r.error=ub().getError(),{min:e,max:t,minValid:n,maxValid:i}}function vG(e,t,r){let n=e.evaluationState,i=e.rawTree,s=i.metaData.vizAxisOffset,o=i.metaData.vizBreadth,a={},u=Uo(t,r,s,a,1),c=Uo(t,r,o,a,1),l=!0,p=!0;isFinite(u)||(l=!1,u=NaN),isFinite(c)||(p=!1,c=NaN),l?p||(n.error=hh().getError()):n.error=gh().getError(),i.metaData.evaluatedAxisOffset=u,i.metaData.evaluatedBreadth=c,n.viz_values={axisOffset:u,breadth:c},n.viz_valids={axisOffset:l,breadth:p},Ka(n,t,a)}function OG(e){return e.globalRandomSeed||[]}function zI(e,t,r,n,i){let s={},o={},a=[],u=[];for(let c in n)n[c]&&(o[c]=!0,a.push(c));for(let c in i)i[c]&&(s[c]=!0,u.push(c));for(;a.length||u.length;){for(;a.length;){let c=a.pop(),l=t[c];if(l)for(let p of l.getLegalExports(e))s[p]||(s[p]=!0,u.push(p))}for(;u.length;){let c=u.pop(),l=r[c];if(l)for(let p of l)o[p]||(o[p]=!0,a.push(p))}}return{ids:o,symbols:s}}function HI(e,t,r){if(e.isError||e.getDependencies().length||e.valueType!==Je)return;let n=e.asValue();if(n)for(let i in n.updateRules){t[i]=vT(n,i);let{value:s,valueType:o}=n.updateRules[i];r[i]=new I.Assignment(i,ot(o,s))}}var Wy=class{constructor(){this.childIntersections=new zp;this.getCLSymbolMap=VR;this.statements={},this.analysis={},this.currentStatus={},this.currentLabel={},this.unpublishedIds={},this.dimensions={width:0,height:0},this.intersectId=void 0,this.dirtyExportedSymbolRoots={},this.dirtyStatementRoots={},this.markedRegressionDirty=!1,this.use_degrees=!1,this.initialEvaluation=!1,this.globalEventCount=0,this.actions=!0,this.substitutions=!0,this.setEvaluationMode(\"graphing\"),this.setProduct(\"graphing\"),this.setBeta3d(!1),this.setRestrictedFunctions(!1),this.setForceEnableGeometryFunctions(!1),this.setFunctionDefinition(!0),this.setReplaceRoundWithReciprocal(!1),this.setDistributions(!0),this.invalidate()}invalidate(){delete this.statements[to];for(let r in this.statements)this.statements.hasOwnProperty(r)&&this.markAsDirtyRoot(r);this.currentStatus={},this.analysis={};let t=this.viewState?{xAxisScale:this.viewState.xAxisScale,yAxisScale:this.viewState.yAxisScale}:void 0;this.policy=cG(this.evaluationMode,this.product===\"graphing-3d\",this.beta3d,t),this.parent_frame=lG[this.evaluationMode].getFrame({restrictedFunctions:this.restrictedFunctions,forceEnableGeometryFunctions:this.forceEnableGeometryFunctions,isGeometryCalculator:this.evaluationMode===\"geometry\",is3DCalculator:this.product===\"graphing-3d\",replaceRoundWithReciprocal:this.replaceRoundWithReciprocal,distributions:this.distributions,additionalFunctions:this.additionalFunctions,trigAngleMultiplier:new no(this.use_degrees?Math.PI/180:Ce(1,1)),initialEvaluation:new no(this.initialEvaluation?1:0),globalEventCount:new no(0),globalRandomSeed:new GR(this.globalRandomSeedString||\"\"),width:this.policy.dimensionVarsEnabled()?new no(Ce(this.dimensions.width,1)):bd(\"width\"),height:this.policy.dimensionVarsEnabled()?new no(Ce(this.dimensions.height,1)):bd(\"height\")}),this.frame=Object.create(this.parent_frame),this.lastFrame=Object.create(this.parent_frame),this.regressionFrame=Object.create(this.parent_frame),this.lastClockTickTime=void 0}processChangeSet(t){let r=ma(),n={cacheWrites:0,cacheReads:0,cacheHits:0,cacheMisses:0};tO(n);let i={intersections:{},graphs:{}};t.isCompleteState&&(this.invalidate(),this.statements={},this.currentLabel={});let s=!!t.isCompleteState&&!t.isUndoRedoState;s!==this.initialEvaluation&&(this.initialEvaluation=s,this.invalidate()),t.hasOwnProperty(\"logInternalErrors\")&&Og(t.logInternalErrors),t.viewState&&this.setViewState(t.viewState),t.hasOwnProperty(\"degreeMode\")&&this.setDegreeMode(t.degreeMode),t.hasOwnProperty(\"globalRandomSeed\")&&this.setGlobalRandomSeed(t.globalRandomSeed),t.hasOwnProperty(\"evaluationMode\")&&this.setEvaluationMode(t.evaluationMode),t.hasOwnProperty(\"additionalFunctions\")&&this.setAdditionalFunctions(t.additionalFunctions),t.hasOwnProperty(\"restrictedFunctions\")&&this.setRestrictedFunctions(t.restrictedFunctions),t.hasOwnProperty(\"forceEnableGeometryFunctions\")&&this.setForceEnableGeometryFunctions(t.forceEnableGeometryFunctions),t.hasOwnProperty(\"distributions\")&&this.setDistributions(t.distributions),t.hasOwnProperty(\"functionDefinition\")&&this.setFunctionDefinition(t.functionDefinition),t.hasOwnProperty(\"replaceRoundWithReciprocal\")&&this.setReplaceRoundWithReciprocal(t.replaceRoundWithReciprocal),t.hasOwnProperty(\"pointsOfInterest\")&&this.setWorkerConfigProperty(\"pointsOfInterest\",t.pointsOfInterest),t.hasOwnProperty(\"plotSingleVariableImplicitEquations\")&&this.setWorkerConfigProperty(\"plotSingleVariableImplicitEquations\",t.plotSingleVariableImplicitEquations),t.hasOwnProperty(\"plotImplicits\")&&this.setWorkerConfigProperty(\"plotImplicits\",t.plotImplicits),t.hasOwnProperty(\"plotInequalities\")&&this.setWorkerConfigProperty(\"plotInequalities\",t.plotInequalities),t.hasOwnProperty(\"sliders\")&&this.setWorkerConfigProperty(\"sliders\",t.sliders),t.hasOwnProperty(\"actions\")&&this.setActions(!!t.actions),t.hasOwnProperty(\"substitutions\")&&this.setSubstitutions(!!t.substitutions),t.hasOwnProperty(\"beta3d\")&&this.setBeta3d(!!t.beta3d),t.hasOwnProperty(\"product\")&&this.setProduct(t.product);let o;if(t.hasOwnProperty(\"selectedIds\")){let p=t.selectedIds||{};(this.intersectId===void 0||!p[this.intersectId])&&([o]=Object.keys(p),this.intersectId=o)}t.hasOwnProperty(\"dimensions\")&&this.setDimensions(t.dimensions);let a=ma();this.processStatements(t,i);let u=ma();n.processStatements=u-a,a=u,this.updateAnalysis(),u=ma(),n.updateAnalysis=u-a,a=u,o!==void 0&&this._updateIntersections(o,i),u=ma(),n.updateIntersections=u-a,a=u;let c=this._publishAllStatuses();u=ma(),n.publishAllStatuses=u-a,a=u,this._computeAllLabels(),u=ma(),n.computeAllLabels=u-a,a=u,this._computeAriaDescriptions(),u=ma(),n.computeAriaDescriptions=u-a,a=u,this._graphAllChanged(i),u=ma(),n.graphAllChanges=u-a;let l=this.processEvents(t.events);return this.unpublishedIds={},n.timeInWorker=u-r,{syncId:t.syncId,isCompleteState:t.isCompleteState,intersectionChanges:i.intersections,statusChanges:c,graphChanges:i.graphs,timingData:n,eventUpdates:l}}processStatements(t,r){if(t.removes)for(let n in t.removes){let i;if(!t.isCompleteState&&this.statements.hasOwnProperty(n)&&(i=this.statements[n].getAllIds()),this.removeStatement(n,r),!t.isCompleteState&&i)for(let s of i)r.graphs[s]=void 0}if(t.statements)for(let n in t.statements){let i=t.statements[n];i===null||this.addStatement(i,r)}}setViewState(t){if(ba(t,this.viewState))return;let r=!!(this.viewState&&t.xAxisScale===this.viewState.xAxisScale&&t.yAxisScale===this.viewState.yAxisScale);if(this.viewState=t,r)for(let n in this.statements)this.statements.hasOwnProperty(n)&&(this.unpublishedIds[n]=!0);else this.invalidate()}getViewState(){return this.viewState}setDegreeMode(t){this.use_degrees=t,this.invalidate()}setDimensions(t){t!==void 0&&(this.dimensions=t,this.invalidate())}setGlobalRandomSeed(t){this.globalRandomSeedString=t,this.parent_frame.globalRandomSeed=new GR(t),this.dirtyExportedSymbolRoots.globalRandomSeed=!0}setEvaluationMode(t){this.evaluationMode=t,this.invalidate()}setProduct(t){this.product=t,this.invalidate()}setBeta3d(t){this.beta3d=t,this.invalidate()}setAdditionalFunctions(t){this.additionalFunctions=t,this.invalidate()}setRestrictedFunctions(t){this.restrictedFunctions=t,this.invalidate()}setForceEnableGeometryFunctions(t){this.forceEnableGeometryFunctions=t,this.invalidate()}setDistributions(t){this.distributions=t,this.invalidate()}setFunctionDefinition(t){this.functionDefinition=t,this.invalidate()}setReplaceRoundWithReciprocal(t){this.replaceRoundWithReciprocal=t,this.invalidate()}setActions(t){t!==this.actions&&(this.actions=t,this.invalidate())}setSubstitutions(t){t!==this.substitutions&&(this.substitutions=t,this.invalidate())}setWorkerConfigProperty(t,r){r!==Si[t]&&(Si[t]=r,this.invalidate())}_publishAllStatuses(){let t={},r=this.currentStatus;this.currentStatus={};for(let n in this.unpublishedIds){if(!this.analysis.hasOwnProperty(n))continue;let i=this.analysis[n].evaluationState;ba(i,r[n])||(t[n]=i),this.currentStatus[n]=i}return t}_computeAllLabels(){for(let t in this.currentLabel){let r=this.statements[t];if(!r)continue;let n=r.tryGetConcreteTree(this.policy,this.frame),i=1;(n.valueType===nt||n.valueType===ur||n.valueType===br||n.valueType===Jt||n.valueType===Qt)&&(i=n.length);let s=[],o=this.currentLabel[t];if(zs(o))for(let a=0;a<i;a++)s.push(GI(o,this.frame,a));ba(s,r.computedLabels)||(r.computedLabels=s,this.unpublishedIds[t]=!0)}}_computeAriaDescriptions(){for(let t in this.analysis){let r=this.analysis[t],n=r.evaluationState,s=r.rawTree.userData,o;if(s.description?o=s.description:s.label&&(o=s.label),o){n.computed_description=[];let a=1;r.concreteTree.isList?a=r.concreteTree.length:n.dimensions&&n.dimensions.x&&Array.isArray(n.dimensions.x)&&(a=n.dimensions.x.length);for(let u=0;u<a;u++)n.computed_description.push(GI(BI(o),this.frame,u))}}}_graphAllChanged(t){let r=this.getViewState(),n=!1;if(!(!r||!gS(r))){for(let i in this.unpublishedIds){if(!this.analysis.hasOwnProperty(i))continue;let s=this.analysis[i],o=s.evaluationState.expression_type,a=o===\"SINGLE_POINT\"||o===\"POINT_LIST\";if(hs(s.rawTree)){let u=s.graph(r,void 0),c=s.rawTree.getAllIds();for(let l of c)u[l]?this._notifyGraphComputed(l,u[l],t):this._notifyGraphRemoved(l,t)}else s.evaluationState.is_graphable&&(s.rawTree.userData.shouldGraph||s.rawTree.userData.showLabel&&a)?(this._notifyGraphComputed(i,s.graph(r,this.childIntersections.getChildIntersections(i)),t),this.intersectId===i&&(n=!0)):this._notifyGraphRemoved(i,t)}Zn(this.unpublishedIds).length&&this.intersectId!==void 0&&(this.unpublishedIds.hasOwnProperty(this.intersectId)||(n=!0)),n&&this._updateIntersections(this.intersectId,t)}}_notifyGraphRemoved(t,r){r.graphs[t]=void 0}_notifyGraphComputed(t,r,n){UM(r),n.graphs[t]=r}_updateIntersections(t,r){if(!this.viewState)return;if(!this.analysis[t]||!this.analysis[t].shouldIntersect()){r.intersections[t]=[];return}let n=wR(this.analysis,this.viewState,t);r.intersections[t]=n}getDisabledFeatures(){let t=this.policy.disabledFeatures();this.functionDefinition===!1&&(t=t.concat(\"FunctionDefinition\")),this.actions===!1&&(t=t.concat(\"UpdateRule\")),this.substitutions===!1&&(t=t.concat(\"Substitution\"));let r=this.additionalFunctions||[];return t=t.filter(n=>!(n===\"Exponent\"&&r.indexOf(\"exponent\")!==-1||n===\"PercentOf\"&&r.indexOf(\"percent\")!==-1)),t}areFractionsDisallowed(){let{evaluationMode:t}=this;return t!==\"fourFunction\"&&t!==\"singleExpressionFourFunction\"?!1:!this.additionalFunctions||this.additionalFunctions.indexOf(\"fraction\")===-1}addStatement(t,r){if(!t)return;let n=t.id;this.markExportsDirty(n),this.markAsDirtyRoot(n);let i;if(t.type===\"statement\"){let c=t.latexSelection;i=c&&{input:t.latex,start:c.start,end:c.end}}let s={index:this.policy.ansEnabled()?t.index:void 0,disabledFeatures:this.getDisabledFeatures(),disallowFrac:this.areFractionsDisallowed(),seedPrefix:ir(n),writeIntegral:this.evaluationMode===\"geometry\",selection:i},o={extraDepNodes:[]};switch(t.type){case\"table\":let c=[];this.statements.hasOwnProperty(n)&&(c=this.statements[n].getAllIds()),t.shouldGraph=!0;let l=t.columns,p=[],f=T=>!T.replace(/\\\\space|\\\\ /g,\"\").match(/\\S/);for(let T=0;T<l.length;T++){let D,S,O,A=l[T];D=ys(A.latex,ee(W({},s),{seedPrefix:ir(n,[[\"tr\",0],[\"tc\",T]])})),S=[];let _=-1;for(let L=0;L<l[T].values.length;L++)f(A.values[L])?S.push(new no(NaN)):(S.push(ys(A.values[L],ee(W({},s),{seedPrefix:ir(n,[[\"tr\",L+1],[\"tc\",T]])}))),_=L);if(S=S.slice(0,_+1),O=new aG(D,S),O.id=A.id,O.header){if(O.header.userData=A,O.header.metaData={extraDepNodes:[]},A.colorLatex){let L=ai(A.colorLatex,ee(W({},s),{seedPrefix:ir(n,[[\"tr\",0],[\"tc\",T],[\"cl\",T]])}));O.header.metaData.colorLatex=L,O.header.metaData.extraDepNodes.push(L)}if(A.pointSize){let L=ai(A.pointSize,ee(W({},s),{seedPrefix:ir(n,[[\"tr\",0],[\"tc\",T],[\"ps\",T]])}));O.header.metaData.pointSize=L,O.header.metaData.extraDepNodes.push(L)}if(A.pointOpacity){let L=ai(A.pointOpacity,ee(W({},s),{seedPrefix:ir(n,[[\"tr\",0],[\"tc\",T],[\"po\",T]])}));O.header.metaData.pointOpacity=L,O.header.metaData.extraDepNodes.push(L)}if(A.lineWidth){let L=ai(A.lineWidth,ee(W({},s),{seedPrefix:ir(n,[[\"tr\",0],[\"tc\",T],[\"lw\",T]])}));O.header.metaData.lineWidth=L,O.header.metaData.extraDepNodes.push(L)}if(A.lineOpacity){let L=ai(A.lineOpacity,ee(W({},s),{seedPrefix:ir(n,[[\"tr\",0],[\"tc\",T],[\"lo\",T]])}));O.header.metaData.lineOpacity=L,O.header.metaData.extraDepNodes.push(L)}}p.push(O)}this.statements[n]=new oG(p);let y=this.statements[n].getAllIds();c.forEach(T=>{y.indexOf(T)===-1&&this._notifyGraphRemoved(T,r)});break;case\"image\":let h=\"-\\\\trigAngleMultiplier*(\"+t.angle+\")\",m=ai(t.center,ee(W({},s),{seedPrefix:ir(n,[[\"ic\",n]])})),b=ai(h,ee(W({},s),{seedPrefix:ir(n,[[\"ia\",n]])})),d=ai(t.width,ee(W({},s),{seedPrefix:ir(n,[[\"iw\",n]])})),g=ai(t.height,ee(W({},s),{seedPrefix:ir(n,[[\"ih\",n]])})),x=ai(t.opacity,ee(W({},s),{seedPrefix:ir(n,[[\"io\",n]])}));this.statements[n]=new iG({center:m,radianAngle:b,width:d,height:g,opacity:x},void 0);break;case\"ticker\":{this.statements[n]=new I.Ticker({handler:ai(t.handlerLatex,ee(W({},s),{allowDt:!0})),minStep:ai(t.minStepLatex||\"0\",s)});break}case\"geometry-toolbar-predicate\":{this.statements[n]=ai(`\\\\{${t.latex}:1,0\\\\}`,W({},s));break}default:t=t;let M,E=fo(t.latex);E.slice(-1)===\"=\"?M=E.substring(0,E.length-1):M=t.latex,this.statements[n]=ys(M,s);for(let T in kp){let D=T;if(t[D]){let S=kp[D],O=t[D];S.transform&&(O=S.transform(O));let A=ro(O,ee(W({},s),{seedPrefix:ir(n,[[S.seed,n]])}));o[D]=A,o.extraDepNodes.push(A)}}if(t.colorLatex){let T=ru(t.colorLatex,ee(W({},s),{seedPrefix:ir(n,[[\"ac\",n]])}));o.colorLatex=T,o.extraDepNodes.push(T)}if(t.polarDomain&&t.polarDomain.min&&(o.polarDomainMin=ro(t.polarDomain.min,ee(W({},s),{seedPrefix:ir(n,[[\"lm\",n]])})),o.extraDepNodes.push(o.polarDomainMin)),t.polarDomain&&t.polarDomain.max&&(o.polarDomainMax=ro(t.polarDomain.max,ee(W({},s),{seedPrefix:ir(n,[[\"lM\",n]])})),o.extraDepNodes.push(o.polarDomainMax)),t.parametricDomain&&t.parametricDomain.min&&(o.parametricDomainMin=ro(t.parametricDomain.min,ee(W({},s),{seedPrefix:ir(n,[[\"lm\",n]])})),o.extraDepNodes.push(o.parametricDomainMin)),t.parametricDomain3Du&&t.parametricDomain3Du.min&&(o.parametricDomain3DuMin=ro(t.parametricDomain3Du.min,ee(W({},s),{seedPrefix:ir(n,[[\"lm\",n]])})),o.extraDepNodes.push(o.parametricDomain3DuMin)),t.parametricDomain3Dv&&t.parametricDomain3Dv.min&&(o.parametricDomain3DvMin=ro(t.parametricDomain3Dv.min,ee(W({},s),{seedPrefix:ir(n,[[\"lm\",n]])})),o.extraDepNodes.push(o.parametricDomain3DvMin)),t.parametricDomain&&t.parametricDomain.max&&(o.parametricDomainMax=ro(t.parametricDomain.max,ee(W({},s),{seedPrefix:ir(n,[[\"lM\",n]])})),o.extraDepNodes.push(o.parametricDomainMax)),t.parametricDomain3Du&&t.parametricDomain3Du.max&&(o.parametricDomain3DuMax=ro(t.parametricDomain3Du.max,ee(W({},s),{seedPrefix:ir(n,[[\"lM\",n]])})),o.extraDepNodes.push(o.parametricDomain3DuMax)),t.parametricDomain3Dv&&t.parametricDomain3Dv.max&&(o.parametricDomain3DvMax=ro(t.parametricDomain3Dv.max,ee(W({},s),{seedPrefix:ir(n,[[\"lM\",n]])})),o.extraDepNodes.push(o.parametricDomain3DvMax)),t.vizProps&&(t.vizProps.axisOffset&&(o.vizAxisOffset=ro(t.vizProps.axisOffset,ee(W({},s),{seedPrefix:ir(n,[[\"vo\",n]])})),o.extraDepNodes.push(o.vizAxisOffset)),t.vizProps.breadth&&(o.vizBreadth=ro(t.vizProps.breadth,ee(W({},s),{seedPrefix:ir(n,[[\"vb\",n]])})),o.extraDepNodes.push(o.vizBreadth))),t.cdf&&t.cdf.show){let T=OO(t.latex);T&&T.type===\"distribution\"&&(o.distributionSpec=T,o.cdfMin=ru(t.cdf.min,ee(W({},s),{seedPrefix:ir(n,[[\"lm\",n]])})),o.extraDepNodes.push(o.cdfMin),o.cdfMax=ru(t.cdf.max,ee(W({},s),{seedPrefix:ir(n,[[\"lM\",n]])})),o.extraDepNodes.push(o.cdfMax))}if(this.statements[n].shouldPromoteToSlider(this.policy)){let T=t.slider,D=!!(T&&T.isPlayingOnce),S=ru(T&&T.softMin,s),O=ru(T&&T.softMax,s),A=ru(T&&T.min,ee(W({},s),{seedPrefix:ir(n,[[\"lm\",n]])})),_=ru(T&&T.max,ee(W({},s),{seedPrefix:ir(n,[[\"lM\",n]])})),L=ru(T&&T.step,ee(W({},s),{seedPrefix:ir(n,[[\"ls\",n]])}));this.statements[n]=new sG(this.statements[n],{sliderMin:A,sliderMax:_,sliderStep:L,sliderIsPlayingOnce:D,sliderSoftMin:S,sliderSoftMax:O})}}let a=t.clickableInfo;a&&a.enabled&&a.latex&&(o.clickHandler=ai(a.latex,ee(W({},s),{allowIndex:!0}))),this.statements[n].userData=t,this.statements[n].metaData=o;let u=t.label;if(u){let c=this.currentLabel[n];(!c||c.raw!==u)&&(this.currentLabel[n]=BI(u))}else delete this.currentLabel[n]}removeStatement(t,r){let n=this.statements[t];if(n){if(this.markExportsDirty(t),hs(n)){let i=this;n.getAllIds().forEach(function(s){i._notifyGraphRemoved(s,r)})}else this._notifyGraphRemoved(t,r);delete this.currentLabel[t],delete this.statements[t],delete this.analysis[t],delete this.currentStatus[t]}}markExportsDirty(t){if(this.statements[t]){qc(this.statements[t])&&(this.markedRegressionDirty=!0);for(let r of this.statements[t].getLegalExports(this.policy))this.dirtyExportedSymbolRoots[r]=!0}}markAsDirtyRoot(t){this.dirtyStatementRoots[t]=!0}getFrame(){return this.updateAnalysis(),this.frame}getAnalysis(){return this.updateAnalysis(),this.analysis}getEvaluationState(t){if(this.updateAnalysis(),!!this.analysis[t])return this.analysis[t].evaluationState}_updateRegressions(t){let r=this.frame,n=this.lastFrame,i=this.regressionFrame;if(!this.policy.graphingEnabled())return;let s=[];for(let l in t)t.hasOwnProperty(l)&&qc(t[l])&&s.push(l);let o=this;s.sort(function(l,p){let f=o.statements[l].userData&&o.statements[l].userData.residualVariable,y=o.statements[p].userData&&o.statements[p].userData.residualVariable;return f&&!y?-1:y&&!f?1:0});let a=VI(this.policy,t,s);zR(a,i);let u=a.resolved,c={};for(let l of u)if(l!==to)if(qc(this.statements[l]))this.analysis[l]=t[l].analyze(this.policy,i,r,n,c),this.analysis[l].exportTo(this.policy,r),delete t[l];else{let p=t[l].tryGetConcreteTree(this.policy,i);t[l].exportTo(this.policy,p,i),c[l]={rawTree:t[l],concreteTree:p}}}buildSymbolToExpressionDirtyMap(){let t={};for(let r in this.statements){if(!this.statements.hasOwnProperty(r))continue;let n=this.statements[r],i=n.metaData;if(qp(t,r,n.getDependencies()),qp(t,r,n.getLegalExports(this.policy)),qc(n)&&n.userData&&n.userData.residualVariable&&qp(t,r,[po(n.userData.residualVariable)]),HR(t,r,i),hs(n)&&n.columns)for(let s=0;s<n.columns.length;s++){let o=n.columns[s];!Ys(o)&&o.header&&o.header.metaData&&HR(t,r,o.header.metaData)}}return t}buildChildIntersectionMap(){var n,i;let t=this.childIntersections,r=new zp;for(let s in this.analysis){let o=this.analysis[s],{geometry:a}=o.evaluationState;if(a!=null&&a.call&&a.call.symbol===\"intersection\"&&this.statements[s].userData.shouldGraph&&!o.concreteTree.isError){let u=!!this.unpublishedIds[s],c=o.concreteTree.asTypedValue();for(let l of a.call.parents){let p=l&&this.frame[l[0]],f=p&&p.userData.id;if(f==null)continue;let y=l&&l[1],h=this.analysis[f];j(h.concreteTree.asTypedValue().valueType)?r.addListParent(f,y===void 0?void 0:y-1,c):r.addPrimitiveParent(f,c),u&&(this.unpublishedIds[f]=!0)}}}for(let s in t.data){let o=((n=t.data[s])==null?void 0:n.count)||0;(((i=r.data[s])==null?void 0:i.count)||0)<o&&(this.unpublishedIds[s]=!0)}return r}updateConstruction(){if(!this.policy.isGeometryEnabled){this.parent_frame.construction=Iu();return}let t=[];for(let o in this.statements)this.statements[o].userData.isInConstructionsFolder&&t.push(o);let r=this.statements[to],n=new uG(t);n.metaData={extraDepNodes:[]},n.userData={};let i={};for(let o of(r==null?void 0:r.getDependencies())||[])i[o]=!0;let s={};for(let o of n.getDependencies())s[o]=!0;(!r||!ba(i,s))&&(this.statements[to]=n,this.parent_frame.construction=n,this.markAsDirtyRoot(to),this.markExportsDirty(to))}updateAnalysis(){var f;this.updateConstruction();let t=this.buildSymbolToExpressionDirtyMap(),r=zI(this.policy,this.statements,t,this.dirtyStatementRoots,this.dirtyExportedSymbolRoots),n=this.markedRegressionDirty;for(let y in r.ids)this.statements[y]&&qc(this.statements[y])&&(n=!0);let i={};if(n){for(let y in this.statements)this.statements[y]&&(i[y]=this.statements[y]);this.frame=Object.create(this.parent_frame),this.regressionFrame=Object.create(this.parent_frame)}else{let y=r.ids;for(let m in y)this.statements[m]&&(i[m]=this.statements[m]);let h=r.symbols;for(let m in h)h[m]&&(delete this.frame[m],delete this.regressionFrame[m])}for(let y in i)i[y]&&(this.unpublishedIds[y]=!0);this.markedRegressionDirty=!1,this.dirtyExportedSymbolRoots={},this.dirtyStatementRoots={};let s=this.analysis,o=this.frame;(this.evaluationMode===\"graphing\"||this.evaluationMode===\"geometry\"||this.evaluationMode===\"graphing_3d\")&&this._updateRegressions(i);let a=VI(this.policy,i);zR(a,o);let u=a.resolved;for(let y of u)if(y!==to)switch(this.evaluationMode){case\"fourFunction\":case\"singleExpressionFourFunction\":s[y]=this.statements[y].analyzeFourFunction(this.policy,o,s),s[y].exportTo(this.policy,o);break;case\"scientific\":s[y]=this.statements[y].analyzeScientific(this.policy,o,s),s[y].exportTo(this.policy,o);break;case\"singleExpressionScientific\":s[y]=this.statements[y].analyzeSingleExpressionScientific(this.policy,o,s),s[y].exportTo(this.policy,o);break;case\"graphing\":case\"graphing_3d\":case\"geometry\":if(!this.policy.graphingEnabled())break;if(o.r){let h=Object.create(o);if(h.r=void 0,s[y]=this.statements[y].analyze(this.policy,h,s),s[y].getGraphMode()===6){s[y].exportTo(this.policy,o);continue}}s[y]=this.statements[y].analyze(this.policy,o,s),s[y].exportTo(this.policy,o);break}if(this.policy.graphingEnabled()){for(let y of u){if(y===to)continue;let h=s[y],m=h.evaluationState.expression_type;for(let b in kp){let d=b;var c=kp[d];this.evaluationMode!==\"graphing_3d\"&&(d===\"checkers\"||d===\"resolution\")||(!c.shouldEvaluate||c.shouldEvaluate(h))&&PG(h,this.policy,o,d)}TG(h,this.policy,o),this.product===\"graphing-3d\"&&IG(h),this.actions&&fG(h)&&EG(h,this.policy,o),m===\"PARAMETRIC\"||m===\"CURVE3D_xyz_t\"||m===\"POLAR\"||m===\"SURFACE_r_\\u03B8z\"||m===\"SURFACE_r_\\u03B8z_AMBIGUOUS\"||m===\"SLICE_r\\u03B8z_at_z\"?MG(h,this.policy,o):m===\"SURFACE_xyz_uv\"||m===\"SLICE_xyz_uv\"||m===\"SURFACE_r_\\u03B8\\u03C6\"||m===\"SURFACE_r_\\u03B8\\u03C6_AMBIGUOUS\"||m===\"SURFACE_z_r\\u03B8\"||m===\"SLICE_zr\\u03B8_at_r\"||m===\"SLICE_zr\\u03B8_at_\\u03B8\"||m===\"SLICE_zr\\u03B8_at_xyz\"||m===\"SLICE_r\\u03B8\\u03C6_at_\\u03B8\"||m===\"SLICE_r\\u03B8\\u03C6_at_\\u03C6\"||m===\"SLICE_r\\u03B8\\u03C6_at_xyz\"?DG(h,this.policy,o):m===\"BOXPLOT\"?vG(h,this.policy,o):pG(h)&&bG(h,this.policy,o)}this.childIntersections=this.buildChildIntersectionMap()}OG(t).forEach(function(y){s[y].evaluationState.depends_on_random_seed=!0});let l=zI(this.policy,this.statements,t,{[to]:!0},{construction:!0});for(let y in l.ids){if(y===to)continue;let h=s[y].evaluationState;h.geometry&&(h.geometry.unconstructable=!0)}let p;for(let y in this.statements)if((f=this.statements[y].parseOptions)!=null&&f.selection){p=y;break}if(p){let y=zI(this.policy,this.statements,t,{[p]:!0},{[`idref_${p}`]:!0});for(let h in y.ids){if(h===to)continue;let m=s[h].evaluationState;m.geometry&&(m.geometry.depends_on_selected=!0)}}this.lastFrame=Object.create(this.parent_frame);for(let y in o)o.hasOwnProperty(y)&&(this.lastFrame[y]=o[y])}processEvents(t){if(!t||!this.actions)return;let r=Object.create(this.frame),n={},i=!1,s=!1,o;for(let c of t)switch(this.globalEventCount+=1,r.globalEventCount=new I.Constant(this.globalEventCount),c.type){case\"step\":{let p=this.statements[c.expressionId];if(!p)continue;let f=p.tryGetConcreteTree(this.policy,r);s=!0,HI(f,n,r);break}case\"click\":{let p=this.statements[c.expressionId];if(!p||!p.metaData.clickHandler)continue;r.index=new I.Constant(c.indexVar+1);let f=p.metaData.clickHandler.tryGetConcreteTree(this.policy,r);s=!0,i=!0,HI(f,n,r);break}case\"clock-tick\":{(o===void 0||c.isFirstTick&&!o.isFirstTick)&&(o=c);break}default:return c}if(o){let c=this.statements[o.id];if(c&&c instanceof I.Ticker){var a=c.minStep.tryGetConcreteTree(this.policy,r).asValue(),u=typeof a==\"number\"&&a>=0&&isFinite(a);if(u){let l=this.lastClockTickTime;if(this.lastClockTickTime=Date.now(),!o.isFirstTick&&l!==void 0){r.dt=new I.Constant(this.lastClockTickTime-l);let p=c.handler.tryGetConcreteTree(this.policy,r);HI(p,n,r)}}}}return{objectClicked:i,userAction:s,updates:n}}};var YR=class{constructor(t){this.context=new Wy,this.sendMessage=t}processChangeSet(t){var r=this.context.processChangeSet(t);this.sendMessage(\"processChangeSet\",r)}};Object.defineProperty(__dcg_chunk_exports__, 'a', { get: () => W });\nObject.defineProperty(__dcg_chunk_exports__, 'b', { get: () => ee });\nObject.defineProperty(__dcg_chunk_exports__, 'c', { get: () => SG });\nObject.defineProperty(__dcg_chunk_exports__, 'd', { get: () => jI });\nObject.defineProperty(__dcg_chunk_exports__, 'e', { get: () => RG });\nObject.defineProperty(__dcg_chunk_exports__, 'f', { get: () => NG });\nObject.defineProperty(__dcg_chunk_exports__, 'g', { get: () => Ds });\nObject.defineProperty(__dcg_chunk_exports__, 'h', { get: () => AG });\nObject.defineProperty(__dcg_chunk_exports__, 'i', { get: () => CG });\nObject.defineProperty(__dcg_chunk_exports__, 'j', { get: () => gs });\nObject.defineProperty(__dcg_chunk_exports__, 'k', { get: () => tI });\nObject.defineProperty(__dcg_chunk_exports__, 'l', { get: () => _y });\nObject.defineProperty(__dcg_chunk_exports__, 'm', { get: () => c3 });\nObject.defineProperty(__dcg_chunk_exports__, 'n', { get: () => l3 });\nObject.defineProperty(__dcg_chunk_exports__, 'o', { get: () => ju });\nObject.defineProperty(__dcg_chunk_exports__, 'p', { get: () => d3 });\nObject.defineProperty(__dcg_chunk_exports__, 'q', { get: () => m3 });\nObject.defineProperty(__dcg_chunk_exports__, 'r', { get: () => uc });\nObject.defineProperty(__dcg_chunk_exports__, 's', { get: () => rf });\nObject.defineProperty(__dcg_chunk_exports__, 't', { get: () => fN });\nObject.defineProperty(__dcg_chunk_exports__, 'u', { get: () => d2 });\nObject.defineProperty(__dcg_chunk_exports__, 'v', { get: () => m2 });\nObject.defineProperty(__dcg_chunk_exports__, 'w', { get: () => oc });\nObject.defineProperty(__dcg_chunk_exports__, 'x', { get: () => P0 });\nObject.defineProperty(__dcg_chunk_exports__, 'y', { get: () => dN });\nObject.defineProperty(__dcg_chunk_exports__, 'z', { get: () => g2 });\nObject.defineProperty(__dcg_chunk_exports__, 'A', { get: () => h2 });\nObject.defineProperty(__dcg_chunk_exports__, 'B', { get: () => b2 });\nObject.defineProperty(__dcg_chunk_exports__, 'C', { get: () => T2 });\nObject.defineProperty(__dcg_chunk_exports__, 'D', { get: () => I2 });\nObject.defineProperty(__dcg_chunk_exports__, 'E', { get: () => ul });\nObject.defineProperty(__dcg_chunk_exports__, 'F', { get: () => M2 });\nObject.defineProperty(__dcg_chunk_exports__, 'G', { get: () => cg });\nObject.defineProperty(__dcg_chunk_exports__, 'H', { get: () => gN });\nObject.defineProperty(__dcg_chunk_exports__, 'I', { get: () => xN });\nObject.defineProperty(__dcg_chunk_exports__, 'J', { get: () => S2 });\nObject.defineProperty(__dcg_chunk_exports__, 'K', { get: () => A2 });\nObject.defineProperty(__dcg_chunk_exports__, 'L', { get: () => C2 });\nObject.defineProperty(__dcg_chunk_exports__, 'M', { get: () => Zn });\nObject.defineProperty(__dcg_chunk_exports__, 'N', { get: () => al });\nObject.defineProperty(__dcg_chunk_exports__, 'O', { get: () => SN });\nObject.defineProperty(__dcg_chunk_exports__, 'P', { get: () => ba });\nObject.defineProperty(__dcg_chunk_exports__, 'Q', { get: () => F2 });\nObject.defineProperty(__dcg_chunk_exports__, 'R', { get: () => cc });\nObject.defineProperty(__dcg_chunk_exports__, 'S', { get: () => lc });\nObject.defineProperty(__dcg_chunk_exports__, 'T', { get: () => CN });\nObject.defineProperty(__dcg_chunk_exports__, 'U', { get: () => q2 });\nObject.defineProperty(__dcg_chunk_exports__, 'V', { get: () => X2 });\nObject.defineProperty(__dcg_chunk_exports__, 'W', { get: () => jr });\nObject.defineProperty(__dcg_chunk_exports__, 'X', { get: () => Hq });\nObject.defineProperty(__dcg_chunk_exports__, 'Y', { get: () => Ud });\nObject.defineProperty(__dcg_chunk_exports__, 'Z', { get: () => Q0 });\nObject.defineProperty(__dcg_chunk_exports__, '_', { get: () => Xn });\nObject.defineProperty(__dcg_chunk_exports__, '$', { get: () => Gr });\nObject.defineProperty(__dcg_chunk_exports__, 'aa', { get: () => v });\nObject.defineProperty(__dcg_chunk_exports__, 'ba', { get: () => Tt });\nObject.defineProperty(__dcg_chunk_exports__, 'ca', { get: () => P });\nObject.defineProperty(__dcg_chunk_exports__, 'da', { get: () => N });\nObject.defineProperty(__dcg_chunk_exports__, 'ea', { get: () => Bt });\nObject.defineProperty(__dcg_chunk_exports__, 'fa', { get: () => te });\nObject.defineProperty(__dcg_chunk_exports__, 'ga', { get: () => zr });\nObject.defineProperty(__dcg_chunk_exports__, 'ha', { get: () => nt });\nObject.defineProperty(__dcg_chunk_exports__, 'ia', { get: () => ar });\nObject.defineProperty(__dcg_chunk_exports__, 'ja', { get: () => Le });\nObject.defineProperty(__dcg_chunk_exports__, 'ka', { get: () => Vr });\nObject.defineProperty(__dcg_chunk_exports__, 'la', { get: () => we });\nObject.defineProperty(__dcg_chunk_exports__, 'ma', { get: () => br });\nObject.defineProperty(__dcg_chunk_exports__, 'na', { get: () => Oe });\nObject.defineProperty(__dcg_chunk_exports__, 'oa', { get: () => ur });\nObject.defineProperty(__dcg_chunk_exports__, 'pa', { get: () => de });\nObject.defineProperty(__dcg_chunk_exports__, 'qa', { get: () => Sr });\nObject.defineProperty(__dcg_chunk_exports__, 'ra', { get: () => ue });\nObject.defineProperty(__dcg_chunk_exports__, 'sa', { get: () => Rr });\nObject.defineProperty(__dcg_chunk_exports__, 'ta', { get: () => ye });\nObject.defineProperty(__dcg_chunk_exports__, 'ua', { get: () => Nr });\nObject.defineProperty(__dcg_chunk_exports__, 'va', { get: () => _e });\nObject.defineProperty(__dcg_chunk_exports__, 'wa', { get: () => Ar });\nObject.defineProperty(__dcg_chunk_exports__, 'xa', { get: () => Ae });\nObject.defineProperty(__dcg_chunk_exports__, 'ya', { get: () => Jt });\nObject.defineProperty(__dcg_chunk_exports__, 'za', { get: () => xe });\nObject.defineProperty(__dcg_chunk_exports__, 'Aa', { get: () => Qt });\nObject.defineProperty(__dcg_chunk_exports__, 'Ba', { get: () => He });\nObject.defineProperty(__dcg_chunk_exports__, 'Ca', { get: () => tn });\nObject.defineProperty(__dcg_chunk_exports__, 'Da', { get: () => ge });\nObject.defineProperty(__dcg_chunk_exports__, 'Ea', { get: () => Cr });\nObject.defineProperty(__dcg_chunk_exports__, 'Fa', { get: () => G });\nObject.defineProperty(__dcg_chunk_exports__, 'Ga', { get: () => e0 });\nObject.defineProperty(__dcg_chunk_exports__, 'Ha', { get: () => tN });\nObject.defineProperty(__dcg_chunk_exports__, 'Ia', { get: () => $n });\nObject.defineProperty(__dcg_chunk_exports__, 'Ja', { get: () => pe });\nObject.defineProperty(__dcg_chunk_exports__, 'Ka', { get: () => j });\nObject.defineProperty(__dcg_chunk_exports__, 'La', { get: () => $e });\nObject.defineProperty(__dcg_chunk_exports__, 'Ma', { get: () => rl });\nObject.defineProperty(__dcg_chunk_exports__, 'Na', { get: () => uo });\nObject.defineProperty(__dcg_chunk_exports__, 'Oa', { get: () => Zp });\nObject.defineProperty(__dcg_chunk_exports__, 'Pa', { get: () => ie });\nObject.defineProperty(__dcg_chunk_exports__, 'Qa', { get: () => Fe });\nObject.defineProperty(__dcg_chunk_exports__, 'Ra', { get: () => t0 });\nObject.defineProperty(__dcg_chunk_exports__, 'Sa', { get: () => Wp });\nObject.defineProperty(__dcg_chunk_exports__, 'Ta', { get: () => t2 });\nObject.defineProperty(__dcg_chunk_exports__, 'Ua', { get: () => ss });\nObject.defineProperty(__dcg_chunk_exports__, 'Va', { get: () => Yo });\nObject.defineProperty(__dcg_chunk_exports__, 'Wa', { get: () => Rs });\nObject.defineProperty(__dcg_chunk_exports__, 'Xa', { get: () => iN });\nObject.defineProperty(__dcg_chunk_exports__, 'Ya', { get: () => n2 });\nObject.defineProperty(__dcg_chunk_exports__, 'Za', { get: () => i2 });\nObject.defineProperty(__dcg_chunk_exports__, '_a', { get: () => Ln });\nObject.defineProperty(__dcg_chunk_exports__, '$a', { get: () => s2 });\nObject.defineProperty(__dcg_chunk_exports__, 'ab', { get: () => fr });\nObject.defineProperty(__dcg_chunk_exports__, 'bb', { get: () => fg });\nObject.defineProperty(__dcg_chunk_exports__, 'cb', { get: () => HN });\nObject.defineProperty(__dcg_chunk_exports__, 'db', { get: () => w0 });\nObject.defineProperty(__dcg_chunk_exports__, 'eb', { get: () => af });\nObject.defineProperty(__dcg_chunk_exports__, 'fb', { get: () => XN });\nObject.defineProperty(__dcg_chunk_exports__, 'gb', { get: () => yg });\nObject.defineProperty(__dcg_chunk_exports__, 'hb', { get: () => Zr });\nObject.defineProperty(__dcg_chunk_exports__, 'ib', { get: () => ZN });\nObject.defineProperty(__dcg_chunk_exports__, 'jb', { get: () => po });\nObject.defineProperty(__dcg_chunk_exports__, 'kb', { get: () => fo });\nObject.defineProperty(__dcg_chunk_exports__, 'lb', { get: () => $o });\nObject.defineProperty(__dcg_chunk_exports__, 'mb', { get: () => Xe });\nObject.defineProperty(__dcg_chunk_exports__, 'nb', { get: () => _P });\nObject.defineProperty(__dcg_chunk_exports__, 'ob', { get: () => wn });\nObject.defineProperty(__dcg_chunk_exports__, 'pb', { get: () => qi });\nObject.defineProperty(__dcg_chunk_exports__, 'qb', { get: () => I });\nObject.defineProperty(__dcg_chunk_exports__, 'rb', { get: () => rE });\nObject.defineProperty(__dcg_chunk_exports__, 'sb', { get: () => $l });\nObject.defineProperty(__dcg_chunk_exports__, 'tb', { get: () => $d });\nObject.defineProperty(__dcg_chunk_exports__, 'ub', { get: () => Di });\nObject.defineProperty(__dcg_chunk_exports__, 'vb', { get: () => vE });\nObject.defineProperty(__dcg_chunk_exports__, 'wb', { get: () => p8 });\nObject.defineProperty(__dcg_chunk_exports__, 'xb', { get: () => g8 });\nObject.defineProperty(__dcg_chunk_exports__, 'yb', { get: () => Bs });\nObject.defineProperty(__dcg_chunk_exports__, 'zb', { get: () => iC });\nObject.defineProperty(__dcg_chunk_exports__, 'Ab', { get: () => Jr });\nObject.defineProperty(__dcg_chunk_exports__, 'Bb', { get: () => iM });\nObject.defineProperty(__dcg_chunk_exports__, 'Cb', { get: () => Ac });\nObject.defineProperty(__dcg_chunk_exports__, 'Db', { get: () => Lc });\nObject.defineProperty(__dcg_chunk_exports__, 'Eb', { get: () => wc });\nObject.defineProperty(__dcg_chunk_exports__, 'Fb', { get: () => tP });\nObject.defineProperty(__dcg_chunk_exports__, 'Gb', { get: () => rP });\nObject.defineProperty(__dcg_chunk_exports__, 'Hb', { get: () => wx });\nObject.defineProperty(__dcg_chunk_exports__, 'Ib', { get: () => X_ });\nObject.defineProperty(__dcg_chunk_exports__, 'Jb', { get: () => LM });\nObject.defineProperty(__dcg_chunk_exports__, 'Kb', { get: () => $_ });\nObject.defineProperty(__dcg_chunk_exports__, 'Lb', { get: () => Pm });\nObject.defineProperty(__dcg_chunk_exports__, 'Mb', { get: () => sp });\nObject.defineProperty(__dcg_chunk_exports__, 'Nb', { get: () => nP });\nObject.defineProperty(__dcg_chunk_exports__, 'Ob', { get: () => iP });\nObject.defineProperty(__dcg_chunk_exports__, 'Pb', { get: () => FM });\nObject.defineProperty(__dcg_chunk_exports__, 'Qb', { get: () => j_ });\nObject.defineProperty(__dcg_chunk_exports__, 'Rb', { get: () => VM });\nObject.defineProperty(__dcg_chunk_exports__, 'Sb', { get: () => J_ });\nObject.defineProperty(__dcg_chunk_exports__, 'Tb', { get: () => BM });\nObject.defineProperty(__dcg_chunk_exports__, 'Ub', { get: () => Q_ });\nObject.defineProperty(__dcg_chunk_exports__, 'Vb', { get: () => uL });\nObject.defineProperty(__dcg_chunk_exports__, 'Wb', { get: () => pL });\nObject.defineProperty(__dcg_chunk_exports__, 'Xb', { get: () => fL });\nObject.defineProperty(__dcg_chunk_exports__, 'Yb', { get: () => Mo });\nObject.defineProperty(__dcg_chunk_exports__, 'Zb', { get: () => zs });\nObject.defineProperty(__dcg_chunk_exports__, '_b', { get: () => v8 });\nObject.defineProperty(__dcg_chunk_exports__, '$b', { get: () => DL });\nObject.defineProperty(__dcg_chunk_exports__, 'ac', { get: () => vP });\nObject.defineProperty(__dcg_chunk_exports__, 'bc', { get: () => _D });\nObject.defineProperty(__dcg_chunk_exports__, 'cc', { get: () => ks });\nObject.defineProperty(__dcg_chunk_exports__, 'dc', { get: () => zm });\nObject.defineProperty(__dcg_chunk_exports__, 'ec', { get: () => qD });\nObject.defineProperty(__dcg_chunk_exports__, 'fc', { get: () => ln });\nObject.defineProperty(__dcg_chunk_exports__, 'gc', { get: () => Pe });\nObject.defineProperty(__dcg_chunk_exports__, 'hc', { get: () => UP });\nObject.defineProperty(__dcg_chunk_exports__, 'ic', { get: () => Ha });\nObject.defineProperty(__dcg_chunk_exports__, 'jc', { get: () => xv });\nObject.defineProperty(__dcg_chunk_exports__, 'kc', { get: () => Nv });\nObject.defineProperty(__dcg_chunk_exports__, 'lc', { get: () => ys });\nObject.defineProperty(__dcg_chunk_exports__, 'mc', { get: () => uO });\nObject.defineProperty(__dcg_chunk_exports__, 'nc', { get: () => Co });\nObject.defineProperty(__dcg_chunk_exports__, 'oc', { get: () => OO });\nObject.defineProperty(__dcg_chunk_exports__, 'pc', { get: () => SO });\nObject.defineProperty(__dcg_chunk_exports__, 'qc', { get: () => RO });\nObject.defineProperty(__dcg_chunk_exports__, 'rc', { get: () => _o });\nObject.defineProperty(__dcg_chunk_exports__, 'sc', { get: () => nV });\nObject.defineProperty(__dcg_chunk_exports__, 'tc', { get: () => Q$ });\nObject.defineProperty(__dcg_chunk_exports__, 'uc', { get: () => xy });\nObject.defineProperty(__dcg_chunk_exports__, 'vc', { get: () => BO });\nObject.defineProperty(__dcg_chunk_exports__, 'wc', { get: () => pa });\nObject.defineProperty(__dcg_chunk_exports__, 'xc', { get: () => K7 });\nObject.defineProperty(__dcg_chunk_exports__, 'yc', { get: () => BT });\nObject.defineProperty(__dcg_chunk_exports__, 'zc', { get: () => GT });\nObject.defineProperty(__dcg_chunk_exports__, 'Ac', { get: () => zT });\nObject.defineProperty(__dcg_chunk_exports__, 'Bc', { get: () => kT });\nObject.defineProperty(__dcg_chunk_exports__, 'Cc', { get: () => Vo });\nObject.defineProperty(__dcg_chunk_exports__, 'Dc', { get: () => Xi });\nObject.defineProperty(__dcg_chunk_exports__, 'Ec', { get: () => XO });\nObject.defineProperty(__dcg_chunk_exports__, 'Fc', { get: () => fZ });\nObject.defineProperty(__dcg_chunk_exports__, 'Gc', { get: () => dZ });\nObject.defineProperty(__dcg_chunk_exports__, 'Hc', { get: () => JO });\nObject.defineProperty(__dcg_chunk_exports__, 'Ic', { get: () => QO });\nObject.defineProperty(__dcg_chunk_exports__, 'Jc', { get: () => mZ });\nObject.defineProperty(__dcg_chunk_exports__, 'Kc', { get: () => Np });\nObject.defineProperty(__dcg_chunk_exports__, 'Lc', { get: () => yZ });\nObject.defineProperty(__dcg_chunk_exports__, 'Mc', { get: () => FV });\nObject.defineProperty(__dcg_chunk_exports__, 'Nc', { get: () => gZ });\nObject.defineProperty(__dcg_chunk_exports__, 'Oc', { get: () => hZ });\nObject.defineProperty(__dcg_chunk_exports__, 'Pc', { get: () => bZ });\nObject.defineProperty(__dcg_chunk_exports__, 'Qc', { get: () => bS });\nObject.defineProperty(__dcg_chunk_exports__, 'Rc', { get: () => n9 });\nObject.defineProperty(__dcg_chunk_exports__, 'Sc', { get: () => _p });\nObject.defineProperty(__dcg_chunk_exports__, 'Tc', { get: () => Ay });\nObject.defineProperty(__dcg_chunk_exports__, 'Uc', { get: () => a9 });\nObject.defineProperty(__dcg_chunk_exports__, 'Vc', { get: () => c9 });\nObject.defineProperty(__dcg_chunk_exports__, 'Wc', { get: () => l9 });\nObject.defineProperty(__dcg_chunk_exports__, 'Xc', { get: () => MS });\nObject.defineProperty(__dcg_chunk_exports__, 'Yc', { get: () => p9 });\nObject.defineProperty(__dcg_chunk_exports__, 'Zc', { get: () => a3 });\nObject.defineProperty(__dcg_chunk_exports__, '_c', { get: () => m9 });\nObject.defineProperty(__dcg_chunk_exports__, '$c', { get: () => y9 });\nObject.defineProperty(__dcg_chunk_exports__, 'ad', { get: () => vS });\nObject.defineProperty(__dcg_chunk_exports__, 'bd', { get: () => OS });\nObject.defineProperty(__dcg_chunk_exports__, 'cd', { get: () => Cy });\nObject.defineProperty(__dcg_chunk_exports__, 'dd', { get: () => SS });\nObject.defineProperty(__dcg_chunk_exports__, 'ed', { get: () => RS });\nObject.defineProperty(__dcg_chunk_exports__, 'fd', { get: () => NS });\nObject.defineProperty(__dcg_chunk_exports__, 'gd', { get: () => R9 });\nObject.defineProperty(__dcg_chunk_exports__, 'hd', { get: () => N9 });\nObject.defineProperty(__dcg_chunk_exports__, 'id', { get: () => u3 });\nObject.defineProperty(__dcg_chunk_exports__, 'jd', { get: () => A9 });\nObject.defineProperty(__dcg_chunk_exports__, 'kd', { get: () => C9 });\nObject.defineProperty(__dcg_chunk_exports__, 'ld', { get: () => Jc });\nObject.defineProperty(__dcg_chunk_exports__, 'md', { get: () => Z3 });\nObject.defineProperty(__dcg_chunk_exports__, 'nd', { get: () => gr });\nObject.defineProperty(__dcg_chunk_exports__, 'od', { get: () => zy });\nObject.defineProperty(__dcg_chunk_exports__, 'pd', { get: () => rB });\nObject.defineProperty(__dcg_chunk_exports__, 'qd', { get: () => _R });\nObject.defineProperty(__dcg_chunk_exports__, 'rd', { get: () => LG });\nObject.defineProperty(__dcg_chunk_exports__, 'sd', { get: () => U0 });\nObject.defineProperty(__dcg_chunk_exports__, 'td', { get: () => k0 });\nObject.defineProperty(__dcg_chunk_exports__, 'ud', { get: () => kB });\nObject.defineProperty(__dcg_chunk_exports__, 'vd', { get: () => qB });\nObject.defineProperty(__dcg_chunk_exports__, 'wd', { get: () => Hp });\nObject.defineProperty(__dcg_chunk_exports__, 'xd', { get: () => Up });\nObject.defineProperty(__dcg_chunk_exports__, 'yd', { get: () => Wy });\nObject.defineProperty(__dcg_chunk_exports__, 'zd', { get: () => YR });\n\n    return __dcg_chunk_exports__;\n  })();"
  const __dcg_shared_module_exports__ = eval(__dcg_shared_module_source__);
  const __dcg_worker_source_exports__ = (function () {
    // worker.js
    const __dcg_worker_source__ = `
      // store the code for the worker module as a function that takes the shared module exports as an argument
      const __dcg_worker_module__ = (__dcg_shared_module_exports__) => {
` + "var o={};__dcg_shared_module_exports__['rd'].log=function(e){self.postMessage({log:JSON.stringify(e)})};var a=self;a.window=a;a.onmessage=function(e){var n=e.data&&e.data.connectionId;if(n)if(e.data.originalMessage.type===\"destroy\")delete o[n];else{var s=o[n];s||(s=new __dcg_shared_module_exports__['zd'](function(g,c){a.postMessage({connectionId:n,originalMessage:{type:g,payload:c}})}),o[n]=s),s.processChangeSet(e.data.originalMessage)}};a.loadMessageQueue&&(a.loadMessageQueue.forEach(function(e){a.onmessage(e)}),delete a.loadMessageQueue);\n" + `
      };
      // execute the shared module store its exports
      const __dcg_worker_shared_module_exports__ = ${__dcg_shared_module_source__};
      // call the worker module, passing in the shared module exports
      __dcg_worker_module__(__dcg_worker_shared_module_exports__);`

    let createWorker;
    if (typeof Blob !== 'undefined' && URL && typeof URL.createObjectURL === 'function') {
      createWorker = () => {
        const workerURL = URL.createObjectURL(new Blob([__dcg_worker_source__], { type: 'application/javascript' }))
        const worker = new Worker(workerURL);
        worker.revokeObjectURL = () => {
          URL.revokeObjectURL(workerURL);
        }
        return worker;
      }
    } else {
      // Just for testing in Node
      createWorker = () => {
        (new Function(__dcg_worker_source__))();
      }
    }

    return {createWorker, default: {createWorker}};
  })();
  function AD(r){return r==null?r+"":typeof r=="object"||typeof r=="function"?MD[j2.call(r)]||"object":typeof r}function gV(r){var e=!!r&&"length"in r&&r.length,t=AD(r);return Tp(r)||_m(r)?!1:t==="array"||e===0||typeof e=="number"&&e>0&&e-1 in r}function Am(r,e){return r.nodeName&&r.nodeName.toLowerCase()===e.toLowerCase()}function Q6(r,e){return e.toUpperCase()}function kp(r){return r.replace(J6,"ms-").replace(X6,Q6)}function jy(){this.expando=oe.expando+jy.uid++}function t7(r){return r==="true"?!0:r==="false"?!1:r==="null"?null:r===+r+""?+r:Z6.test(r)?JSON.parse(r):r}function F2(r,e,t){var i;if(t===void 0&&r.nodeType===1)if(i="data-"+e.replace(e7,"-$&").toLowerCase(),t=r.getAttribute(i),typeof t=="string"){try{t=t7(t)}catch(o){}Ep.set(r,e,t)}else t=void 0;return t}function i7(r,e,t,i){var o,n,a=20,s=i?function(){return i.cur()}:function(){return oe.css(r,e,"")},l=s(),c=t&&t[3]||(oe.cssNumber[e]?"":"px"),p=r.nodeType&&(oe.cssNumber[e]||c!=="px"&&+l)&&LD.exec(oe.css(r,e));if(p&&p[3]!==c){for(l=l/2,c=c||p[3],p=+l||1;a--;)oe.style(r,e,p+c),(1-n)*(1-(n=s()/l||.5))<=0&&(a=0),p=p/n;p=p*2,oe.style(r,e,p+c),t=t||[]}return t&&(p=+p||+l||0,o=t[1]?p+(t[1]+1)*t[2]:+t[2],i&&(i.unit=c,i.start=p,i.end=o)),o}function Om(){return!0}function Pm(){return!1}function o7(r,e){return r===n7()==(e==="focus")}function n7(){try{return ra.activeElement}catch(r){}}function bV(r,e,t,i,o,n){var a,s;if(typeof e=="object"){typeof t!="string"&&(i=i||t,t=void 0);for(s in e)bV(r,s,t,i,e[s],n);return r}if(i==null&&o==null?(o=t,i=t=void 0):o==null&&(typeof t=="string"?(o=i,i=void 0):(o=i,i=t,t=void 0)),o===!1)o=Pm;else if(!o)return r;return n===1&&(a=o,o=function(l){return oe().off(l),a.apply(this,arguments)},o.guid=a.guid||(a.guid=oe.guid++)),r.each(function(){oe.event.add(this,e,o,i,t)})}function VD(r,e,t){if(!t){To.get(r,e)===void 0&&oe.event.add(r,e,Om);return}To.set(r,e,!1),oe.event.add(r,e,{namespace:!1,handler:function(i){var o,n,a=To.get(this,e);if(i.isTrigger&1&&this[e]){if(a.length)(oe.event.special[e]||{}).delegateType&&i.stopPropagation();else if(a=GD.call(arguments),To.set(this,e,a),o=t(this,e),this[e](),n=To.get(this,e),a!==n||o?To.set(this,e,!1):n={},a!==n)return i.stopImmediatePropagation(),i.preventDefault(),n&&n.value}else a.length&&(To.set(this,e,{value:oe.event.trigger(oe.extend(a[0],oe.Event.prototype),a.slice(1),this)}),i.stopImmediatePropagation())}})}function Wy(r,e,t){var i,o,n,a,s=r.style;return t=t||OD(r),t&&(a=t.getPropertyValue(e)||t[e],a===""&&!Z2(r)&&(a=oe.style(r,e)),!ia.pixelBoxStyles()&&wV.test(a)&&a7.test(e)&&(i=s.width,o=s.minWidth,n=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=t.width,s.width=i,s.minWidth=o,s.maxWidth=n)),a!==void 0?a+"":a}function t_(r,e){return{get:function(){if(r()){delete this.get;return}return(this.get=e).apply(this,arguments)}}}function s7(r){for(var e=r[0].toUpperCase()+r.slice(1),t=N2.length;t--;)if(r=N2[t]+e,r in r_)return r}function q2(r){var e=oe.cssProps[r]||B2[r];return e||(r in r_?r:B2[r]=s7(r)||r)}function i_(r,e,t){var i=LD.exec(e);return i?Math.max(0,i[2]-(t||0))+(i[3]||"px"):e}function yV(r,e,t,i,o,n){var a=e==="width"?1:0,s=0,l=0;if(t===(i?"border":"content"))return 0;for(;a<4;a+=2)t==="margin"&&(l+=oe.css(r,t+Tu[a],!0,o)),i?(t==="content"&&(l-=oe.css(r,"padding"+Tu[a],!0,o)),t!=="margin"&&(l-=oe.css(r,"border"+Tu[a]+"Width",!0,o))):(l+=oe.css(r,"padding"+Tu[a],!0,o),t!=="padding"?l+=oe.css(r,"border"+Tu[a]+"Width",!0,o):s+=oe.css(r,"border"+Tu[a]+"Width",!0,o));return!i&&n>=0&&(l+=Math.max(0,Math.ceil(r["offset"+e[0].toUpperCase()+e.slice(1)]-n-l-s-.5))||0),l}function U2(r,e,t){var i=OD(r),o=!ia.boxSizingReliable()||t,n=o&&oe.css(r,"boxSizing",!1,i)==="border-box",a=n,s=Wy(r,e,i),l="offset"+e[0].toUpperCase()+e.slice(1);if(wV.test(s)){if(!t)return s;s="auto"}return(!ia.boxSizingReliable()&&n||!ia.reliableTrDimensions()&&Am(r,"tr")||s==="auto"||!parseFloat(s)&&oe.css(r,"display",!1,i)==="inline")&&r.getClientRects().length&&(n=oe.css(r,"boxSizing",!1,i)==="border-box",a=l in r,a&&(s=r[l])),s=parseFloat(s)||0,s+yV(r,e,t||(n?"border":"content"),a,i,s)+"px"}function xV(r,e,t,i){var o;if(Array.isArray(e))oe.each(e,function(n,a){t||d7.test(r)?i(r,a):xV(r+"["+(typeof a=="object"&&a!=null?n:"")+"]",a,t,i)});else if(!t&&AD(e)==="object")for(o in e)xV(r+"["+o+"]",e[o],t,i);else i(r,e)}var Gp,U6,GD,H6,$2,W6,MD,j2,TD,Y2,$6,ia,Tp,_m,ra,J2,oe,j6,X2,Y6,fV,$y,J6,X6,ID,To,Ep,Z6,e7,Q2,LD,Tu,Lm,Z2,r7,mV,R2,wV,OD,e_,a7,N2,r_,B2,l7,K2,c7,z2,H2,W2,d7,p7,u7,h7,H,xt=__dcg_shared_module_exports__['e'](()=>{"use strict";Gp=[],U6=Object.getPrototypeOf,GD=Gp.slice,H6=Gp.flat?function(r){return Gp.flat.call(r)}:function(r){return Gp.concat.apply([],r)},$2=Gp.push,W6=Gp.indexOf,MD={},j2=MD.toString,TD=MD.hasOwnProperty,Y2=TD.toString,$6=Y2.call(Object),ia={},Tp=function(e){return typeof e=="function"&&typeof e.nodeType!="number"&&typeof e.item!="function"},_m=function(e){return e!=null&&e===e.window},ra=window.document;J2="3.6.0",oe=function(r,e){return new oe.fn.init(r,e)};oe.fn=oe.prototype={jquery:J2,constructor:oe,length:0,toArray:function(){return GD.call(this)},get:function(r){return r==null?GD.call(this):r<0?this[r+this.length]:this[r]},pushStack:function(r){var e=oe.merge(this.constructor(),r);return e.prevObject=this,e},each:function(r){return oe.each(this,r)},map:function(r){return this.pushStack(oe.map(this,function(e,t){return r.call(e,t,e)}))},slice:function(){return this.pushStack(GD.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(oe.grep(this,function(r,e){return(e+1)%2}))},odd:function(){return this.pushStack(oe.grep(this,function(r,e){return e%2}))},eq:function(r){var e=this.length,t=+r+(r<0?e:0);return this.pushStack(t>=0&&t<e?[this[t]]:[])},end:function(){return this.prevObject||this.constructor()},push:$2,sort:Gp.sort,splice:Gp.splice};oe.extend=oe.fn.extend=function(){var r,e,t,i,o,n,a=arguments[0]||{},s=1,l=arguments.length,c=!1;for(typeof a=="boolean"&&(c=a,a=arguments[s]||{},s++),typeof a!="object"&&!Tp(a)&&(a={}),s===l&&(a=this,s--);s<l;s++)if((r=arguments[s])!=null)for(e in r)i=r[e],!(e==="__proto__"||a===i)&&(c&&i&&(oe.isPlainObject(i)||(o=Array.isArray(i)))?(t=a[e],o&&!Array.isArray(t)?n=[]:!o&&!oe.isPlainObject(t)?n={}:n=t,o=!1,a[e]=oe.extend(c,n,i)):i!==void 0&&(a[e]=i));return a};oe.extend({expando:"jQuery"+(J2+Math.random()).replace(/\D/g,""),isReady:!0,error:function(r){throw new Error(r)},noop:function(){},isPlainObject:function(r){var e,t;return!r||j2.call(r)!=="[object Object]"?!1:(e=U6(r),e?(t=TD.call(e,"constructor")&&e.constructor,typeof t=="function"&&Y2.call(t)===$6):!0)},isEmptyObject:function(r){var e;for(e in r)return!1;return!0},each:function(r,e){var t,i=0;if(gV(r))for(t=r.length;i<t&&e.call(r[i],i,r[i])!==!1;i++);else for(i in r)if(e.call(r[i],i,r[i])===!1)break;return r},makeArray:function(r,e){var t=e||[];return r!=null&&(gV(Object(r))?oe.merge(t,typeof r=="string"?[r]:r):$2.call(t,r)),t},inArray:function(r,e,t){return e==null?-1:W6.call(e,r,t)},merge:function(r,e){for(var t=+e.length,i=0,o=r.length;i<t;i++)r[o++]=e[i];return r.length=o,r},grep:function(r,e,t){for(var i,o=[],n=0,a=r.length,s=!t;n<a;n++)i=!e(r[n],n),i!==s&&o.push(r[n]);return o},map:function(r,e,t){var i,o,n=0,a=[];if(gV(r))for(i=r.length;n<i;n++)o=e(r[n],n,t),o!=null&&a.push(o);else for(n in r)o=e(r[n],n,t),o!=null&&a.push(o);return H6(a)},guid:1,support:ia});typeof Symbol=="function"&&(oe.fn[Symbol.iterator]=Gp[Symbol.iterator]);oe.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(r,e){MD["[object "+e+"]"]=e.toLowerCase()});j6=function(r){var e,t,i,o,n,a,s,l=r.document,c=[],p=c.push,u=c.push,m=c.slice,h=/HTML$/i,x=/^[^{]+\{\s*\[native \w/,C=function(){i()};try{u.apply(c=m.call(l.childNodes),l.childNodes),c[l.childNodes.length].nodeType}catch(M){u={apply:c.length?function(I,S){p.apply(I,m.call(S))}:function(I,S){for(var V=I.length,P=0;I[V++]=S[P++];);I.length=V-1}}}function D(){}function k(M){var I=o.createElement("fieldset");try{return!!M(I)}catch(S){return!1}finally{I.parentNode&&I.parentNode.removeChild(I),I=null}}return e=D.support={},t=D.isXML=function(M){var I=M&&M.namespaceURI,S=M&&(M.ownerDocument||M).documentElement;return!h.test(I||S&&S.nodeName||"HTML")},i=D.setDocument=function(M){var I,S,V=M?M.ownerDocument||M:l;return V==o||V.nodeType!==9||!V.documentElement||(o=V,n=o.documentElement,a=!t(o),l!=o&&(S=o.defaultView)&&S.top!==S&&(S.addEventListener?S.addEventListener("unload",C,!1):S.attachEvent&&S.attachEvent("onunload",C)),e.attributes=k(function(P){return P.className="i",!P.getAttribute("className")}),e.getElementsByTagName=k(function(P){return P.appendChild(o.createComment("")),!P.getElementsByTagName("*").length}),I=x.test(n.compareDocumentPosition),s=I||x.test(n.contains)?function(P,L){var B=P.nodeType===9?P.documentElement:P,R=L&&L.parentNode;return P===R||!!(R&&R.nodeType===1&&(B.contains?B.contains(R):P.compareDocumentPosition&&P.compareDocumentPosition(R)&16))}:function(P,L){if(L){for(;L=L.parentNode;)if(L===P)return!0}return!1}),o},D.contains=function(M,I){return(M.ownerDocument||M)!=o&&i(M),s(M,I)},i(),e.sortDetached=k(function(M){return M.compareDocumentPosition(o.createElement("fieldset"))&1}),D}(window);oe.contains=j6.contains;Y6=oe.fn.init=function(r,e,t){if(!r)return this;if(t=t||X2,typeof r=="string")throw new Error("$(string) implementation has been removed");if(r.nodeType)return this[0]=r,this.length=1,this;if(Tp(r))throw new Error("$(function) implementation has been removed");return oe.makeArray(r,this)};Y6.prototype=oe.fn;X2=oe(ra);fV=/[^\x20\t\r\n\f]+/g,$y=function(r,e,t,i,o,n,a){var s=0,l=r.length,c=t==null;if(AD(t)==="object"){o=!0;for(s in t)$y(r,e,s,t[s],!0,n,a)}else if(i!==void 0&&(o=!0,Tp(i)||(a=!0),c&&(a?(e.call(r,i),e=null):(c=e,e=function(p,u,m){return c.call(oe(p),m)})),e))for(;s<l;s++)e(r[s],t,a?i:i.call(r[s],s,e(r[s],t)));return o?r:c?e.call(r):l?e(r[0],t):n},J6=/^-ms-/,X6=/-([a-z])/g;ID=function(r){return r.nodeType===1||r.nodeType===9||!+r.nodeType};jy.uid=1;jy.prototype={cache:function(r){var e=r[this.expando];return e||(e={},ID(r)&&(r.nodeType?r[this.expando]=e:Object.defineProperty(r,this.expando,{value:e,configurable:!0}))),e},set:function(r,e,t){var i,o=this.cache(r);if(typeof e=="string")o[kp(e)]=t;else for(i in e)o[kp(i)]=e[i];return o},get:function(r,e){return e===void 0?this.cache(r):r[this.expando]&&r[this.expando][kp(e)]},access:function(r,e,t){return e===void 0||e&&typeof e=="string"&&t===void 0?this.get(r,e):(this.set(r,e,t),t!==void 0?t:e)},remove:function(r,e){var t,i=r[this.expando];if(i!==void 0){if(e!==void 0)for(Array.isArray(e)?e=e.map(kp):(e=kp(e),e=e in i?[e]:e.match(fV)||[]),t=e.length;t--;)delete i[e[t]];(e===void 0||oe.isEmptyObject(i))&&(r.nodeType?r[this.expando]=void 0:delete r[this.expando])}},hasData:function(r){var e=r[this.expando];return e!==void 0&&!oe.isEmptyObject(e)}};To=new jy,Ep=new jy,Z6=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,e7=/[A-Z]/g;oe.extend({hasData:function(r){return Ep.hasData(r)||To.hasData(r)},data:function(r,e,t){return Ep.access(r,e,t)},removeData:function(r,e){Ep.remove(r,e)},_data:function(r,e,t){return To.access(r,e,t)},_removeData:function(r,e){To.remove(r,e)}});oe.fn.extend({data:function(r,e){var t,i,o,n=this[0],a=n&&n.attributes;if(r===void 0){if(this.length&&(o=Ep.get(n),n.nodeType===1&&!To.get(n,"hasDataAttrs"))){for(t=a.length;t--;)a[t]&&(i=a[t].name,i.indexOf("data-")===0&&(i=kp(i.slice(5)),F2(n,i,o[i])));To.set(n,"hasDataAttrs",!0)}return o}return typeof r=="object"?this.each(function(){Ep.set(this,r)}):$y(this,function(s){var l;if(n&&s===void 0)return l=Ep.get(n,r),l!==void 0||(l=F2(n,r),l!==void 0)?l:void 0;this.each(function(){Ep.set(this,r,s)})},null,e,arguments.length>1,null,!0)},removeData:function(r){return this.each(function(){Ep.remove(this,r)})}});Q2=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,LD=new RegExp("^(?:([+-])=|)("+Q2+")([a-z%]*)$","i"),Tu=["Top","Right","Bottom","Left"],Lm=ra.documentElement,Z2=function(r){return oe.contains(r.ownerDocument,r)},r7={composed:!0};Lm.getRootNode&&(Z2=function(r){return oe.contains(r.ownerDocument,r)||r.getRootNode(r7)===r.ownerDocument});mV=/^(?:checkbox|radio)$/i;(function(){var r=ra.createDocumentFragment(),e=r.appendChild(ra.createElement("div")),t=ra.createElement("input");t.setAttribute("type","radio"),t.setAttribute("checked","checked"),t.setAttribute("name","t"),e.appendChild(t),ia.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",ia.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue,e.innerHTML="<option></option>",ia.option=!!e.lastChild})();R2=/^([^.]*)(?:\.(.+)|)/;oe.event={global:{},add:function(r,e,t,i,o){var n,a,s,l,c,p,u,m,h,x,C,D=To.get(r);if(ID(r)){if(t.handler&&(n=t,t=n.handler,o=n.selector),o)throw new Error("Support for event delegation has been removed");for(t.guid||(t.guid=oe.guid++),(l=D.events)||(l=D.events=Object.create(null)),(a=D.handle)||(a=D.handle=function(k){return typeof oe!="undefined"&&oe.event.triggered!==k.type?oe.event.dispatch.apply(r,arguments):void 0}),e=(e||"").match(fV)||[""],c=e.length;c--;)if(s=R2.exec(e[c])||[],h=C=s[1],x=(s[2]||"").split(".").sort(),!!h){if(u=oe.event.special[h]||{},h=(o?u.delegateType:u.bindType)||h,u=oe.event.special[h]||{},p=oe.extend({type:h,origType:C,data:i,handler:t,guid:t.guid,selector:o,namespace:x.join(".")},n),(m=l[h])||(m=l[h]=[],m.delegateCount=0,(!u.setup||u.setup.call(r,i,x,a)===!1)&&r.addEventListener&&r.addEventListener(h,a)),u.add&&(u.add.call(r,p),p.handler.guid||(p.handler.guid=t.guid)),o)throw new Error("Support for event delegation has been removed");m.push(p),oe.event.global[h]=!0}}},remove:function(r,e,t,i,o){var n,a,s,l,c,p,u,m,h,x,C,D=To.hasData(r)&&To.get(r);if(!(!D||!(l=D.events))){for(e=(e||"").match(fV)||[""],c=e.length;c--;){if(s=R2.exec(e[c])||[],h=C=s[1],x=(s[2]||"").split(".").sort(),!h){for(h in l)oe.event.remove(r,h+e[c],t,i,!0);continue}for(u=oe.event.special[h]||{},h=(i?u.delegateType:u.bindType)||h,m=l[h]||[],s=s[2]&&new RegExp("(^|\\.)"+x.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=n=m.length;n--;)p=m[n],(o||C===p.origType)&&(!t||t.guid===p.guid)&&(!s||s.test(p.namespace))&&(!i||i===p.selector||i==="**"&&p.selector)&&(m.splice(n,1),p.selector&&m.delegateCount--,u.remove&&u.remove.call(r,p));a&&!m.length&&((!u.teardown||u.teardown.call(r,x,D.handle)===!1)&&oe.removeEvent(r,h,D.handle),delete l[h])}oe.isEmptyObject(l)&&To.remove(r,"handle events")}},dispatch:function(r){var e,t,i,o,n,a,s=new Array(arguments.length),l=oe.event.fix(r),c=(To.get(this,"events")||Object.create(null))[l.type]||[],p=oe.event.special[l.type]||{};for(s[0]=l,e=1;e<arguments.length;e++)s[e]=arguments[e];if(l.delegateTarget=this,!(p.preDispatch&&p.preDispatch.call(this,l)===!1)){for(a=oe.event.handlers.call(this,l,c),e=0;(o=a[e++])&&!l.isPropagationStopped();)for(l.currentTarget=o.elem,t=0;(n=o.handlers[t++])&&!l.isImmediatePropagationStopped();)(!l.rnamespace||n.namespace===!1||l.rnamespace.test(n.namespace))&&(l.handleObj=n,l.data=n.data,i=((oe.event.special[n.origType]||{}).handle||n.handler).apply(o.elem,s),i!==void 0&&(l.result=i)===!1&&(l.preventDefault(),l.stopPropagation()));return p.postDispatch&&p.postDispatch.call(this,l),l.result}},handlers:function(r,e){var t=[],i=e.delegateCount,o=r.target;if(i)throw new Error("Support for event delegtaion has been removed");return o=this,i<e.length&&t.push({elem:o,handlers:e.slice(i)}),t},addProp:function(r,e){Object.defineProperty(oe.Event.prototype,r,{enumerable:!0,configurable:!0,get:Tp(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[r]},set:function(t){Object.defineProperty(this,r,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(r){return r[oe.expando]?r:new oe.Event(r)},special:{load:{noBubble:!0},click:{setup:function(r){var e=this||r;return mV.test(e.type)&&e.click&&Am(e,"input")&&VD(e,"click",Om),!1},trigger:function(r){var e=this||r;return mV.test(e.type)&&e.click&&Am(e,"input")&&VD(e,"click"),!0},_default:function(r){var e=r.target;return mV.test(e.type)&&e.click&&Am(e,"input")&&To.get(e,"click")||Am(e,"a")}},beforeunload:{postDispatch:function(r){r.result!==void 0&&r.originalEvent&&(r.originalEvent.returnValue=r.result)}}}};oe.removeEvent=function(r,e,t){r.removeEventListener&&r.removeEventListener(e,t)};oe.Event=function(r,e){if(!(this instanceof oe.Event))return new oe.Event(r,e);r&&r.type?(this.originalEvent=r,this.type=r.type,this.isDefaultPrevented=r.defaultPrevented||r.defaultPrevented===void 0&&r.returnValue===!1?Om:Pm,this.target=r.target&&r.target.nodeType===3?r.target.parentNode:r.target,this.currentTarget=r.currentTarget,this.relatedTarget=r.relatedTarget):this.type=r,e&&oe.extend(this,e),this.timeStamp=r&&r.timeStamp||Date.now(),this[oe.expando]=!0};oe.Event.prototype={constructor:oe.Event,isDefaultPrevented:Pm,isPropagationStopped:Pm,isImmediatePropagationStopped:Pm,isSimulated:!1,preventDefault:function(){var r=this.originalEvent;this.isDefaultPrevented=Om,r&&!this.isSimulated&&r.preventDefault()},stopPropagation:function(){var r=this.originalEvent;this.isPropagationStopped=Om,r&&!this.isSimulated&&r.stopPropagation()},stopImmediatePropagation:function(){var r=this.originalEvent;this.isImmediatePropagationStopped=Om,r&&!this.isSimulated&&r.stopImmediatePropagation(),this.stopPropagation()}};oe.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},oe.event.addProp);oe.each({focus:"focusin",blur:"focusout"},function(r,e){oe.event.special[r]={setup:function(){return VD(this,r,o7),!1},trigger:function(){return VD(this,r),!0},_default:function(){return!0},delegateType:e}});oe.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(r,e){oe.event.special[r]={delegateType:e,bindType:e,handle:function(t){var i,o=this,n=t.relatedTarget,a=t.handleObj;return(!n||n!==o&&!oe.contains(o,n))&&(t.type=a.origType,i=a.handler.apply(this,arguments),t.type=e),i}}});oe.fn.extend({on:function(r,e,t,i){return bV(this,r,e,t,i)},one:function(r,e,t,i){return bV(this,r,e,t,i,1)},off:function(r,e,t){var i,o;if(r&&r.preventDefault&&r.handleObj)return i=r.handleObj,oe(r.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if(typeof r=="object"){for(o in r)this.off(o,e,r[o]);return this}return(e===!1||typeof e=="function")&&(t=e,e=void 0),t===!1&&(t=Pm),this.each(function(){oe.event.remove(this,r,t,e)})}});wV=new RegExp("^("+Q2+")(?!px)[a-z%]+$","i"),OD=function(r){var e=r.ownerDocument.defaultView;return(!e||!e.opener)&&(e=window),e.getComputedStyle(r)},e_=function(r,e,t){var i,o,n={};for(o in e)n[o]=r.style[o],r.style[o]=e[o];i=t.call(r);for(o in e)r.style[o]=n[o];return i},a7=new RegExp(Tu.join("|"),"i");(function(){function r(){if(c){l.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",Lm.appendChild(l).appendChild(c);var p=window.getComputedStyle(c);t=p.top!=="1%",s=e(p.marginLeft)===12,c.style.right="60%",n=e(p.right)===36,i=e(p.width)===36,c.style.position="absolute",o=e(c.offsetWidth/3)===12,Lm.removeChild(l),c=null}}function e(p){return Math.round(parseFloat(p))}var t,i,o,n,a,s,l=ra.createElement("div"),c=ra.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",ia.clearCloneStyle=c.style.backgroundClip==="content-box",oe.extend(ia,{boxSizingReliable:function(){return r(),i},pixelBoxStyles:function(){return r(),n},pixelPosition:function(){return r(),t},reliableMarginLeft:function(){return r(),s},scrollboxSize:function(){return r(),o},reliableTrDimensions:function(){var p,u,m,h;return a==null&&(p=ra.createElement("table"),u=ra.createElement("tr"),m=ra.createElement("div"),p.style.cssText="position:absolute;left:-11111px;border-collapse:separate",u.style.cssText="border:1px solid",u.style.height="1px",m.style.height="9px",m.style.display="block",Lm.appendChild(p).appendChild(u).appendChild(m),h=window.getComputedStyle(u),a=parseInt(h.height,10)+parseInt(h.borderTopWidth,10)+parseInt(h.borderBottomWidth,10)===u.offsetHeight,Lm.removeChild(p)),a}}))})();N2=["Webkit","Moz","ms"],r_=ra.createElement("div").style,B2={};l7=/^(none|table(?!-c[ea]).+)/,K2=/^--/,c7={position:"absolute",visibility:"hidden",display:"block"},z2={letterSpacing:"0",fontWeight:"400"};oe.extend({cssHooks:{opacity:{get:function(r,e){if(e){var t=Wy(r,"opacity");return t===""?"1":t}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(r,e,t,i){if(!(!r||r.nodeType===3||r.nodeType===8||!r.style)){var o,n,a,s=kp(e),l=K2.test(e),c=r.style;if(l||(e=q2(s)),a=oe.cssHooks[e]||oe.cssHooks[s],t!==void 0){if(n=typeof t,n==="string"&&(o=LD.exec(t))&&o[1]&&(t=i7(r,e,o),n="number"),t==null||t!==t)return;n==="number"&&!l&&(t+=o&&o[3]||(oe.cssNumber[s]?"":"px")),!ia.clearCloneStyle&&t===""&&e.indexOf("background")===0&&(c[e]="inherit"),(!a||!("set"in a)||(t=a.set(r,t,i))!==void 0)&&(l?c.setProperty(e,t):c[e]=t)}else return a&&"get"in a&&(o=a.get(r,!1,i))!==void 0?o:c[e]}},css:function(r,e,t,i){var o,n,a,s=kp(e),l=K2.test(e);return l||(e=q2(s)),a=oe.cssHooks[e]||oe.cssHooks[s],a&&"get"in a&&(o=a.get(r,!0,t)),o===void 0&&(o=Wy(r,e,i)),o==="normal"&&e in z2&&(o=z2[e]),t===""||t?(n=parseFloat(o),t===!0||isFinite(n)?n||0:o):o}});oe.each(["height","width"],function(r,e){oe.cssHooks[e]={get:function(t,i,o){if(i)return l7.test(oe.css(t,"display"))&&(!t.getClientRects().length||!t.getBoundingClientRect().width)?e_(t,c7,function(){return U2(t,e,o)}):U2(t,e,o)},set:function(t,i,o){var n,a=OD(t),s=!ia.scrollboxSize()&&a.position==="absolute",l=s||o,c=l&&oe.css(t,"boxSizing",!1,a)==="border-box",p=o?yV(t,e,o,c,a):0;return c&&s&&(p-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(a[e])-yV(t,e,"border",!1,a)-.5)),p&&(n=LD.exec(i))&&(n[3]||"px")!=="px"&&(t.style[e]=i,i=oe.css(t,e)),i_(t,i,p)}}});oe.cssHooks.marginLeft=t_(ia.reliableMarginLeft,function(r,e){if(e)return(parseFloat(Wy(r,"marginLeft"))||r.getBoundingClientRect().left-e_(r,{marginLeft:0},function(){return r.getBoundingClientRect().left}))+"px"});oe.each({margin:"",padding:"",border:"Width"},function(r,e){oe.cssHooks[r+e]={expand:function(t){for(var i=0,o={},n=typeof t=="string"?t.split(" "):[t];i<4;i++)o[r+Tu[i]+e]=n[i]||n[i-2]||n[0];return o}},r!=="margin"&&(oe.cssHooks[r+e].set=i_)});oe.fn.extend({css:function(r,e){return $y(this,function(t,i,o){var n,a,s={},l=0;if(Array.isArray(i)){for(n=OD(t),a=i.length;l<a;l++)s[i[l]]=oe.css(t,i[l],!1,n);return s}return o!==void 0?oe.style(t,i,o):oe.css(t,i)},r,e,arguments.length>1)}});(function(){var r=ra.createElement("input"),e=ra.createElement("select"),t=e.appendChild(ra.createElement("option"));r.type="checkbox",ia.checkOn=r.value!=="",ia.optSelected=t.selected,r=ra.createElement("input"),r.value="t",r.type="radio",ia.radioValue=r.value==="t"})();ia.focusin="onfocusin"in window;H2=/^(?:focusinfocus|focusoutblur)$/,W2=function(r){r.stopPropagation()};oe.extend(oe.event,{trigger:function(r,e,t,i){var o,n,a,s,l,c,p,u,m=[t||ra],h=TD.call(r,"type")?r.type:r,x=TD.call(r,"namespace")?r.namespace.split("."):[];if(n=u=a=t=t||ra,!(t.nodeType===3||t.nodeType===8)&&!H2.test(h+oe.event.triggered)&&(h.indexOf(".")>-1&&(x=h.split("."),h=x.shift(),x.sort()),l=h.indexOf(":")<0&&"on"+h,r=r[oe.expando]?r:new oe.Event(h,typeof r=="object"&&r),r.isTrigger=i?2:3,r.namespace=x.join("."),r.rnamespace=r.namespace?new RegExp("(^|\\.)"+x.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,r.result=void 0,r.target||(r.target=t),e=e==null?[r]:oe.makeArray(e,[r]),p=oe.event.special[h]||{},!(!i&&p.trigger&&p.trigger.apply(t,e)===!1))){if(!i&&!p.noBubble&&!_m(t)){for(s=p.delegateType||h,H2.test(s+h)||(n=n.parentNode);n;n=n.parentNode)m.push(n),a=n;a===(t.ownerDocument||ra)&&m.push(a.defaultView||a.parentWindow||window)}for(o=0;(n=m[o++])&&!r.isPropagationStopped();)u=n,r.type=o>1?s:p.bindType||h,c=(To.get(n,"events")||Object.create(null))[r.type]&&To.get(n,"handle"),c&&c.apply(n,e),c=l&&n[l],c&&c.apply&&ID(n)&&(r.result=c.apply(n,e),r.result===!1&&r.preventDefault());return r.type=h,!i&&!r.isDefaultPrevented()&&(!p._default||p._default.apply(m.pop(),e)===!1)&&ID(t)&&l&&Tp(t[h])&&!_m(t)&&(a=t[l],a&&(t[l]=null),oe.event.triggered=h,r.isPropagationStopped()&&u.addEventListener(h,W2),t[h](),r.isPropagationStopped()&&u.removeEventListener(h,W2),oe.event.triggered=void 0,a&&(t[l]=a)),r.result}},simulate:function(r,e,t){var i=oe.extend(new oe.Event,t,{type:r,isSimulated:!0});oe.event.trigger(i,null,e)}});oe.fn.extend({trigger:function(r,e){return this.each(function(){oe.event.trigger(r,e,this)})},triggerHandler:function(r,e){var t=this[0];if(t)return oe.event.trigger(r,e,t,!0)}});ia.focusin||oe.each({focus:"focusin",blur:"focusout"},function(r,e){var t=function(i){oe.event.simulate(e,i.target,oe.event.fix(i))};oe.event.special[e]={setup:function(){var i=this.ownerDocument||this.document||this,o=To.access(i,e);o||i.addEventListener(r,t,!0),To.access(i,e,(o||0)+1)},teardown:function(){var i=this.ownerDocument||this.document||this,o=To.access(i,e)-1;o?To.access(i,e,o):(i.removeEventListener(r,t,!0),To.remove(i,e))}}});d7=/\[\]$/;oe.param=function(r,e){var t,i=[],o=function(n,a){var s=Tp(a)?a():a;i[i.length]=encodeURIComponent(n)+"="+encodeURIComponent(s==null?"":s)};if(r==null)return"";if(Array.isArray(r)||r.jquery&&!oe.isPlainObject(r))oe.each(r,function(){o(this.name,this.value)});else for(t in r)xV(t,r[t],e,o);return i.join("&")};oe.offset={setOffset:function(r,e,t){var i,o,n,a,s,l,c,p=oe.css(r,"position"),u=oe(r),m={};p==="static"&&(r.style.position="relative"),s=u.offset(),n=oe.css(r,"top"),l=oe.css(r,"left"),c=(p==="absolute"||p==="fixed")&&(n+l).indexOf("auto")>-1,c?(i=u.position(),a=i.top,o=i.left):(a=parseFloat(n)||0,o=parseFloat(l)||0),Tp(e)&&(e=e.call(r,t,oe.extend({},s))),e.top!=null&&(m.top=e.top-s.top+a),e.left!=null&&(m.left=e.left-s.left+o),"using"in e?e.using.call(r,m):u.css(m)}};oe.fn.extend({offset:function(r){if(arguments.length)return r===void 0?this:this.each(function(o){oe.offset.setOffset(this,r,o)});var e,t,i=this[0];if(i)return i.getClientRects().length?(e=i.getBoundingClientRect(),t=i.ownerDocument.defaultView,{top:e.top+t.pageYOffset,left:e.left+t.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var r,e,t,i=this[0],o={top:0,left:0};if(oe.css(i,"position")==="fixed")e=i.getBoundingClientRect();else{for(e=this.offset(),t=i.ownerDocument,r=i.offsetParent||t.documentElement;r&&(r===t.body||r===t.documentElement)&&oe.css(r,"position")==="static";)r=r.parentNode;r&&r!==i&&r.nodeType===1&&(o=oe(r).offset(),o.top+=oe.css(r,"borderTopWidth",!0),o.left+=oe.css(r,"borderLeftWidth",!0))}return{top:e.top-o.top-oe.css(i,"marginTop",!0),left:e.left-o.left-oe.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var r=this.offsetParent;r&&oe.css(r,"position")==="static";)r=r.offsetParent;return r||Lm})}});oe.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(r,e){var t=e==="pageYOffset";oe.fn[r]=function(i){return $y(this,function(o,n,a){var s;if(_m(o)?s=o:o.nodeType===9&&(s=o.defaultView),a===void 0)return s?s[e]:o[n];s?s.scrollTo(t?s.pageXOffset:a,t?a:s.pageYOffset):o[n]=a},r,i,arguments.length)}});oe.each(["top","left"],function(r,e){oe.cssHooks[e]=t_(ia.pixelPosition,function(t,i){if(i)return i=Wy(t,e),wV.test(i)?oe(t).position()[e]+"px":i})});oe.each({Height:"height",Width:"width"},function(r,e){oe.each({padding:"inner"+r,content:e,"":"outer"+r},function(t,i){oe.fn[i]=function(o,n){var a=arguments.length&&(t||typeof o!="boolean"),s=t||(o===!0||n===!0?"margin":"border");return $y(this,function(l,c,p){var u;return _m(l)?i.indexOf("outer")===0?l["inner"+r]:l.document.documentElement["client"+r]:l.nodeType===9?(u=l.documentElement,Math.max(l.body["scroll"+r],u["scroll"+r],l.body["offset"+r],u["offset"+r],u["client"+r])):p===void 0?oe.css(l,c,s):oe.style(l,c,p,s)},e,a?o:void 0,a)}})});oe.fn.extend({bind:function(r,e,t){return this.on(r,null,e,t)},unbind:function(r,e){return this.off(r,null,e)},delegate:function(r,e,t,i){return this.on(e,r,t,i)},undelegate:function(r,e,t){return arguments.length===1?this.off(r,"**"):this.off(e,r||"**",t)},hover:function(r,e){return this.mouseenter(r).mouseleave(e||r)}});oe.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(r,e){oe.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}});p7=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;oe.isArray=Array.isArray;oe.parseJSON=JSON.parse;oe.nodeName=Am;oe.isFunction=Tp;oe.isWindow=_m;oe.camelCase=kp;oe.type=AD;oe.now=Date.now;oe.isNumeric=function(r){var e=oe.type(r);return(e==="number"||e==="string")&&!isNaN(r-parseFloat(r))};oe.trim=function(r){return r==null?"":(r+"").replace(p7,"")};u7=window.jQuery,h7=window.$;oe.noConflict=function(r){return window.$===oe&&(window.$=h7),r&&window.jQuery===oe&&(window.jQuery=u7),oe};typeof noGlobal=="undefined"&&(window.jQuery=window.$=oe);H=oe});var Da,Lp=__dcg_shared_module_exports__['e'](()=>{Da=()=>{let r="";try{r=location.search,r[0]=="?"&&(r=r.slice(1))}catch(i){}let e=r.split("&"),t={};for(let i of e){let o=i.split("=");o.length==2?t[o[0]]=decodeURIComponent(o[1]):t[o[0]]=!0}return t}});function i9(r,e){if(e!=null){if(typeof r!="string")throw new Error("Must pass a string for an EventHandler name");if(typeof e!="function")throw new Error("Must pass a function for an EventHandler callback");return{bindings:{onMount:function(t){t[r.toLowerCase()]=function(i){i&&e.apply(this,arguments)}}}}}}var mF,fF=__dcg_shared_module_exports__['e'](()=>{mF=i9});function o9(r){var e=function(){return r};return e.isDCGViewConst=!0,e}function n9(r){return!!(typeof r=="function"&&r.isDCGViewConst)}var Tn,Ac=__dcg_shared_module_exports__['e'](()=>{Tn={isConst:n9,makeConst:o9}});function a9(r,e,t){t===void 0?r.removeAttribute(e):r.setAttribute(e,t+"")}var oS,ZV=__dcg_shared_module_exports__['e'](()=>{oS={update:a9}});function s9(r,e){var t=e(),i;return Tn.isConst(e)||(i={onUpdate:function(o){var n=e();n!==t&&(t=n,oS.update(o,r,n))}}),{value:t,bindings:i}}var bF,yF=__dcg_shared_module_exports__['e'](()=>{Ac();ZV();bF=s9});function l9(r){return r[0]==="o"&&r[1]==="n"&&r[2].toUpperCase()===r[2]}var xF,wF=__dcg_shared_module_exports__['e'](()=>{xF=l9});function c9(r,e){e1[r]=e}function d9(r){return e1.hasOwnProperty(r)}function p9(r,e){var t=e1[r];return t(e)}var e1,lx,t1=__dcg_shared_module_exports__['e'](()=>{e1={};lx={isCustomAttribute:d9,add:c9,parse:p9}});function u9(r,e,t){var i=r._bindings[e];i?i.push(t):r._bindings[e]=[t]}function h9(r,e){var t=r._bindings[e];if(t)for(var i=t.length,o=0;o<i;o++)t[o]()}var xs,cx=__dcg_shared_module_exports__['e'](()=>{xs={add:u9,invoke:h9}});function g9(r){nf.push(r)}function m9(r){var e=nf;nf=[];for(var t=0;t<e.length;t++){var i=e[t];i!==r&&nf.push(i)}}function f9(r,e){try{if(e&&e._isDCGView){r+=" ["+e._viewName+"]";var t=e.traceViewHierarchy();t.ancestors.length>0&&(r+=`
View Hierarchy:
`+t.formatted)}throw new Error(r)}catch(o){console.warn(o);for(var i=0;i<nf.length;i++)nf[i](o)}}var nf,Gd,dx=__dcg_shared_module_exports__['e'](()=>{nf=[];Gd={warn:f9,addWarningHandler:g9,removeWarningHandler:m9}});function x9(r,e,t){var i=!1;return function(){if(i){Gd.warn(r+" is a one-time binding but was called multiple times",t);return}i=!0,e.apply(this,arguments)}}function w9(r,e,t){var i=t.bindings;if(i)for(var o in i){var n=i[o];o in b9&&(n=n.bind(null,e)),o in y9&&(n=x9(o,n,r)),xs.add(r,o,n)}}function v9(r,e){if(typeof e!="function")throw new Error('The "'+r+'" attr must be a function. It is: '+JSON.stringify(e));return lx.isCustomAttribute(r)?lx.parse(r,e):xF(r)?mF(r,e):bF(r,e)}function C9(r,e,t){if(e)for(var i in e){var o=v9(i,e[i]);if(o){var n=o.value;n!==void 0&&t.setAttribute(i,n),o.bindings&&w9(r,t,o)}}}var b9,y9,vF,CF=__dcg_shared_module_exports__['e'](()=>{fF();yF();wF();t1();cx();dx();b9={onMount:!0,didMount:!0,willUnmount:!0,willUpdate:!0,onUpdate:!0,didUpdate:!0},y9={willMount:!0,onMount:!0,didMount:!0,willUnmount:!0,onUnmount:!0,didUnmount:!0};vF=C9});function D9(){DF=!0}function S9(r,e,t){if(typeof t!="function")throw new Error("bindText expects a function");var i=t();i==null&&(i="");var o=document.createTextNode(i);if(DF){var n=document.createElement("span");n.appendChild(o),e.appendChild(n)}else e.appendChild(o);xs.add(r,"onUpdate",function(){var a=t();a==null&&(a=""),i!==a&&(o.nodeValue=a,i=a)})}var DF,nS,r1=__dcg_shared_module_exports__['e'](()=>{cx();DF=!1;nS={bindText:S9,enableSpanWrapping:D9}});function SF(r,e){var t=document.createTextNode(e);r.appendChild(t)}function i1(r,e,t){if(this.tagName=r,this.attrs=e,this.children=t,Array.isArray(this.children))for(var i=0;i<this.children.length;i++){var o=typeof this.children[i];o!=="object"&&o!=="function"||(this.children[i]._parentElement=this)}}var k9,kF,EF=__dcg_shared_module_exports__['e'](()=>{CF();r1();Ac();dx();k9=nS.bindText;i1.prototype._isDCGElement=!0;i1.prototype.renderToDocFrag=function(r,e){if(this._domNode)throw new Error("Cannot remount a DCGElement");var t=this.children,i=document.createElement(this.tagName);this._domNode=i,vF(e,this.attrs,i),r.appendChild(i);for(var o=t.length,n=0;n<o;n++){var a=t[n];a._isDCGElement?a.renderToDocFrag(i,e):Tn.isConst(a)?SF(i,a()):typeof a=="function"?k9(e,i,a):(Gd.warn("Text should be a const or a getter: "+JSON.stringify(a),e),SF(i,a))}};kF=i1});function GF(r,e){if(r!=null)if(Array.isArray(r))for(var t=0;t<r.length;t++)GF(r[t],e);else e.push(r)}function E9(r,e){for(var t=[],i=arguments.length-1,o=2;o<=i;o++)GF(arguments[o],t);if(typeof r=="string")return new kF(r,e,t);if(r&&r._isDCGViewClass)return new r(e,t);throw new Error("createElement expects a String or DCGViewClass")}var Td,af=__dcg_shared_module_exports__['e'](()=>{EF();Td=E9});function G9(){for(var r=this._element;r._isDCGView;)r=r._element;return r._domNode}function T9(r,e){if(e&&e._childViews.push(this),this.__generatedHTMLBefore)throw new Error("Cannot remount a DCGView");if(this.__generatedHTMLBefore=!0,this._element.renderToDocFrag(r,this),Array.isArray(this._siblingElements))for(var t=0;t<this._siblingElements.length;t++)this._siblingElements[t].renderToDocFrag(r,this)}function I9(r,e,t){if(!r||!r._isDCGViewClass)throw new Error("Must pass a DCGView class to be mounted");if(!e||e.nodeType!==1)throw new Error("Must pass an HTMLElement for the node");if(e._mountedDCGView)throw new Error("This node is already mounted by a view");var i=new r(t),o=document.createDocumentFragment();return i.renderToDocFrag(o),e.innerHTML="",o1(i),e._mountedDCGView=i,e.appendChild(o),n1(i),a1(i),i}function V9(r){var e=r._mountedDCGView;if(!e)throw new Error("This node is not mounted by a DCGView");s1(e),r.innerHTML="",delete r._mountedDCGView,l1(e),c1(e)}function o1(r){r.willMount&&r.willMount(),xs.invoke(r,"willMount"),r._childViews.forEach(o1)}function n1(r){r._isMounted=!0,r.onMount&&r.onMount(),xs.invoke(r,"onMount"),r._childViews.forEach(n1)}function a1(r){r.didMount&&r.didMount(),xs.invoke(r,"didMount"),r._childViews.forEach(a1)}function s1(r){r.willUnmount&&r.willUnmount(),xs.invoke(r,"willUnmount"),r._childViews.forEach(s1)}function l1(r){r._isMounted=!1,r._childViews.forEach(l1),xs.invoke(r,"onUnmount"),r.onUnmount&&r.onUnmount()}function c1(r){r._childViews.forEach(c1),xs.invoke(r,"didUnmount"),r.didUnmount&&r.didUnmount()}function M9(r,e){var t=document.createDocumentFragment();return r.renderToDocFrag(t,e),t.firstChild}var Yt,Nu=__dcg_shared_module_exports__['e'](()=>{cx();Yt={renderToDocFrag:T9,findRootNode:G9,createNodeForView:M9,willMount:o1,onMount:n1,didMount:a1,willUnmount:s1,onUnmount:l1,didUnmount:c1,mountToNode:I9,unmountFromNode:V9}});function A9(){if(!this._isMounted)return Gd.warn("Trying to update view that is not mounted. Ignoring update.",this);if(!(this.shouldUpdate&&!this.shouldUpdate())){if(this.willUpdate&&this.willUpdate(),xs.invoke(this,"willUpdate"),xs.invoke(this,"onUpdate"),this.onUpdate&&this.onUpdate(),this.overrideChildUpdates)this.overrideChildUpdates();else for(var r=this._childViews,e=r.length,t=0;t<e;t++)r[t].update();xs.invoke(this,"didUpdate"),this.didUpdate&&this.didUpdate()}}var TF,IF=__dcg_shared_module_exports__['e'](()=>{cx();dx();TF={update:A9}});function L9(r){var e=arguments.length;if(e<2)return r;for(var t=1;t<e;t++)for(var i=arguments[t],o=Object.keys(i),n=o.length,a=0;a<n;a++){var s=o[a];r[s]=i[s]}return r}var Id,sf=__dcg_shared_module_exports__['e'](()=>{Id=L9});function O9(r){if(!r)throw new Error("must pass a spec to DCGView.createClass");if(typeof r.template!="function")throw new Error("must pass a template function to DCGView.createClass");var e=function(i,o){this._viewName=r.viewName||(this.constructor?this.constructor.name:"Anonymous DCGView"),this._setupProps(i,o),this.init&&this.init(),this._callTemplate()};e.prototype._setupProps=function(i,o){if(i){for(var n in i){var a=i[n];if(typeof a!="function"&&a!==void 0)throw new Error('The "'+n+'" prop must be a function. It is: '+JSON.stringify(a))}this.props=i}else this.props={};this.children=o,this._childViews=[],this._bindings={}},e.prototype._callTemplate=function(){if(this._element=this.template(),!this._element||!this._element._isDCGElement)throw new Error("template() must return a DCGElement");this._element._parentElement=this},e.prototype.bindFn=function(i){return i.bind(this)},e.prototype.findRootNode=Yt.findRootNode,e.prototype.renderToDocFrag=Yt.renderToDocFrag,e.prototype.const=Tn.makeConst,e.prototype.spread=Id,e.prototype.createElement=Td,e.prototype.update=TF.update,e.prototype.traceViewHierarchy=function(){for(var i=[],o=this._parentElement;o;o=o._parentElement)i.unshift(o);var n=i.concat([this]).filter(function(a){return!(!a._isDCGView||a._isDCGSwitch&&a._parentElement&&a._parentElement._isDCGIf||a._isDCGIfDefinedWrapper||a._isDCGSwitchWrapper||a._isDCGSwitchUnionWrapper)}).map(function(a,s){for(var l="";s-- >0;)l+="  ";return l+"<"+a._viewName+">"}).join(`
`);return{ancestors:i,formatted:n}};for(var t in r)if(r.hasOwnProperty(t))if(!e.prototype.hasOwnProperty(t))e.prototype[t]=r[t];else throw new Error("Cannot override the "+t+"() method");return e._isDCGViewClass=!0,e.prototype._isDCGView=!0,e.prototype._isDCGElement=!0,e}var Xi,Yl=__dcg_shared_module_exports__['e'](()=>{af();Nu();IF();Ac();sf();Xi=O9});function VF(r){var e=r(),t=typeof e;if(t==="string")return e;if(!t||t!=="object")throw new Error("Unsupported type returned from style getter: "+t);var i="";for(var o in e){var n=e[o];e.hasOwnProperty(o)&&n!=null&&(i?i+=";"+o+":"+n:i=o+":"+n)}return i}function P9(r){var e,t=VF(r);return Tn.isConst(r)||(e={onUpdate:function(i){var o=VF(r);t!==o&&(oS.update(i,"style",o),t=o)}}),{value:t,bindings:e}}var MF,AF=__dcg_shared_module_exports__['e'](()=>{Ac();ZV();MF=P9});function LF(r){var e=r(),t=typeof e;if(t==="string")return e;if(!t||t!=="object")throw new Error("Unsupported type returned from class getter: "+t);var i="";for(var o in e)if(e.hasOwnProperty(o)){var n=e[o];n&&(i?i+=" "+o:i=o)}return i}function _9(r,e,t){for(var i=[],o=r.className.replace(OF,"").split(PF),n=e.replace(OF,"").split(PF),a={},s=n.length-1;s>=0;s--)a[n[s]]=!0;var l=o.length;for(s=0;s<l;s++){var c=o[s];a.hasOwnProperty(c)||i.push(c)}return t?i.length?t+" "+i.join(" "):t:i.join(" ")}function F9(r){var e,t=LF(r);return Tn.isConst(r)||(e={onUpdate:function(i){var o=LF(r);t!==o&&(i.className===t?(i.className=o,t=o):(i.className=_9(i,t,o),t=o))}}),{value:t,bindings:e}}var OF,PF,_F,FF=__dcg_shared_module_exports__['e'](()=>{Ac();OF=/^\s+|\s+$/g,PF=/\s+/;_F=F9});function R9(r){return function(e){if(typeof e!="function")throw new Error("The "+r+" attribute expects a function for the value");if(Tn.isConst(e))throw new Error("The "+r+" attribute does not expect a const for the value");var t={bindings:{}};return t.bindings[r]=e,t}}var Vd,RF=__dcg_shared_module_exports__['e'](()=>{Ac();Vd=R9});function NF(r){var e=r.length,t=new Array(e),i=new Array(e+1),o=0,n,a;for(a=0;a<e;a++){if(r[i[o]]<r[a])n=o+1;else{for(var s=1,l=o-1;s<=l;){var c=Math.ceil((s+l)/2);r[i[c]]<r[a]?s=c+1:l=c-1}n=s}t[a]=i[n-1],i[n]=a,n>o&&(o=n)}var p=new Array(o),u=i[o];for(a=o-1;a>=0;a--)p[a]=r[u],u=t[u];return p}var BF=__dcg_shared_module_exports__['e'](()=>{});function N9(r,e){var t={},i,o,n=[],a=[];for(i=0;i<e.length;i++)o=e[i],t[o]=i;for(i=0;i<r.length;i++)o=r[i],t[o]===void 0&&n.push(o);var s=[];for(i=0;i<r.length;i++){o=r[i];var l=t[o];l!==void 0&&s.push(l)}var c=NF(s),p={};for(i=0;i<c.length;i++)o=e[c[i]],p[o]=!0;for(i=e.length-1;i>=0;i--)o=e[i],!p[o]&&a.push({key:o,beforeKey:e[i+1]});return{removes:n,inserts:a}}var aS,d1=__dcg_shared_module_exports__['e'](()=>{BF();aS=N9});function z9(r,e){return Td(K9,{items:r,keyFunction:e.key,viewFunction:e.item})}var B9,q9,K9,qF,KF=__dcg_shared_module_exports__['e'](()=>{Yl();d1();af();Nu();B9=Xi({viewName:"EachPlaceholder",_isDCGEachPlaceholder:!0,template:function(){return this.createElement("div",{style:this.const("display: none")})}}),q9=Xi({viewName:"EachWrapper",_isDCGEachWrapper:!0,template:function(){return this.children[0]}}),K9=Xi({viewName:"Each",_isDCGEach:!0,getKeys:function(){this._keyToItem={};var r=this.props.items(),e=this.props.keyFunction?r.map(this.props.keyFunction):r.slice(0);if(!this._chosenKeyType&&e.length&&(this._chosenKeyType=typeof e[0],this._chosenKeyType!=="string"&&this._chosenKeyType!=="number"))throw new Error("The key: "+JSON.stringify(e[0])+" is not a string or number");for(var t=0;t<e.length;t++){var i=e[t];if(typeof i!==this._chosenKeyType)throw new Error("Keys must be the same type. "+JSON.stringify(i)+" is not a "+this._chosenKeyType);if(i in this._keyToItem)throw new Error("The key: "+JSON.stringify(i)+" is not unique");this._keyToItem[i]=r[t]}return e},createViewForKey:function(r){var e=this._keyToItem[r],t=this.props.viewFunction.call(this,e,r),i=t;return i._isDCGView||(i=this.createElement(q9,null,t)),this._keyToView[r]=i,i},template:function(){this._keyToView={},this._keys=this.getKeys(),this._element=this.createElement(B9,null),this._siblingElements=[];for(var r=0;r<this._keys.length;r++){var e=this._keys[r],t=this.createViewForKey(e);t._parentElement=this._element._parentElement,this._siblingElements.push(t)}return this._element},detachAllRemovedViews:function(){for(var r=this._childViews,e=0,t=r.length,i,o=0;o<t;o++)i=r[o],i._will_be_unmounted_?e++:r[o-e]=i;r.splice(t-e,e)},overrideChildUpdates:function(){var r=this._keys,e=this.getKeys();this._keys=e;var t=this._element.findRootNode().parentNode,i,o,n,a,s,l,c=aS(r,e),p=[];for(i=c.removes.length-1;i>=0;i--)l=c.removes[i],p.push(this._keyToView[l]);for(p.forEach(Yt.willUnmount),i=0;i<c.removes.length;i++)l=c.removes[i],o=this._keyToView[l],delete this._keyToView[l],o._will_be_unmounted_=!0,t.removeChild(o.findRootNode());p.length>0&&this.detachAllRemovedViews(),p.forEach(Yt.onUnmount),p.forEach(Yt.didUnmount);var u=[];for(i=c.inserts.length-1;i>=0;i--)l=c.inserts[i].key,l in this._keyToView||(o=this.createViewForKey(l),u.push(o),Yt.createNodeForView(o,this));for(u.forEach(Yt.willMount),i=0;i<c.inserts.length;i++)s=c.inserts[i],n=this._keyToView[s.key].findRootNode(),s.beforeKey!==void 0?a=this._keyToView[s.beforeKey].findRootNode():a=null,t.insertBefore(n,a);u.forEach(Yt.onMount),u.forEach(Yt.didMount);var m=this._childViews,h=m.length-u.length;for(i=0;i<h;i++)m[i].update()}});qF=z9});var U9,H9,zF,UF=__dcg_shared_module_exports__['e'](()=>{Yl();d1();Ac();Nu();U9=Xi({viewName:"ForWrapper",template:function(){return this.children[0]}}),H9=Xi({viewName:"For",_isDCGFor:!0,getKeys:function(){this._keyToItem={};var r=this.props.each();if(!Array.isArray(r))throw new Error("<For each={}> must return an array");var e=this.props.key?r.map(this.props.key):r.slice(0);if(!this._chosenKeyType&&e.length&&(this._chosenKeyType=typeof e[0],this._chosenKeyType!=="string"&&this._chosenKeyType!=="number"))throw new Error("The key: "+JSON.stringify(e[0])+" is not a string or number");for(var t=0;t<e.length;t++){var i=e[t];if(typeof i!==this._chosenKeyType)throw new Error("Keys must be the same type. "+JSON.stringify(i)+" is not a "+this._chosenKeyType);if(i in this._keyToItem)throw new Error("The key: "+JSON.stringify(i)+" is not unique");this._keyToItem[i]=r[t]}return e},createViewForKey:function(r){var e=this._keyToItem[r],t=this._viewFunction.call(this,e,r),i=t;return i._isDCGView||(i=this.createElement(U9,null,t)),this._keyToView[r]=i,i},template:function(){if(this._keyToView={},typeof this.props.each!="function")throw new Error("<For each={}> must be a function");if(this.children.length!==1)throw new Error("<For> expects a single child. You passed "+this.children.length);var r=this.children[0];if(!r||!r._isDCGElement)throw new Error("<For> expects the root node to be a DCGElement. You passed "+JSON.stringify(r));if(r._isDCGView)throw new Error("<For> expects the root node to not be a DCGView. Pass in something like <div> or <span>");if(r.children.length!==1)throw new Error("<For> expects a root node with a single child. You passed "+r.children.length);if(this._viewFunction=r.children[0],this._viewFunction&&this._viewFunction._isDCGElement)throw new Error("<For> expects a function that constructs a DCGElement. You passed a DCGElement directly");if(typeof this._viewFunction!="function"){var e=JSON.stringify(this._viewFunction);throw new Error("<For> expects a function that constructs a DCGElement. You passed "+e)}if(Tn.isConst(this._viewFunction))throw new Error("<For> expects a function that constructs a DCGElement. You passed a constant");this._keys=this.getKeys();for(var t=[],i=0;i<this._keys.length;i++){var o=this._keys[i],n=this.createViewForKey(o);n._parentElement=this,t.push(n)}return r.children=t,r},detachAllRemovedViews:function(){for(var r=this._childViews,e=0,t=r.length,i,o=0;o<t;o++)i=r[o],i._will_be_unmounted_?e++:r[o-e]=i;r.splice(t-e,e)},overrideChildUpdates:function(){var r=this._keys,e=this.getKeys();this._keys=e;var t=this.findRootNode(),i,o,n,a,s,l,c=aS(r,e),p=[];for(i=c.removes.length-1;i>=0;i--)l=c.removes[i],p.push(this._keyToView[l]);for(p.forEach(Yt.willUnmount),i=0;i<c.removes.length;i++)l=c.removes[i],o=this._keyToView[l],delete this._keyToView[l],o._will_be_unmounted_=!0,t.removeChild(o.findRootNode());p.length>0&&this.detachAllRemovedViews(),p.forEach(Yt.onUnmount),p.forEach(Yt.didUnmount);var u=[];for(i=c.inserts.length-1;i>=0;i--)l=c.inserts[i].key,l in this._keyToView||(o=this.createViewForKey(l),u.push(o),Yt.createNodeForView(o,this));for(u.forEach(Yt.willMount),i=0;i<c.inserts.length;i++)s=c.inserts[i],n=this._keyToView[s.key].findRootNode(),s.beforeKey!==void 0?a=this._keyToView[s.beforeKey].findRootNode():a=null,t.insertBefore(n,a);u.forEach(Yt.onMount),u.forEach(Yt.didMount);var m=this._childViews,h=m.length-u.length;for(i=0;i<h;i++)m[i].update()}}),zF=H9});var W9,$9,sS,p1=__dcg_shared_module_exports__['e'](()=>{Yl();Ac();Nu();W9=Xi({viewName:"SwitchWrapper",_isDCGSwitchWrapper:!0,template:function(){return this.children[0]}}),$9=Xi({viewName:"Switch",_isDCGSwitch:!0,updateKey:function(){this._key=this.props.key()},createView:function(){var r=this._viewFunction(this._key);r==null&&(r=this.createElement("div",{style:this.const("display: none")}));var e=this.createElement(W9,null,r);return e._parentElement=this,e},template:function(){if(this._key=void 0,typeof this.props.key!="function")throw new Error("<Switch key={}> must be a function");if(this.children.length!==1)throw new Error("<Switch> expects a single child. You passed "+this.children.length);if(this._viewFunction=this.children[0],this._viewFunction&&this._viewFunction._isDCGElement)throw new Error("<Switch> expects a function that constructs a DCGElement. You passed a DCGElement directly");if(typeof this._viewFunction!="function"){var r=JSON.stringify(this._viewFunction);throw new Error("<Switch> expects a function that constructs a DCGElement. You passed "+r)}if(Tn.isConst(this._viewFunction))throw new Error("<Switch> expects a function that constructs a DCGElement. You passed a constant");return this.updateKey(),this.createView()},overrideChildUpdates:function(){var r=this._key;this.updateKey();var e=this._key;if(r===e)this._element.update();else{var t=this.findRootNode(),i=document.createTextNode("");t.parentNode.insertBefore(i,t),Yt.willUnmount(this._element),this._childViews=[],t.parentNode.removeChild(t),Yt.onUnmount(this._element),Yt.didUnmount(this._element),this._element=this.createView();var o=Yt.createNodeForView(this._element,this);Yt.willMount(this._element),i.parentNode.insertBefore(o,i),i.parentNode.removeChild(i),Yt.onMount(this._element),Yt.didMount(this._element)}}}),sS=$9});function HF(r,e,t){return Td(Y9,{getCase:function(){var i=e();return r?i&&i[r]:i},buildChildView:function(i){var o=t[i];if(o)return o(e)}})}function J9(r,e){return typeof r=="string"?HF.bind(this,r,e):HF(void 0,r,e)}var j9,Y9,lS,u1=__dcg_shared_module_exports__['e'](()=>{Yl();Nu();af();j9=Xi({viewName:"SwitchUnionWrapper",_isDCGSwitchUnionWrapper:!0,template:function(){return this.children[0]}}),Y9=Xi({viewName:"SwitchUnion",_isDCGSwitchUnion:!0,updateCase:function(){this._case=this.props.getCase()},createView:function(){var r=this.props.buildChildView(this._case);r==null&&(r=this.createElement("div",{style:this.const("display: none")}));var e=this.createElement(j9,null,r);return e._parentElement=this,e},template:function(){return this._case=void 0,this.updateCase(),this.createView()},overrideChildUpdates:function(){var r=this._case;this.updateCase();var e=this._case;if(r===e)this._element.update();else{var t=this.findRootNode(),i=document.createTextNode("");t.parentNode.insertBefore(i,t),Yt.willUnmount(this._element),this._childViews=[],t.parentNode.removeChild(t),Yt.onUnmount(this._element),Yt.didUnmount(this._element),this._element=this.createView();var o=Yt.createNodeForView(this._element,this);Yt.willMount(this._element),i.parentNode.insertBefore(o,i),i.parentNode.removeChild(i),Yt.onMount(this._element),Yt.didMount(this._element)}}});lS=J9});var X9,WF,$F=__dcg_shared_module_exports__['e'](()=>{Yl();Ac();p1();X9=Xi({viewName:"If",_isDCGIf:!0,template:function(){if(typeof this.props.predicate!="function")throw new Error("<If predicate={}> must be a function");if(this.children.length!==1)throw new Error("<If> expects a single child. You passed "+this.children.length);if(this._viewFunction=this.children[0],this._viewFunction&&this._viewFunction._isDCGElement)throw new Error("<If> expects a function that constructs a DCGElement. You passed a DCGElement directly");if(typeof this._viewFunction!="function"){var r=JSON.stringify(this._viewFunction);throw new Error("<If> expects a function that constructs a DCGElement. You passed "+r)}if(Tn.isConst(this._viewFunction))throw new Error("<If> expects a function that constructs a DCGElement. You passed a constant");var e=(function(){return!!this.props.predicate()}).bind(this),t=(function(i){if(i)return this._viewFunction()}).bind(this);return this.createElement(sS,{key:e},t)}}),WF=X9});function eW(r,e){return Td(Z9,{isDefined:function(){var t=r();return t!=null},buildChildView:function(){return e(r)}})}var Q9,Z9,jF,YF=__dcg_shared_module_exports__['e'](()=>{Yl();Nu();af();Q9=Xi({viewName:"IfDefinedWrapper",_isDCGIfDefinedWrapper:!0,template:function(){return this.children[0]}}),Z9=Xi({viewName:"IfDefined",_isDCGIfDefined:!0,updateIsDefined:function(){this._isDefined=this.props.isDefined()},createView:function(){var r;this._isDefined&&(r=this.props.buildChildView()),r==null&&(r=this.createElement("div",{style:this.const("display: none")}));var e=this.createElement(Q9,null,r);return e._parentElement=this,e},template:function(){return this._isDefined=void 0,this.updateIsDefined(),this.createView()},overrideChildUpdates:function(){var r=this._isDefined;this.updateIsDefined();var e=this._isDefined;if(r===e)this._element.update();else{var t=this.findRootNode(),i=document.createTextNode("");t.parentNode.insertBefore(i,t),Yt.willUnmount(this._element),this._childViews=[],t.parentNode.removeChild(t),Yt.onUnmount(this._element),Yt.didUnmount(this._element),this._element=this.createView();var o=Yt.createNodeForView(this._element,this);Yt.willMount(this._element),i.parentNode.insertBefore(o,i),i.parentNode.removeChild(i),Yt.onMount(this._element),Yt.didMount(this._element)}}});jF=eW});function tW(r,e){var t=lS(function(){return r()?"true":"false"},e);return t._viewName="IfElse",t}var JF,XF=__dcg_shared_module_exports__['e'](()=>{u1();JF=tW});var QF,ZF=__dcg_shared_module_exports__['e'](()=>{Yl();sf();QF=Xi({viewName:"Textarea",computeValue:function(){var r=this.props.value();return r==null?"":r+""},template:function(){if(!this.props.value)throw new Error('<Textarea> expects a "value={}" prop');if(!this.props.onInput)throw new Error('<Textarea> expects an "onInput={}" prop');var r=Id({},this.props,{onInput:(function(e){this.props.onInput(e.target.value),this._isMounted&&this.update()}).bind(this)});return this.props.disabled&&(r.disabled=(function(){if(this.props.disabled())return!0}).bind(this)),delete r.value,this.createElement("textarea",r,this.const(this.computeValue()))},didUpdate:function(){this.rootDOM||(this.rootDOM=this.findRootNode());var r=this.computeValue();this.rootDOM.value!==r&&(this.rootDOM.value=r)}})});var eR,tR=__dcg_shared_module_exports__['e'](()=>{Yl();sf();eR=Xi({viewName:"Input",computeValue:function(){var r=this.props.value();return r==null?"":r+""},template:function(){if(!this.props.value)throw new Error('<Input> expects a "value={}" prop');if(!this.props.onInput)throw new Error('<Input> expects an "onInput={}" prop');var r=Id({},this.props,{value:this.const(this.computeValue()),onInput:(function(e){this.props.onInput(e.target.value),this._isMounted&&this.update()}).bind(this)});return this.props.onEnterPressed&&(r.onKeypress=(function(e){e.which===13&&this.props.onEnterPressed()}).bind(this)),this.props.disabled&&(r.disabled=(function(){if(this.props.disabled())return!0}).bind(this)),r.hasOwnProperty("tabindex")||(r.tabindex=(function(){return this.props.disabled&&this.props.disabled()?"-1":"0"}).bind(this)),this.createElement("input",r)},didUpdate:function(){this.rootDOM||(this.rootDOM=this.findRootNode());var r=this.computeValue();this.rootDOM.value!==r&&(this.rootDOM.value=r)}})});var rR,iR=__dcg_shared_module_exports__['e'](()=>{Yl();sf();rR=Xi({viewName:"Checkbox",computeChecked:function(){return!!this.props.checked()},template:function(){if(!this.props.checked)throw new Error('<Checkbox> expects a "checked={}" prop');if(!this.props.onChange)throw new Error('<Checkbox> expects an "onChange={}" prop');var r=Id({},this.props,{type:this.const("checkbox"),checked:this.const(this.computeChecked()?"checked":void 0),onChange:(function(e){this.props.onChange(e.target.checked),this._isMounted&&this.update()}).bind(this)});return this.createElement("input",r)},didUpdate:function(){this.rootDOM||(this.rootDOM=this.findRootNode());var r=this.computeChecked();this.rootDOM.checked!==r&&(this.rootDOM.checked=r)}})});var oR,nR=__dcg_shared_module_exports__['e'](()=>{KF();UF();p1();u1();$F();YF();XF();ZF();tR();iR();oR={Each:qF,For:zF,Switch:sS,SwitchUnion:lS,If:WF,IfDefined:jF,IfElse:JF,Textarea:QF,Input:eR,Checkbox:rR}});var aR,sR=__dcg_shared_module_exports__['e'](()=>{Yl();aR=Xi({template:function(){}})});var rW,Jl,Lc,lR=__dcg_shared_module_exports__['e'](()=>{af();Yl();Nu();sf();Ac();t1();AF();FF();RF();nR();dx();r1();sR();rW=nS.enableSpanWrapping,Jl={createElement:Td,createClass:Xi,mountToNode:Yt.mountToNode,unmountFromNode:Yt.unmountFromNode,spread:Id,const:Tn.makeConst,isConst:Tn.isConst,addCustomAttribute:lx.add,Components:oR,addWarningHandler:Gd.addWarningHandler,removeWarningHandler:Gd.removeWarningHandler,_warn:Gd.warn,enableSpanWrapping:rW,Class:aR};Jl.addCustomAttribute("style",MF);Jl.addCustomAttribute("class",_F);Jl.addCustomAttribute("willMount",Vd("willMount"));Jl.addCustomAttribute("onMount",Vd("onMount"));Jl.addCustomAttribute("didMount",Vd("didMount"));Jl.addCustomAttribute("willUnmount",Vd("willUnmount"));Jl.addCustomAttribute("onUnmount",Vd("onUnmount"));Jl.addCustomAttribute("didUnmount",Vd("didUnmount"));Jl.addCustomAttribute("willUpdate",Vd("willUpdate"));Jl.addCustomAttribute("onUpdate",Vd("onUpdate"));Jl.addCustomAttribute("didUpdate",Vd("didUpdate"));Lc=Jl});function iW(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){let e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}function oW(){var r=window.Desmos&&window.Desmos.commit;return r}function nW(){var r="production";if(location&&location.hostname){var e=location.hostname,t=e.split("."),i=t.slice(0,t.length-2).join("."),o=t.slice(t.length-2).join(".");o==="desmos.com"&&(!i||i==="www"?r="production":r=i)}return r}function pR(r){if(!lf){var e=0,t=iW();lf=r({apiKey:"7f7807097671acbc4557e64bbf5eb529",maxBreadcrumbs:40,appVersion:oW(),releaseStage:nW(),consoleBreadcrumbsEnabled:!1,beforeSend:function(i){if(i.errorClass){for(let o of dR)if(i.errorClass.indexOf(o)!==-1){i.ignore();return}}if(i.errorMessage){for(let o of dR)if(i.errorMessage.indexOf(o)!==-1){i.ignore();return}}h1&&h1(i),cR&&cR(i),i.isIgnored()||(e+=1,i.metaData.errorNumber=e,i.metaData.pageLoadId=t)}})}}function fn(r,e){lf&&lf.notify(r,e)}function rg(r,e,t,i){if(e){e=__dcg_shared_module_exports__['a']({},e);for(var o in e)try{e[o]=JSON.stringify(e[o],null,2)}catch(n){e[o]="[[could not stringify]]"}}lf&&lf.leaveBreadcrumb(r,e,t,i)}function uR(r){h1=r}var lf,h1,cR,dR,yl=__dcg_shared_module_exports__['e'](()=>{dR=["UnhandledRejection","lnrAppboy","socratic","MyAppGet","SymBrowser_","mobincube_","_avast_submit","Cannot redefine property: googletag","jcarousel","SyntaxError: Unexpected identifier 'script'","__gCrWeb.autofill.extractForms","BrowseITEXT","Can't find variable: removeAllHighlights","aAttribruteValue.parentNode.getAttribute","vid_mate_check","GetImageTagSrcFromPoint","Can't find variable: didEnterViewPort","tinyMCE is not defined"]});function _p(r,e){let i=new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(r);return i?decodeURIComponent(i[1].replace(/\+/g,"%20")):null}function aW(r,e){return new RegExp("[?|&]"+e+"(=|&|;|$)").test(r)}function sW(r,e,t){if(e!==encodeURIComponent(e))throw new Error("Programming error: parameter name should be URL-safe without encoding.");let i=encodeURIComponent(t);if(r.length){let o=r.split("#"),n=/\?/.test(r)?`${o[0]}&${e}=${i}`:`${o[0]}?${e}=${i}`;return o[1]!==void 0?`${n}#${o[1]}`:n}else return`?${e}=${i}`}function lW(r,e,t){let o=new RegExp("([?|&])"+e+"=([^&;]+?)(&|#|;|$)").exec(r);if(!o)return r;let n=o[1],a=o[2],s=`${n}${e}=${a}`,l=encodeURIComponent(t),c=`${n}${e}=${l}`;return r.replace(s,c)}function cS(r,e,t){return aW(r,e)?lW(r,e,t):sW(r,e,t)}var ig=__dcg_shared_module_exports__['e'](()=>{});function hW(r){let e=pW.exec(r);if(e){let t=e[1];return!uW.test(t)}return!1}function dS(r,e){let t=Da(),i="";return e!==void 0?i=e:i=t.lang?""+t.lang:"",r===""||i===""||cW.test(r)||dW.test(r)||hW(r)?r:cS(r,"lang",i)}var cW,dW,pW,uW,hR=__dcg_shared_module_exports__['e'](()=>{Lp();ig();cW=/lang=[A-Za-z]+/,dW=/(cl|learn|help).desmos.com/,pW=/^(?:https?:)?(?:\/\/)?([^\s\/\?]+)/i,uW=/(^desmos\.com$)|(\.desmos.com$)/});var gR=__dcg_shared_module_exports__['e'](()=>{});var z=__dcg_shared_module_exports__['f']((oce,mR)=>{lR();xt();yl();hR();gR();Lc.addWarningHandler(r=>fn(r));Lc.addCustomAttribute("href",function(r){let e=dS(r()),t={value:`${dS(r())}`,bindings:{onMount(i){if(!i.matches("a")&&!i.matches("use"))throw new Error("Cannot have an href on a non-link element.")}}};return t.bindings.onUpdate=function(i){let o=dS(r());e!==o&&(e=o,i.setAttribute("href",o))},t});Lc.addCustomAttribute("onTap",r=>({value:"",bindings:{onMount(e){H(e).on("dcg-tap",r)}}}));Lc.addCustomAttribute("ignoreRealClick",r=>({bindings:{onMount(e){H(e).on("click",function(t){r()&&t.preventDefault()})}}}));Lc.addCustomAttribute("onTapStart",r=>({bindings:{onMount(e){H(e).on("dcg-tapstart",r)}}}));Lc.addCustomAttribute("onTapMove",r=>({bindings:{onMount(e){H(e).on("dcg-tapmove",r)}}}));Lc.addCustomAttribute("onTapEnd",r=>({bindings:{onMount(e){H(e).on("dcg-tapend",r)}}}));Lc.addCustomAttribute("onLongHold",r=>({bindings:{onMount(e){H(e).on("dcg-longhold",r)}}}));Lc.addCustomAttribute("manageFocus",function(r){return r()===void 0?{}:{bindings:{onMount(e){r().shouldBeFocused()&&e.focus(),e.onfocus=function(t){r().shouldBeFocused()||r().onFocusedChanged(!0,t)},e.onblur=function(t){r().shouldBeFocused()&&r().onFocusedChanged(!1,t)}},onUpdate(e){let t=r().shouldBeFocused(),i=document.activeElement===e;t&&!i?e.focus():i&&!t&&e.blur()},willUnmount(e){e.onfocus=null,e.onblur=null}}}});mR.exports=Lc});var gB=__dcg_shared_module_exports__['f'](rw=>{var ct=rw&&rw.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(i[n]=o[n])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),jk=rw&&rw.__assign||function(){return jk=Object.assign||function(r){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o])}return r},jk.apply(this,arguments)};(function(){var r=-1,e=1,t=Math.min,i=Math.max;function o(){}function n(v,f){if(!f)throw new Error("prayer failed: "+v)}function a(v){n("a direction was passed",v===r||v===e)}function s(v){var f=document.implementation.createHTMLDocument("");if(f.body.innerHTML=v,f.body.children.length===1)return f.body.children[0];for(var d=document.createDocumentFragment();f.body.firstChild;)d.appendChild(f.body.firstChild);return d}var l=function(f,d,g){var y;switch(f){case"svg":case"path":y=document.createElementNS("http://www.w3.org/2000/svg",f);break;default:y=document.createElement(f)}for(var G in d){var F=d[G];F!==void 0&&y.setAttribute(G,typeof F=="string"?F:String(F))}if(g)for(var q=0;q<g.length;q++)y.appendChild(g[q]);return y};l.text=function(v){return document.createTextNode(v)},l.block=function(v,f,d){var g=l(v,f,[d.html()]);return d.setDOM(g),X.linkElementByBlockNode(g,d),g},l.entityText=function(v){var f=s(v);return n("entity parses to a single text node",f instanceof DocumentFragment&&f.childNodes.length===1&&f.childNodes[0]instanceof Text),f.childNodes[0]};function c(v,f){var d,g,y;if(typeof((d=v)===null||d===void 0?void 0:d.closest)=="function")return v.closest(f);if(!(v instanceof HTMLElement))return null;var G=Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,F=v;do{if(G.call(F,f))return F;F=(y=(g=F==null?void 0:F.parentElement)!==null&&g!==void 0?g:F==null?void 0:F.parentNode)!==null&&y!==void 0?y:null}while(F!==null&&F.nodeType===1);return null}var p="\xA0",u="\u200B",m="\u02D9",h="\u2211",x="\u220F",C="\u2210",D="\u222B";function k(v){return v.getClientRects().length?v.getBoundingClientRect():{top:0,left:0,height:0,width:0,x:0,y:0,bottom:0,right:0}}function M(){return window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft}function I(){return window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}var S=function(){var v,f;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(v=requestAnimationFrame,f=cancelAnimationFrame):(v=function(d){return setTimeout(d,13)},f=clearTimeout),function(d,g){var y=Date.now(),G,F=0;function q(){var Oe=(Date.now()-y)/d;Oe<=F?se():F=Oe,g(F,se,Y)}function Y(){G!==void 0&&f(G),G=void 0}function se(){Y(),G=v(q)}g(d<=0?1:0,se,Y)}}(),V=function(){function v(f){this.span=l("span",{class:"dcg-mq-aria-alert","aria-live":"assertive","aria-atomic":"true"}),this.msg="",this.items=[],this.controller=f}return v.prototype.attach=function(){var f=this.controller.container;this.span.parentNode!==f&&L(f).prepend(L(this.span))},v.prototype.queue=function(f,d){d===void 0&&(d=!1);var g="";if(f instanceof Pt){var y=f.mathspeak({ignoreShorthand:!0});d&&(f.parent&&f.parent.ariaLabel&&f.ariaLabel==="block"?g=f.parent.ariaLabel+" "+y:f.ariaLabel&&(g=f.ariaLabel+" "+y)),g===""&&(g=y)}else g=f||"";return this.items.push(g),this},v.prototype.queueDirOf=function(f){return a(f),this.queue(f===r?"before":"after")},v.prototype.queueDirEndOf=function(f){return a(f),this.queue(f===r?"beginning of":"end of")},v.prototype.alert=function(f){return this.attach(),f&&this.queue(f),this.items.length&&(this.msg=this.items.join(" ").replace(/ +(?= )/g,"").trim(),this.controller.containerHasFocus()&&(this.controller.options.logAriaAlerts&&this.msg&&console.log(this.msg),this.span.textContent=this.msg)),this.clear()},v.prototype.clear=function(){return this.items.length=0,this},v}(),P=function(){function v(f,d){var g;arguments.length===1&&(d=f),!(!f||!d)&&(this.ends=(g={},g[r]=f,g[e]=d,g))}return v.create=function(f,d){arguments.length===1&&(d=f),n("No half-empty DOMFragments",!!f==!!d);var g=new v(f,d);return n("last is a forward sibling of first",g.isValid()),g},v.prototype.isEmpty=function(){return this.ends===void 0},v.prototype.isOneNode=function(){return!!(this.ends&&this.ends[r]===this.ends[e])},v.prototype.isValid=function(){if(!this.ends||this.ends[r]===this.ends[e])return!0;var f;return this.eachNode(function(d){return f=d}),f===this.ends[e]},v.prototype.firstNode=function(){return n("Fragment is not empty",this.ends),this.ends[r]},v.prototype.lastNode=function(){return n("Fragment is not empty",this.ends),this.ends[e]},v.prototype.children=function(){var f=this.oneNode(),d=f.firstChild,g=f.lastChild;return d&&g?new v(d,g):new v},v.prototype.join=function(f){if(!this.ends)return f;if(!f.ends)return this;for(var d=!1,g=this.ends[e].nextSibling;g;){if(g===f.ends[r]){d=!0;break}g=g.nextSibling}return n("sibling must be a forward DOM sibling of this fragment",d),new v(this.ends[r],f.ends[e])},v.prototype.oneNode=function(){return n("Fragment has a single node",this.ends&&this.ends[r]===this.ends[e]),this.ends[r]},v.prototype.oneElement=function(){var f=this.oneNode();return n("Node is an Element",f.nodeType===Node.ELEMENT_NODE),f},v.prototype.oneText=function(){var f=this.oneNode();return n("Node is Text",f.nodeType===Node.TEXT_NODE),f},v.prototype.eachNode=function(f){if(!this.ends)return this;for(var d=this.ends[e],g=this.ends[r],y=void 0;g&&(y=g.nextSibling,f(g),g!==d);g=y);return this},v.prototype.eachElement=function(f){return this.eachNode(function(d){d.nodeType===Node.ELEMENT_NODE&&f(d)}),this},v.prototype.text=function(){var f="";return this.eachNode(function(d){f+=d.textContent||""}),f},v.prototype.toNodeArray=function(){var f=[];return this.eachNode(function(d){return f.push(d)}),f},v.prototype.toElementArray=function(){var f=[];return this.eachElement(function(d){return f.push(d)}),f},v.prototype.toDocumentFragment=function(){var f=document.createDocumentFragment();return this.eachNode(function(d){return f.appendChild(d)}),f},v.prototype.insertBefore=function(f){return this.insDirOf(r,f)},v.prototype.insertAfter=function(f){return this.insDirOf(e,f)},v.prototype.append=function(f){return f.appendTo(this.oneElement()),this},v.prototype.prepend=function(f){return f.prependTo(this.oneElement()),this},v.prototype.appendTo=function(f){return this.insAtDirEnd(e,f)},v.prototype.prependTo=function(f){return this.insAtDirEnd(r,f)},v.prototype.parent=function(){if(!this.ends)return this;var f=this.ends[r].parentNode;return f?new v(f):new v},v.prototype.wrapAll=function(f){if(f.textContent="",!this.ends)return this;var d=this.ends[r].parentNode,g=this.ends[e].nextSibling;return this.appendTo(f),d&&d.insertBefore(f,g),this},v.prototype.replaceWith=function(f){var d,g=(d=this.ends)===null||d===void 0?void 0:d[e],y=g==null?void 0:g.parentNode,G=g==null?void 0:g.nextSibling;this.detach();var F=f.toDocumentFragment();return!g||!y?this:(y.insertBefore(F,G||null),this)},v.prototype.nthElement=function(f){if(this.ends&&!(f<0||f!==Math.floor(f)))for(var d=this.ends[r];d;){if(d.nodeType===Node.ELEMENT_NODE){if(f<=0)return d;f-=1}if(d===this.ends[e])return;d=d.nextSibling}},v.prototype.firstElement=function(){return this.nthElement(0)},v.prototype.lastElement=function(){if(this.ends)for(var f=this.ends[e];f;){if(f.nodeType===Node.ELEMENT_NODE)return f;if(f===this.ends[r])return;f=f.previousSibling}},v.prototype.first=function(){return new v(this.firstElement())},v.prototype.last=function(){return new v(this.lastElement())},v.prototype.eq=function(f){return new v(this.nthElement(f))},v.prototype.slice=function(f){if(!this.ends)return this;var d=this.nthElement(f);return d?new v(d,this.ends[e]):new v},v.prototype.next=function(){for(var f=this.oneNode();f;)if(f=f.nextSibling,f&&f.nodeType===Node.ELEMENT_NODE)return new v(f);return new v},v.prototype.prev=function(){for(var f=this.oneNode();f;)if(f=f.previousSibling,f&&f.nodeType===Node.ELEMENT_NODE)return new v(f);return new v},v.prototype.empty=function(){return this.eachElement(function(f){f.textContent=""}),this},v.prototype.remove=function(){return this.toDocumentFragment(),this},v.prototype.detach=function(){return this.remove()},v.prototype.insDirOf=function(f,d){var g;if(!this.ends)return this;var y=(g=d.ends)===null||g===void 0?void 0:g[f];return!y||!y.parentNode?this.detach():(B(f,y.parentNode,this.toDocumentFragment(),y),this)},v.prototype.insAtDirEnd=function(f,d){return this.ends?(R(f,this.toDocumentFragment(),d),this):this},v.prototype.hasClass=function(f){var d=!1;return this.eachElement(function(g){g.classList.contains(f)&&(d=!0)}),d},v.prototype.addClass=function(f){for(var d=function(q){if(!q)return"continue";g.eachElement(function(Y){Y.classList.add(q)})},g=this,y=0,G=f.split(/\s+/);y<G.length;y++){var F=G[y];d(F)}return this},v.prototype.removeClass=function(f){for(var d=function(q){if(!q)return"continue";g.eachElement(function(Y){Y.classList.remove(q)})},g=this,y=0,G=f.split(/\s+/);y<G.length;y++){var F=G[y];d(F)}return this},v.prototype.toggleClass=function(f,d){if(d===!0)return this.addClass(f);if(d===!1)return this.removeClass(f);for(var g=function(Y){if(!Y)return"continue";y.eachElement(function(se){se.classList.toggle(Y)})},y=this,G=0,F=f.split(/\s+/);G<F.length;G++){var q=F[G];g(q)}return this},v}(),L=P.create;function B(v,f,d,g){f.insertBefore(d,v===r?g:g.nextSibling)}function R(v,f,d){v===r?d.insertBefore(f,d.firstChild):d.appendChild(f)}var W=function(){function v(f,d,g){this.init(f,d,g)}return v.prototype.init=function(f,d,g){this.parent=f,this[r]=d,this[e]=g},v.copy=function(f){return new v(f.parent,f[r],f[e])},v}();function re(v,f){var d=v[r];if(d){var g=v[e];if(g)for(g=g[e];d!==g;d=d[e]){var y=f(d);if(y===!1)break}}}function ne(v,f,d){var g=v[r];if(!g)return f;var y=v[e];if(!y)return f;for(y=y[e];g!==y;g=g[e])f=d(f,g);return f}var X=function(){function v(){var g;this[f]=0,this[d]=0,this.parent=0,this.ends=(g={},g[r]=0,g[e]=0,g),this.id=v.uniqueNodeId()}v.uniqueNodeId=function(){return v.idCounter+=1},v.getNodeOfElement=function(g){if(g){if(!g.nodeType)throw new Error("must pass an Element to NodeBase.getNodeOfElement");var y=g;return y.mqBlockNode||y.mqCmdNode}},v.linkElementByBlockNode=function(g,y){g.mqBlockNode=y},v.linkElementByCmdNode=function(g,y){g.mqCmdNode=y},v.prototype.setEnds=function(g){this.ends=g,n("No half-empty node ends",!!this.ends[r]==!!this.ends[e])},v.prototype.getEnd=function(g){return this.ends[g]},v.prototype.toString=function(){return"{{ MathQuill Node #"+this.id+" }}"},v.prototype.setDOM=function(g){return g&&n("DOM is an element or a text node",g.nodeType===Node.ELEMENT_NODE||g.nodeType===Node.TEXT_NODE),this._el=g,this},v.prototype.domFrag=function(){return L(this._el)},v.prototype.createDir=function(g,y){a(g);var G=this;return G.html(),G.domFrag().insDirOf(g,y.domFrag()),y[g]=G.adopt(y.parent,y[r],y[e]),G},v.prototype.createLeftOf=function(g){this.createDir(r,g)},v.prototype.selectChildren=function(g,y){return new pe(g,y)},v.prototype.bubble=function(g){for(var y=this.getSelfNode(),G=y;G;G=G.parent){var F=g(G);if(F===!1)break}return this},v.prototype.postOrder=function(g){var y=this.getSelfNode();return function G(F){return F?(F.eachChild(G),g(F),!0):!1}(y),y},v.prototype.isEmpty=function(){return this.ends[r]===0&&this.ends[e]===0},v.prototype.isQuietEmptyDelimiter=function(g){if(!this.isEmpty()||!g||!this.parent||this.parent.ctrlSeq===void 0)return!1;var y=this.parent.ctrlSeq.replace(/^\\(left|right)?/,"");return g.hasOwnProperty(y)},v.prototype.isStyleBlock=function(){return!1},v.prototype.isTextBlock=function(){return!1},v.prototype.children=function(){return new A(this.getEnd(r),this.getEnd(e))},v.prototype.eachChild=function(g){return re(this.ends,g),this},v.prototype.foldChildren=function(g,y){return ne(this.ends,g,y)},v.prototype.withDirAdopt=function(g,y,G,F){var q=this.getSelfNode();return new A(q,q).withDirAdopt(g,y,G,F),this},v.prototype.adopt=function(g,y,G){var F=this.getSelfNode();return new A(F,F).adopt(g,y,G),this.getSelfNode()},v.prototype.disown=function(){var g=this.getSelfNode();return new A(g,g).disown(),this},v.prototype.remove=function(){return this.domFrag().remove(),this.disown()},v.prototype.shouldIgnoreSubstitutionInSimpleSubscript=function(g){return!(!g.disableAutoSubstitutionInSubscripts||!this.parent||!(this.parent.parent instanceof al)||!this.parent.domFrag().hasClass("dcg-mq-sub"))},v.prototype.getSelfNode=function(){return this},v.prototype.parser=function(){n("Abstract parser() method is never called",!1)},v.prototype.html=function(){throw new Error("html() unimplemented in NodeBase")},v.prototype.text=function(){return""},v.prototype.latex=function(){var g={latex:"",startIndex:-1,endIndex:-1};return this.latexRecursive(g),g.latex},v.prototype.latexRecursive=function(g){},v.prototype.checkCursorContextOpen=function(g){g.startSelectionBefore===this&&(g.startIndex=g.latex.length),g.endSelectionBefore===this&&(g.endIndex=g.latex.length)},v.prototype.checkCursorContextClose=function(g){g.startSelectionAfter===this&&(g.startIndex=g.latex.length),g.endSelectionAfter===this&&(g.endIndex=g.latex.length)},v.prototype.finalizeTree=function(g,y){},v.prototype.contactWeld=function(g,y){},v.prototype.blur=function(g){},v.prototype.focus=function(){},v.prototype.intentionalBlur=function(){},v.prototype.reflow=function(){},v.prototype.registerInnerField=function(g,y){},v.prototype.chToCmd=function(g,y){n("Abstract chToCmd() method is never called",!1)},v.prototype.mathspeak=function(g){return""},v.prototype.seek=function(g,y){},v.prototype.siblingDeleted=function(g,y){},v.prototype.siblingCreated=function(g,y){},v.prototype.finalizeInsert=function(g,y){},v.prototype.fixDigitGrouping=function(g){},v.prototype.writeLatex=function(g,y){},v.prototype.write=function(g,y){};var f,d;return f=r,d=e,v.idCounter=0,v}();function b(v,f,d){n("a parent is always present",v),n("leftward is properly set up",function(){return f?f[e]===d&&f.parent===v:v.getEnd(r)===d}()),n("rightward is properly set up",function(){return d?d[r]===f&&d.parent===v:v.getEnd(e)===f}())}var A=function(){function v(f,d,g){var y,G;if(this.disowned=!1,g===void 0&&(g=r),a(g),n("no half-empty fragments",!f==!d),!f||!d){this.setEnds((y={},y[r]=0,y[e]=0,y));return}n("withDir is passed to Fragment",f instanceof Pt),n("oppDir is passed to Fragment",d instanceof Pt),n("withDir and oppDir have the same parent",f.parent===d.parent);var F=(G={},G[g]=f,G[-g]=d,G);this.setEnds(F);var q=0;this.each(function(Y){q=Y}),n("following direction siblings from start reaches end",q===F[e])}return v.prototype.getDOMFragFromEnds=function(){var f=this.ends[r],d=this.ends[e];return f===0||d===0?L():f===d?f.domFrag():f.domFrag().join(d.domFrag())},v.prototype.setEnds=function(f){this.ends=f},v.prototype.getEnd=function(f){return this.ends?this.ends[f]:0},v.prototype.domFrag=function(){return this.getDOMFragFromEnds()},v.prototype.withDirAdopt=function(f,d,g,y){return f===r?this.adopt(d,g,y):this.adopt(d,y,g)},v.prototype.adopt=function(f,d,g){var y;b(f,d,g);var G=this;this.disowned=!1;var F=G.ends[r];if(!F)return this;var q=G.ends[e];if(!q)return this;var Y=(y={},y[r]=f.getEnd(r),y[e]=f.getEnd(e),y);return d||(Y[r]=F),g?g[r]=q:Y[e]=q,f.setEnds(Y),q[e]=g,G.each(function(se){return se[r]=d,se.parent=f,d&&(d[e]=se),d=se,!0}),G},v.prototype.disown=function(){var f,d=this,g=d.ends[r];if(!g||d.disowned)return d;this.disowned=!0;var y=d.ends[e];if(!y)return d;var G=g.parent;b(G,g[r],g),b(G,y,y[e]);var F=(f={},f[r]=G.getEnd(r),f[e]=G.getEnd(e),f);if(g[r]){var q=g[r];q[e]=y[e]}else F[r]=y[e];if(y[e]){var Y=y[e];Y[r]=g[r]}else F[e]=g[r];return F[r]&&F[e]?G.setEnds(F):G.ends=F,d},v.prototype.remove=function(){return this.domFrag().remove(),this.disown()},v.prototype.each=function(f){return re(this.ends,f),this},v.prototype.fold=function(f,d){return ne(this.ends,f,d)},v}(),E={},J={};function j(v){return v&&v.prototype instanceof Pt}var ce=function(v){ct(f,v);function f(d,g,y){var G=v.call(this,d,g,y)||this;return G.ancestors={},G}return f.fromCursor=function(d){return new f(d.parent,d[r],d[e])},f}(W),te=function(v){ct(f,v);function f(d,g,y){var G=v.call(this,d,0,0)||this;return G.upDownCache={},G.cursorElement=l("span",{class:"dcg-mq-cursor"},[l.text(u)]),G._domFrag=L(),G.controller=y,G.options=g,G.setDOMFrag(L(G.cursorElement)),G.blink=function(){L(G.cursorElement).toggleClass("dcg-mq-blink")},G}return f.prototype.setDOMFrag=function(d){return this._domFrag=d,this},f.prototype.domFrag=function(){return this._domFrag},f.prototype.show=function(){if(L(this.cursorElement).removeClass("dcg-mq-blink"),this.setDOMFrag(L(this.cursorElement)),this.intervalId)clearInterval(this.intervalId);else{var d=this[e];if(d){var g=this.selection;g&&g.getEnd(r)[r]===this[r]?this.domFrag().insertBefore(g.domFrag()):this.domFrag().insertBefore(d.domFrag())}else this.domFrag().appendTo(this.parent.domFrag().oneElement());this.parent.focus()}return this.intervalId=setInterval(this.blink,500),this},f.prototype.hide=function(){return this.intervalId&&clearInterval(this.intervalId),this.intervalId=0,this.domFrag().detach(),this.setDOMFrag(L()),this},f.prototype.withDirInsertAt=function(d,g,y,G){var F=this.parent;this.parent=g,this[d]=y,this[-d]=G,F!==g&&F.blur&&F.blur(this)},f.prototype.insDirOf=function(d,g){return a(d),this.domFrag().insDirOf(d,g.domFrag()),this.withDirInsertAt(d,g.parent,g[d],g),this.parent.domFrag().addClass("dcg-mq-hasCursor"),this},f.prototype.insLeftOf=function(d){return this.insDirOf(r,d)},f.prototype.insRightOf=function(d){return this.insDirOf(e,d)},f.prototype.insAtDirEnd=function(d,g){return a(d),this.domFrag().insAtDirEnd(d,g.domFrag().oneElement()),this.withDirInsertAt(d,g,0,g.getEnd(d)),g.focus(),this},f.prototype.insAtLeftEnd=function(d){return this.insAtDirEnd(r,d)},f.prototype.insAtRightEnd=function(d){return this.insAtDirEnd(e,d)},f.prototype.jumpUpDown=function(d,g){var y=this;y.upDownCache[d.id]=W.copy(y);var G=y.upDownCache[g.id];if(G){var F=G[e];F?y.insLeftOf(F):y.insAtRightEnd(G.parent)}else{var q=y.getBoundingClientRectWithoutMargin().left;g.seek(q,y)}y.controller.aria.queue(g,!0)},f.prototype.getBoundingClientRectWithoutMargin=function(){var d=this.domFrag();d.removeClass("dcg-mq-cursor");var g=k(d.oneElement()),y=g.left,G=g.right;return d.addClass("dcg-mq-cursor"),{left:y,right:G}},f.prototype.unwrapGramp=function(){var d=this.parent.parent,g=d.parent,y=d[e],G=this,F=d[r];if(d.disown().eachChild(function(we){return we.isEmpty()||(we.children().adopt(g,F,y).each(function(Ne){return Ne.domFrag().insertBefore(d.domFrag()),!0}),F=we.getEnd(e)),!0}),!this[e]){var q=this[r];if(q)this[e]=q[e];else for(;!this[e];){var Y=this.parent[e];if(Y)this.parent=Y,this[e]=Y.getEnd(r);else{this[e]=d[e],this.parent=g;break}}}var se=this[e];se?this.insLeftOf(se):this.insAtRightEnd(g),d.domFrag().remove();var Oe=d[r],Te=d[e];Oe&&Oe.siblingDeleted(G.options,e),Te&&Te.siblingDeleted(G.options,r)},f.prototype.startSelection=function(){for(var d=this.anticursor=ce.fromCursor(this),g=d.ancestors,y=d;y.parent;y=y.parent)g[y.parent.id]=y},f.prototype.endSelection=function(){delete this.anticursor},f.prototype.select=function(){var d,g=this.anticursor;if(this[r]===g[r]&&this.parent===g.parent)return!1;for(var y=this;y.parent;y=y.parent)if(y.parent.id in g.ancestors){d=y.parent;break}n("cursor and anticursor in the same tree",d);var G=d,F=g.ancestors[G.id],q,Y,se=e;if(y[r]!==F){for(var Oe=y;Oe;Oe=Oe[e])if(Oe[e]===F[e]){se=r,q=y,Y=F;break}}se===e&&(q=F,Y=y),q instanceof W&&(q=q[e]),Y instanceof W&&(Y=Y[r]),this.hide().selection=G.selectChildren(q,Y);var Te=this.selection.getEnd(se);return this.insDirOf(se,Te),this.selectionChanged(),!0},f.prototype.resetToEnd=function(d){this.clearSelection();var g=d.root;this[e]=0,this[r]=g.getEnd(e),this.parent=g},f.prototype.clearSelection=function(){return this.selection&&(this.selection.clear(),delete this.selection,this.selectionChanged()),this},f.prototype.deleteSelection=function(){var d=this.selection;d&&(this[r]=d.getEnd(r)[r],this[e]=d.getEnd(e)[e],d.remove(),this.selectionChanged(),delete this.selection)},f.prototype.replaceSelection=function(){var d=this.selection;return d&&(this[r]=d.getEnd(r)[r],this[e]=d.getEnd(e)[e],delete this.selection),d},f.prototype.depth=function(){for(var d=this,g=0;d=d.parent;)g+=d instanceof io?1:0;return g},f.prototype.isTooDeep=function(d){return this.options.maxDepth!==void 0?this.depth()+(d||0)>this.options.maxDepth:!1},f.prototype.selectionChanged=function(){},f}(W),pe=function(v){ct(f,v);function f(d,g,y){var G=v.call(this,d,g,y)||this;return G._el=l("span",{class:"dcg-mq-selection"}),G.getDOMFragFromEnds().wrapAll(G._el),G}return f.prototype.isCleared=function(){return this._el===void 0},f.prototype.domFrag=function(){return this.isCleared()?this.getDOMFragFromEnds():L(this._el)},f.prototype.setEnds=function(d){n("Selection ends are never empty",d[r]&&d[e]),this.ends=d},f.prototype.getEnd=function(d){return this.ends[d]},f.prototype.adopt=function(d,g,y){return this.clear(),v.prototype.adopt.call(this,d,g,y)},f.prototype.clear=function(){var d=this.getDOMFragFromEnds();return this.domFrag().replaceWith(d),this._el=void 0,this},f.prototype.join=function(d,g){return g===void 0&&(g=""),this.fold("",function(y,G){return y+g+G[d]()})},f}(A),he=function(){function v(f,d,g){this.textareaEventListeners={},this.id=f.id,this.data={},this.root=f,this.container=d,this.options=g,this.aria=new V(this.getControllerSelf()),this.ariaLabel="Math Input",this.ariaPostLabel="",f.controller=this.getControllerSelf(),this.cursor=f.cursor=new te(f,g,this.getControllerSelf())}return v.prototype.getControllerSelf=function(){return this},v.prototype.handle=function(f,d){var g,y=this.options.handlers,G=(g=this.options.handlers)===null||g===void 0?void 0:g.fns[f];if(G){var F=y==null?void 0:y.APIClasses[this.KIND_OF_MQ];n("APIClass is defined",F);var q=new F(this);d===r||d===e?G(d,q):G(q)}},v.onNotify=function(f){v.notifyees.push(f)},v.prototype.notify=function(f){for(var d=0;d<v.notifyees.length;d+=1)v.notifyees[d](this.cursor,f);return this},v.prototype.setAriaLabel=function(f){var d=this.getAriaLabel();return f&&typeof f=="string"&&f!==""?this.ariaLabel=f:this.editable?this.ariaLabel="Math Input":this.ariaLabel="",this.ariaLabel!==d&&!this.containerHasFocus()&&this.updateMathspeak(),this},v.prototype.getAriaLabel=function(){return this.ariaLabel!=="Math Input"?this.ariaLabel:this.editable?"Math Input":""},v.prototype.setAriaPostLabel=function(f,d){var g=this;return f&&typeof f=="string"&&f!==""?(f!==this.ariaPostLabel&&typeof d=="number"&&(this._ariaAlertTimeout&&clearTimeout(this._ariaAlertTimeout),this._ariaAlertTimeout=setTimeout(function(){g.containerHasFocus()?g.aria.alert(g.root.mathspeak().trim()+" "+f.trim()):g.updateMathspeak()},d)),this.ariaPostLabel=f):(this._ariaAlertTimeout&&clearTimeout(this._ariaAlertTimeout),this.ariaPostLabel=""),this},v.prototype.getAriaPostLabel=function(){return this.ariaPostLabel||""},v.prototype.containerHasFocus=function(){return document.activeElement&&this.container.contains(document.activeElement)},v.prototype.getTextareaOrThrow=function(){var f=this.textarea;if(!f)throw new Error("expected a textarea");return f},v.prototype.getTextareaSpanOrThrow=function(){var f=this.textareaSpan;if(!f)throw new Error("expected a textareaSpan");return f},v.prototype.addTextareaEventListeners=function(f){if(this.textarea)for(var d in f){var g=d;this.removeTextareaEventListener(g),this.textarea.addEventListener(g,f[g])}},v.prototype.removeTextareaEventListener=function(f){if(this.textarea){var d=this.textareaEventListeners[f];d&&this.textarea.removeEventListener(f,d)}},v.prototype.exportMathSpeak=function(){return this.root.mathspeak()},v.prototype.updateMathspeak=function(){},v.prototype.scrollHoriz=function(){},v.prototype.selectionChanged=function(){},v.prototype.setOverflowClasses=function(){},v.notifyees=[],v}(),ae={},ie={},de={handlers:!0,autoCommands:!0,quietEmptyDelimiters:!0,autoParenthesizedFunctions:!0,autoOperatorNames:!0,leftRightIntoCmdGoes:!0,maxDepth:!0,interpretTildeAsSim:!0},Ie={},Se=function(){function v(f){this.version=f}return v.prototype.assertJquery=function(){return n("Interface versions > 2 do not depend on JQuery",this.version<=2),n("JQuery is set for interface v < 3",this.jQuery),this.jQuery},v}(),ot=function(){function v(){}return v}(),Ze=function(){window.console&&console.warn(`You are using the MathQuill API without specifying an interface version, which will fail in v1.0.0. Easiest fix is to do the following before doing anything else:

    MathQuill = MathQuill.getInterface(1);
    // now MathQuill.MathField() works like it used to

See also the "\`dev\` branch (2014\u20132015) \u2192 v0.10.0 Migration Guide" at
  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide`)},at;function Vt(v){return Ze(),at||(at=Ot(1)),at(v)}Vt.prototype=ot.prototype,Vt.VERSION="v0.10.1",Vt.interfaceVersion=function(v){if(v!==1)throw"Only interface version 1 supported. You specified: "+v;return Ze=function(){window.console&&console.warn(`You called MathQuill.interfaceVersion(1); to specify the interface version, which will fail in v1.0.0. You can fix this easily by doing this before doing anything else:

    MathQuill = MathQuill.getInterface(1);
    // now MathQuill.MathField() works like it used to

See also the "\`dev\` branch (2014\u20132015) \u2192 v0.10.0 Migration Guide" at
  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide`)},Ze(),Vt},Vt.getInterface=Ot;var Dt=Ot.MIN=1,Mr=Ot.MAX=3;function Ot(v){if(v!==1&&v!==2&&v!==3)throw"Only interface versions between "+Dt+" and "+Mr+" supported. You specified: "+v;var f=v;if(f<3){var d=window.jQuery;if(!d)throw"MathQuill interface version ".concat(f," requires jQuery 1.5.2+ to be loaded first");Se.prototype.jQuery=d}var g=jk(jk({},Ie),{handlers:function(Te){return{fns:Te||{},APIClasses:Y}}});function y(Te,we){for(var Ne in we)if(we.hasOwnProperty(Ne)){if(Ne==="substituteKeyboardEvents"&&f>=3)throw new Error(["As of interface version 3, the 'substituteKeyboardEvents'","option is no longer supported. Use 'overrideTypedText' and","'overrideKeystroke' instead."].join(" "));var Ue=we[Ne],rt=g[Ne];Te[Ne]=rt?rt(Ue):Ue}}var G=f<3?Se:function(Te){ct(we,Te);function we(){return Te!==null&&Te.apply(this,arguments)||this}return we}(Se),F=function(Te){ct(we,Te);function we(Ne){var Ue=Te.call(this)||this;return Ue.__controller=Ne,Ue.__options=Ne.options,Ue.id=Ne.id,Ue.data=Ne.data,Ue}return we.prototype.mathquillify=function(Ne){var Ue=this.__controller,rt=Ue.root,lt=Ue.container;Ue.createTextarea();var wt=L(lt).addClass(Ne).children().detach();rt.setDOM(L(l("span",{class:"dcg-mq-root-block","aria-hidden":!0})).appendTo(lt).oneElement()),X.linkElementByBlockNode(rt.domFrag().oneElement(),rt),this.latex(wt.text()),this.revert=function(){return Ue.removeMouseEventListener(),L(lt).removeClass("dcg-mq-editable-field dcg-mq-math-mode dcg-mq-text-mode").empty().append(wt),f<3?this.__options.assertJquery()(lt):lt}},we.prototype.setAriaLabel=function(Ne){return this.__controller.setAriaLabel(Ne),this},we.prototype.getAriaLabel=function(){return this.__controller.getAriaLabel()},we.prototype.config=function(Ne){return y(this.__options,Ne),this},we.prototype.el=function(){return this.__controller.container},we.prototype.text=function(){return this.__controller.exportText()},we.prototype.mathspeak=function(){return this.__controller.exportMathSpeak()},we.prototype.latex=function(Ne){if(arguments.length>0){this.__controller.renderLatexMath(Ne);var Ue=this.__controller.cursor;return this.__controller.blurred&&Ue.hide().parent.blur(Ue),this}return this.__controller.exportLatex()},we.prototype.selection=function(){return this.__controller.exportLatexSelection()},we.prototype.html=function(){return this.__controller.root.domFrag().oneElement().innerHTML.replace(/ jQuery\d+="(?:\d+|null)"/g,"").replace(/ mathquill-(?:command|block)-id="?\d+"?/g,"").replace(/<span class="?dcg-mq-cursor( dcg-mq-blink)?"?>.?<\/span>/i,"").replace(/ dcg-mq-hasCursor|dcg-mq-hasCursor ?/,"").replace(/ class=(""|(?= |>))/g,"")},we.prototype.reflow=function(){return this.__controller.root.postOrder(function(Ne){Ne.reflow()}),this},we}(ot),q=function(Te){ct(we,Te);function we(){return Te!==null&&Te.apply(this,arguments)||this}return we.prototype.mathquillify=function(Ne){return Te.prototype.mathquillify.call(this,Ne),this.__controller.editable=!0,this.__controller.addMouseEventListener(),this.__controller.editablesTextareaEvents(),this},we.prototype.focus=function(){return this.__controller.getTextareaOrThrow().focus(),this.__controller.scrollHoriz(),this},we.prototype.blur=function(){return this.__controller.getTextareaOrThrow().blur(),this},we.prototype.write=function(Ne){this.__controller.writeLatex(Ne),this.__controller.scrollHoriz();var Ue=this.__controller.cursor;return this.__controller.blurred&&Ue.hide().parent.blur(Ue),this},we.prototype.empty=function(){var Ne,Ue=this.__controller.root,rt=this.__controller.cursor;return Ue.setEnds((Ne={},Ne[r]=0,Ne[e]=0,Ne)),Ue.domFrag().empty(),delete rt.selection,rt.insAtRightEnd(Ue),this},we.prototype.cmd=function(Ne){var Ue=this.__controller.notify(void 0),rt=Ue.cursor;if(/^\\[a-z]+$/i.test(Ne)&&!rt.isTooDeep()){Ne=Ne.slice(1);var lt=E[Ne],wt;lt&&(lt.constructor?wt=new lt(Ne):wt=lt(Ne),rt.selection&&wt.replaces(rt.replaceSelection()),wt.createLeftOf(rt.show()))}else rt.parent.write(rt,Ne);return Ue.scrollHoriz(),Ue.blurred&&rt.hide().parent.blur(rt),this},we.prototype.select=function(){return this.__controller.selectAll(),this},we.prototype.clearSelection=function(){return this.__controller.cursor.clearSelection(),this},we.prototype.moveToDirEnd=function(Ne){return this.__controller.notify("move").cursor.insAtDirEnd(Ne,this.__controller.root),this},we.prototype.moveToLeftEnd=function(){return this.moveToDirEnd(r)},we.prototype.moveToRightEnd=function(){return this.moveToDirEnd(e)},we.prototype.keystroke=function(Ne,Ue){for(var rt=Ne.replace(/^\s+|\s+$/g,"").split(/\s+/),lt=0;lt<rt.length;lt+=1)this.__controller.keystroke(rt[lt],Ue);return this},we.prototype.typedText=function(Ne){for(var Ue=0;Ue<Ne.length;Ue+=1)this.__controller.typedText(Ne.charAt(Ue));return this},we.prototype.dropEmbedded=function(Ne,Ue,rt){var lt=Ne-M(),wt=Ue-I(),Or=document.elementFromPoint(lt,wt);this.__controller.seek(Or,lt,wt);var yo=new Vy().setOptions(rt);yo.createLeftOf(this.__controller.cursor)},we.prototype.setAriaPostLabel=function(Ne,Ue){return this.__controller.setAriaPostLabel(Ne,Ue),this},we.prototype.getAriaPostLabel=function(){return this.__controller.getAriaPostLabel()},we.prototype.clickAt=function(Ne,Ue,rt){rt=rt||document.elementFromPoint(Ne,Ue);var lt=this.__controller,wt=lt.root,Or=wt.domFrag().oneElement();return Or.contains(rt)||(rt=Or),lt.seek(rt,Ne,Ue),lt.blurred&&this.focus(),this},we.prototype.ignoreNextMousedown=function(Ne){return this.__controller.cursor.options.ignoreNextMousedown=Ne,this},we}(F),Y={AbstractMathQuill:F,EditableField:q};n("API.StaticMath defined",ae.StaticMath),Y.StaticMath=ae.StaticMath(Y),n("API.MathField defined",ae.MathField),Y.MathField=ae.MathField(Y),n("API.InnerMathField defined",ae.InnerMathField),Y.InnerMathField=ae.InnerMathField(Y),ae.TextField&&(Y.TextField=ae.TextField(Y));var se=function(Te){if(!Te||!Te.nodeType)return null;for(var we,Ne=L(Te).children().toElementArray(),Ue=0,rt=Ne;Ue<rt.length;Ue++){var lt=rt[Ue];if(lt.classList.contains("dcg-mq-root-block")){we=lt;break}}var wt=X.getNodeOfElement(we),Or=wt&&wt.controller,yo=Or&&Y[Or.KIND_OF_MQ];return Or&&yo?new yo(Or):null};se.L=r,se.R=e,se.config=function(Te){return y(G.prototype,Te),this},se.registerEmbed=function(Te,we){if(!/^[a-z][a-z0-9]*$/i.test(Te))throw"Embed name must start with letter and be only letters and digits";ie[Te]=we},se.StaticMath=Oe("StaticMath",Y.StaticMath),se.MathField=Oe("MathField",Y.MathField),se.InnerMathField=Oe("InnerMathField",Y.InnerMathField),Y.TextField&&(se.TextField=Oe("TextField",Y.TextField)),se.prototype=F.prototype,se.EditableField=function(){throw"wtf don't call me, I'm 'abstract'"},se.EditableField.prototype=q.prototype,f<3&&(se.saneKeyboardEvents=_l);function Oe(Te,we){n(Te+" is defined",we);function Ne(Ue,rt){if(!Ue||!Ue.nodeType)return null;var lt=se(Ue);if(lt instanceof we)return lt;var wt=new Gt(new we.RootBlock,Ue,new G(f));return wt.KIND_OF_MQ=Te,new we(wt).__mathquillify(rt||{},f)}return Ne.prototype=we.prototype,Ne}return se}Vt.noConflict=function(){return window.MathQuill=Le,Vt};var Le=window.MathQuill;window.MathQuill=Vt;function fo(v){v.moveOutOf=function(f){n("controller is defined",this.controller),this.controller.handle("moveOutOf",f)},v.deleteOutOf=function(f){n("controller is defined",this.controller),this.controller.handle("deleteOutOf",f)},v.selectOutOf=function(f){n("controller is defined",this.controller),this.controller.handle("selectOutOf",f)},v.upOutOf=function(){n("controller is defined",this.controller),this.controller.handle("upOutOf")},v.downOutOf=function(){n("controller is defined",this.controller),this.controller.handle("downOutOf")},v.reflow=function(){n("controller is defined",this.controller),this.controller.handle("reflow"),this.controller.handle("edited"),this.controller.handle("edit")}}function Wi(v,f){throw v?v="'"+v+"'":v="EOF","Parse Error: "+f+" at "+v}var fe=function(){function v(f){this._=f}return v.prototype.parse=function(f){return this.skip(v.eof)._(""+f,d,Wi);function d(g,y){return y}},v.prototype.or=function(f){n("or is passed a parser",f instanceof v);var d=this;return new v(function(g,y,G){return d._(g,y,F);function F(q){return f._(g,y,G)}})},v.prototype.then=function(f){var d=this;return new v(function(g,y,G){return d._(g,F,G);function F(q,Y){var se=f instanceof v?f:f(Y);return n("a parser is returned",se instanceof v),se._(q,y,G)}})},v.prototype.many=function(){var f=this;return new v(function(d,g,y){for(var G=[];f._(d,F,q););return g(d,G);function F(Y,se){return d=Y,G.push(se),!0}function q(){return!1}})},v.prototype.times=function(f,d){arguments.length<2&&(d=f);var g=this;return new v(function(y,G,F){for(var q=[],Y=!0,se,Oe=0;Oe<f;Oe+=1)if(Y=!!g._(y,Te,we),!Y)return F(y,se);for(;Oe<d&&Y;Oe+=1)g._(y,Te,Ne);return G(y,q);function Te(Ue,rt){return q.push(rt),y=Ue,!0}function we(Ue,rt){return se=rt,y=Ue,!1}function Ne(Ue,rt){return!1}})},v.prototype.result=function(f){return this.then(v.succeed(f))},v.prototype.atMost=function(f){return this.times(0,f)},v.prototype.atLeast=function(f){var d=this;return d.times(f).then(function(g){return d.many().map(function(y){return g.concat(y)})})},v.prototype.map=function(f){return this.then(function(d){return v.succeed(f(d))})},v.prototype.skip=function(f){return this.then(function(d){return f.result(d)})},v.string=function(f){var d=f.length,g="expected '"+f+"'";return new v(function(y,G,F){var q=y.slice(0,d);return q===f?G(y.slice(d),q):F(y,g)})},v.regex=function(f){n("regexp parser is anchored",f.toString().charAt(1)==="^");var d="expected "+f;return new v(function(g,y,G){var F=f.exec(g);if(F){var q=F[0];return y(g.slice(q.length),q)}else return G(g,d)})},v.succeed=function(f){return new v(function(d,g){return g(d,f)})},v.fail=function(f){return new v(function(d,g,y){return y(d,f)})},v.letter=v.regex(/^[a-z]/i),v.letters=v.regex(/^[a-z]*/i),v.digit=v.regex(/^[0-9]/),v.digits=v.regex(/^[0-9]*/),v.whitespace=v.regex(/^\s+/),v.optWhitespace=v.regex(/^\s*/),v.any=new v(function(f,d,g){return f?d(f.slice(1),f.charAt(0)):g(f,"expected any character")}),v.all=new v(function(f,d,g){return d("",f)}),v.eof=new v(function(f,d,g){return f?g(f,"expected EOF"):d(f,f)}),v}(),Yo=function(){function v(){this.fn=o}return v.prototype.listen=function(f){this.fn=f,clearTimeout(this.timeoutId),this.timeoutId=setTimeout(this.fn)},v.prototype.listenOnce=function(f){var d=this;this.listen(function(){for(var g=[],y=0;y<arguments.length;y++)g[y]=arguments[y];d.clearListener(),f.apply(void 0,g)})},v.prototype.clearListener=function(){this.fn=o,clearTimeout(this.timeoutId)},v.prototype.trigger=function(){for(var f=[],d=0;d<arguments.length;d++)f[d]=arguments[d];this.fn.apply(this,f)},v}(),tt=function(){var v={8:"Backspace",9:"Tab",10:"Enter",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",144:"NumLock"},f={ArrowRight:"Right",ArrowLeft:"Left",ArrowDown:"Down",ArrowUp:"Up",Delete:"Del",Escape:"Esc"," ":"Spacebar"};function d(F){switch(y(F)){case"Right":case"Left":case"Down":case"Up":return!0}return!1}function g(F){return F.length===1&&F>="a"&&F<="z"}function y(F){var q;if(F.key===void 0){var Y=F.which||F.keyCode;return v[Y]||String.fromCharCode(Y)}return g(F.key)?F.key.toUpperCase():(q=f[F.key])!==null&&q!==void 0?q:F.key}function G(F){var q=y(F),Y=[];return F.ctrlKey&&Y.push("Ctrl"),F.metaKey&&Y.push("Meta"),F.altKey&&Y.push("Alt"),F.shiftKey&&Y.push("Shift"),Y.length?(q!=="Alt"&&q!=="Control"&&q!=="Meta"&&q!=="Shift"&&Y.push(q),Y.join("-")):q}return function(q,Y){var se=null,Oe=null,Te=new Yo;function we(){try{q instanceof HTMLTextAreaElement&&q.select()}catch(qr){}}function Ne(qr){Te.trigger(),Te.clearListener(),q instanceof HTMLTextAreaElement&&(q.value=qr),qr&&we(),Ue=!!qr}var Ue=!1;function rt(){return!("selectionStart"in q)||!(q instanceof HTMLTextAreaElement)?!1:q.selectionStart!==q.selectionEnd}function lt(){Y.options&&Y.options.overrideKeystroke?Y.options.overrideKeystroke(G(se),se):Y.keystroke(G(se),se)}function wt(qr){Te.trigger(qr),qr.target===q&&(se=qr,Oe=null,Ue&&Te.listenOnce(function(gd){gd&&gd.type==="focusout"||we()}),lt())}function Or(qr){Te.trigger(qr),qr.target===q&&(se&&Oe&&lt(),Oe=qr,d(qr)?Te.listenOnce(Go):Te.listen(Br))}function yo(qr){Te.trigger(qr),qr.target===q&&se&&!Oe&&(d(qr)?Te.listenOnce(Go):Te.listen(Br))}function Br(){if(!rt()&&q instanceof HTMLTextAreaElement){var qr=q.value;se&&!se.altKey&&se.ctrlKey&&!se.metaKey&&se.shiftKey&&(se.key==="U"||se.key==="Unidentified"||se.key==="Process")||(qr.length===1?(q.value="",Y.options&&Y.options.overrideTypedText?Y.options.overrideTypedText(qr):Y.typedText(qr)):Go())}}function Go(){q instanceof HTMLTextAreaElement&&q.value.length>1&&we()}function ms(){se=null,Oe=null,Te.clearListener(),q instanceof HTMLTextAreaElement&&(q.value="")}function Ja(qr){Te.trigger(),qr.target===q&&(document.activeElement!==q&&q.focus(),Te.listen(function(){if(q instanceof HTMLTextAreaElement){var ql=q.value;q.value="",ql&&Y.paste(ql)}}))}function Sc(qr){Te.trigger(qr)}return Y.options&&Y.options.disableCopyPaste?Y.addTextareaEventListeners({keydown:wt,keypress:Or,keyup:yo,focusout:ms,copy:function(qr){qr.preventDefault()},cut:function(qr){qr.preventDefault()},paste:function(qr){Te.trigger(),qr.preventDefault()},input:Sc}):Y.addTextareaEventListeners({keydown:wt,keypress:Or,keyup:yo,focusout:ms,cut:function(){Te.listenOnce(function(){Y.cut()})},copy:function(){Te.listenOnce(function(){Y.copy()})},paste:Ja,input:Sc}),{select:Ne}}}(),ft=function(v){ct(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.exportText=function(){return this.root.foldChildren("",function(d,g){return d+g.text()})},f}(he);he.onNotify(function(v,f){if(f==="edit"||f==="replace"||f===void 0){var d=v.controller;if(!d||!d.options.enableDigitGrouping||d.blurred!==!1)return;d.disableGroupingForSeconds(1)}});var gt=function(v){ct(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.handleTextareaFocusEditable=function(){var g=d.cursor;d.updateMathspeak(),d.blurred=!1,clearTimeout(d.blurTimeout),L(d.container).addClass("dcg-mq-focused"),g.parent||g.insAtRightEnd(d.root),g.selection?(g.selection.domFrag().removeClass("dcg-mq-blur"),d.selectionChanged()):g.show(),d.setOverflowClasses()},d.handleTextareaBlurEditable=function(){d.textareaSelectionTimeout&&(clearTimeout(d.textareaSelectionTimeout),d.textareaSelectionTimeout=0),d.disableGroupingForSeconds(0),d.blurred=!0,d.blurTimeout=setTimeout(function(){d.root.postOrder(function(g){g.intentionalBlur()}),d.cursor.clearSelection().endSelection(),d.blur(),d.updateMathspeak(),d.scrollHoriz()}),window.addEventListener("blur",d.handleWindowBlur)},d.handleTextareaFocusStatic=function(){d.blurred=!1},d.handleTextareaBlurStatic=function(){d.cursor.selection&&d.cursor.selection.clear(),setTimeout(function(){L(d.getTextareaSpanOrThrow()).detach(),d.blurred=!0})},d.handleWindowBlur=function(){clearTimeout(d.blurTimeout),d.cursor.selection&&d.cursor.selection.domFrag().addClass("dcg-mq-blur"),d.blur(),d.updateMathspeak()},d}return f.prototype.disableGroupingForSeconds=function(d){var g=this;clearTimeout(this.__disableGroupingTimeout),d===0?this.root.domFrag().removeClass("dcg-mq-suppress-grouping"):(this.root.domFrag().addClass("dcg-mq-suppress-grouping"),this.__disableGroupingTimeout=setTimeout(function(){g.root.domFrag().removeClass("dcg-mq-suppress-grouping")},d*1e3))},f.prototype.blur=function(){this.cursor.hide().parent.blur(this.cursor),L(this.container).removeClass("dcg-mq-focused"),window.removeEventListener("blur",this.handleWindowBlur),this.options&&this.options.resetCursorOnBlur&&this.cursor.resetToEnd(this)},f.prototype.addEditableFocusBlurListeners=function(){var d=this,g=d.cursor;this.addTextareaEventListeners({focus:this.handleTextareaFocusEditable,blur:this.handleTextareaBlurEditable}),d.blurred=!0,g.hide().parent.blur(g)},f.prototype.addStaticFocusBlurListeners=function(){this.addTextareaEventListeners({focus:this.handleTextareaFocusStatic,blur:this.handleTextareaBlurStatic})},f}(ft),xe=!1,Pt=function(v){ct(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.keystroke=function(d,g,y){var G=y.cursor;switch(d){case"Ctrl-Shift-Backspace":case"Ctrl-Backspace":y.ctrlDeleteDir(r);break;case"Shift-Backspace":case"Backspace":y.backspace();break;case"Esc":case"Tab":y.escapeDir(e,d,g);return;case"Shift-Tab":case"Shift-Esc":y.escapeDir(r,d,g);return;case"End":y.notify("move").cursor.insAtRightEnd(G.parent),y.aria.queue("end of").queue(G.parent,!0);break;case"Ctrl-End":y.notify("move").cursor.insAtRightEnd(y.root),y.aria.queue("end of").queue(y.ariaLabel).queue(y.root).queue(y.ariaPostLabel);break;case"Shift-End":y.selectToBlockEndInDir(e);break;case"Ctrl-Shift-End":y.selectToRootEndInDir(e);break;case"Home":y.notify("move").cursor.insAtLeftEnd(G.parent),y.aria.queue("beginning of").queue(G.parent,!0);break;case"Ctrl-Home":y.notify("move").cursor.insAtLeftEnd(y.root),y.aria.queue("beginning of").queue(y.ariaLabel).queue(y.root).queue(y.ariaPostLabel);break;case"Shift-Home":y.selectToBlockEndInDir(r);break;case"Ctrl-Shift-Home":y.selectToRootEndInDir(r);break;case"Left":y.moveLeft();break;case"Shift-Left":y.selectLeft();break;case"Ctrl-Left":break;case"Right":y.moveRight();break;case"Shift-Right":y.selectRight();break;case"Ctrl-Right":break;case"Up":y.moveUp();break;case"Down":y.moveDown();break;case"Shift-Up":y.withIncrementalSelection(function(F){if(G[r])for(;G[r];)F(r);else F(r)});break;case"Shift-Down":y.withIncrementalSelection(function(F){if(G[e])for(;G[e];)F(e);else F(e)});break;case"Ctrl-Up":break;case"Ctrl-Down":break;case"Ctrl-Shift-Del":case"Ctrl-Del":y.ctrlDeleteDir(e);break;case"Shift-Del":case"Del":y.deleteForward();break;case"Meta-A":case"Ctrl-A":y.selectAll();break;case"Ctrl-Alt-Up":G.parent.parent&&G.parent.parent instanceof f?y.aria.queue(G.parent.parent):y.aria.queue("nothing above");break;case"Ctrl-Alt-Down":G.parent&&G.parent instanceof f?y.aria.queue(G.parent):y.aria.queue("block is empty");break;case"Ctrl-Alt-Left":G.parent.parent&&G.parent.parent.getEnd(r)?y.aria.queue(G.parent.parent.getEnd(r)):y.aria.queue("nothing to the left");break;case"Ctrl-Alt-Right":G.parent.parent&&G.parent.parent.getEnd(e)?y.aria.queue(G.parent.parent.getEnd(e)):y.aria.queue("nothing to the right");break;case"Ctrl-Alt-Shift-Down":G.selection?y.aria.queue(G.selection.join("mathspeak"," ").trim()+" selected"):y.aria.queue("nothing selected");break;case"Ctrl-Alt-=":case"Ctrl-Alt-Shift-Right":y.ariaPostLabel.length?y.aria.queue(y.ariaPostLabel):y.aria.queue("no answer");break;default:return}y.aria.alert(),g==null||g.preventDefault(),y.scrollHoriz()},f.prototype.moveOutOf=function(d,g,y){n("overridden or never called on this node",!1)},f.prototype.moveTowards=function(d,g,y){n("overridden or never called on this node",!1)},f.prototype.deleteOutOf=function(d,g){n("overridden or never called on this node",!1)},f.prototype.deleteTowards=function(d,g){n("overridden or never called on this node",!1)},f.prototype.unselectInto=function(d,g){n("overridden or never called on this node",!1)},f.prototype.selectOutOf=function(d,g){n("overridden or never called on this node",!1)},f.prototype.selectTowards=function(d,g){n("overridden or never called on this node",!1)},f}(X);he.onNotify(function(v,f){(f==="move"||f==="upDown")&&v.show().clearSelection()}),Ie.leftRightIntoCmdGoes=function(v){if(v&&v!=="up"&&v!=="down")throw'"up" or "down" required for leftRightIntoCmdGoes option, got "'+v+'"';return v},he.onNotify(function(v,f){f!=="upDown"&&(v.upDownCache={})}),he.onNotify(function(v,f){f==="edit"&&v.show().deleteSelection()}),he.onNotify(function(v,f){f!=="select"&&v.endSelection()});var Fe=function(v){ct(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.keystroke=function(d,g){this.cursor.parent.keystroke(d,g,this.getControllerSelf())},f.prototype.escapeDir=function(d,g,y){a(d);var G=this.cursor;if(G.parent!==this.root&&(y==null||y.preventDefault()),G.parent!==this.root)return G.clearSelection(),G.parent.moveOutOf(d,G),G.controller.aria.alert(),this.notify("move")},f.prototype.moveDir=function(d){a(d);var g=this.cursor,y=g.options.leftRightIntoCmdGoes,G=g[d];return g.selection?g.insDirOf(d,g.selection.getEnd(d)):G?G.moveTowards(d,g,y):g.parent.moveOutOf(d,g,y),this.notify("move")},f.prototype.moveLeft=function(){return this.moveDir(r)},f.prototype.moveRight=function(){return this.moveDir(e)},f.prototype.moveUp=function(){return this.moveUpDown("up")},f.prototype.moveDown=function(){return this.moveUpDown("down")},f.prototype.moveUpDown=function(d){var g=this,y=g.notify("upDown").cursor,G,F;d==="up"?(G="upInto",F="upOutOf"):(G="downInto",F="downOutOf");var q=y[r],Y=y[e],se=Y&&Y[G],Oe=q&&q[G];return se?y.insAtLeftEnd(se):Oe?y.insAtRightEnd(Oe):y.parent.bubble(function(Te){var we=Te[F];if(we&&(typeof we=="function"&&(we=we.call(Te,y)),we instanceof Pt&&y.jumpUpDown(Te,we),we!==!0))return!1}),g},f.prototype.deleteDir=function(d){a(d);var g=this.cursor,y=g[d],G=g.parent.parent,F=g.controller;if(y&&y instanceof Pt)y.sides?F.aria.queue(y.parent.chToCmd(y.sides[-d].ch).mathspeak({createdLeftOf:g})):!y.blocks&&y.parent.ctrlSeq!=="\\text"&&F.aria.queue(y);else if(G&&G instanceof Pt)if(G.sides)F.aria.queue(G.parent.chToCmd(G.sides[d].ch).mathspeak({createdLeftOf:g}));else if(G.blocks&&G.mathspeakTemplate)if(G.upInto&&G.downInto)F.aria.queue(G.mathspeakTemplate[1]);else{var q=G.mathspeakTemplate,Y=d===r?q[0]:q[q.length-1];F.aria.queue(Y)}else F.aria.queue(G);var se=g.selection;if(this.notify("edit"),!se){var Oe=g[d];Oe?Oe.deleteTowards(d,g):g.parent.deleteOutOf(d,g)}var Te=g[r],we=g[e];return Te.siblingDeleted&&Te.siblingDeleted(g.options,e),we.siblingDeleted&&we.siblingDeleted(g.options,r),g.parent.bubble(function(Ne){Ne.reflow()}),this},f.prototype.ctrlDeleteDir=function(d){a(d);var g=this.cursor;if(!g[d]||g.selection)return this.deleteDir(d);this.notify("edit");var y;d===r?y=new A(g.parent.getEnd(r),g[r]):y=new A(g[e],g.parent.getEnd(e)),g.controller.aria.queue(y),y.remove(),g.insAtDirEnd(d,g.parent);var G=g[r],F=g[e];return G&&G.siblingDeleted(g.options,e),F&&F.siblingDeleted(g.options,r),g.parent.bubble(function(q){q.reflow()}),this},f.prototype.backspace=function(){return this.deleteDir(r)},f.prototype.deleteForward=function(){return this.deleteDir(e)},f.prototype.startIncrementalSelection=function(){n("Multiple selections can't be simultaneously open",!xe),xe=!0,this.notify("select");var d=this.cursor;d.anticursor||d.startSelection()},f.prototype.selectDirIncremental=function(d){n("A selection is open",xe),xe=!0;var g=this.cursor,y=g.selection;a(d);var G=g[d];G?y&&y.getEnd(d)===G&&g.anticursor[-d]!==G?G.unselectInto(d,g):G.selectTowards(d,g):g.parent.selectOutOf(d,g)},f.prototype.finishIncrementalSelection=function(){n("A selection is open",xe);var d=this.cursor;d.clearSelection(),d.select()||d.show();var g=d.selection;g&&d.controller.aria.clear().queue(g.join("mathspeak"," ").trim()+" selected"),xe=!1},f.prototype.withIncrementalSelection=function(d){var g=this;try{this.startIncrementalSelection();try{d(function(y){return g.selectDirIncremental(y)})}finally{this.finishIncrementalSelection()}}finally{xe=!1}},f.prototype.selectDir=function(d){this.withIncrementalSelection(function(g){return g(d)})},f.prototype.selectLeft=function(){return this.selectDir(r)},f.prototype.selectRight=function(){return this.selectDir(e)},f.prototype.selectAll=function(){this.notify("move");var d=this.cursor;d.insAtRightEnd(this.root),this.withIncrementalSelection(function(g){for(;d[r];)g(r)})},f.prototype.selectToBlockEndInDir=function(d){var g=this.cursor;this.withIncrementalSelection(function(y){for(;g[d];)y(d)})},f.prototype.selectToRootEndInDir=function(d){var g=this,y=this.cursor;this.withIncrementalSelection(function(G){for(;y[d]||y.parent!==g.root;)G(d)})},f}(gt),wi=function(v){ct(f,v);function f(d){return v.call(this)||this}return f}(Pt),Ce=function(){function v(Br){var Go=new io;return Br.adopt(Go,0,0),Go}function f(Br){for(var Go=Br[0]||new io,ms=1;ms<Br.length;ms+=1)Br[ms].children().adopt(Go,Go.getEnd(e),0);return Go}var d=fe.string,g=fe.regex,y=fe.letter,G=fe.digit,F=fe.any,q=fe.optWhitespace,Y=fe.succeed,se=fe.fail,Oe=y.map(function(Br){return new Jo(Br)}),Te=G.map(function(Br){return new vc(Br)}),we=g(/^[^${}\\_^]/).map(function(Br){return new wc(Br)}),Ne=g(/^[^\\a-eg-zA-Z]/).or(d("\\").then(g(/^[a-z]+/i).or(g(/^\s+/).result(" ")).or(F))).then(function(Br){var Go=E[Br];if(Go)if(Go.constructor){var ms=Go;return new ms(Br).parser()}else{var Ja=Go;return Ja(Br).parser()}else return se("unknown command: \\"+Br)}),Ue=Ne.or(Oe).or(Te).or(we),rt=d("{").then(function(){return wt}).skip(d("}")),lt=q.then(rt.or(Ue.map(v))),wt=lt.many().map(f).skip(q),Or=d("[").then(lt.then(function(Br){return Br.join("latex")!=="]"?Y(Br):se("")}).many().map(f).skip(q)).skip(d("]")),yo=wt;return yo.block=lt,yo.optBlock=Or,yo}();Ie.maxDepth=function(v){return typeof v=="number"?v:void 0};var Ct=function(v){ct(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.cleanLatex=function(d){return d.replace(/(\\[a-z]+) (?![a-z])/gi,"$1")},f.prototype.exportLatex=function(){return this.cleanLatex(this.root.latex())},f.prototype.writeLatex=function(d){var g=this.notify("edit").cursor;return g.parent.writeLatex(g,d),this},f.prototype.exportLatexSelection=function(){var d={latex:"",startIndex:-1,endIndex:-1},g=this.cursor.selection;if(g)d.startSelectionBefore=g.getEnd(r),d.endSelectionAfter=g.getEnd(e);else{var y=this.cursor[r];y?d.startSelectionAfter=y:d.startSelectionBefore=this.cursor.parent;var G=this.cursor[e];G?d.endSelectionBefore=G:d.endSelectionAfter=this.cursor.parent}this.root.latexRecursive(d);for(var F=d.latex,q=this.cleanLatex(F),Y=d.startIndex,se=d.endIndex,Oe=0,Te=0;Te<d.endIndex;Te++)F[Te]!==q[Oe]?(Te<d.startIndex&&(Y-=1),se-=1):Oe+=1;return{latex:q,startIndex:Y,endIndex:se}},f.prototype.classifyLatexForEfficientUpdate=function(d){if(typeof d=="string"){var g=d.match(/-?[0-9.]+$/g);if(g&&g.length===1)return{latex:d,prefix:d.substr(0,d.length-g[0].length),digits:g[0]}}},f.prototype.updateLatexMathEfficiently=function(d,g){var y,G,F,q,Y=this.root,se,Oe=this.classifyLatexForEfficientUpdate(d);if(Oe){if(se=this.classifyLatexForEfficientUpdate(g),!se||se.prefix!==Oe.prefix)return!1}else return!1;var Te=se.digits,we=Oe.digits,Ne=!1,Ue=!1;Te[0]==="-"&&(Ne=!0,Te=Te.substr(1)),we[0]==="-"&&(Ue=!0,we=we.substr(1));for(var rt=this.root.getEnd(e),lt=[],wt=Te.length-1;wt>=0;wt--){if(!rt||rt.ctrlSeq!==Te[wt]||rt.parent!==Y)return!1;lt.unshift(rt),rt=rt[r]}if(Ne&&!Ue){var Or=rt;if(!Or||Or.ctrlSeq!=="-"||Or[e]!==lt[0]||Or.parent!==Y)return!1;var yo=Or[r];if(yo&&yo.parent!==Y)return!1;lt[0][r]=Or[r],Y.getEnd(r)===Or&&Y.setEnds((y={},y[r]=lt[0],y[e]=Y.getEnd(e),y)),yo&&(yo[e]=lt[0]),Or.domFrag().remove()}if(!Ne&&Ue){var Br=new Nl("-"),Go=document.createElement("span");Go.textContent="-",Br.setDOM(Go);var ms=lt[0][r];ms&&(ms[e]=Br),Y.getEnd(r)===lt[0]&&Y.setEnds((G={},G[r]=Br,G[e]=Y.getEnd(e),G)),Br.parent=Y,Br[r]=lt[0][r],Br[e]=lt[0],lt[0][r]=Br,Br.contactWeld(this.cursor),Br.domFrag().insertBefore(lt[0].domFrag())}var Ja=Math.min(Te.length,we.length);for(wt=0;wt<Ja;wt++){var Sc=we[wt];rt=lt[wt],rt.ctrlSeq!==Sc&&(rt.ctrlSeq=Sc,rt.domFrag().oneElement().textContent=Sc,rt.mathspeakName=Sc)}if(Te.length>we.length)for(rt=lt[we.length-1],Y.setEnds((F={},F[r]=Y.getEnd(r),F[e]=rt,F)),rt[e]=0,wt=Te.length-1;wt>=Ja;wt--)lt[wt].domFrag().remove();if(we.length>Te.length){var qr=document.createDocumentFragment();for(wt=Ja;wt<we.length;wt++){var gd=document.createElement("span");gd.className="dcg-mq-digit",gd.textContent=we[wt];var ql=new vc(we[wt]);ql.parent=Y,ql.setDOM(gd),qr.appendChild(gd),ql[r]=Y.getEnd(e),ql[e]=0;var My=ql[r];My[e]=ql,Y.setEnds((q={},q[r]=Y.getEnd(r),q[e]=ql,q))}Y.domFrag().oneElement().appendChild(qr)}var fm=this.exportLatex();if(fm!==d)return console.warn("tried updating latex efficiently but did not work. Attempted: "+d+" but wrote: "+fm),!1;var Ay=Y.getEnd(e);return Ay&&Ay.fixDigitGrouping(this.cursor.options),!0},f.prototype.renderLatexMathFromScratch=function(d){var g,y=this.root,G=this.cursor,F=fe.all,q=fe.eof,Y=Ce.skip(q).or(F.result(!1)).parse(d);if(y.setEnds((g={},g[r]=0,g[e]=0,g)),Y&&Y.children().adopt(y,0,0),Y){var se=y.domFrag();se.children().remove(),se.oneElement().appendChild(Y.html()),y.finalizeInsert(G.options,G)}else y.domFrag().empty()},f.prototype.renderLatexMath=function(d){var g=this.cursor,y=this.root;this.notify("replace"),g.clearSelection();var G=this.exportLatex();(!y.getEnd(r)||!y.getEnd(e)||G!==d)&&(this.updateLatexMathEfficiently(d,G)||this.renderLatexMathFromScratch(d),this.updateMathspeak()),g.insAtRightEnd(y)},f.prototype.renderLatexText=function(d){var g,y=this.root,G=this.cursor;y.domFrag().children().slice(1).remove(),y.setEnds((g={},g[r]=0,g[e]=0,g)),delete G.selection,G.show().insAtRightEnd(y);var F=fe.regex,q=fe.string,Y=fe.eof,se=fe.all,Oe=q("$").then(Ce).skip(q("$").or(Y)).map(function(lt){var wt=new RootMathCommand(G);wt.createBlocks();var Or=wt.getEnd(r);return lt.children().adopt(Or,0,0),wt}),Te=q("\\$").result("$"),we=Te.or(F(/^[^$]/)).map(function(lt){return new wc(lt)}),Ne=Oe.or(we).many(),Ue=Ne.skip(Y).or(se.result(!1)).parse(d);if(Ue){for(var rt=0;rt<Ue.length;rt+=1)Ue[rt].adopt(y,y.getEnd(e),0);L(y.html()).appendTo(y.domFrag().oneElement()),y.finalizeInsert(G.options,G)}},f}(Fe),Tt=function(v){return!1};Se.prototype.ignoreNextMousedown=Tt;var ke;(function(){he.onNotify(function(v,f){(f==="edit"||f==="replace")&&ke&&ke.cursor===v&&ke.cb()})})();var pi=function(v){ct(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.handleMouseDown=function(g){var y=c(g.target,".dcg-mq-root-block"),G=y&&X.getNodeOfElement(y)||X.getNodeOfElement(d.root.domFrag().oneElement()),F=G.domFrag().firstNode().ownerDocument,q=G.controller,Y=q.cursor,se=Y.blink,Oe=q.getTextareaSpanOrThrow(),Te=q.getTextareaOrThrow();if(g.preventDefault(),g.target.unselectable=!0,Y.options.ignoreNextMousedown(g)||(Y.options.ignoreNextMousedown=Tt,c(g.target,".dcg-mq-ignore-mousedown")))return;var we=null;function Ne(yo){we=yo.target}function Ue(yo){Y.anticursor||Y.startSelection(),q.seek(we,yo.clientX,yo.clientY).cursor.select(),Y.selection&&Y.controller.aria.clear().queue(Y.selection.join("mathspeak")+" selected").alert(),we=null}function rt(){y==null||y.removeEventListener("mousemove",Ne),F==null||F.removeEventListener("mousemove",Ue),F==null||F.removeEventListener("mouseup",wt),ke=void 0}function lt(){q.editable?(Y.show(),Y.controller.aria.queue(Y.parent).alert()):L(Oe).detach()}function wt(){Y.blink=se,Y.selection||lt(),rt()}var Or;ke={cursor:Y,cb:function(){Or=!0,Y.blink=se,Y.clearSelection(),lt(),rt()}},!(q.blurred&&(y&&!q.editable&&L(y).prepend(L(Oe)),Te.focus(),Or))&&(Y.blink=o,q.seek(g.target,g.clientX,g.clientY).cursor.startSelection(),y==null||y.addEventListener("mousemove",Ne),F==null||F.addEventListener("mousemove",Ue),F==null||F.addEventListener("mouseup",wt))},d}return f.prototype.addMouseEventListener=function(){this.container.addEventListener("mousedown",this.handleMouseDown)},f.prototype.removeMouseEventListener=function(){this.container.removeEventListener("mousedown",this.handleMouseDown)},f.prototype.seek=function(d,g,y){for(var G=this.notify("select").cursor,F;d&&(F=X.getNodeOfElement(d),!F);)d=d.parentElement;return F||(F=this.root),G.clearSelection().show(),F.seek(g,G),this.scrollHoriz(),this},f}(Ct),pt=function(v){ct(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.setOverflowClasses=function(){var d=this.root.domFrag().oneElement(),g=!1,y=!1;if(!this.blurred){var G=k(d).width,F=d.scrollWidth,q=d.scrollLeft;g=F>G+q,y=q>0}d.classList.contains("dcg-mq-editing-overflow-right")!==g&&d.classList.toggle("dcg-mq-editing-overflow-right"),d.classList.contains("dcg-mq-editing-overflow-left")!==y&&d.classList.toggle("dcg-mq-editing-overflow-left")},f.prototype.scrollHoriz=function(){var d=this,g=this.cursor,y=g.selection,G=k(this.root.domFrag().oneElement());if(g.domFrag().isEmpty()&&!y){this.cancelScrollHoriz&&(this.cancelScrollHoriz(),this.cancelScrollHoriz=void 0);var F=this.root.domFrag().oneElement(),q=F.scrollLeft;S(this.getScrollAnimationDuration(),function(lt,wt,Or){lt>=1?(d.cancelScrollHoriz=void 0,F.scrollLeft=0,d.setOverflowClasses()):(d.cancelScrollHoriz=Or,wt(),F.scrollLeft=Math.round((1-lt)*q))});return}else if(y){var Oe=k(y.domFrag().oneElement()),Te=Oe.left-(G.left+20),we=Oe.right-(G.right-20);if(y.getEnd(r)===g[e])if(Te<0)var se=Te;else if(we>0)if(Oe.left-we<G.left+20)var se=Te;else var se=we;else return;else if(we>0)var se=we;else if(Te<0)if(Oe.right-Te>G.right-20)var se=we;else var se=Te;else return}else{var Y=k(g.domFrag().oneElement()).left;if(Y>G.right-20)var se=Y-(G.right-20);else if(Y<G.left+20)var se=Y-(G.left+20);else return}var Ne=this.root.domFrag().oneElement();if(!(se<0&&Ne.scrollLeft===0)&&!(se>0&&Ne.scrollWidth<=Ne.scrollLeft+G.width)){this.cancelScrollHoriz&&(this.cancelScrollHoriz(),this.cancelScrollHoriz=void 0);var Ue=this.root.domFrag().oneElement(),rt=Ue.scrollLeft;S(this.getScrollAnimationDuration(),function(lt,wt,Or){lt>=1?(d.cancelScrollHoriz=void 0,Ue.scrollLeft=Math.round(rt+se),d.setOverflowClasses()):(d.cancelScrollHoriz=Or,wt(),Ue.scrollLeft=Math.round(rt+lt*se))})}},f.prototype.getScrollAnimationDuration=function(){var d;return(d=this.options.scrollAnimationDuration)!==null&&d!==void 0?d:100},f}(pi);Se.prototype.substituteTextarea=function(){return l("textarea",{autocapitalize:"off",autocomplete:"off",autocorrect:"off",spellcheck:!1,"x-palm-disable-ste-all":!0})};function _l(v,f){return tt(v[0],f)}Se.prototype.substituteKeyboardEvents=_l;var Gt=function(v){ct(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.selectFn=o,d}return f.prototype.createTextarea=function(){this.textareaSpan=l("span",{class:"dcg-mq-textarea"});var d=this.options.substituteTextarea();if(!d.nodeType)throw"substituteTextarea() must return a DOM element, got "+d;this.textarea=L(d).appendTo(this.textareaSpan).oneElement();var g=this;g.cursor.selectionChanged=function(){g.selectionChanged()}},f.prototype.selectionChanged=function(){var d=this;d.textareaSelectionTimeout||(d.textareaSelectionTimeout=setTimeout(function(){d.setTextareaSelection()}))},f.prototype.setTextareaSelection=function(){this.textareaSelectionTimeout=0;var d="";this.cursor.selection&&(d=this.cleanLatex(this.cursor.selection.join("latex")),this.options.statelessClipboard&&(d="$"+d+"$")),this.selectFn(d)},f.prototype.staticMathTextareaEvents=function(){var d=this;this.removeTextareaEventListener("cut"),this.removeTextareaEventListener("paste"),d.options.disableCopyPaste?this.removeTextareaEventListener("copy"):this.addTextareaEventListeners({copy:function(){d.setTextareaSelection()}}),this.addStaticFocusBlurListeners(),d.selectFn=function(g){var y=d.getTextareaOrThrow();y instanceof HTMLTextAreaElement&&(y.value=g,g&&y.select())}},f.prototype.editablesTextareaEvents=function(){var d=this,g=d.getTextareaOrThrow(),y=d.getTextareaSpanOrThrow();if(this.options.version<3){var G=this.options.assertJquery(),F=this.options.substituteKeyboardEvents(G(g),this);this.selectFn=function(Y){F.select(Y)}}else{var q=tt(g,this).select;this.selectFn=q}L(this.container).prepend(L(y)),this.addEditableFocusBlurListeners(),this.updateMathspeak()},f.prototype.unbindEditablesEvents=function(){var d=this,g=d.getTextareaOrThrow(),y=d.getTextareaSpanOrThrow();this.selectFn=function(G){g instanceof HTMLTextAreaElement&&(g.value=G,G&&g.select())},L(y).remove(),this.removeTextareaEventListener("focus"),this.removeTextareaEventListener("blur"),d.blurred=!0,this.removeTextareaEventListener("cut"),this.removeTextareaEventListener("paste")},f.prototype.typedText=function(d){if(d===`
`)return this.handle("enter");var g=this.notify(void 0).cursor;g.parent.write(g,d),this.scrollHoriz()},f.prototype.cut=function(){var d=this,g=d.cursor;g.selection&&setTimeout(function(){d.notify("edit"),g.parent.bubble(function(y){y.reflow()}),d.options&&d.options.onCut&&d.options.onCut()})},f.prototype.copy=function(){this.setTextareaSelection()},f.prototype.paste=function(d){this.options.statelessClipboard&&(d.slice(0,1)==="$"&&d.slice(-1)==="$"?d=d.slice(1,-1):d="\\text{"+d+"}"),this.writeLatex(d).cursor.show(),this.scrollHoriz(),this.options&&this.options.onPaste&&this.options.onPaste()},f.prototype.setupStaticField=function(){this.mathspeakSpan=l("span",{class:"dcg-mq-mathspeak"}),L(this.container).prepend(L(this.mathspeakSpan)),this.updateMathspeak(),this.blurred=!0,this.cursor.hide().parent.blur(this.cursor)},f.prototype.updateMathspeak=function(){var d=this,g=d.getAriaLabel(),y=/[A-Za-z0-9]$/.test(g)?g+":":g,G=d.root.mathspeak().trim();this.aria.clear();var F=d.getTextareaOrThrow();d.mathspeakSpan?(F.setAttribute("aria-label",""),d.mathspeakSpan.textContent=(y+" "+G).trim()):F.setAttribute("aria-label",(y+" "+G+" "+d.ariaPostLabel).trim())},f}(pt),Eo=function(v){ct(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.finalizeInsert=function(d,g){var y=this;y.postOrder(function(q){q.finalizeTree(d)}),y.postOrder(function(q){q.contactWeld(g)}),y.postOrder(function(q){q.blur(g)}),y.postOrder(function(q){q.reflow()});var G=y[e],F=y[r];G&&G.siblingCreated(d,r),F&&F.siblingCreated(d,e),y.bubble(function(q){q.reflow()})},f.prototype.prepareInsertionAt=function(d){var g=d.options.maxDepth;if(g!==void 0){var y=d.depth();if(y>g)return!1;this.removeNodesDeeperThan(g-y)}return!0},f.prototype.removeNodesDeeperThan=function(d){for(var g=0,y=[[this,g]],G;G=y.shift();){var F=G;F[0].children().each(function(q){var Y=q instanceof io?1:0;g=F[1]+Y,g<=d?y.push([q,g]):(Y?q.children():q).remove()})}},f}(Pt),$i=function(){function v(f,d){this.childCount=f,this.render=d}return v}(),ro=function(v){ct(f,v);function f(d,g,y){var G=v.call(this)||this;return G.textTemplate=[""],G.mathspeakTemplate=[""],G.setCtrlSeqHtmlAndText(d,g,y),G}return f.prototype.setEnds=function(d){n("MathCommand ends are never empty",d[r]&&d[e]),this.ends=d},f.prototype.getEnd=function(d){return this.ends[d]},f.prototype.setCtrlSeqHtmlAndText=function(d,g,y){this.ctrlSeq||(this.ctrlSeq=d),g&&(this.domView=g),y&&(this.textTemplate=y)},f.prototype.replaces=function(d){d.disown(),this.replacedFragment=d},f.prototype.isEmpty=function(){return this.foldChildren(!0,function(d,g){return d&&g.isEmpty()})},f.prototype.parser=function(){var d=this,g=Ce.block;return g.times(this.numBlocks()).map(function(y){d.blocks=y;for(var G=0;G<y.length;G+=1)y[G].adopt(d,d.getEnd(e),0);return d})},f.prototype.createLeftOf=function(d){var g=this,y=g.replacedFragment;if(g.createBlocks(),v.prototype.createLeftOf.call(this,d),y){var G=g.getEnd(r);y.adopt(G,0,0),y.domFrag().appendTo(G.domFrag().oneElement()),g.placeCursor(d),g.prepareInsertionAt(d)}g.finalizeInsert(d.options,d),g.placeCursor(d)},f.prototype.createBlocks=function(){for(var d=this,g=d.numBlocks(),y=d.blocks=Array(g),G=0;G<g;G+=1){var F=y[G]=new io;F.adopt(d,d.getEnd(e),0)}},f.prototype.placeCursor=function(d){d.insAtRightEnd(this.foldChildren(this.getEnd(r),function(g,y){return g.isEmpty()?g:y}))},f.prototype.moveTowards=function(d,g,y){var G;y==="up"?G=this.upInto:y==="down"&&(G=this.downInto);var F=G||this.getEnd(-d);g.insAtDirEnd(-d,F),g.controller.aria.queueDirEndOf(-d).queue(g.parent,!0)},f.prototype.deleteTowards=function(d,g){this.isEmpty()?g[d]=this.remove()[d]:this.moveTowards(d,g)},f.prototype.selectTowards=function(d,g){g[-d]=this,g[d]=this[d]},f.prototype.selectChildren=function(){return new pe(this,this)},f.prototype.unselectInto=function(d,g){var y=g.anticursor,G=y.ancestors[this.id];g.insAtDirEnd(-d,G)},f.prototype.seek=function(d,g){function y(Y){var se,Oe=Y.domFrag().oneElement(),Te=k(Oe).left,we=Te+Oe.offsetWidth;return se={},se[r]=Te,se[e]=we,se}var G=this,F=y(G);if(d<F[r])return g.insLeftOf(G);if(d>F[e])return g.insRightOf(G);var q=F[r];G.eachChild(function(Y){var se=y(Y);if(d<se[r])return d-q<se[r]-d?Y[r]?g.insAtRightEnd(Y[r]):g.insLeftOf(G):g.insAtLeftEnd(Y),!1;if(d>se[e]){Y[e]?q=se[e]:F[e]-d<d-se[e]?g.insRightOf(G):g.insAtRightEnd(Y);return}else return Y.seek(d,g),!1})},f.prototype.numBlocks=function(){return this.domView.childCount},f.prototype.html=function(){var d=this.blocks;n("domView is defined",this.domView);var g=this.domView,y=g.render(d||[]);return this.setDOM(y),X.linkElementByCmdNode(y,this),y},f.prototype.latexRecursive=function(d){this.checkCursorContextOpen(d),d.latex+=this.ctrlSeq||"",this.eachChild(function(g){d.latex+="{";var y=d.latex.length;g.latexRecursive(d);var G=d.latex.length;y===G&&(d.latex+=" "),d.latex+="}"}),this.checkCursorContextClose(d)},f.prototype.text=function(){var d=this,g=0;return d.foldChildren(d.textTemplate[g],function(y,G){g+=1;var F=G.text();return y&&d.textTemplate[g]==="("&&F[0]==="("&&F.slice(-1)===")"?y+F.slice(1,-1)+d.textTemplate[g]:y+F+(d.textTemplate[g]||"")})},f.prototype.mathspeak=function(){var d=this,g=0;return d.foldChildren(d.mathspeakTemplate[g]||"Start"+d.ctrlSeq+" ",function(y,G){return g+=1,y+" "+G.mathspeak()+" "+(d.mathspeakTemplate[g]+" "||"End"+d.ctrlSeq+" ")})},f}(Eo),Rn=function(v){ct(f,v);function f(d,g,y,G){var F=v.call(this)||this;return F.setCtrlSeqHtmlTextAndMathspeak(d,g?new $i(0,function(){return g.cloneNode(!0)}):void 0,y,G),F}return f.prototype.setCtrlSeqHtmlTextAndMathspeak=function(d,g,y,G){!y&&d&&(y=d.replace(/^\\/,"")),this.mathspeakName=G||y,v.prototype.setCtrlSeqHtmlAndText.call(this,d,g,[y||""])},f.prototype.parser=function(){return fe.succeed(this)},f.prototype.numBlocks=function(){return 0},f.prototype.replaces=function(d){d.remove()},f.prototype.createBlocks=function(){},f.prototype.moveTowards=function(d,g){g.domFrag().insDirOf(d,this.domFrag()),g[-d]=this,g[d]=this[d],g.controller.aria.queue(this)},f.prototype.deleteTowards=function(d,g){g[d]=this.remove()[d]},f.prototype.seek=function(d,g){var y=this.domFrag().oneElement(),G=k(y).left;return d-G<y.offsetWidth/2?g.insLeftOf(this):g.insRightOf(this),g},f.prototype.latexRecursive=function(d){this.checkCursorContextOpen(d),d.latex+=this.ctrlSeq||"",this.checkCursorContextClose(d)},f.prototype.text=function(){return this.textTemplate.join("")},f.prototype.mathspeak=function(d){return this.mathspeakName||""},f.prototype.placeCursor=function(){},f.prototype.isEmpty=function(){return!0},f}(ro),wc=function(v){ct(f,v);function f(d,g,y){return v.call(this,d,l("span",{},[g||l.text(d)]),void 0,y)||this}return f}(Rn);function _a(v,f,d){return function(){return new wc(v,f?l.entityText(f):void 0,d)}}var _t=function(v){ct(f,v);function f(d,g,y,G,F){var q=this;return F?q=v.call(this,d,l("span",{},[g||l.text(d||"")]),void 0,G)||this:q=v.call(this,d,l("span",{class:"dcg-mq-binary-operator"},g?[g]:[]),y,G)||this,q}return f}(Rn);function va(v,f,d,g){return function(){return new _t(v,f?l.entityText(f):void 0,d,g)}}var io=function(v){ct(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.ariaLabel="block",d}return f.prototype.join=function(d){return this.foldChildren("",function(g,y){return g+y[d]()})},f.prototype.html=function(){var d=document.createDocumentFragment();return this.eachChild(function(g){var y=g.html();d.appendChild(y)}),d},f.prototype.latexRecursive=function(d){this.checkCursorContextOpen(d),this.eachChild(function(g){return g.latexRecursive(d)}),this.checkCursorContextClose(d)},f.prototype.text=function(){var d=this.getEnd(r),g=this.getEnd(e);return d===g&&d!==0?d.text():this.join("text")},f.prototype.mathspeak=function(){var d="",g={};return this.controller&&(g=this.controller.options.autoOperatorNames),this.foldChildren([],function(y,G){if(G.isPartOfOperator)d+=G.mathspeak();else{if(d!==""){if(g._maxLength>0){var F=g[d.toLowerCase()];typeof F=="string"&&(d=F)}y.push(d+" "),d=""}var q=G.mathspeak(),Y=G.ctrlSeq;isNaN(Y)&&Y!=="."&&(!G.parent||!G.parent.parent||!G.parent.parent.isTextBlock())&&(q=" "+q+" "),y.push(q)}return y}).join("").replace(/ +(?= )/g,"").replace(/(\.)([0-9]+)/g,function(y,G,F){return G+F.split("").join(" ").trim()})},f.prototype.keystroke=function(d,g,y){if(y.options.spaceBehavesLikeTab&&(d==="Spacebar"||d==="Shift-Spacebar")){g==null||g.preventDefault(),y.escapeDir(d==="Shift-Spacebar"?r:e,d,g);return}return v.prototype.keystroke.call(this,d,g,y)},f.prototype.moveOutOf=function(d,g,y){var G;if(y==="up"?G=this.parent.upInto:y==="down"&&(G=this.parent.downInto),!G&&this[d]){var F=-d;g.insAtDirEnd(F,this[d]),g.controller.aria.queueDirEndOf(F).queue(g.parent,!0)}else g.insDirOf(d,this.parent),g.controller.aria.queueDirOf(d).queue(this.parent)},f.prototype.selectOutOf=function(d,g){g.insDirOf(d,this.parent)},f.prototype.deleteOutOf=function(d,g){g.unwrapGramp()},f.prototype.seek=function(d,g){var y=this.getEnd(e);if(!y)return g.insAtRightEnd(this);var G=y.domFrag().oneElement(),F=k(G).left;if(F+G.offsetWidth<d)return g.insAtRightEnd(this);var q=this.getEnd(r);if(d<k(q.domFrag().oneElement()).left)return g.insAtLeftEnd(this);for(;d<k(y.domFrag().oneElement()).left;)y=y[r];return y.seek(d,g)},f.prototype.chToCmd=function(d,g){var y;return d.match(/^[a-eg-zA-Z]$/)?new Jo(d):/^\d$/.test(d)?new vc(d):g&&g.typingSlashWritesDivisionSymbol&&d==="/"?E["\xF7"](d):g&&g.typingAsteriskWritesTimesSymbol&&d==="*"?E["\xD7"](d):g&&g.typingPercentWritesPercentOf&&d==="%"?E.percentof(d):(y=J[d]||E[d])?y.constructor?new y(d):y(d):new wc(d)},f.prototype.write=function(d,g){var y=this.chToCmd(g,d.options);d.selection&&y.replaces(d.replaceSelection()),d.isTooDeep()||(y.createLeftOf(d.show()),g==="/"?d.controller.aria.alert("over"):d.controller.aria.alert(y.mathspeak({createdLeftOf:d})))},f.prototype.writeLatex=function(d,g){var y=fe.all,G=fe.eof,F=Ce.skip(G).or(y.result(!1)).parse(g);if(F&&!F.isEmpty()&&F.prepareInsertionAt(d)){F.children().adopt(d.parent,d[r],d[e]),L(F.html()).insertBefore(d.domFrag()),d[r]=F.getEnd(e),F.finalizeInsert(d.options,d);var q=F.getEnd(e),Y=F.getEnd(r),se=q[e],Oe=Y[r];se&&se.siblingCreated(d.options,r),Oe&&Oe.siblingCreated(d.options,e),d.parent.bubble(function(Te){Te.reflow()})}},f.prototype.focus=function(){return this.domFrag().addClass("dcg-mq-hasCursor"),this.domFrag().removeClass("dcg-mq-empty"),this},f.prototype.blur=function(d){return this.domFrag().removeClass("dcg-mq-hasCursor"),this.isEmpty()&&(this.domFrag().addClass("dcg-mq-empty"),d&&this.isQuietEmptyDelimiter(d.options.quietEmptyDelimiters)&&this.domFrag().addClass("dcg-mq-quiet-delimiter")),this},f}(Eo);Se.prototype.mouseEvents=!0,ae.StaticMath=function(v){var f;return f=function(d){ct(g,d);function g(y){var G=d.call(this,y)||this,F=G.innerFields=[];return G.__controller.root.postOrder(function(q){q.registerInnerField(F,v.InnerMathField)}),G}return g.prototype.__mathquillify=function(y,G){return this.config(y),d.prototype.mathquillify.call(this,"dcg-mq-math-mode"),this.__controller.setupStaticField(),this.__options.mouseEvents&&(this.__controller.addMouseEventListener(),this.__controller.staticMathTextareaEvents()),this},g.prototype.latex=function(y){var G=d.prototype.latex.apply(this,arguments);if(arguments.length>0){var F=this.innerFields=[];this.__controller.root.postOrder(function(q){q.registerInnerField(F,v.InnerMathField)}),this.__controller.updateMathspeak()}return G},g.prototype.setAriaLabel=function(y){return this.__controller.setAriaLabel(y),this},g.prototype.getAriaLabel=function(){return this.__controller.getAriaLabel()},g}(v.AbstractMathQuill),f.RootBlock=io,f};var En=function(v){ct(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f}(io);fo(En.prototype),ae.MathField=function(v){var f;return f=function(d){ct(g,d);function g(){return d!==null&&d.apply(this,arguments)||this}return g.prototype.__mathquillify=function(y,G){return this.config(y),G>1&&(this.__controller.root.reflow=o),d.prototype.mathquillify.call(this,"dcg-mq-editable-field dcg-mq-math-mode"),delete this.__controller.root.reflow,this},g}(v.EditableField),f.RootBlock=En,f},ae.InnerMathField=function(v){return n("MathField class is defined",v.MathField),function(f){ct(d,f);function d(){return f!==null&&f.apply(this,arguments)||this}return d.prototype.makeStatic=function(){this.__controller.editable=!1,this.__controller.root.blur(),this.__controller.unbindEditablesEvents(),L(this.__controller.container).removeClass("dcg-mq-editable-field")},d.prototype.makeEditable=function(){this.__controller.editable=!0,this.__controller.editablesTextareaEvents(),this.__controller.cursor.insAtRightEnd(this.__controller.root),L(this.__controller.container).addClass("dcg-mq-editable-field")},d}(v.MathField)};var bu=function(v){ct(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.finalizeTree=function(d,g){this.sharedSiblingMethod(d,g)},f.prototype.siblingDeleted=function(d,g){this.sharedSiblingMethod(d,g)},f.prototype.siblingCreated=function(d,g){this.sharedSiblingMethod(d,g)},f.prototype.sharedSiblingMethod=function(d,g){g!==r&&this[e]instanceof f||this.fixDigitGrouping(d)},f.prototype.fixDigitGrouping=function(d){if(d.enableDigitGrouping){var g=this,y=this,G=0,F=[],q="\\ ",Y=".",se=g;do if(/^[0-9]$/.test(se.ctrlSeq))g=se;else if(se.ctrlSeq===q)g=se,G+=1;else if(se.ctrlSeq===Y)g=se,F.push(se);else break;while(se=g[r]);for(;se=y[e];)if(/^[0-9]$/.test(se.ctrlSeq))y=se;else if(se.ctrlSeq===q)y=se,G+=1;else if(se.ctrlSeq===Y)y=se,F.push(se);else break;for(;y!==g&&g&&g.ctrlSeq===q;)g=g[e],G-=1;for(;y!==g&&y&&y.ctrlSeq===q;)y=y[r],G-=1;if(!(g===y&&g&&g.ctrlSeq===q)){var Oe=G>0||F.length>1;Oe?this.removeGroupingBetween(g,y):F[0]?(F[0]!==g&&this.addGroupingBetween(F[0][r],g),F[0]!==y&&this.removeGroupingBetween(F[0][e],y)):this.addGroupingBetween(y,g)}}},f.prototype.removeGroupingBetween=function(d,g){var y=d;do if(y instanceof f&&y.setGroupingClass(void 0),!y||y===g)break;while(y=y[e])},f.prototype.addGroupingBetween=function(d,g){for(var q=d,y=0,G=0,q=d;q&&(G+=1,q!==g);)q=q[r];var F=G%3;F===0&&(F=3);for(var q=d;q;){y+=1;var Y=void 0;if(G>=4&&(y===G?Y="dcg-mq-group-leading-"+F:y%3===0&&y!==G&&(Y="dcg-mq-group-start"),Y||(Y="dcg-mq-group-other")),q instanceof f&&q.setGroupingClass(Y),q===g)break;q=q[r]}},f.prototype.setGroupingClass=function(d){this._groupingClass!==d&&(this._groupingClass&&this.domFrag().removeClass(this._groupingClass),d&&this.domFrag().addClass(d),this._groupingClass=d)},f}(Rn),vc=function(v){ct(f,v);function f(d,g){return v.call(this,d,l("span",{class:"dcg-mq-digit"},[l.text(d)]),void 0,g)||this}return f.prototype.createLeftOf=function(d){var g=d[r],y=g&&g[r],G=d.parent.parent instanceof al?d.parent.parent.sub:void 0;d.options.autoSubscriptNumerals&&d.parent!==G&&(g instanceof ea&&g.isItalic!==!1||g instanceof al&&y instanceof ea&&y.isItalic!==!1)?(new YC().createLeftOf(d),v.prototype.createLeftOf.call(this,d),d.insRightOf(d.parent.parent)):v.prototype.createLeftOf.call(this,d)},f.prototype.mathspeak=function(d){if(d&&d.createdLeftOf){var g=d.createdLeftOf,y=g[r],G=y&&y[r],F=g.parent.parent instanceof al?g.parent.parent.sub:void 0;if(g.options.autoSubscriptNumerals&&g.parent!==F&&(y instanceof ea&&y.isItalic!==!1||g[r]instanceof al&&G instanceof ea&&G.isItalic!==!1))return"Subscript "+v.prototype.mathspeak.call(this)+" Baseline"}return v.prototype.mathspeak.call(this)},f}(bu),ea=function(v){ct(f,v);function f(d,g){return v.call(this,d,l("var",{},[g||l.text(d)]))||this}return f.prototype.text=function(){var d=this.ctrlSeq||"";return this.isPartOfOperator?d[0]=="\\"?d=d.slice(1,d.length):d[d.length-1]==" "&&(d=d.slice(0,-1)):(this[r]&&!(this[r]instanceof f)&&!(this[r]instanceof _t)&&this[r].ctrlSeq!=="\\ "&&(d="*"+d),this[e]&&!(this[e]instanceof _t)&&!(this[e]instanceof al)&&(d+="*")),d},f.prototype.mathspeak=function(){var d=this.ctrlSeq||"";return this.isPartOfOperator||d.length>1||this.parent&&this.parent.parent&&this.parent.parent.isTextBlock()?v.prototype.mathspeak.call(this):'"'+d+'"'},f}(Rn);function Nr(v,f,d){return function(){return new ea(v,l.entityText(f))}}Se.prototype.autoCommands={_maxLength:0},Ie.autoCommands=function(v){if(typeof v!="string"||!/^[a-z]+(?: [a-z]+)*$/i.test(v))throw'"'+v+'" not a space-delimited list of only letters';for(var f=v.split(" "),d={},g=0,y=0;y<f.length;y+=1){var G=f[y];if(G.length<2)throw'autocommand "'+G+'" not minimum length of 2';if(E[G]===ta)throw'"'+G+'" is a built-in operator name';d[G]=1,g=i(g,G.length)}return d._maxLength=g,d},Se.prototype.quietEmptyDelimiters={},Ie.quietEmptyDelimiters=function(v){v===void 0&&(v="");for(var f=v.split(" "),d={},g=0;g<f.length;g+=1){var y=f[g];d[y]=1}return d},Se.prototype.autoParenthesizedFunctions={_maxLength:0},Ie.autoParenthesizedFunctions=function(v){if(typeof v!="string"||!/^[a-z]+(?: [a-z]+)*$/i.test(v))throw'"'+v+'" not a space-delimited list of only letters';for(var f=v.split(" "),d={},g=0,y=0;y<f.length;y+=1){var G=f[y];if(G.length<2)throw'autocommand "'+G+'" not minimum length of 2';d[G]=1,g=i(g,G.length)}return d._maxLength=g,d};var Jo=function(v){ct(f,v);function f(d){var g=v.call(this,d)||this;return g.letter=d,g}return f.prototype.checkAutoCmds=function(d){if(!this.shouldIgnoreSubstitutionInSimpleSubscript(d.options)){var g=d.options.autoCommands,y=g._maxLength||0;if(y>0){for(var G="",F=this,q=0;F instanceof f&&F.ctrlSeq===F.letter&&q<y;)G=F.letter+G,F=F[r],q+=1;for(;G.length;){if(g.hasOwnProperty(G)){for(F=this,q=1;F&&q<G.length;q+=1,F=F[r]);new A(F,this).remove(),d[r]=F[r];var Y=E[G],se;return j(Y)?se=new Y(G):se=Y(G),se.createLeftOf(d)}G=G.slice(1)}}}},f.prototype.autoParenthesize=function(d){var g=d.parent.getEnd(e);if(!(g&&g instanceof sl&&g.ctrlSeq==="\\left(")&&!this.shouldIgnoreSubstitutionInSimpleSubscript(d.options)){for(var y="",G=this,F=0,q=d.options.autoParenthesizedFunctions,Y=q._maxLength||0,se=d.options.autoOperatorNames;G instanceof f&&F<Y;)y=G.letter+y,G=G[r],F+=1;for(;y.length;){if(q.hasOwnProperty(y)&&se.hasOwnProperty(y))return d.parent.write(d,"(");y=y.slice(1)}}},f.prototype.createLeftOf=function(d){v.prototype.createLeftOf.call(this,d),this.checkAutoCmds(d),this.autoParenthesize(d)},f.prototype.italicize=function(d){return this.isItalic=d,this.isPartOfOperator=!d,this.domFrag().toggleClass("dcg-mq-operator-name",!d),this},f.prototype.finalizeTree=function(d,g){this.sharedSiblingMethod(d,g)},f.prototype.siblingDeleted=function(d,g){this.sharedSiblingMethod(d,g)},f.prototype.siblingCreated=function(d,g){this.sharedSiblingMethod(d,g)},f.prototype.sharedSiblingMethod=function(d,g){g!==r&&this[e]instanceof f||this.autoUnItalicize(d)},f.prototype.autoUnItalicize=function(d){var g=d.autoOperatorNames;if(g._maxLength!==0&&!this.shouldIgnoreSubstitutionInSimpleSubscript(d)){for(var y=this.letter,G=this[r];G instanceof f;G=G[r])y=G.letter+y;for(var F=this[e];F instanceof f;F=F[e])y+=F.letter;var q=G&&G[e],Y=F&&F[r];new A(q||this.parent.getEnd(r),Y||this.parent.getEnd(e)).each(function(Ja){Ja instanceof f&&(Ja.italicize(!0).domFrag().removeClass("dcg-mq-first dcg-mq-last dcg-mq-followed-by-supsub"),Ja.ctrlSeq=Ja.letter)});var se=g._maxLength||0;e:for(var Oe=0,Te=G[e]||this.parent.getEnd(r);Te&&Oe<y.length;Oe+=1,Te=Te[e])for(var we=t(se,y.length-Oe);we>0;we-=1){var Ne=y.slice(Oe,Oe+we),Ue=void 0;if(g.hasOwnProperty(Ne)){for(var rt=0,lt=Te;rt<we;rt+=1,lt=lt[e])lt instanceof f&&(lt.italicize(!1),Ue=lt);var wt=Ya.hasOwnProperty(Ne);if(Te.ctrlSeq=(wt?"\\":"\\operatorname{")+Te.ctrlSeq,Ue.ctrlSeq+=wt?" ":"}",Gn.hasOwnProperty(Ne)){var Or=Ue[r],yo=Or&&Or[r],Br=yo&&yo[r];Br.domFrag().addClass("dcg-mq-last")}if(this.shouldOmitPadding(Te[r])||Te.domFrag().addClass("dcg-mq-first"),!this.shouldOmitPadding(Ue[e]))if(Ue[e]instanceof al){var Go=Ue[e],ms=Go.siblingCreated=Go.siblingDeleted=function(){Go.domFrag().toggleClass("dcg-mq-after-operator-name",!(Go[e]instanceof sl))};ms()}else Ue.domFrag().toggleClass("dcg-mq-last",!(Ue[e]instanceof sl));Oe+=we-1,Te=Ue;continue e}}}},f.prototype.shouldOmitPadding=function(d){return!d||d.ctrlSeq==="."||d instanceof _t||d instanceof Dc},f}(ea),Ya={};Se.prototype.autoOperatorNames=Cc();var Gn={limsup:1,liminf:1,projlim:1,injlim:1};function Cc(){for(var v={_maxLength:9},f="arg deg det dim exp gcd hom inf ker lg lim ln log max min sup limsup liminf injlim projlim Pr".split(" "),d=0;d<f.length;d+=1)Ya[f[d]]=v[f[d]]=1;for(var g="sin cos tan arcsin arccos arctan sinh cosh tanh sec csc cot coth".split(" "),d=0;d<g.length;d+=1)Ya[g[d]]=1;for(var y="sin cos tan sec cosec csc cotan cot ctg".split(" "),d=0;d<y.length;d+=1)v[y[d]]=v["arc"+y[d]]=v[y[d]+"h"]=v["ar"+y[d]+"h"]=v["arc"+y[d]+"h"]=1;for(var G="gcf hcf lcm proj span".split(" "),d=0;d<G.length;d+=1)v[G[d]]=1;return v}Ie.autoOperatorNames=function(v){if(typeof v!="string")throw'"'+v+'" not a space-delimited list';if(!/^[a-z\|\-]+(?: [a-z\|\-]+)*$/i.test(v))throw'"'+v+'" not a space-delimited list of letters or "|"';for(var f=v.split(" "),d={},g=0,y=0;y<f.length;y+=1){var G=f[y];if(G.length<2)throw'"'+G+'" not minimum length of 2';if(G.indexOf("|")<0)d[G]=G,g=i(g,G.length);else{var F=G.split("|");if(F.length>2)throw'"'+G+'" has more than 1 mathspeak delimiter';if(F[0].length<2)throw'"'+G[0]+'" not minimum length of 2';d[F[0]]=F[1].replace(/-/g," "),g=i(g,F[0].length)}}return d._maxLength=g,d};var ta=function(v){ct(f,v);function f(d){return v.call(this,d||"")||this}return f.prototype.createLeftOf=function(d){for(var g=this.ctrlSeq,y=0;y<g.length;y+=1)new Jo(g.charAt(y)).createLeftOf(d)},f.prototype.parser=function(){for(var d=this.ctrlSeq,g=new io,y=0;y<d.length;y+=1)new Jo(d.charAt(y)).adopt(g,g.getEnd(e),0);return fe.succeed(g.children())},f}(Rn);for(var Fl in Se.prototype.autoOperatorNames)Se.prototype.autoOperatorNames.hasOwnProperty(Fl)&&(E[Fl]=ta);E.operatorname=function(v){ct(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.createLeftOf=function(){},f.prototype.numBlocks=function(){return 1},f.prototype.parser=function(){return Ce.block.map(function(d){var g=!0,y="",G=d.children();return G.each(function(F){F instanceof Jo?y+=F.letter:g=!1}),g&&y==="ans"?JC():G})},f}(ro),E.f=function(v){ct(f,v);function f(){var d=this,g="f";return d=v.call(this,g)||this,d.letter=g,d.domView=new $i(0,function(){return l("var",{class:"dcg-mq-f"},[l.text("f")])}),d}return f.prototype.italicize=function(d){return this.domFrag().eachElement(function(g){return g.textContent="f"}),this.domFrag().toggleClass("dcg-mq-f",d),v.prototype.italicize.call(this,d)},f}(Jo),E[" "]=E.space=function(){return new bu("\\ ",l("span",{},[l.text(p)])," ")},E["."]=function(){return new bu(".",l("span",{class:"dcg-mq-digit"},[l.text(".")]),".")},E["'"]=E.prime=_a("'","&prime;","prime"),E["\u2033"]=E.dprime=_a("\u2033","&Prime;","double prime"),E.backslash=_a("\\backslash ","\\","backslash"),J["\\"]||(J["\\"]=E.backslash),E.$=_a("\\$","$","dollar"),E.square=_a("\\square ","\u25A1","square"),E.mid=_a("\\mid ","\u2223","mid");var Rl=function(v){ct(f,v);function f(d,g,y){return v.call(this,d,l("span",{class:"dcg-mq-nonSymbola"},[g||l.text(d)]))||this}return f}(Rn);E["@"]=function(){return new Rl("@")},E["&"]=function(){return new Rl("\\&",l.entityText("&amp;"),"and")},E["%"]=function(v){ct(f,v);function f(){return v.call(this,"\\%",l.text("%"),"percent")||this}return f.prototype.parser=function(){var d=fe.optWhitespace,g=fe.string;return d.then(g("\\operatorname{of}").map(function(){return XC()})).or(v.prototype.parser.call(this))},f}(Rl),E["\u2225"]=E.parallel=_a("\\parallel ","&#x2225;","parallel"),E["\u2226"]=E.nparallel=_a("\\nparallel ","&#x2226;","not parallel"),E["\u27C2"]=E.perp=_a("\\perp ","&#x27C2;","perpendicular"),E.alpha=E.beta=E.gamma=E.delta=E.zeta=E.eta=E.theta=E.iota=E.kappa=E.mu=E.nu=E.xi=E.rho=E.sigma=E.tau=E.chi=E.psi=E.omega=function(v){return new ea("\\"+v+" ",l.entityText("&"+v+";"))},E.phi=Nr("\\phi ","&#981;","phi"),E.phiv=E.varphi=Nr("\\varphi ","&phi;","phi"),E.epsilon=Nr("\\epsilon ","&#1013;","epsilon"),E.epsiv=E.varepsilon=Nr("\\varepsilon ","&epsilon;","epsilon"),E.piv=E.varpi=Nr("\\varpi ","&piv;","piv"),E.sigmaf=E.sigmav=E.varsigma=Nr("\\varsigma ","&sigmaf;","sigma"),E.thetav=E.vartheta=E.thetasym=Nr("\\vartheta ","&thetasym;","theta"),E.upsilon=E.upsi=Nr("\\upsilon ","&upsilon;","upsilon"),E.gammad=E.Gammad=E.digamma=Nr("\\digamma ","&#989;","gamma"),E.kappav=E.varkappa=Nr("\\varkappa ","&#1008;","kappa"),E.rhov=E.varrho=Nr("\\varrho ","&#1009;","rho"),E.pi=E.\u03C0=function(){return new Rl("\\pi ",l.entityText("&pi;"),"pi")},E.lambda=function(){return new Rl("\\lambda ",l.entityText("&lambda;"),"lambda")},E.Upsilon=E.Upsi=E.upsih=E.Upsih=function(){return new Rn("\\Upsilon ",l("var",{style:"font-family: serif"},[l.entityText("&upsih;")]),"capital upsilon")},E.Gamma=E.Delta=E.Theta=E.Lambda=E.Xi=E.Pi=E.Sigma=E.Phi=E.Psi=E.Omega=E.forall=function(v){return new wc("\\"+v+" ",l.entityText("&"+v+";"))};var bo=function(v){ct(f,v);function f(d){var g=v.call(this)||this;return g.latexStr=d,g}return f.prototype.createLeftOf=function(d){var g=Ce.parse(this.latexStr);g.children().adopt(d.parent,d[r],d[e]),d[r]=g.getEnd(e),L(g.html()).insertBefore(d.domFrag()),g.finalizeInsert(d.options,d);var y=g.getEnd(e),G=y&&y[e];G&&G.siblingCreated(d.options,r);var F=g.getEnd(r),q=F&&F[r];q&&q.siblingCreated(d.options,e),d.parent.bubble(function(Y){Y.reflow()})},f.prototype.mathspeak=function(){return Ce.parse(this.latexStr).mathspeak()},f.prototype.parser=function(){var d=Ce.parse(this.latexStr).children();return fe.succeed(d)},f}(ro);E["\u2070"]=function(){return new bo("^0")},E["\xB9"]=function(){return new bo("^1")},E["\xB2"]=function(){return new bo("^2")},E["\xB3"]=function(){return new bo("^3")},E["\u2074"]=function(){return new bo("^4")},E["\u2075"]=function(){return new bo("^5")},E["\u2076"]=function(){return new bo("^6")},E["\u2077"]=function(){return new bo("^7")},E["\u2078"]=function(){return new bo("^8")},E["\u2079"]=function(){return new bo("^9")},E["\xBC"]=function(){return new bo("\\frac14")},E["\xBD"]=function(){return new bo("\\frac12")},E["\xBE"]=function(){return new bo("\\frac34")},E["\u221A"]=function(){return new bo("\\sqrt{}")};function pp(v){if(!v)return!1;var f=v[r];if(f){if(f instanceof _t||/^(\\ )|[,;:\(\[]$/.test(f.ctrlSeq))return!1}else return v.parent&&v.parent.parent&&v.parent.parent.isStyleBlock()?pp(v.parent.parent):!1;return!0}var Nl=function(v){ct(f,v);function f(d,g,y){return v.call(this,d,g,void 0,y,!0)||this}return f.prototype.contactWeld=function(d,g){this.sharedSiblingMethod(d.options,g)},f.prototype.siblingCreated=function(d,g){this.sharedSiblingMethod(d,g)},f.prototype.siblingDeleted=function(d,g){this.sharedSiblingMethod(d,g)},f.prototype.sharedSiblingMethod=function(d,g){if(g!==e)return this.domFrag().oneElement().className=pp(this)?"dcg-mq-binary-operator":"",this},f}(_t);E["+"]=function(v){ct(f,v);function f(){return v.call(this,"+",l.text("+"))||this}return f.prototype.mathspeak=function(){return pp(this)?"plus":"positive"},f}(Nl);var yu=function(v){ct(f,v);function f(){return v.call(this,"-",l.entityText("&minus;"))||this}return f.prototype.mathspeak=function(){return pp(this)?"minus":"negative"},f}(Nl);E["\u2212"]=E["\u2014"]=E["\u2013"]=E["-"]=yu,E["\xB1"]=E.pm=E.plusmn=E.plusminus=function(){return new Nl("\\pm ",l.entityText("&plusmn;"),"plus-or-minus")},E.mp=E.mnplus=E.minusplus=function(){return new Nl("\\mp ",l.entityText("&#8723;"),"minus-or-plus")},J["*"]=E.sdot=E.cdot=va("\\cdot ","&middot;","*","times");var gs=function(v){ct(f,v);function f(){return v.call(this,"\\to ",l.entityText("&rarr;"),"to")||this}return f.prototype.deleteTowards=function(d,g){if(d===r){var y=g[r];new A(y,this).remove(),g[r]=y[r],new yu().createLeftOf(g),g[r].bubble(function(G){G.reflow()});return}v.prototype.deleteTowards.call(this,d,g)},f}(_t);E["\u2192"]=E.to=gs;var Bl=function(v){ct(f,v);function f(d,g){var y=this,G=g?"Strict":"";return y=v.call(this,d["ctrlSeq".concat(G)],l.entityText(d["htmlEntity".concat(G)]),d["text".concat(G)],d["mathspeak".concat(G)])||this,y.data=d,y.strict=g,y}return f.prototype.swap=function(d){this.strict=d;var g=d?"Strict":"";this.ctrlSeq=this.data["ctrlSeq".concat(g)],this.domFrag().children().replaceWith(L(l.entityText(this.data["htmlEntity".concat(g)]))),this.textTemplate=[this.data["text".concat(g)]],this.mathspeakName=this.data["mathspeak".concat(g)]},f.prototype.deleteTowards=function(d,g){if(d===r&&!this.strict){this.swap(!0),this.bubble(function(y){y.reflow()});return}v.prototype.deleteTowards.call(this,d,g)},f}(_t),ky={ctrlSeq:"\\le ",htmlEntity:"&le;",text:"\u2264",mathspeak:"less than or equal to",ctrlSeqStrict:"<",htmlEntityStrict:"&lt;",textStrict:"<",mathspeakStrict:"less than"},WC={ctrlSeq:"\\ge ",htmlEntity:"&ge;",text:"\u2265",mathspeak:"greater than or equal to",ctrlSeqStrict:">",htmlEntityStrict:"&gt;",textStrict:">",mathspeakStrict:"greater than"},Ey=function(v){ct(f,v);function f(){return v.call(this,WC,!0)||this}return f.prototype.createLeftOf=function(d){var g=d[r];if(g instanceof _t&&g.ctrlSeq==="-"){var y=g;d[r]=y[r],y.remove(),new gs().createLeftOf(d),d[r].bubble(function(G){G.reflow()});return}v.prototype.createLeftOf.call(this,d)},f}(Bl);E["<"]=E.lt=function(){return new Bl(ky,!0)},E[">"]=E.gt=Ey,E["\u2264"]=E.le=E.leq=function(){return new Bl(ky,!1)},E["\u2265"]=E.ge=E.geq=function(){return new Bl(WC,!1)},E.infty=E.infin=E.infinity=_a("\\infty ","&infin;","infinity"),E["\u2260"]=E.ne=E.neq=va("\\ne ","&ne;","not equal");var $C=function(v){ct(f,v);function f(){return v.call(this,"=",l.text("="),"=","equals")||this}return f.prototype.createLeftOf=function(d){var g=d[r];if(g instanceof Bl&&g.strict){g.swap(!1),g.bubble(function(y){y.reflow()});return}v.prototype.createLeftOf.call(this,d)},f}(_t);E["="]=$C,E["\xD7"]=E.times=E.cross=va("\\times ","&times;","[x]","times"),E["\xF7"]=E.div=E.divide=E.divides=va("\\div ","&divide;","[/]","over");var Gy=function(v){ct(f,v);function f(){return v.call(this,"\\sim ",l.text("~"),"~","tilde")||this}return f.prototype.createLeftOf=function(d){if(d[r]instanceof f){var g=d[r];d[r]=g[r],g.remove(),new jC().createLeftOf(d),d[r].bubble(function(y){y.reflow()});return}v.prototype.createLeftOf.call(this,d)},f}(_t),jC=function(v){ct(f,v);function f(){return v.call(this,"\\approx ",l.entityText("&approx;"),"\u2248","approximately equal")||this}return f.prototype.deleteTowards=function(d,g){if(d===r){var y=g[r];new A(y,this).remove(),g[r]=y[r],new Gy().createLeftOf(g),g[r].bubble(function(G){G.reflow()});return}v.prototype.deleteTowards.call(this,d,g)},f}(_t);E.tildeNbsp=_a("~",p," "),E.sim=Gy,E["\u2248"]=E.approx=jC,J["~"]=E.sim,E["~"]=E.tildeNbsp,Ie.interpretTildeAsSim=function(v){var f=!!v;return f?E["~"]=E.sim:E["~"]=E.tildeNbsp,f};var xu={sqrt:{width:"",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"0 0 32 54"},[l("path",{d:"M0 33 L7 27 L12.5 47 L13 47 L30 0 L32 0 L13 54 L11 54 L4.5 31 L0 33"})])}},"|":{width:".4em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[l("path",{d:"M4.4 0 L4.4 54 L5.6 54 L5.6 0"})])}},"[":{width:".55em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"0 0 11 24"},[l("path",{d:"M8 0 L3 0 L3 24 L8 24 L8 23 L4 23 L4 1 L8 1"})])}},"]":{width:".55em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"0 0 11 24"},[l("path",{d:"M3 0 L8 0 L8 24 L3 24 L3 23 L7 23 L7 1 L3 1"})])}},"(":{width:".55em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"3 0 106 186"},[l("path",{d:"M85 0 A61 101 0 0 0 85 186 L75 186 A75 101 0 0 1 75 0"})])}},")":{width:".55em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"3 0 106 186"},[l("path",{d:"M24 0 A61 101 0 0 1 24 186 L34 186 A75 101 0 0 0 34 0"})])}},"{":{width:".7em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"10 0 210 350"},[l("path",{d:"M170 0 L170 6 A47 52 0 0 0 123 60 L123 127 A35 48 0 0 1 88 175 A35 48 0 0 1 123 223 L123 290 A47 52 0 0 0 170 344 L170 350 L160 350 A58 49 0 0 1 102 301 L103 220 A45 40 0 0 0 58 180 L58 170 A45 40 0 0 0 103 130 L103 49 A58 49 0 0 1 161 0"})])}},"}":{width:".7em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"10 0 210 350"},[l("path",{d:"M60 0 L60 6 A47 52 0 0 1 107 60 L107 127 A35 48 0 0 0 142 175 A35 48 0 0 0 107 223 L107 290 A47 52 0 0 1 60 344 L60 350 L70 350 A58 49 0 0 0 128 301 L127 220 A45 40 0 0 1 172 180 L172 170 A45 40 0 0 1 127 130 L127 49 A58 49 0 0 0 70 0"})])}},"&#8741;":{width:".7em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[l("path",{d:"M3.2 0 L3.2 54 L4 54 L4 0 M6.8 0 L6.8 54 L6 54 L6 0"})])}},"&lang;":{width:".55em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[l("path",{d:"M6.8 0 L3.2 27 L6.8 54 L7.8 54 L4.2 27 L7.8 0"})])}},"&rang;":{width:".55em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[l("path",{d:"M3.2 0 L6.8 27 L3.2 54 L2.2 54 L5.8 27 L2.2 0"})])}}},nl=function(v){ct(f,v);function f(d,g,y,G,F){var q=v.call(this,d,new $i(1,function(Y){return l.block(g,y,Y[0])}))||this;return q.ariaLabel=G||d.replace(/^\\/,""),q.mathspeakTemplate=["Start"+q.ariaLabel+",","End"+q.ariaLabel],q.shouldNotSpeakDelimiters=F&&F.shouldNotSpeakDelimiters,q}return f.prototype.mathspeak=function(d){return!this.shouldNotSpeakDelimiters||d&&d.ignoreShorthand?v.prototype.mathspeak.call(this):this.foldChildren("",function(g,y){return g+" "+y.mathspeak(d)}).trim()},f}(ro);E.mathrm=function(v){ct(f,v);function f(){return v.call(this,"\\mathrm","span",{class:"dcg-mq-roman dcg-mq-font"},"Roman Font",{shouldNotSpeakDelimiters:!0})||this}return f.prototype.isTextBlock=function(){return!0},f}(nl),E.mathit=function(){return new nl("\\mathit","i",{class:"dcg-mq-font"},"Italic Font")},E.mathbf=function(){return new nl("\\mathbf","b",{class:"dcg-mq-font"},"Bold Font")},E.mathsf=function(){return new nl("\\mathsf","span",{class:"dcg-mq-sans-serif dcg-mq-font"},"Serif Font")},E.mathtt=function(){return new nl("\\mathtt","span",{class:"dcg-mq-monospace dcg-mq-font"},"Math Text")},E.underline=function(){return new nl("\\underline","span",{class:"dcg-mq-non-leaf dcg-mq-underline"},"Underline")},E.overline=E.bar=function(){return new nl("\\overline","span",{class:"dcg-mq-non-leaf dcg-mq-overline"},"Overline")},E.overrightarrow=function(){return new nl("\\overrightarrow","span",{class:"dcg-mq-non-leaf dcg-mq-overarrow dcg-mq-arrow-right"},"Over Right Arrow")},E.overleftarrow=function(){return new nl("\\overleftarrow","span",{class:"dcg-mq-non-leaf dcg-mq-overarrow dcg-mq-arrow-left"},"Over Left Arrow")},E.overleftrightarrow=function(){return new nl("\\overleftrightarrow ","span",{class:"dcg-mq-non-leaf dcg-mq-overarrow dcg-mq-arrow-leftright"},"Over Left and Right Arrow")},E.overarc=function(){return new nl("\\overarc","span",{class:"dcg-mq-non-leaf dcg-mq-overarc"},"Over Arc")},E.dot=function(){return new ro("\\dot",new $i(1,function(v){return l("span",{class:"dcg-mq-non-leaf"},[l("span",{class:"dcg-mq-dot-recurring-inner"},[l("span",{class:"dcg-mq-dot-recurring"},[l.text(m)]),l.block("span",{class:"dcg-mq-empty-box"},v[0])])])}))},E.textcolor=function(v){ct(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.setColor=function(d){this.color=d,this.domView=new $i(1,function(g){return l.block("span",{class:"dcg-mq-textcolor",style:"color:"+d},g[0])}),this.ariaLabel=d.replace(/^\\/,""),this.mathspeakTemplate=["Start "+this.ariaLabel+",","End "+this.ariaLabel]},f.prototype.latexRecursive=function(d){this.checkCursorContextOpen(d);var g=this.blocks[0];d.latex+="\\textcolor{"+this.color+"}{",g.latexRecursive(d),d.latex+="}",this.checkCursorContextClose(d)},f.prototype.parser=function(){var d=this,g=fe.optWhitespace,y=fe.string,G=fe.regex;return g.then(y("{")).then(G(/^[#\w\s.,()%-]*/)).skip(y("}")).then(function(F){return d.setColor(F),v.prototype.parser.call(d)})},f.prototype.isStyleBlock=function(){return!0},f}(ro);var YO=E.class=function(v){ct(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.parser=function(){var d=this,g=fe.string,y=fe.regex;return fe.optWhitespace.then(g("{")).then(y(/^[-\w\s\\\xA0-\xFF]*/)).skip(g("}")).then(function(G){return d.cls=G||"",d.domView=new $i(1,function(F){return l.block("span",{class:"dcg-mq-class ".concat(G)},F[0])}),d.ariaLabel=G+" class",d.mathspeakTemplate=["Start "+d.ariaLabel+",","End "+d.ariaLabel],v.prototype.parser.call(d)})},f.prototype.latexRecursive=function(d){this.checkCursorContextOpen(d);var g=this.blocks[0];d.latex+="\\class{"+this.cls+"}{",g.latexRecursive(d),d.latex+="}",this.checkCursorContextClose(d)},f.prototype.isStyleBlock=function(){return!0},f}(ro),up=/^[\+\-]?[\d]+$/;function Ty(v){if(!v)return"";var f="";return v.eachChild(function(d){d.ctrlSeq!==void 0&&(f+=d.ctrlSeq)}),f}Se.prototype.charsThatBreakOutOfSupSub="";var al=function(v){ct(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.ctrlSeq="_{...}^{...}",d}return f.prototype.setEnds=function(d){n("SupSub ends must be MathBlocks",d[r]instanceof io&&d[e]instanceof io),this.ends=d},f.prototype.getEnd=function(d){return this.ends[d]},f.prototype.createLeftOf=function(d){if(!(!this.replacedFragment&&!d[r]&&d.options.supSubsRequireOperand))return v.prototype.createLeftOf.call(this,d)},f.prototype.contactWeld=function(d){for(var g=r;g;g=g===r?e:!1){var y=this[g],G=void 0;if(y instanceof f){for(var F="sub";F;F=F==="sub"?"sup":!1){var q=this[F],Y=y[F];if(q){if(!Y)y.addBlock(q.disown());else if(q.isEmpty())G=new W(Y,0,Y.getEnd(r));else{q.domFrag().children().insAtDirEnd(-g,Y.domFrag().oneElement());var se=q.children().disown();G=new W(Y,se.getEnd(e),Y.getEnd(r)),g===r?se.adopt(Y,Y.getEnd(e),0):se.adopt(Y,0,Y.getEnd(r))}this.placeCursor=function(Oe,Te){return function(we){we.insAtDirEnd(-g,Oe||Te)}}(Y,q)}}this.remove(),d&&d[r]===this&&(g===e&&G?G[r]?d.insRightOf(G[r]):d.insAtLeftEnd(G.parent):d.insRightOf(y));break}}},f.prototype.finalizeTree=function(){var d=this.getEnd(r);d.write=function(g,y){if(g.options.autoSubscriptNumerals&&this===this.parent.sub&&"0123456789".indexOf(y)>=0){var G=this.chToCmd(y,g.options);G instanceof Rn?g.deleteSelection():g.clearSelection().insRightOf(this.parent),G.createLeftOf(g.show()),g.controller.aria.queue("Baseline").alert(G.mathspeak({createdLeftOf:g}));return}g[r]&&!g[e]&&!g.selection&&g.options.charsThatBreakOutOfSupSub.indexOf(y)>-1&&(g.insRightOf(this.parent),g.controller.aria.queue("Baseline")),io.prototype.write.call(this,g,y)}},f.prototype.moveTowards=function(d,g,y){g.options.autoSubscriptNumerals&&!this.sup?g.insDirOf(d,this):v.prototype.moveTowards.call(this,d,g,y)},f.prototype.deleteTowards=function(d,g){if(g.options.autoSubscriptNumerals&&this.sub){var y=this.sub.getEnd(-d);y instanceof Rn?y.remove():y&&y.deleteTowards(d,g.insAtDirEnd(-d,this.sub)),this.sub.isEmpty()&&(this.sub.deleteOutOf(r,g.insAtLeftEnd(this.sub)),this.sup&&g.insDirOf(-d,this))}else v.prototype.deleteTowards.call(this,d,g)},f.prototype.latexRecursive=function(d){if(this.checkCursorContextOpen(d),this.sub){d.latex+="_{";var g=d.latex.length;this.sub.latexRecursive(d);var y=d.latex.length;g===y&&(d.latex+=" "),d.latex+="}"}if(this.sup){d.latex+="^{";var g=d.latex.length;this.sup.latexRecursive(d);var y=d.latex.length;g===y&&(d.latex+=" "),d.latex+="}"}this.checkCursorContextClose(d)},f.prototype.text=function(){function d(g,y){var G=y&&y.text()||"";return y?g+(G.length===1?G:"("+(G||" ")+")"):""}return d("_",this.sub)+d("^",this.sup)},f.prototype.addBlock=function(d){this.supsub==="sub"?(this.sup=this.upInto=this.sub.upOutOf=d,d.adopt(this,this.sub,0).downOutOf=this.sub,d.setDOM(L(l("span",{class:"dcg-mq-sup"})).append(d.domFrag().children()).prependTo(this.domFrag().oneElement()).oneElement()),X.linkElementByBlockNode(d.domFrag().oneElement(),d)):(this.sub=this.downInto=this.sup.downOutOf=d,d.adopt(this,0,this.sup).upOutOf=this.sup,this.domFrag().removeClass("dcg-mq-sup-only"),d.setDOM(L(l("span",{class:"dcg-mq-sub"})).append(d.domFrag().children()).appendTo(this.domFrag().oneElement()).oneElement()),X.linkElementByBlockNode(d.domFrag().oneElement(),d),this.domFrag().append(L(l("span",{style:"display:inline-block;width:0"},[l.text(u)]))));for(var g=0;g<2;g+=1)(function(y,G,F,q){var Y=y[G];Y.deleteOutOf=function(se,Oe){if(Oe.insDirOf(this[se]?-se:se,this.parent),!this.isEmpty()){var Te=this.getEnd(se);this.children().disown().withDirAdopt(se,Oe.parent,Oe[se],Oe[-se]).domFrag().insDirOf(-se,Oe.domFrag()),Oe[-se]=Te}y.supsub=F,delete y[G],delete y["".concat(q,"Into")];var we=y[F];we["".concat(q,"OutOf")]=Fh,delete we.deleteOutOf,G==="sub"&&y.domFrag().addClass("dcg-mq-sup-only").children().last().remove(),this.remove()}})(this,"sub sup".split(" ")[g],"sup sub".split(" ")[g],"down up".split(" ")[g])},f}(ro);function Fh(v){var f=this.parent,d=v;do{if(d[e])return v.insLeftOf(f);d=d.parent.parent}while(d!==f);v.insRightOf(f)}var YC=function(v){ct(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.supsub="sub",d.domView=new $i(1,function(g){return l("span",{class:"dcg-mq-supsub dcg-mq-non-leaf"},[l.block("span",{class:"dcg-mq-sub"},g[0]),l("span",{style:"display:inline-block;width:0"},[l.text(u)])])}),d.textTemplate=["_"],d.mathspeakTemplate=["Subscript,",", Baseline"],d.ariaLabel="subscript",d}return f.prototype.finalizeTree=function(){this.downInto=this.sub=this.getEnd(r),this.sub.upOutOf=Fh,v.prototype.finalizeTree.call(this)},f}(al);E.subscript=E._=YC,E.superscript=E.supscript=E["^"]=function(v){ct(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.supsub="sup",d.domView=new $i(1,function(g){return l("span",{class:"dcg-mq-supsub dcg-mq-non-leaf dcg-mq-sup-only"},[l.block("span",{class:"dcg-mq-sup"},g[0])])}),d.textTemplate=["^(",")"],d.ariaLabel="superscript",d.mathspeakTemplate=["Superscript,",", Baseline"],d}return f.prototype.mathspeak=function(d){var g=this.upInto;if(g!==void 0){var y=Ty(g);if((!d||!d.ignoreShorthand)&&up.test(y)){if(y==="0")return"to the 0 power";if(y==="2")return"squared";if(y==="3")return"cubed";var G="";/^[+-]?\d{1,3}$/.test(y)&&(/(11|12|13|4|5|6|7|8|9|0)$/.test(y)?G="th":/1$/.test(y)?G="st":/2$/.test(y)?G="nd":/3$/.test(y)&&(G="rd"));var F=typeof g=="object"?g.mathspeak():y;return"to the "+F+G+" power"}}return v.prototype.mathspeak.call(this)},f.prototype.finalizeTree=function(){this.upInto=this.sup=this.getEnd(e),this.sup.downOutOf=Fh,v.prototype.finalizeTree.call(this)},f}(al);var Dc=function(v){ct(f,v);function f(d,g,y){var G=v.call(this)||this;G.ariaLabel=y||d.replace(/^\\/,"");var F=new $i(2,function(q){return l("span",{class:"dcg-mq-large-operator dcg-mq-non-leaf"},[l("span",{class:"dcg-mq-to"},[l.block("span",{},q[1])]),l("big",{},[l.text(g)]),l("span",{class:"dcg-mq-from"},[l.block("span",{},q[0])])])});return Rn.prototype.setCtrlSeqHtmlTextAndMathspeak.call(G,d,F),G}return f.prototype.createLeftOf=function(d){v.prototype.createLeftOf.call(this,d),d.options.sumStartsWithNEquals&&(new Jo("n").createLeftOf(d),new $C().createLeftOf(d))},f.prototype.latexRecursive=function(d){this.checkCursorContextOpen(d),d.latex+=this.ctrlSeq+"_{";var g=d.latex.length;this.getEnd(r).latexRecursive(d);var y=d.latex.length;y===g&&(d.latex+=" "),d.latex+="}^{",g=d.latex.length,this.getEnd(e).latexRecursive(d),y=d.latex.length,g===y&&(d.latex+=" "),d.latex+="}",this.checkCursorContextClose(d)},f.prototype.mathspeak=function(){return"Start "+this.ariaLabel+" from "+this.getEnd(r).mathspeak()+" to "+this.getEnd(e).mathspeak()+", end "+this.ariaLabel+", "},f.prototype.parser=function(){for(var d=fe.string,g=fe.optWhitespace,y=fe.succeed,G=Ce.block,F=this,q=F.blocks=[new io,new io],Y=0;Y<q.length;Y+=1)q[Y].adopt(F,F.getEnd(e),0);return g.then(d("_").or(d("^"))).then(function(se){var Oe=q[se==="_"?0:1];return G.then(function(Te){return Te.children().adopt(Oe,Oe.getEnd(e),0),y(F)})}).many().result(F)},f.prototype.finalizeTree=function(){var d=this.getEnd(r),g=this.getEnd(e);d.ariaLabel="lower bound",g.ariaLabel="upper bound",this.downInto=d,this.upInto=g,d.upOutOf=g,g.downOutOf=d},f}(ro);E["\u2211"]=E.sum=E.summation=function(){return new Dc("\\sum ",h,"sum")},E["\u220F"]=E.prod=E.product=function(){return new Dc("\\prod ",x,"product")},E.coprod=E.coproduct=function(){return new Dc("\\coprod ",C,"co product")},E["\u222B"]=E.int=E.integral=function(v){ct(f,v);function f(){var d=v.call(this,"\\int ","","integral")||this;return d.ariaLabel="integral",d.domView=new $i(2,function(g){return l("span",{class:"dcg-mq-int dcg-mq-non-leaf"},[l("big",{},[l.text(D)]),l("span",{class:"dcg-mq-supsub dcg-mq-non-leaf"},[l("span",{class:"dcg-mq-sup"},[l.block("span",{class:"dcg-mq-sup-inner"},g[1])]),l.block("span",{class:"dcg-mq-sub"},g[0]),l("span",{style:"display:inline-block;width:0"},[l.text(u)])])])}),d}return f.prototype.createLeftOf=function(d){ro.prototype.createLeftOf.call(this,d)},f}(Dc);var WI=E.frac=E.dfrac=E.cfrac=E.fraction=function(v){ct(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.ctrlSeq="\\frac",d.domView=new $i(2,function(g){return l("span",{class:"dcg-mq-fraction dcg-mq-non-leaf"},[l.block("span",{class:"dcg-mq-numerator"},g[0]),l.block("span",{class:"dcg-mq-denominator"},g[1]),l("span",{style:"display:inline-block;width:0"},[l.text(u)])])}),d.textTemplate=["(",")/(",")"],d}return f.prototype.finalizeTree=function(){var d=this.getEnd(r),g=this.getEnd(e);this.upInto=g.upOutOf=d,this.downInto=d.downOutOf=g,d.ariaLabel="numerator",g.ariaLabel="denominator",this.getFracDepth()>1?this.mathspeakTemplate=["StartNestedFraction,","NestedOver",", EndNestedFraction"]:this.mathspeakTemplate=["StartFraction,","Over",", EndFraction"]},f.prototype.mathspeak=function(d){if(d&&d.createdLeftOf){var g=d.createdLeftOf;return g.parent.mathspeak()}var y=Ty(this.getEnd(r)),G=Ty(this.getEnd(e));if((!d||!d.ignoreShorthand)&&up.test(y)&&up.test(G)){var F=y==="1"||y==="-1",q="";if(G==="2"?q=F?"half":"halves":G==="3"?q=F?"third":"thirds":G==="4"?q=F?"quarter":"quarters":G==="5"?q=F?"fifth":"fifths":G==="6"?q=F?"sixth":"sixths":G==="7"?q=F?"seventh":"sevenths":G==="8"?q=F?"eighth":"eighths":G==="9"&&(q=F?"ninth":"ninths"),q!==""){for(var Y="",se=!1,Oe=this[r];Oe&&Oe[r]!==void 0;Oe=Oe[r])if(Oe.ctrlSeq!=="\\ ")if(up.test(Oe.ctrlSeq||""))se=!0;else{se=!1;break}return se&&(Y+="and "),Y+=this.getEnd(r).mathspeak()+" "+q,Y}}return v.prototype.mathspeak.call(this)},f.prototype.getFracDepth=function(){var d=0,g=function(y,G){return y instanceof Pt&&y.ctrlSeq&&y.ctrlSeq.toLowerCase().search("frac")>=0&&(G+=1),y&&y.parent?g(y.parent,G):G};return g(this,d)},f}(ro),$I=E.over=J["/"]=function(v){ct(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.createLeftOf=function(d){if(!this.replacedFragment){var g=d[r];if(!d.options.typingSlashCreatesNewFraction)for(;g&&!(g instanceof _t||g instanceof(E.text||o)||g instanceof Dc||g.ctrlSeq==="\\ "||/^[,;:]$/.test(g.ctrlSeq));)g=g[r];if(g instanceof Dc&&g[e]instanceof al){g=g[e];var y=g[e];y instanceof al&&y.ctrlSeq!=g.ctrlSeq&&(g=g[e])}if(g!==d[r]&&!d.isTooDeep(1)){var y=g[e],G=d[r];this.replaces(new A(y||d.parent.getEnd(r),G)),d[r]=g}}v.prototype.createLeftOf.call(this,d)},f}(WI),JC=function(){return new Rn("\\operatorname{ans}",l("span",{class:"dcg-mq-ans"},[l.text("ans")]),"ans")};E.ans=JC;var XC=function(){return new Rn("\\%\\operatorname{of}",l("span",{class:"dcg-mq-nonSymbola dcg-mq-operator-name"},[l.text("% of ")]),"percent of")};E.percent=E.percentof=XC;var hm=function(v){ct(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.tokenId="",d.ctrlSeq="\\token",d.textTemplate=["token(",")"],d.mathspeakTemplate=["StartToken,",", EndToken"],d.ariaLabel="token",d}return f.prototype.html=function(){var d=l("span",{class:"dcg-mq-token dcg-mq-ignore-mousedown","data-dcg-mq-token":this.tokenId});return this.setDOM(d),X.linkElementByCmdNode(d,this),d},f.prototype.latexRecursive=function(d){this.checkCursorContextOpen(d),d.latex+="\\token{"+this.tokenId+"}",this.checkCursorContextClose(d)},f.prototype.mathspeak=function(){var d=[];return this.domFrag().children().eachElement(function(g){var y=g.getAttribute("aria-label");typeof y=="string"&&y!==""&&d.push(y)}),d.length>0?d.join(" ").trim():"token "+this.tokenId},f.prototype.parser=function(){var d=this;return Ce.block.map(function(g){var y=g.getEnd(r);if(y)for(d.tokenId+=y.ctrlSeq;y=y[e];)d.tokenId+=y.ctrlSeq;return d})},f}(Rn);E.token=hm;var QC=function(v){ct(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.ctrlSeq="\\sqrt",d.domView=new $i(1,function(g){return l("span",{class:"dcg-mq-non-leaf dcg-mq-sqrt-container"},[l("span",{class:"dcg-mq-scaled dcg-mq-sqrt-prefix"},[xu.sqrt.html()]),l.block("span",{class:"dcg-mq-non-leaf dcg-mq-sqrt-stem"},g[0])])}),d.textTemplate=["sqrt(",")"],d.mathspeakTemplate=["StartRoot,",", EndRoot"],d.ariaLabel="root",d}return f.prototype.parser=function(){return Ce.optBlock.then(function(d){return Ce.block.map(function(g){var y=new Rh;return y.blocks=[d,g],d.adopt(y,0,0),g.adopt(y,d,0),y})}).or(v.prototype.parser.call(this))},f}(ro);E.sqrt=QC,E.hat=function(v){ct(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.ctrlSeq="\\hat",d.domView=new $i(1,function(g){return l("span",{class:"dcg-mq-non-leaf"},[l("span",{class:"dcg-mq-hat-prefix"},[l.text("^")]),l.block("span",{class:"dcg-mq-hat-stem"},g[0])])}),d.textTemplate=["hat(",")"],d}return f}(ro);var Rh=function(v){ct(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.domView=new $i(2,function(g){return l("span",{class:"dcg-mq-nthroot-container dcg-mq-non-leaf"},[l.block("sup",{class:"dcg-mq-nthroot dcg-mq-non-leaf"},g[0]),l("span",{class:"dcg-mq-scaled dcg-mq-sqrt-container"},[l("span",{class:"dcg-mq-sqrt-prefix dcg-mq-scaled"},[xu.sqrt.html()]),l.block("span",{class:"dcg-mq-sqrt-stem dcg-mq-non-leaf"},g[1])])])}),d.textTemplate=["sqrt[","](",")"],d}return f.prototype.latexRecursive=function(d){this.checkCursorContextOpen(d),d.latex+="\\sqrt[",this.getEnd(r).latexRecursive(d),d.latex+="]{",this.getEnd(e).latexRecursive(d),d.latex+="}",this.checkCursorContextClose(d)},f.prototype.mathspeak=function(){var d=this.getEnd(r).mathspeak(),g=this.getEnd(e).mathspeak();return this.getEnd(r).ariaLabel="Index",this.getEnd(e).ariaLabel="Radicand",d==="3"?"Start Cube Root, "+g+", End Cube Root":"Root Index "+d+", Start Root, "+g+", End Root"},f}(QC);E.nthroot=Rh,E.cbrt=function(v){ct(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.createLeftOf=function(d){v.prototype.createLeftOf.call(this,d),new vc("3").createLeftOf(d),d.controller.moveRight()},f}(Rh);var ZC=function(v){ct(f,v);function f(d,g,y){var G=this,F=new $i(1,function(q){return l("span",{class:"dcg-mq-non-leaf"},[l("span",{class:"dcg-mq-diacritic-above"},[g]),l.block("span",{class:"dcg-mq-diacritic-stem"},q[0])])});return G=v.call(this,d,F,y)||this,G}return f}(ro);E.vec=function(){return new ZC("\\vec",l.entityText("&rarr;"),["vec(",")"])},E.tilde=function(){return new ZC("\\tilde",l.text("~"),["tilde(",")"])};var eD=function(v){ct(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.setDOM=function(d){var g;v.prototype.setDOM.call(this,d);var y=this.domFrag().children();return y.isEmpty()||(this.delimFrags=(g={},g[r]=y.first(),g[e]=y.last(),g)),this},f}(ro),sl=function(v){ct(f,v);function f(d,g,y,G,F){var q,Y=v.call(this,"\\left"+G,void 0,[g,y])||this;return Y.side=d,Y.sides=(q={},q[r]={ch:g,ctrlSeq:G},q[e]={ch:y,ctrlSeq:F},q),Y}return f.prototype.numBlocks=function(){return 1},f.prototype.html=function(){var d=this,g=this.getSymbol(r),y=this.getSymbol(e);return this.domView=new $i(1,function(G){return l("span",{class:"dcg-mq-non-leaf dcg-mq-bracket-container"},[l("span",{style:"width:"+g.width,class:"dcg-mq-scaled dcg-mq-bracket-l dcg-mq-paren"+(d.side===e?" dcg-mq-ghost":"")},[g.html()]),l.block("span",{style:"margin-left:"+g.width+";margin-right:"+y.width,class:"dcg-mq-bracket-middle dcg-mq-non-leaf"},G[0]),l("span",{style:"width:"+y.width,class:"dcg-mq-scaled dcg-mq-bracket-r dcg-mq-paren"+(d.side===r?" dcg-mq-ghost":"")},[y.html()])])}),v.prototype.html.call(this)},f.prototype.getSymbol=function(d){var g=this.sides[d||e].ch;return xu[g]||{width:"0",html:""}},f.prototype.latexRecursive=function(d){this.checkCursorContextOpen(d),d.latex+="\\left"+this.sides[r].ctrlSeq,this.getEnd(r).latexRecursive(d),d.latex+="\\right"+this.sides[e].ctrlSeq,this.checkCursorContextClose(d)},f.prototype.mathspeak=function(d){var g=this.sides[r].ch,y=this.sides[e].ch;if(g==="|"&&y==="|")this.mathspeakTemplate=["StartAbsoluteValue,",", EndAbsoluteValue"],this.ariaLabel="absolute value";else if(d&&d.createdLeftOf&&this.side){var G="";return this.side===r?G=this.textTemplate[0]:this.side===e&&(G=this.textTemplate[1]),(this.side===r?"left ":"right ")+wu[G]}else this.mathspeakTemplate=["left "+wu[g]+",",", right "+wu[y]],this.ariaLabel=wu[g]+" block";return v.prototype.mathspeak.call(this)},f.prototype.matchBrack=function(d,g,y){return y instanceof f&&y.side&&y.side!==-g&&(!d.restrictMismatchedBrackets||hp[this.sides[this.side].ch]===y.sides[y.side].ch||{"(":"]","[":")"}[this.sides[r].ch]===y.sides[e].ch)&&y},f.prototype.closeOpposing=function(d){d.side=0,d.sides[this.side]=this.sides[this.side];var g=d.delimFrags[this.side===r?r:e].removeClass("dcg-mq-ghost");this.replaceBracket(g,this.side)},f.prototype.createLeftOf=function(d){var g;if(!this.replacedFragment){var y=d.options;this.sides[r].ch==="|"?g=this.matchBrack(y,e,d[e])||this.matchBrack(y,r,d[r])||this.matchBrack(y,0,d.parent.parent):g=this.matchBrack(y,-this.side,d[-this.side])||this.matchBrack(y,-this.side,d.parent.parent)}if(g){var G=this.side=-g.side;this.closeOpposing(g),g===d.parent.parent&&d[G]&&new A(d[G],d.parent.getEnd(G),-G).disown().withDirAdopt(-G,g.parent,g,g[G]).domFrag().insDirOf(G,g.domFrag()),g.bubble(function(F){F.reflow()})}else g=this,G=g.side,g.replacedFragment?g.side=0:d[-G]&&(g.replaces(new A(d[-G],d.parent.getEnd(-G),G)),d[-G]=0),v.prototype.createLeftOf.call(this,d);G===r?d.insAtLeftEnd(g.getEnd(r)):d.insRightOf(g)},f.prototype.placeCursor=function(){},f.prototype.unwrap=function(){this.getEnd(r).children().disown().adopt(this.parent,this,this[e]).domFrag().insertAfter(this.domFrag()),this.remove()},f.prototype.deleteSide=function(d,g,y){var G=this.parent,F=this[d],q=G.getEnd(d);if(d===this.side){this.unwrap(),F?y.insDirOf(-d,F):y.insAtDirEnd(d,G);return}var Y=y.options,se=!this.side;if(this.side=-d,this.matchBrack(Y,d,this.getEnd(r).getEnd(this.side))){this.closeOpposing(this.getEnd(r).getEnd(this.side));var Oe=this.getEnd(r).getEnd(d);this.unwrap(),Oe&&Oe.siblingCreated(y.options,d),F?y.insDirOf(-d,F):y.insAtDirEnd(d,G)}else{if(this.matchBrack(Y,d,this.parent.parent))this.parent.parent.closeOpposing(this),this.parent.parent.unwrap();else if(g&&se){this.unwrap(),F?y.insDirOf(-d,F):y.insAtDirEnd(d,G);return}else{this.sides[d]=jI(this),this.delimFrags[r].removeClass("dcg-mq-ghost"),this.delimFrags[e].removeClass("dcg-mq-ghost");var Te=this.delimFrags[d].addClass("dcg-mq-ghost");this.replaceBracket(Te,d)}if(F){var we=this.getEnd(r),Oe=we.getEnd(d);we.domFrag().removeClass("dcg-mq-empty"),new A(F,q,-d).disown().withDirAdopt(-d,we,Oe,0).domFrag().insAtDirEnd(d,we.domFrag().oneElement()),Oe&&Oe.siblingCreated(y.options,d),y.insDirOf(-d,F)}else g?y.insDirOf(d,this):y.insAtDirEnd(d,this.getEnd(r))}},f.prototype.replaceBracket=function(d,g){var y=this.getSymbol(g);if(d.children().replaceWith(L(y.html())),d.oneElement().style.width=y.width,g===r){var G=d.next();G.isEmpty()||(G.oneElement().style.marginLeft=y.width)}else{var F=d.prev();F.isEmpty()||(F.oneElement().style.marginRight=y.width)}},f.prototype.deleteTowards=function(d,g){this.deleteSide(-d,!1,g)},f.prototype.finalizeTree=function(){this.getEnd(r).deleteOutOf=function(d,g){this.parent.deleteSide(d,!0,g)},this.finalizeTree=this.intentionalBlur=function(){this.delimFrags[this.side===r?e:r].removeClass("dcg-mq-ghost"),this.side=0}},f.prototype.siblingCreated=function(d,g){g===-this.side&&this.finalizeTree()},f}(eD);function jI(v){var f=v.side,d=v.sides[f];return{ch:hp[d.ch],ctrlSeq:hp[d.ctrlSeq]}}var hp={"(":")",")":"(","[":"]","]":"[","{":"}","}":"{","\\{":"\\}","\\}":"\\{","&lang;":"&rang;","&rang;":"&lang;","\\langle ":"\\rangle ","\\rangle ":"\\langle ","|":"|","\\lVert ":"\\rVert ","\\rVert ":"\\lVert "},wu={"&lang;":"angle-bracket","&rang;":"angle-bracket","|":"pipe"};function gm(v,g,d){var g=g||v,y=hp[v],G=hp[g];J[v]=function(){return new sl(r,v,y,g,G)},J[y]=function(){return new sl(e,v,y,g,G)},wu[v]=wu[y]=d}gm("(","","parenthesis"),gm("[","","bracket"),gm("{","\\{","brace"),E.langle=function(){return new sl(r,"&lang;","&rang;","\\langle ","\\rangle ")},E.rangle=function(){return new sl(e,"&lang;","&rang;","\\langle ","\\rangle ")},J["|"]=function(){return new sl(r,"|","|","|","|")},E.lVert=function(){return new sl(r,"&#8741;","&#8741;","\\lVert ","\\rVert ")},E.rVert=function(){return new sl(e,"&#8741;","&#8741;","\\lVert ","\\rVert ")},E.left=function(v){ct(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.parser=function(){var d=fe.regex,g=fe.string,y=fe.optWhitespace;return y.then(d(/^(?:[([|]|\\\{|\\langle(?![a-zA-Z])|\\lVert(?![a-zA-Z]))/)).then(function(G){var F=G.replace(/^\\/,"");return G=="\\langle"&&(F="&lang;",G=G+" "),G=="\\lVert"&&(F="&#8741;",G=G+" "),Ce.then(function(q){return g("\\right").skip(y).then(d(/^(?:[\])|]|\\\}|\\rangle(?![a-zA-Z])|\\rVert(?![a-zA-Z]))/)).map(function(Y){var se=Y.replace(/^\\/,"");Y=="\\rangle"&&(se="&rang;",Y=Y+" "),Y=="\\rVert"&&(se="&#8741;",Y=Y+" ");var Oe=new sl(0,F,se,G,Y);return Oe.blocks=[q],q.adopt(Oe,0,0),Oe})})})},f}(ro),E.right=function(v){ct(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.parser=function(){return fe.fail("unmatched \\right")},f}(ro);var mm=xu["("],Iy=xu[")"],tD=function(v){ct(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.ctrlSeq="\\binom",d.domView=new $i(2,function(g){return l("span",{class:"dcg-mq-non-leaf dcg-mq-bracket-container"},[l("span",{style:"width:"+mm.width,class:"dcg-mq-paren dcg-mq-bracket-l dcg-mq-scaled"},[mm.html()]),l("span",{style:"margin-left:"+mm.width+"; margin-right:"+Iy.width,class:"dcg-mq-non-leaf dcg-mq-bracket-middle"},[l("span",{class:"dcg-mq-array dcg-mq-non-leaf"},[l.block("span",{},g[0]),l.block("span",{},g[1])])]),l("span",{style:"width:"+Iy.width,class:"dcg-mq-paren dcg-mq-bracket-r dcg-mq-scaled"},[Iy.html()])])}),d.textTemplate=["choose(",",",")"],d.mathspeakTemplate=["StartBinomial,","Choose",", EndBinomial"],d.ariaLabel="binomial",d}return f}(eD);E.binom=E.binomial=tD,E.choose=function(v){ct(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.createLeftOf=function(d){$I.prototype.createLeftOf(d)},f}(tD);var YI=function(v){ct(f,v);function f(){var d=v!==null&&v.apply(this,arguments)||this;return d.ctrlSeq="\\MathQuillMathField",d.domView=new $i(1,function(g){return l("span",{class:"dcg-mq-editable-field"},[l.block("span",{class:"dcg-mq-root-block","aria-hidden":"true"},g[0])])}),d}return f.prototype.parser=function(){var d=this,g=fe.string,y=fe.regex,G=fe.succeed;return g("[").then(y(/^[a-z][a-z0-9]*/i)).skip(g("]")).map(function(F){d.name=F}).or(G(void 0)).then(v.prototype.parser.call(this))},f.prototype.finalizeTree=function(d){var g=new Gt(this.getEnd(r),this.domFrag().oneElement(),d);g.KIND_OF_MQ="MathField",g.editable=!0,g.createTextarea(),g.editablesTextareaEvents(),g.cursor.insAtRightEnd(g.root),fo(g.root);function y(G){if(G.parentNode&&!L(G).hasClass("dcg-mq-root-block")&&y(G.parentNode),G.nodeType===Node.ELEMENT_NODE){var F=G;F.getAttribute("aria-hidden")==="true"&&(F.removeAttribute("aria-hidden"),L(G).children().eachElement(function(q){q.setAttribute("aria-hidden","true")}))}}y(this.domFrag().parent().oneElement()),this.domFrag().oneElement().removeAttribute("aria-hidden")},f.prototype.registerInnerField=function(d,g){var y=this.getEnd(r).controller,G=new g(y);d[this.name]=G,d.push(G)},f.prototype.latexRecursive=function(d){this.checkCursorContextOpen(d),this.getEnd(r).latexRecursive(d),this.checkCursorContextClose(d)},f.prototype.text=function(){return this.getEnd(r).text()},f}(ro);E.editable=E.MathQuillMathField=YI;var Vy=function(v){ct(f,v);function f(){return v!==null&&v.apply(this,arguments)||this}return f.prototype.setOptions=function(d){function g(){return""}return this.text=d.text||g,this.domView=new $i(0,function(){return l("span",{},[s(d.htmlString||"")])}),this.latex=d.latex||g,this},f.prototype.latexRecursive=function(d){this.checkCursorContextOpen(d),d.latex+=this.latex(),this.checkCursorContextClose(d)},f.prototype.parser=function(){var d=this,g=fe.string,y=fe.regex,G=fe.succeed;return g("{").then(y(/^[a-z][a-z0-9]*/i)).skip(g("}")).then(function(F){return g("[").then(y(/^[-\w\s]*/)).skip(g("]")).or(G(void 0)).map(function(q){return d.setOptions(ie[F](q))})})},f}(Rn);if(E.embed=Vy,window.jQuery){at=Ot(1);for(var rD in at)(function(v,f){typeof f=="function"?(Vt[v]=function(){return Ze(),f.apply(this,arguments)},Vt[v].prototype=f.prototype):Vt[v]=f})(rD,at[rD])}})()});var E4=__dcg_shared_module_exports__['f']((a1e,k4)=>{k4.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,menuitem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}});var T4=__dcg_shared_module_exports__['f']((s1e,G4)=>{var jZ=/([\w-]+)|=|(['"])([.\s\S]*?)\2/g,YZ=E4();G4.exports=function(r){var e=0,t,i=!0,o={type:"tag",name:"",voidElement:!1,attrs:{},children:[]};return r.replace(jZ,function(n){if(n==="="){i=!0,e++;return}i?e===0?((YZ[n]||r.charAt(r.length-2)==="/")&&(o.voidElement=!0),o.name=n):(o.attrs[t]=n.replace(/^['"]|['"]$/g,""),t=void 0):(t&&(o.attrs[t]=t),t=n),e++,i=!1}),o}});var V4=__dcg_shared_module_exports__['f']((l1e,I4)=>{var JZ=/(?:<!--[\S\s]*?-->|<(?:"[^"]*"['"]*|'[^']*'['"]*|[^'">])+>)/g,XZ=T4(),QZ=Object.create?Object.create(null):{};function wL(r,e,t,i,o){var n=e.indexOf("<",i),a=e.slice(i,n===-1?void 0:n);/^\s*$/.test(a)&&(a=" "),(!o&&n>-1&&t+r.length>=0||a!==" ")&&r.push({type:"text",content:a})}I4.exports=function(e,t){t||(t={}),t.components||(t.components=QZ);var i=[],o,n=-1,a=[],s={},l=!1;return e.replace(JZ,function(c,p){if(l){if(c!=="</"+o.name+">")return;l=!1}var u=c.charAt(1)!=="/",m=c.indexOf("<!--")===0,h=p+c.length,x=e.charAt(h),C;u&&!m&&(n++,o=XZ(c),o.type==="tag"&&t.components[o.name]&&(o.type="component",l=!0),!o.voidElement&&!l&&x&&x!=="<"&&wL(o.children,e,n,h,t.ignoreWhitespace),s[o.tagName]=o,n===0&&i.push(o),C=a[n-1],C&&C.children.push(o),a[n]=o),(m||!u||o.voidElement)&&(m||n--,!l&&x!=="<"&&x&&(C=n===-1?i:a[n].children,wL(C,e,n,h,t.ignoreWhitespace)))}),!i.length&&e.length&&wL(i,e,0,0,t.ignoreWhitespace),i}});var L4=__dcg_shared_module_exports__['f']((c1e,A4)=>{function ZZ(r){var e=[];for(var t in r)e.push(t+'="'+r[t]+'"');return e.length?" "+e.join(" "):""}function M4(r,e){switch(e.type){case"text":return r+e.content;case"tag":return r+="<"+e.name+(e.attrs?ZZ(e.attrs):"")+(e.voidElement?"/>":">"),e.voidElement?r:r+e.children.reduce(M4,"")+"</"+e.name+">"}}A4.exports=function(r){return r.reduce(function(e,t){return e+M4("",t)},"")}});var P4=__dcg_shared_module_exports__['f']((d1e,O4)=>{O4.exports={parse:V4(),stringify:L4()}});var G6=__dcg_shared_module_exports__['f']((E6,jO)=>{(function(r){if(typeof E6=="object"&&typeof jO!="undefined")jO.exports=r();else{var e;typeof window!="undefined"?e=window:typeof global!="undefined"?e=global:typeof self!="undefined"?e=self:e=this,e.bugsnag=r()}})(function(){var r,e,t,i=function(T,_,N){for(var $=N,ee=0,me=T.length;ee<me;ee++)$=_($,T[ee],ee,T);return $},o=function(T,_){return i(T,function(N,$,ee,me){return _($,ee,me)?N.concat($):N},[])},n=function(T,_){return i(T,function(N,$,ee,me){return N.concat(_($,ee,me))},[])},a=function(T,_){return i(T,function(N,$,ee,me){return N===!0||$===_},!1)},s=!{toString:null}.propertyIsEnumerable("toString"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],c=function(T){var _=[],N;for(N in T)Object.prototype.hasOwnProperty.call(T,N)&&_.push(N);if(!s)return _;for(var $=0,ee=l.length;$<ee;$++)Object.prototype.hasOwnProperty.call(T,l[$])&&_.push(l[$]);return _},p=function(T){return Object.prototype.toString.call(T)==="[object Array]"},u=function(T){return T<10?"0"+T:T},m=function(){var T=new Date;return T.getUTCFullYear()+"-"+u(T.getUTCMonth()+1)+"-"+u(T.getUTCDate())+"T"+u(T.getUTCHours())+":"+u(T.getUTCMinutes())+":"+u(T.getUTCSeconds())+"."+(T.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"},h={map:n,reduce:i,filter:o,includes:a,keys:c,isArray:p,isoDate:m},x={};x.intRange=function(T,_){return T===void 0&&(T=1),_===void 0&&(_=1/0),function(N){return typeof N=="number"&&parseInt(""+N,10)===N&&N>=T&&N<=_}},x.stringWithLength=function(T){return typeof T=="string"&&!!T.length};var C={},D=h.filter,k=h.reduce,M=h.keys,I=h.isArray,S=h.includes,V=x.intRange,P=x.stringWithLength;C.schema={apiKey:{defaultValue:function(){return null},message:"is required",validate:P},appVersion:{defaultValue:function(){return null},message:"should be a string",validate:function(T){return T===null||P(T)}},appType:{defaultValue:function(){return null},message:"should be a string",validate:function(T){return T===null||P(T)}},autoNotify:{defaultValue:function(){return!0},message:"should be true|false",validate:function(T){return T===!0||T===!1}},beforeSend:{defaultValue:function(){return[]},message:"should be a function or array of functions",validate:function(T){return typeof T=="function"||I(T)&&D(T,function(_){return typeof _=="function"}).length===T.length}},endpoints:{defaultValue:function(){return{notify:"https://notify.bugsnag.com",sessions:"https://sessions.bugsnag.com"}},message:"should be an object containing endpoint URLs { notify, sessions }. sessions is optional if autoCaptureSessions=false",validate:function(T,_){return T&&typeof T=="object"&&P(T.notify)&&(_.autoCaptureSessions===!1||P(T.sessions))&&D(M(T),function(N){return!S(["notify","sessions"],N)}).length===0}},autoCaptureSessions:{defaultValue:function(T,_){return _.endpoints===void 0||!!_.endpoints&&!!_.endpoints.sessions},message:"should be true|false",validate:function(T){return T===!0||T===!1}},notifyReleaseStages:{defaultValue:function(){return null},message:"should be an array of strings",validate:function(T){return T===null||I(T)&&D(T,function(_){return typeof _=="string"}).length===T.length}},releaseStage:{defaultValue:function(){return"production"},message:"should be a string",validate:function(T){return typeof T=="string"&&T.length}},maxBreadcrumbs:{defaultValue:function(){return 20},message:"should be a number \u226440",validate:function(T){return V(0,40)(T)}},autoBreadcrumbs:{defaultValue:function(){return!0},message:"should be true|false",validate:function(T){return typeof T=="boolean"}},user:{defaultValue:function(){return null},message:"(object) user should be an object",validate:function(T){return typeof T=="object"}},metaData:{defaultValue:function(){return null},message:"should be an object",validate:function(T){return typeof T=="object"}},logger:{defaultValue:function(){},message:"should be null or an object with methods { debug, info, warn, error }",validate:function(T){return!T||T&&k(["debug","info","warn","error"],function(_,N){return _&&typeof T[N]=="function"},!0)}},filters:{defaultValue:function(){return["password"]},message:"should be an array of strings|regexes",validate:function(T){return I(T)&&T.length===D(T,function(_){return typeof _=="string"||_&&typeof _.test=="function"}).length}}},C.mergeDefaults=function(T,_){if(!T||!_)throw new Error("opts and schema objects are required");return k(M(_),function(N,$){return N[$]=T[$]!==void 0?T[$]:_[$].defaultValue(T[$],T),N},{})},C.validate=function(T,_){if(!T||!_)throw new Error("opts and schema objects are required");var N=k(M(_),function($,ee){return _[ee].validate(T[ee],T)?$:$.concat({key:ee,message:_[ee].message,value:T[ee]})},[]);return{valid:!N.length,errors:N}};function L(){return L=Object.assign||function(T){for(var _=1;_<arguments.length;_++){var N=arguments[_];for(var $ in N)Object.prototype.hasOwnProperty.call(N,$)&&(T[$]=N[$])}return T},L.apply(this,arguments)}var B=C.schema,R=h.map,W=x.stringWithLength,re={releaseStage:{defaultValue:function(){return/^localhost(:\d+)?$/.test(window.location.host)?"development":"production"},message:"should be set",validate:W},logger:L({},B.logger,{defaultValue:function(){return typeof console!="undefined"&&typeof console.debug=="function"?ne():void 0}})},ne=function(){var T={},_=console.log;return R(["debug","info","warn","error"],function(N){var $=console[N];T[N]=typeof $=="function"?$.bind(console,"[bugsnag]"):_.bind(console,"[bugsnag]")}),T},X=h.isoDate,b=function(){function T(N,$,ee,me){N===void 0&&(N="[anonymous]"),$===void 0&&($={}),ee===void 0&&(ee="manual"),me===void 0&&(me=X()),this.type=ee,this.name=N,this.metaData=$,this.timestamp=me}var _=T.prototype;return _.toJSON=function(){return{type:this.type,name:this.name,timestamp:this.timestamp,metaData:this.metaData}},T}(),A=b,E=function(T,_,N){var $=T.length,ee=0,me=function(){if(ee>=$)return N(null,!1);_(T[ee],function(ge,$e){if(ge)return N(ge,!1);if($e===!0)return N(null,!0);ee++,me()})};me()},J=function(T){return T.app&&typeof T.app.releaseStage=="string"?T.app.releaseStage:T.config.releaseStage},j=ce;function ce(T){switch(Object.prototype.toString.call(T)){case"[object Error]":return!0;case"[object Exception]":return!0;case"[object DOMException]":return!0;default:return T instanceof Error}}var te=j,pe=function(T,_){return function(N,$){if(typeof N!="function")return $(null,!1);try{if(N.length!==2){var ee=N(T);return ee&&typeof ee.then=="function"?ee.then(function(me){return setTimeout(function(){return $(null,he(T,me))},0)},function(me){setTimeout(function(){return _(me),$(null,!1)})}):$(null,he(T,ee))}N(T,function(me,ge){if(me)return _(me),$(null,!1);$(null,he(T,ge))})}catch(me){_(me),$(null,!1)}}},he=function(T,_){return T.isIgnored()||_===!1},ae={};(function(T,_){"use strict";typeof r=="function"&&r.amd?r("stackframe",[],_):typeof ae=="object"?ae=_():T.StackFrame=_()})(this,function(){"use strict";function T(qe){return!isNaN(parseFloat(qe))&&isFinite(qe)}function _(qe){return qe.charAt(0).toUpperCase()+qe.substring(1)}function N(qe){return function(){return this[qe]}}var $=["isConstructor","isEval","isNative","isToplevel"],ee=["columnNumber","lineNumber"],me=["fileName","functionName","source"],ge=["args"],$e=$.concat(ee,me,ge);function He(qe){if(qe instanceof Object)for(var vi=0;vi<$e.length;vi++)qe.hasOwnProperty($e[vi])&&qe[$e[vi]]!==void 0&&this["set"+_($e[vi])](qe[$e[vi]])}He.prototype={getArgs:function(){return this.args},setArgs:function(qe){if(Object.prototype.toString.call(qe)!=="[object Array]")throw new TypeError("Args must be an Array");this.args=qe},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(qe){if(qe instanceof He)this.evalOrigin=qe;else if(qe instanceof Object)this.evalOrigin=new He(qe);else throw new TypeError("Eval Origin must be an Object or StackFrame")},toString:function(){var qe=this.getFunctionName()||"{anonymous}",vi="("+(this.getArgs()||[]).join(",")+")",md=this.getFileName()?"@"+this.getFileName():"",kc=T(this.getLineNumber())?":"+this.getLineNumber():"",Ca=T(this.getColumnNumber())?":"+this.getColumnNumber():"";return qe+vi+md+kc+Ca}};for(var Zt=0;Zt<$.length;Zt++)He.prototype["get"+_($[Zt])]=N($[Zt]),He.prototype["set"+_($[Zt])]=function(qe){return function(vi){this[qe]=!!vi}}($[Zt]);for(var yt=0;yt<ee.length;yt++)He.prototype["get"+_(ee[yt])]=N(ee[yt]),He.prototype["set"+_(ee[yt])]=function(qe){return function(vi){if(!T(vi))throw new TypeError(qe+" must be a Number");this[qe]=Number(vi)}}(ee[yt]);for(var qi=0;qi<me.length;qi++)He.prototype["get"+_(me[qi])]=N(me[qi]),He.prototype["set"+_(me[qi])]=function(qe){return function(vi){this[qe]=String(vi)}}(me[qi]);return He});var ie={};(function(T,_){"use strict";typeof r=="function"&&r.amd?r("error-stack-parser",["stackframe"],_):typeof ie=="object"?ie=_(ae):T.ErrorStackParser=_(T.StackFrame)})(this,function(_){"use strict";var N=/(^|@)\S+\:\d+/,$=/^\s*at .*(\S+\:\d+|\(native\))/m,ee=/^(eval@)?(\[native code\])?$/;return{parse:function(ge){if(typeof ge.stacktrace!="undefined"||typeof ge["opera#sourceloc"]!="undefined")return this.parseOpera(ge);if(ge.stack&&ge.stack.match($))return this.parseV8OrIE(ge);if(ge.stack)return this.parseFFOrSafari(ge);throw new Error("Cannot parse given Error object")},extractLocation:function(ge){if(ge.indexOf(":")===-1)return[ge];var $e=/(.+?)(?:\:(\d+))?(?:\:(\d+))?$/,He=$e.exec(ge.replace(/[\(\)]/g,""));return[He[1],He[2]||void 0,He[3]||void 0]},parseV8OrIE:function(ge){var $e=ge.stack.split(`
`).filter(function(He){return!!He.match($)},this);return $e.map(function(He){He.indexOf("(eval ")>-1&&(He=He.replace(/eval code/g,"eval").replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,""));var Zt=He.replace(/^\s+/,"").replace(/\(eval code/g,"(").split(/\s+/).slice(1),yt=this.extractLocation(Zt.pop()),qi=Zt.join(" ")||void 0,qe=["eval","<anonymous>"].indexOf(yt[0])>-1?void 0:yt[0];return new _({functionName:qi,fileName:qe,lineNumber:yt[1],columnNumber:yt[2],source:He})},this)},parseFFOrSafari:function(ge){var $e=ge.stack.split(`
`).filter(function(He){return!He.match(ee)},this);return $e.map(function(He){if(He.indexOf(" > eval")>-1&&(He=He.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,":$1")),He.indexOf("@")===-1&&He.indexOf(":")===-1)return new _({functionName:He});var Zt=/((.*".+"[^@]*)?[^@]*)(?:@)/,yt=He.match(Zt),qi=yt&&yt[1]?yt[1]:void 0,qe=this.extractLocation(He.replace(Zt,""));return new _({functionName:qi,fileName:qe[0],lineNumber:qe[1],columnNumber:qe[2],source:He})},this)},parseOpera:function(ge){return!ge.stacktrace||ge.message.indexOf(`
`)>-1&&ge.message.split(`
`).length>ge.stacktrace.split(`
`).length?this.parseOpera9(ge):ge.stack?this.parseOpera11(ge):this.parseOpera10(ge)},parseOpera9:function(ge){for(var $e=/Line (\d+).*script (?:in )?(\S+)/i,He=ge.message.split(`
`),Zt=[],yt=2,qi=He.length;yt<qi;yt+=2){var qe=$e.exec(He[yt]);qe&&Zt.push(new _({fileName:qe[2],lineNumber:qe[1],source:He[yt]}))}return Zt},parseOpera10:function(ge){for(var $e=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,He=ge.stacktrace.split(`
`),Zt=[],yt=0,qi=He.length;yt<qi;yt+=2){var qe=$e.exec(He[yt]);qe&&Zt.push(new _({functionName:qe[3]||void 0,fileName:qe[2],lineNumber:qe[1],source:He[yt]}))}return Zt},parseOpera11:function(ge){var $e=ge.stack.split(`
`).filter(function(He){return!!He.match(N)&&!He.match(/^Error created at/)},this);return $e.map(function(He){var Zt=He.split("@"),yt=this.extractLocation(Zt.pop()),qi=Zt.shift()||"",qe=qi.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||void 0,vi;qi.match(/\(([^\)]*)\)/)&&(vi=qi.replace(/^[^\(]+\(([^\)]*)\)$/,"$1"));var md=vi===void 0||vi==="[arguments not available]"?void 0:vi.split(",");return new _({functionName:qe,args:md,fileName:yt[0],lineNumber:yt[1],columnNumber:yt[2],source:He})},this)}}});var de=ie,Ie=function(T){return!!T&&(!!T.stack||!!T.stacktrace||!!T["opera#sourceloc"])&&typeof(T.stack||T.stacktrace||T["opera#sourceloc"])=="string"&&T.stack!==T.name+": "+T.message},Se={};(function(T,_){"use strict";typeof r=="function"&&r.amd?r("stack-generator",["stackframe"],_):typeof Se=="object"?Se=_(ae):T.StackGenerator=_(T.StackFrame)})(this,function(T){return{backtrace:function(N){var $=[],ee=10;typeof N=="object"&&typeof N.maxStackSize=="number"&&(ee=N.maxStackSize);for(var me=arguments.callee;me&&$.length<ee&&me.arguments;){for(var ge=new Array(me.arguments.length),$e=0;$e<ge.length;++$e)ge[$e]=me.arguments[$e];/function(?:\s+([\w$]+))+\s*\(/.test(me.toString())?$.push(new T({functionName:RegExp.$1||void 0,args:ge})):$.push(new T({args:ge}));try{me=me.caller}catch(He){break}}return $}}});function ot(){return ot=Object.assign||function(T){for(var _=1;_<arguments.length;_++){var N=arguments[_];for(var $ in N)Object.prototype.hasOwnProperty.call(N,$)&&(T[$]=N[$])}return T},ot.apply(this,arguments)}var Ze=h.reduce,at=h.filter,Vt=function(){function T(N,$,ee,me,ge){ee===void 0&&(ee=[]),me===void 0&&(me=Ot()),this.__isBugsnagReport=!0,this._ignored=!1,this._handledState=me,this.app=void 0,this.apiKey=void 0,this.breadcrumbs=[],this.context=void 0,this.device=void 0,this.errorClass=Le(N,"[no error class]"),this.errorMessage=Le($,"[no error message]"),this.groupingHash=void 0,this.metaData={},this.request=void 0,this.severity=this._handledState.severity,this.stacktrace=Ze(ee,function($e,He){var Zt=Dt(He);try{return JSON.stringify(Zt)==="{}"?$e:$e.concat(Zt)}catch(yt){return $e}},[]),this.user=void 0,this.session=void 0,this.originalError=ge}var _=T.prototype;return _.ignore=function(){this._ignored=!0},_.isIgnored=function(){return this._ignored},_.updateMetaData=function($){var ee;if(!$)return this;var me;return(arguments.length<=1?void 0:arguments[1])===null?this.removeMetaData($):(arguments.length<=2?void 0:arguments[2])===null?this.removeMetaData($,arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2]):(typeof(arguments.length<=1?void 0:arguments[1])=="object"&&(me=arguments.length<=1?void 0:arguments[1]),typeof(arguments.length<=1?void 0:arguments[1])=="string"&&(me=(ee={},ee[arguments.length<=1?void 0:arguments[1]]=arguments.length<=2?void 0:arguments[2],ee)),me?(this.metaData[$]||(this.metaData[$]={}),this.metaData[$]=ot({},this.metaData[$],me),this):this)},_.removeMetaData=function($,ee){return typeof $!="string"?this:ee?this.metaData[$]?(delete this.metaData[$][ee],this):this:(delete this.metaData[$],this)},_.toJSON=function(){return{payloadVersion:"4",exceptions:[{errorClass:this.errorClass,message:this.errorMessage,stacktrace:this.stacktrace,type:"browserjs"}],severity:this.severity,unhandled:this._handledState.unhandled,severityReason:this._handledState.severityReason,app:this.app,device:this.device,breadcrumbs:this.breadcrumbs,context:this.context,user:this.user,metaData:this.metaData,groupingHash:this.groupingHash,request:this.request,session:this.session}},T}(),Dt=function(T){var _={file:T.fileName,method:Mr(T.functionName),lineNumber:T.lineNumber,columnNumber:T.columnNumber,code:void 0,inProject:void 0};return _.lineNumber>-1&&!_.file&&!_.method&&(_.file="global code"),_},Mr=function(T){return/^global code$/i.test(T)?"global code":T},Ot=function(){return{unhandled:!1,severity:"warning",severityReason:{type:"handledException"}}},Le=function(T,_){return typeof T=="string"&&T?T:_};Vt.getStacktrace=function(T,_,N){return _===void 0&&(_=0),N===void 0&&(N=0),Ie(T)?de.parse(T).slice(_):at(Se.backtrace(),function($){return($.functionName||"").indexOf("StackGenerator$$")===-1}).slice(1+N)},Vt.ensureReport=function(T,_,N){if(_===void 0&&(_=0),N===void 0&&(N=0),T.__isBugsnagReport)return T;try{var $=Vt.getStacktrace(T,_,1+N);return new Vt(T.name,T.message,$,void 0,T)}catch(ee){return new Vt(T.name,T.message,[],void 0,T)}};var fo=Vt,Wi=function(_,N){var $="000000000"+_;return $.substr($.length-N)},fe=typeof window=="object"?window:self,Yo=0;for(var tt in fe)Object.hasOwnProperty.call(fe,tt)&&Yo++;var ft=navigator.mimeTypes?navigator.mimeTypes.length:0,gt=Wi((ft+navigator.userAgent.length).toString(36)+Yo.toString(36),4),xe=function(){return gt},Pt=0,Fe=4,wi=36,Ce=Math.pow(wi,Fe);function Ct(){return Wi((Math.random()*Ce<<0).toString(wi),Fe)}function Tt(){return Pt=Pt<Ce?Pt:0,Pt++,Pt-1}function ke(){var T="c",_=new Date().getTime().toString(wi),N=Wi(Tt().toString(wi),Fe),$=xe(),ee=Ct()+Ct();return T+_+N+$+ee}ke.fingerprint=xe;var pi=ke,pt=h.isoDate,_l=function(){function T(){this.id=pi(),this.startedAt=pt(),this._handled=0,this._unhandled=0}var _=T.prototype;return _.toJSON=function(){return{id:this.id,startedAt:this.startedAt,events:{handled:this._handled,unhandled:this._unhandled}}},_.trackError=function($){this[$._handledState.unhandled?"_unhandled":"_handled"]+=1},T}(),Gt=_l;function Eo(){return Eo=Object.assign||function(T){for(var _=1;_<arguments.length;_++){var N=arguments[_];for(var $ in N)Object.prototype.hasOwnProperty.call(N,$)&&(T[$]=N[$])}return T},Eo.apply(this,arguments)}var $i=h.map,ro=h.includes,Rn=h.isArray,wc="Usage error.",_a="Bugsnag usage error.",_t=function(){function T(N){if(!N||!N.name||!N.version||!N.url)throw new Error("`notifier` argument is required");this.notifier=N,this._configured=!1,this._opts={},this.config={},this._delivery={sendSession:function(){},sendReport:function(){}},this._logger={debug:function(){},info:function(){},warn:function(){},error:function(){}},this._plugins={},this._session=null,this.breadcrumbs=[],this.app={},this.context=void 0,this.device=void 0,this.metaData=void 0,this.request=void 0,this.user={},this.BugsnagClient=T,this.BugsnagReport=fo,this.BugsnagBreadcrumb=A,this.BugsnagSession=Gt;var $=this,ee=this.notify;this.notify=function(){return ee.apply($,arguments)}}var _=T.prototype;return _.setOptions=function($){this._opts=Eo({},this._opts,$)},_.configure=function($){$===void 0&&($=C.schema);var ee=C.mergeDefaults(this._opts,$),me=C.validate(ee,$);if(!me.valid)throw new Error(En(me.errors));return typeof ee.beforeSend=="function"&&(ee.beforeSend=[ee.beforeSend]),ee.appVersion&&(this.app.version=ee.appVersion),ee.appType&&(this.app.type=ee.appType),ee.metaData&&(this.metaData=ee.metaData),ee.user&&(this.user=ee.user),ee.logger&&this.logger(ee.logger),this.config=Eo({},this.config,ee),this._configured=!0,this},_.use=function($){if(!this._configured)throw new Error("client not configured");$.configSchema&&this.configure($.configSchema);for(var ee=arguments.length,me=new Array(ee>1?ee-1:0),ge=1;ge<ee;ge++)me[ge-1]=arguments[ge];var $e=$.init.apply($,[this].concat(me));return $.name&&(this._plugins["~"+$.name+"~"]=$e),this},_.getPlugin=function($){return this._plugins["~"+$+"~"]},_.delivery=function($){return this._delivery=$,this},_.logger=function($,ee){return this._logger=$,this},_.sessionDelegate=function($){return this._sessionDelegate=$,this},_.startSession=function(){return this._sessionDelegate?this._sessionDelegate.startSession(this):(this._logger.warn("No session implementation is installed"),this)},_.leaveBreadcrumb=function($,ee,me,ge){if(!this._configured)throw new Error("client not configured");if($=$||void 0,me=typeof me=="string"?me:void 0,ge=typeof ge=="string"?ge:void 0,ee=typeof ee=="object"&&ee!==null?ee:void 0,!(typeof $!="string"&&!ee)){var $e=new A($,ee,me,ge);return this.breadcrumbs.push($e),this.breadcrumbs.length>this.config.maxBreadcrumbs&&(this.breadcrumbs=this.breadcrumbs.slice(this.breadcrumbs.length-this.config.maxBreadcrumbs)),this}},_.notify=function($,ee,me){var ge=this;if(ee===void 0&&(ee={}),me===void 0&&(me=function(){}),!this._configured)throw new Error("client not configured");var $e=J(this),He=va($,ee,this._logger),Zt=He.err,yt=He.errorFramesToSkip,qi=He._opts;qi&&(ee=qi),(typeof ee!="object"||ee===null)&&(ee={});var qe=fo.ensureReport(Zt,yt,2);if(qe.app=Eo({},{releaseStage:$e},qe.app,this.app),qe.context=qe.context||ee.context||this.context||void 0,qe.device=Eo({},qe.device,this.device,ee.device),qe.request=Eo({},qe.request,this.request,ee.request),qe.user=Eo({},qe.user,this.user,ee.user),qe.metaData=Eo({},qe.metaData,this.metaData,ee.metaData),qe.breadcrumbs=this.breadcrumbs.slice(0),this._session&&(this._session.trackError(qe),qe.session=this._session),ee.severity!==void 0&&(qe.severity=ee.severity,qe._handledState.severityReason={type:"userSpecifiedSeverity"}),Rn(this.config.notifyReleaseStages)&&!ro(this.config.notifyReleaseStages,$e))return this._logger.warn("Report not sent due to releaseStage/notifyReleaseStages configuration"),me(null,qe);var vi=qe.severity,md=[].concat(ee.beforeSend).concat(this.config.beforeSend),kc=function(Ca){ge._logger.error("Error occurred in beforeSend callback, continuing anyway\u2026"),ge._logger.error(Ca)};E(md,pe(qe,kc),function(Ca,bm){if(Ca&&kc(Ca),bm)return ge._logger.debug("Report not sent due to beforeSend callback"),me(null,qe);ge.config.autoBreadcrumbs&&ge.leaveBreadcrumb(qe.errorClass,{errorClass:qe.errorClass,errorMessage:qe.errorMessage,severity:qe.severity},"error"),vi!==qe.severity&&(qe._handledState.severityReason={type:"userCallbackSetSeverity"}),ge._delivery.sendReport(ge._logger,ge.config,{apiKey:qe.apiKey||ge.config.apiKey,notifier:ge.notifier,events:[qe]},function(iD){return me(iD,qe)})})},T}(),va=function(T,_,N){var $=3,ee=function(He){var Zt=bu(He);return N.warn(wc+" "+Zt),new Error(_a+" "+Zt)},me,ge=0,$e;switch(typeof T){case"string":typeof _=="string"?(me=ee("string/string"),$e={metaData:{notifier:{notifyArgs:[T,_]}}}):(me=new Error(String(T)),ge=$);break;case"number":case"boolean":me=new Error(String(T));break;case"function":me=ee("function");break;case"object":T!==null&&(te(T)||T.__isBugsnagReport)?me=T:T!==null&&io(T)?(me=new Error(T.message||T.errorMessage),me.name=T.name||T.errorClass,ge=$):me=ee(T===null?"null":"unsupported object");break;default:me=ee("nothing")}return{err:me,errorFramesToSkip:ge,_opts:$e}},io=function(T){return(typeof T.name=="string"||typeof T.errorClass=="string")&&(typeof T.message=="string"||typeof T.errorMessage=="string")},En=function(T){return`Bugsnag configuration error
`+$i(T,function(_){return'"'+_.key+'" '+_.message+` 
    got `+vc(_.value)}).join(`

`)},bu=function(T){return"notify() expected error/opts parameters, got "+T},vc=function(T){return typeof T=="object"?JSON.stringify(T):String(T)},ea=_t,Nr=function(T,_,N,$){var ee=$&&$.filterKeys?$.filterKeys:[],me=$&&$.filterPaths?$.filterPaths:[];return JSON.stringify(gs(T,ee,me),_,N)},Jo=20,Ya=25e3,Gn=8,Cc="...";function ta(T){return T instanceof Error||/^\[object (Error|(Dom)?Exception)\]$/.test(Object.prototype.toString.call(T))}function Fl(T){return"[Throws: "+(T?T.message:"?")+"]"}function Rl(T,_){for(var N=0,$=T.length;N<$;N++)if(T[N]===_)return!0;return!1}function bo(T,_){for(var N=0,$=T.length;N<$;N++)if(_.indexOf(T[N])===0)return!0;return!1}function pp(T,_){for(var N=0,$=T.length;N<$;N++)if(typeof T[N]=="string"&&T[N]===_||T[N]&&typeof T[N].test=="function"&&T[N].test(_))return!0;return!1}function Nl(T){return Object.prototype.toString.call(T)==="[object Array]"}function yu(T,_){try{return T[_]}catch(N){return Fl(N)}}function gs(T,_,N){var $=[],ee=0;function me(ge,$e){function He(){return $e.length>Gn&&ee>Ya}if(ee++,$e.length>Jo||He())return Cc;if(ge===null||typeof ge!="object")return ge;if(Rl($,ge))return"[Circular]";if($.push(ge),typeof ge.toJSON=="function")try{ee--;var Zt=me(ge.toJSON(),$e);return $.pop(),Zt}catch(bm){return Fl(bm)}var yt=ta(ge);if(yt){ee--;var qi=me({name:ge.name,message:ge.message},$e);return $.pop(),qi}if(Nl(ge)){for(var qe=[],vi=0,md=ge.length;vi<md;vi++){if(He()){qe.push(Cc);break}qe.push(me(ge[vi],$e.concat("[]")))}return $.pop(),qe}var kc={};try{for(var Ca in ge)if(Object.prototype.hasOwnProperty.call(ge,Ca)){if(bo(N,$e.join("."))&&pp(_,Ca)){kc[Ca]="[Filtered]";continue}if(He()){kc[Ca]=Cc;break}kc[Ca]=me(yu(ge,Ca),$e.concat(Ca))}}catch(bm){}return $.pop(),kc}return me(T,[])}var Bl={},ky=["events.[].app","events.[].metaData","events.[].user","events.[].breadcrumbs","events.[].request","events.[].device"],WC=["device","app","user"];Bl.report=function(T,_){var N=Nr(T,null,null,{filterPaths:ky,filterKeys:_});if(N.length>1e6&&(delete T.events[0].metaData,T.events[0].metaData={notifier:`WARNING!
Serialized payload was `+N.length/1e6+`MB (limit = 1MB)
metaData was removed`},N=Nr(T,null,null,{filterPaths:ky,filterKeys:_}),N.length>1e6))throw new Error("payload exceeded 1MB limit");return N},Bl.session=function(T,_){var N=Nr(T,null,null,{filterPaths:WC,filterKeys:_});if(N.length>1e6)throw new Error("payload exceeded 1MB limit");return N};var Ey={},$C=h.isoDate;Ey=function(T){return T===void 0&&(T=window),{sendReport:function(_,N,$,ee){ee===void 0&&(ee=function(){});var me=Gy(N,"notify","4",T),ge=new T.XDomainRequest;ge.onload=function(){ee(null)},ge.open("POST",me),setTimeout(function(){try{ge.send(Bl.report($,N.filters))}catch($e){_.error($e),ee($e)}},0)},sendSession:function(_,N,$,ee){ee===void 0&&(ee=function(){});var me=Gy(N,"sessions","1",T),ge=new T.XDomainRequest;ge.onload=function(){ee(null)},ge.open("POST",me),setTimeout(function(){try{ge.send(Bl.session($,N.filters))}catch($e){_.error($e),ee($e)}},0)}}};var Gy=function(T,_,N,$){return jC(T.endpoints[_],$.location.protocol)+"?apiKey="+encodeURIComponent(T.apiKey)+"&payloadVersion="+N+"&sentAt="+encodeURIComponent($C())},jC=Ey._matchPageProtocol=function(T,_){return _==="http:"?T.replace(/^https:/,"http:"):T},xu=h.isoDate,nl=function(T){return T===void 0&&(T=window),{sendReport:function(_,N,$,ee){ee===void 0&&(ee=function(){});try{var me=N.endpoints.notify,ge=new T.XMLHttpRequest;ge.onreadystatechange=function(){ge.readyState===T.XMLHttpRequest.DONE&&ee(null)},ge.open("POST",me),ge.setRequestHeader("Content-Type","application/json"),ge.setRequestHeader("Bugsnag-Api-Key",$.apiKey||N.apiKey),ge.setRequestHeader("Bugsnag-Payload-Version","4"),ge.setRequestHeader("Bugsnag-Sent-At",xu()),ge.send(Bl.report($,N.filters))}catch($e){_.error($e)}},sendSession:function(_,N,$,ee){ee===void 0&&(ee=function(){});try{var me=N.endpoints.sessions,ge=new T.XMLHttpRequest;ge.onreadystatechange=function(){ge.readyState===T.XMLHttpRequest.DONE&&ee(null)},ge.open("POST",me),ge.setRequestHeader("Content-Type","application/json"),ge.setRequestHeader("Bugsnag-Api-Key",N.apiKey),ge.setRequestHeader("Bugsnag-Payload-Version","1"),ge.setRequestHeader("Bugsnag-Sent-At",xu()),ge.send(Bl.session($,N.filters))}catch($e){_.error($e)}}}},YO={init:function(T,_){_===void 0&&(_=window),T.config.beforeSend.unshift(function(N){N.context||(N.context=_.location.pathname)})}};function up(){return up=Object.assign||function(T){for(var _=1;_<arguments.length;_++){var N=arguments[_];for(var $ in N)Object.prototype.hasOwnProperty.call(N,$)&&(T[$]=N[$])}return T},up.apply(this,arguments)}var Ty=h.isoDate,al={init:function(T,_){_===void 0&&(_=navigator);var N={locale:_.browserLanguage||_.systemLanguage||_.userLanguage||_.language,userAgent:_.userAgent};T.device=up({},N,T.device),T.config.beforeSend.unshift(function($){$.device=up({},$.device,{time:Ty()})})}};function Fh(){return Fh=Object.assign||function(T){for(var _=1;_<arguments.length;_++){var N=arguments[_];for(var $ in N)Object.prototype.hasOwnProperty.call(N,$)&&(T[$]=N[$])}return T},Fh.apply(this,arguments)}var YC={init:function(T,_){_===void 0&&(_=window),T.config.beforeSend.unshift(function(N){N.request&&N.request.url||(N.request=Fh({},N.request,{url:_.location.href}))})}};function Dc(){return Dc=Object.assign||function(T){for(var _=1;_<arguments.length;_++){var N=arguments[_];for(var $ in N)Object.prototype.hasOwnProperty.call(N,$)&&(T[$]=N[$])}return T},Dc.apply(this,arguments)}var WI=h.isArray,$I=h.includes,JC={init:function(T){return T.sessionDelegate(XC)}},XC={startSession:function(T){var _=T;_._session=new T.BugsnagSession;var N=J(_);return WI(_.config.notifyReleaseStages)&&!$I(_.config.notifyReleaseStages,N)?(_._logger.warn("Session not sent due to releaseStage/notifyReleaseStages configuration"),_):_.config.endpoints.sessions?(_._delivery.sendSession(_._logger,_.config,{notifier:_.notifier,device:_.device,app:Dc({},{releaseStage:N},_.app),sessions:[{id:_._session.id,startedAt:_._session.startedAt,user:_.user}]}),_):(_._logger.warn("Session not sent due to missing endpoints.sessions configuration"),_)}};function hm(){return hm=Object.assign||function(T){for(var _=1;_<arguments.length;_++){var N=arguments[_];for(var $ in N)Object.prototype.hasOwnProperty.call(N,$)&&(T[$]=N[$])}return T},hm.apply(this,arguments)}var QC={init:function(T){T.config.collectUserIp||T.config.beforeSend.push(function(_){_.user&&typeof _.user.id=="undefined"&&delete _.user.id,_.user=hm({id:"[NOT COLLECTED]"},_.user),_.request=hm({clientIp:"[NOT COLLECTED]"},_.request)})},configSchema:{collectUserIp:{defaultValue:function(){return!0},message:"should be true|false",validate:function(T){return T===!0||T===!1}}}},Rh={},ZC=h.map,eD=h.reduce,sl=h.filter;Rh.init=function(T){var _=/^dev(elopment)?$/.test(T.config.releaseStage),N=T.config.consoleBreadcrumbsEnabled===!1,$=(T.config.autoBreadcrumbs===!1||_)&&T.config.consoleBreadcrumbsEnabled!==!0;N||$||ZC(jI,function(ee){var me=console[ee];console[ee]=function(){for(var ge=arguments.length,$e=new Array(ge),He=0;He<ge;He++)$e[He]=arguments[He];T.leaveBreadcrumb("Console output",eD($e,function(Zt,yt,qi){var qe="[Unknown value]";try{qe=String(yt)}catch(vi){}if(qe==="[object Object]")try{qe=JSON.stringify(yt)}catch(vi){}return Zt["["+qi+"]"]=qe,Zt},{severity:ee.indexOf("group")===0?"log":ee}),"log"),me.apply(console,$e)},console[ee]._restore=function(){console[ee]=me}})},Rh.configSchema={consoleBreadcrumbsEnabled:{defaultValue:function(){},validate:function(T){return T===!0||T===!1||T===void 0},message:"should be true|false"}};var jI=sl(["log","debug","info","warn","error"],function(T){return typeof console!="undefined"&&typeof console[T]=="function"}),hp={},wu=h.reduce;hp={init:function(T,_,N){_===void 0&&(_=document),N===void 0&&(N=window);var $="",ee=!1,me=function(){return _.documentElement.outerHTML},ge=N.location.href,$e=function(Zt){var yt=Zt.stacktrace[0];if(!yt||!yt.file||!yt.lineNumber||yt.file.replace(/#.*$/,"")!==ge.replace(/#.*$/,""))return yt;(!ee||!$)&&($=me());var qi=["<!-- DOC START -->"].concat($.split(`
`)),qe=Iy(qi,yt.lineNumber-1),vi=qe.script,md=qe.start,kc=wu(vi,function(Ca,bm,iD){return Math.abs(md+iD+1-yt.lineNumber)>10||(Ca[""+(md+iD+1)]=bm),Ca},{});yt.code=kc,Zt.updateMetaData("script",{content:vi.join(`
`)})};$=me();var He=_.onreadystatechange;_.onreadystatechange=function(){_.readyState==="interactive"&&($=me(),ee=!0),typeof He=="function"&&He.apply(this,arguments)},T.config.beforeSend.unshift($e)}};var gm=/^.*<script.*?>/,mm=/<\/script>.*$/,Iy=hp.extractScriptContent=function(T,_){for(var N=_;N<T.length&&!mm.test(T[N]);)N++;for(var $=N;N>0&&!gm.test(T[N]);)N--;var ee=N,me=T.slice(ee,$+1);return me[0]=me[0].replace(gm,""),me[me.length-1]=me[me.length-1].replace(mm,""),{script:me,start:ee}},tD={init:function(T,_){if(_===void 0&&(_=window),"addEventListener"in _){var N=T.config.interactionBreadcrumbsEnabled===!1,$=T.config.autoBreadcrumbs===!1&&T.config.interactionBreadcrumbsEnabled!==!0;N||$||_.addEventListener("click",function(ee){var me,ge;try{me=YI(ee.target),ge=Vy(ee.target,_)}catch($e){me="[hidden]",ge="[hidden]",T._logger.error("Cross domain error when tracking click event. See docs: https://tinyurl.com/y94fq5zm")}T.leaveBreadcrumb("UI click",{targetText:me,targetSelector:ge},"user")},!0)}},configSchema:{interactionBreadcrumbsEnabled:{defaultValue:function(){},validate:function(T){return T===!0||T===!1||T===void 0},message:"should be true|false"}}},YI=function(T){var _=T.textContent||T.innerText||"";return!_&&(T.type==="submit"||T.type==="button")&&(_=T.value),_=_.replace(/^\s+|\s+$/g,""),rD(_,140)};function Vy(T,_){var N=[T.tagName];if(T.id&&N.push("#"+T.id),T.className&&T.className.length&&N.push("."+T.className.split(" ").join(".")),!_.document.querySelectorAll||!Array.prototype.indexOf)return N.join("");try{if(_.document.querySelectorAll(N.join("")).length===1)return N.join("")}catch(ee){return N.join("")}if(T.parentNode.childNodes.length>1){var $=Array.prototype.indexOf.call(T.parentNode.childNodes,T)+1;N.push(":nth-child("+$+")")}return _.document.querySelectorAll(N.join("")).length===1?N.join(""):T.parentNode?Vy(T.parentNode,_)+" > "+N.join(""):N.join("")}function rD(T,_){var N="(...)";return T&&T.length<=_?T:T.slice(0,_-N.length)+N}var v={};v.init=function(T,_){if(_===void 0&&(_=window),"addEventListener"in _){var N=T.config.navigationBreadcrumbsEnabled===!1,$=T.config.autoBreadcrumbs===!1&&T.config.navigationBreadcrumbsEnabled!==!0;if(!(N||$)){var ee=function(me){return function(){return T.leaveBreadcrumb(me,{},"navigation")}};_.addEventListener("pagehide",ee("Page hidden"),!0),_.addEventListener("pageshow",ee("Page shown"),!0),_.addEventListener("load",ee("Page loaded"),!0),_.document.addEventListener("DOMContentLoaded",ee("DOMContentLoaded"),!0),_.addEventListener("load",function(){return _.addEventListener("popstate",ee("Navigated back"),!0)}),_.addEventListener("hashchange",function(me){var ge=me.oldURL?{from:f(me.oldURL,_),to:f(me.newURL,_),state:y(_)}:{to:f(_.location.href,_)};T.leaveBreadcrumb("Hash changed",ge,"navigation")},!0),_.history.replaceState&&g(T,_.history,"replaceState",_),_.history.pushState&&g(T,_.history,"pushState",_),T.leaveBreadcrumb("Bugsnag loaded",{},"navigation")}}},v.configSchema={navigationBreadcrumbsEnabled:{defaultValue:function(){},validate:function(T){return T===!0||T===!1||T===void 0},message:"should be true|false"}};var f=function(T,_){var N=_.document.createElement("A");return N.href=T,""+N.pathname+N.search+N.hash},d=function(T,_,N,$){var ee=f(T.location.href,T);return{title:N,state:_,prevState:y(T),to:$||ee,from:ee}},g=function(T,_,N,$){var ee=_[N];_[N]=function(me,ge,$e){T.leaveBreadcrumb("History "+N,d($,me,ge,$e),"navigation"),typeof T.refresh=="function"&&T.refresh(),T.config.autoCaptureSessions&&T.startSession(),ee.apply(_,[me,ge].concat($e!==void 0?$e:[]))},_[N]._restore=function(){_[N]=ee}},y=function(T){try{return T.history.state}catch(_){}},G={},F="request",q="BS~~S",Y="BS~~U",se="BS~~M",Oe=h.includes,Te=[],we,Ne,Ue=function(){return[we.config.endpoints.notify,we.config.endpoints.sessions]};G.init=function(T,_){_===void 0&&(_=window);var N=T.config.networkBreadcrumbsEnabled===!1,$=T.config.autoBreadcrumbs===!1&&T.config.networkBreadcrumbsEnabled!==!0;N||$||(we=T,Ne=_,rt(),Or())},G.configSchema={networkBreadcrumbsEnabled:{defaultValue:function(){},validate:function(T){return T===!0||T===!1||T===void 0},message:"should be true|false"}};var rt=function(){if("addEventListener"in Ne.XMLHttpRequest.prototype){var T=Ne.XMLHttpRequest.prototype.open;Ne.XMLHttpRequest.prototype.open=function(N,$){this[Y]=$,this[se]=N,this[q]&&(this.removeEventListener("load",lt),this.removeEventListener("error",wt)),this.addEventListener("load",lt),this.addEventListener("error",wt),this[q]=!0,T.apply(this,arguments)}}};function lt(){if(!Oe(Ue(),this[Y])){var T={status:this.status,request:this[se]+" "+this[Y]};this.status>=400?we.leaveBreadcrumb("XMLHttpRequest failed",T,F):we.leaveBreadcrumb("XMLHttpRequest succeeded",T,F)}}function wt(){Oe(Ue(),this[Y])||we.leaveBreadcrumb("XMLHttpRequest error",{request:this[se]+" "+this[Y]},F)}var Or=function(){if("fetch"in Ne){var T=Ne.fetch;Ne.fetch=function(){for(var N=arguments.length,$=new Array(N),ee=0;ee<N;ee++)$[ee]=arguments[ee];var me=$[0],ge=$[1],$e="GET";return ge&&ge.method&&($e=ge.method),new Promise(function(He,Zt){T.apply(void 0,$).then(function(yt){yo(yt,$e,me),He(yt)}).catch(function(yt){Br($e,me),Zt(yt)})})}}},yo=function(T,_,N){var $={status:T.status,request:_+" "+N};T.status>=400?we.leaveBreadcrumb("fetch() failed",$,F):we.leaveBreadcrumb("fetch() succeeded",$,F)},Br=function(T,_){we.leaveBreadcrumb("fetch() error",{request:T+" "+_},F)},Go=x.intRange,ms={init:function(T){var _=0;T.config.beforeSend.push(function(N){if(_>=T.config.maxEvents)return N.ignore();_++}),T.refresh=function(){_=0}},configSchema:{maxEvents:{defaultValue:function(){return 10},message:"should be a positive integer \u2264100",validate:function(T){return Go(1,100)(T)}}}},Ja={};function Sc(){return Sc=Object.assign||function(T){for(var _=1;_<arguments.length;_++){var N=arguments[_];for(var $ in N)Object.prototype.hasOwnProperty.call(N,$)&&(T[$]=N[$])}return T},Sc.apply(this,arguments)}var qr=h.map;Ja={init:function(T){T.config.beforeSend.push(function(_){_.stacktrace=qr(_.stacktrace,function(N){return Sc({},N,{file:gd(N.file)})})})}};var gd=Ja._strip=function(T){return typeof T=="string"?T.replace(/\?.*$/,"").replace(/#.*$/,""):T},ql={init:function(T,_){_===void 0&&(_=window);function N(ee,me,ge,$e,He){if(ge===0&&/Script error\.?/.test(ee))T._logger.warn("Ignoring cross-domain or eval script error. See docs: https://tinyurl.com/y94fq5zm");else{var Zt={severity:"error",unhandled:!0,severityReason:{type:"unhandledException"}},yt;if(He)He.name&&He.message?yt=new T.BugsnagReport(He.name,He.message,My(T.BugsnagReport.getStacktrace(He),me,ge,$e),Zt,He):(yt=new T.BugsnagReport("window.onerror",String(He),My(T.BugsnagReport.getStacktrace(He,1),me,ge,$e),Zt,He),yt.updateMetaData("window onerror",{error:He}));else if(typeof ee=="object"&&ee!==null&&(!me||typeof me!="string")&&!ge&&!$e&&!He){var qi=ee.type?"Event: "+ee.type:"window.onerror",qe=ee.message||ee.detail||"";yt=new T.BugsnagReport(qi,qe,T.BugsnagReport.getStacktrace(new Error,1).slice(1),Zt,ee),yt.updateMetaData("window onerror",{event:ee,extraParameters:me})}else yt=new T.BugsnagReport("window.onerror",String(ee),My(T.BugsnagReport.getStacktrace(He,1),me,ge,$e),Zt,ee),yt.updateMetaData("window onerror",{event:ee});T.notify(yt)}typeof $=="function"&&$.apply(this,arguments)}var $=_.onerror;_.onerror=N}},My=function(T,_,N,$){var ee=T[0];return ee&&(!ee.fileName&&typeof _=="string"&&ee.setFileName(_),!ee.lineNumber&&fm(N)&&ee.setLineNumber(N),ee.columnNumber||(fm($)?ee.setColumnNumber($):window.event&&fm(window.event.errorCharacter)&&ee.setColumnNumber(window.event.errorCharacter))),T},fm=function(T){return typeof T=="number"&&String.call(T)!=="NaN"},Ay={},A6=h.reduce,L6;Ay.init=function(T,_){_===void 0&&(_=window);var N=function($){var ee=$.reason,me=!1;try{$.detail&&$.detail.reason&&(ee=$.detail.reason,me=!0)}catch(Zt){}var ge={severity:"error",unhandled:!0,severityReason:{type:"unhandledPromiseRejection"}},$e;if(ee&&Ie(ee))$e=new T.BugsnagReport(ee.name,ee.message,de.parse(ee),ge,ee),me&&($e.stacktrace=A6($e.stacktrace,P6(ee),[]));else{var He='Rejection reason was not an Error. See "Promise" tab for more detail.';$e=new T.BugsnagReport(ee&&ee.name?ee.name:"UnhandledRejection",ee&&ee.message?ee.message:He,[],ge,ee),$e.updateMetaData("promise","rejection reason",O6(ee))}T.notify($e)};"addEventListener"in _?_.addEventListener("unhandledrejection",N):_.onunhandledrejection=function($,ee){N({detail:{reason:$,promise:ee}})},L6=N};var O6=function(T){if(T==null)return"undefined (or null)";if(te(T)){var _;return _={},_[Object.prototype.toString.call(T)]={name:T.name,message:T.message,code:T.code,stack:T.stack},_}else return T},P6=function(T){return function(_,N){return N.file===T.toString()?_:(N.method&&(N.method=N.method.replace(/^\s+/,"")),_.concat(N))}},Ly={};function JI(){return JI=Object.assign||function(T){for(var _=1;_<arguments.length;_++){var N=arguments[_];for(var $ in N)Object.prototype.hasOwnProperty.call(N,$)&&(T[$]=N[$])}return T},JI.apply(this,arguments)}var _6="Bugsnag JavaScript",F6="6.1.0",R6="https://github.com/bugsnag/bugsnag-js",N6=h.map,B6=JI({},C.schema,re);return Ly=function(T){typeof T=="string"&&(T={apiKey:T});var _=[];T.sessionTrackingEnabled&&(_.push("deprecated option sessionTrackingEnabled is now called autoCaptureSessions"),T.autoCaptureSessions=T.sessionTrackingEnabled),(T.endpoint||T.sessionEndpoint)&&!T.endpoints&&(_.push("deprecated options endpoint/sessionEndpoint are now configured in the endpoints object"),T.endpoints={notify:T.endpoint,sessions:T.sessionEndpoint}),T.endpoints&&T.endpoints.notify&&!T.endpoints.sessions&&_.push("notify endpoint is set but sessions endpoint is not. No sessions will be sent.");var N=new ea({name:_6,version:F6,url:R6});return N.setOptions(T),N.delivery(window.XDomainRequest?Ey():nl()),N.configure(B6),N6(_,function($){return N._logger.warn($)}),N.use(al),N.use(YO),N.use(YC),N.use(hp),N.use(ms),N.use(JC),N.use(QC),N.use(Ja),N.config.autoNotify!==!1&&(N.use(ql),N.use(Ay)),N.use(v),N.use(tD),N.use(G),N.use(Rh),N.config.autoCaptureSessions?N.startSession():N},Ly.Bugsnag={Client:ea,Report:fo,Session:Gt,Breadcrumb:A},Ly.default=Ly,Ly})});var P2;function K6(r){P2=r(__dcg_shared_module_exports__['c'])}K6(function(r){function e(){window.consoleOverride=!0;var i=window.console.log;window.console.log=function(){for(var o=[],n=0;n<arguments.length;n++)o.push(arguments[n]);i.apply(window.console,[].concat([o.join(" ")],o))}}var t={ready:function(){try{window.TestBridge=t,parent.USING_SELENIUM&&e()}catch(i){}}};return t});var{ready:_2}=P2;xt();var Dr={};__dcg_shared_module_exports__['g'](Dr,{ALT:()=>y7,BACKSPACE:()=>Hl,CAPSLOCK:()=>x7,CONTROL:()=>b7,DELETE:()=>Bm,DOWN:()=>mn,END:()=>Au,ENTER:()=>fs,ESCAPE:()=>hn,HOME:()=>Lu,LEFT:()=>Cd,PAGEDOWN:()=>Nm,PAGEUP:()=>Rm,RIGHT:()=>Dd,SHIFT:()=>Jy,SPACEBAR:()=>Mu,TAB:()=>hl,UP:()=>gn,default:()=>g7,isBacktick:()=>f7,isHelp:()=>vV,isRedo:()=>Zh,isSelectAll:()=>m7,isSwitchPanes:()=>CV,isUndo:()=>Qh,lookup:()=>Ee,lookupChar:()=>ki});var o_=function(){{var r={IS_IE8:navigator.userAgent.match(/MSIE 8.0/i)!==null,IS_IE9:navigator.userAgent.match(/MSIE 9.0/i)!==null,IS_IE:navigator.userAgent.match(/MSIE/i)!==null||navigator.userAgent.match(/Trident/i)!==null&&navigator.userAgent.match(/rv:11/i)!==null,IS_EDGE:navigator.userAgent.match(/Edge/i)!==null,IS_IPAD:navigator.userAgent.match(/iPad/i)!==null,IS_MOBILE:navigator.userAgent.match(/Mobile|Android/i)!==null,IS_ANDROID:navigator.userAgent.match(/Android/i)!==null,IS_IOS:navigator.userAgent.match(/(iPad|iPhone|iPod)/i)!==null||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,IS_CHROME:navigator.userAgent.match(/Chrome/i)!==null,IS_FIREFOX:navigator.userAgent.match(/Firefox/i)!==null,IS_SAFARI:navigator.userAgent.match(/^((?!chrome|android).)*safari/i)!==null,IS_APPLE:navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i)!==null,IS_WINDOWS:navigator.platform.match(/(Win32)/i)!==null,IS_TOUCH:navigator.userAgent.match(/Touch/i)!==null,IS_KINDLE:navigator.userAgent.match(/Kindle/i)!==null||navigator.userAgent.match(/Silk/i)!==null,IS_BRAILLENOTE:navigator.userAgent.match(/KeyWeb/i)!==null,IS_IN_IFRAME:window.parent!==window};return r.IS_TABLET=r.IS_IPAD||r.IS_ANDROID||r.IS_KINDLE,r.IS_TOUCH_DEVICE=r.SHOULD_NOT_AUTOFOCUS=r.IS_IOS||r.IS_ANDROID||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i),r.IOS_VERSION=function(){var e=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return e?[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||0,10)]:null}(),r.MAC_VERSION=function(){var e=navigator.appVersion.match(/OS X (\d+)_(\d+)_?(\d+)?/);return e?[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||0,10)]:null}(),r.CHROME_VERSION=function(){var e=navigator.appVersion.match(/Chrom(e|ium)\/([0-9]+)\.([0-9]+)\.?([0-9]+)?/);return e?[parseInt(e[2],10),parseInt(e[3],10),parseInt(e[4]||0,10)]:null}(),r.SUPPORTS_INPUTMODE=function(){var e="inputMode"in document.createElement("textarea");return!(!e||r.IS_IOS&&r.IOS_VERSION&&r.IOS_VERSION[0]<15)}(),r.SUPPORTS_CANVAS=function(){var e=document.createElement("canvas"),t=!!(e.getContext&&e.getContext("2d"));return t}(),r.PREFERS_REDUCED_MOTION=function(){return window.matchMedia("(prefers-reduced-motion: reduce)")===!0||window.matchMedia("(prefers-reduced-motion: reduce)").matches===!0||document.location.search.indexOf("prefersReducedMotion")>=0}(),r}}(),n_=o_,{SHOULD_NOT_AUTOFOCUS:Gc,IS_TOUCH_DEVICE:a_,IS_SAFARI:s_,IS_APPLE:oi,IS_IOS:Iu,IS_ANDROID:Vu,IS_IPAD:pl,IS_IN_IFRAME:Ip,IOS_VERSION:Yy,MAC_VERSION:goe,CHROME_VERSION:moe,IS_IE:l_,IS_EDGE:foe,IS_CHROME:c_,IS_FIREFOX:PD,IS_MOBILE:ul,IS_WINDOWS:d_,IS_TOUCH:p_,SUPPORTS_INPUTMODE:_D,SUPPORTS_CANVAS:boe,PREFERS_REDUCED_MOTION:Fm,translateRule:yoe}=o_;var u_=function(){{var r=function(){for(var e={8:this.BACKSPACE="Backspace",9:this.TAB="Tab",13:this.ENTER="Enter",16:this.SHIFT="Shift",17:this.CONTROL="Control",18:this.ALT="Alt",20:this.CAPSLOCK="CapsLock",27:this.ESCAPE="Esc",32:this.SPACEBAR="Space",33:this.PAGEUP="PageUp",34:this.PAGEDOWN="PageDown",35:this.END="End",36:this.HOME="Home",37:this.LEFT="Left",38:this.UP="Up",39:this.RIGHT="Right",40:this.DOWN="Down",46:this.DELETE="Del"},t={Backspace:this.BACKSPACE,Tab:this.TAB,Enter:this.ENTER,Shift:this.SHIFT,Control:this.CONTROL,Alt:this.ALT,CapsLock:this.CAPSLOCK,Escape:this.ESCAPE," ":this.SPACEBAR,PageUp:this.PAGEUP,PageDown:this.PAGEDOWN,End:this.END,Home:this.HOME,ArrowLeft:this.LEFT,ArrowUp:this.UP,ArrowRight:this.RIGHT,ArrowDown:this.DOWN,Delete:this.DELETE},i={UIKeyInputUpArrow:this.UP,UIKeyInputDownArrow:this.DOWN,UIKeyInputLeftArrow:this.LEFT,UIKeyInputRightArrow:this.RIGHT,UIKeyInputEscape:this.ESCAPE,UIKeyInputPageUp:this.PAGEUP,UIKeyInputPageDown:this.PAGEDOWN},o=["0123456789abcdefghijklmnopqrstuvwxyz","\xBA\xA1\u2122\xA3\xA2\u221E\xA7\xB6\u2022\xAA\xE5\u222B\xE7\u2202 \u0192\xA9\u02D9 \u2206\u02DA\xAC\xB5 \xF8\u03C0\u0153\xAE\xDF\u2020 \u221A\u2211\u2248\xA5\u03A9","\u201A\u2044\u20AC\u2039\u203A\uFB01\uFB02\u2021\xB0\xB7\xC5\u0131\xC7\xCE\xB4\xCF\u02DD\xD3\u02C6\xD4\uF8FF\xD2\xC2\u02DC\xD8\u220F\u0152\u2030\xCD\u02C7\xA8\u25CA\u201E\u02DB\xC1\xB8"].map(function(m){return m.split("")}),n=o[0],a=o[1],s=o[2],l={},c={},p=0;p<n.length;p++){var u=n[p];a[p]!==" "&&(l[a[p]]=u.toUpperCase()),s[p]!==" "&&(c[s[p]]=u.toUpperCase())}this.isUndo=function(m){return!m.altKey&&!m.shiftKey&&(m.ctrlKey||m.metaKey)&&(m.key=="z"||m.which==90)},this.isRedo=function(m){return!m.altKey&&(m.ctrlKey||m.metaKey)&&(m.key==="y"||m.which==89||m.shiftKey&&(m.key==="Z"||m.key==="z"||m.which===90))},this.isSelectAll=function(m){return!m.altKey&&(m.ctrlKey||m.metaKey)&&(m.key==="a"||m.key==="A"||m.which==65)},this.isBacktick=function(m){return!m.altKey&&!m.ctrlKey&&!m.metaKey&&!m.shiftKey&&(m.key==="`"||m.which==192)},this.isHelp=function(m){return!m.altKey&&(m.ctrlKey||m.metaKey)&&(m.key==="/"||m.which==191)},this.isSwitchPanes=function(m){return m.key==="F6"||m.key==="f6"||m.which===117||m.keyCode===117},this.lookup=function(m){return t[m.key]||e[m.which]||i[m.key]},this.lookupChar=function(m){if(!m.key)return String.fromCharCode(m.which);if(n_.IS_APPLE&&m.altKey){var h=m.shiftKey?c:l;if(h[m.key])return h[m.key]}if(m.key.length===1)return m.key.toUpperCase();if(m.key==="Enter")return String.fromCharCode(13);if(m.key==="Tab")return String.fromCharCode(9)}};return new r}}(),g7=u_,{isUndo:Qh,isRedo:Zh,isSelectAll:m7,isBacktick:f7,isHelp:vV,isSwitchPanes:CV,BACKSPACE:Hl,TAB:hl,ENTER:fs,SHIFT:Jy,CONTROL:b7,ALT:y7,CAPSLOCK:x7,ESCAPE:hn,SPACEBAR:Mu,PAGEUP:Rm,PAGEDOWN:Nm,END:Au,HOME:Lu,LEFT:Cd,UP:gn,RIGHT:Dd,DOWN:mn,DELETE:Bm,lookup:Ee,lookupChar:ki}=u_;var ao=function(r){if(!r)return;let e=r.getBoundingClientRect();return{top:e.top+window.scrollY,left:e.left+window.scrollX}},oa=function(r,e){Object.assign(r.style,e)};function Vp(r){return!!(r&&(r.offsetWidth||r.offsetHeight||r.getClientRects().length))}function FD(r){if(document.readyState!=="loading")r();else{var e=function(){document.removeEventListener("DOMContentLoaded",e),r()};document.addEventListener("DOMContentLoaded",e)}}var w7=document.location.href.indexOf("dcgDebugTouchTracking=dcgYES")!==-1,Ou,qm;window._touchtracking_id_counter==null&&(window._touchtracking_id_counter=0);window._touchtracking_id_counter+=1;var Qy="touchtracking_id_"+window._touchtracking_id_counter,_o=function(r){qm&&(qm.value="("+Date.now()+") "+r+`
`+qm.value)};function Pu(r){if(r.classList.add("dcg-tap-container",Qy),w7){Ou&&Ou.remove(),Ou=document.createElement("div"),oa(Ou,{position:"absolute",bottom:"10px",right:"10px"});let e=document.createElement("textarea");e.setAttribute("rows","30"),e.setAttribute("cols","40"),Ou.append(e);let t=document.createElement("div");t.id="dcg-touchtracking-debug-copy",t.classList.add("dcg-btn-blue"),t.innerText="COPY LOGS",Ou.append(t),qm=Ou.querySelector("textarea"),r.append(Ou),t.addEventListener("mousedown",function(){qm&&(qm.select(),document.execCommand("copy"))},!0),_o("monitor touches")}}var Um=0,Wl=1,Zy=2,Km=3,Ap=4,Sr=Um,DV={},Tc={},Mp=[],SV=0,Xy=null,ND=null,eg=!1,RD=null,h_=eg,_u=function(r){r.type.startsWith("key")?eg=!0:r.type.startsWith("pointer")&&(eg=!1);let e=document.activeElement;e&&!e.closest(".dcg-tap-container."+Qy)&&(e=null),e!==RD?(RD&&RD.classList.remove("dcg-focus-visible"),e&&eg&&e.classList.add("dcg-focus-visible")):h_!==eg&&e&&(eg?e.classList.add("dcg-focus-visible"):e.classList.remove("dcg-focus-visible")),h_=eg,RD=e};document.addEventListener("keydown",_u,{capture:!0});document.addEventListener("keydown",_u);document.addEventListener("pointerdown",_u);document.addEventListener("pointerdown",_u,{capture:!0});document.addEventListener("focusin",_u,{capture:!0});document.addEventListener("focusin",_u);document.addEventListener("focusout",_u,{capture:!0});document.addEventListener("focusout",_u);var g_,qs=[],kV=function(r){if(!(r instanceof Element))return[];let e=r.closest(".dcg-tap-container."+Qy);if(!e)return[];let t=r,i=[];for(;t;){if(i.push(t),t===e)return i;t=t.parentNode}return[]},BD=function(r,e){ND=null,Sr=r,_o("beginMode:"+Sr),Sr===Wl?Mp=kV(e.originalEvent.touches[0].target):Mp=kV(e.target),Mp.forEach(t=>{t.classList.add("dcg-depressed"),y_(t)&&t.classList.add("dcg-focus-by-tap")}),Mp.forEach(function(t){let i=H(t);i.data({originalScrollTop:i.scrollTop(),originalScrollLeft:i.scrollLeft()})}),Tc={}};function tg(r){return r.matches('input, textarea, select, [role="textbox"]')||r.classList.contains("dcg-mathquill-input-span")||r.matches("[contenteditable=true]")}var Hm=function(r){if(!(r instanceof Element))return!1;let e=r.closest(".dcg-tap-container");return e?e.matches(".dcg-tap-container."+Qy):!1},y_=function(r){return Sr!==Km&&!tg(r)&&Hm(r)},Wm=function(r,e){ND=null;let t=!1;_o("endMode:"+Sr),document.querySelectorAll(".dcg-depressed").forEach(o=>{o.classList.remove("dcg-depressed")});let i=document.activeElement;if(!v_(r.target)&&i&&y_(i))try{i.blur()}catch(o){}if(document.querySelectorAll(".dcg-focus-by-tap").forEach(o=>o.classList.remove("dcg-focus-by-tap")),Mp.forEach(function(o){let n=H(o),a=n.data("originalScrollTop")-n.scrollTop(),s=n.data("originalScrollLeft")-n.scrollLeft();(a||s)&&(Tc.scroll=!0)}),Tc["dcg-tapstart"]===1&&Tc["dcg-tapend"]===1&&!Tc["dcg-tapcancel"]&&!Tc.scroll){_o("potential dcg-tap");let o=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY;if(r&&!r.device&&o===0&&n===0){_o("event appears to be simulated"),t=!0,Sr=Km;let l=r.target.getBoundingClientRect();o=(l.left+l.right)/2,n=(l.top+l.bottom)/2}_o("potential dcg-tap coords:"+o+":"+n);let a=!1,s=!1;for(let l of Mp){if(a)break;let c;if(typeof l.getBoundingClientRect=="function"&&(c=l.getBoundingClientRect()),typeof l.getAttribute=="function"&&l.getAttribute("tapboundary")==="true"&&(a=!0),!(c&&(o<c.left||n<c.top||o>c.right||n>c.bottom))){ND=l,s=!0,bs("dcg-tap",r,{target:ND,touches:e.touches,changedTouches:e.changedTouches});break}}_o("result of dcg-tap:  did_dispatch="+s+"  did_escape="+a)}Sr===Wl||Sr===Ap?Xy=setTimeout(function(){Xy=null,SV=new Date().getTime()},1e3):t&&(Xy=setTimeout(function(){Xy=null,SV=new Date().getTime()},100)),Mp=[],Sr=Um},zm=function(){return Xy||new Date().getTime()-SV<500},x_=function(r){return r.identifier!==void 0?r.identifier:r.pointerId},m_=function(r){let e=[];for(let t of r)e.push({identifier:x_(t),x:t.pageX,y:t.pageY,screenX:t.screenX,screenY:t.screenY,pageX:t.pageX,pageY:t.pageY,clientX:t.clientX,clientY:t.clientY});return e},bs=function(r,e,t){let i=x_(e),o=m_(t.touches),n=m_(t.changedTouches);if(_o("dispatchEvent:"+r),r==="dcg-tapstart")DV[i]={type:r,pageX:n[0].pageX,pageY:n[0].pageY};else if(r==="dcg-tapmove"){let c=n[0],p=DV[i];if(p&&c.pageX===p.pageX&&c.pageY===p.pageY||(Sr===Wl||Sr===Ap)&&p&&p.type==="dcg-tapstart"&&Math.abs(p.pageX-c.pageX)+Math.abs(p.pageY-c.pageY)<2)return;DV[i]={type:r,pageX:n[0].pageX,pageY:n[0].pageY}}let a=r.toLowerCase();Tc[a]===void 0?Tc[a]=1:Tc[a]++;let s=H.event.fix(e.originalEvent);s.type=r,s.device=Sr===Wl||Sr===Ap?"touch":Sr===Km?"keyboard":"mouse",s.touches=o,s.changedTouches=n,s.target=t.target?t.target:e.target;let l=s.device!=="keyboard"&&Tc["dcg-longhold"]>0;s.wasLongheld=function(){return l},s.preventTap=function(){Tc["dcg-tapcancel"]=1},clearTimeout(g_),s.type==="dcg-tapstart"&&s.device!=="keyboard"&&s.touches.length===1&&(g_=setTimeout(function(){bs("dcg-longhold",e,t)},500)),s.target&&s.target.nodeName&&s.target.nodeName.toLowerCase()==="a"&&s.type==="dcg-tap"&&s.device==="keyboard"&&s.target.click&&s.target.click(),_o("trigger event:"+s.type),H(s.target).trigger(s)},qD=function(r){let e=Mp,t=!!Mp.length,i=document.querySelectorAll(".dcg-tap-container."+Qy+" .dcg-hovered"),o=Array.from(i).filter(Hm),n=[],a=[],s=[];r&&kV(r).forEach(function(l){(!t||e.indexOf(l)!==-1)&&(o.indexOf(l)===-1&&s.push(l),n.push(l))});for(let l of o)n.indexOf(l)===-1&&a.push(l);a.forEach(l=>{l&&l.classList.remove("dcg-hovered"),H(l).trigger("tipsyhide")}),s.forEach(l=>{l&&l.classList.add("dcg-hovered"),H(l).trigger("tipsyshow")})},KD=function(r){for(let e of qs)if(e.pointerId===r)return!0;return!1},EV=function(r){for(let e=0;e<qs.length;e++)if(qs[e].pointerId===r){qs.splice(e,1)[0];return}},w_=function(r){Sr===Um&&BD(Ap,r),qD(null),qs.push(r.originalEvent),bs("dcg-tapstart",r,{touches:qs,changedTouches:[r.originalEvent]})},f_=function(r){EV(r.originalEvent.pointerId);let e={touches:qs,changedTouches:[r.originalEvent]};bs("dcg-tapcancel",r,e),qs.length===0&&Wm(r,e)},b_=function(r){EV(r.originalEvent.pointerId);let e={touches:qs,changedTouches:[r.originalEvent]};bs("dcg-tapend",r,e),qs.length===0&&Wm(r,e)},zD=function(r){return r.originalEvent.pointerType==="touch"},$m=function(r,e){r.trim().split(/\s+/).forEach(function(t){let i=v7?{passive:!1}:void 0;document.addEventListener(t,function(o){_o("document.on:"+o.type),e(H.event.fix(o))},i)})};$m("pointerdown MSPointerDown",function(r){if(!(Sr===Zy||Sr===Wl||!zD(r))){if(KD(r.originalEvent.pointerId)){_o("exit. pointer id already exists: "+r.originalEvent.pointerId);return}w_(r)}});$m("pointermove MSPointerMove",function(r){Sr===Zy||Sr===Wl||!zD(r)||(KD(r.originalEvent.pointerId)||(_o("pointer id already exists: "+r.originalEvent.pointerId),w_(r)),EV(r.originalEvent.pointerId),qs.push(r.originalEvent),bs("dcg-tapmove",r,{touches:qs,changedTouches:[r.originalEvent]}))});H(document).on("pointercancel MSPointerCancel",function(r){if(_o("document.on:"+r.type),Sr!==Ap||!zD(r)||!KD(r.originalEvent.pointerId))return;f_(r);let e;for(;e=qs.pop();){let t=H.Event(e,{originalEvent:e});f_(t)}});H(document).on("pointerup MSPointerUp",function(r){if(_o("document.on:"+r.type),Sr!==Ap||!zD(r)||!KD(r.originalEvent.pointerId))return;b_(r);let e;for(;e=qs.pop();){let t=H.Event(e,{originalEvent:e});b_(t)}});var v7=function(){let r=!1;try{let e=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("test",function(){},e),window.removeEventListener("test",function(){},e)}catch(e){}return r}();$m("touchstart",function(r){Sr===Zy||Sr===Ap||(Sr===Um&&BD(Wl,r),qD(null),bs("dcg-tapstart",r,{touches:r.originalEvent.touches,changedTouches:r.originalEvent.changedTouches}))});$m("touchmove",function(r){Sr===Wl&&bs("dcg-tapmove",r,{touches:r.originalEvent.touches,changedTouches:r.originalEvent.changedTouches})});$m("touchcancel",function(r){if(Sr!==Wl)return;let e={touches:r.originalEvent.touches,changedTouches:r.originalEvent.changedTouches};bs("dcg-tapcancel",r,e),r.originalEvent.touches.length===0&&Wm(r,e)});$m("touchend",function(r){if(Sr!==Wl)return;let e={touches:r.originalEvent.touches,changedTouches:r.originalEvent.changedTouches};bs("dcg-tapend",r,e),r.originalEvent.touches.length===0&&Wm(r,e)});H(document).on("mousedown",function(r){if(_o("document.on:"+r.type),!(r.button===1||r.button===2)){if(Sr===Wl||Sr===Ap||zm()){!r.target.matches("input, textarea, select")&&Hm(r.target)&&r.preventDefault(),_o("abort mousedown: "+Sr+":"+zm());return}BD(Zy,r),bs("dcg-tapstart",r,{touches:[r],changedTouches:[r]})}});var v_=function(r){if(!(r instanceof Element))return!1;let e=!!r.closest(".dcg-do-not-blur"),t=!!r.closest(".dcg-do-blur");return!!(e&&!t&&Hm(r))};H(document).on("mousedown",function(r){if(_o("document.on:"+r.type),!!v_(r.target)){r.preventDefault();try{let e=window.getSelection();if(e.rangeCount===1){let t=e.getRangeAt(0);t.startContainer===t.endContainer&&t.startContainer.closest(".dcg-text-selectable")&&e.removeAllRanges()}}catch(e){}}});H(document).on("mouseleave",function(r){if(_o("document.on:"+r.type),Sr===Um){if(zm()){_o("abort mouseleave: "+Sr+":"+zm());return}qD(null)}});H(document).on("mousemove",function(r){if(_o("document.on:"+r.type),!(r.button===1||r.button===2)&&!(Sr===Wl||Sr===Ap)){if(zm()){_o("abort mousemove: "+Sr+":"+zm());return}qD(r.target),bs("dcg-tapmove",r,{touches:[r],changedTouches:[r]})}});H(document).on("mouseup",function(r){if(_o("document.on:"+r.type),r.button===1||r.button===2||Sr!==Zy)return;let e={touches:[],changedTouches:[r]};bs("dcg-tapend",r,e),Wm(r,e)});H(document).on("keydown",function(r){if(_o("document.on:"+r.type),!(Ee(r)!==fs&&Ee(r)!==Mu||!Hm(r.target))&&Sr!==Km){if(r.target.matches('a:not([ontap]), button:not([ontap]), input, textarea, select, [role="textbox"], [contenteditable="true"]'))return;r.preventDefault(),BD(Km,r),bs("dcg-tapstart",r,{touches:[r],changedTouches:[r]})}});H(document).on("keyup",function(r){if(_o("document.on:"+r.type),Ee(r)!==fs&&Ee(r)!==Mu||!Hm(r.target)||Sr!==Km)return;let e={touches:[],changedTouches:[r]};bs("dcg-tapend",r,e),Wm(r,e)});function C_(){return Sr!==Um}var D_=`[
  {
    "hash": "xgzjfcnzpl",
    "parent_hash": null,
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/xgzjfcnzpl.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/xgzjfcnzpl",
    "title": "Perpendicular Bisector",
    "access": "link",
    "created": "Mon, 10 Apr 2023 12:07:41 GMT",
    "i18nKey": "geometry-label-example-construction-perpendicular-bisector",
    "example": true
  },
  {
    "hash": "tvwgdw2p2k",
    "parent_hash": "utqqso12vr",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/tvwgdw2p2k.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/tvwgdw2p2k",
    "title": "Equilateral triangle",
    "access": "link",
    "created": "Fri, 12 May 2023 01:32:09 GMT",
    "i18nKey": "geometry-label-example-construction-equilateral-triangle",
    "example": true
  },
  {
    "hash": "t9ognxlses",
    "parent_hash": "ueuubwvxa7",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/t9ognxlses.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/t9ognxlses",
    "title": "Inscribed Right Triangle",
    "access": "link",
    "created": "Fri, 12 May 2023 01:31:40 GMT",
    "i18nKey": "geometry-label-example-construction-inscribed-triangle",
    "example": true
  },
  {
    "hash": "y8ssoi4tlg",
    "parent_hash": "gsu6149kxi",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/y8ssoi4tlg.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/y8ssoi4tlg",
    "title": "Angles of a quadrilateral",
    "access": "link",
    "created": "Fri, 12 May 2023 01:31:10 GMT",
    "i18nKey": "geometry-label-example-construction-angles-of-quadrilateral",
    "example": true
  },
  {
    "hash": "akkwop6h4u",
    "parent_hash": "z7iuegt8w1",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/akkwop6h4u.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/akkwop6h4u",
    "title": "Two Reflections",
    "access": "link",
    "created": "Fri, 12 May 2023 01:15:57 GMT",
    "i18nKey": "geometry-label-example-construction-two-reflections",
    "example": true
  },
  {
    "hash": "b0vy5ha5gm",
    "parent_hash": "p4qkho6ty4",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/b0vy5ha5gm.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/b0vy5ha5gm",
    "title": "Rotating a triangle",
    "access": "link",
    "created": "Fri, 12 May 2023 01:33:01 GMT",
    "i18nKey": "geometry-label-example-construction-rotation-with-slider",
    "example": true
  },
  {
    "hash": "8nrcwj07pb",
    "parent_hash": "jfrjmiapzf",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/8nrcwj07pb.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/8nrcwj07pb",
    "title": "Rotation pinwheel",
    "access": "link",
    "created": "Fri, 12 May 2023 01:30:43 GMT",
    "i18nKey": "geometry-label-example-construction-pinwheel",
    "example": true
  },
  {
    "hash": "yeql8gqrwk",
    "parent_hash": "mfi2yi7qeg",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/yeql8gqrwk.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/yeql8gqrwk",
    "title": "Rainbow pinwheel",
    "access": "link",
    "created": "Fri, 12 May 2023 01:30:13 GMT",
    "i18nKey": "geometry-label-example-construction-rainbow-pinwheel",
    "example": true
  },
  {
    "hash": "hcedd3i9ql",
    "parent_hash": "0cioxhhukl",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/hcedd3i9ql.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/hcedd3i9ql",
    "title": "Triangle Perimeter and Area - Slider",
    "access": "link",
    "created": "Sat, 29 Apr 2023 21:47:20 GMT",
    "i18nKey": "geometry-label-example-construction-triangle-area-and-perimeter",
    "example": true
  },
  {
    "hash": "ccdpnbozkd",
    "parent_hash": "xmitip8xjp",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/ccdpnbozkd.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/ccdpnbozkd",
    "title": "30-60-90 animation",
    "access": "link",
    "created": "Thu, 11 May 2023 05:45:14 GMT",
    "i18nKey": "geometry-label-example-construction-30-60-90",
    "example": true
  },
  {
    "hash": "102alj1jxy",
    "parent_hash": null,
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/102alj1jxy.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/102alj1jxy",
    "title": "String Art",
    "access": "link",
    "created": "Mon, 10 Apr 2023 12:06:06 GMT",
    "i18nKey": "geometry-label-example-construction-string-art",
    "example": true
  },
  {
    "hash": "tqqv9uunwu",
    "parent_hash": "n5fmcg0nyj",
    "thumbUrl": "https://www.desmos.com/calc_thumbs/production/tqqv9uunwu.png",
    "stateUrl": "https://www.desmos.com/calc-states/production/tqqv9uunwu",
    "title": "The Euler Line",
    "access": "link",
    "created": "Thu, 11 May 2023 01:00:12 GMT",
    "i18nKey": "geometry-label-example-construction-euler-line",
    "example": true
  }
]
`;function D7(r){typeof r.min=="number"&&(r.min=""+r.min),typeof r.max=="number"&&(r.max=""+r.max),typeof r.step=="number"&&(r.step=""+r.step)}function S7(r){r.slider&&D7(r.slider),typeof r.id!="string"&&(r.id=""+r.id)}function k7(r){let e=E7(r)+1,t={},i,o;for(let n of r)if(S7(n),n.type==="folder")i=n.id,t[n.id]&&(n.id=""+e,e+=1),o=n.id,t[n.id]=!0,n.hasOwnProperty("folderId")&&delete n.folderId;else{if(i!==void 0&&n.folderId===i?n.folderId=o:(n.folderId&&(n.folderId=""),i=void 0,o=void 0),n.type==="table"&&Array.isArray(n.columns))for(let a of n.columns)t[a.id]&&(a.id=""+e,e+=1),t[a.id]=!0;t[n.id]&&(n.id=""+e,e+=1),t[n.id]=!0}}function S_(r,e){let t=parseFloat(e);return t!==Math.floor(t)?r:Math.max(r,t)}function E7(r){let e=0;for(let t of r)if(e=S_(e,t.id),t.type==="table"&&Array.isArray(t.column))for(let i of t.columns)S_(e,i.id);return e}function UD(r){let e=__dcg_shared_module_exports__['j'](r);return Array.isArray(e.expressions.list)&&k7(e.expressions.list),e}var GV={NONE:"NONE",POSITIVE:"POSITIVE",BOTH:"BOTH"},G7={expression:!0,table:!0,image:!0,folder:!0,text:!0};function T7(r){if(r.type){if(G7.hasOwnProperty(r.type))return r.type;throw new Error("Invalid item type: '"+r.type+"'.")}return r.text!==void 0?"text":r.columns!==void 0||r.headings!==void 0?"table":"expression"}function HD(r){return r.replace(/\\(total|length|mean|median|quantile|stdev|stddev|stdDev|stdevp|stddevp|stdDevP|var|variance|cov|corr|ceil|floor|round|abs|mod|lcm|mcm|mcd|nCr|nPr|signum|sign|arcsinh|arccosh|arctanh|arccsch|arcsech|arccoth|arccsc|arcsec|arccot)/g,"\\operatorname{$1}")}function I7(r){var e={};for(var t in r)r.hasOwnProperty(t)&&(t==="latex"?e[t]=HD(r[t]):t==="values"?e[t]=r[t].map(HD):e[t]=r[t]);return e}function V7(r){var e=T7(r),t={},i;switch(e){case"expression":for(i in r)r.hasOwnProperty(i)&&(i==="latex"?t[i]=HD(r[i]):t[i]=r[i]);return t.type=e,t;case"table":for(i in r)r.hasOwnProperty(i)&&(i==="columns"?t[i]=r[i].map(I7):t[i]=r[i]);return t.type=e,t;case"image":for(i in r)r.hasOwnProperty(i)&&(i==="width"||i==="height"||i==="x"||i==="y"?t[i]=HD(r[i]):t[i]=r[i]);return t.type=e,t;case"text":case"folder":for(i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);return t.type=e,t}}var k_={none:GV.NONE,both:GV.BOTH,positive:GV.POSITIVE};function M7(r){var e={};for(var t in r)r.hasOwnProperty(t)&&(t==="xAxisArrows"||t==="yAxisArrows"||(e[t]=r[t]));return e.xAxisArrowMode=k_[r.xAxisArrows||"none"],e.yAxisArrowMode=k_[r.yAxisArrows||"none"],e}function E_(r){if(r.version)throw new Error("Unexpected version: "+r.version);var e={};return e.graph=M7(r.graph),e.expressions={list:r.expressions.list.map(V7)},e.version=0,e}var A7=1;function WD(r){return r.replace(/\\(sech|csch)/g,"\\operatorname{$1}")}function L7(r){var e={};for(var t in r)r.hasOwnProperty(t)&&(t==="latex"?e[t]=WD(r[t]):t==="values"?e[t]=r[t].map(WD):e[t]=r[t]);return e}function O7(r){var e=r.type,t={},i;switch(e){case"expression":for(i in r)r.hasOwnProperty(i)&&(i==="latex"?t[i]=WD(r[i]):t[i]=r[i]);return t;case"table":for(i in r)r.hasOwnProperty(i)&&(i==="columns"?t[i]=r[i].map(L7):t[i]=r[i]);return t;case"image":for(i in r)r.hasOwnProperty(i)&&(i==="width"||i==="height"||i==="x"||i==="y"?t[i]=WD(r[i]):t[i]=r[i]);return t;case"text":case"folder":for(i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);return t;default:throw new Error("Unexpected expression type: "+e)}}function G_(r){if(r.version)throw new Error("Unexpected version: "+r.version);var e={};return e.graph=r.graph,e.expressions={list:r.expressions.list.map(O7)},e.version=A7,e}var P7=2,_7="#C0504D",F7="#4F81BD",R7="#9BBB59",N7="#8064A2",B7="#F79646",q7="#000000";function T_(r){switch(r){case _7:return __dcg_shared_module_exports__['o'].RED;case F7:return __dcg_shared_module_exports__['o'].BLUE;case R7:return __dcg_shared_module_exports__['o'].GREEN;case N7:return __dcg_shared_module_exports__['o'].PURPLE;case B7:return __dcg_shared_module_exports__['o'].ORANGE;case q7:return __dcg_shared_module_exports__['o'].BLACK;default:return r}}function K7(r){var e={};for(var t in r)r.hasOwnProperty(t)&&(t==="color"?e[t]=T_(r[t]):e[t]=r[t]);return e}function z7(r){var e=r.type,t={},i;switch(e){case"expression":for(i in r)r.hasOwnProperty(i)&&(i==="color"?t[i]=T_(r[i]):t[i]=r[i]);return t;case"table":for(i in r)r.hasOwnProperty(i)&&(i==="columns"?t[i]=r[i].map(K7):t[i]=r[i]);return t;case"image":case"text":case"folder":for(i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);return t;default:throw new Error("Unexpected expression type: "+e)}}function I_(r){if(r.version>1)throw new Error("Unexpected version: "+r.version);var e={};return e.graph=r.graph,e.expressions={list:r.expressions.list.map(z7)},e.version=P7,e}var U7=3;function TV(r){if(typeof r=="string")return r;if(r===void 0)return"";var e=r+"";return e=e.replace(/1e\+?([-\d]+)/,"10^{$1}"),e=e.replace(/([-\d\.]+)e\+?([-\d]+)/,"$1\\cdot 10^{$2}"),e}function H7(r){var e=r.type,t={},i;switch(e){case"expression":for(i in r)r.hasOwnProperty(i)&&(i==="sliderMax"||i==="sliderMin"||i==="sliderInterval"?t[i]=TV(r[i]):i==="domain"?t[i]={max:TV(r[i].max),min:TV(r[i].min)}:t[i]=r[i]);return t.hasOwnProperty("sliderMin")&&t.sliderInterval===void 0&&(t.sliderInterval=""),t;case"image":case"table":case"text":case"folder":for(i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);return t;default:throw new Error("Unexpected expression type: "+e)}}function V_(r){if(r.version>2)throw new Error("Unexpected version: "+r.version);var e={};return e.graph=r.graph,e.expressions={list:r.expressions.list.map(H7)},e.version=U7,e}var W7=4;function M_(r){switch(r){case"point":return"POINT";case"cross":return"CROSS";case"open":return"OPEN";case"normal":return"SOLID";case"dashed":return"DASHED";case"dotted":return"DOTTED";default:return r}}function $7(r){var e={};for(var t in r)r.hasOwnProperty(t)&&(t==="style"?e[t]=M_(r[t]):e[t]=r[t]);return e}function j7(r){var e=r.type,t={},i;switch(e){case"expression":for(i in r)r.hasOwnProperty(i)&&(i==="style"?t[i]=M_(r[i]):t[i]=r[i]);return t;case"table":for(i in r)r.hasOwnProperty(i)&&(i==="columns"?t[i]=r[i].map($7):t[i]=r[i]);return t;case"image":case"text":case"folder":for(i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);return t;default:throw new Error("Unexpected expression type: "+e)}}function A_(r){if(r.version!==3)throw new Error("Unexpected version: "+r.version);var e={};return e.graph=r.graph,e.expressions={list:r.expressions.list.map(j7)},e.version=W7,e}function Y7(r){var e={},t;for(var i in r)if(r.hasOwnProperty(i))switch(t=r[i],i){case"showAxes":e.showXAxis=t,e.showYAxis=t;break;case"showLabels":e.xAxisNumbers=t,e.yAxisNumbers=t,e.polarNumbers=t;break;case"labelXMode":e.xAxisStep=t==="pi"?Math.PI:0;break;case"labelYMode":e.yAxisStep=t==="pi"?Math.PI:0;break;default:e[i]=t}return e}function J7(r){var e={};for(var t in r)r.hasOwnProperty(t)&&(t==="showPoints"||t==="showLine"||(e[t]=r[t]));return(r.showPoints!==void 0||r.showLine!==void 0)&&(r.showPoints&&r.showLine?e.columnMode="POINTS_AND_LINES":r.showPoints?e.columnMode="POINTS":r.showLine?e.columnMode="LINES":(e.hidden=!0,e.columnMode="POINTS")),e}function X7(r){var e=r.type,t={},i;switch(e){case"expression":r.hidden===void 0?r.hasOwnProperty("graphed")?t.hidden=!r.graphed:r.hasOwnProperty("userRequestedGraphing")?t.hidden=r.userRequestedGraphing==="never":t.hidden=!1:t.hidden=r.hidden;for(i in r)if(r.hasOwnProperty(i)&&!(i==="graphed"||i==="userRequestedGraphing"||i==="hidden")&&i!=="slider"){if(i==="color"){typeof r.color=="object"?t.color=r.color.value:t.color=r.color;continue}if(i==="style"){t.style=r.style==="normal"?"SOLID":r.style;continue}if(i==="sliderInterval"){t.sliderInterval=r.sliderInterval==="undefined"?"":r.sliderInterval;continue}t[i]=r[i]}return t;case"table":if(r.headings||r.columns){var o=r.headings?r.headings:r.columns;if(t.columns=o.map(J7),r.rows)for(var n=0;n<t.columns.length;n++){var a=t.columns[n];a.values=[];for(var s=0;s<r.rows.length;s++)a.values.push(r.rows[s][n])}}for(i in r)r.hasOwnProperty(i)&&(i==="rows"||i==="headings"||i==="columns"||(t[i]=r[i]));return t;case"image":case"text":case"folder":for(i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);return t;default:throw new Error("Unexpected expression type: "+e)}}function L_(r){if(r.version!==4)throw new Error("Unexpected version: "+r.version);var e={version:5,graph:Y7(r.graph),expressions:{list:r.expressions.list.map(X7)}};return e}function gi(r,e){var t=/^\s*(\-|\+)?([0-9]+(\.[0-9]+)?)\s*$/;if(t.test(r))return parseFloat(r);var i=Object.create(__dcg_shared_module_exports__['mb']);return i.trigAngleMultiplier=new __dcg_shared_module_exports__['ab'](e?Math.PI/180:1),+__dcg_shared_module_exports__['lc'](r).tryGetConcreteTree(__dcg_shared_module_exports__['nb'],i).asValue()}var Z7=6;function eH(r){return r.length<2?!1:r[0]==="`"&&r[r.length-1]==="`"}function tH(r){if(eH(r))return{raw:r,parts:[r]};for(var e=["[a-zA-Z][0-9]*","[a-zA-Z]_[a-zA-Z0-9]+","[a-zA-Z]_\\{[a-zA-Z0-9]+\\}"],t="({"+e.join("})|({")+"})",i=new RegExp(t,"g"),o=[],n=0,a=0,s;s=i.exec(r);){a=s.index,a>n&&o.push(r.substr(n,a-n));var l=s[0],c=l.replace(/[{}\$]/g,"").replace(/^([a-zA-Z])([0-9]+)$/,"$1_$2");o.push({symbol:c,str:l}),n=s.index+l.length}return n<r.length&&o.push(r.substr(n)),{raw:r,parts:o}}function rH(r){var e={};for(var t in r)if(r.hasOwnProperty(t)&&t!=="style")if(t==="values"&&(e[t]=r[t].map(function(i){return i?""+i:""})),t==="columnMode"&&!r.hasOwnProperty("points")&&!r.hasOwnProperty("lines"))switch(r[t]){case"LINES":e.points=!1,e.lines=!0;break;case"POINTS_AND_LINES":e.points=!0,e.lines=!0;break;default:e.points=!0,e.lines=!1}else e[t]=r[t];return e.hasOwnProperty("pointStyle")||(e.pointStyle="POINT"),e.hasOwnProperty("lineStyle")||(e.lineStyle="SOLID"),e.id=""+e.id,e}var O_={sliderMin:"min",sliderMax:"max",sliderInterval:"step",sliderHardMin:"hardMin",sliderHardMax:"hardMax",sliderAnimationPeriod:"animationPeriod",sliderLoopMode:"loopMode",sliderPlayDirection:"playDirection",sliderIsPlaying:"isPlaying"};function iH(r){var e=tH(r),t="";return __dcg_shared_module_exports__['r'](e.parts,function(i){t+=typeof i=="object"&&i.str?"$"+i.str:i}),t}function oH(r,e){var t=r.latex.split("=");if(t.length===2){var i=gi(t[1],e);if(isFinite(i)){var o=r.slider.hardMin?gi(r.slider.min||"-10",e):void 0,n=r.slider.hardMax?gi(r.slider.max||"10",e):void 0,a=r.slider.step?gi(r.slider.step,e):void 0,s=__dcg_shared_module_exports__['X']({target:i,step:a,hardMin:o,hardMax:n});s.min||(delete r.slider.hardMin,delete r.slider.min),s.max||(delete r.slider.hardMax,delete r.slider.max),s.step||delete r.slider.step}}}function nH(r,e,t,i){var o=r.type,n={},a;switch(o){case"folder":for(a in r)r.hasOwnProperty(a)&&(a==="memberIds"||(n[a]=r[a]));break;case"expression":for(a in r)if(r.hasOwnProperty(a)){if(a==="style"&&!r.hasOwnProperty("pointStyle")&&!r.hasOwnProperty("lineStyle")){var s=r[a];__dcg_shared_module_exports__['w'](["POINT","OPEN","CROSS"],s)?(n.pointStyle=s,n.lineStyle="SOLID"):__dcg_shared_module_exports__['w'](["SOLID","DASHED","DOTTED"],s)?(n.pointStyle="POINT",n.lineStyle=s):(n.pointStyle="POINT",n.lineStyle="SOLID");continue}O_.hasOwnProperty(a)?(n.slider=n.slider||{},n.slider[O_[a]]=r[a]):n[a]=r[a],r.label&&(n.label=iH(r.label))}n.latex&&n.slider&&!n.slider.isPlaying&&oH(n,i),n.hasOwnProperty("fillOpacity")||(n.fillOpacity=.4),n.label===!1&&(n.label=""),n.labelSize||(n.labelSize="medium"),n.labelOrientation||(n.labelOrientation="default"),n.verticalLabel||(n.verticalLabel=!1),n.interactiveLabel||(n.interactiveLabel=!1);break;case"image":for(a in r)!r.hasOwnProperty(a)||a==="x"||a==="y"||(n[a]=r[a]);n.center="\\left("+(r.x||"0")+","+(r.y||"0")+"\\right)",n.angle=r.angle||"0",n.foreground=!!n.foreground;break;case"text":for(a in r)r.hasOwnProperty(a)&&(n[a]=r[a]);break;case"table":for(a in r)r.hasOwnProperty(a)&&(a==="columns"?n[a]=r[a].map(rH):n[a]=r[a]);break;default:throw new Error("Unexpected expression type: "+o)}if(n.id=""+n.id,r.type==="folder")e.folderId=n.id,e.memberIds=r.memberIds,n.folderId="";else{var l=t[n.id];e.memberIds&&e.memberIds[l]?n.folderId=e.folderId:(n.folderId="",e.folderId=void 0,e.memberIds=void 0)}return n}function aH(r){for(var e=0,t=/^[0-9]+$/,i=r.length-1;i>=0;i--){var o=r[i],n=o.id,a;if(t.test(n)&&(a=parseInt(n,10),a>e&&(e=a)),o.type==="table"&&o.columns)for(var s=o.columns.length-1;s>=0;s--)n=o.columns[s].id,t.test(n)&&(a=parseInt(n,10),a>e&&(e=a))}return e+1}function P_(r){if(r.version!==5)throw new Error("Unexpected version: "+r.version);var e=!!(r.graph&&r.graph.degreeMode),t=r.expressions.list,i=-1,o={},n={},a={};return{version:Z7,graph:r.graph,expressions:{list:t.map(function(l){return o[l.id]?(i===-1&&(i=aH(t)),n[i]=l.id,l=__dcg_shared_module_exports__['j'](l),l.id=i+"",i+=1):n[l.id]=l.id,o[l.id]=!0,nH(l,a,n,e)})}}}function IV(r){if(r.version!==6)throw new Error(`Unexpected version: ${r.version}`);let e=r.expressions.list.map(t=>{if(t.type==="expression"&&t.domain){let i=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{parametricDomain:{min:t.domain.min,max:t.domain.max}});return delete i.domain,i}return t});return{version:7,randomSeed:r.randomSeed,graph:r.graph,expressions:{list:e}}}function sH(r){return r.length===1?`0${r}`:r}function Sd(){let r=new Uint8Array(16);if(typeof crypto!="undefined")crypto.getRandomValues(r);else if(typeof msCrypto!="undefined")msCrypto.getRandomValues(r);else return __dcg_shared_module_exports__['rb'](Date.now().toString()+Math.random().toString());return Array.prototype.slice.call(r).map(t=>sH(t.toString(16))).join("")}function VV(r){let e=r.split("_");return e.length===2&&e[1]&&e[1].length===1?e[0]+"_{"+e[1]+"}":r}function __(r){return r=__dcg_shared_module_exports__['j'](r),!r.rules&&(r.assignment||r.expression)&&(r.rules=[{id:"1",assignment:r.assignment||"",expression:r.expression||""}]),delete r.assignment,delete r.expression,r}function ex(r){let e=/\\operatorname(?:\{stdev\}p|\{stddev\}p|\{stdDev\}P|\{var\}iance)/g;return r.replace(e,t=>{switch(t){case"\\operatorname{stdev}p":return"\\operatorname{stdevp}";case"\\operatorname{stddev}p":return"\\operatorname{stddevp}";case"\\operatorname{stdDev}P":return"\\operatorname{stdDevP}";case"\\operatorname{var}iance":return"\\operatorname{variance}";default:return""}})}function lH(r){return r.columns?__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{columns:r.columns.map(cH)}):r}function cH(r){let{latex:e,values:t}=r,i=__dcg_shared_module_exports__['a']({},r);return e&&(i.latex=ex(e),i.latex=VV(i.latex)),t&&(i.values=t.map(function(o){return o?ex(o):""})),i}function MV(r){if(r.version!==7)throw new Error(`Unexpected version: ${r.version}`);let e=r.expressions.list.map(t=>{if(t.type==="image"){let i=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{opacity:""});t.hasOwnProperty("stringOpacity")?i.opacity=t.stringOpacity:t.hasOwnProperty("opacity")?i.opacity=t.opacity+"":delete i.opacity,t.clickableInfo&&(i.clickableInfo=__(t.clickableInfo)),delete i.stringOpacity;for(let o in t)if(o==="x"||o==="y"||o==="width"||o==="height"){let n=t[o];n&&(i[o]=ex(n))}return i}else if(t.type==="expression"){let i=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{fillOpacity:"",lineStyle:"SOLID"});if(t.lineStyle==="SINGLE_PIXEL"?i.lineWidth="1":t.hasOwnProperty("lineStyle")?i.lineStyle=t.lineStyle:delete i.lineStyle,i.hasOwnProperty("lineWidth")||(i.lineWidth=""),i.hasOwnProperty("lineOpacity")||(i.lineOpacity=""),i.hasOwnProperty("pointOpacity")||(i.pointOpacity=""),i.hasOwnProperty("pointSize")||(i.pointSize=""),i.hasOwnProperty("colorLatex")||(i.colorLatex=""),typeof t.latex=="string"&&(i.latex=ex(t.latex)),t.latex&&(i.latex=ex(t.latex)),t.hasOwnProperty("stringFillOpacity")?i.fillOpacity=t.stringFillOpacity:t.hasOwnProperty("fillOpacity")?i.fillOpacity=t.fillOpacity+"":delete i.fillOpacity,i.slider&&t.slider&&t.slider.newLoopMode&&(i.slider=__dcg_shared_module_exports__['j'](i.slider),i.slider.loopMode=t.slider.newLoopMode,delete i.slider.newLoopMode),i.residualVariable&&(i.residualVariable=VV(i.residualVariable)),i.regressionParameters){i.regressionParameters={};for(let o in t.regressionParameters){let n=VV(o),a=t.regressionParameters[o];i.regressionParameters[n]=a}}return t.clickableInfo&&(i.clickableInfo=__(t.clickableInfo)),i}else if(t.type==="table")return lH(t);return t});return{version:8,randomSeed:r.randomSeed||Sd(),graph:r.graph,expressions:{list:e}}}var Jm={handlerLatex:"",minStepLatex:"",open:!1,playing:!1};function F_(r){return __dcg_shared_module_exports__['Tc'](Jm,r)}function R_(r){return __dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},Jm),r)}function dH(r,e,t){if(r.verticalLabel)switch(delete e.verticalLabel,t?e.labelAngle="90":e.labelAngle="\\frac{\\pi}{2}",r.labelOrientation){case"above":e.labelOrientation="right";break;case"below":e.labelOrientation="left";break;case"left":e.labelOrientation="above";break;case"right":e.labelOrientation="below";break}r.extendedLabelOrientation&&(e.labelOrientation=r.extendedLabelOrientation,delete e.extendedLabelOrientation)}function pH(r,e){if(r.vizProps)switch(r.vizProps.dotplotSize){case"small":e.pointSize="9";break;case"large":e.pointSize="20";break}if(r.vizProps){let t=__dcg_shared_module_exports__['a']({},r.vizProps);delete t.dotplotSize,Object.keys(t).length?e.vizProps=t:delete e.vizProps}}function AV(r){return r.filter(({assignment:e,expression:t})=>!!e&&!!t)}function LV(r){return r.map(({assignment:e,expression:t})=>`${e}\\to ${t}`).join(",")||""}function OV(r){let e=JSON.stringify(r),t=/_(\d)|_\{(\d+)\}/g,i,o={};for(;(i=t.exec(e))!==null;){let n=i[1]!==void 0?i[1]:i[2];o[n]=!0}return o}function PV(r,e){for(let t=e+1;;t++)if(!r[t])return t}function N_(r){let e=JSON.stringify(r),t=/"(\d+)"/g,i,o={};for(;(i=t.exec(e))!==null;){let n=i[1]!==void 0?i[1]:i[2];o[n]=!0}return o}function B_(r,e){for(let t=e+1;;t++)if(!r[t])return t}function uH(r){if(/^\d+$/.test(r)){let e=parseInt(r,10);return e===0?"\\infty":""+Math.round(1e3/e)}else return`\\frac{1000}{${r}}`}function hH(r,e){let t={handlerLatex:r,playing:!0,open:!0};return e!==void 0&&(t.minStepLatex=uH(e)),t}function _V(r){if(r.version!==8)throw new Error(`Unexpected version: ${r.version}`);var e=!1;r.graph&&r.graph.degreeMode&&(e=!0);let t=r.expressions.ticker||Jm,i=0,o,n=0,a,s=[];for(let p of r.expressions.list)switch(p.type){case"expression":{let u=__dcg_shared_module_exports__['a']({},p);dH(p,u,e),pH(p,u);let m;if(p.clickableInfo&&p.clickableInfo.rules){let l=p.clickableInfo,{rules:h}=l,C=__dcg_shared_module_exports__['d'](l,["rules"]),D=AV(h),k=LV(D);if(D.length>1){o||(o=OV(r)),i=PV(o,i),a||(a=N_(r)),n=B_(a,n);let M=`A_{${i}}`;C.latex=M,m={type:"expression",id:""+n,latex:`${M}=${k}`},p.folderId!==void 0&&(m.folderId=p.folderId)}else C.latex=k;u.clickableInfo=C}u.clickableInfo&&u.clickableInfo.enabled&&u.hidden&&(u.clickableInfo.enabled=!1),s.push(u),m&&s.push(m);break}case"image":{if(p.clickableInfo&&p.clickableInfo.rules){let u=__dcg_shared_module_exports__['a']({},p),c=p.clickableInfo,{rules:m}=c,x=__dcg_shared_module_exports__['d'](c,["rules"]),C=AV(m),D=LV(C),k;if(C.length>1){o||(o=OV(r)),i=PV(o,i),a||(a=N_(r)),n=B_(a,n);let M=`A_{${i}}`;x.latex=M,k={type:"expression",id:""+n,latex:`${M}=${D}`},p.folderId!==void 0&&(k.folderId=p.folderId)}else x.latex=D;u.clickableInfo=x,s.push(u),k&&s.push(k)}else s.push(p);break}case"simulation":{let u;if(p.clickableInfo&&p.clickableInfo.rules){let h=AV(p.clickableInfo.rules);u=LV(h)}else u="";if(p.isPlaying&&u!==""){o||(o=OV(r)),i=PV(o,i);let h=`A_{${i}}`;u=`${h}=${u}`,t=hH(h,p.fps)}let m={type:"expression",id:p.id,latex:u};p.folderId!==void 0&&(m.folderId=p.folderId),s.push(m);break}default:s.push(p);break}return{version:9,randomSeed:r.randomSeed||Sd(),graph:r.graph,expressions:{list:s,ticker:t}}}function gH(r){return r.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")}function mH(r){return r.replace(/\\\\right\\(\\*[})\]|])/g,".*\\\\right\\$1").replace(/ ?\\([}\]])/g,".*\\$1")}function z_(r){let e=mH(gH(r));return new RegExp(e)}function fH(r){switch(r.type){case"TokenNode":case"Letter":return!0;case"OperatorName":{for(let e of r.arg.args)if(e.type!=="Letter")return!1;return!0}case"Cmd":{let e=__dcg_shared_module_exports__['ic'][r.val];return e===void 0?!0:e==="Ln"||e==="Log"||e==="Trig"}default:return!1}}function FV(r){let e;try{e=__dcg_shared_module_exports__['ec'](r)}catch(o){return}if(e.args.length===0||e.args.length>2)return;let t=e.args[0];if(!fH(t))return;let i;if(e.args.length>1){let o=e.args[1];if(o.type!=="SupSub")return;let{sup:n,sub:a}=o;if(n!==void 0||a===void 0)return;for(let s of a.args)if(s.type!=="Letter"&&s.type!=="Digit")return;i=a}return{base:t,subscript:i}}function ys(r){return FV(r)!==void 0}function U_(r){let e=__dcg_shared_module_exports__['ec'](r),t=__dcg_shared_module_exports__['kc'](e);switch(t.type){case"Letter":return t.val;case"Cmd":return t.val;default:return}}function q_(r){return r.replace(/^(\\? )+|(\\? )+$/g,"")}function H_(r){try{let e=__dcg_shared_module_exports__['ec'](r),t=__dcg_shared_module_exports__['kc'](e);if(t.type==="Equals"&&(t=t.args[1]),t.type==="Call"){let i=t.args[1];return i.type==="Seq"?i.args:[i]}return}catch(e){return}}function rx(r){let e=r.indexOf("=");if(e===-1)return;let t=q_(r.slice(0,e));if(ys(t))return t;try{let i=__dcg_shared_module_exports__['ec'](`${t}=0`),o=__dcg_shared_module_exports__['kc'](i);if(o.type==="Equals"&&__dcg_shared_module_exports__['jc'](o.args[0])){let n=r.indexOf("\\left(");if(n===-1&&(n=r.indexOf("(")),n===-1)return;let a=q_(r.slice(0,n));if(ys(a))return a}}catch(i){}}function Xm(r,e){let t=FV(e);if(t===void 0)return[];let i=[],o;try{o=__dcg_shared_module_exports__['ec'](r)}catch(n){return i}return tx(o,t,i,{wrapInBraces:!1}),i}function Ic(r,e){return Xm(r,e).length!==0}function $D(r,e,t){return FV(t)===void 0?r:RV(r,e,t)}function RV(r,e,t){let i=Xm(r,e);if(i.length===0)return r;let o="",n=0;for(let a of i){if(o+=r.slice(n,a.base.start),a.wrapInBraces&&(o+="{"),o+=t,n=a.base.end,a.subscript){let s=0,l=0;for(let c=a.subscript.start;c>=0;c--)if(r[c]==="{"&&(s+=1),r[c]==="_"){l=c;break}o+=r.slice(n,l),n=a.subscript.end;for(let c=a.subscript.end;c<r.length&&!(s<=0);c++)r[c]==="}"&&(s-=1,n=c+1)}a.wrapInBraces&&(o+="}")}return o+=r.slice(n,r.length),o}function K_(r,e){if(r.args.length!==e.args.length)return!1;for(let t=0;t<r.args.length;t++){let i=r.args[t],o=e.args[t];if(!(i.type==="Letter"&&o.type==="Letter"&&i.val===o.val)&&!(i.type==="Digit"&&o.type==="Digit"&&i.val===o.val))return!1}return!0}function bH(r,e,t){let i=r.arg.args,o=e.arg.args;if(i.length===o.length){for(let n=0;n<i.length;n++){let a=i[n],s=o[n];if(a.type!=="Digit"||a.type!==s.type||a.val!==s.val)return}t.push({base:e.span,wrapInBraces:!1})}}function tx(r,e,t,{wrapInBraces:i}){let{base:o,subscript:n}=e;for(let a=0;a<r.args.length;a++){let s=r.args[a],l;if(a+1<r.args.length){let c=r.args[a+1];c.type==="SupSub"&&c.sub!==void 0&&(l=c.sub)}switch(s.type){case"Letter":case"Cmd":if(o.type!==s.type||o.val!==s.val)break;n&&l&&K_(n,l)?t.push({base:s.span,subscript:l.span,wrapInBraces:i}):!n&&!l&&t.push({base:s.span,wrapInBraces:i});break;case"OperatorName":{if(o.type!==s.type||o.arg.args.length!==s.arg.args.length)break;let c=!0;for(let p=0;p<o.arg.args.length;p++){let u=o.arg.args[p],m=s.arg.args[p];if(u.type!=="Letter"||m.type!=="Letter"||u.val!==m.val){c=!1;break}}if(!c)break;n&&l&&K_(n,l)?t.push({base:s.span,subscript:l.span,wrapInBraces:i}):!n&&!l&&t.push({base:s.span,wrapInBraces:i});break}case"Digit":case"Symbol":case"EscapedSymbol":break;case"LeftRight":case"Sqrt":tx(s.arg,e,t,{wrapInBraces:!1});break;case"Frac":tx(s.num,e,t,{wrapInBraces:!1}),tx(s.den,e,t,{wrapInBraces:!1});break;case"SupSub":if(s.sup){let c=!1;for(let p=s.sup.span.start;p>=0;p--){let u=s.sup.span.input[p];if(u==="^")break;u==="{"&&(c=!0)}tx(s.sup,e,t,{wrapInBraces:!c})}break;case"TokenNode":{if(o.type!==s.type)break;bH(o,s,t)}break;default:{let c=s;throw new Error("Unexpected token type: "+c.type)}}}}function W_(r){r.clickableInfo&&(r.description===void 0&&r.clickableInfo.description!==void 0&&(r.description=r.clickableInfo.description),delete r.clickableInfo.description,Object.keys(r.clickableInfo).length===0&&delete r.clickableInfo)}function yH(r){switch(r.labelSize){case"small":r.labelSize="0.85";break;case"medium":r.labelSize="1";break;case"large":r.labelSize="1.35";break;default:break}}function xH(r){let e=0,t=/^[0-9]+$/;for(var i=r.length-1;i>=0;i--){var o=r[i];let n=o.id;if(t.test(n)){let a=parseInt(n,10);a>e&&(e=a)}if(o.type==="table"&&o.columns){for(let a=o.columns.length-1;a>=0;a--)if(n=o.columns[a].id,!!n&&t.test(n)){let s=parseInt(n,10);s>e&&(e=s)}}}return e}function NV(r){if(r.version!==9)throw new Error(`Unexpected version: ${r.version}`);let e=[],t={},i=xH(r.expressions.list);for(let n of r.expressions.list)switch(n.type){case"expression":{let l=__dcg_shared_module_exports__['a']({},n);W_(l),yH(l),e.push(l);break}case"image":{let l=__dcg_shared_module_exports__['a']({},n);W_(l);let c=l.description;(c===void 0||c==="")&&l.draggable&&l.center!==void 0&&l.center!==""&&(t[l.center]===void 0?t[l.center]=[l]:t[l.center].push(l)),e.push(l);break}case"table":let a=__dcg_shared_module_exports__['a']({},n);if(!a.columns||!ys(a.columns[0].latex)){e.push(a);break}let s=a.columns[0].latex;for(let l=1;l<a.columns.length;l++){let c=a.columns[l];if(!c.lines||!Ic(c.latex,s))continue;delete c.lines,i++;let p={type:"expression",latex:"y="+$D(c.latex,s,"x"),id:`${i}`};c.color&&(p.color=c.color),c.lineStyle&&(p.lineStyle=c.lineStyle),c.lineWidth&&(p.lineWidth=c.lineWidth),c.lineOpacity&&(p.lineOpacity=c.lineOpacity),e.push(p)}e.push(a);break;default:e.push(n);break}for(let n of e){if(n.type!=="expression"||n.latex===void 0||n.latex===""||n.latex.indexOf("=")===-1||n.dragMode===void 0||n.dragMode==="NONE"||n.label===void 0||n.label==="")continue;let a=n.latex.slice(0,n.latex.indexOf("=")),s=t[a];if(s!==void 0)for(let l of s)l.description=n.label}return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{version:10,expressions:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.expressions),{list:e})})}function wH(r){let e=/[ \\]*=[ \\]*\\operatorname\{(dilation|reflection|rotation|translation)\}\\left\(/g;return r.type!=="expression"||!r.latex||(r.latex=r.latex.replace(e,(t,i)=>{switch(i){case"dilation":return"\\left(x\\right)=\\operatorname{dilate}\\left(x,";case"rotation":return"\\left(x\\right)=\\operatorname{rotate}\\left(x,";case"reflection":return"\\left(x\\right)=\\operatorname{reflect}\\left(x,";case"translation":return"\\left(x\\right)=\\operatorname{translate}\\left(x,";default:return""}})),r}function BV(r){if(r.version!==10)throw new Error(`Unexpected version: ${r.version}`);let e=__dcg_shared_module_exports__['a']({},r.graph);delete e.projectorMode;let t=__dcg_shared_module_exports__['a']({},r.expressions);if((e==null?void 0:e.product)==="geometry-calculator"){let i=[];for(let o of t.list)switch(o.type){case"expression":{let n=__dcg_shared_module_exports__['a']({},o);wH(n),i.push(n);break}default:i.push(o)}t.list=i}return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{version:11,graph:e,expressions:t})}function $_(r){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{version:10})}var qV=[E_,G_,I_,V_,A_,L_,P_,IV,MV,_V,NV,BV];var $l=11;function Vc(r){if(r.version>$l)return typeof console!="undefined"&&console.warn&&console.warn("Loading saved state with version "+r.version+" but last known version is "+$l+". States saved in a newer version of the calculator may not load correctly in an older version of the calculator."),UD(r);if(r.hasOwnProperty("version")&&!qV[r.version])return typeof console!="undefined"&&console.warn&&console.warn("State has invalid version "+r.version+". If a version is present, it should be a non-negative integer less than or equal to "+$l+"."),UD(r);for(r.hasOwnProperty("version")||(r=qV[0](r));r.version<$l;)r=qV[r.version+1](r);return UD(r)}function vH(r){return $_(r)}function j_(r){return vH(Vc(r))}var Zm={version:$l,randomSeed:"",graph:{viewport:{xmin:-10,ymin:-13.25,xmax:10,ymax:13.25},showGrid:!1,product:"geometry-calculator",showXAxis:!1,showYAxis:!1,degreeMode:!0},expressions:{list:[{type:"folder",id:__dcg_shared_module_exports__['ad'],title:"geometry",secret:!0},{id:"1",type:"expression"}]}};var KV={showGrid:!0,showXAxis:!0,showYAxis:!0,xAxisStep:0,yAxisStep:0,xAxisScale:"linear",yAxisScale:"linear",xAxisMinorSubdivisions:0,yAxisMinorSubdivisions:0,xAxisArrowMode:"NONE",yAxisArrowMode:"NONE",xAxisLabel:"",yAxisLabel:"",xAxisNumbers:!0,yAxisNumbers:!0,polarMode:!1,polarNumbers:!0,degreeMode:!1,randomSeed:"",restrictGridToFirstQuadrant:!1,userLockedViewport:!1},Y_={threeDMode:!1,worldRotation3D:[],axis3D:[0,0,1],speed3D:0,showPlane3D:!0,showNumbers3D:!0,plane3dOpacity:"",backgroundColor3d:"#FFF",showAxis3D:!0,showAxisLabels3D:!0,showBox3D:!0},CH={squareAxes:!0},DH=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},Y_),CH),{product:"graphing"});function J_(r){return r in Y_}var Fu=__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},KV),DH),X_=Object.keys(KV);function Q_(r){return r in KV}var ef=r=>isFinite(r)&&(r>0||r===0);var SH=0,kH="guid_"+Math.round(Math.random()*1e6)+"_"+new Date().getTime()+"_",zV=class{constructor(){this.__observers={},this.__eventObservers={},this.__oldProperties={},this.__propertyComparators={},this.guid=kH+ ++SH}unobserveAll(){this.__observers={},this.__eventObservers={}}getProperty(e){return this[e]}getOldProperty(e){return this.__oldProperties[e]}setProperty(e,t){var i=this[e];this[e]=t;var o=this.__propertyComparators[e];if(o){if(o(i,t))return}else if(__dcg_shared_module_exports__['P'](i,t))return;this.__oldProperties[e]=i,this.notifyPropertyChange(e)}setProperties(e){for(var t in e)e.hasOwnProperty(t)&&this.setProperty(t,e[t])}setPropertyComparator(e,t){this.__propertyComparators[e]=t}notifyPropertyChange(e){this.__callObservers(this.__observers,e,this)}observe(e,t){this.__addObservers(this.__observers,e,t)}unobserve(e){this.__removeObservers(this.__observers,e)}observeAndSync(e,t){this.observe(e,t);for(var i=e.split(" "),o=0;o<i.length;o++){var n=i[o].split("."),a=n[0];this.hasOwnProperty(a)&&t(a,this)}}triggerEvent(e,t){this.__callObservers(this.__eventObservers,e,t)}observeEvent(e,t){this.__addObservers(this.__eventObservers,e,t)}unobserveEvent(e){this.__removeObservers(this.__eventObservers,e)}__callObservers(e,t,i){var o=e[t];if(o)for(var n=0;n<o.length;n++)o[n].callback(t,i)}__removeObservers(e,t){for(var i=t.split(" "),o=0;o<i.length;o++){var n=i[o].split("."),a=n[0],s=n[1];if(a&&s){var l=e[a],c=[];if(!l)continue;for(var p=0;p<l.length;p++){var u=l[p];u.namespace!==s&&c.push(u)}e[a]=c}else if(a)delete e[a];else if(s)for(a in e)e.hasOwnProperty(a)&&this.__removeObservers(e,a+"."+s)}}__addObservers(e,t,i){for(var o=t.split(" "),n=0;n<o.length;n++){var a=o[n].split("."),s=a[0];if(!s)throw"Must supply a property to observe";var l=a[1],c={namespace:l,callback:i},p=e[s];p?p.push(c):e[s]=[c]}}},kr=zV;Lp();var Bn={},gl=Da();if(typeof Desmos!="undefined"&&Desmos.config)for(jD in Desmos.config)Desmos.config.hasOwnProperty(jD)&&(gl[jD]=Desmos.config[jD]);var jD,Mc=function(r){return gl.hasOwnProperty(r)},hr=function(r){Bn[r]=Mc(r)},so=function(r){Bn[r]=!Mc("no"+r)};hr("testing");hr("maintenance");hr("disableScrollFix");hr("nativeOnscreenKeypad");hr("hidden");hr("disableMouseInteractions");hr("advancedStyling");hr("outofdom");hr("beta3d");gl.lang&&(Bn.language=gl.lang);gl.fontSize&&(Bn.fontSize=gl.fontSize);gl.backgroundColor&&(Bn.backgroundColor="#"+gl.backgroundColor);gl.textColor&&(Bn.textColor="#"+gl.textColor);Bn.no_navigation_warning=Mc("noconcat")||Mc("testing");Bn.previewMessage="You're previewing some new accessibility features.";Bn.previewFeedbackUrl="mailto:feedback@desmos.com";var EH=location&&location.hostname==="preview.desmos.com";Bn.previewMode=Mc("previewMode")||EH;hr("lockViewport");hr("authorFeatures");hr("degreeMode");hr("clearIntoDegreeMode");hr("plaidMode");hr("wireframe");hr("editOnWeb");hr("crossOriginSaveTest");hr("showResetButtonOnGraphpaper");hr("transparentBackground");hr("forceLogModeRegressions");so("links");so("trace");so("zoomFit");hr("expressionsCollapsed");hr("invertedColors");hr("projectorMode");so("images");so("folders");so("settingsMenu");so("expressionsTopbar");so("zoomButtons");so("keypad");so("graphpaper");so("expressions");so("branding");so("pointsOfInterest");so("plotSingleVariableImplicitEquations");so("plotImplicits");so("plotInequalities");so("notes");so("sliders");hr("pauseWhenOffscreen");hr("worksheetSVG");so("brailleControls");hr("audioTraceKeypad");hr("audioTraceSimult");so("audio");hr("sciKeypad");hr("4fnKeypad");hr("ans");Mc("braille")&&(Bn.braille=!0);so("qwertyKeyboard");hr("restrictedFunctions");hr("forceEnableGeometryFunctions");so("functionDefinition");hr("singleExpression");hr("restrictedEditing");hr("replaceCommaWith10Exp");hr("replaceRoundWithReciprocal");Mc("typingAsteriskWritesTimesSymbol")&&(Bn.typingAsteriskWritesTimesSymbol=!0);so("substitutions");so("logScales");so("labels");so("distributions");Bn["4fnKeypad"]?hr("decimalToFraction"):so("decimalToFraction");hr("translucentSurfaces");hr("3d");hr("disableWorkerOnZoom");hr("disableLighting");Mc("exponentButtonForSquareRoot")?Bn.additionalFunctions=["exponent"]:gl.additionalFunctions&&typeof gl.additionalFunctions=="string"&&(Bn.additionalFunctions=gl.additionalFunctions.split(","));Mc("actions")?Bn.actions=!0:Mc("noactions")?Bn.actions=!1:Mc("clickableObjects")&&(Bn.actions=!0);function Pr(r){return Bn[r]}function YD(){return __dcg_shared_module_exports__['j'](Bn)}function JD(r){var e=[];for(let i of r)if(!(!i||typeof i!="string")){var t=i.split("-")[0];e.push(i),e.push(t);for(let o in fl){let n=fl[o];o.split("-")[0]===t&&n.useAsRoot&&e.push(o)}}return e}function Z_(){let r={},e=Object.keys(fl);for(let t in e){let i=e[t];r[i]={code:i,display_name:fl[i].displayName}}return r}var fl={en:{displayName:"English (US)",userGuideURL:"https://docs.google.com/document/d/1gV-WgDjgR9hKKb32ffeUpjwggNAgfqxl0Gsg6xocbok/preview",useAsRoot:!1},es:{displayName:"Espa\xF1ol (LATAM)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_ES-ES.pdf",useAsRoot:!0},et:{displayName:"Eesti",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ru:{displayName:"\u0420\u0443\u0441\u0441\u043A\u0438\u0439",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_RU.pdf",useAsRoot:!1},da:{displayName:"Dansk",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},de:{displayName:"Deutsch",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_DE.pdf",useAsRoot:!1},"pt-BR":{displayName:"Portugu\xEAs (Brasil)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!0},"pt-PT":{displayName:"Portugu\xEAs (Portugal)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ca:{displayName:"Catal\xE0",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},fr:{displayName:"Fran\xE7ais",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_FR.pdf",useAsRoot:!1},it:{displayName:"Italiano",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_IT.pdf",useAsRoot:!1},is:{displayName:"\xCDslenska",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},nl:{displayName:"Nederlands",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},no:{displayName:"Norsk",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},"sv-SE":{displayName:"Svenska",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!0},hu:{displayName:"Magyar",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},cs:{displayName:"\u010Ce\u0161tina",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},pl:{displayName:"Polski",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_PL.pdf",useAsRoot:!1},id:{displayName:"Bahasa Indonesia",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},vi:{displayName:"Ti\u1EBFng Vi\u1EC7t",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_VI.pdf",useAsRoot:!1},el:{displayName:"\u0395\u03BB\u03BB\u03B7\u03BD\u03B9\u03BA\u03AC",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_EL.pdf",useAsRoot:!1},uk:{displayName:"\u0423\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ka:{displayName:"\u10E5\u10D0\u10E0\u10D7\u10E3\u10DA\u10D8",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},th:{displayName:"\u0E20\u0E32\u0E29\u0E32\u0E44\u0E17\u0E22",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},tr:{displayName:"T\xFCrk\xE7e",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_TR.pdf",useAsRoot:!1},"zh-CN":{displayName:"\u7B80\u4F53\u4E2D\u6587",useAsRoot:!0,userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_ZH-CN.pdf"},"zh-TW":{displayName:"\u7E41\u9AD4\u4E2D\u6587",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_ZH-TW.pdf",useAsRoot:!1},ko:{displayName:"\uD55C\uAD6D\uC5B4",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ja:{displayName:"\u65E5\u672C\u8A9E",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_JA.pdf",useAsRoot:!1}};var eF=`account-shell-button-cancel = Cancel
account-shell-button-clear = Clear
account-shell-button-confirm-delete =
    { $count ->
        [one] Yes, delete graph
       *[other] Yes, delete graphs
    }
account-shell-button-contact-us = Contact Us
account-shell-button-delete = Delete
account-shell-button-download-braille = Download Braille Equations
account-shell-button-download-png = Download PNG
account-shell-button-download-svg = Download SVG
account-shell-button-duplicate = Duplicate
account-shell-button-embed = Embed
account-shell-button-export-image = Export Image
account-shell-button-hide-browser-warning = Hide this warning.
account-shell-button-line-medium = Medium
account-shell-button-line-thick = Thick
account-shell-button-line-thin = Thin
account-shell-button-log-in = Log In
account-shell-button-mygraphs-attempt-recovery = Attempt recovery.
account-shell-button-mygraphs-cancel = Cancel
account-shell-button-mygraphs-close-graph-list = Close Graph List
account-shell-button-mygraphs-close-graph-preview = Close Graph Preview
account-shell-button-mygraphs-delete-graph = Delete Graph
account-shell-button-mygraphs-delete-title = Delete { $graphTitle }
account-shell-button-mygraphs-offline-try-again = offline. click to try again.
account-shell-button-mygraphs-save = Save
account-shell-button-mygraphs-try-again = Try again
account-shell-button-open-construction = Open Construction
account-shell-button-open-graph = Open Graph
account-shell-button-print = Print
account-shell-button-rename = Rename
account-shell-button-retry-now = Retry now
account-shell-button-save = Save
account-shell-button-save-copy = Save Copy
account-shell-button-sign-up = Sign Up
account-shell-button-submit = Submit
account-shell-button-submit-graph = Submit This Graph
account-shell-button-svg-options = SVG Options
account-shell-button-update-graph = Update your submission
account-shell-error-deletion-error = There was an error. Try again later?
account-shell-error-graph-too-large = This graph is too large to save. The maximum allowable size is 5 MB.
account-shell-error-logging-out = Error logging out.
account-shell-error-mygraphs-check-connection = Check your internet connection?
account-shell-error-mygraphs-error-deleting = Error deleting.
account-shell-error-mygraphs-error-loading = Error loading graph
account-shell-error-save-art-contest = Error saving. Please try again later.
account-shell-error-sharing-link = Sorry, there was an error generating a link to your graph. Check your internet connection.
account-shell-error-something-went-wrong = Something went wrong, please report this to desmos.com support. (Error { $error_num })
account-shell-error-submitting = Error submitting. Please try again later.
account-shell-error-unexpected-error = Unexpected error.
account-shell-error-unknown = Sorry! Something went wrong. Please try again later.
account-shell-heading-3dcalc-page-title = Desmos | 3D Graphing Calculator
account-shell-heading-artist-statement = Your Artist Statement
account-shell-heading-birth-year = Your Birth Year
account-shell-heading-contact-us = Contact Us
account-shell-heading-country = Your Country
account-shell-heading-download-instructions = Download Instructions
account-shell-heading-duplicate-construction = Duplicate This Construction
account-shell-heading-duplicate-graph = Duplicate This Graph
account-shell-heading-email = Your Email
account-shell-heading-email-details = This will never be shared, but please provide an email where we can reach you!
account-shell-heading-embossers = Tactile Graphics Embossers
account-shell-heading-embossing-instructions = Embossing Instructions
account-shell-heading-export-graph = Export Your Graph
account-shell-heading-export-size = Size
account-shell-heading-geometry-legacy-page-title = Desmos | Geometry (Legacy)
account-shell-heading-geometry-page-title = Desmos | Geometry
account-shell-heading-graphingcalc-page-title = Desmos | Graphing Calculator
account-shell-heading-line-thickness = Line Thickness
account-shell-heading-math-art-contest = Global Math Art Contest
account-shell-heading-mygraphs-examples = Examples
account-shell-heading-mygraphs-recovered-work = Recovered Work
account-shell-heading-mygraphs-saved-constructions = Saved Constructions
account-shell-heading-mygraphs-saved-graphs = Saved Graphs
account-shell-heading-name = Your Name
account-shell-heading-name-details = This will be public
account-shell-heading-named-graph = { $title } | Desmos
account-shell-heading-rename-graph = Rename This Graph
account-shell-heading-resources = Resources
account-shell-heading-save-construction = Save This Construction
account-shell-heading-save-graph = Save This Graph
account-shell-heading-share-graph = Share Your Graph
account-shell-heading-submit-graph = Submit This Graph
account-shell-heading-title-mygraphs-search = Search
account-shell-heading-tours = Tours
account-shell-heading-unsupported-browser = Unsupported Browser
account-shell-label-account-information = Account Information
account-shell-label-advanced-preferences = Advanced
account-shell-label-artiist-statement-description = In 2-3 sentences, describe the inspiration behind your graph.
account-shell-label-artist-statement-placeholder = Tell us about your graph...
account-shell-label-beta = Beta
account-shell-label-betchacant-loading = Challenge accepted...
account-shell-label-birth-year-placeholder = Birth Year
account-shell-label-country-placeholder = Your Country
account-shell-label-created-days-ago = { $number } days ago
account-shell-label-created-hours-ago = { $number } hours ago
account-shell-label-created-last-week = last week
account-shell-label-created-minutes-ago = { $number } minutes ago
account-shell-label-created-on-date = { $month } { $day }, { $year }
account-shell-label-created-one-hour-ago = one hour ago
account-shell-label-created-one-minute-ago = one minute ago
account-shell-label-created-seconds-ago = less than a minute ago
account-shell-label-created-weeks-ago = { $number } weeks ago
account-shell-label-created-yesterday = yesterday
account-shell-label-delete-graph-modal-title = Delete Graph
account-shell-label-email-address = Email Address
account-shell-label-email-placeholder = email@example.com
account-shell-label-export-size-large-rectangle = Large Rectangle
account-shell-label-export-size-large-square = Large Square
account-shell-label-export-size-medium-rectangle = Medium Rectangle
account-shell-label-export-size-medium-square = Medium Square
account-shell-label-export-size-small-square = Small Square
account-shell-label-feature-flag-actions = Actions
account-shell-label-feedback = Feedback
account-shell-label-feedback-email = Email address so we can respond! (optional)
account-shell-label-feedback-message = Questions? Feedback?
account-shell-label-feedback-placeholder = Write to us!
account-shell-label-feedback-sending = Sending...
account-shell-label-full-name = Full Name
account-shell-label-graph-actions = Graph actions
account-shell-label-graph-title = Title
account-shell-label-help = Help
account-shell-label-help-menu = Help Menu
account-shell-label-language = Language
account-shell-label-loading = Loading...
account-shell-label-math-art-contest = Global Math Art Contest
account-shell-label-month-apr = Apr
account-shell-label-month-aug = Aug
account-shell-label-month-dec = Dec
account-shell-label-month-feb = Feb
account-shell-label-month-jan = Jan
account-shell-label-month-jul = Jul
account-shell-label-month-jun = Jun
account-shell-label-month-mar = Mar
account-shell-label-month-may = May
account-shell-label-month-nov = Nov
account-shell-label-month-oct = Oct
account-shell-label-month-sep = Sep
account-shell-label-mygraphs-example = example
account-shell-label-mygraphs-last-saved = last saved: { $date }
account-shell-label-mygraphs-no-unsaved-changes = no unsaved changes
account-shell-label-mygraphs-unsaved-graph = unsaved graph
account-shell-label-no-unsaved-changes = No Unsaved Changes
account-shell-label-open-graph-mac = { $open_graph } (cmd+o)
account-shell-label-open-graph-pc = { $open_graph } (ctrl+o)
account-shell-label-save-changes-mac = Save Changes (cmd+s)
account-shell-label-save-changes-pc = Save Changes (ctrl+s)
account-shell-label-saving-graph = Saving graph...
account-shell-label-share = share
account-shell-label-share-graph = Share Graph
account-shell-label-share-link = Share this link:
account-shell-label-submission-already-received = Your Art Contest Submission
account-shell-label-submission-received = Submission Received!
account-shell-label-submitting = Submitting...
account-shell-label-success = Success!
account-shell-label-try-a-quest-title = Try a Quest
account-shell-label-you-are-eligible = You're eligible to participate in the 2022 Global Math Art Contest!
account-shell-label-zoom = Zoom: { $value }%
account-shell-link-3d-user-guide = 3D User Guide
account-shell-link-account-settings = Account Settings
account-shell-link-download-chrome = Click here to download Google Chrome.
account-shell-link-email-support = Email Our Support Team
account-shell-link-geometry-user-guide = Geometry User Guide
account-shell-link-getting-started = Getting Started
account-shell-link-help = Help
account-shell-link-help-center = Help Center
account-shell-link-keyboard-shortcuts = Keyboard Shortcuts
account-shell-link-learn-more = Learn More
account-shell-link-privacy = Privacy Policy
account-shell-link-read-blog = Read our blog
account-shell-link-send-feedback = Send Feedback and Questions
account-shell-link-share-thoughts = Share your thoughts!
account-shell-link-sign-out = Sign Out
account-shell-link-terms = Terms of Service
account-shell-link-try-a-quest = Try a quest
account-shell-link-try-next-quest = Try another
account-shell-link-user-guide = Desmos User Guide
account-shell-link-video-tutorials = Video Tutorials
account-shell-link-view-all-quests = View all quests
account-shell-narration-clear-selected-country = Clear Selected Country
account-shell-narration-graph-preview = Graph Preview
account-shell-narration-image-download = Image Download
account-shell-narration-language-menu = Language Options Menu
account-shell-narration-mygraphs-open-graph = Open graph
account-shell-narration-share-options = Share Options
account-shell-narration-size-options = Size Options
account-shell-text-3d-beta-notice = Thank you for visiting our Beta 3D Calculator! Please share any bugs, questions, or suggestions with us below.
account-shell-text-3d-expression-list-notice = Please share any bugs, questions, or suggestions at: <1>feedback@desmos.com</1>
account-shell-text-advanced-preferences-instructions = Try these advanced features. Feel free to send any questions or feedback to support@desmos.com.
account-shell-text-alt-text-art-contest = Earth with students from different countries and a red ribbon around it. Illustration.
account-shell-text-alt-text-success = Five people standing around and talking about an exciting piece of art in a museum. Illustration.
account-shell-text-art-contest-about-paragraph = Want to share your awesome graph with the world? Students ages 13+ can enter the Desmos Global Math Art Contest before<1> January 15th </1>for a chance to be featured on our website and win other prizes! <2>Learn more</2>
account-shell-text-art-contest-congratulations = Congratulations, and keep graphing!
account-shell-text-art-contest-copyright-agreement = I pledge that (a) this is my original work and (b) this isn't based on copyrighted material.
account-shell-text-art-contest-legal-disclaimer = By submitting this graph, you acknowledge that Desmos Studio, PBC may, at its discretion, post it publicly at the contest website and/or on social media channels.
account-shell-text-art-contest-notice-default = Once you've created a graph, you can submit it here to participate in the Global Math Art Contest!
account-shell-text-art-contest-notice-login = Please create an account or sign in to participate in the Global Math Art Contest!
account-shell-text-art-contest-submission-already-received = <1>Your previous submission to the Global Math Art Contest was successfully received! You can click the link below to update your submission, any time before January 15th.</1>
account-shell-text-art-contest-success-paragraph = If you'd like to revise your submission, feel free to resubmit anytime before<1> January 15th</1>. We'll only look at the most recent submission.
account-shell-text-artcontest-ineligible = <1><2>Based on your age and location, we aren\u2019t able to accept a graph submission from you this year.</2><3>Keep up the awesome graphing! There will be new contests every year.</3></1>
account-shell-text-confirm-leave = Are you sure you want to leave this graph? Your unsaved work will be lost.
account-shell-text-construction-cleared = Construction Cleared.
account-shell-text-contest-under-16 = Under 16?
account-shell-text-contest-verify-eligibility = Verify your eligibility
account-shell-text-continue-with-quest = ...or <1>keep playing with this quest</1>.
account-shell-text-copy-of-title = [Copy of] { $originalTitle }
account-shell-text-delete-graphs-confirmation =
    Are you sure you want to delete { $count ->
        [one] "{ $title }"
       *[other] the { $count } selected graphs
    }?
account-shell-text-download-instructions = To download, right click on the image of the graph select "Save As." You might also be able to click and drag the image onto your desktop.
account-shell-text-embossing-etc-print = Set paper size to { $size }. Then click "Edit" and select File > Emboss.
account-shell-text-embossing-etc-save = Save this image. Open Firebird, select File > Open > Image File, and open the image.
account-shell-text-embossing-vpmax-print = Right click image and select "print". Set paper size to { $size }.
account-shell-text-embossing-vpmax-save = Right click graph image and save to desktop.
account-shell-text-error = error
account-shell-text-error-loading-geometry-state = Error loading construction
account-shell-text-feature-flag-actions-description = Make graphs interactive by defining rules for responding to clicks or to the passage of time.
account-shell-text-feedback-sent = Thanks! We'll be in touch.
account-shell-text-geometry-beta-notice = Thank you for visiting our new Geometry Tool! Please share any bugs, questions, or suggestions with us below.
account-shell-text-graph-cleared = Graph cleared.
account-shell-text-graph-migrated-from-geometry = '{ $title }' was auto-migrated from the old geometry tool.
account-shell-text-graph-uses-advanced-features = This graph uses advanced features.
account-shell-text-logged-in = Logged in successfully!
account-shell-text-login-window-blocked-apple = Login window blocked. Please allow popups from desmos.com to sign in with Apple
account-shell-text-login-window-blocked-google = Login window blocked. Please allow popups from desmos.com to sign in with Google.
account-shell-text-maintenance-mode = Desmos is in Maintenance Mode.
account-shell-text-mygraphs-attempting-recovery = Attempting recovery...
account-shell-text-mygraphs-count-more = { $count } more...
account-shell-text-mygraphs-current-construction = Current Construction
account-shell-text-mygraphs-current-graph = Current Graph
account-shell-text-mygraphs-deleting = Deleting...
account-shell-text-mygraphs-loading = Loading...
account-shell-text-mygraphs-lost-work = Lost work?
account-shell-text-mygraphs-maintenance-mode = Desmos is temporarily in maintenance mode. You can open example graphs, but won't be able to sign in, open your graphs, or save any changes. We're so sorry for the inconvenience.
account-shell-text-mygraphs-new-blank-graph = New Blank Graph
account-shell-text-mygraphs-new-construction = New Construction
account-shell-text-mygraphs-no-examples-match-search = No examples match your search.
account-shell-text-mygraphs-no-saved-graphs = No saved graphs yet.
account-shell-text-mygraphs-no-search-results = No saved graphs match your search.
account-shell-text-mygraphs-no-unsaved-graphs = Couldn't find any unsaved graphs.
account-shell-text-mygraphs-opened-graph = Opened '{ $graphTitle }'
account-shell-text-mygraphs-or = or
account-shell-text-mygraphs-search-by-title = search by title
account-shell-text-mygraphs-share-thoughts = Share your thoughts!
account-shell-text-mygraphs-submit-to-contest = <1>Submit this graph to the <2>Global Math Art Contest!</2></1>
account-shell-text-mygraphs-synced = synced!
account-shell-text-mygraphs-to-save-constructions = to save your constructions!
account-shell-text-mygraphs-to-save-graphs = to save your graphs!
account-shell-text-mygraphs-updating-graphs = updating graphs...
account-shell-text-mygraphs-version = Version
account-shell-text-new-construction-created = New construction created.
account-shell-text-new-graph-created = New graph created.
account-shell-text-or = or
account-shell-text-saved = saved
account-shell-text-share-submit-to-contest = <1>Submit this graph to the <2>Global Math Art Contest!</2></1>
account-shell-text-unsupported-browser-android = Desmos works best on your version of Android if you use the Chrome Browser.
account-shell-text-untitled = Untitled
account-shell-text-untitled-graph = Untitled Graph
account-shell-text-welcome-to-3d = Welcome to Desmos 3D (Beta)
shared-button-accept = Accept
shared-button-cancel = Cancel
shared-button-change-email-address = Change email address
shared-button-change-email-and-password = Change email and password
shared-button-close-dialog = Close Dialog
shared-button-close-message = Close Message
shared-button-confirm-name = Confirm Name
shared-button-continue-to-desmos = Continue to Desmos
shared-button-create-account = Create Account
shared-button-delete-account-question = Delete your Desmos account?
shared-button-email-address-narrow = Email
shared-button-email-address-wide = Email Address
shared-button-external-account-narrow = External
shared-button-external-account-wide = External Account
shared-button-go-to-account-settings = Go to Account Settings
shared-button-google-account-narrow = Google
shared-button-google-account-wide = Google Account
shared-button-learn-more-capitalized = Learn More
shared-button-login = Log in
shared-button-login-capitalized = Log In
shared-button-read-more = Read More
shared-button-recover-password = Recover Password
shared-button-save = Save
shared-button-send-delete-account-email = Send Delete Account Email
shared-button-send-email = Send Email
shared-button-sign-in-with-apple = Sign in with Apple
shared-button-sign-in-with-google = Sign in with Google
shared-button-try-again = Didn't work? Try again!
shared-calculator-button-braille-mode-nemeth = Nemeth
shared-calculator-button-braille-mode-ueb = UEB
shared-calculator-button-clear = clear
shared-calculator-button-controlbar-functions = functions
shared-calculator-button-go = Go
shared-calculator-button-mac = Mac Shortcuts
shared-calculator-button-windows-chrome = Windows / ChromeOS Shortcuts
shared-calculator-error-3d-bad-equality-slice = We don't support this type of equality restriction.
shared-calculator-error-3d-equality-and-other-restriction = Cannot combine an equality restriction with any other restrictions.
shared-calculator-error-3d-length-type-error = Function '{ $fn }' cannot be applied to { $arg } in the 3d calculator. Use '{ $alternativeFn }' to find the number of elements in a list.
shared-calculator-error-action-merge-free-variable = Cannot combine an action that depends on free variable '{ $symbol }'.
shared-calculator-error-add-arguments-to-definition-many = Try including '{ $symbols }' and '{ $lastSymbol }' as arguments by defining the function as '{ $newSignature }'.
shared-calculator-error-add-arguments-to-definition-one = Try including '{ $lastSymbol }' as an argument by defining the function as '{ $newSignature }'.
shared-calculator-error-add-type-error = Cannot add { $symbol1 } and { $symbol2 }.
shared-calculator-error-adjacent-mixed-number = Sorry, I don't know what to do with mixed number '{ $mixedNumber }'. Try using a '*' symbol around it.
shared-calculator-error-adjacent-numbers = Sorry, I don't know what to do with adjacent numbers '{ $left }' and '{ $right }'. Try using parentheses or a '*' symbol.
shared-calculator-error-and-type-error = Cannot apply { $symbol } to { $symbol1 } and { $symbol2 }.
shared-calculator-error-ans-undefined = The previous expression didn't define any value for ans.
shared-calculator-error-assignments-unsupported = This calculator does not support defining variables.
shared-calculator-error-bad-implicit-call = Use parentheses around the argument of '{ $symbol }'.
shared-calculator-error-bad-integral-bound-dependency = Integration bounds can't depend on integration variable '{ $symbol }'.
shared-calculator-error-bad-list-comprehension-input-dependency = List comprehension input list can't depend on input variable '{ $symbol }'.
shared-calculator-error-bad-log-exponent = Only { $form } is supported. Otherwise, use parens.
shared-calculator-error-bad-product-bound-dependency = Product bounds can't depend on product index '{ $symbol }'.
shared-calculator-error-bad-sample-size = Sample size must be a finite, non-negative number.
shared-calculator-error-bad-sum-bound-dependency = Summation bounds can't depend on summation index '{ $symbol }'.
shared-calculator-error-bad-symbol-context = You can't use '{ $symbol }' in this context.
shared-calculator-error-bad-trig-exponent = Only { $form1 } and { $form2 } are supported. Otherwise, use parens.
shared-calculator-error-bad-tuple-dimensions = Points may only have { $symbol } coordinates.
shared-calculator-error-binary-operator-missing-operand = You need something on both sides of the '{ $symbol }' symbol.
shared-calculator-error-blank-expression = You haven't written anything yet.
shared-calculator-error-boxplot-breadth-invalid = Invalid height. Try using any number.
shared-calculator-error-boxplot-offset-invalid = Invalid offset. Try using any number.
shared-calculator-error-cannot-assign-color = Cannot assign a color to '{ $variable }'.
shared-calculator-error-cannot-redefine = You can't redefine '{ $symbol }' because it's already defined.
shared-calculator-error-cannot-redefine-root = You can't define '{ $symbol }' because '{ $symbolRoot }' is already defined.
shared-calculator-error-cannot-restrict = Cannot create a restriction based on '{ $variable }' in this type of expression.
shared-calculator-error-cannot-restrict-with-equality = Cannot create an equality restriction based on '{ $variable }' in this type of expression.
shared-calculator-error-cannot-subscript = '{ $symbol }' cannot have a subscript.
shared-calculator-error-cdf-max-invalid = Invalid cdf max. Try using any number.
shared-calculator-error-cdf-max-less-than-min = Invalid cdf limits. Min should be less than max.
shared-calculator-error-cdf-min-invalid = Invalid cdf min. Try using any number.
shared-calculator-error-cdf-too-many-arguments = 'cdf' should be called on a distribution with at most two numbers. { $recommendation }
shared-calculator-error-cdf-too-many-arguments-recommendation = For example, try typing: D.cdf(-1,1) where D=normaldist().
shared-calculator-error-cdf-wrong-arity = 'cdf' should be called on a distribution with at least one number. { $recommendation }
shared-calculator-error-cdf-wrong-arity-recommendation = For example, try typing: D.cdf(x) where D=normaldist().
shared-calculator-error-clickable-object-assignment-not-defined = "{ $symbol }" is not defined. Try using a different variable or adding a slider.
shared-calculator-error-clickable-object-assignment-not-identifier = Invalid symbol. Try using a single letter.
shared-calculator-error-clickable-object-invalid-expression = Can't evaluate this. Try a number or simple expression.
shared-calculator-error-colon-missing-condition = The left side of a ':' must be a condition, like 'x>1'.
shared-calculator-error-color-arity = '{ $symbol }' should be called with 3 arguments. { $recommendation }
shared-calculator-error-color-arity-recommendation = For example, try typing: { $recommendation }.
shared-calculator-error-color-not-assigned = To use a color, you must assign it to a variable.
shared-calculator-error-combine-type-error = Cannot combine { $symbol1 } and { $symbol2 }.
shared-calculator-error-comparator-type-error = Cannot compare { $symbol1 } to { $symbol2 }.
shared-calculator-error-complicated-double-inequality = We only support solved double inequalities. Try deleting one side of the inequality.
shared-calculator-error-complicated-polar-implicit = Polar equations must be linear in r.
shared-calculator-error-constant-unsupported = This calculator does not support the constant '{ $symbol }'.
shared-calculator-error-custom-toolbar-not-condition = Please write a valid condition and make sure every referenced variable is defined.
shared-calculator-error-deeply-nested = Definitions are nested too deeply.
shared-calculator-error-dependency-cycle = '{ $symbols }' and '{ $lastSymbol }' can't be defined in terms of each other.
shared-calculator-error-depends-on-deleted-geo-object = This depends on a geometric object that's no longer defined.
shared-calculator-error-derivative-missing-body = What do you want to take the derivative of?
shared-calculator-error-derivative-type-error = Cannot take the derivative of { $symbol }.
shared-calculator-error-derivative-variable-type-error = Cannot take derivative with respect to '{ $symbol1 }' because it is { $symbol2 }.
shared-calculator-error-differential-with-superscript = Integration variable cannot have a superscript.
shared-calculator-error-distribution-as-function = Cannot call distribution '{ $symbol }' as a function. Try '{ $symbol }.pdf(x)'.
shared-calculator-error-divide-type-error = Cannot divide { $symbol1 } by { $symbol2 }.
shared-calculator-error-domain-max-invalid = Invalid domain max. Try using any number.
shared-calculator-error-domain-max-less-than-min = Invalid domain limits. Min should be less than max.
shared-calculator-error-domain-min-invalid = Invalid domain min. Try using any number.
shared-calculator-error-dot-lhs-type-error = Cannot call '.{ $symbol }' on { $type }.
shared-calculator-error-duplicate-update-rules = An action cannot specify multiple update rules for '{ $symbol }'.
shared-calculator-error-empty-paren = Parentheses cannot be empty.
shared-calculator-error-empty-pipe = Absolute value symbol cannot be empty.
shared-calculator-error-empty-radical = Radical cannot be empty.
shared-calculator-error-empty-radical-index = Radical index cannot be empty.
shared-calculator-error-empty-square-bracket = Square brackets cannot be empty.
shared-calculator-error-empty-subscript = Subscripts cannot be empty.
shared-calculator-error-empty-superscript = Superscripts cannot be empty.
shared-calculator-error-equation-required = Try adding an equals sign to turn this into an equation.
shared-calculator-error-equation-required-symbol = Try adding '{ $lhs }' to the beginning of this equation.
shared-calculator-error-equations-unsupported = This calculator does not support this type of equation.
shared-calculator-error-event-handler-type-error = This should be an action. Try '{ $example }'.
shared-calculator-error-exponent-type-error = Cannot raise { $symbol1 } to { $symbol2 }.
shared-calculator-error-feature-unavailable = This feature is not available in the current calculator.
shared-calculator-error-fraction-empty = You need a numerator and denominator for your fraction.
shared-calculator-error-fraction-missing-denominator = You need a denominator for the bottom of your fraction.
shared-calculator-error-fraction-missing-numerator = You need a numerator for the top of your fraction.
shared-calculator-error-function-definition-unsupported = This calculator does not support function definitions.
shared-calculator-error-function-not-defined = Function '{ $dependency }' is not defined.
shared-calculator-error-function-type-error-1 = Function '{ $fn }' cannot be applied to { $arg }.
shared-calculator-error-function-type-error-2 = Function '{ $fn }' cannot be applied to { $arg1 } and { $arg2 }.
shared-calculator-error-function-type-error-many = Function '{ $fn }' cannot be applied to these arguments.
shared-calculator-error-function-unsupported = This calculator does not support the '{ $symbol }' function.
shared-calculator-error-geometry-length-type-error = Function '{ $fn }' cannot be applied to { $arg } in the geometry calculator. Use '{ $alternativeFn }' to find the number of elements in a list.
shared-calculator-error-gpu-function-unsupported = Cannot use the '{ $symbol }' function here.
shared-calculator-error-gpu-integral-unsupported = Cannot use integrals here.
shared-calculator-error-gpu-long-product = Products may not have more than { $maxTermCount } terms here.
shared-calculator-error-gpu-long-sum = Sums may not have more than { $maxTermCount } terms here.
shared-calculator-error-gpu-max-list-size = Lists may not have more than { $maxListSize } elements here.
shared-calculator-error-gpu-variable-list-length = List length cannot depend on variable '{ $symbol }' here.
shared-calculator-error-gpu-variable-product = Product bound cannot depend on variable '{ $symbol }' here.
shared-calculator-error-gpu-variable-sum = Sum bound cannot depend on variable '{ $symbol }' here.
shared-calculator-error-heterogeneous-list = All elements of a list must have the same type.
shared-calculator-error-identifier-as-function = '{ $symbol }' is a function. Try using parentheses.
shared-calculator-error-illegal-bin-width = The second argument to '{ $symbol }' must be a positive number.
shared-calculator-error-illegal-dot-call = Function '{ $symbol }' cannot be called with dot notation.
shared-calculator-error-implicits-disabled = Plotting implicit equations and inequalities is disabled.
shared-calculator-error-incorrect-list-comprehension-input = Inputs to a list comprehension must set a variable equal to a list. Try i=[1...10].
shared-calculator-error-incorrect-product-lower-bound = Lower bound of a product must set a variable equal to a number. Try n=1.
shared-calculator-error-incorrect-sum-lower-bound = Lower bound of a sum must set a variable equal to a number. Try n=1.
shared-calculator-error-index-type-error = Cannot index { $symbol1 } with { $symbol2 }.
shared-calculator-error-inequalities-disabled = Plotting inequalities is disabled.
shared-calculator-error-inequalities-unsupported = This calculator does not support inequalities.
shared-calculator-error-inequality-chain-too-long = Cannot chain more than 2 inequalities.
shared-calculator-error-integral-argument-type-error = Cannot take the integral of { $symbol }.
shared-calculator-error-integral-lower-bound-type-error = Lower bound of an integral cannot be { $symbol }.
shared-calculator-error-integral-missing-body = What do you want to take the integral of?
shared-calculator-error-integral-missing-bound = Integrals must have upper and lower bounds.
shared-calculator-error-integral-missing-differential = Integrand must end with an integration variable, like dx.
shared-calculator-error-integral-upper-bound-type-error = Upper bound of an integral cannot be { $symbol }.
shared-calculator-error-invalid-dependent-first-table-column = This column header can't be defined elsewhere in the calculator.
shared-calculator-error-invalid-double-inequality-3d = Sorry, we don't plot double inequalities in this calculator.
shared-calculator-error-invalid-double-inequality-variables = We only plot double inequalities of x and y.
shared-calculator-error-invalid-first-table-column = First column may not be { $most } or { $last }.
shared-calculator-error-invalid-half-empty-range = Range must have an upper and lower bound.
shared-calculator-error-invalid-implicit-variables = We only support implicit equations of x and y.
shared-calculator-error-invalid-inequality-variables = We only plot inequalities of x and y, or r and \u03B8.
shared-calculator-error-invalid-lhs = Sorry, you can't graph { $symbol } as a function of anything yet.
shared-calculator-error-invalid-operator-name = Operator names may only contain letters.
shared-calculator-error-invalid-regression-parameter = '{ $symbol }' may not be used as a regression parameter. Try using a list.
shared-calculator-error-invalid-subscript = Subscripts may only contain letters and digits. '{ $symbol }' is not allowed.
shared-calculator-error-invalid-table-entry = Table entries must be simple expressions. { $supplement }
shared-calculator-error-invalid-table-header = Table headers must be simple expressions. { $supplement }
shared-calculator-error-list-comprehension-input-type-error = An input to a list comprehension must be a list, but { $identifier } is { $actual }. Try { $identifier }=[1...10].
shared-calculator-error-list-type-error = Cannot store { $symbol1 } in a list.
shared-calculator-error-log-scale-box-plot = Cannot plot a box plot on a log scale.
shared-calculator-error-log-scale-dot-plot = Cannot plot a dot plot on a log scale.
shared-calculator-error-log-scale-histogram = Cannot plot a histogram on a log scale.
shared-calculator-error-log-scale-type-error = Cannot plot { $symbol } on a log scale.
shared-calculator-error-logbase-unsupported = This calculator does not support specifying the base of a logarithm. Try 'log' or 'ln'.
shared-calculator-error-malformed-list = Lists are written like this: [1, 2, 3].
shared-calculator-error-malformed-point = Points are written like this: (1, 2).
shared-calculator-error-matrix-add-dimensions = Cannot add matrices with different dimensions.
shared-calculator-error-matrix-assignment = This calculator does not support this type of variable definition. Try using 'New Matrix'.
shared-calculator-error-matrix-element-type-error = Cannot use { $arg } as an element of a matrix.
shared-calculator-error-matrix-fractional-power = A matrix can only be raised to integer powers.
shared-calculator-error-matrix-invalid-variable = Cannot use '{ $symbol }' as a variable.
shared-calculator-error-matrix-multiply-dimensions = Cannot multiply matrices with incompatible dimensions.
shared-calculator-error-matrix-power-dimensions = Only square matrices can be raised to a power.
shared-calculator-error-matrix-subtract-dimensions = Cannot subtract matrices with different dimensions.
shared-calculator-error-max-list-size = Lists may not have more than { $maxListSize } elements.
shared-calculator-error-method-requires-list = '{ $symbol }' requires a list. For example, try typing: { $recommendation }.
shared-calculator-error-mismatched-braces = Expected '{ $symbol1 }' to match '{ $symbol2 }'.
shared-calculator-error-mismatched-double-inequality = Double inequalities must both go the same way, e.g. { $example }.
shared-calculator-error-multiply-defined = You've defined '{ $dependency }' in more than one place. Try deleting some of the definitions of '{ $dependency }'.
shared-calculator-error-multiply-type-error = Cannot multiply { $symbol1 } by { $symbol2 }.
shared-calculator-error-multiply-type-error-2d = Ambiguous multiplication of { $symbol1 } by { $symbol2 }. Try typing: (1, 2) * (2, 1).
shared-calculator-error-multiply-type-error-3d = Ambiguous multiplication of { $symbol1 } by { $symbol2 }. Try typing: (1, 2, 3) cross (2, 1, 0).
shared-calculator-error-multiply-type-error-cross = Cannot take the cross product of { $symbol1 } and { $symbol2 }.
shared-calculator-error-negative-type-error = Cannot negate { $symbol }.
shared-calculator-error-non-arithmetic-range = Ranges must be arithmetic sequences.
shared-calculator-error-non-list-double-reducer = Both arguments of '{ $symbol }' must be lists. For example, try typing: { $recommendation }.
shared-calculator-error-non-list-parameterized-reducer = The first argument of '{ $symbol }' must be a list. For example, try typing: { $recommendation }.
shared-calculator-error-non-singular-inverse = Singular matrices do not have an inverse.
shared-calculator-error-non-square-determinant = Only square matrices have a determinant.
shared-calculator-error-non-square-inverse = Only square matrices have an inverse.
shared-calculator-error-non-square-trace = Only square matrices have a trace.
shared-calculator-error-optimization-error = We couldn't find any region where this model is defined.
shared-calculator-error-ordered-pair-access-type-error = Cannot access a coordinate of { $symbol }.
shared-calculator-error-parameter-already-defined = You can't use '{ $dependency }' as a parameter of this function because '{ $dependency }' is already defined.
shared-calculator-error-parse-error = Sorry, I don't understand this.
shared-calculator-error-pdf-wrong-arity = 'pdf' should be called on a distribution with a number. { $recommendation }
shared-calculator-error-pdf-wrong-arity-recommendation = For example, try typing: D.pdf(x) where D=normaldist().
shared-calculator-error-percent-missing-of = '%' must be used with 'of'. Try '25% of 12'.
shared-calculator-error-piecewise-branch-type-error = Cannot use { $symbol1 } and { $symbol2 } as the branches in a piecewise. Every branch must have the same type.
shared-calculator-error-piecewise-condition-type-error = The condition in a piecewise expression must be { $symbol1 } but was { $symbol2 }.
shared-calculator-error-piecewise-missing-condition = A piecewise expression must have at least one condition.
shared-calculator-error-piecewise-part-missing-condition = Every part of a piecewise expression must have a condition except the last.
shared-calculator-error-point-type-error = Cannot use { $symbol1 } as a coordinate of { $symbol2 }.
shared-calculator-error-points-unsupported = This calculator does not support points.
shared-calculator-error-polygon-unsupported-in-3d = This calculator does not support the 'polygon' function. Try 'triangle' instead.
shared-calculator-error-prime-without-paren = Primed function calls must use parentheses.
shared-calculator-error-primed-function-arity = Prime notation can only be used for functions of a single argument.
shared-calculator-error-product-argument-type-error = Cannot take the product of { $symbol }.
shared-calculator-error-product-infinite-bound-type-error = Product bounds must be finite numbers.
shared-calculator-error-product-lower-bound-type-error = Lower bound of a product cannot be { $symbol }.
shared-calculator-error-product-missing-body = What do you want to take the product of?
shared-calculator-error-product-missing-bound = Products must have upper and lower bounds.
shared-calculator-error-product-upper-bound-type-error = Upper bound of a product cannot be { $symbol }.
shared-calculator-error-random-arity = 'random' should be called with no arguments, or an optional number of samples. For example, try random() or random(10).
shared-calculator-error-random-from-broadcast-distribution = Cannot sample from a list of distributions
shared-calculator-error-regression-type-error = Cannot regress { $symbol1 } against { $symbol2 }.
shared-calculator-error-regressions-unsupported = This calculator does not support regressions.
shared-calculator-error-self-referential-function = The definition of function '{ $symbol }' cannot depend on '{ $symbol }'.
shared-calculator-error-shadowed-index = You can't use '{ $symbol }' as an index because it's already defined.
shared-calculator-error-shadowed-integration-variable = You can't use '{ $symbol }' as an integration variable because it's already defined.
shared-calculator-error-shadowed-list-comprehension-input = You can't use '{ $symbol }' as a list comprehension input because it's already defined.
shared-calculator-error-single-variable-implicit-equations-disabled = Plotting single-variable implicit equations is disabled.
shared-calculator-error-slider-limit-references-export = Slider limits cannot depend on the slider variable '{ $symbol }'.
shared-calculator-error-slider-max-invalid = Invalid slider max. Try using any number.
shared-calculator-error-slider-max-less-than-min = Invalid slider limits. Min should be less than max.
shared-calculator-error-slider-min-invalid = Invalid slider min. Try using any number.
shared-calculator-error-slider-step-invalid = Invalid slider step. Try using any number.
shared-calculator-error-substitution-ambiguous-comma = Ambiguous use of ',' and 'with'. Add parentheses around the 'with' expression.
shared-calculator-error-substitution-body-action = The left hand side of a 'with' substitution cannot be an action.
shared-calculator-error-substitution-body-local-variable-dependency = The left hand side of a 'with' substitution cannot depend on '{ $symbol }' because '{ $symbol }' is locally defined.
shared-calculator-error-substitution-body-regression-parameter-dependency = The left hand side of a 'with' substitution cannot depend on '{ $symbol }' because '{ $symbol }' is a regression parameter.
shared-calculator-error-substitution-duplicate-assignment = A 'with' expression cannot make multiple substitutions for '{ $symbol }'.
shared-calculator-error-substitution-function-lhs = Substituting for '{ $symbol }' is not allowed because it is a function.
shared-calculator-error-substitution-illegal-lhs = Substituting for '{ $symbol }' is not allowed.
shared-calculator-error-substitution-invalid-assignments = 'with' must be followed by one or more variable assignments.
shared-calculator-error-substitution-local-lhs = Substituting for variable '{ $symbol }' is not allowed because it is locally defined.
shared-calculator-error-substitution-nested = Using one 'with' expression inside another 'with' expression is not allowed.
shared-calculator-error-substitution-type-error = Cannot substitute { $actual } for { $expected }.
shared-calculator-error-substitution-undefined-rhs = An expression that depends on the free variable '{ $symbol }' cannot be used on the right hand side of 'with'.
shared-calculator-error-subtract-type-error = Cannot subtract { $symbol2 } from { $symbol1 }.
shared-calculator-error-sum-argument-type-error = Cannot take the sum of { $symbol }.
shared-calculator-error-sum-infinite-bound-type-error = Summation bounds must be finite numbers.
shared-calculator-error-sum-lower-bound-type-error = Lower bound of a sum cannot be { $symbol }.
shared-calculator-error-sum-missing-body = What do you want to take the sum of?
shared-calculator-error-sum-missing-bound = Sums must have upper and lower bounds.
shared-calculator-error-sum-upper-bound-type-error = Upper bound of a sum cannot be { $symbol }.
shared-calculator-error-superscript-with-prime = Superscripts and primes cannot be combined.
shared-calculator-error-table-entry-type-error = Table entry cannot be { $symbol }.
shared-calculator-error-table-equation-supplement = Equations are not allowed.
shared-calculator-error-table-function-definition-supplement = Function definitions are not allowed.
shared-calculator-error-table-generic-supplement = This type of expression is not allowed.
shared-calculator-error-table-header-type-error = Table header cannot be { $symbol }.
shared-calculator-error-table-inequality-supplement = Inequalities are not allowed.
shared-calculator-error-table-list-supplement = Lists are not allowed.
shared-calculator-error-table-regression-supplement = Regressions are not allowed.
shared-calculator-error-tdist-wrong-arity = 'tdist' requires 1 argument. For example, try typing: tdist(1).
shared-calculator-error-ticker-min-step-nonnegative = Min step must evaluate to a non-negative number.
shared-calculator-error-token-with-subscript = Tokens may not have subscripts.
shared-calculator-error-too-many-arguments = '{ $symbol }' accepts at most { $max } arguments.
shared-calculator-error-too-many-variables-many-symbols = Too many variables. Try defining '{ $variables }' or '{ $lastVariable }'.
shared-calculator-error-too-many-variables-no-symbols = Too many variables, I don't know what to do with this.
shared-calculator-error-too-many-variables-one-symbol = Too many variables. Try defining '{ $variable }'.
shared-calculator-error-transformation-definition-expected-types-1 = Try using { $arg }.
shared-calculator-error-transformation-definition-expected-types-2 = Try using { $arg1 } and { $arg2 }.
shared-calculator-error-transformation-definition-expected-types-use-fewer-1 = Try using just { $arg }.
shared-calculator-error-transformation-definition-expected-types-use-fewer-2 = Try using just { $arg1 } and { $arg2 }.
shared-calculator-error-transformation-definition-type-error-1 = A { $fn } cannot be defined using { $arg }. { $expectedTypeMessage }
shared-calculator-error-transformation-definition-type-error-2 = A { $fn } cannot be defined using { $arg1 } and { $arg2 }. { $expectedTypeMessage }
shared-calculator-error-transformation-definition-type-error-many = A '{ $fn }' cannot be defined with these arguments.
shared-calculator-error-transformation-definition-type-error-use-more-1 = A { $fn } cannot be defined using just { $arg }. { $expectedTypeMessage }
shared-calculator-error-transformation-definition-type-error-use-more-2 = A { $fn } cannot be defined using just { $arg1 } and { $arg2 }. { $expectedTypeMessage }
shared-calculator-error-transformation-type-error-1 = Transformation '{ $fn }' cannot be applied to { $arg }.
shared-calculator-error-transformation-type-error-2 = Transformation '{ $fn }' cannot be applied to { $arg1 } and { $arg2 }.
shared-calculator-error-transformation-type-error-many = Transformation '{ $fn }' cannot be applied to these arguments.
shared-calculator-error-ttest-list-too-short = Lists for '{ $symbol }' must have at least 2 elements.
shared-calculator-error-two-numbers-error = Cannot make a polygon from two numbers.
shared-calculator-error-unary-operator-missing-left = You need something before the '{ $symbol }' symbol.
shared-calculator-error-unary-operator-missing-right = You need something after the '{ $symbol }' symbol.
shared-calculator-error-unexpected-for-keyword = 'for' can only be used inside a list. Try [i for i=[1...10]].
shared-calculator-error-unexpected-inequality = Cannot use an inequality here.
shared-calculator-error-unexpected-prime = Sorry, I don't understand this use of prime notation.
shared-calculator-error-unexpected-subscript = Only functions and variables may have subscripts.
shared-calculator-error-unexpected-symbol = Sorry, I don't understand the way that '{ $symbol }' is used here.
shared-calculator-error-unplottable-polar-function = We can't plot \u03B8 as a function of r. Try plotting r(\u03B8) instead.
shared-calculator-error-unrecognized-symbol = Sorry, I don't understand the '{ $symbol }' symbol.
shared-calculator-error-update-rule-function-lhs = '{ $symbol }' cannot be updated because it is a function.
shared-calculator-error-update-rule-illegal-lhs = Variable '{ $symbol }' cannot be updated.
shared-calculator-error-update-rule-local-lhs = Variable '{ $symbol }' cannot be updated because it is locally defined.
shared-calculator-error-update-rule-non-identifier-lhs = The left hand side of '{ $arrow }' should be a variable name like '{ $example }'.
shared-calculator-error-update-rule-type-error = Cannot update a variable to { $symbol }.
shared-calculator-error-update-rule-undefined-lhs = Variable '{ $symbol }' must be defined to be updated.
shared-calculator-error-variable-as-function = Variable '{ $dependency }' can't be used as a function.
shared-calculator-error-variable-function-free-variable = Function '{ $functionSymbol }' cannot depend on free variable '{ $variableSymbol }'.
shared-calculator-error-variable-invalid-function-name = This calculator can not use '{ $symbol }' as a function name.
shared-calculator-error-variable-length-distribution-list = The length of a list of distributions can't depend on free variable '{ $symbol }'.
shared-calculator-error-variable-length-product-body-depends-on-index = Can't take the product of a list whose length depends on product index '{ $symbol }'.
shared-calculator-error-variable-length-sum-body-depends-on-index = Can't sum a list whose length depends on summation index '{ $symbol }'.
shared-calculator-error-variable-length-top-level-list = Can't plot a list whose length depends on free variable '{ $symbol }'.
shared-calculator-error-variable-seed = Random seed cannot depend on free variable '{ $symbol }'.
shared-calculator-error-variable-unsupported = This calculator does not support the '{ $symbol }' variable.
shared-calculator-error-variables-unsupported = This calculator does not support variables like '{ $variable }'.
shared-calculator-error-write-integral = Type '{ $command }' for { $symbol }.
shared-calculator-error-wrong-arity-many-arg = Function '{ $dependency }' requires { $assignment_arity } arguments. { $supplement }
shared-calculator-error-wrong-arity-single-arg-too-few = Function '{ $dependency }' requires an argument. { $supplement }
shared-calculator-error-wrong-arity-single-arg-too-many = Function '{ $dependency }' requires only 1 argument. { $supplement }
shared-calculator-error-wrong-arity-supplement = For example, try typing: { $recommendation }.
shared-calculator-error-wrong-two-arg-arity = Function '{ $symbol }' requires 2 arguments. For example, try typing: { $recommendation }.
shared-calculator-error-zero-arg-reducer = Function '{ $symbol }' requires at least one argument. For example, try typing: { $symbol }(1, 2).
shared-calculator-heading-function-table-column-header = Function
shared-calculator-heading-keyboard-shortcuts = Keyboard Shortcuts
shared-calculator-heading-keyboard-shortcuts-audio-tracing = Audio Tracing
shared-calculator-heading-keyboard-shortcuts-braille = Braille
shared-calculator-heading-keyboard-shortcuts-common-actions = Common Actions
shared-calculator-heading-keyboard-shortcuts-common-symbols = Common Symbols
shared-calculator-heading-keyboard-shortcuts-desmos-com-only = Desmos.com Only
shared-calculator-heading-keyboard-shortcuts-expression-entry-and-navigation = Expression Entry and Navigation
shared-calculator-heading-keyboard-shortcuts-geometry-expression-edit = Expression Edit
shared-calculator-heading-keyboard-shortcuts-geometry-graph-navigation-during-construction = Graph Navigation During Construction
shared-calculator-heading-keyboard-shortcuts-geometry-token-navigator = Token Navigator
shared-calculator-heading-keyboard-shortcuts-geometry-tool-selection = Tool Selection
shared-calculator-heading-keyboard-shortcuts-interactive-points = Interactive Points
shared-calculator-heading-keyboard-shortcuts-slider-trace = Slider Trace
shared-calculator-heading-keyboard-shortcuts-sliders = Sliders
shared-calculator-heading-keyboard-shortcuts-symbols = Symbols
shared-calculator-heading-keyboard-shortcuts-tables = Tables
shared-calculator-heading-mac-table-column-header = Mac Shortcut
shared-calculator-heading-windows-chrome-table-column-header = Windows / ChromeOS Shortcut
shared-calculator-label-os = Operating System
shared-calculator-label-saved = Saved!
shared-calculator-label-saving = Saving...
shared-calculator-label-search-results = Search Results
shared-calculator-label-toast-learn-more = Learn more
shared-calculator-label-toast-undo = Undo
shared-calculator-label-value-type-action = an action
shared-calculator-label-value-type-angle = an angle
shared-calculator-label-value-type-any = an unknown object
shared-calculator-label-value-type-arc = an arc
shared-calculator-label-value-type-bool = a true/false value
shared-calculator-label-value-type-circle = a circle
shared-calculator-label-value-type-color = a color
shared-calculator-label-value-type-directed-angle = a directed angle
shared-calculator-label-value-type-distribution = a distribution
shared-calculator-label-value-type-empty-list = an empty list
shared-calculator-label-value-type-error = an error object
shared-calculator-label-value-type-line = a line
shared-calculator-label-value-type-list-of-3d-points = a list of 3D points
shared-calculator-label-value-type-list-of-angles = a list of angles
shared-calculator-label-value-type-list-of-any = a list of unknown objects
shared-calculator-label-value-type-list-of-arcs = a list of arcs
shared-calculator-label-value-type-list-of-bool = a list of true/false values
shared-calculator-label-value-type-list-of-circles = a list of circles
shared-calculator-label-value-type-list-of-colors = a list of colors
shared-calculator-label-value-type-list-of-directed-angles = a list of directed angles
shared-calculator-label-value-type-list-of-distributions = a list of distributions
shared-calculator-label-value-type-list-of-lines = a list of lines
shared-calculator-label-value-type-list-of-numbers = a list of numbers
shared-calculator-label-value-type-list-of-points = a list of points
shared-calculator-label-value-type-list-of-polygons = a list of polygons
shared-calculator-label-value-type-list-of-rays = a list of rays
shared-calculator-label-value-type-list-of-segment3d = a list of 3d segments
shared-calculator-label-value-type-list-of-segments = a list of segments
shared-calculator-label-value-type-list-of-sphere3d = a list of 3d sphere
shared-calculator-label-value-type-list-of-transformations = a list of transformations
shared-calculator-label-value-type-list-of-triangle3d = a list of 3d triangles
shared-calculator-label-value-type-list-of-vector3d = a list of 3d vectors
shared-calculator-label-value-type-list-of-vectors = a list of vectors
shared-calculator-label-value-type-number = a number
shared-calculator-label-value-type-point = a point
shared-calculator-label-value-type-point3d = a 3d point
shared-calculator-label-value-type-polygon = a polygon
shared-calculator-label-value-type-ray = a ray
shared-calculator-label-value-type-seed = a string
shared-calculator-label-value-type-segment = a segment
shared-calculator-label-value-type-segment3d = a 3d segment
shared-calculator-label-value-type-sphere3d = a 3d sphere
shared-calculator-label-value-type-transformation = a transformation
shared-calculator-label-value-type-triangle3d = a 3d triangle
shared-calculator-label-value-type-vector = a vector
shared-calculator-label-value-type-vector3d = a 3d vector
shared-calculator-narration-author-mode = Author Mode
shared-calculator-narration-braille-mode = Braille Mode
shared-calculator-narration-control-toggle-switch-to-default = { $toggled } selected. Press Enter to switch to { $default }.
shared-calculator-narration-control-toggle-switch-to-toggled = { $default } selected. Press Enter to switch to { $toggled }.
shared-calculator-narration-disable-tool = Disable { $tool } when this condition is true
shared-calculator-narration-display-as-decimal = Displaying as fraction. Press Enter to display as Decimal
shared-calculator-narration-display-as-fraction = Displaying as decimal. Press Enter to display as Fraction
shared-calculator-narration-expression-index = Expression { $index }
shared-calculator-narration-expression-list = Expression List
shared-calculator-narration-hotkey-braille-mode-nemeth = Braille mode Nemeth
shared-calculator-narration-hotkey-braille-mode-off = Braille mode off
shared-calculator-narration-hotkey-braille-mode-ueb = Braille mode UEB
shared-calculator-narration-input-error = input has an error
shared-calculator-narration-item-clickable = { $item } clickable
shared-calculator-narration-item-selected = { $item } selected
shared-calculator-narration-item-unknown = Unknown
shared-calculator-narration-item-unselected = { $item } unselected
shared-calculator-narration-keypad = keypad
shared-calculator-narration-keypad-controlbar = Control Bar
shared-calculator-narration-keypad-key-10-n = Times ten to the power of
shared-calculator-narration-keypad-key-abs = Absolute Value
shared-calculator-narration-keypad-key-action-to = Set Value To
shared-calculator-narration-keypad-key-action-with = Substitute With
shared-calculator-narration-keypad-key-alpha = Alpha
shared-calculator-narration-keypad-key-angle = Angle
shared-calculator-narration-keypad-key-angles = Angles
shared-calculator-narration-keypad-key-ans = Answer
shared-calculator-narration-keypad-key-arc = Arc
shared-calculator-narration-keypad-key-arccos = Inverse Cosine
shared-calculator-narration-keypad-key-arccot = Inverse Cotangent
shared-calculator-narration-keypad-key-arccsc = Inverse Cosecant
shared-calculator-narration-keypad-key-arcsec = Inverse Secant
shared-calculator-narration-keypad-key-arcsin = Inverse Sine
shared-calculator-narration-keypad-key-arctan = Inverse Tangent
shared-calculator-narration-keypad-key-area = Area
shared-calculator-narration-keypad-key-backspace = Backspace
shared-calculator-narration-keypad-key-beta = Beta
shared-calculator-narration-keypad-key-binomialdist = Binomial Distribution
shared-calculator-narration-keypad-key-boxplot = Box Plot
shared-calculator-narration-keypad-key-ceil = Ceiling
shared-calculator-narration-keypad-key-center = Center
shared-calculator-narration-keypad-key-circle = Circle
shared-calculator-narration-keypad-key-corr = Correlation
shared-calculator-narration-keypad-key-cos = Cosine
shared-calculator-narration-keypad-key-cosh = Hyperbolic Cosine
shared-calculator-narration-keypad-key-cot = Cotangent
shared-calculator-narration-keypad-key-coterminal = Coterminal
shared-calculator-narration-keypad-key-coth = Hyperbolic Cotangent
shared-calculator-narration-keypad-key-cov = Co Variance
shared-calculator-narration-keypad-key-covp = Population Co Variance
shared-calculator-narration-keypad-key-csc = Cosecant
shared-calculator-narration-keypad-key-csch = Hyperbolic Cosecant
shared-calculator-narration-keypad-key-cubed = Cubed
shared-calculator-narration-keypad-key-decimal = Decimal
shared-calculator-narration-keypad-key-dilate = Dilate
shared-calculator-narration-keypad-key-directed-angle = Directed Angle
shared-calculator-narration-keypad-key-directed-angles = Directed Angles
shared-calculator-narration-keypad-key-distance = Distance
shared-calculator-narration-keypad-key-divide = Divide
shared-calculator-narration-keypad-key-dotplot = Dot Plot
shared-calculator-narration-keypad-key-enter = Enter
shared-calculator-narration-keypad-key-erf = Error Function
shared-calculator-narration-keypad-key-exp = Exponent
shared-calculator-narration-keypad-key-factorial = Factorial
shared-calculator-narration-keypad-key-floor = Floor
shared-calculator-narration-keypad-key-fraction = A over B
shared-calculator-narration-keypad-key-glider = Glider
shared-calculator-narration-keypad-key-histogram = Histogram
shared-calculator-narration-keypad-key-int = Integral
shared-calculator-narration-keypad-key-intersection = Intersection
shared-calculator-narration-keypad-key-inversecdf = Inverse CDF function
shared-calculator-narration-keypad-key-ittest = Independent T Test
shared-calculator-narration-keypad-key-left-arrow = Left Arrow
shared-calculator-narration-keypad-key-left-bracket = Left Bracket
shared-calculator-narration-keypad-key-left-paren = Left Parenthesis
shared-calculator-narration-keypad-key-line = Line
shared-calculator-narration-keypad-key-ln = Natural Log
shared-calculator-narration-keypad-key-log = Log
shared-calculator-narration-keypad-key-loga = Log A
shared-calculator-narration-keypad-key-mean = Mean
shared-calculator-narration-keypad-key-median = Median
shared-calculator-narration-keypad-key-midpoint = Midpoint
shared-calculator-narration-keypad-key-minus = Minus
shared-calculator-narration-keypad-key-normaldist = Normal Distribution
shared-calculator-narration-keypad-key-nthroot = Nth Root
shared-calculator-narration-keypad-key-parallel = Parallel
shared-calculator-narration-keypad-key-pdf = Probability Density Function
shared-calculator-narration-keypad-key-percent-of = Percent Of
shared-calculator-narration-keypad-key-perimeter = Perimeter
shared-calculator-narration-keypad-key-perpendicular = Perpendicular
shared-calculator-narration-keypad-key-pi = Pi
shared-calculator-narration-keypad-key-plus = Plus
shared-calculator-narration-keypad-key-poissondist = Poisson Distribution
shared-calculator-narration-keypad-key-polygon = Polygon
shared-calculator-narration-keypad-key-prime = Function derivative
shared-calculator-narration-keypad-key-product = Product
shared-calculator-narration-keypad-key-quantile = Quantile
shared-calculator-narration-keypad-key-quartile = Quartile
shared-calculator-narration-keypad-key-radius = Radius
shared-calculator-narration-keypad-key-random = Random Number
shared-calculator-narration-keypad-key-ray = Ray
shared-calculator-narration-keypad-key-reciprocal = Reciprocal
shared-calculator-narration-keypad-key-reflect = Reflect
shared-calculator-narration-keypad-key-right-arrow = Right Arrow
shared-calculator-narration-keypad-key-right-bracket = Right Bracket
shared-calculator-narration-keypad-key-right-paren = Right Parenthesis
shared-calculator-narration-keypad-key-rotate = Rotate
shared-calculator-narration-keypad-key-round = Round
shared-calculator-narration-keypad-key-sec = Secant
shared-calculator-narration-keypad-key-segment = Segment
shared-calculator-narration-keypad-key-segments = Segments
shared-calculator-narration-keypad-key-shift = Shift
shared-calculator-narration-keypad-key-sin = Sine
shared-calculator-narration-keypad-key-sinh = Hyperbolic Sine
shared-calculator-narration-keypad-key-spearman = Spearman Rank Correlation
shared-calculator-narration-keypad-key-sphere = Sphere
shared-calculator-narration-keypad-key-sqrt = Square Root
shared-calculator-narration-keypad-key-squared = Squared
shared-calculator-narration-keypad-key-stats = Summary statistics
shared-calculator-narration-keypad-key-stdev = Standard Deviation
shared-calculator-narration-keypad-key-stdevp = Standard Deviation of Population
shared-calculator-narration-keypad-key-subscript = Subscript
shared-calculator-narration-keypad-key-sum = Sum
shared-calculator-narration-keypad-key-superscript = Superscript
shared-calculator-narration-keypad-key-supplement = Supplement
shared-calculator-narration-keypad-key-tan = Tangent
shared-calculator-narration-keypad-key-tanh = Hyperbolic Tangent
shared-calculator-narration-keypad-key-tau = Tau
shared-calculator-narration-keypad-key-tdist = Student-t Distribution
shared-calculator-narration-keypad-key-theta = Theta
shared-calculator-narration-keypad-key-times = Times
shared-calculator-narration-keypad-key-toggle-audio-trace = Toggle Audio Trace
shared-calculator-narration-keypad-key-toggle-letters = Toggle Letters
shared-calculator-narration-keypad-key-toggle-numbers = Toggle Numbers
shared-calculator-narration-keypad-key-translate = Translate
shared-calculator-narration-keypad-key-triangle = Triangle
shared-calculator-narration-keypad-key-tscore = T Score
shared-calculator-narration-keypad-key-ttest = T Test
shared-calculator-narration-keypad-key-uniformdist = Uniform Distribution
shared-calculator-narration-keypad-key-vector = Vector
shared-calculator-narration-keypad-key-vertices = Vertices
shared-calculator-narration-keypad-key-ythroot = Yth Root
shared-calculator-narration-keypad-plus-minus = Plus-Minus
shared-calculator-narration-math-input-error-message = expression has error
shared-calculator-narration-settings-display-size = Display Size
shared-calculator-narration-settings-display-size-default = Display size: default
shared-calculator-narration-settings-display-size-large = Display size: large
shared-calculator-narration-show-as-decimal = Show as Decimal
shared-calculator-narration-show-as-fraction = Show as Fraction
shared-calculator-narration-six-key-mode-off = Six Key Braille Input off
shared-calculator-narration-six-key-mode-on = Six Key Braille Input on
shared-calculator-text-customize-toolbar = Customize the Toolbar
shared-calculator-text-keyboard-shortcut-add-expression = Add an Expression
shared-calculator-text-keyboard-shortcut-add-folder = Add a Folder
shared-calculator-text-keyboard-shortcut-add-image = Add an Image
shared-calculator-text-keyboard-shortcut-add-note = Add a Note
shared-calculator-text-keyboard-shortcut-add-table = Add a Table
shared-calculator-text-keyboard-shortcut-adjust-playback-speed = Adjust Playback Speed (1 = slowest, 5 = fastest)
shared-calculator-text-keyboard-shortcut-announce-slider-animations = Announce Active Slider Animations
shared-calculator-text-keyboard-shortcut-beginning-of-block = Beginning of Current Block
shared-calculator-text-keyboard-shortcut-beginning-of-expression = Beginning of Current Expression
shared-calculator-text-keyboard-shortcut-close-a-dialog = Close a Dialog
shared-calculator-text-keyboard-shortcut-collapse-all-folders = Collapse All Folders
shared-calculator-text-keyboard-shortcut-collapse-folder = Collapse Selected Folder
shared-calculator-text-keyboard-shortcut-decrease-volume = Decrease Volume
shared-calculator-text-keyboard-shortcut-decrease-x = Decrease X
shared-calculator-text-keyboard-shortcut-decrease-x-larger = Decrease X by Larger Amount
shared-calculator-text-keyboard-shortcut-decrease-y = Decrease Y
shared-calculator-text-keyboard-shortcut-decrease-y-larger = Decrease Y by Larger Amount
shared-calculator-text-keyboard-shortcut-degrees-toggle = Toggle Between Degrees and Radians
shared-calculator-text-keyboard-shortcut-delete-expression = Delete the Expression that has Keyboard Focus
shared-calculator-text-keyboard-shortcut-delete-selection = Delete Selection
shared-calculator-text-keyboard-shortcut-describe-axes = Describe the graph axes
shared-calculator-text-keyboard-shortcut-end-of-block = End of Current Block
shared-calculator-text-keyboard-shortcut-end-of-expression = End of Current Expression
shared-calculator-text-keyboard-shortcut-exit-block = Exit Current Block
shared-calculator-text-keyboard-shortcut-expand-all-folders = Expand All Folders
shared-calculator-text-keyboard-shortcut-expand-folder = Expand Selected Folder
shared-calculator-text-keyboard-shortcut-first-point = First Point
shared-calculator-text-keyboard-shortcut-focus-expression-list = Focus the Expression List
shared-calculator-text-keyboard-shortcut-focus-first-interactive-point = Focus First Interactive Point On Screen
shared-calculator-text-keyboard-shortcut-focus-graph-paper = Focus the Graph Paper
shared-calculator-text-keyboard-shortcut-geometry-add-object-to-selection = Add Object that has Keyboard Focus to Group of Selected Items (when box-select is active)
shared-calculator-text-keyboard-shortcut-geometry-add-object-token-to-selection = Add an Object Token to Selection
shared-calculator-text-keyboard-shortcut-geometry-cancel-active-tool = Cancel Active Tool
shared-calculator-text-keyboard-shortcut-geometry-choose-toolbar-item-and-focus-graph = Select a Tool and Focus the Graph
shared-calculator-text-keyboard-shortcut-geometry-close-token-navigator = Close Token navigator
shared-calculator-text-keyboard-shortcut-geometry-delete-selected-objects = Delete Selected Object(s)
shared-calculator-text-keyboard-shortcut-geometry-describe-object = Describe Object that has Keyboard Focus
shared-calculator-text-keyboard-shortcut-geometry-deselect-all-objects = Deselect All Objects
shared-calculator-text-keyboard-shortcut-geometry-drag-movable-objects = Drag All Movable Objects
shared-calculator-text-keyboard-shortcut-geometry-expression-edit-add-object = Add Object that has Keyboard Focus to Expression
shared-calculator-text-keyboard-shortcut-geometry-expression-edit-complete = Finish Editing and Return to Expression List (When All Required Objects Have Been Added)
shared-calculator-text-keyboard-shortcut-geometry-expression-edit-next-object = Move to Next Valid Object for the Active Expression
shared-calculator-text-keyboard-shortcut-geometry-expression-edit-previous-object = Move to Previous Valid Object for the Active Expression
shared-calculator-text-keyboard-shortcut-geometry-focus-selected-objects-toolbar = Focus the Toolbar for the Selected Object(s)
shared-calculator-text-keyboard-shortcut-geometry-focus-toolbar = Focus the Geometry Toolbar
shared-calculator-text-keyboard-shortcut-geometry-move-between-toolbar-categories = Move Between Categories in the Toolbar
shared-calculator-text-keyboard-shortcut-geometry-move-between-toolbar-dropdown-items = Move Through Tools in a Dropdown
shared-calculator-text-keyboard-shortcut-geometry-move-to-bottom-of-graph = Move to Bottom Edge of Graph
shared-calculator-text-keyboard-shortcut-geometry-move-to-left-of-graph = Move to Left Edge of Graph
shared-calculator-text-keyboard-shortcut-geometry-move-to-right-of-graph = Move to Right Edge of Graph
shared-calculator-text-keyboard-shortcut-geometry-move-to-top-of-graph = Move to Top Edge of Graph
shared-calculator-text-keyboard-shortcut-geometry-move-token-between-expression-list-and-navigator = Move an Object Token Between the Expression List and Navigator
shared-calculator-text-keyboard-shortcut-geometry-navigate-graph = Move to Add Point
shared-calculator-text-keyboard-shortcut-geometry-navigate-object-levels = Navigate Between Object Levels
shared-calculator-text-keyboard-shortcut-geometry-navigate-tokens-at-current-level = Move Between Object Tokens at Current Level
shared-calculator-text-keyboard-shortcut-geometry-next-object = Give Attention to Next Valid Object for the Active Tool
shared-calculator-text-keyboard-shortcut-geometry-open-options = Open Options for the Selected Object(s)
shared-calculator-text-keyboard-shortcut-geometry-open-token-navigator = Open Token navigator
shared-calculator-text-keyboard-shortcut-geometry-open-transformation-options = Open Transformation Options for Selected Object
shared-calculator-text-keyboard-shortcut-geometry-previous-object = Give Attention to Previous Valid Object for the Active Tool
shared-calculator-text-keyboard-shortcut-geometry-repeat-active-tool-prompt = Repeat Active Tool Prompt
shared-calculator-text-keyboard-shortcut-geometry-select-next-category = Select Next Construction Tool Category
shared-calculator-text-keyboard-shortcut-geometry-select-next-tool-within-category = Select Next Tool within Active Category
shared-calculator-text-keyboard-shortcut-geometry-select-previous-category = Select Previous Construction Tool Category
shared-calculator-text-keyboard-shortcut-geometry-select-previous-tool-within-category = Select Previous Tool within Active Category
shared-calculator-text-keyboard-shortcut-geometry-select-single-object-token = Select a Single Object Token
shared-calculator-text-keyboard-shortcut-geometry-select-tool-by-number = Select the nth Construction Tool Category
shared-calculator-text-keyboard-shortcut-hear-graph = Hear Graph
shared-calculator-text-keyboard-shortcut-hear-specific-branch = Hear Only Branch 1 Through 10
shared-calculator-text-keyboard-shortcut-increase-selection-left = Increase Selection Left
shared-calculator-text-keyboard-shortcut-increase-selection-right = Increase Selection Right
shared-calculator-text-keyboard-shortcut-increase-volume = Increase Volume
shared-calculator-text-keyboard-shortcut-increase-x = Increase X
shared-calculator-text-keyboard-shortcut-increase-x-larger = Increase X by Larger Amount
shared-calculator-text-keyboard-shortcut-increase-y = Increase Y
shared-calculator-text-keyboard-shortcut-increase-y-larger = Increase Y by Larger Amount
shared-calculator-text-keyboard-shortcut-keypad-toggle = Show or Hide the Keypad
shared-calculator-text-keyboard-shortcut-last-point = Last Point
shared-calculator-text-keyboard-shortcut-move-to-denominator = Move to Denominator Within Fraction
shared-calculator-text-keyboard-shortcut-move-to-numerator = Move to Numerator Within Fraction
shared-calculator-text-keyboard-shortcut-move-to-origin = Move to Origin
shared-calculator-text-keyboard-shortcut-nemeth-mode = Switch to Nemeth
shared-calculator-text-keyboard-shortcut-next-character = Next Character
shared-calculator-text-keyboard-shortcut-next-curve = Move to Next Curve
shared-calculator-text-keyboard-shortcut-next-expression = Move to Next Expression
shared-calculator-text-keyboard-shortcut-next-interactive-point = Go to Next Interactive Point
shared-calculator-text-keyboard-shortcut-next-poi = Next Point of Interest
shared-calculator-text-keyboard-shortcut-next-point = Next Point
shared-calculator-text-keyboard-shortcut-open-a-graph = Open a Graph
shared-calculator-text-keyboard-shortcut-open-expression-options = Open Options for the Expression that has Keyboard Focus
shared-calculator-text-keyboard-shortcut-open-shortcuts-dialog = Open Keyboard Shortcuts Dialog
shared-calculator-text-keyboard-shortcut-previous-character = Previous Character
shared-calculator-text-keyboard-shortcut-previous-curve = Move to Previous Curve
shared-calculator-text-keyboard-shortcut-previous-expression = Move to Previous Expression
shared-calculator-text-keyboard-shortcut-previous-interactive-point = Go to Previous Interactive Point
shared-calculator-text-keyboard-shortcut-previous-poi = Previous Point of Interest
shared-calculator-text-keyboard-shortcut-previous-point = Previous Point
shared-calculator-text-keyboard-shortcut-print-a-graph = Print a Graph
shared-calculator-text-keyboard-shortcut-print-mode = Switch to Print
shared-calculator-text-keyboard-shortcut-redo = Redo
shared-calculator-text-keyboard-shortcut-remove-empty-expression = Remove Selected Empty Expression
shared-calculator-text-keyboard-shortcut-save-a-graph = Save a Graph
shared-calculator-text-keyboard-shortcut-select-all = Select All
shared-calculator-text-keyboard-shortcut-show-answer-as-decimal-or-fraction = Show Answer as Decimal or Fraction
shared-calculator-text-keyboard-shortcut-show-or-hide-expression-list = Show or Hide the Expression List
shared-calculator-text-keyboard-shortcut-slider-decrease = Decrease Value
shared-calculator-text-keyboard-shortcut-slider-decrease-larger = Decrease Value by Larger Increment
shared-calculator-text-keyboard-shortcut-slider-increase = Increase Value
shared-calculator-text-keyboard-shortcut-slider-increase-larger = Increase Value by Larger Increment
shared-calculator-text-keyboard-shortcut-slider-maximum = Highest Value
shared-calculator-text-keyboard-shortcut-slider-minimum = Lowest Value
shared-calculator-text-keyboard-shortcut-slider-trace-decrease = Decrease Value of Selected Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-decrease-larger = Decrease Value of Selected Slider by Larger Increment When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-increase = Increase Value of Selected Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-increase-larger = Increase Value of Selected Slider by Larger Increment When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-maximum = Move to Highest Value of Selected Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-minimum = Move to Lowest Value of Selected Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-next-slider = Select Next Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-previous-slider = Select Previous Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-speak-answer = Speak Answer
shared-calculator-text-keyboard-shortcut-speak-branch = Speak Branch
shared-calculator-text-keyboard-shortcut-speak-color = Speak Color
shared-calculator-text-keyboard-shortcut-speak-focused-block = Speak Block that has Keyboard Focus
shared-calculator-text-keyboard-shortcut-speak-label = Speak Label
shared-calculator-text-keyboard-shortcut-speak-left-adjacent-block = Speak Left-Adjacent Block
shared-calculator-text-keyboard-shortcut-speak-parent-block = Speak Parent Block
shared-calculator-text-keyboard-shortcut-speak-poi-count = Speak Point of Interest Count
shared-calculator-text-keyboard-shortcut-speak-point-type = Speak Type of Selected Point
shared-calculator-text-keyboard-shortcut-speak-right-adjacent-block = Speak Right-Adjacent Block
shared-calculator-text-keyboard-shortcut-speak-selection = Speak Selection
shared-calculator-text-keyboard-shortcut-speak-x = Speak X Coordinate
shared-calculator-text-keyboard-shortcut-speak-y = Speak Y Coordinate
shared-calculator-text-keyboard-shortcut-summarize-graph = Summarize Selected Curve
shared-calculator-text-keyboard-shortcut-switch-pane-in-3d-quest = Move Between Expression List and Quest Instruction Pane
shared-calculator-text-keyboard-shortcut-table-first-column = First Column in Row
shared-calculator-text-keyboard-shortcut-table-first-row = First Row in Column
shared-calculator-text-keyboard-shortcut-table-last-column = Last Column in Row
shared-calculator-text-keyboard-shortcut-table-last-row = Last Row in Column
shared-calculator-text-keyboard-shortcut-table-next-cell = Next Cell
shared-calculator-text-keyboard-shortcut-table-next-column = Next Column
shared-calculator-text-keyboard-shortcut-table-next-row = Next Row
shared-calculator-text-keyboard-shortcut-table-previous-cell = Previous Cell
shared-calculator-text-keyboard-shortcut-table-previous-column = Previous Column
shared-calculator-text-keyboard-shortcut-table-previous-row = Previous Row
shared-calculator-text-keyboard-shortcut-table-speak-column-header = Speak Column Header
shared-calculator-text-keyboard-shortcut-toggle-account-menu = Open or Close the Account Menu
shared-calculator-text-keyboard-shortcut-toggle-audio-trace = Enable or Disable Audio Trace Mode
shared-calculator-text-keyboard-shortcut-toggle-braille-typing = Turn Braille Typing On or Off
shared-calculator-text-keyboard-shortcut-toggle-edit-list-mode = Turn Edit List Mode On or Off
shared-calculator-text-keyboard-shortcut-toggle-graph-settings-menu = Open or Close the Graph Settings Menu
shared-calculator-text-keyboard-shortcut-toggle-help-menu = Open or Close the Help Menu
shared-calculator-text-keyboard-shortcut-toggle-language-menu = Open or Close the Language Menu
shared-calculator-text-keyboard-shortcut-toggle-share-menu = Open or Close the Share Menu
shared-calculator-text-keyboard-shortcut-toggle-slider-trace = Toggle Slider Trace Mode
shared-calculator-text-keyboard-shortcut-ueb-mode = Switch to UEB
shared-calculator-text-keyboard-shortcut-undo = Undo
shared-calculator-text-keyboard-shortcut-zoom-fit = Zoom to Fit
shared-calculator-text-keyboard-shortcut-zoom-in = Zoom In
shared-calculator-text-keyboard-shortcut-zoom-out = Zoom Out
shared-calculator-text-keyboard-shortcut-zoom-restore-default = Restore Default Viewport
shared-calculator-text-search-results =
    { $count ->
        [0] No results.
        [one] 1 result.
       *[other] { $count } results.
    }
shared-label-email = Email
shared-label-family-name = Last Name (optional)
shared-label-given-name-or-nickname = First Name or Nickname
shared-label-name = Name
shared-label-new-email-address = New Email Address
shared-label-opens-in-new-tab = (opens in new tab)
shared-label-password = Password
shared-label-to = to
shared-message-account-reactivated = You previously requested to delete your account, but because you logged back in within 30 days, we will not delete your account. Welcome back!
shared-message-change-password-email-sent = We will send a link to your email address ({ $emailAddress }) so you can change your password.
shared-message-check-email-for-delete-link = Please check your email ({ $emailAddress }) for the link to delete your account.
shared-message-check-email-for-link = Please check { $emailAddress } for the Change Email link.
shared-message-check-email-for-password-link = Please check your email ({ $emailAddress }) for the link to change your password.
shared-message-check-email-for-password-recovery-link = Message sent. Please check your email for a password recovery link.
shared-message-consent-delete-information = If you don't want Desmos to hold onto this information, you may delete your account from the Account Settings menu at any time.
shared-message-consent-information = When you created your Desmos account, you gave us your name, email address, and password (unless you signed in with Google, in which case you gave us access to the name and email address associated with that account). You also gave us access to your saved work. To continue using your Desmos account, please consent below to the collection of this information.
shared-message-consent-text = I agree to let Desmos store and maintain the information I provide (e.g. login credentials, saved work) in order to provide and improve its service. To withdraw consent, you may delete your account at any time.
shared-message-cookie-notice = <1>Note:</1> Desmos uses cookies to enable persistence when you are signed in. If you do not wish to use cookies, please use Desmos without logging in. <2>Learn More.</2>
shared-message-delete-account-notice = When you delete your account, <1>we will retain your data for 30 days.</1> You can reactivate your account at any time during those 30 days by logging back in. If there's something about Desmos we can improve, please <2>let us know.</2>
shared-message-delete-account-will-send-email = We will send you a link to your email address ({ $email }) so you can delete your account.
shared-message-email-sent = Email sent
shared-message-email-settings-will-send-email = We will send a Change Email link to { $emailAddress }.
shared-message-google-login-not-available = Google Login is not available on this device.
shared-message-information-saved = Saved!
shared-message-or-login-with-desmos = Or log in with Desmos
shared-message-please-review-name = We tried to split your name into first and last name. Please review your name below and edit any mistakes.
shared-message-privacy-notice = I have read, understand, and accept the <1>Terms of Service</1> and <2>Privacy Policy</2>.
shared-message-set-new-email-address = Set a new email address and password.
shared-prompt-already-have-account = Already have a Desmos account?
shared-prompt-enter-email-for-password-recovery-link = Enter your email address to get a password recovery link.
shared-prompt-forgot-your-password = Forgot your password?
shared-prompt-new-to-desmos-sign-up-here = New to Desmos? <1>Sign up</1>.
shared-prompt-new-to-desmos-teacher-or-student = New to Desmos? <1>Sign up!</1>
shared-prompt-please-consent-to-sign-up-with-apple = Please consent above to sign up with Apple
shared-prompt-please-consent-to-sign-up-with-google = Please consent above to sign up with Google
shared-prompt-sign-up-with-apple = Sign up with Apple
shared-prompt-sign-up-with-google = Sign up with Google
shared-title-account-reactivated = Your account has been reactivated.
shared-title-account-settings = Account Settings
shared-title-change-email-address = Change your Desmos email address
shared-title-change-password-narrow = Password
shared-title-change-password-wide = Change Password
shared-title-consent = We value your privacy
shared-title-delete-account = Are you sure you want to delete your account?
shared-title-email-settings = Email
shared-title-language-menu = Language
shared-title-login = Log In
shared-title-profile-information-narrow = Profile
shared-title-profile-information-wide = Profile Information
shared-title-recover-password = Recover Password
shared-title-signup = Sign-Up
basic-calculator-button-controlbar-abc = abc
basic-calculator-button-controlbar-clear = clear
basic-calculator-button-controlbar-clear-all = clear all
basic-calculator-button-controlbar-func = func
basic-calculator-button-controlbar-main = main
basic-calculator-button-turn-braille-mode-off = Turn { $mode } off
basic-calculator-error-fractions-unavailable = Fractions are not available in the current calculator.
basic-calculator-heading-braille-table-type-this = Type this
basic-calculator-heading-braille-table-typeset = Typeset
basic-calculator-label-answer-hint = Your answers show up on this side.
basic-calculator-label-controlbar-deg = deg
basic-calculator-label-controlbar-rad = rad
basic-calculator-label-convert-to-decimal = Convert to decimal.
basic-calculator-label-convert-to-fraction = Convert to fraction.
basic-calculator-label-reverse-contrast = Reverse Contrast
basic-calculator-label-six-key-input = Six Key Braille Input
basic-calculator-link-download-braille-equations = Download Braille Equations
basic-calculator-link-view-braille-examples = View more examples
basic-calculator-narration-calc-description-fourfunction = Desmos Four-Function Calculator
basic-calculator-narration-calc-description-scientific = Desmos Scientific Calculator
basic-calculator-narration-controlbar-abc = A B C
basic-calculator-narration-controlbar-backspace = backspace
basic-calculator-narration-controlbar-clear = clear
basic-calculator-narration-controlbar-clear-all = clear all
basic-calculator-narration-controlbar-degrees = Degrees
basic-calculator-narration-controlbar-functions = Functions
basic-calculator-narration-controlbar-main = main
basic-calculator-narration-controlbar-radians = Radians
basic-calculator-narration-controlbar-redo = Redo
basic-calculator-narration-controlbar-settings = settings
basic-calculator-narration-controlbar-undo = Undo
basic-calculator-narration-convert-to-decimal = Displaying as fraction. Press Enter to display as Decimal
basic-calculator-narration-convert-to-fraction = Displaying as decimal. Press Enter to display as Fraction
basic-calculator-narration-hotkey-six-key-input-off = Six Key Braille Input off
basic-calculator-narration-hotkey-six-key-input-on = Six Key Braille Input on
basic-calculator-text-braille-mode-is-on = { $mode } is on!
basic-calculator-text-how-to-type-braille = Use a Refreshable Braille display, or just type Braille with a keyboard.
geometry-label-construct-instruction = Click down here to construct
geometry-label-example-construction-30-60-90 = 30-60-90 Triangle Animation
geometry-label-example-construction-angles-of-quadrilateral = Angles of a Quadrilateral
geometry-label-example-construction-equilateral-triangle = Equilateral Triangle
geometry-label-example-construction-euler-line = The Euler Line
geometry-label-example-construction-inscribed-triangle = Inscribed Triangle
geometry-label-example-construction-perpendicular-bisector = Perpendicular Bisector
geometry-label-example-construction-pinwheel = Pinwheel
geometry-label-example-construction-rainbow-pinwheel = Rainbow Pinwheel
geometry-label-example-construction-rotation-with-slider = Rotating with a Slider
geometry-label-example-construction-string-art = String Art
geometry-label-example-construction-triangle-area-and-perimeter = Triangle Area and Perimeter
geometry-label-example-construction-two-reflections = Two Reflections
geometry-label-pick-tool-instruction = Pick a tool to get started
graphing-calculator-button-audio-trace-hear-graph = Hear Graph
graphing-calculator-button-audio-trace-stop-graph = Stop Graph
graphing-calculator-button-change-image = Change Image
graphing-calculator-button-clear-graph = Delete All
graphing-calculator-button-done = Done
graphing-calculator-button-draggable = Draggable
graphing-calculator-button-edit-graph-on-desmos-logo = edit graph on
graphing-calculator-button-editable-math = Editable Math
graphing-calculator-button-editable-text = Editable Text
graphing-calculator-button-find-cdf = Find Cumulative Probability (CDF)
graphing-calculator-button-funcs = funcs
graphing-calculator-button-functions = functions
graphing-calculator-button-functions-menu-custom-colors = Custom Colors
graphing-calculator-button-functions-menu-number-theory = Number Theory
graphing-calculator-button-geometry-label-points-checkbox = Label Points
graphing-calculator-button-hide-folder-from-students-2 = Hide this folder from students.
graphing-calculator-button-keypad-audio-trace-off = Audio Trace Off
graphing-calculator-button-keypad-describe-axes = Describe Axes
graphing-calculator-button-keypad-describe-curve = Describe Curve
graphing-calculator-button-keypad-describe-curve-short = Curve
graphing-calculator-button-keypad-describe-point = Describe Point
graphing-calculator-button-keypad-describe-point-short = Point
graphing-calculator-button-label = Label
graphing-calculator-button-label-editable = Editable
graphing-calculator-button-label-show-on-hover = Show on hover
graphing-calculator-button-label-text-outline = Text outline
graphing-calculator-button-load-image-retry = Retry.
graphing-calculator-button-move-to-folder-action = Move
graphing-calculator-button-place-image-behind-graphs = Place behind graphs
graphing-calculator-button-regression-log-mode = Log Mode
graphing-calculator-button-regression-plot-residuals = plot
graphing-calculator-button-replace = Replace
graphing-calculator-button-reset-graph = Reset
graphing-calculator-button-settings-degrees = Degrees
graphing-calculator-button-settings-radians = Radians
graphing-calculator-button-settings-zoom-square = Zoom Square
graphing-calculator-button-share-graph-link-copy = Copy
graphing-calculator-button-show-all-table-rows = Show all
graphing-calculator-button-slider-add-all-variables = all
graphing-calculator-button-visual-parameters-binned = Binned
graphing-calculator-button-visual-parameters-center = Center
graphing-calculator-button-visual-parameters-count = Count
graphing-calculator-button-visual-parameters-density = Density
graphing-calculator-button-visual-parameters-exact = Exact
graphing-calculator-button-visual-parameters-exclude-outliers = Exclude Outliers
graphing-calculator-button-visual-parameters-left = Left
graphing-calculator-button-visual-parameters-relative = Relative
graphing-calculator-error-equation-contains-unresolved-details = This equation contains fine detail that has not been fully resolved.
graphing-calculator-error-expression-replacement = Replacement must be a valid function or variable name.
graphing-calculator-error-expression-search = Can only rename a valid function or variable name.
graphing-calculator-error-failed-to-load-image = Failed to load image.
graphing-calculator-error-image-invalid-angle = Invalid angle. Try using any number.
graphing-calculator-error-image-invalid-center = Invalid center. Try, for example, (0,0).
graphing-calculator-error-image-invalid-file = The file "{ $file }" is not an image
graphing-calculator-error-image-invalid-height = Invalid height. Try using any number.
graphing-calculator-error-image-invalid-opacity = Invalid opacity. Try using any number.
graphing-calculator-error-image-invalid-width = Invalid width. Try using any number.
graphing-calculator-error-log-axes-image = Cannot plot images on a log scale.
graphing-calculator-heading-advanced = Advanced
graphing-calculator-heading-audio-trace-describe = Describe
graphing-calculator-heading-audio-trace-navigation = Navigation
graphing-calculator-heading-audio-trace-screen-reader = Screen Reader
graphing-calculator-heading-calculus = Calculus
graphing-calculator-heading-clickable = Clickable
graphing-calculator-heading-dist-tab-distributions = Distributions
graphing-calculator-heading-dist-tab-visualizations = Visualizations
graphing-calculator-heading-drag = Drag
graphing-calculator-heading-fill = Fill
graphing-calculator-heading-functions-menu-advanced = Advanced
graphing-calculator-heading-geometry = Geometry
graphing-calculator-heading-geometry-measurements = Properties & Measurements
graphing-calculator-heading-geometry-tools = Geometry Tools
graphing-calculator-heading-geometry-transformations = Transformations
graphing-calculator-heading-hyperbolic-trig = Hyperbolic Trig Functions
graphing-calculator-heading-image-opacity = Opacity
graphing-calculator-heading-inverse-trig = Inverse Trig Functions
graphing-calculator-heading-keypad-audio-trace-point-of-interest = <1>Point</1><2>of Interest</2>
graphing-calculator-heading-label = Label
graphing-calculator-heading-label-orientation = Orientation
graphing-calculator-heading-lines = Lines
graphing-calculator-heading-lists = List Operations
graphing-calculator-heading-points = Points
graphing-calculator-heading-quest = Quest: { $title }
graphing-calculator-heading-quests = Quests
graphing-calculator-heading-regression-parameters = Parameters
graphing-calculator-heading-regression-residuals = Residuals
graphing-calculator-heading-regression-statistics = Statistics
graphing-calculator-heading-slider-animation-mode = Animation Mode
graphing-calculator-heading-slider-speed = Speed
graphing-calculator-heading-stat-tests = Statistical Tests
graphing-calculator-heading-stats = Statistics
graphing-calculator-heading-style = Style
graphing-calculator-heading-surfaces = Surfaces
graphing-calculator-heading-trig = Trig Functions
graphing-calculator-heading-visual-parameters-bar-heights = Bar Heights
graphing-calculator-heading-visual-parameters-bin-alignment = Bin Alignment
graphing-calculator-heading-visual-parameters-display-properties = Display Properties
graphing-calculator-heading-visual-parameters-x-values = X Values
graphing-calculator-label-add-depressed-image-tooltip = Add Depressed Image
graphing-calculator-label-add-hovered-image-tooltip = Add Hovered Image
graphing-calculator-label-add-item-tooltip = Add Item
graphing-calculator-label-add-slider = add slider:
graphing-calculator-label-angle-tooltip = Angle
graphing-calculator-label-animation-properties-tooltip = Animation Properties
graphing-calculator-label-audio-trace-curve = Curve
graphing-calculator-label-audio-trace-need-screen-reader = Your Screen Reader needs to be on to hear these.
graphing-calculator-label-audio-trace-point = Point
graphing-calculator-label-audio-trace-speed = Speed
graphing-calculator-label-audio-trace-volume = Volume
graphing-calculator-label-axes = Axes
graphing-calculator-label-braille-size-etc11 = ETC Romeo/Juliet (11.5 x 11 in)
graphing-calculator-label-braille-size-etc8 = ETC Romeo/Juliet (8.5 x 11 in)
graphing-calculator-label-braille-size-vpmax11 = VP Max (11.5 x 11 in)
graphing-calculator-label-braille-size-vpmax8 = VP Max (8.5 x 11 in)
graphing-calculator-label-cdf-maximum = Max:
graphing-calculator-label-cdf-minimum = Min:
graphing-calculator-label-change-depressed-image-tooltip = Change Depressed Image
graphing-calculator-label-change-hovered-image-tooltip = Change Hovered Image
graphing-calculator-label-checkers = Number of checkers on a side
graphing-calculator-label-convert-to-table-tooltip = Convert to Table
graphing-calculator-label-create-table = Create Table
graphing-calculator-label-depressed = Depressed
graphing-calculator-label-disable-zoom = Disable zooming
graphing-calculator-label-display-properties = Preferences
graphing-calculator-label-drop-image-here = Drop Image Here
graphing-calculator-label-duplicate-expression-tooltip = Duplicate
graphing-calculator-label-edit-graph-bounds = Graph Bounds
graphing-calculator-label-edit-list-tooltip = Edit List
graphing-calculator-label-evaluation-list = { $count } element list
graphing-calculator-label-expression-delete-tooltip = Delete
graphing-calculator-label-expression-lowercase = expression
graphing-calculator-label-extend-to-3d = Extend to 3D
graphing-calculator-label-folder-lowercase = folder
graphing-calculator-label-geometry-move-to-folder-placeholder = Folder name
graphing-calculator-label-geometry-tools = Geometry Tools
graphing-calculator-label-geometry-tools-dropdown-menu-angle = Angle tools
graphing-calculator-label-geometry-tools-dropdown-menu-circle = Circle tools
graphing-calculator-label-geometry-tools-dropdown-menu-line = Line tools
graphing-calculator-label-geometry-tools-dropdown-menu-point = Point tools
graphing-calculator-label-geometry-tools-dropdown-menu-polygon = Polygon tools
graphing-calculator-label-geometry-tools-dropdown-menu-selection = Selection tools
graphing-calculator-label-geometry-tools-dropdown-menu-transformation = Transformation tools
graphing-calculator-label-geometry-tools-open-dropdown-menu-transformation = Open { $item } menu
graphing-calculator-label-hide-expression-list-tooltip = Hide Expression List
graphing-calculator-label-hide-keypad = Hide Keypad
graphing-calculator-label-hovered = Hovered
graphing-calculator-label-image-angle = Angle:
graphing-calculator-label-image-center = Center:
graphing-calculator-label-image-height = Height:
graphing-calculator-label-image-lowercase = image
graphing-calculator-label-image-opacity = Opacity:
graphing-calculator-label-image-width = Width:
graphing-calculator-label-label-size-tooltip = Label Scale Factor
graphing-calculator-label-line-thickness-3d-tooltip = Line Thickness
graphing-calculator-label-line-thickness-tooltip = Line Thickness (px)
graphing-calculator-label-list-index = Use <1>index</1> to reference the clicked index in the list.
graphing-calculator-label-lock-expression-tooltip = Prevent Editing
graphing-calculator-label-more-viewport-options = More Options
graphing-calculator-label-new-transformation = New Transformation
graphing-calculator-label-note-lowercase = note
graphing-calculator-label-opacity-tooltip = Opacity (0 to 1)
graphing-calculator-label-open-graph-tooltip = Open Graph (ctrl+o)
graphing-calculator-label-poi-unknown = unknown coordinates
graphing-calculator-label-point-size-3d-tooltip = Point Size
graphing-calculator-label-point-size-tooltip = Point Size (px)
graphing-calculator-label-powered-by = powered by
graphing-calculator-label-randomize-tooltip = Randomize
graphing-calculator-label-recent-transformations = Recent Transformations
graphing-calculator-label-recenter = Center Origin
graphing-calculator-label-redo-tooltip = Redo (ctrl+y)
graphing-calculator-label-reference-count =
    { $count ->
        [one] (1 reference)
       *[other] ({ $count } references)
    }
graphing-calculator-label-regression-log-mode-help-tooltip = Log mode help
graphing-calculator-label-regression-parameters-not-exact = Parameters might not be exact. Click to learn more.
graphing-calculator-label-regression-what-is-rmse-tooltip = What is RMSE? Click to learn more.
graphing-calculator-label-regression-why-is-negative-tooltip = Why is this negative? Click to learn more.
graphing-calculator-label-remove-depressed-image = Remove depressed image
graphing-calculator-label-remove-hovered-image = Remove hovered image
graphing-calculator-label-rename = rename
graphing-calculator-label-resolution-tooltip = 3D Grid Sample Resolution
graphing-calculator-label-search-expressions = Search this graph
graphing-calculator-label-settings-all-axes = All axes:
graphing-calculator-label-settings-arrows = Arrows
graphing-calculator-label-settings-axis-labels-3d = Labels
graphing-calculator-label-settings-axis-numbers = Axis Numbers
graphing-calculator-label-settings-domain-plane = XY plane
graphing-calculator-label-settings-grid = Grid
graphing-calculator-label-settings-hidden-objects = Reveal { $count } hidden objects
graphing-calculator-label-settings-lock-viewport = Lock Viewport
graphing-calculator-label-settings-minor-gridlines = Minor Gridlines
graphing-calculator-label-settings-numbers-3d = Numbers
graphing-calculator-label-settings-one-quadrant = One Quadrant
graphing-calculator-label-settings-reverse-contrast = Reverse contrast
graphing-calculator-label-settings-six-key-braille = Six Key Braille Input
graphing-calculator-label-settings-step = Step:
graphing-calculator-label-settings-translucent-surfaces = Translucent surfaces
graphing-calculator-label-settings-x-axis = X-Axis
graphing-calculator-label-settings-y-axis = Y-Axis
graphing-calculator-label-show-keypad = Show Keypad
graphing-calculator-label-slider-disabled-while-ticker-playing = Sliders are disabled while the ticker is running.
graphing-calculator-label-slider-step = Step:
graphing-calculator-label-table-lowercase = table
graphing-calculator-label-ticker-close = cancel
graphing-calculator-label-ticker-help-tooltip = On slow computers, this might run slower. Use local variable "dt" to capture the actual update speed.
graphing-calculator-label-ticker-lowercase = ticker
graphing-calculator-label-ticker-min-step = Min Step Time
graphing-calculator-label-ticker-pause = pause
graphing-calculator-label-ticker-play = play
graphing-calculator-label-tooltip-geometry-settings = Geometry Settings
graphing-calculator-label-tooltip-graph-settings = Graph Settings
graphing-calculator-label-tooltip-open-graph = Open Graph
graphing-calculator-label-tooltip-reset = Reset
graphing-calculator-label-tooltip-show-list = Show List
graphing-calculator-label-tooltip-viewport-default = Default Viewport
graphing-calculator-label-tooltip-zoom-default-orientation = Default Orientation
graphing-calculator-label-tooltip-zoom-in = Zoom In
graphing-calculator-label-tooltip-zoom-out = Zoom Out
graphing-calculator-label-tooltip-zoom-xy-orientation = XY Orientation
graphing-calculator-label-undo-tooltip = Undo (ctrl+z)
graphing-calculator-label-unlock-expression-tooltip = Allow Editing
graphing-calculator-label-update-on-click = On click:
graphing-calculator-link-edit-on-desmos = edit graph on
graphing-calculator-link-learn-more = Learn more.
graphing-calculator-link-view-braille-examples = View examples
graphing-calculator-narration-3d-graphpaper-label = three-dimensional graph paper
graphing-calculator-narration-3d-orientation-options-label = Orientation
graphing-calculator-narration-add-expression = Add expression
graphing-calculator-narration-add-folder = Add folder
graphing-calculator-narration-add-image = Add image
graphing-calculator-narration-add-item-menu = Add Item Menu
graphing-calculator-narration-add-note = Add note
graphing-calculator-narration-add-slider-prompt = Add slider for { $vars }
graphing-calculator-narration-add-table = Add table
graphing-calculator-narration-add-ticker = Add Ticker
graphing-calculator-narration-all-folders-collapsed = all folders collapsed
graphing-calculator-narration-all-folders-expanded = all folders expanded
graphing-calculator-narration-audio-instructions-enter-audio-trace-mac = Press OPTION+T for audio trace.
graphing-calculator-narration-audio-instructions-enter-audio-trace-windows = Press ALT+T for audio trace.
graphing-calculator-narration-audio-trace-branch-not-found = Branch { $branch } does not exist.
graphing-calculator-narration-audio-trace-cannot-change-slider-value = Unable to adjust slider
graphing-calculator-narration-audio-trace-description-branch-count = Branches: { $branches }.
graphing-calculator-narration-audio-trace-description-color = Color: { $color }.
graphing-calculator-narration-audio-trace-description-multiple-extrema = { $count } extrema.
graphing-calculator-narration-audio-trace-description-multiple-intercepts = { $count } intercepts.
graphing-calculator-narration-audio-trace-description-multiple-intersections = { $count } intersections.
graphing-calculator-narration-audio-trace-description-multiple-labels = { $count } point labels.
graphing-calculator-narration-audio-trace-description-multiple-roots = { $count } zero crossings.
graphing-calculator-narration-audio-trace-description-no-curve-selected = No curve selected.
graphing-calculator-narration-audio-trace-description-one-extremum = 1 extremum.
graphing-calculator-narration-audio-trace-description-one-intercept = 1 intercept.
graphing-calculator-narration-audio-trace-description-one-intersection = 1 intersection.
graphing-calculator-narration-audio-trace-description-one-label = 1 point label.
graphing-calculator-narration-audio-trace-description-one-root = 1 zero crossing.
graphing-calculator-narration-audio-trace-description-shading-above = Shading above.
graphing-calculator-narration-audio-trace-description-shading-below = Shading below.
graphing-calculator-narration-audio-trace-description-shading-in-regions = Shading in regions.
graphing-calculator-narration-audio-trace-description-shading-left = Shading on the left.
graphing-calculator-narration-audio-trace-description-shading-right = Shading on the right.
graphing-calculator-narration-audio-trace-description-visible-grid = Grid lines are visible.
graphing-calculator-narration-audio-trace-description-visible-x-axis = X axis visible.
graphing-calculator-narration-audio-trace-description-visible-x-axis-and-label = X axis visible and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-x-axis-range = X axis visible from { $xmin } to { $xmax }.
graphing-calculator-narration-audio-trace-description-visible-x-axis-range-and-label = X axis visible from { $xmin } to { $xmax } and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-y-axis = Y axis visible.
graphing-calculator-narration-audio-trace-description-visible-y-axis-and-label = Y axis visible and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-y-axis-range = Y axis visible from { $ymin } to { $ymax }.
graphing-calculator-narration-audio-trace-description-visible-y-axis-range-and-label = Y axis visible from { $ymin } to { $ymax } and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-z-axis = Z axis visible.
graphing-calculator-narration-audio-trace-description-visible-z-axis-and-label = Z axis visible and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-z-axis-range = Z axis visible from { $zmin } to { $zmax }.
graphing-calculator-narration-audio-trace-description-visible-z-axis-range-and-label = Z axis visible from { $zmin } to { $zmax } and is labeled { $label }.
graphing-calculator-narration-audio-trace-expression-with-column = Expression { $index } column { $column }
graphing-calculator-narration-audio-trace-first-point = First point
graphing-calculator-narration-audio-trace-first-slider = First slider.
graphing-calculator-narration-audio-trace-instructions-disable-mac = To disable audio trace, press OPTION+T.
graphing-calculator-narration-audio-trace-instructions-disable-windows = To disable audio trace, press ALT+T.
graphing-calculator-narration-audio-trace-instructions-expression-navigation-mac = To move between expressions, press COMMAND+Up-Arrow or COMMAND+Down-Arrow.
graphing-calculator-narration-audio-trace-instructions-expression-navigation-windows = To move between expressions, press ALT+Up-Arrow or ALT+Down-Arrow.
graphing-calculator-narration-audio-trace-instructions-hear-graph = To hear the graph, press H.
graphing-calculator-narration-audio-trace-instructions-use-arrow-keys = Use Arrow keys to navigate.
graphing-calculator-narration-audio-trace-last-point = Last point
graphing-calculator-narration-audio-trace-last-slider = Last slider.
graphing-calculator-narration-audio-trace-multiple-sliders-paused = { $sliders } animating sliders were paused.
graphing-calculator-narration-audio-trace-no-more-pois = No more points of interest
graphing-calculator-narration-audio-trace-no-sliders-paused = No animating sliders were paused.
graphing-calculator-narration-audio-trace-one-slider-paused = One animating slider was paused.
graphing-calculator-narration-audio-trace-playback-speed = Graph playback speed { $speed }
graphing-calculator-narration-audio-trace-poi-count = Points of interest, { $x }.
graphing-calculator-narration-audio-trace-point-type-definition = Definition
graphing-calculator-narration-audio-trace-point-type-extremum = Extremum
graphing-calculator-narration-audio-trace-point-type-intercept = Intercept
graphing-calculator-narration-audio-trace-point-type-intersection = Intersection
graphing-calculator-narration-audio-trace-point-type-intersection-with-curves = Intersection with { $curves }
graphing-calculator-narration-audio-trace-point-type-label = Label
graphing-calculator-narration-audio-trace-point-type-not-a-poi = Not a P O I
graphing-calculator-narration-audio-trace-point-type-root = Zero
graphing-calculator-narration-audio-trace-point-type-trace = Trace
graphing-calculator-narration-audio-trace-property-branch-number = Branch { $branch }.
graphing-calculator-narration-audio-trace-property-type-before-coordinates = { $type } at
graphing-calculator-narration-audio-trace-property-x = X: { $x }.
graphing-calculator-narration-audio-trace-property-y = Y: { $y }.
graphing-calculator-narration-audio-trace-slider-value-unknown = Unable to determine slider value
graphing-calculator-narration-audio-trace-sound-effects-disabled = Sound effects have been disabled.
graphing-calculator-narration-audio-trace-traceable-curves =
    { $sketchCount ->
        [one] 1 audio traceable curve.
       *[other] { $sketchCount } audio traceable curves.
    }
graphing-calculator-narration-audio-trace-tracing-different-expression = Tracing { $expression }.
graphing-calculator-narration-audio-trace-unable-to-play = Unable to play audio.
graphing-calculator-narration-audio-trace-unable-to-trace-this-expression = Unable to audio trace this expression.
graphing-calculator-narration-audio-trace-unsupported-expression = { $expression } cannot be audio traced.
graphing-calculator-narration-audio-trace-volume = Volume { $volume } percent
graphing-calculator-narration-cdf-maximum = Max
graphing-calculator-narration-cdf-minimum = Min
graphing-calculator-narration-click-action = Click Action
graphing-calculator-narration-clickable-image-options = Clickable Image Options
graphing-calculator-narration-collapse = Collapse
graphing-calculator-narration-collapse-folder-index = Collapse Folder { $index }
graphing-calculator-narration-collapse-folder-title = Collapse { $folder } folder
graphing-calculator-narration-color-unknown = unknown
graphing-calculator-narration-computed-cell-role-description = computed cell
graphing-calculator-narration-configure-toolbar = Geometry Toolbar Configuration
graphing-calculator-narration-create-table = Create Table
graphing-calculator-narration-create-table-expression = Create Table from Expression { $index }
graphing-calculator-narration-create-table-secret-expression = Create Table from Secret Expression { $index }
graphing-calculator-narration-delete = Delete
graphing-calculator-narration-delete-expression = Delete Expression { $index }
graphing-calculator-narration-delete-folder-index = Delete Folder { $index }
graphing-calculator-narration-delete-folder-title = Delete { $folder } folder
graphing-calculator-narration-delete-image = Delete Image { $index }
graphing-calculator-narration-delete-secret-expression = Delete Secret Expression { $index }
graphing-calculator-narration-delete-table = Delete Table { $index }
graphing-calculator-narration-delete-text = Delete Note { $index }
graphing-calculator-narration-describe = Unknown object
graphing-calculator-narration-describe-expression = Expression { $index }
graphing-calculator-narration-describe-folder-index = Folder { $index }
graphing-calculator-narration-describe-folder-title = { $folder } folder
graphing-calculator-narration-describe-image = Image { $index }
graphing-calculator-narration-describe-secret-expression = Secret expression { $index }
graphing-calculator-narration-describe-table = Table { $index }
graphing-calculator-narration-describe-text = Note { $index }
graphing-calculator-narration-description-collapsed-folder = Collapsed Folder
graphing-calculator-narration-description-collapsed-readonly-folder = Collapsed Locked Folder
graphing-calculator-narration-description-collapsed-secret-folder = Collapsed Secret Folder
graphing-calculator-narration-description-collapsed-secret-readonly-folder = Collapsed Secret Locked Folder
graphing-calculator-narration-description-folder = Folder
graphing-calculator-narration-description-hidden-collapsed-folder = Hidden Collapsed Folder
graphing-calculator-narration-description-hidden-collapsed-readonly-folder = Hidden Collapsed Locked Folder
graphing-calculator-narration-description-hidden-collapsed-secret-folder = Hidden Collapsed Secret Folder
graphing-calculator-narration-description-hidden-collapsed-secret-readonly-folder = Hidden Collapsed Secret Locked Folder
graphing-calculator-narration-description-hidden-folder = Hidden Folder
graphing-calculator-narration-description-hidden-readonly-folder = Hidden Locked Folder
graphing-calculator-narration-description-hidden-secret-folder = Hidden Secret Folder
graphing-calculator-narration-description-hidden-secret-readonly-folder = Hidden Secret Locked Folder
graphing-calculator-narration-description-readonly-folder = Locked Folder
graphing-calculator-narration-description-secret-folder = Secret Folder
graphing-calculator-narration-description-secret-readonly-folder = Secret Locked Folder
graphing-calculator-narration-dist-tab-distributions = Distributions
graphing-calculator-narration-dist-tab-visualizations = Visualizations
graphing-calculator-narration-domain3d-maximum = domain { $term } Maximum:
graphing-calculator-narration-domain3d-minimum = domain { $term } Minimum:
graphing-calculator-narration-drag-mode-x = X
graphing-calculator-narration-drag-mode-xy = X and Y
graphing-calculator-narration-drag-mode-y = Y
graphing-calculator-narration-draggable-image-off-screen-prompt = { " " }not completely visible on screen
graphing-calculator-narration-duplicate = Duplicate
graphing-calculator-narration-duplicate-expression = Duplicate Expression { $index }
graphing-calculator-narration-duplicate-folder-index = Duplicate Folder { $index }
graphing-calculator-narration-duplicate-folder-title = Duplicate { $folder } folder
graphing-calculator-narration-duplicate-image = Duplicate Image { $index }
graphing-calculator-narration-duplicate-secret-expression = Duplicate Secret Expression { $index }
graphing-calculator-narration-duplicate-table = Duplicate Table { $index }
graphing-calculator-narration-duplicate-text = Duplicate Note { $index }
graphing-calculator-narration-edit-action = Edit Action
graphing-calculator-narration-edit-expression-list = Edit Expression List
graphing-calculator-narration-edit-folder-title = Edit Folder { $index } Title
graphing-calculator-narration-edit-graph-on-desmos = Edit graph on Desmos
graphing-calculator-narration-edit-image-title = Edit Image { $index } Title
graphing-calculator-narration-edit-list-mode-off = Edit list mode off.
graphing-calculator-narration-edit-list-mode-on = Edit list mode on.
graphing-calculator-narration-edit-on-desmos = Edit graph on Desmos
graphing-calculator-narration-edit-slider-variable-limits = Edit { $variable } Limits
graphing-calculator-narration-edit-text-title = Note { $index }
graphing-calculator-narration-edit-title = Edit Title
graphing-calculator-narration-editable-label-mode = Editable label mode
graphing-calculator-narration-editable-point-label-at-coordinates = Editable point label at { $coordinates }
graphing-calculator-narration-expand = Expand
graphing-calculator-narration-expand-folder-index = Expand Folder { $index }
graphing-calculator-narration-expand-folder-title = Expand { $folder } folder
graphing-calculator-narration-expression-audio-trace-mac = To audio trace, press OPTION+T.
graphing-calculator-narration-expression-audio-trace-windows = To audio trace, press ALT+T.
graphing-calculator-narration-expression-bar = Expression Bar
graphing-calculator-narration-expression-evaluation-has-graph = Has graph.
graphing-calculator-narration-expression-evaluation-has-graph-and-regression = Has graph and regression. To access statistics, press Tab.
graphing-calculator-narration-expression-evaluation-has-regression = Has regression. To access statistics, press Tab.
graphing-calculator-narration-expression-evaluation-is-distribution = is distribution.
graphing-calculator-narration-expression-evaluation-is-t-test = is T test. To access statistics, press Tab.
graphing-calculator-narration-expression-hidden-label = Hidden { $label }
graphing-calculator-narration-expression-index-table = Expression { $index } table
graphing-calculator-narration-expression-label = Label
graphing-calculator-narration-fill-opacity = Fill Opacity:
graphing-calculator-narration-fill-visible = Fill visible
graphing-calculator-narration-folder-collapsed = folder collapsed
graphing-calculator-narration-folder-expanded = folder expanded
graphing-calculator-narration-folder-has-items = { $folder } has { $count } items
graphing-calculator-narration-functions = Functions
graphing-calculator-narration-geometry-added-object-type = Added { $type }.
graphing-calculator-narration-geometry-added-object-type-and-point = Added { $type } and 1 point.
graphing-calculator-narration-geometry-added-object-type-and-points = Added { $type } and { $points } points.
graphing-calculator-narration-geometry-added-points = Added { $points } points.
graphing-calculator-narration-geometry-angle-at-coordinates-through-points = { $itemDescription } through { $parent1 }, { $parent2 }, and { $parent3 } at { $x1 } { $y1 }
graphing-calculator-narration-geometry-angle-of-polygon-at-coordinates = { $itemDescription } of { $parent } at { $x } { $y }
graphing-calculator-narration-geometry-angle-with-assignment = Angle { $assignment }
graphing-calculator-narration-geometry-angle-with-measurement-and-assignment = { $measurementText } Angle { $assignment }
graphing-calculator-narration-geometry-arc-with-assignment = Arc { $assignment }
graphing-calculator-narration-geometry-circle-with-assignment = Circle { $assignment }
graphing-calculator-narration-geometry-construction-icon-label = Token Count
graphing-calculator-narration-geometry-construction-role-description = construction
graphing-calculator-narration-geometry-deselect-all = Deselect All
graphing-calculator-narration-geometry-dilated-item = dilated { $item }
graphing-calculator-narration-geometry-directed-angle-with-assignment = Directed Angle { $assignment }
graphing-calculator-narration-geometry-directed-angle-with-measurement-and-assignment = { $measurementText } Directed Angle { $assignment }
graphing-calculator-narration-geometry-edge-of-polygon = Edge { $polygonEdge } of { $item }
graphing-calculator-narration-geometry-glider-with-assignment = GliderW { $assignment }
graphing-calculator-narration-geometry-hidden-construction-description = Hidden { $description }
graphing-calculator-narration-geometry-intersection-with-assignment = Intersection { $assignment }
graphing-calculator-narration-geometry-item-at-coordinates-and-intersection = { $itemDescription } intersecting { $parent1 } and { $parent2 } at { $x } { $y }
graphing-calculator-narration-geometry-item-at-coordinates-and-parent = { $itemDescription } of { $parent } at { $x } { $y }
graphing-calculator-narration-geometry-item-at-coordinates-to-coordinates = { $itemDescription } from { $x1 } { $y1 } to { $x2 } { $y2 }
graphing-calculator-narration-geometry-item-at-coordinates-with-middle-and-end = { $itemDescription } starting at { $x1 } { $y1 } middle at { $x2 } { $y2 } and end at { $x3 } { $y3 }
graphing-calculator-narration-geometry-item-at-coordinates-with-radius = { $itemDescription } at { $x } { $y } with radius { $radius }.
graphing-calculator-narration-geometry-item-to-line-passing-through-point-at-coordinates-to-coordinates = { $itemDescription } to { $parent1 } passing through { $parent2 } from { $x1 } { $y1 } to { $x2 } { $y2 }
graphing-calculator-narration-geometry-line-with-assignment = Line { $assignment }
graphing-calculator-narration-geometry-list-of-angles = List of { $count } angles
graphing-calculator-narration-geometry-list-of-any = List of { $count } unknown objects
graphing-calculator-narration-geometry-list-of-arcs = List of { $count } arcs
graphing-calculator-narration-geometry-list-of-circles = List of { $count } circles
graphing-calculator-narration-geometry-list-of-directed-angles = List of { $count } directed angles
graphing-calculator-narration-geometry-list-of-lines = List of { $count } lines
graphing-calculator-narration-geometry-list-of-points = List of { $count } points
graphing-calculator-narration-geometry-list-of-polygons = List of { $count } polygons
graphing-calculator-narration-geometry-list-of-rays = List of { $count } rays
graphing-calculator-narration-geometry-list-of-segments = List of { $count } segments
graphing-calculator-narration-geometry-midpoint-with-assignment = Midpoint { $assignment }
graphing-calculator-narration-geometry-moved-to-coordinates = Moved to x: { $x }, y: { $y }.
graphing-calculator-narration-geometry-near-item = Near { $item }.
graphing-calculator-narration-geometry-no-tool-inputs = No inputs exist
graphing-calculator-narration-geometry-nothing-selected = Nothing selected.
graphing-calculator-narration-geometry-parallel-with-assignment = Parallel { $assignment }
graphing-calculator-narration-geometry-perpendicular-with-assignment = Perpendicular { $assignment }
graphing-calculator-narration-geometry-point-with-assignment = Point { $assignment }
graphing-calculator-narration-geometry-polygon-with-assignment = Polygon { $assignment } with { $sideCount } sides
graphing-calculator-narration-geometry-quadrilateral-with-assignment = Quadrilateral { $assignment }
graphing-calculator-narration-geometry-ray-with-assignment = Ray { $assignment }
graphing-calculator-narration-geometry-reflected-item = reflected { $item }
graphing-calculator-narration-geometry-rotated-item = rotated { $item }
graphing-calculator-narration-geometry-segment-with-assignment = Segment { $assignment }
graphing-calculator-narration-geometry-token-navigator-depth = Depth: { $depth }
graphing-calculator-narration-geometry-token-navigator-label = Token Navigator
graphing-calculator-narration-geometry-tool-cancelled = Cancelled.
graphing-calculator-narration-geometry-tool-disabled = The { $tool } tool is disabled.
graphing-calculator-narration-geometry-transformed-item = transformed { $item }
graphing-calculator-narration-geometry-translated-item = translated { $item }
graphing-calculator-narration-geometry-triangle-with-assignment = Triangle { $assignment }
graphing-calculator-narration-geometry-unable-to-move = Unable to move.
graphing-calculator-narration-geometry-unlabeled-angle = Angle { $index }
graphing-calculator-narration-geometry-unlabeled-angle-with-measurement = { $measurementText } Angle
graphing-calculator-narration-geometry-unlabeled-arc = Arc { $index }
graphing-calculator-narration-geometry-unlabeled-circle = Circle { $index }
graphing-calculator-narration-geometry-unlabeled-directed-angle = Directed Angle { $index }
graphing-calculator-narration-geometry-unlabeled-directed-angle-with-measurement = { $measurementText } Directed Angle
graphing-calculator-narration-geometry-unlabeled-glider = Glider { $index }
graphing-calculator-narration-geometry-unlabeled-intersection = Intersection { $index }
graphing-calculator-narration-geometry-unlabeled-line = Line { $index }
graphing-calculator-narration-geometry-unlabeled-midpoint = Midpoint { $index }
graphing-calculator-narration-geometry-unlabeled-parallel = Parallel { $index }
graphing-calculator-narration-geometry-unlabeled-perpendicular = Perpendicular { $index }
graphing-calculator-narration-geometry-unlabeled-point = Point { $index }
graphing-calculator-narration-geometry-unlabeled-polygon = Polygon { $index } with { $sideCount } sides
graphing-calculator-narration-geometry-unlabeled-quadrilateral = Quadrilateral { $index }
graphing-calculator-narration-geometry-unlabeled-ray = Ray { $index }
graphing-calculator-narration-geometry-unlabeled-segment = Segment { $index }
graphing-calculator-narration-geometry-unlabeled-triangle = Triangle { $index }
graphing-calculator-narration-geometry-unlabeled-vector = Vector { $index }
graphing-calculator-narration-geometry-vector-with-assignment = Vector { $assignment }
graphing-calculator-narration-graph-settings-controls = Graph Settings Controls
graphing-calculator-narration-graphpaper-label = graph paper
graphing-calculator-narration-hide = Hide
graphing-calculator-narration-hide-animation-properties = Hide Animation Properties
graphing-calculator-narration-hide-expression = Hide Expression { $index }
graphing-calculator-narration-hide-expression-list = Hide expression list
graphing-calculator-narration-hide-folder-index = Hide Folder { $index }
graphing-calculator-narration-hide-folder-title = Hide { $folder } folder
graphing-calculator-narration-hide-image = Hide Image { $index }
graphing-calculator-narration-hide-options = Hide Options
graphing-calculator-narration-hide-options-expression = Hide Options for Expression { $index }
graphing-calculator-narration-hide-options-image = Hide Options for Image { $index }
graphing-calculator-narration-hide-options-secret-expression = Hide Options for Secret Expression { $index }
graphing-calculator-narration-hide-secret-expression = Hide Secret Expression { $index }
graphing-calculator-narration-hide-table = Hide Table { $index }
graphing-calculator-narration-hide-table-column = Hide Column
graphing-calculator-narration-hide-text = Hide Note { $index }
graphing-calculator-narration-image-styles = Styles
graphing-calculator-narration-item-at-coordinates = { $itemDescription } at { $x } { $y }
graphing-calculator-narration-item-with-list-index = index { $listIndex } of { $item }
graphing-calculator-narration-items-deleted =
    { $count ->
        [zero]
            { $locked ->
                [one] { $locked } locked item could not be deleted.
               *[other] { $locked } locked items could not be deleted.
            }
        [one]
            { $locked ->
                [0] { $count } item deleted.
                [one] { $count } item deleted. { $locked } locked item could not be deleted.
               *[other] { $count } item deleted. { $locked } locked items could not be deleted.
            }
       *[other]
            { $locked ->
                [0] { $count } items deleted.
                [one] { $count } items deleted. { $locked } locked item could not be deleted.
               *[other] { $count } items deleted. { $locked } locked items could not be deleted.
            }
    }
graphing-calculator-narration-keypad-hidden = Keypad hidden
graphing-calculator-narration-keypad-key-next-curve = Next Curve
graphing-calculator-narration-keypad-key-next-poi = Next Point of Interest
graphing-calculator-narration-keypad-key-next-point = Next Point
graphing-calculator-narration-keypad-key-previous-curve = Previous Curve
graphing-calculator-narration-keypad-key-previous-poi = Previous Point of Interest
graphing-calculator-narration-keypad-key-previous-point = Previous Point
graphing-calculator-narration-keypad-key-speed-down = Speed Down
graphing-calculator-narration-keypad-key-speed-up = Speed Up
graphing-calculator-narration-keypad-key-volume-down = Volume Down
graphing-calculator-narration-keypad-key-volume-up = Volume Up
graphing-calculator-narration-keypad-visible = Keypad visible
graphing-calculator-narration-label-angle = Label Angle:
graphing-calculator-narration-label-size = Label Size:
graphing-calculator-narration-label-text = Label Text
graphing-calculator-narration-label-visible = Label visible
graphing-calculator-narration-line-opacity = Line Opacity:
graphing-calculator-narration-line-style-dashed = Dashed
graphing-calculator-narration-line-style-dotted = Dotted
graphing-calculator-narration-line-style-solid = Solid
graphing-calculator-narration-lines-visible = Lines visible
graphing-calculator-narration-main-desmos-geometry = Desmos Geometry
graphing-calculator-narration-main-desmos-graphing-calculator = Desmos Graphing Calculator
graphing-calculator-narration-make-clickable = make clickable
graphing-calculator-narration-menu-drag-enabled = Drag Enabled
graphing-calculator-narration-movable-point-off-screen-prompt = { " " }not visible on screen
graphing-calculator-narration-movable-point-prefix = Point
graphing-calculator-narration-movable-point-suffix-usage-instructions = { " " }is movable. Press Arrows or Shift+Arrows to adjust.
graphing-calculator-narration-no-geometry-tools-available = No geometry tools available.
graphing-calculator-narration-open-graph = Open Graph
graphing-calculator-narration-options-menu = Options Menu
graphing-calculator-narration-options-menu-closed = Options menu closed.
graphing-calculator-narration-options-menu-open = Options menu open.
graphing-calculator-narration-pause-variable-animation = Pause { $variable } Animation
graphing-calculator-narration-play-variable-animation = Play { $variable } Animation
graphing-calculator-narration-poi-graph-point = Point
graphing-calculator-narration-point-size = Point Size:
graphing-calculator-narration-point-style-cross = Cross
graphing-calculator-narration-point-style-open = Open
graphing-calculator-narration-point-style-point = Point
graphing-calculator-narration-points-visible = Points visible
graphing-calculator-narration-powered-by-desmos = Powered by Desmos
graphing-calculator-narration-redo = Redo
graphing-calculator-narration-rename = Rename
graphing-calculator-narration-rename-expression = Rename in Expression { $index }
graphing-calculator-narration-rename-secret-expression = Rename in Secret Expression { $index }
graphing-calculator-narration-rename-table = Rename in Table { $index }
graphing-calculator-narration-run-action-icon = Run Action
graphing-calculator-narration-settings-all-axes-max = Max for x, y, and z
graphing-calculator-narration-settings-all-axes-min = Min for x, y, and z
graphing-calculator-narration-settings-angle = Angle Settings
graphing-calculator-narration-settings-cartesian-grid = Cartesian Grid
graphing-calculator-narration-settings-dimension = 2D vs 3D Mode
graphing-calculator-narration-settings-polar-grid = Polar Grid
graphing-calculator-narration-settings-show-both = Show Both
graphing-calculator-narration-settings-show-positive = Show Positive
graphing-calculator-narration-settings-x-axis-label-placeholder = e.g. \u201Cx\u201D
graphing-calculator-narration-settings-x-axis-max = X Axis Maximum:{ " " }
graphing-calculator-narration-settings-x-axis-min = X Axis Minimum:{ " " }
graphing-calculator-narration-settings-x-axis-step = X Axis Step Size:{ " " }
graphing-calculator-narration-settings-y-axis-label-placeholder = e.g. \u201Cy\u201D
graphing-calculator-narration-settings-y-axis-max = Y Axis Maximum:{ " " }
graphing-calculator-narration-settings-y-axis-min = Y Axis Minimum:{ " " }
graphing-calculator-narration-settings-y-axis-step = Y Axis Step Size:{ " " }
graphing-calculator-narration-settings-z-axis-max = Z Axis Maximum:{ " " }
graphing-calculator-narration-settings-z-axis-min = Z Axis Minimum:{ " " }
graphing-calculator-narration-share-graph-link = Link to this graph
graphing-calculator-narration-share-graph-link-copied = Link copied
graphing-calculator-narration-share-graph-link-unable-to-copy = Unable to copy link
graphing-calculator-narration-show = Show
graphing-calculator-narration-show-animation-properties = Show Animation Properties
graphing-calculator-narration-show-expression = Show Expression { $index }
graphing-calculator-narration-show-folder-index = Show Folder { $index }
graphing-calculator-narration-show-folder-title = Show { $folder } folder
graphing-calculator-narration-show-image = Show Image { $index }
graphing-calculator-narration-show-options = Show Options
graphing-calculator-narration-show-options-expression = Show Options for Expression { $index }
graphing-calculator-narration-show-options-image = Show Options for Image { $index }
graphing-calculator-narration-show-options-secret-expression = Show Options for Secret Expression { $index }
graphing-calculator-narration-show-secret-expression = Show Secret Expression { $index }
graphing-calculator-narration-show-table = Show Table { $index }
graphing-calculator-narration-show-table-column = Show Column
graphing-calculator-narration-show-text = Show Note { $index }
graphing-calculator-narration-slider-animate-faster = Animate Faster
graphing-calculator-narration-slider-animate-slower = Animate Slower
graphing-calculator-narration-slider-animating-at-speed = Animating at { $speed }x
graphing-calculator-narration-slider-loop-forwards-and-backwards = Loop forwards and backwards
graphing-calculator-narration-slider-maximum = Slider Maximum:
graphing-calculator-narration-slider-minimum = Slider Minimum:
graphing-calculator-narration-slider-play-indefinitely = Play indefinitely
graphing-calculator-narration-slider-play-once = Play once
graphing-calculator-narration-slider-repeat-one-direction = Repeat in one direction
graphing-calculator-narration-slider-step = Slider Step Size:
graphing-calculator-narration-slider-trace-no-sliders = No sliders to trace.
graphing-calculator-narration-slider-trace-off = Slider trace off.
graphing-calculator-narration-slider-trace-on = Slider trace on.
graphing-calculator-narration-slider-variable-paused = { $variable } paused
graphing-calculator-narration-slider-variable-playing = { $variable } playing
graphing-calculator-narration-slider-variable-restarted = { $variable } restarted
graphing-calculator-narration-surfaces-visible = Surfaces visible
graphing-calculator-narration-table-column-header = Column header { $column }
graphing-calculator-narration-table-no-column-header = No column header
graphing-calculator-narration-table-row-column = Row { $row } Col { $column }
graphing-calculator-narration-tick-action = Tick Action
graphing-calculator-narration-toggle-audio-trace = Toggle Audio Trace
graphing-calculator-narration-toggle-letters = Toggle Letters
graphing-calculator-narration-transformations-menu = Transformations Menu
graphing-calculator-narration-unable-to-activate-account-menu = Unable to activate account menu
graphing-calculator-narration-unable-to-activate-help-menu = Unable to activate help menu
graphing-calculator-narration-unable-to-activate-language-menu = Unable to activate language menu
graphing-calculator-narration-unable-to-activate-share-menu = Unable to activate share menu
graphing-calculator-narration-unable-to-add-expression = Unable to add expression
graphing-calculator-narration-unable-to-add-note = Unable to add note
graphing-calculator-narration-unable-to-add-table = Unable to add table
graphing-calculator-narration-undo = Undo
graphing-calculator-narration-viewport-default = Graph viewport default
graphing-calculator-narration-viewport-updated = Graph viewport updated.
graphing-calculator-narration-viewport-zoom-in = Graph zoom in
graphing-calculator-narration-viewport-zoom-out = Graph zoom out
graphing-calculator-narration-viewport-zoom-square = Graph zoom square
graphing-calculator-narration-visual-parameters-height = Height
graphing-calculator-narration-visual-parameters-offset = Offset
graphing-calculator-narration-visual-parameters-width = Width
graphing-calculator-narration-x-percentage-coordinate = { $x } percent from left.
graphing-calculator-narration-y-percentage-coordinate = { $y } percent from top.
graphing-calculator-narration-zoom-options-label = Zoom
graphing-calculator-text-add-screen-reader-label-placeholder = Add screen reader label
graphing-calculator-text-arrow-mode-both = Both
graphing-calculator-text-arrow-mode-default = Default
graphing-calculator-text-arrow-mode-none = None
graphing-calculator-text-arrow-mode-positive = Positive
graphing-calculator-text-audio-trace-no-implicit-support = Sorry, but I can't trace implicit curves yet.
graphing-calculator-text-audio-trace-no-parametric-support = Sorry, but I can't trace parametric curves yet.
graphing-calculator-text-audio-trace-no-polar-support = Sorry, but I can't trace polar curves yet.
graphing-calculator-text-audio-trace-off = Audio trace off.
graphing-calculator-text-audio-trace-on = Audio trace on.
graphing-calculator-text-color-black = black
graphing-calculator-text-color-blue = blue
graphing-calculator-text-color-gray = gray
graphing-calculator-text-color-green = green
graphing-calculator-text-color-orange = orange
graphing-calculator-text-color-purple = purple
graphing-calculator-text-color-red = red
graphing-calculator-text-color-unknown = color unknown
graphing-calculator-text-enter-pareneter = Enter the { $param }.
graphing-calculator-text-export-braille-email-accessibility = Feedback? Email <1>accessibility@desmos.com</1>.
graphing-calculator-text-folder-placeholder = Untitled folder
graphing-calculator-text-geometry-arrow-mode = Arrow Mode: { $mode }
graphing-calculator-text-geometry-delete-selected-objects =
    { $count ->
        [one]
            { $locked ->
                [0] Delete 1 object
               *[other] Delete 1 unlocked object
            }
       *[other]
            { $locked ->
                [0] Delete { $count } objects
               *[other] Delete { $count } unlocked objects
            }
    }
graphing-calculator-text-geometry-glider = glider
graphing-calculator-text-geometry-hide-objects =
    { $count ->
        [one] Hide
       *[other] Hide all
    }
graphing-calculator-text-geometry-intersection = intersection
graphing-calculator-text-geometry-move-to-folder-message =
    { $count ->
        [one] Move to folder:
       *[other] Move { $count } objects to folder:
    }
graphing-calculator-text-geometry-multi-select-more-dropdown = More
graphing-calculator-text-geometry-multi-select-transform = Transform
graphing-calculator-text-geometry-no-constructed-objects = No constructed objects yet.
graphing-calculator-text-geometry-select-hint = Select a { $type }
graphing-calculator-text-geometry-selected-objects =
    { $count ->
        [one] 1 object selected
       *[other] { $count } objects selected
    }
graphing-calculator-text-geometry-show-objects =
    { $count ->
        [one] Show
       *[other] Show all
    }
graphing-calculator-text-geometry-tool-angle-display-name = Angle
graphing-calculator-text-geometry-tool-angle-hint-1 = Choose a starting point
graphing-calculator-text-geometry-tool-angle-hint-2 = Choose a vertex point
graphing-calculator-text-geometry-tool-angle-hint-3 = Choose an endpoint
graphing-calculator-text-geometry-tool-angles-hint-1 = Choose a starting point or a polygon
graphing-calculator-text-geometry-tool-arc-display-name = Arc
graphing-calculator-text-geometry-tool-arc-hint-1 = Choose a point (start)
graphing-calculator-text-geometry-tool-arc-hint-2 = Choose a point (middle)
graphing-calculator-text-geometry-tool-arc-hint-3 = Choose a point (end)
graphing-calculator-text-geometry-tool-box-selection-display-name = Box Select
graphing-calculator-text-geometry-tool-circle-display-name = Circle
graphing-calculator-text-geometry-tool-circle-hint-center = Choose a point (center)
graphing-calculator-text-geometry-tool-circle-hint-radius = Choose a point (radius)
graphing-calculator-text-geometry-tool-compass-display-name = Compass
graphing-calculator-text-geometry-tool-compass-hint-center = Choose a center point
graphing-calculator-text-geometry-tool-compass-hint-segment = Choose a segment to set the radius
graphing-calculator-text-geometry-tool-dilate-display-name = Dilate
graphing-calculator-text-geometry-tool-dilation-hint-center = Choose point (center)
graphing-calculator-text-geometry-tool-dilation-hint-scale-factor = Scale factor
graphing-calculator-text-geometry-tool-directed-angle-display-name = Directed Angle
graphing-calculator-text-geometry-tool-directedangle-display-name = Directed angle
graphing-calculator-text-geometry-tool-expression-edit-display-name = Insert into current expression.
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-0 = No valid inputs
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-1 = Choose { $type }
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-2 = Choose { $type1 } or { $type2 }
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-any-object = Choose any object
graphing-calculator-text-geometry-tool-expression-edit-generic-hint-many = Choose one of the following: { $types }
graphing-calculator-text-geometry-tool-line-display-name = Line
graphing-calculator-text-geometry-tool-line-hint-end = Choose a 2nd point
graphing-calculator-text-geometry-tool-line-hint-start = Choose a 1st point
graphing-calculator-text-geometry-tool-midpoint-display-name = Midpoint
graphing-calculator-text-geometry-tool-midpoint-hint = Choose a segment
graphing-calculator-text-geometry-tool-parallel-display-name = Parallel
graphing-calculator-text-geometry-tool-parallel-hint-point = Choose a point to pass through
graphing-calculator-text-geometry-tool-parallel-hint-straight-line = Choose a line to be parallel to
graphing-calculator-text-geometry-tool-perpendicular-display-name = Perpendicular
graphing-calculator-text-geometry-tool-perpendicular-hint-point = Choose a point to pass through
graphing-calculator-text-geometry-tool-perpendicular-hint-straight-line = Choose a line to be perpendicular to
graphing-calculator-text-geometry-tool-point-display-name = Point
graphing-calculator-text-geometry-tool-point-hint = Select or create a point
graphing-calculator-text-geometry-tool-polygon-display-name = Polygon
graphing-calculator-text-geometry-tool-polygon-hint-finish-point = Choose another point, or click an existing point to finish
graphing-calculator-text-geometry-tool-polygon-hint-first-point = Choose a point
graphing-calculator-text-geometry-tool-polygon-hint-next-point = Choose another point
graphing-calculator-text-geometry-tool-ray-display-name = Ray
graphing-calculator-text-geometry-tool-ray-hint-end = Choose a point (direction)
graphing-calculator-text-geometry-tool-ray-hint-start = Choose a point (vertex)
graphing-calculator-text-geometry-tool-reflect-display-name = Reflect
graphing-calculator-text-geometry-tool-reflection-hint-choose-line = Choose line of reflection
graphing-calculator-text-geometry-tool-rotate-display-name = Rotate
graphing-calculator-text-geometry-tool-rotation-hint-angle = Choose angle
graphing-calculator-text-geometry-tool-rotation-hint-angle-end = Choose angle end point
graphing-calculator-text-geometry-tool-rotation-hint-angle-start = Construct or choose an angle
graphing-calculator-text-geometry-tool-rotation-hint-angle-vertex = Complete angle: choose 2 more points
graphing-calculator-text-geometry-tool-rotation-hint-center = Choose point (center)
graphing-calculator-text-geometry-tool-segment-display-name = Segment
graphing-calculator-text-geometry-tool-segment-hint-end = Choose another point
graphing-calculator-text-geometry-tool-segment-hint-start = Choose a point
graphing-calculator-text-geometry-tool-selection-display-name = Select
graphing-calculator-text-geometry-tool-translate-display-name = Translate
graphing-calculator-text-geometry-tool-translation-hint-from-with-vector = Choose start point or a vector
graphing-calculator-text-geometry-tool-translation-hint-to = Choose end point
graphing-calculator-text-geometry-tool-vector-copy-display-name = Copy of Vector
graphing-calculator-text-geometry-tool-vector-copy-hint-end = Choose new start point for copy
graphing-calculator-text-geometry-tool-vector-display-name = Vector
graphing-calculator-text-geometry-tool-vector-end-point-display-name = Vector End Point
graphing-calculator-text-geometry-tool-vector-hint-end = Choose end point
graphing-calculator-text-geometry-tool-vector-hint-start = Choose start point or a vector to copy
graphing-calculator-text-geometry-tool-vector-start-point-display-name = Vector Start Point
graphing-calculator-text-image-placeholder = Unnamed image
graphing-calculator-text-label-orientation-above = Above
graphing-calculator-text-label-orientation-above-left = Above Left
graphing-calculator-text-label-orientation-above-right = Above Right
graphing-calculator-text-label-orientation-below = Below
graphing-calculator-text-label-orientation-below-left = Below Left
graphing-calculator-text-label-orientation-below-right = Below Right
graphing-calculator-text-label-orientation-default = Default
graphing-calculator-text-label-orientation-left = Left
graphing-calculator-text-label-orientation-right = Right
graphing-calculator-text-loading-image = Loading image...
graphing-calculator-text-note-placeholder = Empty note
graphing-calculator-text-parameter-name-binwidth = Bin Width
graphing-calculator-text-parameter-name-data = Data Set
graphing-calculator-text-parameter-name-dof = Degrees of Freedom
graphing-calculator-text-parameter-name-height = Height
graphing-calculator-text-parameter-name-max = Maximum
graphing-calculator-text-parameter-name-mean = Mean
graphing-calculator-text-parameter-name-min = Minimum
graphing-calculator-text-parameter-name-offset = Offset
graphing-calculator-text-parameter-name-probsuccess = Success Probability
graphing-calculator-text-parameter-name-stddev = Standard Deviation
graphing-calculator-text-parameter-name-trials = Trials
graphing-calculator-text-refreshable-braille-display-note = Use a refreshable Braille display, or just type Braille with a keyboard.
graphing-calculator-text-regression-potentially-inaccurate-parameters = Some parameters may be too large or small to represent accurately.
graphing-calculator-text-share-graph-link = Link to this graph
graphing-calculator-text-table-created = Table created.
graphing-calculator-text-table-more-rows = { $rowCount } more rows
graphing-calculator-text-toast-choose-one-file = You can only choose one file as a replacement
graphing-calculator-text-toast-error-importing-graph = Error importing graph. Check the URL?
graphing-calculator-text-toast-error-no-folders = Only graphs without folders can be inserted into a folder.
graphing-calculator-text-toast-expression-size-limit = Maximum expression size reached.
graphing-calculator-text-toast-graph-cleared = Graph cleared.
graphing-calculator-text-toast-graph-reset = Graph reset.
graphing-calculator-text-toast-image-upload-failed = Image upload failed.
graphing-calculator-text-toast-imported-graph = Graph imported!
graphing-calculator-text-toast-importing-graph = Importing graph...
graphing-calculator-text-toast-no-file-selected = You did not select a file
graphing-calculator-text-toast-undo-cmd-z = Press CMD+Z to undo.
graphing-calculator-text-toast-undo-ctrl-z = Press CTRL+Z to undo.
graphing-calculator-text-toast-uploading-images = Uploading images...
graphing-calculator-text-toast-zoom-to-fit = We zoomed to fit your data.
graphing-calculator-text-zoom-fit = Zoom Fit
graphing-tours-heading-quest-success = You completed the "{ $title }" quest.
graphing-tours-heading-regressions = Regressions
graphing-tours-heading-restrictions = Restrictions
graphing-tours-heading-sliders = Sliders
graphing-tours-heading-tables = Tables
graphing-tours-label-add-slider = Add a slider
graphing-tours-label-awesome = Awesome!
graphing-tours-label-brilliant = Brilliant!
graphing-tours-label-change-color = Change color
graphing-tours-label-check-progress = Check my progress
graphing-tours-label-close-quest = Exit quest
graphing-tours-label-close-quests = Exit quests
graphing-tours-label-close-tour = Close tour
graphing-tours-label-new-item = Click here to add a new item.
graphing-tours-label-next-step-countdown = Continuing in { $seconds }...
graphing-tours-label-nice = Nice!
graphing-tours-label-quest-back-to-quest = Back to quest
graphing-tours-label-quest-take-a-tour = Take a tour
graphing-tours-label-quest-tours = Looking around? Try a quick tour.
graphing-tours-label-quest-tours-aria = Tours that might help with this quest
graphing-tours-label-regressions-better-fit = Edit this equation to find a better fit. Try, for example:<br>{ $equation }
graphing-tours-label-regressions-check-model = Nice. Let's check the model.
graphing-tours-label-regressions-data = First, let's get some data.
graphing-tours-label-regressions-data-2 = Let's start with some data!
graphing-tours-label-regressions-docs = Head over to Google Docs and copy and paste this { $sample_data_link }.
graphing-tours-label-regressions-equation = Now type: { $equation }
graphing-tours-label-regressions-expression-option = ... and select the "expression" option.
graphing-tours-label-regressions-fill-sample-data = Fill in the sample data:
graphing-tours-label-regressions-hint-1 = Hint #1: to get { $y_1 } type { $y1 }.
graphing-tours-label-regressions-hint-2 = Hint #2: { $twiddle } is in our onscreen keypad in the 'A B C' section.
graphing-tours-label-regressions-keep-exploring = Nice work \u2013 Keep exploring!
graphing-tours-label-regressions-new-model = Now, let's try a new model.
graphing-tours-label-regressions-new-table = Click here to add a new table.
graphing-tours-label-regressions-own-data = Note: you can add your own data instead by clicking the { $plus_icon } button.
graphing-tours-label-regressions-residuals = Residuals are the difference between your data and your model. Click here to add them to your table and plot them on the graph.
graphing-tours-label-regressions-sample-data = sample data
graphing-tours-label-require-expressions-visible = Click to show the list of expressions.
graphing-tours-label-require-not-edit-list-mode = Click to return to your expressions.
graphing-tours-label-require-resources-not-open = Click to return to this graph.
graphing-tours-label-restrictions-abc = Hint: press the 'A B C' button on the keypad to find the { $buttons } buttons
graphing-tours-label-restrictions-blank-expression = Click here to make a new blank expression.
graphing-tours-label-restrictions-change-equation = Change this equation to { $sample_expression }
graphing-tours-label-restrictions-domain = Restrict the domain of this line by adding { $sample_expression } to the end.
graphing-tours-label-restrictions-dont-forget = Don't forget the "y="!
graphing-tours-label-restrictions-graph-parabola = Now graph: { $sample_expression }
graphing-tours-label-restrictions-move-parabola = Move the parabola.
graphing-tours-label-restrictions-new-expression = Click here to create a new expression.
graphing-tours-label-restrictions-range = Now let's restrict the range. Add { $sample_expression } to the end.
graphing-tours-label-restrictions-star = You're a restrictions star!
graphing-tours-label-restrictions-start = Let's get started!
graphing-tours-label-restrictions-straight-line = Try graphing a straight line, like { $sample_expression }
graphing-tours-label-restrictions-type-all = Try typing all of { $sample_expression }
graphing-tours-label-restrictions-typing-hint = Hint: you can type { $suggestion1 }, or use the { $suggestion2 } button on the keypad below.
graphing-tours-label-self-destruct = This message will self-destruct in { $seconds }...
graphing-tours-label-show-surface = Show 3D surface
graphing-tours-label-sliders-add = Now click here to add the sliders.
graphing-tours-label-sliders-blank-expression = Click here to create a new blank expression.
graphing-tours-label-sliders-change-value = Type in here to change the value.
graphing-tours-label-sliders-drag-handle = Drag the handle to change the value.
graphing-tours-label-sliders-hands-free = Go "Hands-free"
graphing-tours-label-sliders-make-sliders = Let's make some sliders!
graphing-tours-label-sliders-press-play = Press play to animate the slider.
graphing-tours-label-sliders-pro = You're a slider pro!
graphing-tours-label-sliders-try-typing = Try typing { $sample_expression }
graphing-tours-label-tables-back = Click back to continue editing.
graphing-tours-label-tables-close-options = Click anywhere to close the drawing options.
graphing-tours-label-tables-dots = Click here to connect the dots.
graphing-tours-label-tables-enter = Now try pressing Enter.
graphing-tours-label-tables-fill-another = Just fill in one more...
graphing-tours-label-tables-fill-cell = Fill it in.
graphing-tours-label-tables-fill-row = Fill in this whole row.
graphing-tours-label-tables-last-trick = Last trick!
graphing-tours-label-tables-next-row = Go down to the next row to add more data.
graphing-tours-label-tables-open-options = Click and hold on this icon until the options menu opens up.
graphing-tours-label-tables-scroll = Scroll back up to the table.
graphing-tours-label-tables-select-table = ... and select the "table" option.
graphing-tours-label-tables-start = Let's make a table!
graphing-tours-label-tables-type-number = Type any number here.
graphing-tours-label-tables-valid-number = Uh-oh! Type a valid number here.
graphing-tours-label-tables-whiz = You're a tables whiz!
graphing-tours-label-turn-off-axes = Turn off axes
graphing-tours-narration-exiting-quest = Exiting quest.
graphing-tours-narration-quest-goal-complete = { $goal }. Complete.
graphing-tours-narration-quest-goal-incomplete = { $goal }. Incomplete.
graphing-tours-narration-quest-started = Started "{ $title }" quest.
graphing-tours-narration-quest-thumbnail = Thumbnail for '{ $title }' quest
graphing-tours-narration-tour-thumbnail = Thumbnail for '{ $title }' tour
matrix-calculator-narration-keypad-key-det = Determinant
matrix-calculator-narration-keypad-key-inverse = Inverse
matrix-calculator-narration-keypad-key-rref = Reduced row echelon form
matrix-calculator-narration-keypad-key-trace = Trace
matrix-calculator-narration-keypad-key-transpose = Transpose
frontpage-narration-shared-desmos-logo = Desmos Logo
frontpage-text-header-terms-update = We've updated our Terms of Service.


































































































































































































































































































































































































































































































































































































































































































`;var Ru=class{constructor(e){this.value=e}valueOf(){return this.value}},Io=class extends Ru{constructor(e="???"){super(e)}toString(e){return`{${this.value}}`}},bl=class extends Ru{constructor(e,t={}){super(e),this.opts=t}toString(e){try{return e.memoizeIntlObject(Intl.NumberFormat,this.opts).format(this.value)}catch(t){return e.reportError(t),this.value.toString(10)}}},Op=class extends Ru{constructor(e,t={}){super(e),this.opts=t}toString(e){try{return e.memoizeIntlObject(Intl.DateTimeFormat,this.opts).format(this.value)}catch(t){return e.reportError(t),new Date(this.value).toISOString()}}};var tF=100,TH="\u2068",IH="\u2069";function VH(r,e,t){if(t===e||t instanceof bl&&e instanceof bl&&t.value===e.value)return!0;if(e instanceof bl&&typeof t=="string"){let i=r.memoizeIntlObject(Intl.PluralRules,e.opts).select(e.value);if(t===i)return!0}return!1}function rF(r,e,t){return e[t]?tf(r,e[t].value):(r.reportError(new RangeError("No default")),new Io)}function UV(r,e){let t=[],i=Object.create(null);for(let o of e)o.type==="narg"?i[o.name]=ix(r,o.value):t.push(ix(r,o));return{positional:t,named:i}}function ix(r,e){switch(e.type){case"str":return e.value;case"num":return new bl(e.value,{minimumFractionDigits:e.precision});case"var":return MH(r,e);case"mesg":return AH(r,e);case"term":return LH(r,e);case"func":return OH(r,e);case"select":return PH(r,e);default:return new Io}}function MH(r,{name:e}){let t;if(r.params)if(Object.prototype.hasOwnProperty.call(r.params,e))t=r.params[e];else return new Io(`$${e}`);else if(r.args&&Object.prototype.hasOwnProperty.call(r.args,e))t=r.args[e];else return r.reportError(new ReferenceError(`Unknown variable: $${e}`)),new Io(`$${e}`);if(t instanceof Ru)return t;switch(typeof t){case"string":return t;case"number":return new bl(t);case"object":if(t instanceof Date)return new Op(t.getTime());default:return r.reportError(new TypeError(`Variable type not supported: $${e}, ${typeof t}`)),new Io(`$${e}`)}}function AH(r,{name:e,attr:t}){let i=r.bundle._messages.get(e);if(!i)return r.reportError(new ReferenceError(`Unknown message: ${e}`)),new Io(e);if(t){let o=i.attributes[t];return o?tf(r,o):(r.reportError(new ReferenceError(`Unknown attribute: ${t}`)),new Io(`${e}.${t}`))}return i.value?tf(r,i.value):(r.reportError(new ReferenceError(`No value: ${e}`)),new Io(e))}function LH(r,{name:e,attr:t,args:i}){let o=`-${e}`,n=r.bundle._terms.get(o);if(!n)return r.reportError(new ReferenceError(`Unknown term: ${o}`)),new Io(o);if(t){let s=n.attributes[t];if(s){r.params=UV(r,i).named;let l=tf(r,s);return r.params=null,l}return r.reportError(new ReferenceError(`Unknown attribute: ${t}`)),new Io(`${o}.${t}`)}r.params=UV(r,i).named;let a=tf(r,n.value);return r.params=null,a}function OH(r,{name:e,args:t}){let i=r.bundle._functions[e];if(!i)return r.reportError(new ReferenceError(`Unknown function: ${e}()`)),new Io(`${e}()`);if(typeof i!="function")return r.reportError(new TypeError(`Function ${e}() is not callable`)),new Io(`${e}()`);try{let o=UV(r,t);return i(o.positional,o.named)}catch(o){return r.reportError(o),new Io(`${e}()`)}}function PH(r,{selector:e,variants:t,star:i}){let o=ix(r,e);if(o instanceof Io)return rF(r,t,i);for(let n of t){let a=ix(r,n.key);if(VH(r,o,a))return tf(r,n.value)}return rF(r,t,i)}function HV(r,e){if(r.dirty.has(e))return r.reportError(new RangeError("Cyclic reference")),new Io;r.dirty.add(e);let t=[],i=r.bundle._useIsolating&&e.length>1;for(let o of e){if(typeof o=="string"){t.push(r.bundle._transform(o));continue}if(r.placeables++,r.placeables>tF)throw r.dirty.delete(e),new RangeError(`Too many placeables expanded: ${r.placeables}, max allowed is ${tF}`);i&&t.push(TH),t.push(ix(r,o).toString(r)),i&&t.push(IH)}return r.dirty.delete(e),t.join("")}function tf(r,e){return typeof e=="string"?r.bundle._transform(e):HV(r,e)}var XD=class{constructor(e,t,i){this.dirty=new WeakSet,this.params=null,this.placeables=0,this.bundle=e,this.errors=t,this.args=i}reportError(e){if(!this.errors)throw e;this.errors.push(e)}memoizeIntlObject(e,t){let i=this.bundle._intls.get(e);i||(i={},this.bundle._intls.set(e,i));let o=JSON.stringify(t);return i[o]||(i[o]=new e(this.bundle.locales,t)),i[o]}};function iF(r,e){let t=Object.create(null);for(let[i,o]of Object.entries(r))e.includes(i)&&(t[i]=o.valueOf());return t}var _H=["unitDisplay","currencyDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits"];function oF(r,e){let t=r[0];if(t instanceof Io)return new Io(`NUMBER(${t.valueOf()})`);if(t instanceof bl||t instanceof Op)return new bl(t.valueOf(),__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},t.opts),iF(e,_H)));throw new TypeError("Invalid argument to NUMBER")}var FH=["dateStyle","timeStyle","fractionalSecondDigits","dayPeriod","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName"];function nF(r,e){let t=r[0];if(t instanceof Io)return new Io(`DATETIME(${t.valueOf()})`);if(t instanceof bl||t instanceof Op)return new Op(t.valueOf(),__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},t.opts),iF(e,FH)));throw new TypeError("Invalid argument to DATETIME")}var ox=class{constructor(e,{functions:t,useIsolating:i=!0,transform:o=n=>n}={}){this._terms=new Map,this._messages=new Map,this._intls=new WeakMap,this.locales=Array.isArray(e)?e:[e],this._functions=__dcg_shared_module_exports__['a']({NUMBER:oF,DATETIME:nF},t),this._useIsolating=i,this._transform=o}hasMessage(e){return this._messages.has(e)}getMessage(e){return this._messages.get(e)}addResource(e,{allowOverrides:t=!1}={}){let i=[];for(let o=0;o<e.body.length;o++){let n=e.body[o];if(n.id.startsWith("-")){if(t===!1&&this._terms.has(n.id)){i.push(new Error(`Attempt to override an existing term: "${n.id}"`));continue}this._terms.set(n.id,n)}else{if(t===!1&&this._messages.has(n.id)){i.push(new Error(`Attempt to override an existing message: "${n.id}"`));continue}this._messages.set(n.id,n)}}return i}formatPattern(e,t=null,i=null){if(typeof e=="string")return this._transform(e);let o=new XD(this,i,t);try{return HV(o,e).toString(o)}catch(n){if(o.errors)return o.errors.push(n),new Io().toString(o);throw n}}};var WV=/^(-?[a-zA-Z][\w-]*) *= */gm,aF=/\.([a-zA-Z][\w-]*) *= */y,RH=/\*?\[/y,$V=/(-?[0-9]+(?:\.([0-9]+))?)/y,NH=/([a-zA-Z][\w-]*)/y,sF=/([$-])?([a-zA-Z][\w-]*)(?:\.([a-zA-Z][\w-]*))?/y,BH=/^[A-Z][A-Z0-9_-]*$/,QD=/([^{}\n\r]+)/y,qH=/([^\\"\n\r]*)/y,lF=/\\([\\"])/y,cF=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{6})/y,KH=/^\n+/,dF=/ +$/,zH=/ *\r?\n/g,UH=/( *)$/,HH=/{\s*/y,pF=/\s*}/y,WH=/\[\s*/y,$H=/\s*] */y,jH=/\s*\(\s*/y,YH=/\s*->\s*/y,JH=/\s*:\s*/y,XH=/\s*,?\s*/y,QH=/\s+/y,rf=class{constructor(e){this.body=[],WV.lastIndex=0;let t=0;for(;;){let R=WV.exec(e);if(R===null)break;t=WV.lastIndex;try{this.body.push(l(R[1]))}catch(W){if(W instanceof SyntaxError)continue;throw W}}function i(R){return R.lastIndex=t,R.test(e)}function o(R,W){if(e[t]===R)return t++,!0;if(W)throw new W(`Expected ${R}`);return!1}function n(R,W){if(i(R))return t=R.lastIndex,!0;if(W)throw new W(`Expected ${R.toString()}`);return!1}function a(R){R.lastIndex=t;let W=R.exec(e);if(W===null)throw new SyntaxError(`Expected ${R.toString()}`);return t=R.lastIndex,W}function s(R){return a(R)[1]}function l(R){let W=p(),re=c();if(W===null&&Object.keys(re).length===0)throw new SyntaxError("Expected message value or attributes");return{id:R,value:W,attributes:re}}function c(){let R=Object.create(null);for(;i(aF);){let W=s(aF),re=p();if(re===null)throw new SyntaxError("Expected attribute value");R[W]=re}return R}function p(){let R;if(i(QD)&&(R=s(QD)),e[t]==="{"||e[t]==="}")return u(R?[R]:[],1/0);let W=P();return W?R?u([R,W],W.length):(W.value=L(W.value,KH),u([W],W.length)):R?L(R,dF):null}function u(R=[],W){for(;;){if(i(QD)){R.push(s(QD));continue}if(e[t]==="{"){R.push(m());continue}if(e[t]==="}")throw new SyntaxError("Unbalanced closing brace");let b=P();if(b){R.push(b),W=Math.min(W,b.length);continue}break}let re=R.length-1,ne=R[re];typeof ne=="string"&&(R[re]=L(ne,dF));let X=[];for(let b of R)b instanceof ZD&&(b=b.value.slice(0,b.value.length-W)),b&&X.push(b);return X}function m(){n(HH,SyntaxError);let R=h();if(n(pF))return R;if(n(YH)){let W=D();return n(pF,SyntaxError),__dcg_shared_module_exports__['a']({type:"select",selector:R},W)}throw new SyntaxError("Unclosed placeable")}function h(){if(e[t]==="{")return m();if(i(sF)){let[,R,W,re=null]=a(sF);if(R==="$")return{type:"var",name:W};if(n(jH)){let ne=x();if(R==="-")return{type:"term",name:W,attr:re,args:ne};if(BH.test(W))return{type:"func",name:W,args:ne};throw new SyntaxError("Function names must be all upper-case")}return R==="-"?{type:"term",name:W,attr:re,args:[]}:{type:"mesg",name:W,attr:re}}return M()}function x(){let R=[];for(;;){switch(e[t]){case")":return t++,R;case void 0:throw new SyntaxError("Unclosed argument list")}R.push(C()),n(XH)}}function C(){let R=h();return R.type!=="mesg"?R:n(JH)?{type:"narg",name:R.name,value:M()}:R}function D(){let R=[],W=0,re;for(;i(RH);){o("*")&&(re=W);let ne=k(),X=p();if(X===null)throw new SyntaxError("Expected variant value");R[W++]={key:ne,value:X}}if(W===0)return null;if(re===void 0)throw new SyntaxError("Expected default variant");return{variants:R,star:re}}function k(){n(WH,SyntaxError);let R;return i($V)?R=I():R={type:"str",value:s(NH)},n($H,SyntaxError),R}function M(){if(i($V))return I();if(e[t]==='"')return S();throw new SyntaxError("Invalid expression")}function I(){let[,R,W=""]=a($V),re=W.length;return{type:"num",value:parseFloat(R),precision:re}}function S(){o('"',SyntaxError);let R="";for(;;){if(R+=s(qH),e[t]==="\\"){R+=V();continue}if(o('"'))return{type:"str",value:R};throw new SyntaxError("Unclosed string literal")}}function V(){if(i(lF))return s(lF);if(i(cF)){let[,R,W]=a(cF),re=parseInt(R||W,16);return re<=55295||57344<=re?String.fromCodePoint(re):"\uFFFD"}throw new SyntaxError("Unknown escape sequence")}function P(){let R=t;switch(n(QH),e[t]){case".":case"[":case"*":case"}":case void 0:return!1;case"{":return B(e.slice(R,t))}return e[t-1]===" "?B(e.slice(R,t)):!1}function L(R,W){return R.replace(W,"")}function B(R){let W=R.replace(zH,`
`),re=UH.exec(R)[1].length;return new ZD(W,re)}}},ZD=class{constructor(e,t){this.value=e,this.length=t}};var e9=["ae","ar","arc","bcc","bqi","ckb","dv","fa","glk","he","ku","mzn","nqo","pnb","ps","sd","ug","ur","yi"],Vo=class{constructor(e){this.value=e}},eS=class r{constructor(e,t){this.bundles=e;this.onError=t}static fromSources(e,t,i){let o=[];for(let{lang:n,source:a}of e){let s=n.split("-")[0],l=new ox(n,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},i),{useIsolating:e9.indexOf(s)>=0}));l.addResource(new rf(a),{allowOverrides:!1}),l.addResource(new rf(`
l10n-internal-date-day-month-year = {DATETIME($d, month: "short", day: "numeric", year: "numeric")}
l10n-internal-date-day-month = {DATETIME($d, month: "short", day: "numeric")}
l10n-internal-time = {DATETIME($d, minute: "numeric", hour: "numeric")}
      `),{allowOverrides:!1}),o.push(l)}return new r(o,t)}format(e,t){for(let i of this.bundles){if(!i.hasMessage(e))continue;let o=i.getMessage(e);if(!(o!=null&&o.value))return;let n=[],a=i.formatPattern(o.value,this.coerceNumericVariables(t),n);for(let s of n)this.onError(`Error formatting ${e} for locale ${i.locales.join(",")}: ${s}`);return a}this.onError(`Couldn't find message for key ${e} for locales ${this.getLocales().join(",")}`)}formatDate(e,t){return t.showYear?this.format("l10n-internal-date-day-month-year",{d:e}):this.format("l10n-internal-date-day-month",{d:e})}formatTime(e){let t=this.format("l10n-internal-time",{d:e});return this.getLocales()[0]==="en"?t==null?void 0:t.toLowerCase():t}hasTranslation(e,t){for(let i of this.bundles)if(i.locales.indexOf(t)>=0)return i.hasMessage(e);return!1}coerceNumericVariables(e){let t={};for(let i in e){let o=e[i];o instanceof Vo?t[i]=o.value:typeof o=="number"?t[i]=`${o}`:t[i]=o}return t}getLocales(){return this.bundles.reduce((e,t)=>e.concat(t.locales),[])}};var tS="",jV={},uF={},YV={},t9=["ar","hy-AM","hi","tr","xx-XX"];function rS(r){tS=r||""}function JV(r){for(let e in r)delete YV[e],uF[e]=r[e]}function XV(r,e){let t=e!=null?e:tS;return gF(t).hasTranslation(r,t)}function Ks(r,e){if(e)for(var t in e)e.hasOwnProperty(t)&&(r=r.split("__"+t+"__").join(e[t]));return r}function wo(r,e,t){return hF(r,e!=null?e:{},t!=null?t:tS)}function jl(r){return function(t,i){return hF(t,i!=null?i:{},r())}}function r9(r){let e={};for(let t in r){let i=r[t];i!==void 0&&(e[t]=i)}return e}function hF(r,e,t){let o=gF(t).format(r,r9(e));return o==null?(__dcg_shared_module_exports__['rd'].warn(`Could not format string ${r}`),""):o}function gF(r){let e=YV[r];if(!e){jV[r]||(jV[r]=JD([r]));let t=[];for(let o of jV[r]){let n=uF[o];n&&t.push({lang:o,source:n})}let i={};r==="xx-XX"&&(i.transform=o=>o.replace(/[a-z]/gi,"\u2666")),e=YV[r]=eS.fromSources([...t,{lang:"en",source:eF}],o=>{__dcg_shared_module_exports__['rd'].warn(o)},i)}return e}function nx(){return tS}function QV(r){return fl.hasOwnProperty(r)||__dcg_shared_module_exports__['w'](t9,r)}function kd(r,e){if(r==null)return"";if(typeof r=="string")return r;if(typeof r=="number")return""+r;let t=r.vars,i;if(t){i={};for(let o in t)t.hasOwnProperty(o)&&(i[o]=kd(t[o],e))}return wo(r.key,i,e)}var Ed={cb20221031:"1"};var ax=typeof desmosLocaleData=="object"?desmosLocaleData:{};function sx(){for(var r=JD([Pr("language"),navigator.userLanguage,navigator.language]),e=0;e<r.length;e++){var t=r[e];if(QV(t))return t}return"en"}async function of(r){if(ax[r]||r==="en"||r==="xx-XX")return rS(r),!0;if(!QV(r)){let i=r.indexOf("-")!==-1?r.split("-")[0]:r;for(let o in fl)if(i===o.split("-")[0]&&fl[o].useAsRoot){r=o;break}}let e=await fetch(`/api/v1/calculator/language/${r}.ftl?${new URLSearchParams(Ed)}`,{headers:{Accept:"application/json"}});if(!e.ok)throw e.status===404&&__dcg_shared_module_exports__['rd'].warn(r+" is not an available language."),void 0;let t=await e.json();return ax[r]=t[r],JV(ax),rS(r),!0}function iS(r){return!!ax[r]}JV(ax);rS(sx());var Pp=class r extends kr{constructor(){super();this.highlightPropertyMultipliers={};this.stateProperties=[],this.cloneProperties=[],this.highlightPropertyMultipliers={},this.config=new kr;for(var t in Fu)Fu.hasOwnProperty(t)&&this.addStateProperty(t,Fu[t]);this.labelHangingColor="rgba(150,150,150,1)",this.lastChangedAxis="x",this.addDynamicProperties()}addDynamicProperties(){var t=this;function i(n,a,s){t.cloneProperties.push(n);function l(){t.setProperty(n,t.config.projectorMode?s:a)}t.config.observe("projectorMode",l),l()}function o(n,a,s,l,c){t.cloneProperties.push(n);function p(){var m;t.config.projectorMode?m=t.highlight?c:l:m=t.highlight?s:a,t.setProperty(n,m)}var u=[a,s,l,c];t.highlightPropertyMultipliers[n]=u.map(function(m){return m/u[0]}),t.observe("highlight",p),t.config.observe("projectorMode",p),p()}i("labelSize",14,19),i("majorAxisOpacity",.4,1),i("minorAxisOpacity",.12,.25),i("axisOpacity",.9,.9),i("axisLineWidth",1.5,2),i("axisLineOffset",.25,0),i("pixelsPerLabel",80,120),o("curveOpacity",.7,1,.7,1),i("globalCurveColor",void 0,void 0),i("disableFill",!1,!1),o("graphLineWidth",2.5,3.5,5,7),o("pointLineWidth",9,11,15,17)}setController(t){this.controller=t,this.registerCallbacks()}getHighlightPropertyMultiplier(t,i){var o=i?1:0;return this.config.projectorMode?this.highlightPropertyMultipliers[t][2+o]:this.highlightPropertyMultipliers[t][o]}getFillOpacityMultiplier(){return this.highlight&&this.controller&&this.controller.isGeometry()?2:1}addStateProperty(t,i){this[t]=i,this.stateProperties.push(t),this.cloneProperties.push(t)}static fromObject(t){var i=new r;return i.cloneProperties.forEach(function(o){t.hasOwnProperty(o)&&i.setProperty(o,t[o])}),i}registerCallbacks(){var t=()=>{var i;(i=this.controller)==null||i.requestRedrawGraph()};this.stateProperties.forEach(i=>{this.observe(i,t)}),this.config.observe("backgroundColor",t),this.config.observe("textColor",t),this.config.observe("invertedColors",t),this.observe("backgroundColor",t),this.observe("textColor",t),this.config.observe("enableTabindex",t),this.config.observeAndSync("projectorMode",t)}_validateSetting(t,i){var o;switch(t){case"xAxisMinorSubdivisions":case"yAxisMinorSubdivisions":o=Math.round(Math.min(Math.max(0,i),5)),i!==o&&__dcg_shared_module_exports__['rd'].warn("minorSubdivisions must be an integer between 0 and 5. You provided "+i+", which we changed to "+o+".");break;case"degreeMode":case"projectorMode":case"showGrid":case"showXAxis":case"showYAxis":case"xAxisNumbers":case"yAxisNumbers":case"polarNumbers":case"enableTabindex":case"invertedColors":o=i==="false"?!1:!!i,i!==o&&__dcg_shared_module_exports__['rd'].warn(t+" must be a Boolean. You provided "+i+" ("+typeof i+"), which we changed to "+o+" ("+typeof o+").");break;case"xAxisStep":case"yAxisStep":o=parseFloat(i),isFinite(i)||(o=0,__dcg_shared_module_exports__['rd'].warn(t+" must be a number. You provided "+i+", which we changed to "+o+"."));break;case"xAxisScale":case"yAxisScale":o=i,!this.config.logScales&&i==="logarithmic"?(o="linear",__dcg_shared_module_exports__['rd'].warn("Must set logScales: true to set "+t+" to 'logarithmic'.")):i!=="linear"&&i!=="logarithmic"&&(o="linear",__dcg_shared_module_exports__['rd'].warn(t+' must be "linear" or "logarithmic". You provided '+i+", which we changed to "+o+"."));break;case"xAxisArrowMode":case"yAxisArrowMode":o=__dcg_shared_module_exports__['Zc'][i],o!==i&&(o="NONE",__dcg_shared_module_exports__['rd'].warn(`unknown AxisArrowMode. Allowed values are: 
`+__dcg_shared_module_exports__['M'](__dcg_shared_module_exports__['Zc']).join(`
`)));break;case"xAxisLabel":case"yAxisLabel":o=i,typeof i!="string"&&(o="",__dcg_shared_module_exports__['rd'].warn(t+" must be a string. you provided a "+typeof i+"."));break;case"randomSeed":o=i,typeof i!="string"&&(o=""+i,__dcg_shared_module_exports__['rd'].warn("randomSeed must be a string. you provided a "+typeof i+"."));break;case"backgroundColor":o=i,typeof i!="string"&&(o="",__dcg_shared_module_exports__['rd'].warn(t+" must be a string. you provided a "+typeof i+".")),o||(o="#fff"),o[0]!=="#"&&(o="#"+o);break;case"textColor":o=i,typeof i!="string"&&(o="",__dcg_shared_module_exports__['rd'].warn(t+" must be a string. you provided a "+typeof i+".")),o||(o="#000"),o[0]!=="#"&&(o="#"+o);break;case"fontSize":o=i,typeof i!="number"&&(o=parseInt(o,10),__dcg_shared_module_exports__['rd'].warn("fontSize must be a number. Attempted to convert "+i+" to "+o+"."));break;case"language":o=i,typeof i!="string"&&(o="",__dcg_shared_module_exports__['rd'].warn(t+" must be a string. you provided a "+typeof i+".")),i!=="en"&&!iS(i)&&(o="en",__dcg_shared_module_exports__['rd'].warn(i+" is not currently an available language."));break;default:o=i;break}return o}validateSettings(t){var i={},o=!1;for(var n in t)this.stateProperties.indexOf(n)>=0?i[n]=this._validateSetting(n,t[n]):(__dcg_shared_module_exports__['rd'].warn('Invalid graph setting "'+n+'".'),o=!0);return o&&__dcg_shared_module_exports__['rd'].warn(`Available graph settings are: 
`+this.stateProperties.join(`
`)),i}getBackgroundColor({invertWhite:t}={invertWhite:!1}){var i=__dcg_shared_module_exports__['k'](this.config.backgroundColor||"#fff");return this.config.invertedColors&&(i!=="#ffffff"||t)?__dcg_shared_module_exports__['n'](i):i}getTextColor({invertBlack:t}={invertBlack:!1}){var i=__dcg_shared_module_exports__['k'](this.config.textColor||"#000");return this.config.invertedColors&&(i!=="#000000"||t)?__dcg_shared_module_exports__['n'](i):i}};xt();var l4=__dcg_shared_module_exports__['h'](z());function fR(r,e){var t=__dcg_shared_module_exports__['zb'](r),i=__dcg_shared_module_exports__['zb'](e);if(__dcg_shared_module_exports__['_a'](t.n/t.d,r)&&__dcg_shared_module_exports__['_a'](i.n/i.d,e)){var o=__dcg_shared_module_exports__['Bb'](t.d,i.d),n=t.n*(o/t.d),a=i.n*(o/i.d),s=a-n;return{nstart:n,nstep:s,lcm:o}}}var bR={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function f1(r){let e=[],t=r.toLowerCase();if(t.slice(0,3)==="rgb")try{e=t.replace(/[^\d,]/g,"").split(",").slice(0,3).map(function(o){return parseInt(o,10)})}catch(o){m1(r)}else if(t[0]==="#"){var i=/^#?([a-f\d])([a-f\d])([a-f\d])$/;t=t.replace(i,function(o,n,a,s){return n+n+a+a+s+s});try{e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/.exec(t).slice(1).map(function(o){return parseInt(o,16)})}catch(o){m1(r)}}else e=bR[t];return gW(e)||m1(r),{R:e[0],G:e[1],B:e[2]}}function gW(r){return!__dcg_shared_module_exports__['R'](r)||r.length!==3?!1:__dcg_shared_module_exports__['u'](r,function(e){return Number.isInteger(e)&&e>=0&&e<=255})}function m1(r){throw new Error("Invalid color string: "+r)}function yR(r){var e=r.R/255,t=r.G/255,i=r.B/255,o=[];return o[0]=.49*e+.31*t+.2*i,o[1]=.17697*e+.8124*t+.01063*i,o[2]=.01*t+.99*i,o=__dcg_shared_module_exports__['s'](o,function(n){return n/.17697}),{X:o[0],Y:o[1],Z:o[2]}}function xR(r){var e=95.047,t=100,i=108.883,o=r.X,n=r.Y,a=r.Z,s=[];return s[0]=116*ux(n/t)-16,s[1]=500*(ux(o/e)-ux(n/t)),s[2]=200*(ux(n/t)-ux(a/i)),{L:s[0],a:s[1],b:s[2]}}function ux(r){var e=.20689655172413793;return r>Math.pow(e,3)?Math.pow(r,1/3):r/(3*e*e)+4/29}function mW(r,e){var t=1,i=.045,o=.015,n=1,a=1,s=1,l=r.L,c=r.a,p=r.b,u=e.L,m=e.a,h=e.b,x=l-u,C=Math.sqrt(c*c+p*p),D=Math.sqrt(m*m+h*h),k=C-D,M=c-m,I=p-h,S=Math.sqrt(M*M+I*I-k*k),V=1+i*C,P=1+o*C,L=x/(t*s),B=k/(n*V),R=S/(a*P);return Math.sqrt(L*L+B*B+R*R)}function fW(r,e){var t=xR(yR(f1(r))),i=xR(yR(f1(e)));return mW(t,i)}function wR(r,e){var t=__dcg_shared_module_exports__['s'](e,function(o){return fW(r,o)}),i=__dcg_shared_module_exports__['z'](t);return e[t.indexOf(i)]}function bW({R:r,G:e,B:t}){return .2126729*(r/255)**2.4+.7151522*(e/255)**2.4+.072175*(t/255)**2.4}var b1=.342;function y1(r,e=!1,t=b1){if(typeof r!="string"||!r)return!1;try{let i=f1(r);return bW(i)>t?!e:e}catch(i){return!1}}function Ei(r,e){if(!isFinite(r))return r;if(!isFinite(e))return e;var t=__dcg_shared_module_exports__['Va'](r,e);if(r>0!=e>0||r===0||e===0)return 0;var i=r>0?1:-1,o=Math.abs(r).toExponential().split("e"),n=Math.abs(e).toExponential().split("e"),a=o[0],s=n[0],l=o[1],c=n[1];if(c!==l)return i*Math.pow(10,Math.max(parseFloat(l),parseFloat(c)));if(a[0]!==s[0])return parseFloat(t.toPrecision(1));for(var p=1,u=2;u<Math.min(a.length,s.length)&&(p++,a[u]===s[u]);u++);return parseFloat(t.toPrecision(p))}function yW(r){return __dcg_shared_module_exports__['sb'](r)!==null}var cf=yW;function hx(r){let e=__dcg_shared_module_exports__['lc'](r);if(e.type!=="Assignment")return NaN;if(e._expression.type!=="Constant")return NaN;if(!new __dcg_shared_module_exports__['ld']({enableGeometry:!1,enable3d:!1,beta3d:!1,scales:void 0}).validLHS(e._symbol))return NaN;if(__dcg_shared_module_exports__['mb'][e._symbol])return NaN;let i=e._expression.asValue();return typeof i=="number"?i:NaN}function w1(r){return r===void 0?NaN:+r}function Md(r){return!!r&&r.type==="expression"&&!!r.formula&&!!r.formula.typed_constant_value&&!!r.formula.geometry}var SR={smallCutoff:1e-6,bigCutoff:1e9,digits:12};function kR(r){let e=r.formula;return e?r.controller.isDecimalToFractionEnabled()&&e.hasOwnProperty("constant_value")&&__dcg_shared_module_exports__['db'](w1(e.constant_value)):!1}function zu(r){return!!(r.formula&&r.formula.is_graphable)}function v1(r){let e=r.formula;if(!e)return!1;let i=!(e.operator==="="&&r.controller.isThreeDMode()&&(e.assignment==="x"||e.assignment==="y"||e.assignment==="z"||e.assignment==="r"))&&e.is_evaluable&&e.zero_values&&e.zero_values.length>0&&typeof e.zero_values[0].val!="boolean",o=kR(r)&&Uu(r),n=!!e.rgb_value&&r.formula.assignment;return i||o||n}function C1(r){let e=r.formula;return v1(r)?e.zero_values&&e.zero_values.length?e.zero_values[0].val:e.rgb_value?e.rgb_value:e.constant_value:kR(r)?r.formula.constant_value:NaN}function df(r){var e=r.formula.ttest_results;if(!(!e||!isFinite(e.lessThan)))return{lessThan:e.lessThan,greaterThan:e.greaterThan,notEqual:e.notEqual}}function pf(r){var e=r.formula.stats_results;if(!(!e||!isFinite(e.min)))return{min:e.min,q1:e.q1,median:e.median,q3:e.q3,max:e.max}}function qu(r,e){if(!isFinite(e))return r;let t=r.indexOf("=")+1;return gi(r.slice(t),!1)===e?r:r.slice(0,t)+__dcg_shared_module_exports__['sc'](e)}function Us(r){var e=r.latex||"",t=r.label||"",i=e+t;return i.split(" ").join("")===""}function Gi(r,e={isReverseDrag:!1}){let t=r.dragMode==="AUTO"&&r.formula.default_drag_mode!==void 0?r.formula.default_drag_mode:r.dragMode;return r.controller.isThreeDMode()&&(t="NONE"),r.dragMode==="AUTO"&&!e.isReverseDrag&&Za(r)&&(t="NONE"),__dcg_shared_module_exports__['Qc'](t,r.formula.move_strategy)}function wW(r){let e=Gi(r);r.interactiveLabel&&e!=="NONE"&&Mx(r,!1)}function Xl(r,e,t){if(!r.sliderExists)return NaN;let i=xl(r),o=Pc(r),n=Ql(r);if(t&&t.overwriteStep!==void 0&&(n=t.overwriteStep),e=__dcg_shared_module_exports__['Y']({target:e,hardMin:r.slider.hardMin?i:void 0,hardMax:r.slider.hardMax?o:void 0,step:n}),!t||!t.ignoreSoftLimits){if(!r.slider.hardMin&&e<i)return i;if(!r.slider.hardMax&&e>o)return o}return e}function D1(r,e,t={}){if(!r.sliderExists)return NaN;let i=ws(r),o=xl(r),n=Pc(r),a=Ql(r);t.overwriteStep===void 0&&(t.overwriteStep=a||(n-o)/20);var s=0;switch(e){case"min":return Xl(r,o);case"max":return Xl(r,n);case"up":s=1;break;case"down":s=-1;break;case"bigup":s=5;break;case"bigdown":s=-5;break;default:return e}let l=i;for(var c=0;c<20;c++){let p=c/3*t.overwriteStep,u=i;if(s>0)i=Xl(r,l+p,t),i>u&&(s-=1);else if(s<0)i=Xl(r,l-p,t),i<u&&(s+=1);else break}return i}function pS(r,e){if(r.sliderExists){r.slider.isPlaying&&Hs(r,!1);var t=Xl(r,e,{ignoreSoftLimits:!0});r.latex=qu(r.latex,t)}}function ER(r,e,t){if(r.sliderExists){r.slider.isPlaying&&Hs(r,!1),gf(r);var i=D1(r,e,t);r.latex=qu(r.latex,i)}}function GR(r,e){if(r.sliderExists){r.slider.isPlaying&&Hs(r,!1);var t=Xl(r,e);r.latex=qu(r.latex,t)}}function TR(r,e){if(!r.sliderExists||r.resetSliderAnimationTargetValue)return;var t=r.sliderLastTickTime;if(r.sliderLastTickTime=e,t===void 0)return;var i=e-t;let o=xl(r),n=Pc(r),a=Ql(r),s=r.slider.animationPeriod,l=r.slider.loopMode;if(isNaN(r.sliderAnimationTargetValue)){var c=ws(r);isNaN(c)||(r.sliderAnimationTargetValue=c)}var p=a?a/2:0;if(l==="LOOP_FORWARD_REVERSE")r.sliderAnimationTargetValue>=n?na(r,{playDirection:-1}):r.sliderAnimationTargetValue<=o&&na(r,{playDirection:1});else if(l==="LOOP_FORWARD")na(r,{playDirection:1}),r.sliderAnimationTargetValue>=n+p&&(r.sliderAnimationTargetValue=o-p);else if(l==="PLAY_ONCE")na(r,{playDirection:1});else if(l==="PLAY_INDEFINITELY")na(r,{playDirection:1});else throw new Error("Unexpected slider loop mode: "+l);isFinite(i)||(i=0);var u,m;if(l==="PLAY_INDEFINITELY")u=i/(s/4),a&&(u*=a),r.sliderAnimationTargetValue+=u,m=r.sliderAnimationTargetValue,a||(m=Ei(m-u*.1,m+u*.1)),m=Xl(r,m,{ignoreSoftLimits:!0}),r.latex=qu(r.latex,m);else{if(i=Math.min(i,s/10),u=(n-o)*i/s,r.sliderAnimationTargetValue+=u*r.slider.playDirection,r.sliderAnimationTargetValue=Math.max(o-p,Math.min(n+p,r.sliderAnimationTargetValue)),m=r.sliderAnimationTargetValue,!a){let h=u/i*16.666666666666668;m=Ei(m-h*.1,m+h*.1)}m=Xl(r,m),r.latex=qu(r.latex,m)}}function uS(r){let e=r.formula;return e?e.is_single_identifier?[]:e.variables||[]:[]}function S1(r,e){r.formula=e,r.error=e.error,r.unresolved=!1,e.is_slider?(!r.sliderExists||r.resetSliderAnimationTargetValue)&&(r.sliderAnimationTargetValue=ws(r),r.sliderDragging=!1,r.sliderExists=!0):r.sliderExists=!1,r.resetSliderAnimationTargetValue=!1;var t={};e.is_regression&&(t=e.regression.parameters,r.residualVariable=e.regression.residualVariable,r.controller.areLogModeRegressionsForced()&&(r.isLogModeRegression=!0)),__dcg_shared_module_exports__['P'](r.regressionParameters,t)||(r.regressionParameters=t)}function vW(r){if(r.shouldGraph=!Za(r),r.folderId===__dcg_shared_module_exports__['ad']){let e=r.controller.getExpressionIdForIdentifier(r.controller.getHoveredOrFocusedTokenIdentifier())===r.id,t=r.controller.isItemSelected(r.id);(e||t||r.controller.getGhostMode())&&(r.shouldGraph=!0)}}function Za(r){var t;if(!r)return!1;if(r.hidden)return!0;if((t=r==null?void 0:r.formula)!=null&&t.expression_type&&yf(r))return!0;let e=Ws(r);return!!(e&&e.hidden)}function CW(r){let e=r.formula&&r.formula.raw_slider_latex;if(!r.sliderExists||r.latex!==e){r.cachedDisplayLatex={storedLatex:r.latex,valueLatex:r.latex};return}let{latex:t}=r;if(r.cachedDisplayLatex.storedLatex!==t){r.cachedDisplayLatex={storedLatex:r.latex,valueLatex:r.latex};return}let i=MR(r);if(isFinite(i)){let o=r.controller.getFocusLocation();o&&o.type==="expression"&&o.id===r.id||(r.cachedDisplayLatex.valueLatex=qu(r.latex,i))}}function mx(r){return r.cachedDisplayLatex.valueLatex}function IR(r){return __dcg_shared_module_exports__['bb'](r).latex}function hS(r){return r.slider.hardMin?r.slider.min:IR(xl(r))}function VR(r){return r.slider.hardMax?r.slider.max:IR(Pc(r))}function xl(r){if(r.slider.hardMin){let e=r.formula.slider_min_number;return isFinite(e)?e:NaN}else{let e=r.controller.isDegreeMode(),t=gi(r.slider.min,e),i=ws(r),o=Ql(r),n=r.slider.hardMax?r.formula.slider_max_number:void 0,s=r.controller.is3dProduct()?__dcg_shared_module_exports__['W'].xmin:-10;if(t<s&&(s=t),i<s&&(s=i),n<s&&(s=n),o){let l=__dcg_shared_module_exports__['Y']({target:s,hardMin:void 0,hardMax:n,step:o});l<=s?s=l:s=l-o}return s}}function Pc(r){if(r.slider.hardMax){let e=r.formula.slider_max_number;return isFinite(e)?e:NaN}else{let e=r.controller.isDegreeMode(),t=gi(r.slider.max,e),i=ws(r),o=Ql(r),n=r.slider.hardMin?r.formula.slider_min_number:void 0;return __dcg_shared_module_exports__['Z']({storedMax:t,sliderValue:i,step:o,hardMin:n,is3d:r.controller.is3dProduct()})}}function Ql(r){return r.formula.slider_step_number}function MR(r){if(!r.formula||!r.formula.is_slider)return;let e=r.formula.constant_value;if(e!==void 0)return+e}function ws(r){let e=r.formula&&r.formula.raw_slider_latex;if(r.latex!==e)return hx(r.latex);let t=MR(r);return isFinite(t)?t:NaN}function k1(r){return r.slider.loopMode!=="PLAY_ONCE"?!1:ws(r)>=Pc(r)}function AR(r,e){return r.formula.viz_valids?!!r.formula.viz_valids[e]:!1}function Fp(r,e){return r.vizProps[e]}function LR(r,e,t){r.vizProps=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.vizProps),{[e]:t})}function OR(r,e,t){r.clickableInfo=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.clickableInfo),{[e]:t})}function gS(r,e){r.clickableInfo=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.clickableInfo),{latex:e})}function vs(r){var e;return!!(r.clickableInfo.enabled&&W1(r)&&((e=r.formula.click_handler)==null?void 0:e.status)==="maybe-valid")}function PR(r){return!!r.__workerNeedsDotplotXMode}function mS(r){return!!(r.formula&&r.formula.slider_min_valid)}function fS(r){return!!(r.formula&&r.formula.slider_max_valid)}function bS(r){return!!(r.formula&&r.formula.slider_step_valid)}function _R(r){if(!r.formula)return NaN;if(r.formula.expression_type==="SURFACE_xyz_uv"||r.formula.expression_type==="SURFACE_r_\u03B8\u03C6"||r.formula.expression_type==="SURFACE_r_\u03B8\u03C6_AMBIGUOUS"||r.formula.expression_type==="SURFACE_z_r\u03B8"||r.formula.expression_type==="SLICE_r\u03B8z_at_z"||r.formula.expression_type==="SLICE_zr\u03B8_at_r"||r.formula.expression_type==="SLICE_zr\u03B8_at_\u03B8"||r.formula.expression_type==="SLICE_zr\u03B8_at_xyz"||r.formula.expression_type==="SLICE_r\u03B8\u03C6_at_\u03B8"||r.formula.expression_type==="SLICE_r\u03B8\u03C6_at_\u03C6"||r.formula.expression_type==="SLICE_r\u03B8\u03C6_at_xyz"||r.formula.expression_type==="SLICE_xyz_uv")return 0;if(Hu(r)&&isFinite(r.__workerSampledDomainMin))return r.__workerSampledDomainMin;let e=r.formula.domain_min_number;return isFinite(e)?e:NaN}function FR(r,e=""){if(!r.formula)return NaN;if(r.formula.expression_type==="SURFACE_xyz_uv"||r.formula.expression_type==="SLICE_xyz_uv")return 1;let t=r.controller.isDegreeMode()?180/Math.PI:1;if(r.formula.expression_type==="SURFACE_r_\u03B8\u03C6"||r.formula.expression_type==="SURFACE_r_\u03B8\u03C6_AMBIGUOUS"||r.formula.expression_type==="SLICE_r\u03B8z_at_z"||r.formula.expression_type==="SLICE_r\u03B8\u03C6_at_\u03B8"||r.formula.expression_type==="SLICE_r\u03B8\u03C6_at_\u03C6"||r.formula.expression_type==="SLICE_r\u03B8\u03C6_at_xyz"){if(e==="\\theta")return Math.PI*2*t;if(e==="\\phi")return Math.PI*t}if(r.formula.expression_type==="SURFACE_z_r\u03B8"||r.formula.expression_type==="SLICE_zr\u03B8_at_r"||r.formula.expression_type==="SLICE_zr\u03B8_at_\u03B8"||r.formula.expression_type==="SLICE_zr\u03B8_at_xyz"){if(e==="r")return __dcg_shared_module_exports__['W'].xmax;if(e==="\\theta")return Math.PI*2*t}if(Hu(r)&&isFinite(r.__workerSampledDomainMax))return r.__workerSampledDomainMax;let i=r.formula.domain_max_number;return isFinite(i)?i:NaN}function RR(r,e){switch(e){case"u":return!!(r.formula&&r.formula.domain_min_u_valid);case"r":return!!(r.formula&&(zs(r)&&r.formula.domain_min_u_valid||r.formula.domain_min_valid));case"\\theta":return!!(r.formula&&(wl(r)&&r.formula.domain_min_u_valid||zs(r)&&r.formula.domain_min_v_valid||r.formula.domain_min_valid));case"v":case"\\phi":return!!(r.formula&&r.formula.domain_min_v_valid)}return!!(r.formula&&r.formula.domain_min_valid)}function NR(r,e){switch(e){case"u":return!!(r.formula&&r.formula.domain_max_u_valid);case"r":return!!(r.formula&&(zs(r)&&r.formula.domain_max_u_valid||r.formula.domain_max_valid));case"\\theta":return!!(r.formula&&(wl(r)&&r.formula.domain_max_u_valid||zs(r)&&r.formula.domain_max_v_valid||r.formula.domain_max_valid));case"v":case"\\phi":return!!(r.formula&&r.formula.domain_max_v_valid)}return!!(r.formula&&r.formula.domain_max_valid)}function ng(r,e){var t=r.cachedViewState;if((!e.stripDefaults||r.parametricDomain.min!==""||r.parametricDomain.max!=="")&&(t=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{domain:{min:r.parametricDomain.min===""?"0":r.parametricDomain.min,max:r.parametricDomain.max===""?"1":r.parametricDomain.max}})),e.stripDefaults)return __dcg_shared_module_exports__['hd'](t,{is3d:r.controller.is3dProduct()});if(t.points===void 0||t.lines===void 0||t.fill===void 0){let i=__dcg_shared_module_exports__['j'](t);return i.points===void 0&&delete i.points,i.lines===void 0&&delete i.lines,i.fill===void 0&&delete i.fill,i}return t}function DW(r){let e=r.cachedViewState;e&&__dcg_shared_module_exports__['jd'](e,r)&&e.folderId===r.folderId&&e.color===r.color&&e.latex===r.latex&&e.showLabel===r.showLabel&&e.showAngleLabel===r.showAngleLabel&&e.label===r.label&&e.hidden===r.hidden&&e.secret===r.secret&&e.readonly===r.readonly&&e.fill===r.fill&&e.points===r.points&&e.lines===r.lines&&e.extendTo3D===r.extendTo3D&&e.lineStyle===r.lineStyle&&e.arrowMode===r.arrowMode&&e.pointStyle===r.pointStyle&&e.dragMode===r.dragMode&&e.labelSize===r.labelSize&&e.labelOrientation===r.labelOrientation&&e.suppressTextOutline===r.suppressTextOutline&&e.interactiveLabel===r.interactiveLabel&&e.editableLabelMode===r.editableLabelMode&&e.residualVariable===r.residualVariable&&e.regressionParameters===r.regressionParameters&&e.isLogModeRegression===r.isLogModeRegression&&e.displayEvaluationAsFraction===r.displayEvaluationAsFraction&&e.slider===r.slider&&e.strictIntersection===r.strictIntersection||(r.cachedViewState=__dcg_shared_module_exports__['a']({type:r.type,id:r.id,folderId:r.folderId,color:r.color,latex:r.latex,showLabel:r.showLabel,showAngleLabel:r.showAngleLabel,label:r.label,hidden:r.hidden,secret:r.secret,readonly:r.readonly,points:r.points,lines:r.lines,extendTo3D:r.extendTo3D,lineStyle:r.lineStyle,arrowMode:r.arrowMode,pointStyle:r.pointStyle,fill:r.fill,dragMode:r.dragMode,labelSize:r.labelSize,labelOrientation:r.labelOrientation,suppressTextOutline:r.suppressTextOutline,interactiveLabel:r.interactiveLabel,editableLabelMode:r.editableLabelMode,residualVariable:r.residualVariable,regressionParameters:r.regressionParameters,isLogModeRegression:r.isLogModeRegression,displayEvaluationAsFraction:r.displayEvaluationAsFraction,slider:r.slider,strictIntersection:r.strictIntersection},__dcg_shared_module_exports__['id'](r)))}function E1(r,e){e&&gf(r),r.draggingOnGraphpaper=e}function SW(r){var e=r.memoizedUndoRedoStateParams,t=r.cachedViewState,i=r.preTransientState;if(r.cachedUndoRedoFullState=t,e&&e.viewState===t&&e.preTransientState===i)return;r.memoizedUndoRedoStateParams={viewState:t,preTransientState:i};let o;i?o=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{latex:i.latex,slider:__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},t.slider),i.slider)}):o=__dcg_shared_module_exports__['a']({},t),delete o.regressionParameters,delete o.residualVariable,r.cachedUndoRedoDiffState=o}function yS(r,e){let t=__dcg_shared_module_exports__['j'](__dcg_shared_module_exports__['gd'](r,{is3d:e.is3dProduct()})),{color:i}=t;return(!i||!cf(i))&&(i=e.getNextColor()),__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},t),_d(e)),{labelDropdownOpen:!1,formula:{error:void 0,operator:"=",variables:[]},error:void 0,unresolved:!1,color:i,pointStyle:t.pointStyle,lineStyle:t.lineStyle,arrowMode:t.arrowMode,displayEvaluationAsFraction:t.displayEvaluationAsFraction,shouldGraph:void 0,sliderDragging:void 0,sliderAnimationTargetValue:void 0,resetSliderAnimationTargetValue:!1,sliderLastTickTime:void 0,draggingOnGraphpaper:!1,cachedUndoRedoDiffState:void 0,cachedUndoRedoFullState:void 0,cachedParsableState:void 0,cachedViewState:void 0,cachedDisplayLatex:{storedLatex:"",valueLatex:""}})}function kW(r){let e=Ws(r),t=!!(e&&e.hidden),i=r.cachedViewState,o=r.index,n=r.showLabel&&!t,a=r.showAngleLabel,s=r.shouldGraph,l=r.memoizedParsableStateParams;if(l&&l.viewState===i&&l.index===o&&l.showLabel===n&&l.showAngleLabel===a&&l.shouldGraph===s)return;r.memoizedParsableStateParams={viewState:i,index:o,showLabel:n,showAngleLabel:a,shouldGraph:s};let c=__dcg_shared_module_exports__['kd'](i);c.index=o,c.showLabel=n,c.showAngleLabel=a,c.shouldGraph=s,c.isInConstructionsFolder=r.folderId===__dcg_shared_module_exports__['ad'],r.cachedParsableState=c}function xS(r,e){e(r.latex,"latex"),e(r.clickableInfo.latex,"clickableInfoLatex"),e(r.lineWidth,"lineWidth"),e(r.fillOpacity,"fillOpacity"),e(r.lineOpacity,"lineOpacity"),e(r.pointOpacity,"pointOpacity"),e(r.pointSize,"pointSize"),e(r.labelSize,"labelSize"),e(r.labelAngle,"labelAngle"),e(r.colorLatex,"colorLatex"),Np(r)&&(e(r.parametricDomain.min,"parametricDomainMin"),e(r.parametricDomain.max,"parametricDomainMax")),(MS(r)||wl(r))&&(e(r.parametricDomain3Du.min,"parametricDomain3DuMin"),e(r.parametricDomain3Du.max,"parametricDomain3DuMax"),e(r.parametricDomain3Dv.min,"parametricDomain3DvMin"),e(r.parametricDomain3Dv.max,"parametricDomain3DvMax")),(Hu(r)||vf(r))&&(e(r.polarDomain.min,"polarDomainMin"),e(r.polarDomain.max,"polarDomainMax")),(N1(r)||R1(r))&&e(r.resolution,"resolution"),Pd(r)&&(e(r.cdf.min,"cdfMin"),e(r.cdf.max,"cdfMax")),r.sliderExists&&(e(r.slider.min,"sliderMin"),e(r.slider.max,"sliderMax"),e(r.slider.step,"sliderStep")),r.residualVariable&&e(r.residualVariable,"residualVariable")}function In(r){return r.formula&&r.formula.assignment}function G1(r){return r.formula&&r.formula.shader}function Fo(r){let e=r.cachedAssignmentOrFunctionName;if(e&&e.latex===r.latex)return e.result;let t=rx(r.latex),i=t?{latex:t,identifier:__dcg_shared_module_exports__['jb'](t)}:void 0;return r.cachedAssignmentOrFunctionName={latex:r.latex,result:i},i}function T1(r){let e=r.cachedFunctionCallArgumentsLatex;if(e&&e.latex===r.latex)return e.parsedArgs;let t=H_(r.latex);return r.cachedFunctionCallArgumentsLatex={latex:r.latex,parsedArgs:t},t}function BR(r){var t,i;let e=(i=(t=r.formula)==null?void 0:t.typed_constant_value)==null?void 0:i.valueType;return e==null?!1:__dcg_shared_module_exports__['Ka'](e)}function I1(r){var i;let e=(i=Fo(r))==null?void 0:i.latex;var t=e==null?void 0:e.match(/^(\\token\{\d+\})$/);if(t)return t[1]}function qR(r){var i,o;let e=(o=(i=r.formula)==null?void 0:i.typed_constant_value)==null?void 0:o.valueType,t=!1;if(e&&__dcg_shared_module_exports__['Ka'](e)&&(t=!0,e=__dcg_shared_module_exports__['La'](e)),e==null||!__dcg_shared_module_exports__['Ma'](e))return"U";switch(e){case __dcg_shared_module_exports__['da']:return t?"P":"p";case __dcg_shared_module_exports__['na']:case __dcg_shared_module_exports__['va']:case __dcg_shared_module_exports__['ta']:return t?"L":"l";case __dcg_shared_module_exports__['Da']:return t?"V":"v";case __dcg_shared_module_exports__['ra']:case __dcg_shared_module_exports__['pa']:return t?"C":"c";case __dcg_shared_module_exports__['xa']:case __dcg_shared_module_exports__['za']:return t?"A":"a";case __dcg_shared_module_exports__['la']:return"P";case __dcg_shared_module_exports__['Ba']:return"T";default:return e}}function EW(r){var t,i;let e=(i=(t=r.formula)==null?void 0:t.typed_constant_value)==null?void 0:i.valueType;if(e==null||(__dcg_shared_module_exports__['Ka'](e)&&(e=__dcg_shared_module_exports__['La'](e)),!__dcg_shared_module_exports__['Ma'](e)))return"unknown";switch(e){case __dcg_shared_module_exports__['da']:return"point";case __dcg_shared_module_exports__['na']:return"segment";case __dcg_shared_module_exports__['va']:return"ray";case __dcg_shared_module_exports__['ta']:return"line";case __dcg_shared_module_exports__['Da']:return"vector";case __dcg_shared_module_exports__['ra']:return"arc";case __dcg_shared_module_exports__['pa']:return"circle";case __dcg_shared_module_exports__['xa']:return"angle";case __dcg_shared_module_exports__['za']:return"directedangle";case __dcg_shared_module_exports__['la']:return"polygon";case __dcg_shared_module_exports__['Ba']:return"transformation";default:return e}return"unknown"}function V1(r){var t,i;let e=(i=(t=r.formula)==null?void 0:t.typed_constant_value)==null?void 0:i.valueType;if(e==null||(__dcg_shared_module_exports__['Ka'](e)&&(e=__dcg_shared_module_exports__['La'](e)),!__dcg_shared_module_exports__['Ma'](e)))return"unknown";switch(e){case __dcg_shared_module_exports__['da']:return"point";case __dcg_shared_module_exports__['na']:case __dcg_shared_module_exports__['va']:case __dcg_shared_module_exports__['ta']:case __dcg_shared_module_exports__['Da']:return"line";case __dcg_shared_module_exports__['ra']:return"arc";case __dcg_shared_module_exports__['pa']:return"circle";case __dcg_shared_module_exports__['xa']:return"angle";case __dcg_shared_module_exports__['za']:return"directedangle";case __dcg_shared_module_exports__['la']:return"polygon";case __dcg_shared_module_exports__['Ba']:return"transformation";default:return e}return"unknown"}function KR(r){return r.indexOf("\\token{")!==-1}function zR(r){var i,o,n,a;let e=(o=(i=r.formula.geometry)==null?void 0:i.call)==null?void 0:o.symbol,t=(a=(n=r.formula)==null?void 0:n.typed_constant_value)==null?void 0:a.valueType;return!e||e==="apply"||__dcg_shared_module_exports__['ac'](e)&&t!==void 0&&!__dcg_shared_module_exports__['Pa'](t,__dcg_shared_module_exports__['Ba'])?EW(r):e}function GW(r){return!!(r.sliderExists&&(r.slider.isPlaying||r.sliderDragging)||r.draggingOnGraphpaper)}function UR(r){return!!(r.sliderExists&&r.sliderDragging||r.draggingOnGraphpaper)}function M1(r){var e=GW(r);e?r.preTransientState||(r.preTransientState={latex:r.latex,slider:{min:r.slider.min,max:r.slider.max,playDirection:r.slider.playDirection}}):delete r.preTransientState,(!r.sliderExists||!r.slider.isPlaying)&&(r.sliderLastTickTime=void 0),Fd(r),vW(r),wW(r),DW(r),SW(r),kW(r),CW(r)}var TW=__dcg_shared_module_exports__['a']({id:!1,type:!1,color:!0,folderId:!0,latex:!0,showLabel:!0,showAngleLabel:!0,label:!0,hidden:!0,secret:!0,readonly:!0,points:!0,lines:!0,lineStyle:!0,arrowMode:!0,pointStyle:!0,fill:!0,dragMode:!0,labelSize:!0,labelOrientation:!0,suppressTextOutline:!0,interactiveLabel:!0,editableLabelMode:!0,residualVariable:!0,regressionParameters:!0,isLogModeRegression:!0,displayEvaluationAsFraction:!0,slider:!0,strictIntersection:!0,angleType:!0,showAngleDirection:!0,extendTo3D:!1},__dcg_shared_module_exports__['Yc'](__dcg_shared_module_exports__['cd']));function HR(r,e){__dcg_shared_module_exports__['Vc']({from:e,to:r,props:TW}),r.resetSliderAnimationTargetValue=!0,r.sliderAnimationTargetValue=void 0}function uf(r,e){e?na(r,{hardMin:!0,min:e}):na(r,{hardMin:!1,min:r.controller.is3dProduct()?`${__dcg_shared_module_exports__['W'].xmin}`:"-10"})}function hf(r,e){e?na(r,{hardMax:!0,max:e}):na(r,{hardMax:!1,max:r.controller.is3dProduct()?`${__dcg_shared_module_exports__['W'].xmax}`:"10"})}function na(r,e){r.slider=__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},r.slider),e)}function Hs(r,e){!r||r.slider.isPlaying===e||(na(r,{isPlaying:e}),e&&(gf(r),r.sliderAnimationTargetValue=ws(r)))}function gf(r){if(!r.slider.hardMin){let e=__dcg_shared_module_exports__['rc'](xl(r));e!==r.slider.min&&na(r,{min:e})}if(!r.slider.hardMax){let e=__dcg_shared_module_exports__['rc'](Pc(r));e!==r.slider.max&&na(r,{max:e})}}function Cs(r,e){var t=hx(e);if(isFinite(t)){let i=__dcg_shared_module_exports__['X']({target:t,step:Ql(r),hardMin:r.slider.hardMin?xl(r):void 0,hardMax:r.slider.hardMax?Pc(r):void 0});i.min||na(r,{hardMin:!1,min:"-10"}),i.max||na(r,{hardMax:!1,max:"10"}),i.step||na(r,{step:""})}r.latex=e}function WR(r,e){na(r,{loopMode:e,playDirection:1}),e==="PLAY_INDEFINITELY"&&na(r,{hardMin:!1,hardMax:!1,min:"",max:""}),r.sliderAnimationTargetValue=xl(r)}function fx(r,e){e&&gf(r),r.sliderDragging=e}function bx(r,e){na(r,{step:e})}function $R(r,e){na(r,{animationPeriod:e})}function Uu(r){return r.displayEvaluationAsFraction}function jR(r,e){r.displayEvaluationAsFraction=e}function Rp(r,e){r.label=e}function ag(r,e){Wu(r)?r.showAngleLabel=e:r.showLabel=e}function YR(r,e){r.description=e}function yx(r,e){r.polarDomain=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.polarDomain),{min:e})}function xx(r,e){r.parametricDomain=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.parametricDomain),{min:e})}function wx(r,e){r.parametricDomain3Du=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.parametricDomain3Du),{min:e})}function vx(r,e){r.parametricDomain3Dv=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.parametricDomain3Dv),{min:e})}function Cx(r,e){r.polarDomain=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.polarDomain),{max:e})}function Dx(r,e){r.parametricDomain=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.parametricDomain),{max:e})}function Sx(r,e){r.parametricDomain3Du=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.parametricDomain3Du),{max:e})}function kx(r,e){r.parametricDomain3Dv=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.parametricDomain3Dv),{max:e})}function A1(r,e){r.isLogModeRegression=e}function wS(r,e){cf(e)&&(r.color=e,r.colorLatex="")}function L1(r,e){r.fill=e}function Ex(r,e){r.fillOpacity!==e&&(r.fillOpacity=e)}function mf(r,e){r.lineOpacity!==e&&(r.lineOpacity=e)}function Gx(r,e){r.pointOpacity!==e&&(r.pointOpacity=e)}function Tx(r,e){r.pointSize!==e&&(r.pointSize=e)}function ff(r,e){r.lineWidth!==e&&(r.lineWidth=e)}function vS(r,e){r.resolution!==e&&(r.resolution=e)}function CS(r,e){r.checkers!==e&&(r.checkers=e)}function JR(r,e){r.polarCoordinateSystem!==e&&(r.polarCoordinateSystem=e)}function Ix(r,e){r.colorLatex!==e&&(r.colorLatex=e)}function XR(r,e){r.labelDropdownOpen=e}function sg(r,e){r.dragMode!==e&&(r.dragMode=e)}function O1(r,e){r.points=e}function P1(r,e){r.pointStyle!==e&&(r.pointStyle=e,e!=="POINT"&&(r.dragMode="NONE"))}function _1(r,e){r.lines=e}function QR(r,e){r.extendTo3D=e}function DS(r,e){r.lineStyle!==e&&(r.lineStyle=e)}function ZR(r,e){r.arrowMode=e===IW(r)?"DEFAULT":e}function IW(r){return"NONE"}function Vx(r,e){r.labelSize=e}function SS(r,e){r.labelAngle=e}function F1(r,e){r.labelOrientation=e}function eN(r,e){r.suppressTextOutline=e}function Mx(r,e){r.interactiveLabel=e}function kS(r,e){r.editableLabelMode=e}function tN(r){return r.editableLabelMode}function bf(r){let{editableLabelMode:e}=r;return e==="MATH"||e==="TEXT"}function rN(r,e){r.strictIntersection=e}function iN(r){return!!(Gi(r)!=="NONE"&&Za(r))}function oN(r,e){r.hidden=e,!e&&yf(r)&&(r.lines=r.points=r.fill=void 0)}function yf(r){if(Ld(r)&&!r.controller.isThreeDMode())return!1;let{points:e,lines:t,fill:i}=r,o=__dcg_shared_module_exports__['pc'](r.formula.expression_type,{points:e,lines:t,fill:i});return!o.points&&!o.lines&&!o.fill}function ES(r){return Np(r)||Hu(r)||vf(r)}function GS(r){return MS(r)||wl(r)||zs(r)}function nN(r){return r.polarDomain.min}function aN(r){return r.polarDomain.max}function sN(r){return r.parametricDomain.min}function lN(r){return r.parametricDomain3Du.min}function cN(r){return r.parametricDomain3Dv.min}function dN(r){return r.parametricDomain.max}function pN(r){return r.parametricDomain3Du.max}function uN(r){return r.parametricDomain3Dv.max}function xf(r){return!!r.formula.action_value&&Object.keys(r.formula.action_value).length>0}function hN(r){return!!r.sliderExists}function Ad(r){return r.formula.expression_type==="POLYGON"}function Ld(r){return!!r.formula.is_inequality}function wf(r){return!!r.formula.is_regression}function Np(r){return r.formula.expression_type==="PARAMETRIC"||r.formula.expression_type==="CURVE3D_xyz_t"&&!Ax(r)&&!Lx(r)}function TS(r){return r.formula.expression_type==="POINT3D"}function R1(r){return r.formula.expression_type==="CURVE3D_xyz_t"||r.formula.expression_type==="SLICE"||r.formula.expression_type==="SLICE_r\u03B8z_at_z"||r.formula.expression_type==="SLICE_zr\u03B8_at_r"||r.formula.expression_type==="SLICE_zr\u03B8_at_\u03B8"||r.formula.expression_type==="SLICE_zr\u03B8_at_xyz"||r.formula.expression_type==="SLICE_r\u03B8\u03C6_at_\u03B8"||r.formula.expression_type==="SLICE_r\u03B8\u03C6_at_\u03C6"||r.formula.expression_type==="SLICE_r\u03B8\u03C6_at_xyz"||r.formula.expression_type==="SLICE_xyz_uv"}function gN(r){return r.formula.expression_type==="SLICE_zr\u03B8_at_r"||r.formula.expression_type==="SLICE_r\u03B8\u03C6_at_\u03B8"}function mN(r){return r.formula.expression_type==="SLICE_zr\u03B8_at_\u03B8"||r.formula.expression_type==="SLICE_r\u03B8\u03C6_at_\u03C6"}function N1(r){switch(r.formula.expression_type){case"SURFACE_xyz_uv":case"SURFACE_z_r\u03B8":case"SURFACE_r_\u03B8z":case"SURFACE_r_\u03B8z_AMBIGUOUS":case"SURFACE_r_\u03B8\u03C6":case"SURFACE_r_\u03B8\u03C6_AMBIGUOUS":case"SURFACE":case"SURFACE_AMBIGUOUS":case"SURFACE_CONSTANT_AMBIGUOUS":case"IMPLICIT_SURFACE":case"IMPLICIT_SURFACE_AMBIGUOUS":case"TRIANGLE3D":case"SPHERE3D":return!0;default:return!1}}function IS(r){return r.formula.expression_type==="TRIANGLE3D"}function fN(r){return r.formula.expression_type==="SPHERE3D"}function bN(r){return r.formula.expression_type==="IMPLICIT_SURFACE"||r.formula.expression_type==="IMPLICIT_SURFACE_AMBIGUOUS"}function VS(r){return VW(r)||B1(r)}function VW(r){return r.formula.expression_type==="X_OR_Y"||r.formula.expression_type==="IMPLICIT"||r.formula.expression_type==="SURFACE_AMBIGUOUS"||r.formula.expression_type==="SURFACE_CONSTANT_AMBIGUOUS"||r.formula.expression_type==="IMPLICIT_SURFACE_AMBIGUOUS"}function B1(r){return!r.formula.is_inequality&&(r.formula.expression_type==="POLAR"||r.formula.expression_type==="SURFACE_r_\u03B8z_AMBIGUOUS"||r.formula.expression_type==="SURFACE_r_\u03B8\u03C6_AMBIGUOUS")}function Hu(r){return r.formula.expression_type==="POLAR"}function vf(r){return r.formula.expression_type==="SURFACE_r_\u03B8z"||r.formula.expression_type==="SURFACE_r_\u03B8z_AMBIGUOUS"||r.formula.expression_type==="SLICE_r\u03B8z_at_z"}function zs(r){return r.formula.expression_type==="SURFACE_z_r\u03B8"||r.formula.expression_type==="SLICE_zr\u03B8_at_r"||r.formula.expression_type==="SLICE_zr\u03B8_at_\u03B8"||r.formula.expression_type==="SLICE_zr\u03B8_at_xyz"}function wl(r){return r.formula.expression_type==="SURFACE_r_\u03B8\u03C6"||r.formula.expression_type==="SURFACE_r_\u03B8\u03C6_AMBIGUOUS"||r.formula.expression_type==="SLICE_r\u03B8\u03C6_at_\u03B8"||r.formula.expression_type==="SLICE_r\u03B8\u03C6_at_\u03C6"||r.formula.expression_type==="SLICE_r\u03B8\u03C6_at_xyz"}function MS(r){return r.formula.expression_type==="SURFACE_xyz_uv"||r.formula.expression_type==="SLICE_xyz_uv"}function Wu(r){let e=r.formula.typed_constant_value;if(!e)return!1;let t=e.valueType;return t===__dcg_shared_module_exports__['xa']||t===__dcg_shared_module_exports__['ya']||t===__dcg_shared_module_exports__['za']||t===__dcg_shared_module_exports__['Aa']}function _c(r){let e=Wu(r);return e&&r.showAngleLabel||!e&&r.showLabel}function yN(r){if(Od(r))return!0;let e=r.formula.typed_constant_value;if(!e)return!1;let t=e.valueType;return t===__dcg_shared_module_exports__['na']||t===__dcg_shared_module_exports__['oa']||t===__dcg_shared_module_exports__['xa']||t===__dcg_shared_module_exports__['ya']||t===__dcg_shared_module_exports__['za']||t===__dcg_shared_module_exports__['Aa']}function Ax(r){return r.formula.expression_type==="SEGMENT3D"}function Lx(r){return r.formula.expression_type==="VECTOR3D"}function es(r){return r.formula.expression_type==="SINGLE_POINT"}function Ox(r){return r.formula.expression_type==="POINT_LIST"}function Od(r){return r.formula.expression_type==="POINT_LIST"||r.formula.expression_type==="SINGLE_POINT"}function AS(r){return r.formula.expression_type==="POINT3D_LIST"}function $u(r){let e=vl(r);return!!(e&&e.type==="visualization"&&e.symbol==="boxplot")}function Bp(r){let e=vl(r);return!!(e&&e.type==="visualization"&&e.symbol==="dotplot")}function lg(r){let e=vl(r);return!!(e&&e.type==="visualization"&&e.symbol==="histogram")}function LS(r){var e=$u(r)||Bp(r)||lg(r);return e}function OS(r){return r.formula.expression_type==="TTEST"}function xN(r){return r.formula.expression_type==="STATS"}function ju(r){let e=vl(r);return!!(e&&e.type==="distribution")}function wN(r){let{formula:e}=r;return e?!!e.is_discrete_distribution:!1}function vl(r){if(r.controller.areDistributionsEnabled()&&r.latex)return(!r.cachedParseToplevelFunction||r.cachedParseToplevelFunction.latex!==r.latex)&&(r.cachedParseToplevelFunction={latex:r.latex,spec:__dcg_shared_module_exports__['oc'](r.latex)}),r.cachedParseToplevelFunction.spec}function q1(r){return Px(r)&&ju(r)}function Px(r){return!!r.formula.expression_type}function K1(r){return!!r.formula.is_concrete_list}function Pd(r){return!q1(r)||K1(r)?!1:r.cdf.show}function _x(r){return r.cdf.min}function Fx(r){return r.cdf.max}function vN(r){var e=w1(r.formula.cdf_min_default);return e===-1/0?"-\\infty":isFinite(e)?e+"":"-\\infty"}function CN(r){var e=w1(r.formula.cdf_max_default);return e===1/0?"\\infty":isFinite(e)?e+"":"\\infty"}function DN(r,e){r.cdf=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.cdf),{show:e})}function PS(r,e){r.cdf=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.cdf),{min:e})}function _S(r,e){r.cdf=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.cdf),{max:e})}function Rx(r){return!!r.formula&&r.formula.cdf_min_valid!==!1}function Nx(r){return!!r.formula&&r.formula.cdf_max_valid!==!1}function z1(r){return!!r.formula&&r.formula.fill_opacity_valid!==!1}function SN(r){return!!r.formula&&r.formula.line_opacity_valid!==!1}function kN(r){return!!r.formula&&r.formula.point_opacity_valid!==!1}function U1(r){return!!r.formula&&r.formula.label_size_valid!==!1}function H1(r){return!!r.formula&&r.formula.label_angle_valid!==!1}function FS(r){return!!r.formula&&r.formula.point_size_valid!==!1}function RS(r){return!!r.formula&&r.formula.line_width_valid!==!1}function EN(r){return!!r.formula&&r.formula.checkers_valid!==!1}function NS(r){return!!r.formula&&r.formula.resolution_valid!==!1}function GN(r){return!!r.formula&&r.formula.color_latex_valid!==!1}function TN(r){return r.formula&&r.formula.color_latex_value}function IN(r){return r.formula&&r.formula.label_angle_value}function BS(r){var e=r.formula&&r.formula.cdf_evaluation;return isFinite(e)?e:0}function W1(r){if(!r||!__dcg_shared_module_exports__['qc'](r.formula.expression_type))return!1;let e=Gi(r);return!(e&&e!=="NONE")}function VN(r){r.showLabel=__dcg_shared_module_exports__['dd'].showLabel,r.showAngleLabel=__dcg_shared_module_exports__['dd'].showAngleLabel,r.label=__dcg_shared_module_exports__['dd'].label,r.hidden=__dcg_shared_module_exports__['dd'].hidden,r.dragMode=__dcg_shared_module_exports__['dd'].dragMode,r.fill=__dcg_shared_module_exports__['dd'].fill,r.points=__dcg_shared_module_exports__['dd'].points,r.pointStyle=__dcg_shared_module_exports__['dd'].pointStyle,r.lines=__dcg_shared_module_exports__['dd'].lines,r.lineStyle=__dcg_shared_module_exports__['dd'].lineStyle,r.slider=r.controller.is3dProduct()?__dcg_shared_module_exports__['fd']:__dcg_shared_module_exports__['ed'],r.latex="",r.labelSize="",r.labelOrientation="default",r.displayEvaluationAsFraction=__dcg_shared_module_exports__['dd'].displayEvaluationAsFraction,r.strictIntersection=__dcg_shared_module_exports__['dd'].strictIntersection,r.suppressTextOutline=!1,r.interactiveLabel=!1,r.editableLabelMode=__dcg_shared_module_exports__['dd'].editableLabelMode,__dcg_shared_module_exports__['Wc'](__dcg_shared_module_exports__['cd'],r)}function qS(r){return!!r.formula.move_strategy}function KS(r,e){var t=r.cachedViewState;return e.stripDefaults?__dcg_shared_module_exports__['$c'](t):t}function MW(r){r.cachedViewState={type:r.type,id:r.id,title:r.title,hidden:r.hidden,readonly:r.readonly,collapsed:r.collapsed,secret:r.secret}}function AW(r){r.cachedUndoRedoDiffState=r.cachedViewState,r.cachedUndoRedoFullState=r.cachedViewState}function MN(r,e){let t=__dcg_shared_module_exports__['j'](__dcg_shared_module_exports__['_c'](r));return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},t),_d(e)),{cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{},cachedViewState:{}})}function AN(r){LW(r),Fd(r),MW(r),AW(r)}function LW(r){var e=r.controller,t=e.getAllSelectedItems();r.collapsedChildIsSelected=r.collapsed&&__dcg_shared_module_exports__['v'](t,i=>i.type!=="folder"&&i.folderId===r.id)}var OW={id:!1,type:!1,hidden:!0,secret:!0,collapsed:!0,title:!0,readonly:!0};function LN(r,e){__dcg_shared_module_exports__['Vc']({from:e,to:r,props:OW})}function Cf(r,e){r.collapsed=e}function ON(r,e){r.title=e}function PN(r,e){r.hidden=e}var FN={folderId:"",text:"",secret:!1,readonly:!1};function RN(r){return __dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},FN),r)}function NN(r){return __dcg_shared_module_exports__['Sc'](FN,r)}function BN(r,e){r.text=e}function qN(r,e){let t=__dcg_shared_module_exports__['j'](RN(r));return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},t),_d(e)),{cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{},cachedViewState:{}})}function KN(r){Fd(r),_W(r),FW(r)}var PW={id:!1,type:!1,folderId:!0,text:!0,secret:!0,readonly:!0};function zN(r,e){__dcg_shared_module_exports__['Vc']({from:e,to:r,props:PW})}function zS(r,e){var t=r.cachedViewState;return e.stripDefaults?NN(t):t}function _W(r){r.cachedViewState={type:r.type,id:r.id,folderId:r.folderId,text:r.text,secret:r.secret,readonly:r.readonly}}function FW(r){r.cachedUndoRedoDiffState=r.cachedViewState,r.cachedUndoRedoFullState=r.cachedViewState}var RW=0;function NW(){return"helper_item_"+RW++}function HN(r){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{formula:__dcg_shared_module_exports__['md'](),guid:NW(),cachedParsableState:{type:"statement",id:r.id,latex:r.latex,shouldGraph:!1}})}function WN(r,e,t){var l;e.formula=t;let i=e.proxy,o={numericValue:i.numericValue,listValue:i.listValue},{constant_value:n,zero_values:a}=t,s=n!=null?n:(l=(a||[])[0])==null?void 0:l.val;i.numericValue=__dcg_shared_module_exports__['T'](s)?s:NaN,i.listValue=__dcg_shared_module_exports__['R'](s)&&__dcg_shared_module_exports__['u'](s,__dcg_shared_module_exports__['T'])?s.slice(0):void 0,__dcg_shared_module_exports__['P'](i.numericValue,o.numericValue)||r.runAfterDispatch(()=>{i.notifyPropertyChange("numericValue")}),__dcg_shared_module_exports__['P'](i.listValue,o.listValue)||r.runAfterDispatch(()=>{i.notifyPropertyChange("listValue")})}xt();var $1={enabled:!1,latex:"",hoveredImage:"",depressedImage:""},US={center:"\\left(0,0\\right)",angle:"0",width:"10",height:"10",opacity:"1",clickableInfo:$1,description:"",draggable:!1},$N=__dcg_shared_module_exports__['a']({folderId:"",hidden:!1,secret:!1,readonly:!1,foreground:!1,name:""},US);function jN(r){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},$N),r),{clickableInfo:__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},$1),r.clickableInfo)})}function YN(r){var e=__dcg_shared_module_exports__['Sc']($N,r),t=__dcg_shared_module_exports__['Tc']($1,r.clickableInfo);return t===void 0?delete e.clickableInfo:e.clickableInfo=t,e}function j1(r){return __dcg_shared_module_exports__['Xc'](r,US)}function JN(r){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({type:"image",id:r.id},j1(r)),{guid:"",index:0,color:"",shouldGraph:r.hidden,showPoints:!1})}function XN(r,e){r.hidden=e}function $s(r,e,t){r[e]=t}function QN(r,e){return r[e]}function ZN(r,e){r.description=e}function e3(r,e){r.name=e}function Y1(r,e){r.draggable=e}function Df(r){if(r.formula){var e=r.formula.center_reference_id,t=r.formula.center_reference_symbol;if(!(!e||!t)){var i=r.controller.getItemModel(e);if(!(!i||i.type!=="expression")&&i.formula.assignment===t&&es(i))return i}}}function qW(r){var e=Df(r);if(!e)return!1;var t=Gi(e);return!(!t||t==="NONE")}function Nd(r){return r.draggable?qW(r):!1}function t3(r){if(!r.formula||!r.formula.center_is_point_literal)return!1;var e=r.formula.move_strategy;if(!e)return!1;var t=e[2],i=e[3],o=t&&t.type!=="none",n=i&&i.type!=="none";return!!(o||n)}function r3(r,e){r.opacity=e}function J1(r,e){r.foreground=e}function i3(r,e){r.image_url=e}function WS(r,e){e(r.opacity,"imageOpacity"),e(r.center,"imageCenter"),e(r.height,"imageHeight"),e(r.width,"imageWidth"),e(r.angle,"imageAngle")}function KW(r){let e=JN(r);e.color=r.color,e.index=r.index,e.guid=r.guid,e.shouldGraph=r.shouldGraph,e.showPoints=r.showPoints,r.cachedParsableState=e}function o3(r){r.draggingOnGraphpaper?r.preTransientState||(r.preTransientState={center:r.center,width:r.width,height:r.height}):delete r.preTransientState,Fd(r);let e=Ws(r);r.shouldGraph=e&&e.hidden?!1:!r.hidden,r.showPoints=r.shouldGraph&&aa(r)&&r.loadStatus==="loaded"&&!Nd(r)&&r.controller.isTraceEnabled(),UW(r),HW(r),KW(r)}function n3(r,e){r.formula=e,r.error=zW(r)}function $S(r){return r.formula?r.formula.variables||[]:[]}function zW(r){var e={scale:r.controller.s("graphing-calculator-error-log-axes-image"),center:r.controller.s("graphing-calculator-error-image-invalid-center"),angle:r.controller.s("graphing-calculator-error-image-invalid-angle"),width:r.controller.s("graphing-calculator-error-image-invalid-width"),height:r.controller.s("graphing-calculator-error-image-invalid-height"),opacity:r.controller.s("graphing-calculator-error-image-invalid-opacity")};for(var t in r.formula.errorMap){var i=r.formula.errorMap[t];if(i)return e[t]}}function a3(r,e){return!r.formula||!r.formula.errorMap?!1:!!r.formula.errorMap[e]}function jS(r,e){var t=r.cachedViewState;return e.stripDefaults?YN(t):t}function UW(r){var e=r.cachedViewState.clickableInfo,t=!0,i=!0;if(e&&(e.depressedImage===r.clickableInfo.depressedImage&&(i=!1),e.hoveredImage===r.clickableInfo.hoveredImage&&(t=!1)),t&&(r.hoveredImageObj&&(H(r.hoveredImageObj).off("load"),delete r.hoveredImageObj),r.clickableInfo.hoveredImage)){r.hoveredImageObj=new Image;var o=function(){r.controller.requestRedrawGraph()},n=function(){};HS(r.hoveredImageObj,r.clickableInfo.hoveredImage,o,n)}if(i&&(r.depressedImageObj&&(H(r.depressedImageObj).off("load"),delete r.depressedImageObj),r.clickableInfo.depressedImage)){r.depressedImageObj=new Image;var o=function(){r.controller.requestRedrawGraph()},n=function(){};HS(r.depressedImageObj,r.clickableInfo.depressedImage,o,n)}if(r.cachedViewState.image_url!==r.image_url){H(r.imageObj).off("load"),r.imageObj=new Image;let a=function(){r.controller.dispatch({type:"image-load-success",id:r.id})},s=function(){r.controller.dispatch({type:"image-load-error",id:r.id})},c=r.controller.getGraphSettings().config.cacheRenderedSvgs?{fetchMimeType:{imageModel:r}}:void 0;HS(r.imageObj,r.image_url,a,s,c)}r.cachedViewState=__dcg_shared_module_exports__['a']({type:r.type,id:r.id,folderId:r.folderId,image_url:r.image_url,name:r.name,hidden:r.hidden,foreground:r.foreground,secret:r.secret,readonly:r.readonly},j1(r))}function X1(r,e){r.draggingOnGraphpaper=e}function HW(r){var e=r.cachedViewState;r.cachedUndoRedoFullState=r.cachedViewState,r.preTransientState&&(e=__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},e),r.preTransientState)),r.cachedUndoRedoDiffState=e}function WW(r){var e=document.createElement("canvas");e.width=2,e.height=2;var t=e.getContext("2d");return t.drawImage(r,0,0,2,2),e.toDataURL()}function HS(r,e,t,i,o={}){H(r).on("load.initial-image-load",function(){var s=r.width,l=r.height;s===1&&l===1?(H(r).off(".initial-image-load"),H(r).on("load",t),r.src=WW(r)):t()}).on("error",i);let n=/^data:/.test(e);n||(r.crossOrigin="anonymous");let{fetchMimeType:a}=o;a?n?(r.src=e,a.imageModel.mimeType=e.substring(5,e.indexOf(";"))):fetch(e).then(s=>{let l=s.headers.get("Content-type");return l&&(a.imageModel.mimeType=l),s.blob()}).then(s=>{let l=URL.createObjectURL(s);r.src=l}):r.src=e}function s3(r,e){let t=__dcg_shared_module_exports__['j'](jN(r));return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},t),_d(e)),{color:__dcg_shared_module_exports__['o'].BLUE,loadStatus:"loading",failures:0,imageObj:new Image,hoveredImageObj:void 0,depressedImageObj:void 0,mimeType:void 0,shouldGraph:void 0,showPoints:void 0,error:void 0,formula:void 0,draggingOnGraphpaper:!1,cachedViewState:{},cachedParsableState:{},cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{}})}var $W=__dcg_shared_module_exports__['a']({id:!1,type:!1,image_url:!0,name:!0,folderId:!0,hidden:!0,secret:!0,readonly:!0,foreground:!0},__dcg_shared_module_exports__['Yc'](US));function l3(r,e){__dcg_shared_module_exports__['Vc']({from:e,to:r,props:$W})}function c3(r){let{controller:e,files:t,id:i}=r,o={errors:[],tokens:[]};for(let n=0;n<t.length;n++){let a=t[n];if(!a.type.match("image/*")){o.errors.push(e.s("graphing-calculator-error-image-invalid-file",{file:a.name}));continue}o.tokens.push(YW({controller:e,file:a,id:i}))}return o}var jW=0;function YW(r){let{controller:e,file:t,id:i}=r,o=""+jW++;return e.getGraphSettings().config.imageUploadCallback(t,(n,a)=>{setTimeout(()=>{if(n)e.dispatch({type:"image-upload-error",token:o,error:n});else{let s=new Image;HS(s,a,function(){var p=s.width,u=s.height,m=Math.max(p,u)/Math.min(p,u);p<u?(u=10,p=Math.round(10*u/m)/10):(p=10,u=Math.round(10*p/m)/10),e.dispatch({type:"image-upload-success",token:o,url:a,width:p+"",height:u+"",name:t.name,id:i})},function(){e.dispatch({type:"image-upload-error",token:o,error:!0})})}})}),o}function YS(r,e){r.loadStatus=e,e==="loaded"&&(r.failures=0),e==="failed"&&(r.failures+=1)}function Q1(r){r.imageObj.src=r.imageObj.src,YS(r,"loading")}function JS(r,e,t){r.clickableInfo=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.clickableInfo),{[e]:t})}function d3(r,e){r.clickableInfo=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.clickableInfo),{latex:e})}function cg(r){var e;return!!(r.clickableInfo.enabled&&r.formula&&((e=r.formula.click_handler)==null?void 0:e.status)==="maybe-valid")}var p3="dcg_ticker_guid_internal",JW=p3;function u3(){return Z1(Jm)}function XW(r){r.cachedParsableState={type:"ticker",id:r.id,handlerLatex:r.handlerLatex,minStepLatex:r.minStepLatex,shouldGraph:!1}}function h3(r,e){return e.stripDefaults?F_(r.cachedViewState):r.cachedViewState}function g3(r){return r.cachedUndoRedoDiffState}function m3(r){return r.cachedUndoRedoFullState}function QW(r){r.cachedViewState={handlerLatex:r.handlerLatex,minStepLatex:r.minStepLatex,playing:r.playing,open:r.open}}function ZW(r){var e=r.cachedViewState;r.cachedUndoRedoDiffState=e,r.cachedUndoRedoFullState=e}function Z1(r){let e=R_(r);return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},e),{type:"ticker",guid:p3,id:JW,avgDelta:0,lastTickTime:void 0,cachedViewState:{},cachedParsableState:{},cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{},filteredBySearch:!1})}function f3(r,e){__dcg_shared_module_exports__['Wc'](e,r)}function b3(r,e){r.formula=e}function y3(r){QW(r),ZW(r),XW(r)}function x3(r,{currentFrameTime:e,previousFrameTime:t}){var a,s;if(!r.playing||((a=r.formula)==null?void 0:a.handler.status)!=="maybe-valid")return!1;if(r.lastTickTime==null||t==null)return!0;if(((s=r.formula)==null?void 0:s.minStep.status)!=="valid")return!1;let i=r.formula.minStep.value,o=r.lastTickTime+i;if(e>=o)return!0;let n=e-t;return o-e<n/2}function w3(r,e){r.lastTickTime=e}function v3(r){if(r.formula)return r.formula.handler.status==="error"?r.formula.handler.error:void 0}function C3(r){if(r.formula)return r.formula.minStep.status==="error"?r.formula.minStep.error:void 0}function Bx(r){var e;return((e=r.formula)==null?void 0:e.variables)||[]}function XS(r,e){e(r.handlerLatex,"tickerHandler"),e(r.minStepLatex,"tickerMinStep")}var kf="dcg_geometry_toolbar_",D3={selection:{visible:!0},"box-selection":{visible:!0},"expression-edit":{visible:!0},point:{visible:!1},line:{visible:!1},segment:{visible:!1},ray:{visible:!1},vector:{visible:!1},circle:{visible:!1},arc:{visible:!1},parallel:{visible:!1},perpendicular:{visible:!1},midpoint:{visible:!1},polygon:{visible:!1},compass:{visible:!1},angle:{visible:!1},directedangle:{visible:!1},reflect:{visible:!1},translate:{visible:!1},rotate:{visible:!1},dilate:{visible:!1}};function S3(r){if(r.toolbar!=="all"){if(r.toolbar==="custom"){let e=__dcg_shared_module_exports__['Tc'](D3,r.toolbarState),t={toolbar:"custom"};return e!==void 0&&(t.toolbarState=e),t}return r}}function k3(r){return r===void 0?{toolbar:"all"}:r.toolbar==="custom"?{toolbar:"custom",toolbarState:__dcg_shared_module_exports__['Uc'](D3,r.toolbarState)}:r}function E3(r,e){return e.stripDefaults?S3(r.cachedViewState):r.cachedViewState}function eM(r){return r.cachedUndoRedoDiffState}function e$(r){r.toolbar==="custom"?r.cachedViewState={toolbar:"custom",toolbarState:__dcg_shared_module_exports__['j'](r.toolbarState)}:r.cachedViewState={toolbar:r.toolbar}}function G3(r){e$(r),t$(r),r.__cachedToolbarState=void 0}function T3(r){let e=[];for(let t in r.toolbarState){let i=t,o=r.toolbarState[i];o.visible&&o.disabledLatex&&e.push({type:"geometry-toolbar-predicate",id:`${kf}${i}`,latex:o.disabledLatex})}return e}function I3(r,e){if(!r.toolbarState[e].disabledLatex)return;let t=r.formulas[e];if(t!=null&&t.error)return{key:"shared-calculator-error-custom-toolbar-not-condition",vars:{}}}function V3(r,e,t){let i=e.replace(kf,"");i in r.toolbarState&&(r.formulas[i]=t)}function t$(r){var e=r.cachedViewState;r.cachedUndoRedoDiffState=e,r.cachedUndoRedoFullState=e}function ZS(r){let e=k3(r);return{toolbar:e.toolbar,toolbarState:e.toolbar==="custom"?e.toolbarState:r$(),formulas:{},selectedToolForGroup:{},__cachedToolbarState:void 0,cachedViewState:e,cachedUndoRedoDiffState:e,cachedUndoRedoFullState:e}}function M3(){return ZS(void 0)}function r$(){return{selection:{visible:!0},"box-selection":{visible:!0},"expression-edit":{visible:!0},point:{visible:!0},line:{visible:!0},segment:{visible:!0},ray:{visible:!0},vector:{visible:!1},circle:{visible:!0},arc:{visible:!1},parallel:{visible:!1},perpendicular:{visible:!1},midpoint:{visible:!1},polygon:{visible:!1},compass:{visible:!1},angle:{visible:!1},directedangle:{visible:!1},reflect:{visible:!1},translate:{visible:!1},rotate:{visible:!1},dilate:{visible:!1}}}function A3(r,e){r.toolbar=e,r.__cachedToolbarState=void 0}function L3(r,e,t){let{groups:i,items:o}=tk(r,t);for(let n of i){let a=o[n];a!=null&&a.dropdown&&a.dropdown.indexOf(e)!==-1?r.selectedToolForGroup[a.group]=e:a!=null&&a.dropdown&&i$(a.current)&&(r.selectedToolForGroup[a.group]=a.dropdown[0])}r.__cachedToolbarState=void 0}function ek(r,e,t){r.toolbarState[e]={visible:t.visible,disabledLatex:t.disabledLatex},r.__cachedToolbarState=void 0}function dg(r,e){return r.toolbar==="all"?!0:r.toolbar==="none"?!1:r.toolbarState[e].visible}function Ef(r,e){if(r.toolbar==="all")return!0;let t=dg(r,e);if(t&&r.formulas[e]){let i=r.formulas[e],o=i==null?void 0:i.constant_value;return typeof o=="number"?!o:!0}return t||e==="selection"}function tk(r,e){var o;if(((o=r.__cachedToolbarState)==null?void 0:o.authorMode)===e)return r.__cachedToolbarState.state;let t={};for(let n of tM())if(n.dropdown){let a=n.dropdown.filter(s=>e||dg(r,s));if(a.sort((s,l)=>{let c=Ef(r,s),p=Ef(r,l),u=dg(r,s),m=dg(r,l);return(c?0:u?1:2)-(p?0:m?1:2)}),a.length>0){let s=r.selectedToolForGroup[n.group];(!s||a.indexOf(s)===-1)&&(s=a[0]),!e&&!Ef(r,s)&&(s=a.find(l=>Ef(r,l))||a[0]),t[n.group]={group:n.group,current:s,dropdown:a.length>1?a:void 0}}}else(e||dg(r,n.current))&&(t[n.group]=n);let i=Object.keys(t);r.__cachedToolbarState={authorMode:e,state:{groups:i,items:t}};for(let n of i){let a=t[n];r.selectedToolForGroup[n]=a==null?void 0:a.current}return{groups:i,items:t}}function tM(){return[{group:"selection",current:"selection",dropdown:["selection","box-selection"]},{group:"point",current:"point",dropdown:["point","midpoint"]},{group:"line",current:"segment",dropdown:["segment","line","ray","vector","parallel","perpendicular"]},{group:"circle",current:"circle",dropdown:["circle","compass","arc"]},{group:"angle",current:"angle",dropdown:["angle","directedangle"]},{group:"polygon",current:"polygon"}]}function i$(r){switch(r){case"box-selection":case"midpoint":case"parallel":case"perpendicular":case"compass":case"arc":return!0;default:return!1}}var Vf="**dcg_geo_expression_edit_tool_preview**";function O3(r){return{controller:r,__itemModelArray:[],__itemIdToModel:{},__helperIdToModel:{},__toolPreviewIdToModel:{},__anyDependsOnRandomSeed:!1,__anyIsAction:!1,selectedItemMap:{},drawOrder:[],colorIdx:0,expressionAnalysis:{},nextDisplayIndex:1,ticker:u3()}}function P3(r){for(var e=0;e<r.__itemModelArray.length;e++){var t=r.__itemModelArray[e];if(t.type==="image"&&t.loadStatus==="loading")return!0}return!1}function _3(r){var e=__dcg_shared_module_exports__['t'](__dcg_shared_module_exports__['N'](r.controller.getColors()),i=>i!=__dcg_shared_module_exports__['o'].ORANGE),t=e[r.colorIdx];return r.colorIdx=(r.colorIdx+1)%e.length,t}function Mf(r,e){return r.__itemModelArray[e]}function Af(r){for(let e=0;e<r.__itemModelArray.length;e++){let t=r.__itemModelArray[e];if(Lf(t))return t}}function ik(r){for(let e=r.__itemModelArray.length-1;e>=0;e--){let t=r.__itemModelArray[e];if(Lf(t))return t}}function pg(r,e){var t;do{if(e--,e===-1)return;t=Mf(r,e)}while(t&&!Lf(t));return t}function ug(r,e){var t,i=Kx(r);do{if(e++,e===i)return;t=Mf(r,e)}while(t&&!Lf(t));return t}function Ws(r){if(r.type!=="folder"&&r.folderId){let e=r.controller.getListModel(),t=Fc(e,r.folderId);if(t&&t.type==="folder")return t}}function F3(r,e){let t=Fc(r,e);if(!t||t.type!=="folder")return 0;let i=0,o=r.__itemModelArray.length;for(var n=t.index+1;n<o;n++){let a=r.__itemModelArray[n];if(a.type==="folder"||a.folderId!==e)break;i+=1}return i}function R3(r,e){let t=Fc(r,e);if(!t||t.type!=="folder")return[];let i=[],o=r.__itemModelArray.length;for(var n=t.index+1;n<o;n++){let a=r.__itemModelArray[n];if(a.type==="folder"||a.folderId!==e)break;i.push(a.id)}return i}function N3(r,e){let t=[],i=Fc(r,e);if(!i||i.type!=="folder")return t;let o=r.__itemModelArray.length;for(let n=i.index+1;n<o;n++){let a=r.__itemModelArray[n];if(a.type==="folder"||a.folderId!==e)break;t.push(a)}return t}function iM(r){return!!(r&&r.readonly)}function qx(r){if(!r)return!1;if(r.secret)return!0;let e=Ws(r);return!!(e&&e.secret&&e.id!==__dcg_shared_module_exports__['ad'])}function Lf(r){return!oM(r)}function B3(r){return r.id===__dcg_shared_module_exports__['ad']||r.type!=="folder"&&r.folderId===__dcg_shared_module_exports__['ad']}function oM(r){if(!r||r.filteredBySearch||B3(r))return!0;if(r.controller.isItemBeingDragged(r.id))return!!r.controller.shouldRenderDraggedItemAsToken();if(!r.controller.shouldShowAuthorFeatures()&&qx(r))return!0;let t=Ws(r);return!!(t&&t.collapsed&&!r.controller.getExpressionSearchStr())}function nM(r){return r.__itemModelArray}function q3(r){return __dcg_shared_module_exports__['N'](r.__helperIdToModel)}function Of(r){return __dcg_shared_module_exports__['N'](r.__toolPreviewIdToModel)}function Pf(r,e){for(var t=0;t<r.__itemModelArray.length;t++){var i=r.__itemModelArray[t];Tf(i,e)}for(var o in r.__toolPreviewIdToModel)Tf(r.__toolPreviewIdToModel[o],e);if(r.ticker.open&&(e(r.ticker.handlerLatex,{type:"item",location:"tickerHandler",item:r.ticker}),e(r.ticker.minStepLatex,{type:"item",location:"tickerMinStep",item:r.ticker})),r.controller.isGeometry()){let a=r.controller.getGeometryToolbarModel().toolbarState;for(let s in a){let l=s,c=a[l];c.visible&&c.disabledLatex&&e(c.disabledLatex,{type:"geometry-toolbar",tool:l})}}}function Tf(r,e){switch(r.type){case"expression":xS(r,(i,o)=>e(i,{type:"item",location:o,item:r}));break;case"table":ck(r,(i,o,n)=>e(i,__dcg_shared_module_exports__['a']({type:"item",location:o,item:r},n)));break;case"image":WS(r,(i,o)=>e(i,{type:"item",location:o,item:r}));break;case"ticker":XS(r,(i,o)=>e(i,{type:"item",location:o,item:r}));break;case"folder":case"text":break;default:return r}}function Gf(r,e){return!!r.replace(/([_^])([a-z0-9])/gi,"$1{$2}").match(e)}function K3(r,e){if(!ys(e))return!1;let i=!1;return Pf(r,o=>{Ic(o,e)&&(i=!0)}),i}function z3(r,e){let t=0,i=ys(e);r.ticker.filteredBySearch=r.ticker.open&&!Ic(r.ticker.handlerLatex,e)&&!Ic(r.ticker.minStepLatex,e);for(let o of r.__itemModelArray){if(!i){o.filteredBySearch=!1,t++;continue}switch(o.filteredBySearch=!0,o.type){case"expression":xS(o,s=>{Ic(s,e)&&(o.filteredBySearch=!1,t++)});let n=_c(o);o.label&&n&&o.label.match(rk(e))&&(o.filteredBySearch=!1,t++);break;case"table":ck(o,s=>{Ic(s,e)&&(o.filteredBySearch=!1,t++)});break;case"image":WS(o,s=>{Ic(s,e)&&(o.filteredBySearch=!1,t++)});break;case"folder":case"text":break;default:return o}!o.filteredBySearch&&o.type!=="folder"&&o.folderId&&(r.__itemIdToModel[o.folderId].filteredBySearch=!1,t++)}return t}function U3(r,e){let t=0,i=z_(e);r.ticker.filteredBySearch=r.ticker.open&&!Gf(r.ticker.handlerLatex,i)&&!Gf(r.ticker.minStepLatex,i);for(var o=0;o<r.__itemModelArray.length;o++){if(!e){r.__itemModelArray[o].filteredBySearch=!1;continue}var n=r.__itemModelArray[o];switch(n.filteredBySearch=!0,n.type){case"expression":xS(n,l=>{Gf(l,i)&&(n.filteredBySearch=!1,t++)});let a=_c(n);n.label&&a&&(e==="\\operatorname{label}"||e.length>1&&"label".indexOf(e)===0||Gf(n.label,i))&&(n.filteredBySearch=!1,t++);break;case"table":ck(n,l=>{Gf(l,i)&&(n.filteredBySearch=!1,t++)});break;case"image":e==="\\operatorname{image}"||e.length>1&&"image".indexOf(e)===0?(n.filteredBySearch=!1,t++):WS(n,l=>{Gf(l,i)&&(n.filteredBySearch=!1,t++)});break;case"folder":n.title&&n.title.indexOf(e)>=0&&(n.filteredBySearch=!1,t++);break;case"text":n.text.indexOf(e)>=0&&(n.filteredBySearch=!1,t++);break;default:return n}!n.filteredBySearch&&n.type!=="folder"&&n.folderId&&(r.__itemIdToModel[n.folderId].filteredBySearch=!1,t++)}return t}function rk(r,e){return new RegExp("\\$\\{"+r.replace("{","\\{?").replace("}","\\}?").replace("_","\\_?")+"\\}",e)}function H3(r,e){let t=0;for(var i=0;i<r.__itemModelArray.length;i++){var o=r.__itemModelArray[i];if(o.type!=="expression")continue;if(_c(o)&&o.label){let a=o.label.match(rk(e,"g"));a&&(t+=a.length)}}return Pf(r,n=>{t+=Xm(n,e).length}),t}function Ju(r,e,t,i){t=t.trim().replace(/_\{([a-zA-Z0-9])\}/g,"_$1");for(var o=0;o<r.__itemModelArray.length;o++){let n=r.__itemModelArray[o];if(n.type==="expression"){let a=_c(n);n.label&&a&&n.label.match(rk(e))&&Rp(n,n.label.replace(rk(e,"g"),"${"+t.trim()+"}"))}}Pf(r,(n,a)=>{if(i&&i.limitToItem!==void 0&&(a.type!=="item"||i.limitToItem!==a.item.id)||i&&i.limitToFolder!==void 0&&(a.type!=="item"||a.item.type==="ticker"||a.item.type==="folder"||i.limitToFolder!==a.item.folderId))return;let s=$D(n,e,t);if(a.type==="geometry-toolbar"){let c=r.controller.getGeometryToolbarModel();ek(c,a.tool,{visible:!0,disabledLatex:s});return}let l=a.item;if(s!==n){let c;switch(a.cellLocation!==void 0&&l.columnModels&&(c=l.columnModels[a.cellLocation.column].id),a.location){case"latex":{Cs(l,s);break}case"cdfMin":{PS(l,s);break}case"cdfMax":{_S(l,s);break}case"colorLatex":{Ix(l,s);break}case"lineWidth":{ff(l,s);break}case"resolution":{vS(l,s);break}case"checkers":{CS(l,s);break}case"clickableInfoLatex":{gS(l,s);break}case"fillOpacity":{Ex(l,s);break}case"lineOpacity":{mf(l,s);break}case"pointOpacity":{Gx(l,s);break}case"pointSize":{Tx(l,s);break}case"labelAngle":{SS(l,s);break}case"labelSize":{Vx(l,s);break}case"polarDomainMin":{yx(l,s);break}case"polarDomainMax":{Cx(l,s);break}case"parametricDomainMin":{xx(l,s);break}case"parametricDomain3DuMin":{wx(l,s);break}case"parametricDomain3DvMin":{vx(l,s);break}case"parametricDomainMax":{Dx(l,s);break}case"parametricDomain3DuMax":{Sx(l,s);break}case"parametricDomain3DvMax":{kx(l,s);break}case"sliderMin":{uf(l,s);break}case"sliderMax":{hf(l,s);break}case"sliderStep":{bx(l,s);break}case"imageOpacity":{$s(l,"opacity",s);break}case"imageCenter":{$s(l,"center",s);break}case"imageHeight":{$s(l,"height",s);break}case"imageWidth":{$s(l,"width",s);break}case"imageAngle":{$s(l,"angle",s);break}case"tickerHandler":{l.handlerLatex=s;break}case"tickerMinStep":{l.minStepLatex=s;break}case"tableHeader":case"tableCellValue":if(!a.cellLocation||l.type!=="table")break;qp(l,a.cellLocation,s);break;case"tableColumnColorLatex":{c&&gk(l,c,s);break}case"tableColumnPointSize":{c&&uk(l,c,s);break}case"tableColumnPointOpacity":{c&&hk(l,c,s);break}case"tableColumnLineWidth":{c&&dk(l,c,s);break}case"tableColumnLineOpacity":{c&&pk(l,c,s);break}case"residualVariable":break;default:{let p=a.location;throw new Error(`Unexpected latex location ${p}`)}}}})}function ok(r){var e=[];Pf(r,function(o){if(!(o.indexOf("~")!==-1||o.indexOf("\\sim")!==-1))for(var n=/_(\d)|_\{(?:\s|\\space)*(\d+)(?:\s|\\space)*\}/g;;){var a=n.exec(o);if(!a)break;e.push(parseInt(a[1]||a[2],10))}}),e.sort(function(o,n){return o-n});for(var t=1,i=0;i<e.length;i++)e[i]===t&&t++;return t}function W3(r){var e=0;return Pf(r,function(t){for(var i=/\\token\{(\d+)\}/g;;){var o=i.exec(t);if(!o)break;var n=parseInt(o[1],10);n>e&&(e=n)}}),e}function $3(r){var e={};return Pf(r,function(t){if(!(t.indexOf("~")!==-1||t.indexOf("\\sim")!==-1))for(var i=/(\\?[a-zA-Z]+)_(\d)|(\\?[a-zA-Z]+)_\{(?:\s|\\space)*(\d+)(?:\s|\\space)*\}/g;;){var o=i.exec(t);if(!o)break;var n=o[1]||o[3],a=o[2]||o[4];n[0]!=="\\"&&(n=n[n.length-1]);var s=parseInt(a,10);e[n]||(e[n]=0),s>e[n]&&(e[n]=s)}}),e}function j3(r,e){var t=[],i={points:[],angles:[],polygons:[],other:[]};function o(n){if(!(a$(r,n.id)&&e!=="actual")&&!(n.id===Vf&&e!=="preview")){if(n.type==="expression"&&n.folderId===__dcg_shared_module_exports__['ad']){Od(n)?i.points.push(n.id):Wu(n)?i.angles.push(n.id):Ad(n)?i.polygons.push(n.id):i.other.push(n.id);return}n.type==="table"?__dcg_shared_module_exports__['r'](n.columnModels,function(a){t.push(a.id)}):t.push(n.id)}}r.__itemModelArray.forEach(o),Of(r).forEach(o),t.push.apply(t,i.polygons),t.push.apply(t,i.other),t.push.apply(t,i.angles),t.push.apply(t,i.points),r.drawOrder=t}function Fc(r,e,t){let i=r.__itemIdToModel[e];if(i)return i;if(t&&t.includePreviewItems)return r.__toolPreviewIdToModel[e]}function Y3(r,e){return!!r.__toolPreviewIdToModel[e]}function _f(r,e){var n;for(var t=[],i=0;i<r.__itemModelArray.length;i++){var o=r.__itemModelArray[i];o.type==="expression"&&((n=Fo(o))==null?void 0:n.identifier)===e&&t.push(o)}return t}function o$(r,e){return r.__helperIdToModel[e]}function J3(r,e){var t=HN(e);r.__helperIdToModel[t.id]=t}function aM(r){r.__anyDependsOnRandomSeed=!1;for(var e=0;e<r.__itemModelArray.length;e++){var t=r.__itemModelArray[e];if(t&&"formula"in t&&t.formula&&t.formula.depends_on_random_seed){r.__anyDependsOnRandomSeed=!0;return}}}function X3(r){r.__anyIsAction=!1}function nk(r){if(!r.__anyIsAction){if(r.ticker.open){r.__anyIsAction=!0;return}for(var e=0;e<r.__itemModelArray.length;e++){var t=r.__itemModelArray[e];if(t&&"formula"in t&&t.formula){if(t.type!=="expression"&&t.type!=="image")continue;let{formula:i}=t;if(i.hasOwnProperty("action_value")||i.hasOwnProperty("click_handler")){r.__anyIsAction=!0;return}}}}}function hg(r){for(var e=!r.controller.shouldShowAuthorFeatures(),t=1,i=1,o=0;o<r.__itemModelArray.length;o++){var n=r.__itemModelArray[o];n.index=o,n.displayIndex=t,qx(n)&&(n.secretIndex=i,i+=1),!B3(n)&&(!e||!qx(n))&&(t+=1)}for(var a in r.selectedItemMap)r.__itemIdToModel[a]||delete r.selectedItemMap[a];r.nextDisplayIndex=t}function n$(r){r.__itemModelArray=[],r.__itemIdToModel={},r.__helperIdToModel={},r.__toolPreviewIdToModel={},r.__anyDependsOnRandomSeed=!1}function sM(r,e){let t={},i=[],o=[];return e.forEach(n=>{let a=r.__itemIdToModel[n];if(a)if(iM(a))o.push(a);else{let s=Nf(r,n);for(let l of s)t[l.id]||(t[l.id]=!0,i.push(l))}}),{deletedItems:i,readonlyItemsNotDeleted:o}}function Kx(r){return r.__itemModelArray.length}function Q3(r){return r.__itemModelArray.filter(e=>e.type==="expression"&&e.folderId===__dcg_shared_module_exports__['ad']&&!!Za(e)).length}function Z3(r){return r.nextDisplayIndex===1}function e5(r){for(var e=[],t=0;t<r.__itemModelArray.length;t++){var i=r.__itemModelArray[t];i.type==="expression"&&i.sliderExists&&e.push(i)}return e}function Ff(r){var e;for(var t in r.selectedItemMap){if(e!==void 0)return;e=t}if(e!==void 0)return r.__itemIdToModel[e]}function a$(r,e){return!!r.selectedItemMap[e]}function t5(r){return __dcg_shared_module_exports__['a']({},r.selectedItemMap)}function ak(r){var e=[];for(var t in r.selectedItemMap)e.push(r.__itemIdToModel[t]);return e}function r5(r){return{list:r.__itemModelArray.map(function(e){return e.cachedUndoRedoDiffState}),ticker:g3(r.ticker)}}function lM(r){return{list:r.__itemModelArray.map(function(e){return e.cachedUndoRedoFullState}),ticker:m3(r.ticker)}}function i5(r,e){let t={list:r.__itemModelArray.map(function(o){switch(o.type){case"expression":return ng(o,e);case"image":return jS(o,e);case"table":return qf(o,e);case"folder":return KS(o,e);case"text":return zS(o,e);default:return o}})},i=h3(r.ticker,e);return i&&(t.ticker=i),t}function o5(r){let e=0,t=/^[0-9]+$/;for(var i=r.list.length-1;i>=0;i--){var o=r.list[i];let n=o.id;if(t.test(n)){let a=parseInt(n,10);a>e&&(e=a)}if(o.type==="table"&&o.columns){for(let a=o.columns.length-1;a>=0;a--)if(n=o.columns[a].id,t.test(n)){let s=parseInt(n,10);s>e&&(e=s)}}}return e}function n5(r,e,t){t||(t={});var i,o;for(r.colorIdx=0,n$(r),r.expressionAnalysis={},i=0;i<e.list.length;i++){if(o=If(r,e.list[i]),t.remapColors&&"color"in o&&o.color){var n=__dcg_shared_module_exports__['N'](r.controller.getColors());__dcg_shared_module_exports__['w'](n,o.color)||(o.color=wR(o.color,n))}r.__itemModelArray.push(o),r.__itemIdToModel[o.id]=o}if(r.ticker=Z1(e.ticker),hg(r),r.nextDisplayIndex===1){var a=If(r,{type:"expression",id:r.controller.generateId(),color:r.controller.getNextColor()});Dl(r,a,r.__itemModelArray.length)}}function If(r,e){switch(e.type){case"expression":return yS(e,r.controller);case"table":return g5(e,r.controller);case"image":return s3(e,r.controller);case"folder":return MN(e,r.controller);case"text":return qN(e,r.controller);default:return e}}function a5(r,e){var t,i;let o=r.__itemIdToModel;for(r.__itemModelArray=[],r.__itemIdToModel={},t=0;t<e.list.length;t++){var n=e.list[t];if(i=o[n.id],i&&i.type===n.type)switch(i.type){case"expression":if(n.type!==i.type)throw new Error("invalid restoration");HR(i,n);break;case"table":if(n.type!==i.type)throw new Error("invalid restoration");h5(i,n);break;case"image":if(n.type!==i.type)throw new Error("invalid restoration");l3(i,n);break;case"folder":{if(n.type!==i.type)throw new Error("invalid restoration");LN(i,n)}break;case"text":if(n.type!==i.type)throw new Error("invalid restoration");zN(i,n);break;default:return i}else i=If(r,n);r.__itemModelArray.push(i),r.__itemIdToModel[i.id]=i}e.ticker&&f3(r.ticker,e.ticker),aM(r),nk(r),hg(r)}function s5(r,e,t){let i=t[0]&&t[0].tableId,o=Fc(r,i||e);if(!o)return;let n;switch(o.type){case"expression":let a=!1;o.__workerNeedsDotplotXMode=!1;for(let c=0;c<t.length;c++){let p=t[c];if(p.graphMode===15){o.error=p.error;continue}"resolved"in p&&!p.resolved&&(a=!0),"boundingBox"in p&&p.boundingBox&&(n||(n=[]),n.push(p.boundingBox)),p.needsDotplotXMode&&(o.__workerNeedsDotplotXMode=!0)}o.unresolved=a,o.boundingBoxes=n;let s=1/0,l=-1/0;for(let c of t){if(c.graphMode!==6)continue;let p=c.sampledDomain;p&&(s=Math.min(s,p.min),l=Math.max(l,p.max))}isFinite(s)&&(o.__workerSampledDomainMin=s),isFinite(l)&&(o.__workerSampledDomainMax=l);return;case"table":for(let c=0;c<t.length;c++){let p=t[c];"boundingBox"in p&&p.boundingBox&&(n||(n=[]),n.push(p.boundingBox))}n&&m5(o,e,n);return;default:return}}function l5(r,e){var t,i,o,n=__dcg_shared_module_exports__['j'](r.expressionAnalysis);for(t in e){if(!e.hasOwnProperty(t))continue;o=e[t],i=Fc(r,t);let a={isGraphable:!!o.is_graphable,isError:!!o.error,errorMessage:o.error?r.controller.unpack(o.error):void 0};if(i)switch(i.type){case"expression":if(S1(i,o),o.zero_values&&o.zero_values.length===1){let c=o.zero_values[0].val;__dcg_shared_module_exports__['T'](c)&&(a.evaluation={type:"Number",value:c},a.evaluationDisplayed=!0),__dcg_shared_module_exports__['R'](c)&&c.every(__dcg_shared_module_exports__['T'])&&(a.evaluation={type:"ListOfNumber",value:c.slice()},a.evaluationDisplayed=!0)}else o.hasOwnProperty("constant_value")&&__dcg_shared_module_exports__['T'](o.constant_value)&&(a.evaluation={type:"Number",value:o.constant_value},a.evaluationDisplayed=!1);break;case"image":n3(i,o);break;case"table":u5(i,o);break;case"folder":case"text":break;default:return i}else t===r.ticker.id&&b3(r.ticker,o);let s=o$(r,t);if(s)WN(r.controller,s,o);else{let l=r.__toolPreviewIdToModel[t];l&&S1(l,o)}t.startsWith(kf)&&V3(r.controller.getGeometryToolbarModel(),t,o),t!==r.ticker.id&&!t.startsWith(kf)&&(n[t]=a)}aM(r),nk(r),r.expressionAnalysis=n}function Zr(r,e){if(r.selectedItemMap={},!!e){if(e.type==="image"&&e.folderId){let t=Fc(r,e.folderId);t&&t.type==="folder"&&t.collapsed&&(e=t)}r.selectedItemMap[e.id]=!0}}function cM(r,e){r.selectedItemMap[e]?delete r.selectedItemMap[e]:r.selectedItemMap[e]=!0}function dM(r,e){r.selectedItemMap=__dcg_shared_module_exports__['a']({},e)}function Xu(r,e,t,i){if(e===t)return;let o=r.__itemModelArray.splice(e,i);e<t&&(t=t-i+1),r.__itemModelArray.splice.apply(r.__itemModelArray,[t,0,...o]),hg(r)}function Dl(r,e,t){var i=String(e.id);if(r.__itemIdToModel.hasOwnProperty(i))throw Error("Item with id '"+i+"' is already in list");r.__itemIdToModel[i]=e,r.__itemModelArray.splice(t,0,e),hg(r)}function Rc(r,e){Dl(r,e,Kx(r))}function Rf(r,e){let t=[];var i=r.__itemModelArray[e];if(i.type==="folder"){let n=0,a=e+1;for(let s=a;s<r.__itemModelArray.length;s++){var o=r.__itemModelArray[s];if(o.type==="folder"||o.folderId!==i.id)break;aa(o)&&Zr(r,void 0),o.readonly?(s>a&&(r.__itemModelArray[s]=r.__itemModelArray[a],r.__itemModelArray[a]=o),sa(o,""),a+=1):(delete r.__itemIdToModel[o.id],delete r.expressionAnalysis[i.id],n+=1)}n>0&&t.push(...r.__itemModelArray.splice(a,n))}return aa(i)&&Zr(r,void 0),t.push(...r.__itemModelArray.splice(e,1)),delete r.__itemIdToModel[i.id],delete r.expressionAnalysis[i.id],aM(r),hg(r),t}function c5(r){return r.__anyDependsOnRandomSeed}function d5(r){return r.__anyIsAction}function Nf(r,e){let t=Fc(r,e);return t?Rf(r,t.index):[]}function sk(r){let e=Ff(r);if(!e)return!1;let t=pg(r,e.index);return t?(Zr(r,t),t.index===Kx(r)-1&&e.type==="expression"&&Us(e)&&Rf(r,t.index),!0):!1}function lk(r){let e=Ff(r);if(!e)return!1;let t=ug(r,e.index);return t?(Zr(r,t),!0):!1}function aa(r){return!!r.controller.getListModel().selectedItemMap[r.id]}function zx(r,e){r.dragState=e}function Ux(r){switch(r.type){case"expression":return uS(r);case"image":return $S(r);case"table":return[];case"text":return[];case"folder":return[];default:return r}}function p5(r,e){for(let t of nM(r))t.type==="folder"&&Cf(t,e)}function Bf(r){return r?r.type==="image"&&cg(r)||r.type==="expression"&&vs(r):!1}var s$=30,l$=10,mk=__dcg_shared_module_exports__['o'].RED,fk=__dcg_shared_module_exports__['o'].BLUE,bk=__dcg_shared_module_exports__['o'].GREEN,yk=__dcg_shared_module_exports__['o'].PURPLE,xk=__dcg_shared_module_exports__['o'].ORANGE,wk=__dcg_shared_module_exports__['o'].BLACK;function gg(r,e){switch(e){case __dcg_shared_module_exports__['o'].RED:return r.s("graphing-calculator-text-color-red");case __dcg_shared_module_exports__['o'].BLUE:return r.s("graphing-calculator-text-color-blue");case __dcg_shared_module_exports__['o'].GREEN:return r.s("graphing-calculator-text-color-green");case __dcg_shared_module_exports__['o'].PURPLE:return r.s("graphing-calculator-text-color-purple");case __dcg_shared_module_exports__['o'].ORANGE:return r.s("graphing-calculator-text-color-orange");case __dcg_shared_module_exports__['o'].BLACK:return r.s("graphing-calculator-text-color-black");case __dcg_shared_module_exports__['o'].GRAY:return r.s("graphing-calculator-text-color-gray");default:return r.s("graphing-calculator-text-color-unknown")}}var pM=r=>{if(!Array.isArray(r))return[r];let e=Array(Math.min(r.length,l$));for(let t=0;t<e.length;t++)e[t]=r[Math.round(t*r.length/e.length)];return e};function f5(r,e){switch(r.type){case"single-color":case"color-array":return pM(r.value).every(i=>y1(i,e));case"gradient_u":case"gradient_v":case"checkers":case"shader":case"image":return!1;default:let t=r;throw new Error("Unexpected ColorSwatchSpec type: "+t.type)}}function vk(r,e,t=b1){switch(r.type){case"single-color":case"color-array":return pM(r.value).some(o=>y1(o,e,t));case"gradient_u":case"gradient_v":case"checkers":case"shader":case"image":return!0;default:let i=r;throw new Error("Unexpected ColorSwatchSpec type: "+i.type)}}var Kf=r=>{switch(r.type){case"single-color":return r.value;case"color-array":let e=pM(r.value);if(e.length===0)return __dcg_shared_module_exports__['o'].BLACK;if(e.length===1)return r.value[0];let t=s$/e.length;return`linear-gradient(to right${e.reduce((o,n,a)=>`${o}, ${n} ${a*t}px, ${n} ${(a+1)*t}px`,"")})`;case"gradient_u":return"linear-gradient(90deg,hsl(0, 100%, 50%),hsl(30, 100%, 50%),hsl(60, 100%, 50%),hsl(90, 100%, 50%),hsl(120, 100%, 50%),hsl(150, 100%, 50%),hsl(180, 100%, 50%),hsl(210, 100%, 50%),hsl(240, 100%, 50%),hsl(270, 100%, 50%),hsl(300, 100%, 50%),hsl(330, 100%, 50%),hsl(360, 100%, 50%)";case"gradient_v":return"linear-gradient(180deg,hsl(0, 100%, 50%),hsl(30, 100%, 50%),hsl(60, 100%, 50%),hsl(90, 100%, 50%),hsl(120, 100%, 50%),hsl(150, 100%, 50%),hsl(180, 100%, 50%),hsl(210, 100%, 50%),hsl(240, 100%, 50%),hsl(270, 100%, 50%),hsl(300, 100%, 50%),hsl(330, 100%, 50%),hsl(360, 100%, 50%)";case"checkers":return"repeating-conic-gradient(#808080 0% 25%, transparent 0% 50%) 50% / 16px 16px";case"shader":return"#808080";case"image":return'url("'+r.value+'")';default:let i=r;throw new Error("Unexpected ColorSwatchSpec type: "+i.type)}};var c$=0;function d$(){return"abstract_item_"+c$++}function _d(r){return{guid:d$(),controller:r,index:-1,displayIndex:-1,secretIndex:-1,isHiddenFromUI:!0,renderShell:!0}}function uM(r,e){r.secret=e}function Ck(r,e){r.readonly=e}function sa(r,e){r.type!=="folder"&&(r.folderId=e)}function Fd(r){r.isHiddenFromUI=oM(r)}function Dk(r){return r.isHiddenFromUI||r.filteredBySearch?"none":r.renderShell?"shell":"render"}function Nc(r){let e=Hx(r),t=e.type==="color-array"?{type:"single-color",value:e.value[0]}:e;return Kf(t)}function Hx(r){if(!r.colorLatex)return{type:"single-color",value:r.color};switch(r.colorLatex){case"gradient_u":case"gradient_v":case"checkers":return{type:r.colorLatex};default:if(/^data:image/.test(r.colorLatex))return{type:"image",value:r.colorLatex};let e,t;return r.type==="expression"?(e=TN(r),t=GN(r)):r.type==="table-column"&&(e=x5(r),t=y5(r)),t&&e?Array.isArray(e)?{type:"color-array",value:e}:{type:"single-color",value:e}:{type:"single-color",value:r.color}}}var w5={folderId:"",secret:!1,readonly:!1},Sk={latex:"",color:"",hidden:!1,values:[],points:!0,lines:!1,dragMode:"NONE",pointStyle:"POINT",lineStyle:"SOLID",colorLatex:"",lineOpacity:"",lineWidth:"",pointOpacity:"",pointSize:""};function kk(r){let e=(r.columns||[]).map(function(t){return __dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},Sk),t)});return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},w5),r),{columns:e})}function v5(r){return r=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{columns:r.columns.map(function(e){return __dcg_shared_module_exports__['Sc'](Sk,e)})}),__dcg_shared_module_exports__['Sc'](w5,r)}function Ek(r){return{type:"table",id:r.id,columns:r.columns.map(function(e){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},e),{tableId:r.id})})}}function u$(r){return isFinite(r)?__dcg_shared_module_exports__['gb'](r,{digits:8,bigCutoff:1e6,smallCutoff:.001}):"\\mathrm{undefined}"}function h$(r,e,t){let i=r.columnModels[e];i.error=t.error,i.discrete=t.discrete,i.disabled=t.dependent,i.draggable=!t.error&&!t.dependent,i.packedErrors=[],i.computedValues=[];let o=t.values;for(let n=o.length-1;n>=0;n--){let a=o[n];typeof a=="number"?i.computedValues[n]=u$(a):(i.computedValues[n]="",i.packedErrors[n]=a)}}function D5(r){let e=Sa(r);if(!e)return;let t=fg(r);if(!t){r.isExpanded||zf(r,!0);return}e.row>=t.min&&e.row<t.max&&zf(r,!0)}function fg(r){if(r.isExpanded)return;let e=Sl(r);if(!(e<30))return{min:8,max:e-4}}function S5(r,e){let t=r.columnModels[e];return{values:t.values.slice(),dragMode:t.dragMode,hidden:t.hidden,id:t.id,color:t.color,points:t.points,lines:t.lines,pointStyle:t.pointStyle,lineStyle:t.lineStyle,latex:t.latex,colorLatex:t.colorLatex,lineOpacity:t.lineOpacity,lineWidth:t.lineWidth,pointSize:t.pointSize,pointOpacity:t.pointOpacity}}var g$=0;function m$(){return"table_guid_"+g$++}function f$(r,e,t){r.columnModels[e].values.splice(t,0,"")}function b$(r,e,t){r.columnModels[e].values.splice(t,1)}function k5(r,e,t){let{color:i}=t;(!i||!cf(i))&&(i=r.controller.getNextColor());let o=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{type:"table-column",guid:m$(),index:e,error:void 0,table:r,color:i,packedErrors:[],computedValues:[],discrete:void 0,shouldGraph:void 0,disabled:void 0,draggable:void 0});return e===0&&(o.hidden=!0),o}function Wx(r,e){var t=r.table.formula;if(!t)return!1;var i=t.column_data[r.index];return i?!!i[e]:!1}function y5(r){return Wx(r,"color_latex_valid")}function E5(r){return Wx(r,"line_opacity_valid")}function G5(r){return Wx(r,"line_width_valid")}function T5(r){return Wx(r,"point_size_valid")}function I5(r){return Wx(r,"point_opacity_valid")}function x5(r){var e=r.table.formula;if(e){var t=e.column_data[r.index];if(t)return t.color_latex_value}}function V5(r){r.draggingOnGraphpaper?r.preTransientState||(r.preTransientState={columns:qf(r,{stripDefaults:!1}).columns}):delete r.preTransientState,Fd(r);let e=Ws(r);var t=e&&e.hidden;__dcg_shared_module_exports__['r'](r.columnModels,function(i){i.shouldGraph=!t&&!i.hidden&&!r.controller.is3dProduct()}),x$(r),w$(r),y$(r)}function Sl(r){let e=2,t,i=Sa(r);return i&&i.row>e&&(e=i.row),r.columnModels.forEach(o=>{t=o.disabled?o.computedValues.length:o.values.length+1,t>e&&(e=t)}),e}function Uf(r){return r.columnModels.length}function u5(r,e){r.formula=e;for(let i=0;i<e.column_data.length&&i<Uf(r);i++){let o=e.column_data[i];h$(r,i,o)}let t=r.columnModels[r.columnModels.length-1];t.disabled=!0,t.error=void 0}function hM(r,e){for(let t=0;t<r.columnModels.length;t++)f$(r,t,e)}function M5(r,e){let t=fg(r);t&&e===t.max-1&&zf(r,!0);for(var i=0;i<r.columnModels.length;i++)b$(r,i,e),i>0&&U5(r.columnModels[i])}function Gk(r,e){let t={id:r.controller.generateId(),latex:e?e.latex:"",color:r.controller.getNextColor()},i=e?e.columnIndex:r.columnModels.length,o=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},Sk),t),{values:[]});var n=k5(r,i,o);r.columnModels.splice(i,0,n);for(var a=i+1;a<r.columnModels.length;a++)r.columnModels[a].index=a}function A5(r,e){r.columnModels.splice(e,1);for(var t=e;t<r.columnModels.length;t++)r.columnModels[t].index=t}function L5(r,e){var t,i=r.columnModels.length,o=[];for(t=0;t<i;t++)o.push("");var n=r.columnModels[0].values;if(e>1){var a=r.controller.isDegreeMode(),s=gi(n[0],a),l=gi(n[1],a);if(isFinite(s)&&isFinite(l)){var c=fR(s,l);if(c){var p=c.nstart,u=p/c.lcm;for(t=0;t<e;t++){var m=gi(n[t],a);if(!__dcg_shared_module_exports__['_a'](m,u))return o;p+=c.nstep,u=p/c.lcm}(""+s).length<8&&(""+l).length<8?o[0]=""+u:o[0]="\\frac{"+p+"}{"+c.lcm+"}"}}}return o}function ck(r,e){for(let o=0;o<r.columnModels.length;o++){let n=r.columnModels[o],a={cellLocation:{column:o,row:0}};e(n.latex,"tableHeader",a),e(n.colorLatex,"tableColumnColorLatex",a),e(n.pointSize,"tableColumnPointSize",a),e(n.pointOpacity,"tableColumnPointOpacity",a),e(n.lineWidth,"tableColumnLineWidth",a),e(n.lineOpacity,"tableColumnLineOpacity",a);for(var t=r.columnModels[o],i=0;i<t.values.length;i++)t.values[i]&&e(t.values[i],"tableCellValue",{cellLocation:{column:o,row:i+1}})}}function y$(r){let e=Ek({type:"table",id:r.id,secret:r.secret,readonly:r.readonly,folderId:r.folderId,columns:r.columnModels.map(function(i){return S5(r,i.index)})});for(var t=0;t<e.columns.length;t++)e.columns[t].hidden=!r.columnModels[t].shouldGraph;r.cachedParsableState=e}function O5(r){return r.slice(0,r.length-1)}function qf(r,e){let t=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.cachedViewState),{columns:O5(r.cachedViewState.columns)});return e.stripDefaults?v5(t):t}function x$(r){var e=r.columnModels.map(function(t,i){return S5(r,i)});r.cachedViewState={id:r.id,type:r.type,folderId:r.folderId,columns:e,secret:r.secret,readonly:r.readonly}}function gM(r,e){r.draggingOnGraphpaper=e}function w$(r){let e=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r.cachedViewState),{columns:O5(r.cachedViewState.columns)});r.cachedUndoRedoFullState=e,r.preTransientState&&(e=__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},e),r.preTransientState)),r.cachedUndoRedoDiffState=e}var v$={id:!1,type:!1,columns:!1,folderId:!0,secret:!0,readonly:!0};function h5(r,e){__dcg_shared_module_exports__['Vc']({from:e,to:r,props:v$}),P5(r,e.columns)}function g5(r,e){let t=__dcg_shared_module_exports__['j'](kk(r)),i=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},t),_d(e)),{columnModels:void 0,formula:void 0,draggingOnGraphpaper:!1,cachedViewState:{},cachedParsableState:{},cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{},isExpanded:!1});return P5(i,t.columns),i}function P5(r,e){r.columnModels=e.map(function(t,i){return k5(r,i,t)}),Gk(r)}var C5=["x","y","z","u","v","w"];function mM(r,e,t){for(var i=[],o=Math.min(e.length,C5.length),n=0;n<o;n++)i.push({id:t.generateId(),latex:__dcg_shared_module_exports__['hb'](C5[n]+"_"+r),values:e[n],color:t.getNextColor(),hidden:!1,points:!0,lines:!1,dragMode:"NONE",pointStyle:"POINT",lineStyle:"SOLID",colorLatex:"",lineWidth:"",lineOpacity:"",pointOpacity:"",pointSize:""});return{id:t.generateId(),type:"table",folderId:"",secret:!1,readonly:!1,columns:i}}function _5(r,e){let t=qf(r,{stripDefaults:!1});if(!t.columns||!e.columns)return e;for(var i=0;i<e.columns.length;i++){var o=t.columns[i],n=e.columns[i];if(o)for(var a in o)o.hasOwnProperty(a)&&(n.hasOwnProperty(a)||(n[a]=o[a]))}return e}function Sa(r){if(!r)return;let e=r.controller.getFocusLocation();if(e&&e.type==="table"&&e.id===r.id)return e.location}function la(r,e){for(var t=0;t<r.columnModels.length;t++){let i=r.columnModels[t];if(i.id===e)return i}}function fM(r,e,t){let i=la(r,e);i&&(i.points=t,t||(i.dragMode="NONE"))}function F5(r,e,t){let i=la(r,e);i&&(i.pointStyle=t)}function R5(r,e,t){let i=la(r,e);i&&(i.lines=t)}function N5(r,e,t){let i=la(r,e);i&&(i.lineStyle=t)}function dk(r,e,t){let i=la(r,e);i&&(i.lineWidth=t)}function pk(r,e,t){let i=la(r,e);i&&(i.lineOpacity=t)}function uk(r,e,t){let i=la(r,e);i&&(i.pointSize=t)}function hk(r,e,t){let i=la(r,e);i&&(i.pointOpacity=t)}function B5(r,e,t){let i=la(r,e);i&&(i.dragMode=t,t!=="NONE"&&!i.points&&(i.points=!0))}function q5(r,e,t){let i=la(r,e);!i||!cf(t)||(i.color=t,i.colorLatex="")}function gk(r,e,t){let i=la(r,e);i&&(i.colorLatex=t)}function zf(r,e){r.isExpanded=e}function K5(r,e,t){let i=la(r,e);i&&(i.hidden=t,t&&z5(r))}function m5(r,e,t){let i=la(r,e);i&&(i.boundingBoxes=t,z5(r))}function z5(r){let e=[];r.columnModels.forEach(t=>{t.boundingBoxes&&!t.hidden&&(e=e.concat(t.boundingBoxes))}),r.boundingBoxes=e}function Tk(r,e){let t=la(r,e);return t?!t.points&&!t.lines:!0}function qp(r,e,t){if(e.row===0){let n=r.columnModels[e.column].id,a=la(r,n);if(!a)return;a.latex=t,e.column>=r.columnModels.length-1&&Gk(r);return}for(var i=r.columnModels[e.column],o=i.values.length;o<e.row-1;o++)i.values[o]="";r.columnModels[i.index].values[e.row-1]=t,e.column>0&&U5(r.columnModels[i.index])}function U5(r){for(;r.values.length>0&&!r.values[r.values.length-1];)r.values.pop()}function H5(r,e){return!!r.columnModels[e.column]&&e.row>=0}function W5(r){let e;if(r.values){for(e of r.values)if(e!=="")return!1}if(r.computedValues){for(e of r.computedValues)if(e!=="")return!1}return!0}function $x(r,e,t){let i=r.columnModels[t];return i.disabled?i.computedValues[e]||"":i.values[e]||""}function $5(r){let e=Sl(r),t=Uf(r);for(let i=0;i<t;i++)if($x(r,e-1,i)!=="")return!1;return!0}function Ik(r){var e=r&&r.id;if(r&&r.type==="table"){var t=Sa(r);if(t){var i=r.columnModels[t.column];e=i?i.id:void 0}else e=void 0}return e}function j5(r,e,t){var i=r.getAllSelectedItems(),o={};for(var n of i){var a=Ik(n);a!==void 0&&(o[a]=!0,t[a]||e.selectSketch(a))}for(let s in t)o[s]||e.deselectSketch(s);return o}var kl=function(r,e,t){if(r===void 0||e===void 0)return!1;let i,o=e.getBoundingClientRect().height,n=r.getBoundingClientRect().height,a=ao(r),s=ao(e);if(!a||!s)return!1;let l=e.scrollTop,c=a.top+l-s.top,p=c-t,u=n+c+t-o;return p>=u?i=Math.min(Math.max(l,u),p):i=.5*(p+u),i!==l?(e.scrollTop=i,e.scrollTop!=l):!1};function yg(r,e,t,i=3){let[o,n,a,s]=r,{x:l,y:c}=e.mathToPixels.mapPoint({x:o,y:n}),{x:p,y:u}=e.mathToPixels.mapPoint({x:a,y:s}),m=Math.min(i,Math.max(e.screen.width,e.screen.height)),h={xmin:-m,ymin:-m,xmax:e.screen.width+m,ymax:e.screen.height+m},x=l-p,C=c-u,D=-x,k=-C,M=l-h.xmin,I=h.xmax-l,S=c-h.ymin,V=h.ymax-c,P=[],L=[];if(x!==0){let b=M/x,A=I/D;x<0?(P.push(b),L.push(A)):(P.push(A),L.push(b))}if(C!==0){let b=S/C,A=V/k;C<0?(P.push(b),L.push(A)):(P.push(A),L.push(b))}(t===17||t===24)&&(P.push(0),L.push(1)),t===19&&P.push(0);let B=Math.max(...P),R=Math.min(...L);if(B>R)return{mapped:[l,c,p,u],clipped:[]};let W=l+D*B,re=c+k*B,ne=l+D*R,X=c+k*R;return W<h.xmin&&ne<h.xmin||W>h.xmax&&ne>h.xmax||re<h.ymin&&X<h.ymin||re>h.ymax&&X>h.ymax?{mapped:[l,c,p,u],clipped:[]}:{mapped:[l,c,p,u],clipped:[W,re,ne,X]}}var Fa=class{constructor(e,t,i){this.pattern=i,this.replen=this.pattern[0]+this.pattern[1],t/this.replen>1e3&&(this.pattern[0]=t*this.pattern[0]/this.replen/1e3,this.pattern[1]=t*this.pattern[1]/this.replen/1e3),this.pstate=0,this.dstaccum=0,this.px=null,this.py=null,this.ctx=e}static getDashedPattern(e,t){let i=e.lineWidth*11/(t?3.5:2.5),o=i*7/11;return[i,o]}static getDottedPattern(e,t,i){let o=.5*e.lineWidth*.1/(i?3.5:2.5),n=o*8/.1;return t&&(n*=2),[o,n]}static getTotalSegmentLength(e){if(e.length<4)return 0;let t=0,i=0,o=e[0],n=e[1];for(;isNaN(o)||isNaN(n);){if(i+=2,i>=e.length)return 0;o=e[i],n=e[i+1]}let a,s;for(i+=2;i<e.length;i+=2)a=e[i],s=e[i+1],!(isNaN(a)||isNaN(s))&&(t+=__dcg_shared_module_exports__['Ua'](a-o,s-n),o=a,n=s);return t}start(e,t){this.px=e,this.py=t}next(e,t){if(this.px===null||this.py===null)throw new Error("Must call start before calling next");let i=this.pattern[this.pstate],o=Math.sqrt(Math.pow(e-this.px,2)+Math.pow(t-this.py,2));if(o>1e-5){for(;o+this.dstaccum>=i;){let n=e-this.px,a=t-this.py,s=i-this.dstaccum;n*=s/o,a*=s/o,this.pstate===0&&(this.ctx.moveTo(this.px,this.py),this.ctx.lineTo(this.px+n,this.py+a)),this.dstaccum=0,this.px+=n,this.py+=a,this.pstate=this.pstate===0?1:0,i=this.pattern[this.pstate],o-=s}this.pstate===0&&(this.ctx.moveTo(this.px,this.py),this.ctx.lineTo(e,t))}this.px=e,this.py=t,this.dstaccum+=o}close(){this.pstate=0,this.dstaccum=0,this.px=null,this.py=null}drawSegment(e){let t=0,i=e[0],o=e[1];for(;isNaN(i)||isNaN(o);){if(t+=2,t>=e.length)return;i=e[t],o=e[t+1]}this.start(i,o);let n,a;for(t+=2;t<e.length;t+=2)n=e[t],a=e[t+1],!(isNaN(n)||isNaN(a))&&this.next(n,a);this.close()}};var Qu=10,Zu=3;function Vk(r,e){return r+1e-8*(e-r)>r&&e-r>1e-300&&e-r<1e300}function J5(r,e){return r>1e-300&&Vk(r,e)}var lo=class r{constructor(e=-10,t=10,i=-10,o=10,n=-2,a=2){this.xmin=e,this.xmax=t,this.ymin=i,this.ymax=o,this.zmin=n,this.zmax=a}static fromObject({xmin:e,xmax:t,ymin:i,ymax:o,zmin:n,zmax:a}){return new r(e,t,i,o,n,a)}toObject(){return{xmin:this.xmin,ymin:this.ymin,zmin:this.zmin,xmax:this.xmax,ymax:this.ymax,zmax:this.zmax}}equals(e){return!(this.xmin!==e.xmin||this.ymin!==e.ymin||this.zmin!==e.zmin||this.xmax!==e.xmax||this.ymax!==e.ymax||this.zmax!==e.zmax)}isXValid(e){return e==="linear"?Vk(this.xmin,this.xmax):J5(this.xmin,this.xmax)}isYValid(e){return e==="linear"?Vk(this.ymin,this.ymax):J5(this.ymin,this.ymax)}isZValid(){return this.zmin===void 0||this.zmax===void 0?!1:Vk(this.zmin,this.zmax)}isValid(e){return this.isXValid(e.xAxisScale)&&this.isYValid(e.yAxisScale)}isSquare(e,t){return Math.abs(e.height-e.width*this.aspectRatio(t))<1}isSquare3D(){let{xmin:e,xmax:t,ymin:i,ymax:o,zmin:n,zmax:a}=this;if(n===void 0||a===void 0)return!1;let s=[t-e,o-i,a-n];return Math.min(...s)/Math.max(...s)>.99999}aspectRatio(e){let t=Qu/Zu,i=e.yAxisScale==="linear"?this.ymax-this.ymin:Math.log10(this.ymax/this.ymin)*t,o=e.xAxisScale==="linear"?this.xmax-this.xmin:Math.log10(this.xmax/this.xmin)*t;return i/o}getSquaredAxisLimits({axis:e,screen:t,settings:i}){let[o,n,a,s,l]=e==="y"?[{min:this.ymin,max:this.ymax},{min:this.xmin,max:this.xmax},t.height/t.width,i.yAxisScale,i.xAxisScale]:[{min:this.xmin,max:this.xmax},{min:this.ymin,max:this.ymax},t.width/t.height,i.xAxisScale,i.yAxisScale];if(s==="logarithmic"){let p=l==="logarithmic"?Math.log(n.max)-Math.log(n.min):(n.max-n.min)*Zu/(Qu*Math.LOG10E),{min:u,max:m}=X5({min:Math.log(o.min),max:Math.log(o.max)},a*p);return{min:Math.exp(u),max:Math.exp(m)}}let c=l==="logarithmic"?(Math.log10(n.max)-Math.log10(n.min))*Qu/Zu:n.max-n.min;return X5(o,c*a)}squareXAxis(e,t){let{min:i,max:o}=this.getSquaredAxisLimits({axis:"x",screen:e,settings:t}),n=new r(i,o,this.ymin,this.ymax);return n.isXValid(t.xAxisScale)?n:this}squareYAxis(e,t){let{min:i,max:o}=this.getSquaredAxisLimits({axis:"y",screen:e,settings:t}),n=new r(this.xmin,this.xmax,i,o);return n.isYValid(t.yAxisScale)?n:this}squareCrop(e,t){return this.aspectRatio({xAxisScale:t.xAxisScale,yAxisScale:t.yAxisScale})>e.height/e.width?this.squareYAxis(e,t):this.squareXAxis(e,t)}polarDiameter(){let e=Math.abs(this.xmax),t=Math.abs(this.xmin),i=Math.abs(this.ymax),o=Math.abs(this.ymin);return 1.5*Math.max(e,t,i,o)}largestR(){return Math.sqrt(Math.pow(Math.max(-this.xmin,this.xmax),2)+Math.pow(Math.max(-this.ymin,this.ymax),2))}smallestR(){return this.xmin<=0&&this.xmax>=0&&this.ymin<=0&&this.ymax>=0?0:this.xmin<=0&&this.xmax>=0?Math.min(Math.abs(this.ymin),Math.abs(this.ymax)):this.ymin<=0&&this.ymax>=0?Math.min(Math.abs(this.xmin),Math.abs(this.xmax)):Math.sqrt(Math.pow(Math.max(this.xmin,-this.xmax),2)+Math.pow(Math.max(this.ymin,-this.ymax),2))}};function X5(r,e){let t=.5*(r.min+r.max),[i,o]=[t-.5*e,t+.5*e];return Math.abs((o-i)/e-1)>.1?{min:-.5*e,max:.5*e}:{min:i,max:o}}var Mk={IS_HOVERED:1.2,IS_PRESSED:1.4,IS_GHOSTED:.4},jx={IS_HOVERED:.5,IS_DEPRESSED:.3},yM={IS_GHOSTED:.4},Ak={IS_HOVERED:.3,IS_DEPRESSED:.5},Lk={IS_GHOSTED:.4},Yx=1;function Qi(r,e){let t=r;t._dcgSaveClassName&&t._dcgSaveClassName(e)}function Oi(r){let e=r;e._dcgRestoreClassName&&e._dcgRestoreClassName()}var Kp,xg=new Map,Ok=0;function Z5(r,e,t){let i=r.imageObj;if(Kp&&Kp.color===e&&Kp.img===i)return Kp.canvas;Kp?(Kp.color=e,Kp.img=i):Kp={color:e,img:i,canvas:document.createElement("canvas")};let o=Kp.canvas,n=r.mimeType==="image/svg+xml";o.width=0,o.width=n?t.width:i.width,o.height=n?t.height:i.height;let a=o.getContext("2d");return a.drawImage(i,0,0,o.width,o.height),a.fillStyle=e,a.globalCompositeOperation="source-atop",a.fillRect(0,0,o.width,o.height),o}function C$(r,e){if(e.width*e.height>1e3*1e3*window.devicePixelRatio*window.devicePixelRatio)return r.imageObj;let t=r.image_url,i=xg.get(t),o;if(!i||e.width!==i.size.width||e.height!==i.size.height){i&&(xg.delete(t),Ok-=i.canvas.width*i.canvas.height);let a=r.imageObj,s=document.createElement("canvas");s.width=e.width,s.height=e.height;var n=s.getContext("2d");n.drawImage(a,0,0,s.width,s.height);let l=20*1e3*1e3;if(s.width*s.height>l)return r.imageObj;for(Ok+=s.width*s.height;Ok>l;){let[c,p]=Array.from(xg)[0];xg.delete(c),Ok-=p.canvas.width*p.canvas.height}xg.set(t,{canvas:s,size:e}),o=s}else xg.delete(t),xg.set(t,i),o=i.canvas;return o}function Pk(r,e,t,i={cacheRenderedSvgs:!1}){let{ctx:o,projection:n}=r,a=e.formula;if(!a||!a.dimensions.x)return;let s=a.dimensions;for(let l=0;l<s.x.length;l++){let c=s.x[l],p=s.y[l],u=s.width[l],m=s.height[l],h=s.radianAngle[l];if(!isFinite(c)||!isFinite(p)||!isFinite(u)||!isFinite(m)||!isFinite(h))continue;Qi(o,"dcg-svg-image"),o.save(),Oi(o),o.globalAlpha=s.opacity[l];let x=n.mapy(m)-n.mapy(0),C=n.mapx(u)-n.mapx(0),D=h===0?1:Math.abs(C/u*(m/x)),k=n.mapx(c),M=n.mapy(p),I=k-C/2,S=M+x*D/2,V=m<0?-1:1,P=u<0?-1:1,L=I*P,B=S*V,R=Math.abs(C),W=Math.abs(x);h!==0&&(o.translate(k,M),o.scale(1,1/D),o.rotate(h),o.translate(-k,-M)),o.scale(P,V);let re=t.shouldDrawHovered(r,e.id,l),ne=t.shouldDrawPressed(e.id,l),X=i.currentKeyboardAttention&&i.currentKeyboardAttention.calcId===e.id&&(i.currentKeyboardAttention.listIndex===void 0||i.currentKeyboardAttention.listIndex===l),A=e.imageObj,E=window.devicePixelRatio*(n.screen.width/n.screen.height),J={width:Math.floor(R*E),height:Math.floor(W*E)};ne?e.depressedImageObj?A=e.depressedImageObj:A=Z5(e,"rgba(50,50,50,0.2)",J):re?e.hoveredImageObj?A=e.hoveredImageObj:A=Z5(e,"rgba(200,200,200,0.2)",J):i.cacheRenderedSvgs&&e.mimeType==="image/svg+xml"&&(A=C$(e,J)),o.drawImage(A,L,B,R,W*D);let j=0,ce=3;if(aa(e)&&e.controller.isTraceEnabled()&&(o.beginPath(),o.rect(L-j,B-j,R+2*j,W*D+2*j),o.restore(),o.save(),o.strokeStyle="#6993C7",o.lineWidth=ce,o.stroke()),X){let te=o.globalAlpha;j=5,o.beginPath(),o.roundRect?o.roundRect(L-j,B-j,R+2*j,W*D+2*j,j):o.rect(L-j,B-j,R+2*j,W*D+2*j),o.restore(),o.save(),o.strokeStyle=__dcg_shared_module_exports__['o'].FOCUS_OUTLINE,o.globalAlpha=1,o.lineWidth=ce,o.stroke(),o.globalAlpha=te}o.restore()}}function Ra(r,e){let t=r;t._dcgStartNamedGroup&&t._dcgStartNamedGroup(e)}function Jx(r,e){let t=r;t._dcgSetTitle&&t._dcgSetTitle(e)}function Na(r){let e=r;e._dcgEndNamedGroup&&e._dcgEndNamedGroup()}function eB(r){return r.uncommitted?"#ccc":!r.selected&&!r.hovered&&tB(r)===1?__dcg_shared_module_exports__['m'](r.color,.2):r.color}function tB(r){let e=.6;return r.hidden?r.selected?e=.4:e=.25:r.selected||r.isPoint?e=1:r.hovered&&(e=.8),r.isTransparentObject&&(e*=.3),e}function D$(r){return r.hidden?r.isPoint?0:r.selected?.3:.2:r.selected||r.isPoint||r.hovered?1:.7}function rB(r,e){if(r=r.replace(/#/,""),r.length===3)var t=parseInt(r.slice(0,1)+r.slice(0,1),16),i=parseInt(r.slice(1,2)+r.slice(1,2),16),o=parseInt(r.slice(2,3)+r.slice(2,3),16);else if(r.length===6)var t=parseInt(r.slice(0,2),16),i=parseInt(r.slice(2,4),16),o=parseInt(r.slice(4,6),16);else var t=0,i=0,o=0;return`rgba(${t}, ${i}, ${o}, ${e})`}function Qx(r){return rB(eB(r),D$(r))}function _k(r){return rB(eB(r),tB(r))}function Fk(r){return Math.abs(Math.abs(r)-Math.PI/2)<1e-6}var $f=1.4,iB=1.5,Bk={};function lB(r={}){return Object.keys(r).length}function Nk(r,e={}){return lB(e)===0?r:r.filter((t,i)=>!e[i])}function oB(r,e){let t=[];for(let i=0;i<r;i++)t.push(e);return t}function G$(){return!!Object.keys(Bk).length}var wM=function(r,e){let t=3;return e&&(t+=e),new lo(-t,r.width+t,-t,r.height+t)};function nB(r,e){let{displayAsRightAngle:t,rx:i,ry:o,startAngle:n,deltaAngle:a,yscreen:s,xscreen:l}=r;if(t){let c=i*Math.cos(-n),p=i*Math.cos(-n-a),u=o*Math.sin(-n),m=o*Math.sin(-n-a);e.moveTo(l+c,s+u),e.lineTo(l+c+p,s+u+m),e.lineTo(l+p,s+m)}else e.ellipse(l,s,i,o,0,-n,-n-a,a>0)}var eh=class r{constructor(e,t,i){if(this.controller=e,this.getExpressionAriaLabel=i,t.config.plaidMode){let o=["RED","BLUE","GREEN","PURPLE","ORANGE","BLACK"];for(let n of o)Bk[__dcg_shared_module_exports__['o'][n]]=document.createElement("img"),Bk[__dcg_shared_module_exports__['o'][n]].setAttribute("src","/assets/img/april-fools/"+n.toLowerCase()+".png")}}redrawToCtx(e,t,i,o,n,a,s){let{ctx:l,projection:c}=e;Ra(l,"expressions");let p=c.settings.highlight,u=this.controller.isGeometry();o.forEach(m=>{let h=t[m],x=i[m];h!==void 0&&(u&&c.settings.setProperty("highlight",h.showHighlight),Ra(l,"sketch"),c.settings.takingScreenshot&&Jx(l,this.getExpressionAriaLabel(m)),r.drawSketchToCtx({sketch:t[m],drawContext:e,poiLabelsLayer:n,clickableObjectsLayer:a,geometryContext:this.controller.getGeoModel(),showMovablePoints:s==null?void 0:s.showMovablePoints}),Na(l)),x&&x.shouldGraph&&x.foreground&&Pk(e,x,a,{currentKeyboardAttention:this.controller.get2dPOIController().keyboardAttentionManager.getKeyboardAttention(),cacheRenderedSvgs:this.controller.getGraphSettings().config.cacheRenderedSvgs})}),Na(l),c.settings.setProperty("highlight",p)}static eachSegment(e,t){for(let i of e.branches)if(i.graphMode!==15)for(let o of i.segments)t(i,o)}static drawSketchToCtx({sketch:e,drawContext:t,poiLabelsLayer:i,clickableObjectsLayer:o,geometryContext:n,showMovablePoints:a}){var D,k,M,I,S;if(!e.branches||!e.branches.length)return;let{ctx:s,projection:l}=t,c=s.lineWidth,p=s.globalAlpha,u=l.settings.globalCurveColor?l.settings.globalCurveColor:e.color,m=Bk[u],h;m&&m.complete&&m.naturalWidth>0?h=s.createPattern(m,"repeat"):h=u,s.lineJoin="round",s.lineCap="round";let x=!!l.settings.takingScreenshot,C=!!a;for(let V of e.branches){if(V.graphMode===3||V.graphMode===4||V.graphMode===15||V.graphMode===22)continue;let P=1;o.shouldDrawHovered(t,e.id,V.listIndex)&&(P=Mk.IS_HOVERED),o.shouldDrawPressed(e.id,V.listIndex)&&(P=Mk.IS_PRESSED),o.shouldDrawGhosted(e.id)&&(P=Mk.IS_GHOSTED),P*=(D=n==null?void 0:n.getToolFadeOpacity(e.id))!=null?D:1,P*=l.settings.getFillOpacityMultiplier(),s.strokeStyle=u,s.fillStyle=V.color&&!l.settings.globalCurveColor&&!G$()?V.color:h,V.graphMode!==6&&(s.desmos_batching=!0,s.beginPath());for(let L of V.segments){let B=(k=V.graphMode)!=null?k:2;if(B===7&&!l.settings.disableFill)r.fillPolygonToCtx(s,l,L,V.fillOpacity===void 0?NaN:V.fillOpacity*P);else if(B!==8){let R=V.operator,W=!l.settings.disableFill&&(R=="<"||R==">"||R=="<="||R==">="),re=R=="<="||R=="<";W&&r.fillGraphStrokeToCtx(s,l,L,re,B)}}s.globalAlpha=r._clampedOpacity(V.fillOpacity===void 0?NaN:V.fillOpacity*P,.4),V.graphMode!==6&&(s.fill(),s.desmos_batching=!1),s.globalAlpha=1;for(let L of V.segments){let B=2;V.graphMode&&(B=V.graphMode);let R=L,W=V.lineWidth!==void 0,re=V.lineWidth,ne=2.5,X=(M=V.arrowMode)!=null?M:"DEFAULT";if(s.strokeStyle=V.color,s.fillStyle=V.color,W&&(re<=0||!isFinite(re)))continue;s.lineWidth=W?re:ne;let b=l.settings.graphLineWidth/ne,A=1.3;l.settings.highlight&&(A*=5/7),e.tokenSelected?(b*=iB,A/=iB):e.tokenHovered&&(b*=$f,A/=$f),s.lineWidth*=b,s.globalAlpha*=l.settings.curveOpacity,s.globalAlpha=r._clampedOpacity(l.settings.curveOpacity===1?1:V.lineOpacity,.9);let E=V.operator,J="default";E==="<"||E===">"||E==="!="?J="DASHED":E==="<="||E===">="?J="SOLID":e.style==="DASHED"||V.style==="DASHED"?J="DASHED":(e.style==="DOTTED"||V.style==="DOTTED")&&(J="DOTTED",W&&(s.lineWidth*=2)),s.globalAlpha*=(I=n==null?void 0:n.getToolFadeOpacity(e.id))!=null?I:1;let j=!V.isIntersectionExtension&&o.shouldDrawHovered(t,e.id,V.listIndex),ce=!V.isIntersectionExtension&&o.shouldDrawPressed(e.id,V.listIndex),te=o.shouldDrawGhosted(e.id);te?s.globalAlpha*=yM.IS_GHOSTED:(ce||j)&&(s.save(),s.lineWidth+=4.5,s.globalAlpha*=ce?jx.IS_DEPRESSED:jx.IS_HOVERED,r.drawGraphStrokeToCtx(s,l,R,{type:J,graphMode:B,op:E,arrowMode:X,arrowHeadBaseWidth:(s.lineWidth-4.5)*A,opacityMultiplier:ce?jx.IS_DEPRESSED:jx.IS_HOVERED}),s.restore()),r.drawGraphStrokeToCtx(s,l,R,{type:J,graphMode:B,op:E,arrowMode:X,arrowHeadBaseWidth:s.lineWidth*A,opacityMultiplier:((S=n==null?void 0:n.getToolFadeOpacity(e.id))!=null?S:1)*(te?yM.IS_GHOSTED:Yx)})}}s.lineWidth=c,s.globalAlpha=p,s.strokeStyle=u,r.eachSegment(e,(function(V,P){var L;if(V.graphMode===3&&V.showPoint||V.graphMode===4&&x){let B=P,R=[],W;if(V.interactiveLabel&&e.labels)for(let te=0,pe=e.labels.length;te<pe;te++){let he=e.labels[te];if(he.type==="poi"){let ae=i.isOpenPOI(he.poi),ie=i.getHoveredPOI()===he.poi;R.push(ae||ie),!ae&&ie&&(W=te)}}let re=V.graphMode===4&&x&&!C&&V.pointOpacity===1,ne=1;typeof V.pointSize=="number"?ne=V.pointSize/9:Array.isArray(V.pointSize)&&(ne=V.pointSize.map(function(te){return te/9}));let X;Array.isArray(V.color)&&(X=V.color);let b=o.getHoveredObjectById(e.id),A=o.shouldDrawHovered(t,e.id,void 0),E=o.getPressedObject(),J=o.shouldDrawPressed(e.id,E==null?void 0:E.listIndex),j=o.shouldDrawGhosted(e.id),ce=V.droppedIndices;if((A||J)&&!j){let te=B.length;ce&&(te+=lB(ce));let pe=oB(te,0),he=Array.isArray(ne)?ne.slice():oB(te,ne);J&&E?E.listIndex===void 0?(pe=pe.map(()=>Ak.IS_DEPRESSED),he=he.map(ae=>ae*1.5)):(pe[E.listIndex]=Ak.IS_DEPRESSED,he[E.listIndex]*=1.5):A&&b&&(pe=pe.map((ae,ie)=>b.listIndexes===void 0||b.listIndexes[ie]?Ak.IS_HOVERED:ae),he=he.map((ae,ie)=>b.listIndexes===void 0||b.listIndexes[ie]?ae*1.5:ae)),r.drawPointsToCtx({ctx:s,projection:l,segment:B,style:V.style,sizeOverrideIdxs:R,opacityOverrideIdx:W,sizeFactor:he,opacityFactor:pe,colorOverrides:X,baseOpacity:V.pointOpacity,droppedIndices:ce,sketch:e,isKeyboardFocused:o.isKeyboardFocused(e.id,void 0)}),s.restore()}r.drawPointsToCtx({ctx:s,projection:l,segment:B,style:V.style,sizeOverrideIdxs:R,opacityOverrideIdx:W,sizeFactor:ne,opacityFactor:((L=n==null?void 0:n.getToolFadeOpacity(e.id))!=null?L:1)*(j?Lk.IS_GHOSTED:Yx),colorOverrides:X,baseOpacity:re?.9:V.pointOpacity,droppedIndices:ce,sketch:e})}}).bind(this))}static drawGraphStrokeToCtx(e,t,i,o){let n={arrowHeadBaseWidth:e.lineWidth},{type:a,graphMode:s,op:l,arrowMode:c,arrowHeadBaseWidth:p}=Object.assign({},n,o);if(s===20||s===21){let[C,D,k]=i,M=t.mathToPixels.mapX(C),I=t.mathToPixels.mapY(D),S=t.mathToPixels.dangerouslyGetXScaleFactor(),V=t.mathToPixels.dangerouslyGetYScaleFactor(),P=Math.abs(k*S),L=Math.abs(k*V),B,R;if(s===21?(B=-i[3],R=-i[4]):(B=0,R=2*Math.PI),e.save(),Qi(e,"dcg-svg-curve"),e.desmos_batching||e.beginPath(),a==="DASHED"){let W=Fa.getDashedPattern(e,!!t.settings.highlight);e.setLineDash(W)}else if(a==="DOTTED"){let W=Fa.getDottedPattern(e,!!t.settings.config.projectorMode,!!t.settings.highlight);e.setLineDash(W)}e.ellipse(M,I,P,L,0,B,R,B>R),e.desmos_batching||e.stroke(),Oi(e),e.restore();return}else if(s===23){let[C,D,k,M,I]=i,S=!I&&Fk(M),V=th(M,t),P=t.mathToPixels.mapX(C),L=t.mathToPixels.mapY(D),B=t.mathToPixels.dangerouslyGetXScaleFactor(),R=t.mathToPixels.dangerouslyGetYScaleFactor(),W=B>R?B/R:1,re=B>R?1:R/B,ne=Math.abs(W*V),X=Math.abs(re*V);if(e.save(),Qi(e,"dcg-svg-curve"),e.globalAlpha=.4*o.opacityMultiplier,e.desmos_batching||e.beginPath(),e.moveTo(P,L),e.lineTo(P+ne*Math.cos(-k),L+X*Math.sin(-k)),nB({displayAsRightAngle:S,rx:ne,ry:X,startAngle:k,deltaAngle:M,yscreen:L,xscreen:P},e),e.lineTo(P,L),!e.desmos_batching&&!I&&e.fill(),e.globalAlpha=o.opacityMultiplier,e.desmos_batching||e.beginPath(),nB({displayAsRightAngle:S,rx:ne,ry:X,startAngle:k,deltaAngle:M,yscreen:L,xscreen:P},e),I){let b=-k-M,A=P+ne*Math.cos(b),E=L+X*Math.sin(b);CM(e,A,E,-k,-M,10,ne)}e.globalAlpha=o.opacityMultiplier,e.desmos_batching||e.stroke(),e.lineWidth=1.5,e.globalAlpha=.2*o.opacityMultiplier,e.moveTo(P+1.5*ne*Math.cos(-k),L+1.5*X*Math.sin(-k)),e.lineTo(P,L),e.lineTo(P+1.5*ne*Math.cos(-k-M),L+1.5*X*Math.sin(-k-M)),e.stroke(),Oi(e),e.restore()}else if(s===17||s===18||s===19||s===24){let{clipped:C,mapped:D}=yg(i,t,s,e.lineWidth);if(C.length===0)return;let[k,M,I,S]=C,[V,P,L,B]=D;e.save(),Qi(e,"dcg-svg-curve");let R;if(e.desmos_batching||e.beginPath(),a=="DASHED"?(R=new Fa(e,Fa.getTotalSegmentLength(C),Fa.getDashedPattern(e,!!t.settings.highlight)),R.drawSegment(C)):a=="DOTTED"?(R=new Fa(e,Fa.getTotalSegmentLength(C),Fa.getDottedPattern(e,!!t.settings.config.projectorMode,!!t.settings.highlight)),R.drawSegment(C)):(e.moveTo(k,M),e.lineTo(I,S)),s===17){let W=aB(a)*p,{startArrow:re,endArrow:ne}=I$(T$(s,c));re&&qc(e,L,B,V,P,W),ne&&qc(e,V,P,L,B,W)}else if(s===24&&(V!==L||P!==B)){let W=aB(a)*p;qc(e,V,P,L,B,W)}e.desmos_batching||e.stroke(),Oi(e),e.restore();return}let u=__dcg_shared_module_exports__['Pc'](s,l!=="=",t.settings),m=__dcg_shared_module_exports__['Jc'](i,t.mathToPixels,u),h=__dcg_shared_module_exports__['Kc'](m,wM(t.screen,e.lineWidth));if(h.length===0)return;e.save(),Qi(e,"dcg-svg-curve");let x;if(e.desmos_batching||e.beginPath(),a=="DASHED")x=new Fa(e,Fa.getTotalSegmentLength(h),Fa.getDashedPattern(e,!!t.settings.highlight)),x.drawSegment(h);else if(a=="DOTTED")x=new Fa(e,Fa.getTotalSegmentLength(h),Fa.getDottedPattern(e,!!t.settings.config.projectorMode,!!t.settings.highlight)),x.drawSegment(h);else if((a==="SOLID"||a==="default")&&e.lineWidth===1)if(h.length>4||h[0]!==h[2]&&h[1]!==h[3]){e.moveTo(h[0],h[1]);for(let D=0;D<h.length;D+=2)e.lineTo(h[D],h[D+1])}else{e.moveTo(__dcg_shared_module_exports__['$a'](h[0]),__dcg_shared_module_exports__['$a'](h[1]));for(let D=0;D<h.length;D+=2)e.lineTo(__dcg_shared_module_exports__['$a'](h[D]),__dcg_shared_module_exports__['$a'](h[D+1]))}else{e.moveTo(h[0],h[1]);for(let C=0;C<h.length;C+=2)e.lineTo(h[C],h[C+1])}e.desmos_batching||e.stroke(),Oi(e),e.restore()}static mapPointToScreen(e,t,i){let n=e.mapx(t);if(n<-20||n>e.screen.width+20)return null;let a=e.mapy(i);return a<-20||a>e.screen.height+20?null:{x:n,y:a}}static drawPointToCtx(e){let{ctx:t,projection:i,sketch:o,x:n,y:a}=e,{sizeFactor:s}=e,l=t.lineWidth,c=t.fillStyle,p=t.strokeStyle,u=r.mapPointToScreen(i,n,a);if(!u||e.sizeFactor!==void 0&&(e.sizeFactor<=0||!isFinite(e.sizeFactor)))return!1;Qi(t,"dcg-svg-point"),e.alpha!==void 0?t.globalAlpha=e.alpha:t.globalAlpha=.9,e.opacityFactor!==void 0&&(t.globalAlpha*=e.opacityFactor),t.desmos_batching||t.beginPath();let m=i.settings.pointLineWidth;if(e.overrideSize&&(m=i.settings.config.projectorMode?17:11,t.lineWidth=m),o.tokenSelected?s?s*=1.5:s=1.5:o.tokenHovered&&(s?s*=$f:s=$f),s!==void 0&&(m*=s,t.lineWidth=m),e.colorOverride&&(t.fillStyle=e.colorOverride,t.strokeStyle=e.colorOverride),e.style==="CROSS"){let h=m*.4;t.moveTo(u.x-h,u.y-h),t.lineTo(u.x+h,u.y+h),t.moveTo(u.x+h,u.y-h),t.lineTo(u.x-h,u.y+h),t.lineWidth=m*.3}else if(e.style==="OPEN"){let h=m*.42;t.moveTo(u.x+h,u.y),t.arc(u.x,u.y,h,0,Math.PI*2,!0),t.closePath(),t.fillStyle="white",t.lineWidth=m*.25,t.fill()}else t.moveTo(u.x-.1,u.y-.1),t.lineTo(u.x-.1,u.y+.1),t.lineTo(u.x+.1,u.y+.1),t.lineTo(u.x+.1,u.y-.1);if(t.desmos_batching||t.stroke(),t.globalAlpha=1,e.isKeyboardFocused){let h=m/2+6;t.lineWidth=2,t.strokeStyle="#6A93D2",t.beginPath(),t.moveTo(u.x+h,u.y),t.arc(u.x,u.y,h,0,Math.PI*2,!0),t.stroke(),t.closePath()}return t.lineWidth=l,t.fillStyle=c,t.strokeStyle=p,Oi(t),!0}static drawPointsToCtx(e){let{ctx:t,projection:i,segment:o,style:n,sizeOverrideIdxs:a,opacityOverrideIdx:s,sizeFactor:l,opacityFactor:c,colorOverrides:p,baseOpacity:u,droppedIndices:m}=e,h=t.lineWidth;t.lineWidth=i.settings.pointLineWidth;let x;Array.isArray(u)?(x=u.map((function(C){return r._clampedOpacity(C,.9)}).bind(this)),x=Nk(x,m)):x=r._clampedOpacity(u,.9),Array.isArray(l)&&(l=Nk(l,m)),Array.isArray(c)&&(c=Nk(c,m)),p&&(p=Nk(p,m));for(let C=0;C<o.length;C++)r.drawPointToCtx({ctx:t,projection:i,sketch:e.sketch,x:o[C][0],y:o[C][1],alpha:s===C?.6:Array.isArray(x)?x[C]:x,style:n,overrideSize:a[C],sizeFactor:Array.isArray(l)?l[C]:l,opacityFactor:Array.isArray(c)?c[C]:c,colorOverride:p&&p[C],isKeyboardFocused:e.isKeyboardFocused});t.lineWidth=h}static fillGraphStrokeToCtx(e,t,i,o,n){e.globalAlpha=n===6?.2:.4;let a=null,s=null,l;if(n===6){s=__dcg_shared_module_exports__['Ec'];let p=o?0:t.viewport.polarDiameter(),u=t.settings.degreeMode?180:2*Math.PI;a=__dcg_shared_module_exports__['Nc'](i,p,u)}else n===2?(s=__dcg_shared_module_exports__['Gc'],l=o?t.viewport.ymin:t.viewport.ymax,a=__dcg_shared_module_exports__['Oc'](i,l)):n===1&&(s=__dcg_shared_module_exports__['Fc'],l=o?t.viewport.xmin:t.viewport.xmax,a=__dcg_shared_module_exports__['Oc'](i,l));if(a===null||s===null)return;let c=wM(t.screen);for(let p of a){let u=__dcg_shared_module_exports__['Pc'](n,!0,t.settings),m=__dcg_shared_module_exports__['Jc'](p,t.mathToPixels,u),h=__dcg_shared_module_exports__['Mc'](m,c,s,!1);if(h.length>=6){Qi(e,"dcg-svg-region"),e.desmos_batching||e.beginPath(),e.moveTo(h[0],h[1]);for(let x=2;x<h.length;x+=2)e.lineTo(h[x],h[x+1]);e.lineTo(h[0],h[1]),e.desmos_batching||e.fill(),Oi(e)}}e.globalAlpha=1}static _clampedOpacity(e,t){return typeof e!="number"?t:e<0?0:e>1?1:isFinite(e)?e:t}static fillPolygonToCtx(e,t,i,o){let n=wM(t.screen);e.globalAlpha=r._clampedOpacity(o*t.settings.getFillOpacityMultiplier(),.4);let a=__dcg_shared_module_exports__['Jc'](i,t.mathToPixels,__dcg_shared_module_exports__['Hc']),s=__dcg_shared_module_exports__['Mc'](a,n,__dcg_shared_module_exports__['Ec'],!1);if(s.length>=6){Qi(e,"dcg-svg-region"),e.desmos_batching||e.beginPath(),e.moveTo(s[0],s[1]);for(let l=2;l<s.length;l+=2)e.lineTo(s[l],s[l+1]);e.desmos_batching||e.fill(),Oi(e)}e.globalAlpha=1}};function T$(r,e){return r===17?e==="DEFAULT"?"NONE":e:"NONE"}function I$(r){switch(r){case"NONE":return{startArrow:!1,endArrow:!1};case"POSITIVE":return{startArrow:!1,endArrow:!0};case"BOTH":return{startArrow:!0,endArrow:!0};default:let e=r;throw new Error("Unexpected arrowMode: "+e)}}function aB(r){switch(r){case"default":case"SOLID":case"DASHED":return 4;case"DOTTED":return 2;default:let e=r;throw new Error("Unexpected line style "+e)}}function qc(r,e,t,i,o,n){let a=Math.atan2(o-t,i-e),s=i-n*Math.cos(a-Math.PI/9),l=o-n*Math.sin(a-Math.PI/9),c=i-n*Math.cos(a+Math.PI/9),p=o-n*Math.sin(a+Math.PI/9),u=i-(n-2)*Math.cos(a-Math.PI/18),m=o-(n-2)*Math.sin(a-Math.PI/18),h=i-(n-2)*Math.cos(a+Math.PI/18),x=o-(n-2)*Math.sin(a+Math.PI/18);r.moveTo(i,o),r.lineTo(s,l),r.lineTo(c,p),r.lineTo(i,o),r.lineTo(u,m),r.lineTo(h,x),r.lineTo(i,o)}function CM(r,e,t,i,o,n,a){let s=i+o,l=n*Math.min(1,Math.max(.5,Math.abs(o)/.8)),c=o<=0,p=Math.PI/2;a<25?p+=.25:p+=.1,c||(p*=-1);let u=e+Math.cos(s+p),m=t+Math.sin(s+p);qc(r,u,m,e,t,l)}function th(r,e){let t=20;return e.settings.config.projectorMode&&(t*=1.4),t}var Kk=class{constructor(e){this.savedPOI=[],this.controller=e}redrawToCtx(e,t,i,o,n){let{ctx:a,projection:s}=e,l=[];for(var c=0;c<n.length;c++){var p=n[c],u=t[p];if(u){u.showHighlight&&!this.controller.isGeometry()&&this.drawSketchHighlight({sketch:u,drawContext:e,poiLabelsLayer:i,clickableObjectsLayer:o,geometryContext:this.controller.getGeoModel()});var m=u.getPOI();(u.showPOI||m.length&&m[0].isAttachedToPlottedPoint())&&l.push.apply(l,this.drawPOIs(m,a,"#AAAAAA",s))}}this.savedPOI=l}getDrawnPOI(){return this.savedPOI}drawSketchHighlight(e){e.drawContext.projection.settings.setProperty("highlight",!0),eh.drawSketchToCtx(e),e.drawContext.projection.settings.setProperty("highlight",!1)}drawPOIs(e,t,i,o){t.lineWidth=o.settings.pointLineWidth,t.strokeStyle=i||"#AAAAAA",t.fillStyle=i||"#AAAAAA",t.lineJoin="round",t.lineCap="round";var n=t.globalAlpha;t.globalAlpha=.01;var a=[],s,l=e.length,c;if(l&&e[0].isAttachedToPlottedPoint())for(s=0;s<l;s++)c=e[s],eh.mapPointToScreen(o,c.x,c.y)&&a.push(c);else for(s=0;s<l;s++)c=e[s],eh.drawPointToCtx(__dcg_shared_module_exports__['a']({ctx:t,projection:o},c))&&a.push(c);return t.globalAlpha=n,a}};var zk=class{redrawToCtx(e,t){let{ctx:i,projection:o}=e;if(t){i.save(),i.lineWidth=2,i.fillStyle="rgba(0,0,0,.15)",i.strokeStyle="rgba(0,0,0,.4)";var n=o.mapx(t.left),a=o.mapy(t.top),s=o.mapx(t.right),l=o.mapy(t.bottom),c=s-n,p=l-a;i.fillRect(n,a,c,p),i.strokeRect(n,a,c,p),i.restore()}}};var Up=__dcg_shared_module_exports__['h'](z());var{If:M$}=Up.Components,Uk=class extends Up.Class{init(){this.controller=this.props.grapher().controller,this.poiController=this.props.grapher().poiController}template(){return Up.createElement(M$,{predicate:this.bindFn(this.showCursor)},()=>Up.createElement("div",{class:Up.const("dcg-geo-keyboard-cursor"),style:()=>({top:`${this.getPosition().y}px`,left:`${this.getPosition().x}px`})}))}getPosition(){let e=this.poiController.getGeoKeyboardPt(),t=this.props.grapher().getProjection();return{x:t.mapx(e.x),y:t.mapy(e.y)}}showCursor(){return this.controller.isVirtualMouseAllowed()}};var Xf,bt,tw,kM,SM;function rs(r,e){var t=Object.keys(e),i;for(i=0;i<t.length;i++)r=r.replace(new RegExp("\\{"+t[i]+"\\}","gi"),e[t[i]]);return r}function Hk(r){var e,t,i;if(!r)throw new Error("cannot create a random attribute name for an undefined object");e="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",t="";do for(t="",i=0;i<12;i++)t+=e[Math.floor(Math.random()*e.length)];while(r[t]);return t}function A$(r,e){var t,i,o={},n,a;for(r=r.split(","),e=e||10,t=0;t<r.length;t+=2)i="&"+r[t+1]+";",n=parseInt(r[t],e),o[i]="&#"+n+";";return o["\\xa0"]="&#160;",o}function L$(r){var e={left:"start",right:"end",center:"middle",start:"start",end:"end"};return e[r]||e.start}SM=A$("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);Xf={strokeStyle:{svgAttr:"stroke",canvas:"#000000",svg:"none",apply:"stroke"},fillStyle:{svgAttr:"fill",canvas:"#000000",svg:null,apply:"fill"},lineCap:{svgAttr:"stroke-linecap",canvas:"butt",svg:"butt",apply:"stroke"},lineJoin:{svgAttr:"stroke-linejoin",canvas:"miter",svg:"miter",apply:"stroke"},miterLimit:{svgAttr:"stroke-miterlimit",canvas:10,svg:4,apply:"stroke"},lineWidth:{svgAttr:"stroke-width",canvas:1,svg:1,apply:"stroke"},globalAlpha:{svgAttr:"opacity",canvas:1,svg:1,apply:"fill stroke"},font:{canvas:"10px sans-serif"},shadowColor:{canvas:"#000000"},shadowOffsetX:{canvas:0},shadowOffsetY:{canvas:0},shadowBlur:{canvas:0},textAlign:{canvas:"start"},textBaseline:{canvas:"alphabetic"},lineDash:{svgAttr:"stroke-dasharray",canvas:[],svg:null,apply:"stroke"}};tw=function(r,e){this.__root=r,this.__ctx=e};tw.prototype.addColorStop=function(r,e){var t=this.__ctx.__createElement("stop"),i,o;t.setAttribute("offset",r),e.indexOf("rgba")!==-1?(i=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi,o=i.exec(e),t.setAttribute("stop-color",rs("rgb({r},{g},{b})",{r:o[1],g:o[2],b:o[3]})),t.setAttribute("stop-opacity",o[4])):t.setAttribute("stop-color",e),this.__root.appendChild(t)};kM=function(r,e){this.__root=r,this.__ctx=e};bt=function(r){var e={width:500,height:500,enableMirroring:!1},t;if(arguments.length>1?(t=e,t.width=arguments[0],t.height=arguments[1]):r?t=r:t=e,!(this instanceof bt))return new bt(t);this._randomPostfix="-"+function(){return"xxxxxxxx".replace(/x/g,function(o){return(Math.random()*16|0).toString(16)})}(),this._svgClassNames=[],this.width=t.width||e.width,this.height=t.height||e.height,this.enableMirroring=t.enableMirroring!==void 0?t.enableMirroring:e.enableMirroring,this.canvas=this,this.__document=t.document||document,t.ctx?this.__ctx=t.ctx:(this.__canvas=this.__document.createElement("canvas"),this.__ctx=this.__canvas.getContext("2d")),this.__setDefaultStyles(),this.__stack=[this.__getStyleState()],this.__groupStack=[],this.__root=this.__document.createElementNS("http://www.w3.org/2000/svg","svg"),this.__root.setAttribute("version",1.1),this.__root.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.__root.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this.__root.setAttribute("width",this.width),this.__root.setAttribute("height",this.height),this.__ids={},this.__defs=this.__document.createElementNS("http://www.w3.org/2000/svg","defs"),this.__root.appendChild(this.__defs),this.__currentElement=this.__document.createElementNS("http://www.w3.org/2000/svg","g"),this.__root.appendChild(this.__currentElement)};bt.prototype.__createElement=function(r,e,t){typeof e=="undefined"&&(e={});var i=this.__document.createElementNS("http://www.w3.org/2000/svg",r),o=Object.keys(e),n,a;for(t&&(i.setAttribute("fill","none"),i.setAttribute("stroke","none")),n=0;n<o.length;n++)a=o[n],i.setAttribute(a,e[a]);var s=this._svgClassNames&&this._svgClassNames[this._svgClassNames.length-1];return s&&i.setAttribute("class",s),i};bt.prototype.__setDefaultStyles=function(){var r=Object.keys(Xf),e,t;for(e=0;e<r.length;e++)t=r[e],this[t]=Xf[t].canvas};bt.prototype.__applyStyleState=function(r){var e=Object.keys(r),t,i;for(t=0;t<e.length;t++)i=e[t],this[i]=r[i]};bt.prototype.__getStyleState=function(){var r,e={},t=Object.keys(Xf),i;for(r=0;r<t.length;r++)i=t[r],e[i]=this[i];return e};bt.prototype.__applyStyleToCurrentElement=function(r){var e=this.__currentElement,t=this.__currentElementsToStyle;t&&(e.setAttribute(r,""),e=t.element,t.children.forEach(function(h){h.setAttribute(r,"")}));var i=Object.keys(Xf),o,n,a,s,l,c;for(o=0;o<i.length;o++)if(n=Xf[i[o]],a=this[i[o]],n.apply){if(a instanceof kM){if(a.__ctx)for(;a.__ctx.__defs.childNodes.length;)s=a.__ctx.__defs.childNodes[0].getAttribute("id"),this.__ids[s]=s,this.__defs.appendChild(a.__ctx.__defs.childNodes[0]);e.setAttribute(n.apply,rs("url(#{id})",{id:a.__root.getAttribute("id")}))}else if(a instanceof tw)e.setAttribute(n.apply,rs("url(#{id})",{id:a.__root.getAttribute("id")}));else if(n.apply.indexOf(r)!==-1&&n.svg!==a)if((n.svgAttr==="stroke"||n.svgAttr==="fill")&&a.indexOf("rgba")!==-1){l=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi,c=l.exec(a),e.setAttribute(n.svgAttr,rs("rgb({r},{g},{b})",{r:c[1],g:c[2],b:c[3]}));var p=c[4],u=this.globalAlpha;u!=null&&(p*=u),e.setAttribute(n.svgAttr+"-opacity",p)}else{var m=n.svgAttr;if(i[o]==="globalAlpha"&&(m=r+"-"+n.svgAttr,e.getAttribute(m)))continue;e.setAttribute(m,a)}}};bt.prototype.__closestGroupOrSvg=function(r){return r=r||this.__currentElement,r.nodeName==="g"||r.nodeName==="svg"?r:this.__closestGroupOrSvg(r.parentNode)};bt.prototype.getSerializedSvg=function(r){var e=new XMLSerializer().serializeToString(this.__root),t,i,o,n,a,s;if(s=/xmlns="http:\/\/www\.w3\.org\/2000\/svg".+xmlns="http:\/\/www\.w3\.org\/2000\/svg/gi,s.test(e)&&(e=e.replace('xmlns="http://www.w3.org/2000/svg','xmlns:xlink="http://www.w3.org/1999/xlink')),r)for(t=Object.keys(SM),i=0;i<t.length;i++)o=t[i],n=SM[o],a=new RegExp(o,"gi"),a.test(e)&&(e=e.replace(a,n));return e};bt.prototype.getSvg=function(){return this.__root};bt.prototype._dcgStartNamedGroup=function(r){var e=this.__createElement("g");e.setAttribute("id",r+this._randomPostfix);var t=this.__closestGroupOrSvg();this.__groupStack.push(t),t.appendChild(e),this.__currentElement=e};bt.prototype._dcgEndNamedGroup=function(){this.__currentElement=this.__groupStack.pop(),this.__currentElement||(this.__currentElement=this.__root.childNodes[1])};bt.prototype._dcgSaveClassName=function(r){this._svgClassNames.push(r),this.__currentElement&&this.__currentElement.tagName==="path"&&!this.__currentDefaultPath&&(this.__currentElement.getAttribute("class")||this.__currentElement.setAttribute("class",r))};bt.prototype._dcgRestoreClassName=function(){this._svgClassNames.pop()};bt.prototype.save=function(){var r=this.__createElement("g"),e=this.__closestGroupOrSvg();this.__groupStack.push(e),e.appendChild(r),this.__currentElement=r,this.__stack.push(this.__getStyleState())};bt.prototype.restore=function(){this.__currentElement=this.__groupStack.pop(),this.__currentElementsToStyle=null,this.__currentElement||(this.__currentElement=this.__root.childNodes[1]);var r=this.__stack.pop();this.__applyStyleState(r)};bt.prototype.__addTransform=function(r){var e=this.__closestGroupOrSvg();if(e.childNodes.length>0){this.__currentElement.nodeName==="path"&&(this.__currentElementsToStyle||(this.__currentElementsToStyle={element:e,children:[]}),this.__currentElementsToStyle.children.push(this.__currentElement),this.__applyCurrentDefaultPath());var t=this.__createElement("g");e.appendChild(t),this.__currentElement=t}var i=this.__currentElement.getAttribute("transform");i?i+=" ":i="",i+=r,this.__currentElement.setAttribute("transform",i)};bt.prototype.scale=function(r,e){e===void 0&&(e=r),this.__addTransform(rs("scale({x},{y})",{x:r,y:e}))};bt.prototype.rotate=function(r){var e=r*180/Math.PI;this.__addTransform(rs("rotate({angle},{cx},{cy})",{angle:e,cx:0,cy:0}))};bt.prototype.translate=function(r,e){this.__addTransform(rs("translate({x},{y})",{x:r,y:e}))};bt.prototype.transform=function(r,e,t,i,o,n){this.__addTransform(rs("matrix({a},{b},{c},{d},{e},{f})",{a:r,b:e,c:t,d:i,e:o,f:n}))};bt.prototype.beginPath=function(){var r,e;this.__currentDefaultPath="",this.__currentPosition={},r=this.__createElement("path",{},!0),e=this.__closestGroupOrSvg(),e.appendChild(r),this.__currentElement=r};bt.prototype.__applyCurrentDefaultPath=function(){var r=this.__currentElement;r.nodeName==="path"?r.setAttribute("d",this.__currentDefaultPath):console.error("Attempted to apply path command to node",r.nodeName)};bt.prototype.__addPathCommand=function(r){this.__currentDefaultPath+=" ",this.__currentDefaultPath+=r};bt.prototype.moveTo=function(r,e){this.__currentElement.nodeName!=="path"&&this.beginPath(),this.__currentPosition={x:r,y:e},this.__addPathCommand(rs("M {x} {y}",{x:r,y:e}))};bt.prototype.closePath=function(){this.__currentDefaultPath&&this.__addPathCommand("Z")};bt.prototype.lineTo=function(r,e){this.__currentPosition={x:r,y:e},this.__currentDefaultPath.indexOf("M")>-1?this.__addPathCommand(rs("L {x} {y}",{x:r,y:e})):this.__addPathCommand(rs("M {x} {y}",{x:r,y:e}))};bt.prototype.bezierCurveTo=function(r,e,t,i,o,n){this.__currentPosition={x:o,y:n},this.__addPathCommand(rs("C {cp1x} {cp1y} {cp2x} {cp2y} {x} {y}",{cp1x:r,cp1y:e,cp2x:t,cp2y:i,x:o,y:n}))};bt.prototype.quadraticCurveTo=function(r,e,t,i){this.__currentPosition={x:t,y:i},this.__addPathCommand(rs("Q {cpx} {cpy} {x} {y}",{cpx:r,cpy:e,x:t,y:i}))};var DM=function(r){var e=Math.sqrt(r[0]*r[0]+r[1]*r[1]);return[r[0]/e,r[1]/e]};bt.prototype.arcTo=function(r,e,t,i,o){var n=this.__currentPosition&&this.__currentPosition.x,a=this.__currentPosition&&this.__currentPosition.y;if(!(typeof n=="undefined"||typeof a=="undefined")){if(o<0)throw new Error("IndexSizeError: The radius provided ("+o+") is negative.");if(n===r&&a===e||r===t&&e===i||o===0){this.lineTo(r,e);return}var s=DM([n-r,a-e]),l=DM([t-r,i-e]);if(s[0]*l[1]===s[1]*l[0]){this.lineTo(r,e);return}var c=s[0]*l[0]+s[1]*l[1],p=Math.acos(Math.abs(c)),u=DM([s[0]+l[0],s[1]+l[1]]),m=o/Math.sin(p/2),h=r+m*u[0],x=e+m*u[1],C=[-s[1],s[0]],D=[l[1],-l[0]],k=function(S){var V=S[0],P=S[1];return P>=0?Math.acos(V):-Math.acos(V)},M=k(C),I=k(D);this.lineTo(h+C[0]*o,x+C[1]*o),this.arc(h,x,o,M,I)}};bt.prototype.stroke=function(){this.__currentElement.nodeName==="path"&&this.__currentElement.setAttribute("paint-order","fill stroke markers"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("stroke")};bt.prototype.fill=function(){this.__currentElement.nodeName==="path"&&this.__currentElement.setAttribute("paint-order","stroke fill markers"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("fill")};bt.prototype.rect=function(r,e,t,i){this.__currentElement.nodeName!=="path"&&this.beginPath(),this.moveTo(r,e),this.lineTo(r+t,e),this.lineTo(r+t,e+i),this.lineTo(r,e+i),this.lineTo(r,e),this.closePath()};bt.prototype.fillRect=function(r,e,t,i){var o,n;o=this.__createElement("rect",{x:r,y:e,width:t,height:i},!0),n=this.__closestGroupOrSvg(),n.appendChild(o),this.__currentElement=o,this.__applyStyleToCurrentElement("fill")};bt.prototype.strokeRect=function(r,e,t,i){var o,n;o=this.__createElement("rect",{x:r,y:e,width:t,height:i},!0),n=this.__closestGroupOrSvg(),n.appendChild(o),this.__currentElement=o,this.__applyStyleToCurrentElement("stroke")};bt.prototype.__clearCanvas=function(){for(var r=this.__closestGroupOrSvg(),e=r.getAttribute("transform"),t=this.__root.childNodes[1],i=t.childNodes,o=i.length-1;o>=0;o--)i[o]&&t.removeChild(i[o]);this.__currentElement=t,this.__groupStack=[],e&&this.__addTransform(e)};bt.prototype.clearRect=function(r,e,t,i){if(r===0&&e===0&&t===this.width&&i===this.height){this.__clearCanvas();return}var o,n=this.__closestGroupOrSvg();o=this.__createElement("rect",{x:r,y:e,width:t,height:i,fill:"#FFFFFF"},!0),n.appendChild(o)};bt.prototype.createLinearGradient=function(r,e,t,i){var o=this.__createElement("linearGradient",{id:Hk(this.__ids),x1:r+"px",x2:t+"px",y1:e+"px",y2:i+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(o),new tw(o,this)};bt.prototype.createRadialGradient=function(r,e,t,i,o,n){var a=this.__createElement("radialGradient",{id:Hk(this.__ids),cx:i+"px",cy:o+"px",r:n+"px",fx:r+"px",fy:e+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(a),new tw(a,this)};bt.prototype.__parseFont=function(){var r=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-,\'\"\sa-z0-9]+?)\s*$/i,e=r.exec(this.font),t={style:e[1]||"normal",size:e[4]||"10px",family:e[6]||"sans-serif",weight:e[3]||"normal",decoration:e[2]||"normal",href:null};return this.__fontUnderline==="underline"&&(t.decoration="underline"),this.__fontHref&&(t.href=this.__fontHref),t};bt.prototype.__wrapTextLink=function(r,e){if(r.href){var t=this.__createElement("a");return t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r.href),t.appendChild(e),t}return e};bt.prototype.__applyText=function(r,e,t,i){var o=this.__parseFont(),n=this.__closestGroupOrSvg(),a=this.__createElement("text",{"font-family":o.family,"font-size":o.size,"font-style":o.style,"font-weight":o.weight,"text-decoration":o.decoration,x:e,y:t,"text-anchor":L$(this.textAlign)},!0);a.appendChild(this.__document.createTextNode(r)),this.__currentElement=a,this.__applyStyleToCurrentElement(i),n.appendChild(this.__wrapTextLink(o,a))};bt.prototype.fillText=function(r,e,t){this.__applyText(r,e,t,"fill")};bt.prototype.strokeText=function(r,e,t){this.__applyText(r,e,t,"stroke")};bt.prototype.measureText=function(r){return this.__ctx.font=this.font,this.__ctx.measureText(r)};bt.prototype.arc=function(r,e,t,i,o,n){if(i!==o){i=i%(2*Math.PI),o=o%(2*Math.PI),i===o&&(o=(o+2*Math.PI-.001*(n?-1:1))%(2*Math.PI));var a=r+t*Math.cos(o),s=e+t*Math.sin(o),l=r+t*Math.cos(i),c=e+t*Math.sin(i),p=n?0:1,u=0,m=o-i;m<0&&(m+=2*Math.PI),n?u=m>Math.PI?0:1:u=m>Math.PI?1:0,this.lineTo(l,c),this.__addPathCommand(rs("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}",{rx:t,ry:t,xAxisRotation:0,largeArcFlag:u,sweepFlag:p,endX:a,endY:s})),this.__currentPosition={x:a,y:s}}};bt.prototype.clip=function(){var r=this.__closestGroupOrSvg(),e=this.__createElement("clipPath"),t=Hk(this.__ids),i=this.__createElement("g");this.__applyCurrentDefaultPath(),r.removeChild(this.__currentElement),e.setAttribute("id",t),e.appendChild(this.__currentElement),this.__defs.appendChild(e),r.setAttribute("clip-path",rs("url(#{id})",{id:t})),r.appendChild(i),this.__currentElement=i};bt.prototype.drawImage=function(){var r=Array.prototype.slice.call(arguments),e=r[0],t,i,o,n,a=0,s=0,l,c,p,u,m,h,x,C,D,k,M;if(r.length===3)t=r[1],i=r[2],l=e.width,c=e.height,o=l,n=c;else if(r.length===5)t=r[1],i=r[2],o=r[3],n=r[4],l=e.width,c=e.height;else if(r.length===9)a=r[1],s=r[2],l=r[3],c=r[4],t=r[5],i=r[6],o=r[7],n=r[8];else throw new Error("Invalid number of arguments passed to drawImage: "+arguments.length);p=this.__closestGroupOrSvg(),x=this.__currentElement;var I="translate("+t+", "+i+")";if(e instanceof bt){if(u=e.getSvg().cloneNode(!0),u.childNodes&&u.childNodes.length>1){for(m=u.childNodes[0];m.childNodes.length;)M=m.childNodes[0].getAttribute("id"),this.__ids[M]=M,this.__defs.appendChild(m.childNodes[0]);if(h=u.childNodes[1],h){var S=h.getAttribute("transform"),V;S?V=S+" "+I:V=I,h.setAttribute("transform",V),p.appendChild(h)}}}else(e.nodeName==="CANVAS"||e.nodeName==="IMG")&&(C=this.__createElement("image"),C.setAttribute("width",o),C.setAttribute("height",n),C.setAttribute("opacity",this.globalAlpha),C.setAttribute("preserveAspectRatio","none"),(a||s||l!==e.width||c!==e.height)&&(D=this.__document.createElement("canvas"),D.width=o,D.height=n,k=D.getContext("2d"),k.drawImage(e,a,s,l,c,0,0,o,n),e=D),C.setAttribute("transform",I),C.setAttribute("xlink:href",e.nodeName==="CANVAS"?e.toDataURL():e.getAttribute("src")),p.appendChild(C))};bt.prototype.createPattern=function(r,e){var t=this.__document.createElementNS("http://www.w3.org/2000/svg","pattern"),i=Hk(this.__ids),o;return t.setAttribute("id",i),t.setAttribute("width",r.width),t.setAttribute("height",r.height),r.nodeName==="CANVAS"||r.nodeName==="IMG"?(o=this.__document.createElementNS("http://www.w3.org/2000/svg","image"),o.setAttribute("width",r.width),o.setAttribute("height",r.height),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r.nodeName==="CANVAS"?r.toDataURL():r.getAttribute("src")),t.appendChild(o),this.__defs.appendChild(t)):r instanceof bt&&(t.appendChild(r.__root.childNodes[1]),this.__defs.appendChild(t)),new kM(t,this)};bt.prototype.setLineDash=function(r){r&&r.length>0?this.lineDash=r.join(","):this.lineDash=null};bt.prototype.ellipse=function(r,e,t,i,o,n,a,s){if(n!==a){n=n%(2*Math.PI),a=a%(2*Math.PI),n===a&&(a=(a+2*Math.PI-.001*(s?-1:1))%(2*Math.PI));var l=r+Math.cos(-o)*t*Math.cos(a)+Math.sin(-o)*i*Math.sin(a),c=e-Math.sin(-o)*t*Math.cos(a)+Math.cos(-o)*i*Math.sin(a),p=r+Math.cos(-o)*t*Math.cos(n)+Math.sin(-o)*i*Math.sin(n),u=e-Math.sin(-o)*t*Math.cos(n)+Math.cos(-o)*i*Math.sin(n),m=s?0:1,h=0,x=a-n;x<0&&(x+=2*Math.PI),s?h=x>Math.PI?0:1:h=x>Math.PI?1:0,this.lineTo(p,u),this.__addPathCommand(rs("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}",{rx:t,ry:i,xAxisRotation:o*(180/Math.PI),largeArcFlag:h,sweepFlag:m,endX:l,endY:c})),this.__currentPosition={x:l,y:c}}};bt.prototype._dcgSetTitle=function(r){var e=this.__currentElement,t=!1,i,o=e.getElementsByTagName("title");o.length>0?i=o[0]:(i=this.__document.createElementNS("http://www.w3.org/2000/svg","title"),t=!0),i.textContent=r,t&&e.appendChild(i)};bt.prototype.drawFocusRing=function(){};bt.prototype.createImageData=function(){};bt.prototype.getImageData=function(){};bt.prototype.putImageData=function(){};bt.prototype.globalCompositeOperation=function(){};bt.prototype.setTransform=function(){};var dB=bt;xt();var Hp=document.createElement("canvas").getContext("2d"),js=class r{constructor(e,t){this._label=e,this._fontSize=t,this._layout=O$(e,t)}getRect(){return this.getRectWhenCenteredAt({x:0,y:0})}getRectWhenCenteredAt(e){return{left:this._layout.left+e.x,right:this._layout.right+e.x,top:this._layout.top+e.y,bottom:this._layout.bottom+e.y}}getBoundsWhenCenteredAt(e,t){switch(t){case"x":return{lower:this._layout.left+e,upper:this._layout.right+e};case"y":return{lower:this._layout.top+e,upper:this._layout.bottom+e};default:let i=t;throw new Error(`Unknown axis: ${i}`)}}getWidth(){return this._layout.right-this._layout.left}getHeight(){return this._layout.bottom-this._layout.top}getDimensionAlongAxis(e){switch(e){case"x":return this.getWidth();case"y":return this.getHeight();default:let t=e;throw new Error(`Unknown axis: ${t}`)}}clampBoundsWithinRect(e,t){let i,o;return e.x+this._layout.left<t.left?i=t.left-this._layout.left:e.x+this._layout.right>t.right?i=t.right-this._layout.right:i=e.x,e.y+this._layout.top<t.top?o=t.top-this._layout.top:e.y+this._layout.bottom>t.bottom?o=t.bottom-this._layout.bottom:o=e.y,{x:i,y:o}}getValue(){return this._label.value}getMinusWidth(){return this.getValue()<0?(r.setCtxFontSize(Hp,this._fontSize),Hp.measureText("-1").width-Hp.measureText("1").width):0}getString(){return this._label.superscript?this._label.mantissa+"^"+this._label.superscript:this._label.string}drawCenteredAt(e,t,i){let o=t.x,n=r.computeBaselineFromCenter(t.y,this._fontSize);i&&Qi(e,i),e.save(),i&&Oi(e),r.setCtxFontSize(e,this._fontSize),this._label.superscript?(e.strokeText(this._label.mantissa,this._layout.mantissa_x+o,this._layout.mantissa_y+n),e.strokeText(this._label.superscript,this._layout.superscript_x+o,this._layout.superscript_y+n),e.fillText(this._label.mantissa,this._layout.mantissa_x+o,this._layout.mantissa_y+n),e.fillText(this._label.superscript,this._layout.superscript_x+o,this._layout.superscript_y+n)):(e.strokeText(this._label.string,this._layout.mantissa_x+o,this._layout.mantissa_y+n),e.fillText(this._label.string,this._layout.mantissa_x+o,this._layout.mantissa_y+n)),e.restore()}static computeBaselineFromCenter(e,t){return e+.272*t}static setCtxFontSize(e,t){e.font=t+"px Arial",e.textAlign="center"}};function O$(r,e){if(r.superscript){let t=e;js.setCtxFontSize(Hp,t);let i=Hp.measureText(r.mantissa).width,o=Math.round(.8*e);js.setCtxFontSize(Hp,o);let n=Hp.measureText(r.superscript).width,a=0,s=e/5,l=i/2+n/2,c=-e/4,p=c-o/2,u=s+t/2,m=a-i/2,h=l+n/2;return{top:p,bottom:u,left:m,right:h,mantissa_height:t,mantissa_width:i,mantissa_x:a,mantissa_y:s,superscript_height:o,superscript_width:n,superscript_x:l,superscript_y:c}}else{let t=e;js.setCtxFontSize(Hp,e);let i=Hp.measureText(r.string).width,o=0,n=0,a=n-t/2,s=n+t/2,l=o-i/2,c=o+i/2;return{top:a,bottom:s,left:l,right:c,mantissa_height:t,mantissa_width:i,mantissa_x:o,mantissa_y:n}}}function P$(r,e,t,i){let o=Math.ceil(r/t),n=Math.floor(e/t),a=1/t;if(!(o>n)&&!(n-o>1e4))for(let s=o;s<=n;s++)i(s/a)}var EM={base:10,major:[1,2,5],minor:[5,4,5]},_$={base:10,major:[Math.PI,2*Math.PI,5*Math.PI],minor:[4,4,5]},F$={base:2,major:[Math.PI/3],minor:[3]};function R$(r){return r?{base:10,major:[r,2*r,5*r],minor:[4,4,5]}:EM}function GM(r,e){let{major:t,minor:i,base:o}=e,n=1/0,a=1/0;for(let s=0;s<t.length;s++){let l=t[s],c=Math.ceil(Math.log(r/l)/Math.log(o)),p=l*Math.pow(o,c);if(p<n){n=p;let u=i[s];a=n/u}}return{major:n,minor:a}}function N$(r,e,t){return 1+(e-r)/t}function pB(r){let e=r.screen.width,t=r.screen.height,i=r.viewport.xmax-r.viewport.xmin,o=r.viewport.ymax-r.viewport.ymin,n=r.settings.pixelsPerLabel;return{majorStepX:n/e*i,majorStepY:n/t*o}}function rh(r){let e=l=>{let[c,p,u,m,h]=l==="x"?[r.viewport.xmin,r.viewport.xmax,r.settings.xAxisStep,r.settings.xAxisNumbers,r.settings.xAxisMinorSubdivisions]:[r.viewport.ymin,r.viewport.ymax,r.settings.yAxisStep,r.settings.yAxisNumbers,r.settings.yAxisMinorSubdivisions],x=p-c,C=Math.abs(u!=null?u:NaN),D=0,k=0;if(C&&C!==Math.PI){let M=N$(c,p,C);if(M>=3&&M<100){let I=0;if(m){let V=0;P$(c,p,C,function(P){let L=new js(__dcg_shared_module_exports__['bb'](P,x),r.settings.labelSize);V=Math.max(L.getDimensionAlongAxis(l),V)}),I=V+10}else I=h===1?8:20;let S=l==="x"?"width":"height";M*I<=r.screen[S]&&(D=C,C===3||C===5?k=1:k=C/4)}}if(!D){let M=pB(r)[l==="x"?"majorStepX":"majorStepY"],I=GM(M,__dcg_shared_module_exports__['bb'](C,x).string.indexOf("\u03C0")>=0?M>=1?_$:F$:R$(C));D=I.major,k=I.minor}return{majorStep:D,minorStep:k}},t=()=>{var l,c;if(Math.abs((l=r.settings.xAxisStep)!=null?l:NaN)===Math.abs((c=r.settings.yAxisStep)!=null?c:NaN)){let{xmin:m,xmax:h,ymin:x,ymax:C}=r.viewport,D=r.screen.width/(h-m),k=r.screen.height/(C-x),M=D/k,I=.01;if(M>=1-I&&M<=2){let{majorStep:S,minorStep:V}=e("y");return{x:{majorStep:S,minorStep:V},y:{majorStep:S,minorStep:V}}}if(M<=1-I&&M>=.5){let{majorStep:S,minorStep:V}=e("x");return{x:{majorStep:S,minorStep:V},y:{majorStep:S,minorStep:V}}}}return{x:e("x"),y:e("y")}},i=()=>{let{xAxisScale:l,yAxisScale:c}=r.settings,p=l==="logarithmic",u=c==="logarithmic";return!p&&!u?t():{x:p?{majorStep:NaN,minorStep:NaN}:e("x"),y:u?{majorStep:NaN,minorStep:NaN}:e("y")}},{x:o,y:n}=i(),{xAxisMinorSubdivisions:a=0,yAxisMinorSubdivisions:s=0}=r.settings;return{majorStepX:o.majorStep,minorStepX:a>0?o.majorStep/a:o.minorStep,majorStepY:n.majorStep,minorStepY:s>0?n.majorStep/s:n.minorStep}}function uB(r){let e=pB(r),t=GM(e.majorStepX,EM),i=GM(e.majorStepY,EM),o=t.major>i.major?t:i;return{majorStepR:o.major,minorStepR:o.minor}}xt();function Kr(){document.activeElement&&tg(document.activeElement)&&H(document.activeElement).trigger("blur")}Lp();var Wk=class{constructor(e,t){this.cb=e;this.document=t;this.observedAriaLiveElements=new WeakMap;this.destroyed=!1;this.onAriaLabelFocus=e=>{let t=e.target;if(this.isElement(t)){let i=t.getAttribute("aria-label");i&&this.cb(i,"label")}};this.document.documentElement.addEventListener("focus",this.onAriaLabelFocus,!0),this.ariaLiveContentObserver=new MutationObserver(i=>this.handleAriaLiveContentMutations(i)),t.documentElement.querySelectorAll('[aria-live="assertive"]').forEach(i=>this.startObservingAriaLiveElement(i)),this.treeObserver=new MutationObserver(i=>this.handleDocumentTreeMutations(i)),this.treeObserver.observe(t.documentElement,{childList:!0,subtree:!0,attributeFilter:["aria-live"]})}destroy(){this.destroyed=!0,this.document.documentElement.removeEventListener("focus",this.onAriaLabelFocus,!0),this.ariaLiveContentObserver.disconnect()}isObservingElement(e){return!!this.observedAriaLiveElements.get(e)}handleAriaLiveContentMutations(e){var i;let t=new Map;for(let o of e){if(!this.observedAriaLiveElements.get(o.target))continue;let n=t.get(o.target);n||(n=[],t.set(o.target,n)),n.push(o)}for(let[o,n]of t){let a=o.cloneNode(!0),s=[a.textContent||""];for(let l=n.length-1;l>=0;l--){let c=n[l];switch(c.type){case"attributes":{c.attributeName!==null&&a.setAttribute(c.attributeName,c.oldValue||""),s.push(a.textContent||"");break}case"characterData":{c.oldValue!==null&&(a.textContent=c.oldValue),a.textContent&&a.textContent!==s[s.length-1]&&s.push(a.textContent);break}case"childList":{if(c.addedNodes.length>1||c.removedNodes.length>1)throw new Error(`Expected at most one removed node and one added node, but got ${c.removedNodes.length} removed nodes and ${c.addedNodes.length} added nodes`);c.addedNodes.length===1&&((i=a.firstChild)==null||i.remove()),c.removedNodes.length===1&&c.removedNodes.forEach(p=>a.appendChild(p.cloneNode(!0))),a.textContent&&a.textContent!==s[s.length-1]&&s.push(a.textContent);break}}}for(let l of s.reverse())this.cb(l,"alert")}}startObservingAriaLiveElement(e){this.destroyed||e.getAttribute("aria-live")==="assertive"&&(this.observedAriaLiveElements.get(e)||(this.observedAriaLiveElements.set(e,!0),e.textContent&&this.cb(e.textContent,"alert"),this.ariaLiveContentObserver.observe(e,{attributes:!0,characterData:!0,childList:!0,attributeOldValue:!0,characterDataOldValue:!0})))}stopObservingAriaLiveElement(e){this.observedAriaLiveElements.set(e,!1)}handleDocumentTreeMutations(e){for(let t of e)t.addedNodes.forEach(i=>{this.isElement(i)&&i.getAttribute("aria-live")==="assertive"&&this.startObservingAriaLiveElement(i)}),this.isElement(t.target)&&t.attributeName==="aria-live"&&(t.target.getAttribute("aria-live")==="assertive"?this.startObservingAriaLiveElement(t.target):this.stopObservingAriaLiveElement(t.target)),t.removedNodes.forEach(i=>{this.isElement(i)&&(this.stopObservingAriaLiveElement(i),i.querySelectorAll('[aria-live="assertive"]').forEach(o=>this.stopObservingAriaLiveElement(o)))})}isElement(e){var i;let t=(i=this.document.defaultView)==null?void 0:i.Element;return t?e instanceof t:!1}};var Bd,$k=[],hB="",B$;function tn(){Bd&&(Bd.textContent="")}function At(r){$k.push(r)}function be(r){if(r!==void 0&&At(r),Bd&&$k.length>0){let e=$k.join(" ").replace(/ +(?= )/g,"");Bd.setAttribute("aria-relevant",hB===e&&oi?"all":"additions text"),Bd.textContent=e,hB=e}$k.length=0}function q$(){Bd=document.createElement("p"),Bd.setAttribute("aria-live","assertive"),Bd.setAttribute("aria-atomic","true"),Bd.classList.add("dcg-aria-alert"),document.body.appendChild(Bd),Da().logAria&&(B$=new Wk((e,t)=>__dcg_shared_module_exports__['rd'].log(`[aria ${t}] ${e}`),document))}FD(q$);var uue=__dcg_shared_module_exports__['h'](gB());xt();var mB=["exp|exponent ln|natural-log log","total length count mean median quantile quartile nCr nPr stats","stdev|standard-deviation stddev|standard-deviation","stdDev|standard-deviation stdevp|standard-deviation-population","stddevp|standard-deviation-population stdDevP|standard-deviation-population mad var|variance","varp|variance-population variance cov|co-variance covp|co-variance-population corr|correlation spearman","lcm mcm gcd mcd gcf mod ceil|ceiling floor round abs|absolute-value min max sign|signum signum sgn","sin|sine cos|cosine tan|tangent csc|co-secant sec|secant cot|co-tangent","sinh|hyperbolic-sine cosh|hyperbolic-cosine tanh|hyperbolic-tangent csch|hyperbolic-co-secant","sech|hyperbolic-secant coth|hyperbolic-co-tangent","arcsin|arc-sine arccos|arc-cosine arctan|arc-tangent arccsc|arc-co-secant arcsec|arc-secant","arccot|arc-co-tangent","arcsinh|hyperbolic-arc-sine arccosh|hyperbolic-arc-cosine arctanh|hyperbolic-arc-co-tangent","arccsch|hyperbolic-arc-co-secant arcsech|hyperbolic-arc-secant","arccoth|hyperbolic-arc-co-tangent","arsinh|hyperbolic-ar-sine arcosh|hyperbolic-ar-cosine artanh|hyperbolic-ar-co-tangent","arcsch|hyperbolic-ar-co-secant arsech|hyperbolic-ar-secant","arcoth|hyperbolic-ar-co-tangent","polygon","distance midpoint","sort shuffle join unique","erf|error-function","TTest|t-test ttest|t-test TScore|t-score tscore|t-score","iTTest|independent-t-test ittest|independent-t-test IndependentTTest","TScore|t-score Tscore|t-score tscore|t-score","normaldist|normal-distribution tdist|t-distribution poissondist|poisson-distribution","binomialdist|binomial-distribution","uniformdist|uniform-distribution","pdf cdf random inverseCdf inversecdf","histogram dotplot boxplot","pdf cdf","rgb hsv","for","width height","with"].join(" "),K$=["det|determinant","inv|inverse","transpose","rref|reduced-row-echelon-form","trace"].join(" ");mB+=" "+K$;var z$="alpha beta sqrt theta phi pi tau nthroot cbrt sum prod integral percent infinity infty cross";function qd(r){r||(r={});let e=[z$];return r.disallowAns||e.push("ans"),r.disallowFrac||e.push("frac"),r.additionalCommands&&(e=e.concat(r.additionalCommands)),e.join(" ")}function Ys(r){r||(r={});let e=mB;return r.additionalOperators&&r.additionalOperators.length&&(e=`${e} ${r.additionalOperators.join(" ")}`),r.includeGeometryFunctions&&(e+=" "+Object.keys(__dcg_shared_module_exports__['sd']).join(" ")),r.include3DFunctions&&(e+=" "+Object.keys(__dcg_shared_module_exports__['td']).join(" ")),e}var fB=window.MathQuill.noConflict().getInterface(3);fB.config({leftRightIntoCmdGoes:"up",sumStartsWithNEquals:!0,supSubsRequireOperand:!0,charsThatBreakOutOfSupSub:"+-=<>*",autoCommands:qd(),autoSubscriptNumerals:!0,restrictMismatchedBrackets:!0,typingPercentWritesPercentOf:!0,substituteTextarea:function(){if(!_D&&(Iu||Vu)){let e=document.createElement("span");return e.classList.add("dcg-mathquill-input-span"),e.setAttribute("tabindex","0"),e.setAttribute("role","textbox"),oa(e,{display:"inline-block",height:"1px",width:"1px"}),e}if(d_&&p_){let e=document.createElement("textarea");return e.setAttribute("readonly",""),e.setAttribute("inputmode","none"),e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","none"),e.setAttribute("spellcheck","false"),e.setAttribute("autocomplete","off"),H(e).on("keydown",function(){this.readOnly=!1,this.select()}).on("blur",function(){this.readOnly=!0}),e}let r=document.createElement("textarea");return r.setAttribute("inputmode","none"),r.setAttribute("autocorrect","off"),r.setAttribute("autocapitalize","none"),r.setAttribute("spellcheck","false"),r.setAttribute("autocomplete","off"),r},autoOperatorNames:Ys(),quietEmptyDelimiters:"( [",resetCursorOnBlur:!0,enableDigitGrouping:!0,disableAutoSubstitutionInSubscripts:!0,interpretTildeAsSim:!0});var Zl=fB;var H$=/`[^`]*`/g,W$=/^[\+\-]?[\d]*(\.\d+)?$/,$$=r=>{if(r!=null){let e=r.match(/`/g);return(e!=null&&e.length||0)%2==0}return!0},j$=r=>{let e=[];if(r==null||r.length==0)return e;let t=0,i;for(;i=H$.exec(r);){let n=r.slice(t,i.index);n.length>0&&e.push({from:t,to:i.index,type:"text",text:n}),t=i.index+i[0].length,e.push({from:i.index,to:t,type:"math",text:i[0].slice(1,-1)})}let o=r.slice(t);return o.length>0&&e.push({from:t,to:r.length,type:"text",text:o}),e},bB=Zl.StaticMath(document.createElement("span"));function ka(r){let e="",t=[];$$(r)?t=j$(r):t=[{from:0,to:r.length,type:"text",text:r}];for(let i of t)e+=i.type==="text"?i.text:ca(i.text);return e}function ca(r){let e="";return W$.test(r)?(/^\+/.test(r)?(e="positive ",r=r.slice(1)):/^\-/.test(r)&&(e="negative ",r=r.slice(1)),e+=r.replace(/(\.)([0-9]+)/g,(t,i,o)=>i+o.split("").join(" ").trim())):(bB.latex(r),e=bB.mathspeak().trim()),e}var jr=class{constructor(e){this.model=e;this.s=e.s}createOutput(){return this.model.createCustomToolOutput(this.getSpec())}clearTentativeOutputs(){let e=this.getSpec();var t={},i=this.model.getNonObjectsState().ui.currentTool.idMap;for(let o in i){let n=i[o];!this.model.isObjectALockedToolInput(n)&&this.model.isObjectUncommitted(n)&&(t[o]=n)}this.model.deleteObjectsAndRememberReusableId(t),this.model.tentativelyMatchToolInput(e,""),this.createOutput()}didLockInput(e){var n;let{currentTool:t}=this.model.getNonObjectsState().ui,i=t.inputIndex,o=e.inputs[i];o&&(n=o.numberInputInfo)!=null&&n.defaultLatex&&!t.idMap[o.id]&&this.onNumberInput(o.numberInputInfo.defaultLatex)}shouldReferenceSpecificItemInList(e,t){return!t}getExpandedReferenceForDef(e,t){return this.shouldReferenceSpecificItemInList(e,t)?e.referenceLatex:e.assignment}getListIndexForHover(e,t){if(this.shouldReferenceSpecificItemInList(e,t))return e.listIndex}_getOrCreatePoint(e,t,i){var c,p;let o=this.model.getOrCreatePointNearMouse(e,i);if(o.type==="def")return{createdNew:!1,def:o.def,reference:this.getExpandedReferenceForDef(o.def,t),previewOnly:!1};let n=this.createPointDefinition(o.spec,t),a=o.spec.type==="point-reference"?o.spec.targetSpec.parentDefs:o.spec.parentDefs,s=0;for(let u=0;u<a.length;u++){let m=a[u];if(m.polygonEdgeInfo){let h=this.model.createToolInputDependency({type:"polygon-segment",parents:[(c=m.polygonEdgeInfo)==null?void 0:c.polygonDef.referenceLatex],edgeNumber:((p=m.polygonEdgeInfo)==null?void 0:p.edgeNumber)||0},this.getSpec(),s);n.parents[u]=h,s+=1,this.model.setObjectHovered({tokenId:h,listIndex:void 0})}else this.model.setObjectHovered({calcId:m.calcId,listIndex:this.getListIndexForHover(m,t)})}return{createdNew:!0,def:void 0,reference:this.model._createInputObject(n),previewOnly:n.type==="point"&&n.previewOnly}}_isReadyToCommit(){return this.model.getNonObjectsState().ui.currentTool.inputIndex>=this.getSpec().inputs.length}_getFirstMissingInput(){let{inputIndex:e}=this.model.getNonObjectsState().ui.currentTool;return this.getSpec().inputs[e]}canNextInputBePoint(){let e=this._getFirstMissingInput();return e&&e.type==="point"?!0:!!(e&&e.type==="union"&&e.valueTypes.indexOf(__dcg_shared_module_exports__['da'])!==-1)}getNonPointInputType(){let e=this._getFirstMissingInput();if(!(!e||e.type==="point"))return e.type==="union"?e:e.type}isValidNextInputType(e){if(this.canNextInputBePoint()&&__dcg_shared_module_exports__['Na'](e,__dcg_shared_module_exports__['da']))return!0;let t=this._getFirstMissingInput();if(!t)return!1;let i=[];if(t.type==="union")i=t.valueTypes;else{let o=t.type;switch(o){case"point":i=[__dcg_shared_module_exports__['da']];break;case"straight":i=[...__dcg_shared_module_exports__['Oa']];break;case"angle":i=[__dcg_shared_module_exports__['xa'],__dcg_shared_module_exports__['za']];break;case"arc":i=[__dcg_shared_module_exports__['ra']];break;case"circle":i=[__dcg_shared_module_exports__['pa']];break;case"polygon":i=[__dcg_shared_module_exports__['la']];break;case"segment":i=[__dcg_shared_module_exports__['na']];break;case"vector":i=[__dcg_shared_module_exports__['Da']];break;default:return o}}return t.numberInputInfo&&i.push(__dcg_shared_module_exports__['ca']),i.some(o=>__dcg_shared_module_exports__['Na'](e,o))}getAllValidNextInputTypes(){return __dcg_shared_module_exports__['Ha'].filter(e=>this.isValidNextInputType(e))}getHint(){let e=this._getFirstMissingInput();return e?e.hint!==void 0?this.s(e.hint):this.s("graphing-calculator-text-geometry-select-hint",{type:e.type}):""}getSpecIdToLockIn(e,t){let i=e.inputs[t];if(i)return i.id}tryCommitResults(){if(this.model.attemptLockToolInputIn(this.getSpec()),this._isReadyToCommit()){let e=this.model.getUncommittedObjects();for(let i in e)e[i].type==="expression-edit-preview-latex"&&delete e[i];let t=__dcg_shared_module_exports__['a']({},this.model.getNonObjectsState().ui.currentTool.idMap);return this.model.commitObjects(),this.model.deselectAllObjects(),this.model.cancelToolplay(),{committed:e,toolIdToLatex:t}}return{committed:void 0}}tentativelyAddInput({target:e,pointInfo:t},i){var n,a;let o;if(e)if(e.polygonEdgeInfo){let s=this.model.createToolInputDependency({type:"polygon-segment",parents:[(n=e.polygonEdgeInfo)==null?void 0:n.polygonDef.referenceLatex],edgeNumber:((a=e.polygonEdgeInfo)==null?void 0:a.edgeNumber)||0},this.getSpec(),0);this.model.setObjectHovered({tokenId:s,listIndex:void 0}),o=s}else o=this.getExpandedReferenceForDef(e,i),this.model.setObjectHovered({calcId:e.calcId,listIndex:this.getListIndexForHover(e,i)});else t&&(o=t.reference,t!=null&&t.def&&!t.createdNew&&!t.previewOnly&&this.model.setObjectHovered({calcId:t.def.calcId,listIndex:this.getListIndexForHover(t.def,i)}));o&&this.model.tentativelyMatchToolInput(this.getSpec(),o)}onFocus(e){this.clearTentativeOutputs(),e&&this.tentativelyAddInput({target:e},!1),this.createOutput()}onMove(e){this.clearTentativeOutputs();let t=this.canNextInputBePoint(),i=this.getNonPointInputType(),o=!1;if(i){let n=this.model.getObjectDefUnderMouse(e.pt,e.tolerance);n&&this.model.objectIsInstanceOf(n,i)&&(this.tentativelyAddInput({target:n},e.shift),o=!0)}if(!o&&t){let n=this._getOrCreatePoint(e.pt,e.shift,e.tolerance);o=!n.previewOnly,this.isDegenerateInput(n.reference)?n.def&&this.model.setObjectHovered({calcId:n.def.calcId,listIndex:this.getListIndexForHover(n.def,e.shift)}):this.tentativelyAddInput({pointInfo:n},e.shift)}return this.createOutput(),o}isDegenerateInput(e){return!!this.model.getNonObjectsState().ui.currentTool.lockedIds[e]}getNumberInputLatex(){let e=this.getSpec(),{inputIndex:t,idMap:i}=this.model.getNonObjectsState().ui.currentTool,o=e.inputs[t];return o!=null&&o.numberInputInfo&&i[`${o.id}-number`]||""}onNumberInput(e){this.clearTentativeOutputs();let t=this.getSpec();this.model.storeNumberInputLatex(t,e),this.createOutput()}createPointDefinition(e,t){let i=e.parentDefs,o;switch(e.type){case"point-reference":{o={type:"point-reference",parents:[this.getExpandedReferenceForDef(i[0],t)]};break}default:{let n=i.map(a=>this.getExpandedReferenceForDef(a,t));o=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},e),{parents:n})}}return o}shouldUseJitEdges(){return!0}shouldHighlightRelevantObjects(){return!0}};function Yk(r,e){if(typeof e=="object")return e.valueTypes.some(t=>__dcg_shared_module_exports__['Na'](r,t));switch(e){case"point":return r===__dcg_shared_module_exports__['da'];case"straight":return r===__dcg_shared_module_exports__['ta']||r===__dcg_shared_module_exports__['va']||r===__dcg_shared_module_exports__['na']||r===__dcg_shared_module_exports__['Da'];case"angle":return r===__dcg_shared_module_exports__['xa']||r===__dcg_shared_module_exports__['za'];case"arc":return r===__dcg_shared_module_exports__['ra'];case"circle":return r===__dcg_shared_module_exports__['pa'];case"polygon":return r===__dcg_shared_module_exports__['la'];case"segment":return r===__dcg_shared_module_exports__['na'];case"vector":return r===__dcg_shared_module_exports__['Da'];default:return e}}var IM="graphing-calculator-text-geometry-tool-vector-hint-start",yB="graphing-calculator-text-geometry-tool-vector-hint-end",xB="graphing-calculator-text-geometry-tool-vector-copy-hint-end",iw=class extends jr{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-vector-display-name",this.toolName="vector",this.toolType="simple",this.icon=[{type:"stroked-path",path:[32,68,65,35],lineWidth:"large",arrow:!0},{type:"point",x:32,y:68},{type:"point",x:68,y:32}]}getExpressionEditHint(t){return t===0?this.s(IM):this.firstInputIsVector()?this.s(xB):this.s(yB)}firstInputIsVector(){let{idMap:t}=this.model.getNonObjectsState().ui.currentTool,i=t[1],o=i&&this.model.findDefsForInputId(i)[0];return o&&o.typedRuntimeValue.valueType===__dcg_shared_module_exports__['Da']}getSpec(){return this.firstInputIsVector()?{inputs:[{type:"union",valueTypes:[__dcg_shared_module_exports__['da'],__dcg_shared_module_exports__['Da']],id:"1",hint:IM},{type:"point",id:"2",hint:xB}],outputs:[{id:"3",type:"vector-copy",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}:{inputs:[{type:"union",valueTypes:[__dcg_shared_module_exports__['da'],__dcg_shared_module_exports__['Da']],id:"1",hint:IM},{type:"point",id:"2",hint:yB}],outputs:[{id:"3",type:"vector",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};function Y$(r){return Array.isArray(r)&&r.length===2&&r.every(e=>Array.isArray(e)&&e.length===2&&e.every(t=>!Array.isArray(t)&&!isNaN(t)))}function Wp(r){if(!Y$(r))return __dcg_shared_module_exports__['pb'](__dcg_shared_module_exports__['Da']);let e=r[1][0],t=r[1][1],i=r[1][0]+r[0][0],o=r[1][1]+r[0][1];return[[e,t],[i,o]]}function VM(r){let e=r.formula.geometry&&r.formula.geometry.call;return!e||!e.parents?[]:e.parents.map(t=>t===void 0?"":t[0])}function $p(r,e={}){let t=r.formula.typed_constant_value.value,i=r.formula.typed_constant_value.valueType;return e.listIndex!==void 0&&__dcg_shared_module_exports__['Ka'](i)&&(i=__dcg_shared_module_exports__['La'](i),t=t[e.listIndex]),{value:t,valueType:i}}function Jk(r,e,t){var C,D,k,M,I,S,V;let i,o=[],n=(C=r.formula.geometry.call)==null?void 0:C.symbol,a=((D=r.formula.assignment)==null?void 0:D[0])==="$",s=VM(r),l=e.getGeoTokenInfoFromIdentifier(s[0]),c=e.getGeoTokenInfoFromIdentifier(s[1]),{value:p}=$p(r,t),u=p[0],m=p[1],h=(k=t.poi)==null?void 0:k.ariaLabel,x=h!==void 0&&h!==""?h:r.label;switch(n){case"intersection":x?i=e.s("graphing-calculator-narration-geometry-intersection-with-assignment",{assignment:ka(x)}):a?i=e.s("graphing-calculator-narration-geometry-unlabeled-intersection",{index:r.id}):i=e.s("graphing-calculator-narration-geometry-intersection-with-assignment",{assignment:(M=r.formula.assignment)!=null?M:""}),t.includeDetails&&typeof u=="number"&&typeof m=="number"&&l!==void 0&&c!==void 0?o.push(e.s("graphing-calculator-narration-geometry-item-at-coordinates-and-intersection",{itemDescription:i,parent1:l.description,parent2:c.description,x:mi(e,u),y:fi(e,m)})):o.push(i);break;case"midpoint":x?i=e.s("graphing-calculator-narration-geometry-midpoint-with-assignment",{assignment:ka(x)}):a?i=e.s("graphing-calculator-narration-geometry-unlabeled-midpoint",{index:r.id}):i=e.s("graphing-calculator-narration-geometry-midpoint-with-assignment",{assignment:(I=r.formula.assignment)!=null?I:""}),t.includeDetails&&typeof u=="number"&&typeof m=="number"&&l!==void 0?o.push(e.s("graphing-calculator-narration-geometry-item-at-coordinates-and-parent",{itemDescription:i,parent:l.description,x:mi(e,u),y:fi(e,m)})):o.push(i);break;case"glider":x?i=e.s("graphing-calculator-narration-geometry-glider-with-assignment",{assignment:ka(x)}):a?i=e.s("graphing-calculator-narration-geometry-unlabeled-glider",{index:r.id}):i=e.s("graphing-calculator-narration-geometry-glider-with-assignment",{assignment:(S=r.formula.assignment)!=null?S:""}),t.includeDetails&&typeof u=="number"&&typeof m=="number"?o.push(e.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:i,x:mi(e,u),y:fi(e,m)})):o.push(i);break;default:x?i=e.s("graphing-calculator-narration-geometry-point-with-assignment",{assignment:ka(x)}):a?i=e.s("graphing-calculator-narration-geometry-unlabeled-point",{index:r.id}):i=e.s("graphing-calculator-narration-geometry-point-with-assignment",{assignment:(V=r.formula.assignment)!=null?V:""}),t.includeDetails&&typeof u=="number"&&typeof m=="number"?o.push(e.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:i,x:mi(e,u),y:fi(e,m)})):o.push(i)}return o}function wB(r,e,t){var m,h,x,C;let i,o=[],n=((m=r.formula.assignment)==null?void 0:m[0])==="$",{value:a}=$p(r,t),s=(h=a[0])==null?void 0:h[0],l=(x=a[0])==null?void 0:x[1],c=a[1],p=e.get2dProjection(),u=p&&p.viewport;return n?i=e.s("graphing-calculator-narration-geometry-unlabeled-circle",{index:r.id}):i=e.s("graphing-calculator-narration-geometry-circle-with-assignment",{assignment:(C=r.formula.assignment)!=null?C:""}),t.includeDetails&&u&&typeof s=="number"&&typeof l=="number"&&typeof c=="number"?o.push(e.s("graphing-calculator-narration-geometry-item-at-coordinates-with-radius",{itemDescription:i,x:mi(e,s),y:fi(e,l),radius:ca(__dcg_shared_module_exports__['bb'](c,u.xmax-u.xmin).latex)})):o.push(i),o}function vB(r,e,t){var h,x,C,D,k,M,I,S;let i="",o=[],n=((h=r.formula.assignment)==null?void 0:h[0])==="$",{value:a}=$p(r,t);n?i=e.s("graphing-calculator-narration-geometry-unlabeled-arc",{index:r.id}):i=e.s("graphing-calculator-narration-geometry-arc-with-assignment",{assignment:(x=r.formula.assignment)!=null?x:""});let s=(C=a[0])==null?void 0:C[0],l=(D=a[0])==null?void 0:D[1],c=(k=a[1])==null?void 0:k[0],p=(M=a[1])==null?void 0:M[1],u=(I=a[2])==null?void 0:I[0],m=(S=a[2])==null?void 0:S[1];return t.includeDetails&&typeof s=="number"&&typeof l=="number"&&typeof c=="number"&&typeof p=="number"&&typeof u=="number"&&typeof m=="number"?o.push(e.s("graphing-calculator-narration-geometry-item-at-coordinates-with-middle-and-end",{itemDescription:i,x1:mi(e,s),y1:fi(e,l),x2:mi(e,c),y2:fi(e,p),x3:mi(e,u),y3:fi(e,m)})):o.push(i),o}function CB(r,e,t){var m,h,x,C,D,k,M,I;let{value:i}=$p(r,t),o=i.length;if(t.polygonEdge!==void 0)if(t.polygonEdge>=0&&t.polygonEdge<i.length){let S=i[t.polygonEdge],V=i[(t.polygonEdge+1)%i.length];i=[S,V]}else return[e.s("shared-calculator-narration-item-unknown")];let n,a=[],s=((m=r.formula.assignment)==null?void 0:m[0])==="$",l=(h=i[0])==null?void 0:h[0],c=(x=i[0])==null?void 0:x[1],p=(C=i[1])==null?void 0:C[0],u=(D=i[1])==null?void 0:D[1];return o===3?s?n=e.s("graphing-calculator-narration-geometry-unlabeled-triangle",{index:r.id}):n=e.s("graphing-calculator-narration-geometry-triangle-with-assignment",{assignment:(k=r.formula.assignment)!=null?k:""}):o===4?s?n=e.s("graphing-calculator-narration-geometry-unlabeled-quadrilateral",{index:r.id}):n=e.s("graphing-calculator-narration-geometry-quadrilateral-with-assignment",{assignment:(M=r.formula.assignment)!=null?M:""}):s?n=e.s("graphing-calculator-narration-geometry-unlabeled-polygon",{index:r.id,sideCount:o}):n=e.s("graphing-calculator-narration-geometry-polygon-with-assignment",{assignment:(I=r.formula.assignment)!=null?I:"",sideCount:o}),t.polygonEdge!==void 0?t.includeDetails&&typeof l=="number"&&typeof c=="number"&&typeof p=="number"&&typeof u=="number"?a.push(e.s("graphing-calculator-narration-geometry-item-at-coordinates-to-coordinates",{itemDescription:n,x1:mi(e,l),y1:fi(e,c),x2:mi(e,p),y2:fi(e,u)})):a.push(n):t.includeDetails&&typeof l=="number"&&typeof c=="number"?a.push(e.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:n,x:mi(e,l),y:fi(e,c)})):a.push(n),a}function DB(r,e,t){var D,k,M,I,S,V,P,L,B,R,W,re;let i="",o=[],n=(D=r.formula.geometry.call)==null?void 0:D.symbol,a=((k=r.formula.assignment)==null?void 0:k[0])==="$",s=VM(r),l=e.getGeoTokenInfoFromIdentifier(s[0]),c=e.getGeoTokenInfoFromIdentifier(s[1]),{value:p,valueType:u}=$p(r,t),m,h,x,C;return n==="vector"?[[m,h],[x,C]]=Wp(p):(m=(M=p[0])==null?void 0:M[0],h=(I=p[0])==null?void 0:I[1],x=(S=p[1])==null?void 0:S[0],C=(V=p[1])==null?void 0:V[1]),n==="parallel"?a?i=e.s("graphing-calculator-narration-geometry-unlabeled-parallel",{index:r.id}):i=e.s("graphing-calculator-narration-geometry-parallel-with-assignment",{assignment:(P=r.formula.assignment)!=null?P:""}):n==="perpendicular"?a?i=e.s("graphing-calculator-narration-geometry-unlabeled-perpendicular",{index:r.id}):i=e.s("graphing-calculator-narration-geometry-perpendicular-with-assignment",{assignment:(L=r.formula.assignment)!=null?L:""}):u===__dcg_shared_module_exports__['ta']?a?i=e.s("graphing-calculator-narration-geometry-unlabeled-line",{index:r.id}):i=e.s("graphing-calculator-narration-geometry-line-with-assignment",{assignment:(B=r.formula.assignment)!=null?B:""}):u===__dcg_shared_module_exports__['va']?a?i=e.s("graphing-calculator-narration-geometry-unlabeled-ray",{index:r.id}):i=e.s("graphing-calculator-narration-geometry-ray-with-assignment",{assignment:(R=r.formula.assignment)!=null?R:""}):u===__dcg_shared_module_exports__['na']?a?i=e.s("graphing-calculator-narration-geometry-unlabeled-segment",{index:r.id}):i=e.s("graphing-calculator-narration-geometry-segment-with-assignment",{assignment:(W=r.formula.assignment)!=null?W:""}):u===__dcg_shared_module_exports__['Da']&&(a?i=e.s("graphing-calculator-narration-geometry-unlabeled-vector",{index:r.id}):i=e.s("graphing-calculator-narration-geometry-vector-with-assignment",{assignment:(re=r.formula.assignment)!=null?re:""})),(n==="parallel"||n==="perpendicular")&&t.includeDetails&&typeof m=="number"&&typeof h=="number"&&typeof x=="number"&&typeof C=="number"&&l!==void 0&&c!==void 0?o.push(e.s("graphing-calculator-narration-geometry-item-to-line-passing-through-point-at-coordinates-to-coordinates",{itemDescription:i,parent1:l.description,parent2:c.description,x1:mi(e,m),y1:fi(e,h),x2:mi(e,x),y2:fi(e,C)})):t.includeDetails&&typeof m=="number"&&typeof h=="number"&&typeof x=="number"&&typeof C=="number"?o.push(e.s("graphing-calculator-narration-geometry-item-at-coordinates-to-coordinates",{itemDescription:i,x1:mi(e,m),y1:fi(e,h),x2:mi(e,x),y2:fi(e,C)})):o.push(i),o}function SB(r,e,t){var m,h,x,C;let i="",o=[],{value:n,valueType:a}=$p(r,t),s=(m=n[0])==null?void 0:m[0],l=(h=n[0])==null?void 0:h[1],c=(x=r.formula.assignment)!=null?x:"",p="",u=(C=e.getGrapher())==null?void 0:C.getGraphSketch(r.id);if(u&&"labels"in u){let D=u.labels;D.length>0&&"text"in D[0]&&(p=ka(D[0].text))}if(a===__dcg_shared_module_exports__['xa']?/^\$/.test(c)?p!==""?i=e.s("graphing-calculator-narration-geometry-unlabeled-angle-with-measurement",{measurementText:p}):i=e.s("graphing-calculator-narration-geometry-unlabeled-angle",{index:r.id}):p!==""?i=e.s("graphing-calculator-narration-geometry-angle-with-measurement-and-assignment",{measurementText:p,assignment:c}):i=e.s("graphing-calculator-narration-geometry-angle-with-assignment",{assignment:c}):a===__dcg_shared_module_exports__['za']&&(/^\$/.test(c)?p!==""?i=e.s("graphing-calculator-narration-geometry-unlabeled-directed-angle-with-measurement",{measurementText:p}):i=e.s("graphing-calculator-narration-geometry-unlabeled-directed-angle",{index:r.id}):p!==""?i=e.s("graphing-calculator-narration-geometry-directed-angle-with-measurement-and-assignment",{measurementText:p,assignment:c}):i=e.s("graphing-calculator-narration-geometry-directed-angle-with-assignment",{assignment:c})),t.includeDetails&&typeof s=="number"&&typeof l=="number"){let D=VM(r),k=e.getGeoTokenInfoFromIdentifier(D[0]),M=e.getGeoTokenInfoFromIdentifier(D[1]),I=e.getGeoTokenInfoFromIdentifier(D[2]);k!==void 0&&M!==void 0&&I!==void 0?o.push(e.s("graphing-calculator-narration-geometry-angle-at-coordinates-through-points",{itemDescription:i,x1:mi(e,s),y1:fi(e,l),parent1:k.description,parent2:M.description,parent3:I.description})):k!==void 0?o.push(e.s("graphing-calculator-narration-geometry-angle-of-polygon-at-coordinates",{itemDescription:i,parent:k.description,x:mi(e,s),y:fi(e,l)})):o.push(e.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:i,x:mi(e,s),y:fi(e,l)}))}else o.push(i);return o}function kB(r,e,t){let{value:i,valueType:o}=$p(r,t),n=[],a=i.length;switch(__dcg_shared_module_exports__['La'](o)){case __dcg_shared_module_exports__['da']:n.push(e.s("graphing-calculator-narration-geometry-list-of-points",{count:a}));break;case __dcg_shared_module_exports__['pa']:n.push(e.s("graphing-calculator-narration-geometry-list-of-circles",{count:a}));break;case __dcg_shared_module_exports__['ra']:n.push(e.s("graphing-calculator-narration-geometry-list-of-arcs",{count:a}));break;case __dcg_shared_module_exports__['la']:n.push(e.s("graphing-calculator-narration-geometry-list-of-polygons",{count:a}));break;case __dcg_shared_module_exports__['ta']:n.push(e.s("graphing-calculator-narration-geometry-list-of-lines",{count:a}));break;case __dcg_shared_module_exports__['va']:n.push(e.s("graphing-calculator-narration-geometry-list-of-rays",{count:a}));break;case __dcg_shared_module_exports__['na']:n.push(e.s("graphing-calculator-narration-geometry-list-of-segments",{count:a}));break;case __dcg_shared_module_exports__['xa']:n.push(e.s("graphing-calculator-narration-geometry-list-of-angles",{count:a}));break;case __dcg_shared_module_exports__['za']:n.push(e.s("graphing-calculator-narration-geometry-list-of-directed-angles",{count:a}));break;default:n.push(e.s("graphing-calculator-narration-geometry-list-of-any",{count:a}));break}return n[0]=`${n[0]}.`,n}var Yr=__dcg_shared_module_exports__['h'](z());var J$=1,jp=class{constructor(e,t,i,o,n,a,s){this.x=e,this.y=t,this.type=i,this.sketch=o,this.branch=n,this.pointIdxOnBranch=a,this.bareLabel=s===void 0?!1:s,this.id=J$++}getLabel(){let e=this.sketch&&this.sketch.branches[this.branch];return e&&"labels"in e&&e.labels&&e.labels[this.pointIdxOnBranch]||""}getGraphMode(){return this.sketch.branches[this.branch].graphMode}getCompiledFunction(){let e=this.sketch.branches[this.branch];if(!(!("compiled"in e)||!e.compiled))return e.compiled.fn}isAttachedToPlottedPoint(){return this.type===1006||this.type===1008}isMovable(){return this.getGraphMode()===4}isPersistent(){return this.type===1008}getLabelSize(){let e=this.sketch&&this.sketch.branches[this.branch];return this.type===1008&&e&&"labelSize"in e?e.labelSize===void 0?1:e.labelSize:1}getLabelRotation(){let e=this.sketch&&this.sketch.branches[this.branch];return this.type===1008&&e&&"labelAngle"in e?e.labelAngle===void 0?0:e.labelAngle:0}getPointOpacity(){let e=this.sketch&&this.sketch.branches[this.branch];if(e&&"pointOpacity"in e){let t=e.pointOpacity;if(t!==void 0){let i;return Array.isArray(t)?i=t[this.pointIdxOnBranch]:i=t,isFinite(i)?Math.max(0,Math.min(1,i)):.9}}return this.isMovable()?1:.9}getPointSize(){let e=this.sketch&&this.sketch.branches[this.branch];if(this.isMovable())return 22;if(e&&"pointSize"in e){let t=e.pointSize;if(t!==void 0){let i;return Array.isArray(t)?i=t[this.pointIdxOnBranch]:i=t,isFinite(i)?Math.max(0,i):9}}return 9}getTextOutline(){if(this.hasEditableLabel())return!1;let e=this.sketch&&this.sketch.branches[this.branch];return this.type===1008&&e&&"suppressTextOutline"in e?!e.suppressTextOutline:!0}hasInteractiveLabel(){let e=this.sketch&&this.sketch.branches[this.branch];return e&&"interactiveLabel"in e?!!e.interactiveLabel:!1}hasEditableLabel(){let e=this.sketch&&this.sketch.branches[this.branch];return e&&"editableLabel"in e?!!e.editableLabel:!1}isBareLabel(){return this.bareLabel}getMovablePoint(){return this.sketch.getMovablePointByIndex(this.pointIdxOnBranch)}isSelected(){return this.sketch.showHighlight}};function Xk(r,e,t){return Math.max(e,Math.min(t,r))}var Qf=class{constructor(e){let t=e.data,i=e.width,o=e.height;this.imageData=e;for(let l=1;l<i;l++)t[l]+=t[l-1];for(let l=1;l<o;l++)t[l*i]+=t[l*i-i];let n=i*o-i-o+1,a=i-1;for(var s=0;s<n;s++){let l=1+s%a,p=(1+Math.floor(s/a))*i,u=l-1+p,m=l+p-i,h=l-1+p-i;t[p+l]+=t[u]+t[m]-t[h]}}getSumForValidRect(e){let t=e.left-1,i=e.right-1,o=e.top-1,n=e.bottom-1,a=this.imageData.width,s=this.imageData.data,l=s[t+o*a],c=s[i+o*a],p=s[t+n*a],u=s[i+n*a];return t>=0&&o>=0?u-c-p+l:t>=0?u-p:o>=0?u-c:u}getSum(e){let t={left:Xk(Math.floor(e.left),0,this.imageData.width),right:Xk(Math.ceil(e.right),0,this.imageData.width),top:Xk(Math.floor(e.top),0,this.imageData.height),bottom:Xk(Math.ceil(e.bottom),0,this.imageData.height)};return t.left>=t.right||t.top>=t.bottom?0:this.getSumForValidRect(t)}};var oh=1/2,ih=document.createElement("canvas"),AM=[];function X$(r,e){if(!(e.width*e.height>0))return new Qf({width:0,height:0,data:[]});ih.width=0,ih.width=Math.round(e.width*oh),ih.height=Math.round(e.height*oh);let i=ih.getContext("2d");i.save(),i.scale(ih.width/r.canvas.width,ih.height/r.canvas.height),i.drawImage(r.canvas,0,0),i.restore();var o=i.getImageData(0,0,ih.width,ih.height),n=o.data;n.length/4,AM.length,AM=new Array(n.length/4);for(var a=AM,s=0;s<a.length;s++)a[s]=n[s*4+3];var l=new Qf({width:o.width,height:o.height,data:a});return l}function EB(r){for(var e=0;e<r.length;e++){var t=Q$(e,r);r[e]=[t]}return r.map(function(i){return i[0]})}function Q$(r,e){var t=1/0,i=-1,o=e[r];if(o.length===1)return o[0];for(var n=0;n<o.length;n++){var a=e[r][n].staticScore,s=Z$(r,n,e),l=a+s;(i===-1||l<t)&&(t=l,i=n)}return o[i]}function Z$(r,e,t){for(var i=0,o=t[r][e],n=0;n<t.length;n++)if(n!==r){for(var a=0,s=t[n],l=s.length-1;l>=0;l--){var c=s[l],p=Math.max(0,Math.min(o.right,c.right)-Math.max(o.left,c.left)),u=Math.max(0,Math.min(o.bottom,c.bottom)-Math.max(o.top,c.top));a+=p*u}i+=a/s.length}return i}function ej(r,e){var t=e.getSum({left:r.left*oh,right:r.right*oh,top:r.top*oh,bottom:r.bottom*oh});return t/=200,t/=oh*oh,t}function tj(r,e){var t=0;return e.forEach(function(i){t+=GB(r,i)}),t}function rj(r,e){var t=GB(r,e);return 10*(r.width*r.height-t)}function GB(r,e){var t=Math.max(0,Math.min(r.right,e.right)-Math.max(r.left,e.left)),i=Math.max(0,Math.min(r.bottom,e.bottom)-Math.max(r.top,e.top));return t*i}function TB(r,e,t){let i;return()=>(i||(i={domObstructions:t,viewport:{left:0,right:e.width,top:0,bottom:e.height},integralImage:X$(r,e)}),i)}function Qk(r,e){if(!(e.length<=1)){var t=r();for(var i of e)i.staticScore+=rj(i,t.viewport),i.staticScore+=tj(i,t.domObstructions),i.staticScore+=ej(i,t.integralImage)}}function IB(r,e){var t=e.nakedLabel?0:e.pt_radius,i=Math.round(t/Math.sqrt(2)),o=[],n=e.pt_x,a=e.pt_y,s=e.width,l=e.height,c=400;o.push({cx_s:0,cy_s:0,cx_a:0,cy_a:0,staticScore:c,orientation:"center",matches:{default:1,center:1,center_auto:1,auto_center:1}}),o.push({cx_s:.5,cx_a:t+3,cy_s:0,cy_a:0,staticScore:c,orientation:"right",matches:{default:1,right:1,center_auto:1,auto_right:1}}),o.push({cx_s:-.5,cx_a:-t-3,cy_s:0,cy_a:0,staticScore:c,orientation:"left",matches:{default:1,left:1,center_auto:1,auto_left:1}}),o.push({cx_s:0,cx_a:0,cy_s:-.5,cy_a:-t,staticScore:c,orientation:"above",matches:{default:1,above:1,auto_center:1,above_auto:1}}),o.push({cx_s:-.5,cx_a:-i,cy_s:-.5,cy_a:-i,staticScore:c,orientation:"tl",matches:{default:1,above_left:1,above_auto:1,auto_left:1}}),o.push({cx_s:.5,cx_a:i,cy_s:-.5,cy_a:-i,staticScore:c,orientation:"tr",matches:{default:1,above_right:1,above_auto:1,auto_right:1}}),o.push({cx_s:0,cx_a:0,cy_s:.5,cy_a:t,staticScore:c,orientation:"below",matches:{default:1,below:1,auto_center:1,below_auto:1}}),o.push({cx_s:-.5,cx_a:-i,cy_s:.5,cy_a:i,staticScore:c,orientation:"bl",matches:{default:1,below_left:1,below_auto:1,auto_left:1}}),o.push({cx_s:.5,cx_a:i,cy_s:.5,cy_a:i,staticScore:c,orientation:"br",matches:{default:1,below_right:1,below_auto:1,auto_right:1}});var p=Math.cos(e.rotation),u=Math.sin(e.rotation),m=o.map(function(h){var x=h.cx_s*s+h.cx_a,C=h.cy_s*l+h.cy_a;let D=x*p-C*u,k=C*p+x*u,M=`calc(${h.cx_s*100-50}% + ${h.cx_a}px)`,I=`calc(${h.cy_s*100-50}% + ${h.cy_a}px)`,S=-s/2,V=s/2,P=-l/2,L=l/2;if(e.rotation){let B=ij([{x:S*p-P*u,y:P*p+S*u},{x:S*p-L*u,y:L*p+S*u},{x:V*p-P*u,y:P*p+V*u},{x:V*p-L*u,y:L*p+V*u}]);S=B.left,V=B.right,P=B.top,L=B.bottom}return S=Math.round(n+D+S),V=Math.round(n+D+V),P=Math.round(a+k+P),L=Math.round(a+k+L),{pt_x:Math.round(n),pt_y:Math.round(a),left:S,right:V,top:P,bottom:L,width:V-S,height:L-P,transform:`translate(${M},${I})`,staticScore:e.priorOrientation===h.orientation?h.staticScore-20:h.staticScore,orientation:h.orientation,matches:h.matches}});return e.enforceOrientation&&e.enforceOrientation!=="default"?m=__dcg_shared_module_exports__['t'](m,function(h){return!!h.matches[e.enforceOrientation]}):e.nakedLabel?m=__dcg_shared_module_exports__['t'](m,function(h){return h.orientation==="center"}):e.keepOrientation&&e.priorOrientation?m=__dcg_shared_module_exports__['t'](m,function(h){return h.orientation===e.priorOrientation}):m=__dcg_shared_module_exports__['t'](m,function(h){return h.orientation!=="center"}),Qk(r,m),m}function VB(r,e){var t=[],i=e.width,o=e.height,n=i/2,a=o/2,s=e.pt_x1,l=e.pt_y1,c=e.pt_x2,p=e.pt_y2,u=5,m=(p-l)/(c-s),h=Math.atan2(p-l,c-s)+Math.PI/2,x=u*Math.cos(h),C=u*Math.sin(h),D=Math.min(l,p)-Math.abs(C)-o,k=Math.max(l,p)+Math.abs(C),M=[.5,.4,.6,.2,.8],I=[0,20,20,40,40],S=[];for(let W of M)S.push({x:s*(1-W)+c*W,y:l*(1-W)+p*W});for(let W=0;W<S.length;W++){let re=S[W];var V,P,L,B;if(m>=2||m<=-2){L=B=re.y-a;let A=Math.abs((c-s)/(p-l)*a)+Math.abs(x);V=re.x+A,P=re.x-A-i}else if(m<=.05&&m>=-.05){V=P=re.x-n;let A=Math.abs(m*n)+Math.abs(C);L=re.y-A-o,B=re.y+A}else x>0?(V=re.x+x,P=re.x-x-i):(V=re.x+x-i,P=re.x-x),C>0?(L=re.y+C,B=re.y-C-o):(L=re.y+C-o,B=re.y-C);L<D?L=D:L>k&&(L=k),B<D?B=D:B>k&&(B=k);let ne=(c-s)*(L-l)-(p-l)*(V-s)>0,X=W.toString()+(ne?"-a":"-b");t.push({pt_x:re.x,pt_y:re.y,left:V,top:L,staticScore:I[W],orientation:X,matches:{[X]:1}});let b=W.toString()+(ne?"-b":"-a");t.push({pt_x:re.x,pt_y:re.y,left:P,top:B,staticScore:I[W],orientation:b,matches:{[b]:1}})}var R=t.map(function(W){let re=Math.round(W.left),ne=Math.round(W.left+i),X=Math.round(W.top),b=Math.round(W.top+o);return{pt_x:Math.round(W.pt_x),pt_y:Math.round(W.pt_y),transform:`translate(${W.left-W.pt_x}px,${W.top-W.pt_y}px)`,left:re,right:ne,top:X,bottom:b,width:ne-re,height:b-X,staticScore:e.priorOrientation===W.orientation?W.staticScore-20:W.staticScore,orientation:W.orientation,matches:W.matches}});return e.keepOrientation&&e.priorOrientation&&(R=__dcg_shared_module_exports__['t'](R,function(W){return W.orientation===e.priorOrientation})),Qk(r,R),R}function MB(r,e){var t=[],i=e.pt_x,o=e.pt_y,n=e.width,a=e.height;let s=-(e.startAngle+e.deltaAngle/2),l=e.isRightAngle?e.radius*Math.sqrt(2)-1:e.radius+4,c=l+Math.sqrt(e.width*e.width/4+e.height*e.height/4),p=[],u=c*Math.sin(s);u>l+1/2*a&&(u=l+1/2*a),u<-l-1/2*a&&(u=-l-1/2*a),p.push({x:i+c*Math.cos(s)-n/2,y:o+u-a/2});for(let h=0;h<p.length;h++){let x=p[h],C=h.toString()+"-a";t.push({pt_x:x.x,pt_y:x.y,left:x.x,top:x.y,staticScore:0,orientation:C,matches:{[C]:1}})}var m=t.map(function(h){let x=Math.round(h.left),C=Math.round(h.left+n),D=Math.round(h.top),k=Math.round(h.top+a);return{pt_x:Math.round(h.pt_x),pt_y:Math.round(h.pt_y),transform:`translate(${h.left-h.pt_x}px,${h.top-h.pt_y}px)`,left:x,right:C,top:D,bottom:k,width:C-x,height:k-D,staticScore:e.priorOrientation===h.orientation?h.staticScore-20:h.staticScore,orientation:h.orientation,matches:h.matches}});return e.keepOrientation&&e.priorOrientation&&(m=__dcg_shared_module_exports__['t'](m,function(h){return h.orientation===e.priorOrientation})),Qk(r,m),m}function AB(r,e){for(var t=[],i=e.width,o=e.height,n=10,a=Math.round(n/Math.sqrt(2)),s=0,l=50,c=0,p=0,u=0,m=0;m<e.path.length-2;m+=2)u+=1,c+=e.path[m],p+=e.path[m+1];var h=c/u,x=p/u;t.push({left:h-i/2,top:x-o/2,staticScore:s,orientation:"center",matches:{center:1}}),t.push({left:h+n+3,top:x-o/2,staticScore:l,orientation:"right",matches:{right:1}}),t.push({left:h-(n+i)-3,top:x-o/2,staticScore:l,orientation:"left",matches:{left:1}}),t.push({left:h-i/2,top:x-(o+n),staticScore:l,orientation:"top",matches:{top:1}}),t.push({left:h-(i+a),top:x-(o+a),staticScore:l,orientation:"tl",matches:{tl:1}}),t.push({left:h+a,top:x-(o+a),staticScore:l,orientation:"tr",matches:{tr:1}}),t.push({left:h-i/2,top:x+n,staticScore:l,orientation:"bottom",matches:{bottom:1}}),t.push({left:h-(i+a),top:x+a,staticScore:l,orientation:"bl",matches:{bl:1}}),t.push({left:h+a,top:x+a,staticScore:l,orientation:"br",matches:{br:1}});var C=t.map(function(D){let k=Math.round(D.left),M=Math.round(D.left+i),I=Math.round(D.top),S=Math.round(D.top+o);return{pt_x:Math.round(h),pt_y:Math.round(x),transform:`translate(${D.left-h}px,${D.top-x}px)`,left:k,right:M,top:I,bottom:S,width:M-k,height:S-I,staticScore:e.priorOrientation===D.orientation?D.staticScore-20:D.staticScore,orientation:D.orientation,matches:D.matches}});return e.keepOrientation&&e.priorOrientation&&(C=__dcg_shared_module_exports__['t'](C,function(D){return D.orientation===e.priorOrientation})),Qk(r,C),C}function ij(r){let e=r[0].x,t=r[0].x,i=r[0].y,o=r[0].y;for(var n=r.length-1;n>=1;n--){let{x:a,y:s}=r[n];a<e&&(e=a),a>t&&(t=a),s<i&&(i=s),s>o&&(o=s)}return{left:e,right:t,top:i,bottom:o}}var Zk=__dcg_shared_module_exports__['h'](z());var LB=__dcg_shared_module_exports__['h'](z());var os=__dcg_shared_module_exports__['h'](z());function Qe(r){return{shouldBeFocused:()=>vg(r),onFocusedChanged:e=>{LM(r,e)}}}function vg(r){let e=r.predicate;if(e&&!e())return!1;let t=r.controller.getFocusLocation();return t&&__dcg_shared_module_exports__['P'](t,r.location)}function LM(r,e){let t=r.predicate;t&&!t()||(e?r.controller.dispatch({type:"set-focus-location",location:r.location}):r.controller.dispatch({type:"blur-focus-location",location:r.location}))}var{If:OM}=os.Components,Kd=class extends os.Class{init(){this.controller=this.props.controller()}template(){return os.createElement("span",{class:()=>{var t,i;let e=this.parentOrChildHovered();return{"dcg-geo-token-view":!0,"dcg-static-token":(i=(t=this.props).isStatic)==null?void 0:i.call(t),"dcg-selected-token":this.isTokenSelected(),"dcg-hidden-token":this.isHidden(),"dcg-token-has-label":this.hasLabel(),"dcg-child-of-hovered-token":e==="child","dcg-parent-of-hovered-token":e==="parent","dcg-assignment-token":!!this.getAssignment()}},style:()=>({color:this.getColor()}),role:this.bindFn(this.getAriaRole),"dcg-token-type":()=>this.getTokenInfo().iconType,"aria-roledescription":()=>this.props.insideGroup()?void 0:this.controller.s("graphing-calculator-narration-geometry-construction-role-description"),"aria-label":this.bindFn(this.getAriaLabel),"aria-selected":this.bindFn(this.isTokenSelected),tabindex:()=>this.props.putInTabOrder()?0:-1,manageFocus:()=>this.props.focusLocation?Qe({controller:this.controller,location:this.props.focusLocation()}):void 0,onTapStart:this.bindFn(this.onTapStart),onTap:this.bindFn(this.onTap),onPointerOver:this.bindFn(this.onPointerOver),onPointerOut:this.bindFn(this.onPointerOut)},os.createElement("span",{class:os.const("dcg-token-background")}),os.createElement("span",{class:()=>({"dcg-token-icon":!0,[this.getAdditionalTokenClass()]:this.getAdditionalTokenClass(),"dcg-token-is-list":this.getIsList()&&!this.getAssignment()}),style:()=>({"--dcg-icon-angle":this.getIconAngle()})},os.createElement(OM,{predicate:()=>!!this.getIcon()},()=>os.createElement("i",{class:this.bindFn(this.getIcon)}))),os.createElement(OM,{predicate:()=>!!this.getAssignment()},()=>os.createElement(ze,{latex:this.bindFn(this.getAssignment),config:this.const({})})),os.createElement(OM,{predicate:()=>this.hasLabel()},()=>os.createElement("span",{class:()=>({"dcg-token-label":!0})},()=>this.getLabel())))}getIconAngle(){let e=this.controller.getItemsByIdentifier(this.props.identifier());if(!e||e.length!==1)return;let t=e[0];if(!t||!t.formula||!t.formula.typed_constant_value)return;let i;switch(this.getIconType()){case"vector":case"translate":if(t.formula.typed_constant_value.valueType!==__dcg_shared_module_exports__['Da'])return;let[o,n]=t.formula.typed_constant_value.value[0];i=__dcg_shared_module_exports__['Ta'](o,n);break;case"segment":{if(t.formula.typed_constant_value.valueType!==__dcg_shared_module_exports__['na'])return;let[[a,s],[l,c]]=t.formula.typed_constant_value.value;i=__dcg_shared_module_exports__['Ta'](l-a,c-s);break}case"line":{if(t.formula.typed_constant_value.valueType!==__dcg_shared_module_exports__['ta'])return;let[[a,s],[l,c]]=t.formula.typed_constant_value.value;i=__dcg_shared_module_exports__['Ta'](l-a,c-s);break}case"ray":{if(t.formula.typed_constant_value.valueType!==__dcg_shared_module_exports__['va'])return;let[[a,s],[l,c]]=t.formula.typed_constant_value.value;i=__dcg_shared_module_exports__['Ta'](l-a,c-s);break}}return i!==void 0?`${-Number(i).toFixed(2)}rad`:void 0}getAdditionalTokenClass(){if(this.getAssignment()||this.hasError())return"";switch(this.getIconType()){case"glider":return"dcg-token-glider";case"line":return"dcg-token-line";case"segment":return"dcg-token-segment";case"ray":return"dcg-token-ray";case"intersection":return"dcg-token-intersection";case"midpoint":return"dcg-token-midpoint";case"parallel":return"dcg-token-parallel";case"perpendicular":return"dcg-token-perpendicular";case"rotate":return"dcg-token-rotate";case"circle":return"dcg-token-circle";case"arc":return"dcg-token-arc";case"vector":return"dcg-token-vector";case"dilate":return"dcg-token-dilate";case"reflect":return"dcg-token-reflect";case"translate":return"dcg-token-translate";case"transformation":return"dcg-token-transformation";case"point":case"start":case"end":return"dcg-token-point";case"polygon":return"dcg-token-polygon";case"angle":return"dcg-token-angle";case"angles":return"dcg-token-angles";case"directedangle":case"directedangles":return"dcg-token-directedangle"}return""}getIdFromParentRef(e){if(e)return this.controller.getExpressionIdForIdentifier(e[0])}parentOrChildHovered(){var c,p,u,m,h,x;if(!this.props.showParentChildrenHover||!this.props.showParentChildrenHover())return!1;let e=this.controller.getHoveredOrFocusedTokenIdentifier(),t=this.controller.getExpressionIdForIdentifier(e),i=this.props.identifier(),o=this.props.controller().getExpressionIdForIdentifier(i)||"";if(!t)return!1;let n=this.controller.getItemModel(t),a=this.controller.getItemModel(o);if(!n||n.type!=="expression"||!a||a.type!=="expression")return!1;let s=((u=(p=(c=n.formula)==null?void 0:c.geometry)==null?void 0:p.call)==null?void 0:u.parents)||[],l=((x=(h=(m=a.formula)==null?void 0:m.geometry)==null?void 0:h.call)==null?void 0:x.parents)||[];for(let C=0;C<s.length;C++)if(this.getIdFromParentRef(s[C])===o)return"parent";for(let C=0;C<l.length;C++)if(this.getIdFromParentRef(l[C])===t)return"child";return!1}willUnmount(){this.implicitMouseOut()}didUpdate(){let e=this.props.identifier();this.currentlyActiveIdentifier&&e!==this.currentlyActiveIdentifier&&this.implicitMouseOut()}implicitMouseOut(){this.currentlyActiveIdentifier&&this.controller.runAfterDispatch(()=>{let e=this.currentlyActiveIdentifier;e&&(this.currentlyActiveIdentifier=void 0,this.controller.dispatch({type:"unset-active-token",identifier:e,style:"hovered"}))})}isHidden(){return this.getTokenInfo().isHidden}hasError(){let e=this.getTokenInfo();return!e||e.hasError}getIcon(){if(this.getAssignment())return;let e=this.getTokenInfo();if(this.hasError())return"dcg-icon-error";switch(e.iconType){case"point":case"glider":case"intersection":case"strictintersection":case"midpoint":case"start":case"end":return"dcg-icon-point";case"translate":case"vector":return"dcg-icon-vector";case"dilate":return"dcg-icon-dilation";case"rotate":return"dcg-icon-rotation";case"reflect":return"dcg-icon-reflection";case"transformation":return"dcg-icon-title";case"angle":case"angles":case"directedangle":case"directedangles":return"dcg-icon-angle";case"polygon":return"dcg-icon-polygon-solid";case"apply":case"arc":case"circle":case"clockwise":case"counterclockwise":case"error":case"line":case"parallel":case"perpendicular":case"ray":case"reflex":case"segment":case"segments":case"unknown":case"vertices":return;default:return e.iconType}}hasLabel(){return!!this.getLabel()}getLabel(){if(this.getAssignment())return"";let e=this.getTokenInfo().label.trim();return e.length<=2?e:""}getAssignment(){let e=this.props.identifier();return e[0]!=="$"?__dcg_shared_module_exports__['hb'](e):""}getAriaLabel(){let{description:e}=this.getTokenInfo();return this.isHidden()?this.controller.s("graphing-calculator-narration-geometry-hidden-construction-description",{description:e}):e}isTransformation(){var e;return((e=this.getTokenInfo())==null?void 0:e.groupType)==="transformation"}getColor(){if(this.getAssignment())return;let e=this.getTokenInfo();return this.hasError()?"#fa824c":this.isTransformation()||this.isHidden()?"#aaa":e.color}getIconType(){return this.getTokenInfo().iconType}getIsList(){return this.getTokenInfo().isList}getTokenInfo(){let e=this.props.identifier();return this.controller.getTokenRenderInfoByIdentifier(e)}onPointerOver(e){var t,i;(i=(t=this.props).isStatic)!=null&&i.call(t)||e.pointerType==="mouse"&&(this.currentlyActiveIdentifier=this.props.identifier(),this.controller.dispatch({type:"set-active-token",identifier:this.currentlyActiveIdentifier,style:"hovered"}))}onPointerOut(e){var t,i;(i=(t=this.props).isStatic)!=null&&i.call(t)||e.pointerType==="mouse"&&this.currentlyActiveIdentifier&&(this.controller.dispatch({type:"unset-active-token",identifier:this.currentlyActiveIdentifier,style:"hovered"}),this.currentlyActiveIdentifier=void 0)}onTapStart(e){var t,i;(i=(t=this.props).isStatic)!=null&&i.call(t)||e.handle()}onTap(e){var t,i;(i=(t=this.props).isStatic)!=null&&i.call(t)||(e.handle(),this.props.focusLocation&&this.controller.dispatch({type:"set-focus-location",location:this.props.focusLocation()}),this.controller.dispatch({type:"select-expression-that-defines-token",identifier:this.props.identifier(),toggle:this.isTokenSelected(),multiSelectMode:this.controller.isMultiSelectEnabled()&&!!e.shiftKey}))}isTokenSelected(){let e=this.getTokenInfo();return!!(e&&e.isSelected)}getAriaRole(){var e,t;if(!((t=(e=this.props).isStatic)!=null&&t.call(e)))return this.props.insideGroup()?"option":"button"}};var Zf=r=>{let e=function(){return r};return e.isDcgViewConst=!0,e},eb=class{constructor(e,t,i){this.tokenController=e,this.mathNode=t,this.isStatic=i}updateTokens(e){if(!this.mathNode)return;if(!this.lastTokenInfo||this.lastTokenInfo.latex!==e)if(!this.tokenController.doesLatexContainToken(e))this.lastTokenInfo={latex:e,tokens:[]};else{let i=[];this.mathNode.querySelectorAll(".dcg-mq-token").forEach(o=>{i.push(o)}),this.lastTokenInfo={latex:e,tokens:i}}let t=this.lastTokenInfo.tokens;for(let i of t){let o=i.dcgTokenView;if(o)o.update();else{let n=i.getAttribute("data-dcg-mq-token")||"",a=LB.mountToNode(Kd,i,{controller:Zf(this.tokenController),identifier:Zf("$"+n),insideMQ:Zf(!0),insideGroup:Zf(!1),putInTabOrder:Zf(!1),isStatic:Zf(this.isStatic)});i.dcgTokenView=a}}}};var ze=class extends Zk.Class{template(){return this.children.length===1?this.children[0]:Zk.createElement("div",{onMount:e=>this.onMountMathquill(e)})}onMount(){this.children.length===1&&this.onMountMathquill(this.findRootNode())}onMountMathquill(e){this.props.tokenController&&(this.mathquillTokenHelper=new eb(this.props.tokenController(),e,!0)),this.staticMath=Zl.StaticMath(e,__dcg_shared_module_exports__['a']({},this.props.config())),e.classList.add("dcg-static-mathquill-view"),this.updateMathquill()}didUpdate(){this.updateMathquill()}updateMathquill(){var e;this.updateMathquillAria(),this.updateMathquillLatex(),(e=this.mathquillTokenHelper)==null||e.updateTokens(this.props.latex())}updateMathquillLatex(){if(!this.staticMath)return;let e=this.props.latex();this.lastLatex!==e&&(this.staticMath.latex(e),this.lastLatex=e,this.props.onReflow&&this.props.onReflow())}updateMathquillAria(){if(!this.staticMath||!this.props.getAriaLabel)return;let e=this.props.getAriaLabel();e!==this.staticMath.getAriaLabel()&&this.staticMath.setAriaLabel(e)}};xt();var rhe=function(){{var r="_*_";H.Event.prototype.wasHandled=function(e){e=e||r;var t=this.originalEvent,i=t&&t.handledBy;if(i&&i[e])return!0;if(e!==r)return!1;var o=this.target.closest("[handleEvent]");return o&&o!==this.currentTarget?o.getAttribute("handleEvent")!=="false":!1},H.Event.prototype.handle=function(e){e=e||r;var t=this.originalEvent;if(t){var i=t.handledBy;i||(i=t.handledBy={}),i[e]=!0}}}}();var Gl=__dcg_shared_module_exports__['h'](z());xt();function tb(r){let e=__dcg_shared_module_exports__['bc'](r),t=0;for(;!__dcg_shared_module_exports__['dc'](e);)t+=1,e=__dcg_shared_module_exports__['cc'](e);return t}var{If:nj}=Gl.Components,rb=500,aj=30,_e=class r extends Gl.Class{constructor(){super(...arguments),this.lastLatexProp="",this.wasFocusedLastUpdate=!1}template(){return Gl.createElement("div",{class:Gl.const("dcg-mq-container")},Gl.createElement(nj,{predicate:()=>this.getPlaceholder().trim().length>0},()=>Gl.createElement("span",{class:Gl.const("dcg-mq-placeholder")},Gl.createElement(ze,{config:()=>this.props.config(),latex:()=>this.getPlaceholder()}))),Gl.createElement("div",{class:()=>({"dcg-math-field":!0,"dcg-no-fadeout":this.props.noFadeout&&this.props.noFadeout(),"dcg-invalid":this.props.hasError(),"dcg-focus":this.props.isFocused()}),didMount:e=>this.didMountMathquill(e),"data-dcg-label":()=>this.props.dataLabelAttributeValue?this.props.dataLabelAttributeValue():void 0}))}didMount(){this.children.length===1&&this.didMountMathquill(this.findRootNode())}willUnmount(){this.$mathField.off(".view"),this.mathField=void 0}getPlaceholder(){return!this.props.placeholder||this.props.isFocused()||this.props.latex()?"":this.props.placeholder()}didMountMathquill(e){this.cachedConfig=this.getCacheableMQConfig();let t=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.cachedConfig),{handlers:{reflow:i=>{this.props.onReflow&&this.mathField&&this.props.onReflow(i)}},onCut:()=>{this.mathField&&this.props.onUserChangedLatex(this.mathField.latex())},onPaste:()=>{this.mathField&&this.props.onUserChangedLatex(this.mathField.latex())},overrideTypedText:i=>{this.mathField&&this.viewCanAcceptText(i)&&(this.props.onUserTypedText?this.props.onUserTypedText(i):(this.mathField.typedText(i),this.props.onUserChangedLatex(this.mathField.latex())))},overrideKeystroke:(i,o)=>{if(i==="Backspace"&&o.preventDefault(),!this.mathField)return;if(i==="Spacebar"&&this.props.disableSpace&&this.props.disableSpace())return o.preventDefault();let n=Ee(o);if(n==="Up"||n==="Down"||n==="Left"||n==="Right"||n==="Esc"){let a=[];o.ctrlKey&&a.push("Ctrl"),o.metaKey&&a.push("Meta"),o.altKey&&a.push("Alt"),o.shiftKey&&a.push("Shift"),a.length?(a.push(n),i=a.join("-")):i=n}this.props.onUserPressedKey?this.props.onUserPressedKey(i,o):(this.mathField.keystroke(i,o),this.props.onUserChangedLatex(this.mathField.latex())),this.maybeTriggerOnSelectionChange()}});this.props.needsSystemKeypad&&this.props.needsSystemKeypad()&&(t.substituteTextarea=()=>{let i=document.createElement("textarea");return i.setAttribute("autocorrect","off"),i.setAttribute("autocapitalize","none"),i.setAttribute("spellcheck","false"),i.setAttribute("autocomplete","off"),i}),this.props.tokenController&&(this.mathquillTokenHelper=new eb(this.props.tokenController(),e,!1)),this.$mathField=H(e),this.mathField=Zl.MathField(e,t),e._mqMathFieldInstance=this.mathField,e._mqViewInstance=this,this.$mathField.on("focusin.view focusout.view",i=>this.onFocusEvent(i)).on("paste.view",i=>this.onPasteEvent(i)),!_D&&(Iu||Vu)&&this.$mathField.on("keypress.view",i=>this.onKeypressEvent(i)),this.hookupMQTapTouch(),this.updateMathquill()}getCacheableMQConfig(){let e=__dcg_shared_module_exports__['a']({},this.props.config());return this.props.capExpressionSize()&&(e.maxDepth=aj),e}didUpdate(){this.updateMathquill()}updateMathquill(){var e;this.updateMathquillConfig(),this.updateMathquillAria(),this.updateMathquillLatex(),this.updateMathquillFocused(),this.updateMathquillPostLabel(),(e=this.mathquillTokenHelper)==null||e.updateTokens(this.props.latex())}onFocusEvent(e){let t=this.isFocused();t!==this.shouldBeFocused()&&this.props.onFocusedChanged(t,e)}onPasteEvent(e){let t="",i=window.clipboardData,o=e.originalEvent;i&&i.getData?t=i.getData("Text"):o&&o.clipboardData&&o.clipboardData.getData&&(t=o.clipboardData.getData("text/plain"));var n=this.viewCanAcceptText(t);return!n&&this.props.onExpressionSizeExceeded&&this.props.onExpressionSizeExceeded(),n}viewCanAcceptText(e){return r.canAcceptText(this.mathField,this.props.capExpressionSize(),e)}static canAcceptText(e,t,i){if(!e)return!1;if(!t)return!0;let o=e.latex();return tb(o)+tb(i)<=rb}onKeypressEvent(e){if(e.stopPropagation(),e.preventDefault(),!!this.mathField){var t=e.key&&e.key.length===1?e.key:void 0;t&&this.viewCanAcceptText(t)&&(this.props.onUserTypedText?this.props.onUserTypedText(t):(this.mathField.typedText(t),this.props.onUserChangedLatex(this.mathField.latex())))}}hookupMQTapTouch(){this.$mathField.on("dcg-tapstart.view",()=>{let e="dcg-tapend.mathquill-selection-change";H(document).on(e,()=>{this.maybeTriggerOnSelectionChange(),H(document).off(e)})}),this.$mathField.on("dcg-tap.view",e=>{let t=e;if(t.device!=="touch"||t.target.closest(".dcg-mq-ignore-mousedown")||!this.mathField)return;let i=t.changedTouches[0];this.mathField.clickAt(i.clientX,i.clientY,i.target),this.isFocused()||this.mathField.focus();let o;setTimeout(function(){o=Date.now()},0),this.mathField.ignoreNextMousedown(function(){return o===void 0?!0:Date.now()-o<500})})}updateMathquillConfig(){if(!this.mathField)return;let e=this.getCacheableMQConfig();__dcg_shared_module_exports__['P'](e,this.cachedConfig)||(this.cachedConfig=e,this.mathField.config(e))}updateMathquillAria(){if(!this.mathField)return;let e=this.props.getAriaLabel();e!==this.mathField.getAriaLabel()&&this.mathField.setAriaLabel(e)}updateMathquillPostLabel(){this.mathField&&this.mathField.setAriaPostLabel(this.props.getAriaPostLabel(),this.props.hasError()?5e3:1e3)}updateMathquillLatex(){let e=this.props.latex();this.mathField&&this.lastLatexProp!==e&&(this.props.capExpressionSize()&&tb(e)>rb||(this.lastLatexProp=e,this.mathField.latex()!==e&&this.mathField.latex(e)))}updateMathquillFocused(){if(!this.mathField)return;let e=this.isFocused(),t=this.shouldBeFocused();t&&t!==this.wasFocusedLastUpdate&&this.props.selectOnFocus&&this.props.selectOnFocus()&&this.mathField.select(),this.wasFocusedLastUpdate=t,e!==t&&(t?this.mathField.focus():this.mathField.blur())}isFocused(){return!!(document.activeElement&&this.$mathField[0].contains(document.activeElement))}shouldBeFocused(){return this.props.isFocused()}maybeTriggerOnSelectionChange(){let e=this.props.onSelectionChanged;if(!e||!this.mathField)return;let t=this.mathField.selection();__dcg_shared_module_exports__['P'](t,this.lastSelection)||(this.lastSelection=t,e(t))}static getFocusedMathquill(){if(!document.activeElement)return;let e=document.activeElement.closest(".dcg-mq-editable-field");if(e)return e._mqMathFieldInstance}static getMQViewInstance(e){let t=e.el();if(t)return t._mqViewInstance}static applyArrowKeyAndReturnIfWasAtBounds(e,t,i){var o=e.selection();let n=o.startIndex===0&&o.endIndex===o.latex.length;if((t==="Up"||t==="Down")&&n)return e.keystroke(t,i),!0;e.keystroke(t,i);var a=e.selection(),s=a.latex!==o.latex||a.startIndex!==o.startIndex||a.endIndex!==o.endIndex;return!s}static simulateKeypress(e,t){var i=r.getMQViewInstance(e);i&&(i.props.onUserPressedKey?i.props.onUserPressedKey(t):(e.keystroke(t),i.props.onUserChangedLatex(e.latex())),i.maybeTriggerOnSelectionChange())}static simulateUserChangedLatex(e){var t=r.getMQViewInstance(e);t&&t.mathField&&t.props.onUserChangedLatex(t.mathField.latex())}static handleKeystrokeAndDecideIfSpecialEvent(e,t,i){return t==="Enter"||t==="Delete"&&e.latex()===""||t==="Backspace"&&e.latex()===""?!0:t==="Up"||t==="Down"||t==="Left"||t==="Right"?r.applyArrowKeyAndReturnIfWasAtBounds(e,t,i):(e.keystroke(t,i),!1)}};function OB(r,e){r.translate(e.left,e.top)}function sj(r,e){var t=document.createRange();t.selectNode(r);var i=t.getBoundingClientRect(),o=i.width>0&&i.height>0;if(!o)return;var n=window.getComputedStyle(r.parentElement),a=r.nodeValue||"";if(!a)return;var s=parseFloat(n.fontSize);let l=-.228*s,c=n.fontStyle+" "+n.fontWeight+" "+n.fontSize+" "+n.fontFamily;return{type:"text",rect:{left:i.left-e.pointCenterX,right:i.right-e.pointCenterY,top:i.top-e.pointCenterY,bottom:i.bottom-e.pointCenterY},text:a,color:n.color||"#000",font:c,y:i.height+l,hasOutline:e.hasOutline}}function PB(r,e,t){r.save(),r.font=e.font,t?(r.strokeStyle="#FFF",r.lineWidth=3,r.miterLimit=2,r.strokeText(e.text,0,e.y)):(r.fillStyle=e.color,r.fillText(e.text,0,e.y)),r.restore()}function _B(r,e,t){r.save(),t?(r.strokeStyle="#FFF",r.lineWidth=3):(e.fillColor&&(r.fillStyle=e.fillColor),e.strokeColor&&(r.strokeStyle=e.strokeColor)),r.beginPath();for(let i of e.instructions)switch(i.type){case"moveTo":r.moveTo(i.x,i.y);break;case"lineTo":r.lineTo(i.x,i.y);break;case"arcTo":r.arcTo(i.cx,i.cy,i.x,i.y,i.radius);break;case"ellipse":r.ellipse(i.centerX,i.centerY,i.radiusX,i.radiusY,i.rotation,i.startAngle,i.endAngle,i.anticlockwise);break}r.closePath(),t?r.stroke():(e.strokeColor&&r.stroke(),e.fillColor&&r.fill()),r.restore()}function lj(r,e){var t=r.getBoundingClientRect(),i=t.width>0&&t.height>0;if(i){var o=5,n=3,a=-o,s=t.width+o,l=-o,c=t.height+o,p=[{type:"moveTo",x:a+n,y:l},{type:"lineTo",x:s-n,y:l},{type:"arcTo",cx:s,cy:l,x:s,y:l+n,radius:n},{type:"lineTo",x:s,y:c-n},{type:"arcTo",cx:s,cy:c,x:s-n,y:c,radius:n},{type:"lineTo",x:a+n,y:c},{type:"arcTo",cx:a,cy:c,x:a,y:c-n,radius:n},{type:"lineTo",x:a,y:l+n},{type:"arcTo",cx:a,cy:l,x:a+n,y:l,radius:n}];return{type:"path",disableGlow:!0,rect:{left:t.left-e.pointCenterX,right:t.right-e.pointCenterX,top:t.top-e.pointCenterY,bottom:t.bottom-e.pointCenterY},instructions:p,strokeColor:"#C2C2C2",fillColor:"rgba(255,255,255,.75)"}}}function cj(r,e,t){var i=r.getBoundingClientRect(),o=i.width>0&&i.height>0;if(o){var n=i.width,a=parseFloat(e.borderTopWidth||"1px"),s=e.borderTopColor||"#000",l=[{type:"moveTo",x:0,y:0},{type:"lineTo",x:n,y:0},{type:"lineTo",x:n,y:a},{type:"lineTo",x:0,y:a}];return{type:"path",rect:{left:i.left-t.pointCenterX,right:i.right-t.pointCenterX,top:i.top-t.pointCenterY,bottom:i.bottom-t.pointCenterY},instructions:l,fillColor:s}}}function FB(r,e){var t=Math.sqrt(r[0]*r[0]+r[1]*r[1]),i=Math.sqrt(e[0]*e[0]+e[1]*e[1]),o=r[0]*e[0]+r[1]*e[1],n=Math.acos(o/(t*i));return r[0]*e[1]-r[1]*e[0]<0&&(n*=-1),n}function dj(r,e,t,i,o,n,a,s,l){var c=Math.cos(o),p=Math.sin(o),u=(r-s)/2,m=(e-l)/2,h=c*u+p*m,x=-p*u+c*m,C=t*t,D=i*i,k=h*h,M=x*x,I=Math.sqrt((C*D-C*M-D*k)/(C*M+D*k));n===a&&(I*=-1);var S=I*t*x/i,V=-I*i*h/t,P=(r+s)/2,L=(e+l)/2,B=c*S-p*V+P,R=p*S+c*V+L,W=[1,0],re=[(h-S)/t,(x-V)/i],ne=[(-h-S)/t,(-x-V)/i],X=FB(W,re),b=FB(W,ne);return{centerX:B,centerY:R,radiusX:t,radiusY:i,startAngle:X,endAngle:b,rotation:o,anticlockwise:a===0}}var RB={};function pj(r,e){var t=r+"-"+e,i=RB[t];if(i)return i;i=[],RB[t]=i;var o=e.split(" ");if(o.length!==4)return i;var n=parseFloat(o[0]),a=parseFloat(o[2]),s=parseFloat(o[1]),l=parseFloat(o[3]),c=a-n,p=l-s;function u(P){return(P-n)/c}function m(P){return(P-s)/p}var h="[0-9-.]+",x="(M"+h+" "+h+")",C="(L"+h+" "+h+")",D="(A"+h+" "+h+" "+h+" "+h+" "+h+" "+h+" "+h+")",k=new RegExp(x+"|"+C+"|"+D,"g"),M=r.match(k);if(!M||!M.length)return i;var I=NaN,S=NaN;for(let P of M){var V=P.substr(1).split(" ").map(parseFloat);switch(P[0]){case"M":I=u(V[0]),S=m(V[1]),i.push({type:"moveTo",x:I,y:S});break;case"L":I=u(V[0]),S=m(V[1]),i.push({type:"lineTo",x:I,y:S});break;case"A":let L=V[0]/c,B=V[1]/p,R=V[2],W=V[3],re=V[4],ne=u(V[5]),X=m(V[6]),b=dj(I,S,L,B,R,W,re,ne,X);I=ne,S=X,i.push(__dcg_shared_module_exports__['a']({type:"ellipse"},b));break}}return i}function uj(r,e){var t=r.childNodes[0];if(!(!t||t.nodeName!=="path")){var i=r.getBoundingClientRect(),o=i.width>0&&i.height>0;if(o){var n=t.getAttribute("d")||"",a=r.getAttribute("viewBox")||"",s=pj(n,a),l=window.getComputedStyle(r),c=i.width,p=i.height;s=__dcg_shared_module_exports__['j'](s);for(let u of s)switch(u.type){case"moveTo":case"lineTo":u.x*=c,u.y*=p;break;case"arcTo":u.x*=c,u.y*=p,u.cx*=c,u.cy*=p,u.radius*=c;break;case"ellipse":u.centerX*=c,u.centerY*=p,u.radiusX*=c,u.radiusY*=p;break;default:return u}return{type:"path",rect:{left:i.left-e.pointCenterX,right:i.right-e.pointCenterX,top:i.top-e.pointCenterY,bottom:i.bottom-e.pointCenterY},fillColor:l.color||"#000",instructions:s}}}}function NB(r,e,t){var i=window.getComputedStyle(r);if(i.borderTopWidth!=="0px"){let s=cj(r,i,e);s&&t.push(s)}for(var o=r.childNodes,n=0;n<o.length;n++){var a=o[n];if(a.nodeType===3){let s=sj(a,e);s&&t.push(s)}else if(a.nodeName==="svg"){let s=uj(a,e);s&&t.push(s)}else a.nodeType===1&&NB(a,e,t)}}function eE(r,e){let t=[];if(e.hasBorder){let i=lj(r,e);i&&t.push(i)}return NB(r,e,t),t}function tE(r,e){Qi(e,"dcg-svg-label"),e.save(),Oi(e);for(let t of r){switch(e.save(),OB(e,t.rect),t.type){case"path":t.disableGlow||_B(e,t,!0);break;case"text":t.hasOutline&&PB(e,t,!0);break;default:return t}e.restore()}for(let t of r){switch(e.save(),OB(e,t.rect),t.type){case"path":_B(e,t,!1);break;case"text":PB(e,t,!1);break;default:return t}e.restore()}e.restore()}var{If:hj,Input:gj,For:BB,Switch:mj,IfElse:fj}=Yr.Components;function bj(r,e){return e?e.getPOIById(r):null}function Cg(r,e){return 1e3*(r.pixelsToMath.mapX(r.mathToPixels.mapX(e)+.5)-r.pixelsToMath.mapX(r.mathToPixels.mapX(e)-.5))}function iE(r,e){return 1e3*(r.pixelsToMath.mapY(r.mathToPixels.mapY(e)+.5)-r.pixelsToMath.mapY(r.mathToPixels.mapY(e)-.5))}function yj(r,{x:e,y:t}){let i=Cg(r,e),o=iE(r,t);return{xscale:i,yscale:o}}function xj(r,e){var t,i=!1;let o="",n="";if(r.type==="poi"){let u=r.poi,{xscale:m,yscale:h}=yj(e,u);t=u.getLabel();let x=u.getGraphMode(),C;var a=u.type===1007&&u.getCompiledFunction();if(a){var s=x===1,l=s?u.y:u.x;if(C=__dcg_shared_module_exports__['cb'](l,m,h,a),s){var c=C[0];C[0]=C[1],C[1]=c}}else C=[__dcg_shared_module_exports__['bb'](u.x,m),__dcg_shared_module_exports__['bb'](u.y,h)];i=!isFinite(C[1].value),o=C[0].superscript?C[0].mantissa+"^{"+C[0].superscript+"}":C[0].string,n=C[1].superscript?C[1].mantissa+"^{"+C[1].superscript+"}":C[1].string,o==="undefined"&&(o="\\mathrm{undefined}"),n==="undefined"&&(n="\\mathrm{undefined}")}else t=r.text;var p=t&&__dcg_shared_module_exports__['ud'](t);return t?p==="latex"?{is_hole:i,type:"latex",text:t.substr(1,t.length-2)}:p==="text"?{is_hole:i,type:"text",text:t}:{is_hole:i,type:"mixed",text:t}:r.type==="poi"?r.poi.hasEditableLabel()?{is_hole:i,type:"text",text:""}:{is_hole:i,type:"latex",text:"\\left("+o+",\\space "+n+"\\right)"}:{is_hole:i,type:"text",text:"?"}}function qB(r,e,t){let i=r.s("graphing-calculator-label-poi-unknown"),o=e.getProjection();return!o||!o.viewport||t&&(i=oE(r,t.x,t.y)),i}var KB=4,PM=class extends Yr.Class{getClassName(){var e;return((e=this.props.point())==null?void 0:e.y)!==void 0?"dcg-audio-trace-line dcg-audio-trace-line--horizontal":"dcg-audio-trace-line"}getTraceCoord(){var o,n;let e=(o=this.props.point())==null?void 0:o.x,t=(n=this.props.point())==null?void 0:n.y,i=this.props.projection();if(e!==void 0)return`${Math.round(10*i.mapx(e))/10-KB/2}px`;if(t!==void 0)return`${Math.round(10*i.mapy(t))/10-KB/2}px`}getStyle(){var i;let e=this.getTraceCoord(),t=(i=this.props.point())==null?void 0:i.color;return{"--dcg-trace-coord":e,"--dcg-trace-color":t}}template(){return Yr.createElement("div",{class:this.bindFn(this.getClassName),style:this.bindFn(this.getStyle)})}},ib=class extends Yr.Class{constructor(){super(...arguments),this.labelsDirty=!1,this.traceLinePt=void 0}init(){this.grapher=this.props.grapher(),this.controller=this.grapher.controller,this.cachedLabelDict={},this.cachedLabelOrder=[],this.hoveredPOI=void 0,this.openedPOI2Sketch={},this.takingScreenshot=!1}template(){return Yr.createElement("div",{class:Yr.const("dcg-graph-outer"),style:this.const({"z-index":0}),didMount:this.bindFn(this.didMountRoot)},Yr.createElement(BB,{each:()=>this.cachedLabelOrder},Yr.createElement("div",null,e=>Yr.createElement("div",{class:()=>this.getLabelClasses(e),style:()=>this.getLabelStyles(e),didMount:t=>this.linkLabelContainerNode(e,t)},Yr.createElement("div",{class:Yr.const("dcg-pt"),style:()=>this.getDotStyles(e)}),Yr.createElement("div",{class:Yr.const("dcg-label"),didMount:t=>this.linkLabelDOMNode(e,t)},this.renderLabelContent(e))))),Yr.createElement(hj,{predicate:()=>!0},()=>Yr.createElement(PM,{point:()=>this.traceLinePt,projection:()=>this.grapher.getProjection()})))}setTraceLine(e){__dcg_shared_module_exports__['P'](e,this.traceLinePt)||(this.traceLinePt=e,this.update())}renderLabelContent(e){return Yr.createElement(mj,{key:()=>this.getLabelContent(e).type},t=>t==="text"?Yr.createElement("span",{class:Yr.const("dcg-label-raw-text")},()=>this.getLabelContent(e).text):t==="latex"?Yr.createElement(ze,{latex:()=>this.getLabelContent(e).text,config:this.bindFn(this.getMQConfig)}):t==="mixed"?Yr.createElement(BB,{each:()=>__dcg_shared_module_exports__['vd'](this.getLabelContent(e).text),key:(i,o)=>`${i}${o}`},Yr.createElement("span",null,i=>fj(()=>__dcg_shared_module_exports__['ud'](i)==="latex",{true:()=>Yr.createElement(ze,{latex:()=>i.substr(1,i.length-2),config:this.bindFn(this.getMQConfig)}),false:()=>Yr.createElement("span",{class:Yr.const("dcg-label-raw-text")},()=>i)}))):t==="MATH"?Yr.createElement("div",{class:()=>({"dcg-editable-label-border":!0,"dcg-do-not-blur":!0,"dcg-focus":this.shouldEditableLabelBeFocused(e),"dcg-empty-label":this.getEditableLabelText(e).trim().length===0}),style:()=>({"border-color":__dcg_shared_module_exports__['m'](this.getEditableLabelTextColor(e),.3)})},Yr.createElement(_e,{latex:()=>this.getEditableLabelText(e),placeholder:()=>"",isFocused:()=>this.shouldEditableLabelBeFocused(e),capExpressionSize:()=>!!this.controller.getGraphSettings().config.capExpressionSize,selectOnFocus:Yr.const(!1),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.controller.s("graphing-calculator-narration-editable-point-label-at-coordinates",{coordinates:qB(this.controller,this.grapher,this.cachedLabelDict[e])}),getAriaPostLabel:this.const(""),onUserChangedLatex:i=>this.onLabelInput(i,e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:i=>this.onEditableLabelFocusChange(i,e),hasError:this.const(!1),noFadeout:this.const(!0),needsSystemKeypad:()=>!this.controller.isKeypadEnabled()})):Yr.createElement("div",{class:()=>({"dcg-resizing-text-input-container":!0,"dcg-editable-label-border":!0,"dcg-focus":this.shouldEditableLabelBeFocused(e),"dcg-empty-label":this.getEditableLabelText(e).trim().length===0}),style:()=>({"border-color":__dcg_shared_module_exports__['m'](this.getEditableLabelTextColor(e),.3)}),onScroll:i=>{i.target&&(i.target.scrollLeft=0)}},Yr.createElement(gj,{"aria-label":()=>this.controller.s("graphing-calculator-narration-editable-point-label-at-coordinates",{coordinates:qB(this.controller,this.grapher,this.cachedLabelDict[e])}),onInput:i=>this.onLabelInput(i,e),value:()=>this.getEditableLabelText(e),onFocus:()=>this.onEditableLabelFocusChange(!0,e),onBlur:()=>this.onEditableLabelFocusChange(!1,e)}),Yr.createElement("span",{class:Yr.const("dcg-text-input-content")},()=>this.getEditableLabelText(e)||" ")))}getSketchIdFromLabelId(e){var t=this.cachedLabelDict[e];if(t)return t.sketchId}getEditableLabelTextColor(e){let t=this.getSketchIdFromLabelId(e);if(!t)return"#000";let i=this.controller.getItemModel(t);return!i||i.type!=="expression"?"#000":Nc(i)}onEditableLabelFocusChange(e,t){let i=this.getSketchIdFromLabelId(t);i&&(e?this.controller.dispatch({type:"set-focus-location",location:{type:"editable-label",id:i}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"editable-label",id:i}}),this.update())}shouldEditableLabelBeFocused(e){let t=this.getSketchIdFromLabelId(e),i=this.controller.getFocusLocation();return!(!i||i.type!=="editable-label"||!t||i.id!==t)}onLabelInput(e,t){let i=this.getSketchIdFromLabelId(t);if(!i)return;let o=this.controller.getItemModel(i);if(!o||o.type!=="expression")return;let n=e;this.controller.getItemEditableLabelMode(i)==="MATH"&&n.length>0&&(n="`"+n+"`"),this.controller.dispatch({type:"set-item-label",id:i,label:n})}getEditableLabelText(e){let t=this.getSketchIdFromLabelId(e);if(!t)return"";let i=this.controller.getItemModel(t);return!i||i.type!=="expression"?"":this.controller.getItemEditableLabelMode(t)==="MATH"?i.label.substr(1,i.label.length-2):i.label}linkLabelDOMNode(e,t){var i=this.cachedLabelDict[e];i&&(i.labelDOM=t)}linkLabelContainerNode(e,t){var i=this.cachedLabelDict[e];i&&(i.containerDOM=t)}getLabelClasses(e){var t=this.cachedLabelDict[e];return t?t.classes:{}}getLabelStyles(e){var t=this.cachedLabelDict[e];return t?t.styles:{}}getDotStyles(e){var t=this.cachedLabelDict[e];return t?t.dotStyles:{}}getLabelContent(e){var t=this.cachedLabelDict[e];if(t){let i=this.getSketchIdFromLabelId(e);if(!i)return{is_hole:!1,type:"text",text:""};let o=this.controller.getItemEditableLabelMode(i);return t.classes["dcg-editable-label"]&&o!==void 0&&o!=="NONE"?{is_hole:!1,type:o,text:""}:t.content}return{is_hole:!1,type:"text",text:""}}didMountRoot(e){this.node=e}computeHoveredLabel(e,t){var i;this.hoveredPOI?this.isOpenPOI(this.hoveredPOI)?this.grapher.setLayerClass("hoveredPOI","dcg-mouse-over-opened-poi"):(i=this.computeLabel(e,{poi:this.hoveredPOI,type:"poi"},t,"hovered"),this.grapher.setLayerClass("hoveredPOI","dcg-mouse-over-closed-poi")):this.grapher.setLayerClass("hoveredPOI",void 0);var o=this.getHoveredInteractiveLabel();o&&!o.bareLabel?this.grapher.setLayerClass("interactiveLabel","dcg-mouse-over-opened-poi"):this.grapher.setLayerClass("interactiveLabel",void 0),i&&this.saveLabelToCache(i)}computeTraceLabel(e,t){if(this.traceInfo){var i=this.traceInfo.pt;if(i){var o=new jp(i.x,i.y,1007,this.traceInfo.branchInfo.sketch,this.traceInfo.branchInfo.branch,0),n=this.computeLabel(e,{poi:o,type:"poi"},t,"trace");n&&this.saveLabelToCache(n)}}}computeLabel(e,t,i,o){let{projection:n}=e,a=t.type==="poi"?t.poi.id+"":t.id;o==="trace"&&(a="*trace*");let s=t.poi,l=n.mapx(s.x),c=n.mapy(s.y),p=l,u=c;if(t.type!=="poi"&&(l=0,c=0),n.coordsAreOnscreen(l,c,20)){if(this.isHiddenInteractiveLabel(s))return;let m=!1,h,x=s.sketch,C=x&&x.branches[0];C&&(m=!!("nakedLabel"in C&&C.nakedLabel),h="labelOrientation"in C?C.labelOrientation:void 0);let D=x.id,k=this.controller.getItemModel(D);if(s.hasEditableLabel()&&k&&k.type==="expression"&&!es(k))return;let M=xj(t,n),I=s.pointIdxOnBranch,S=s.getLabelSize();this.grapher.settings.config.projectorMode&&(S*=1.2),Array.isArray(S)&&(S=S[I]);let V=s.getLabelRotation();Array.isArray(V)&&(V=V[I]);let P=s.getPointOpacity()*this.controller.getGeoModel().getToolFadeOpacity(D),L=!!s.getTextOutline(),B=s.isPersistent(),R=s.isAttachedToPlottedPoint(),W=s.hasInteractiveLabel(),re=s.hasEditableLabel()&&!this.takingScreenshot,ne=!!(k&&k.type==="expression"&&vs(k)),X=this.grapher.clickableObjectsLayer.shouldDrawPressed(D,s.pointIdxOnBranch),b=this.grapher.clickableObjectsLayer.shouldDrawHovered(e,D,s.pointIdxOnBranch),A=this.grapher.clickableObjectsLayer.isKeyboardFocused(D,s.pointIdxOnBranch),E=x.color;if(X){let Ze=__dcg_shared_module_exports__['tb'](E);Ze.l>.2?Ze.l-=.2:Ze.l+=.1,E=Ze.toString()}else if(b){let Ze=__dcg_shared_module_exports__['tb'](E);Ze.l>.2?Ze.l-=.1:Ze.l+=.2,E=Ze.toString()}let J=!B,j=!!R;W&&(j=!0,J=!0),o==="trace"&&(j=!1,J=!0);let ce=i[a],te=ce&&ce.labelDOM,pe=ce&&ce.containerDOM,he=ce&&ce.width,ae=ce&&ce.height,ie=ce&&ce.orientation,de={"dcg-poi-label":!0,"dcg-tracept":o==="trace","dcg-opened":o==="opened","dcg-hole":M.is_hole,"dcg-show-border":J,"dcg-hide-dot":j,"dcg-naked-label":m,"dcg-editable-label":re,"dcg-has-outline":L,"dcg-focus":A,"dcg-underlined-label":!!(ne&&k&&k.type==="expression"&&k.hidden)};isFinite(S)||(S=1);let Ie=Math.round(S*1100)/10,Se={left:l+"px",top:c+"px","font-size":Ie+"%"};V&&!this.takingScreenshot&&(Se.transform=`rotate(${V}rad)`),B&&E&&(Se.color=E),Se.opacity=`${Math.min(.99,P)}`;let ot={};return o==="trace"&&(ot["background-color"]=E,ot["border-color"]=E),{id:a,sketchId:D,poi:s,x:s.x,y:s.y,screenX:l,screenY:c,top:u,left:p,width:he,height:ae,labelDOM:te,containerDOM:pe,forcedOrientation:h,isNakedLabel:m,isClickable:ne,orientation:ie,rotation:V,classes:de,styles:Se,dotStyles:ot,content:M,hasBorder:s.hasEditableLabel(),opacity:P,hasOutline:L||s.hasEditableLabel(),objectSpec:t.type!=="poi"?t.type==="angle"?{type:t.type,segments:[n.mapx(t.segments[0]),n.mapy(t.segments[1]),t.segments[2],t.segments[3]]}:{type:t.type,segments:n.map_xy_pairs(t.segments)}:void 0}}}computeAllLabels(e,t){var i={},o,n,a=this.grapher.graphSketches;this.grapher.getSketchOrder().forEach(c=>{var p=a[c];if(p){var u=p.labels;if(u.length)for(var m=0;m<u.length;m++){let h=u[m],x=this.computeLabel(e,h,t,"opened");x&&(Array.isArray(p.color)&&(x.styles.color=p.color[m]),this.saveLabelToCache(x))}}});var s={};for(o in this.openedPOI2Sketch){var l=bj(o,a[this.openedPOI2Sketch[o]]);l&&(s[o]=l.sketch.id,n=this.computeLabel(e,{poi:l,type:"poi"},t,"opened"),n&&this.saveLabelToCache(n))}return this.openedPOI2Sketch=s,i}saveLabelToCache(e){var t=e.id;this.cachedLabelDict[t]||this.cachedLabelOrder.push(t),this.cachedLabelDict[t]=e}markLabelsDirty(){this.labelsDirty=!0}getInteractiveLabelUnderPoint(e){let t;for(var i=this.cachedLabelOrder.length-1;i>=0;i--){let o=this.cachedLabelOrder[i],n=this.cachedLabelDict[o];if(!n||!n.width||!n.height)continue;let a=n.screenX,s=n.screenY,{left:l,top:c,width:p,height:u}=n;if(p>0&&u>0&&e.x>a+l&&e.x<a+l+p&&e.y>s+c&&e.y<s+c+u){let m=this.getSketchIdFromLabelId(o);if(m===void 0)continue;let h=this.controller.getItemModel(m);if(!h||h.type!=="expression")continue;if(bf(h))return{type:"editable",model:h};!t&&iN(h)?t={type:"draggable",label:{model:h,x:n.x,y:n.y}}:!t&&n.isClickable&&(t={type:"clickable",model:h,poi:n.poi})}}return t}positionLabels(e,t,i,o,n){var a=!this.labelsDirty;this.labelsDirty=!1;var s=[];t.forEach(u=>{var m=i[u];if(!m||!m.labelDOM)return;let h,x=this.getSketchIdFromLabelId(u);if(x!==void 0){let P=this.grapher.getGraphSketch(x);P&&P.branches&&(h=P.branches[0].pointSize)}(h===void 0||typeof h!="number"||h<0)&&(h=9);let D=(this.grapher.settings.config.projectorMode?14:10)*h/9;var k=m.screenX,M=m.screenY,I=m.labelDOM.clientWidth,S=m.labelDOM.clientHeight;if(!(I>0&&S>0))return;let V=0;this.takingScreenshot&&m.hasBorder&&(V=5),s.push({renderedLabel:m,pt_x:k,pt_y:M,pt_radius:D+V,rotation:m.rotation,nakedLabel:m.isNakedLabel,width:I,height:S,keepOrientation:a,priorOrientation:m.orientation,enforceOrientation:m.forcedOrientation})});var l=TB(e,o,n),c=s.map(u=>{if(u.renderedLabel.objectSpec){if(u.renderedLabel.objectSpec.type==="segment")return VB(l,{pt_x1:u.renderedLabel.objectSpec.segments[0],pt_y1:u.renderedLabel.objectSpec.segments[1],pt_x2:u.renderedLabel.objectSpec.segments[2],pt_y2:u.renderedLabel.objectSpec.segments[3],pt_radius:10,width:u.width,height:u.height,keepOrientation:u.keepOrientation,priorOrientation:u.priorOrientation||""});if(u.renderedLabel.objectSpec.type==="polygon")return AB(l,{path:u.renderedLabel.objectSpec.segments,pt_radius:10,width:u.width,height:u.height,keepOrientation:u.keepOrientation,priorOrientation:u.priorOrientation||""});if(u.renderedLabel.objectSpec.type==="angle"){let m=u.renderedLabel.objectSpec.segments,h=this.grapher.settings.config.projectorMode?30:20;return MB(l,{pt_x:m[0],pt_y:m[1],startAngle:m[2],deltaAngle:m[3],isRightAngle:Fk(m[3]),radius:h,pt_radius:10,width:u.width,height:u.height,keepOrientation:u.keepOrientation,priorOrientation:u.priorOrientation||""})}}else return IB(l,u);return[]}),p=EB(c);p.forEach(function(u,m){var h=s[m].renderedLabel;h.orientation=u.orientation;let x=u.left-u.pt_x,C=u.top-u.pt_y;h.left=x,h.top=C,h.width=u.width,h.height=u.height;var D=h.labelDOM;if(D){D.style.transform=u.transform,D.setAttribute("dcg-label-orientation",u.orientation);var k=h.containerDOM;k&&(k.style.left=u.pt_x+"px",k.style.top=u.pt_y+"px"),setTimeout(()=>D.classList.add("dcg-enable-transition"),1)}})}copyToCtx(e){Ra(e,"labels");var t=this.node.getBoundingClientRect();this.cachedLabelOrder.forEach(i=>{var o=this.cachedLabelDict[i];if(!o)return;var n=o.labelDOM;if(!n)return;let a={pointCenterX:o.screenX,pointCenterY:o.screenY,hasOutline:!!o.hasOutline,hasBorder:!!o.hasBorder};var s=this.computeRotatedCenter(a.pointCenterX,a.pointCenterY,o.rotation);let l=eE(n,a);e.save(),e.globalAlpha=o.opacity,e.rotate(o.rotation),e.translate(s.x-t.left,s.y-t.top),tE(l,e),e.restore()}),Na(e)}computeRotatedCenter(e,t,i){var o=Math.cos(-i),n=Math.sin(-i),a=e*o-t*n,s=t*o+e*n;return{x:a,y:s}}drawForScreenshot(e,t,i,o){this.takingScreenshot=!0,this.redraw(e,i,o),this.takingScreenshot=!1,this.copyToCtx(t)}redraw(e,t,i){let{ctx:o}=e;var n=this.cachedLabelDict;this.cachedLabelDict={},this.cachedLabelOrder=[],this.computeAllLabels(e,n),this.computeHoveredLabel(e,n),this.computeTraceLabel(e,n),this.update(),this.positionLabels(o,this.cachedLabelOrder,this.cachedLabelDict,t,i)}clearOpenedPOI(){this.openedPOI2Sketch={}}closePOI(e){delete this.openedPOI2Sketch[e.id]}openPOI(e){this.openedPOI2Sketch[e.id]=e.sketch.id}isOpenPOI(e){return this.openedPOI2Sketch.hasOwnProperty(e.id)}isOpenInteractiveLabel(e){return this.isOpenPOI(e)?e.hasInteractiveLabel():!1}isHiddenInteractiveLabel(e){return!e||!e.hasInteractiveLabel()?!1:!this.isOpenPOI(e)&&this.getHoveredPOI()!==e}setHoveredPOI(e){this.hoveredPOI=e}getHoveredPOI(){return this.hoveredPOI}getHoveredInteractiveLabel(){var e=this.getHoveredPOI();if(e&&e.hasInteractiveLabel())return e}setTraceInfo(e){this.traceInfo=e}isTracing(){return!!this.traceInfo}getTraceInfo(){return this.traceInfo}getMQConfig(){return this.controller.getMathquillConfig({})}};function _i(r,e){if(!r)return"";let{controller:t}=r;if(r.type==="expression"){let i=t.isItemSecret(r.id);switch(e){case"describe":return i?t.s("graphing-calculator-narration-describe-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-describe-expression",{index:r.displayIndex});case"delete":return i?t.s("graphing-calculator-narration-delete-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-delete-expression",{index:r.displayIndex});case"duplicate":return i?t.s("graphing-calculator-narration-duplicate-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-duplicate-expression",{index:r.displayIndex});case"show":return i?t.s("graphing-calculator-narration-show-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-show-expression",{index:r.displayIndex});case"hide":return i?t.s("graphing-calculator-narration-hide-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-hide-expression",{index:r.displayIndex});case"show-options":return i?t.s("graphing-calculator-narration-show-options-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-show-options-expression",{index:r.displayIndex});case"hide-options":return i?t.s("graphing-calculator-narration-hide-options-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-hide-options-expression",{index:r.displayIndex});case"create_table":return i?t.s("graphing-calculator-narration-create-table-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-create-table-expression",{index:r.displayIndex});case"rename":return i?t.s("graphing-calculator-narration-rename-secret-expression",{index:r.secretIndex}):t.s("graphing-calculator-narration-rename-expression",{index:r.displayIndex})}}if(r.type==="image")switch(e){case"describe":return t.s("graphing-calculator-narration-describe-image",{index:r.displayIndex});case"delete":return t.s("graphing-calculator-narration-delete-image",{index:r.displayIndex});case"duplicate":return t.s("graphing-calculator-narration-duplicate-image",{index:r.displayIndex});case"show":return t.s("graphing-calculator-narration-show-image",{index:r.displayIndex});case"hide":return t.s("graphing-calculator-narration-hide-image",{index:r.displayIndex});case"show-options":return t.s("graphing-calculator-narration-show-options-image",{index:r.displayIndex});case"hide-options":return t.s("graphing-calculator-narration-hide-options-image",{index:r.displayIndex});case"edit_title":return t.s("graphing-calculator-narration-edit-image-title",{index:r.displayIndex})}if(r.type==="text")switch(e){case"describe":return t.s("graphing-calculator-narration-describe-text",{index:r.displayIndex});case"delete":return t.s("graphing-calculator-narration-delete-text",{index:r.displayIndex});case"duplicate":return t.s("graphing-calculator-narration-duplicate-text",{index:r.displayIndex});case"show":return t.s("graphing-calculator-narration-show-text",{index:r.displayIndex});case"hide":return t.s("graphing-calculator-narration-hide-text",{index:r.displayIndex});case"edit_title":return t.s("graphing-calculator-narration-edit-text-title",{index:r.displayIndex})}if(r.type==="table")switch(e){case"describe":return t.s("graphing-calculator-narration-describe-table",{index:r.displayIndex});case"delete":return t.s("graphing-calculator-narration-delete-table",{index:r.displayIndex});case"duplicate":return t.s("graphing-calculator-narration-duplicate-table",{index:r.displayIndex});case"show":return t.s("graphing-calculator-narration-show-table",{index:r.displayIndex});case"hide":return t.s("graphing-calculator-narration-hide-table",{index:r.displayIndex});case"rename":return t.s("graphing-calculator-narration-rename-table",{index:r.displayIndex})}if(r.type==="folder"){let i=!!r.title;switch(e){case"describe":return i?t.s("graphing-calculator-narration-describe-folder-title",{folder:r.title}):t.s("graphing-calculator-narration-describe-folder-index",{index:r.displayIndex});case"collapse":return i?t.s("graphing-calculator-narration-collapse-folder-title",{folder:r.title}):t.s("graphing-calculator-narration-collapse-folder-index",{index:r.displayIndex});case"expand":return i?t.s("graphing-calculator-narration-expand-folder-title",{folder:r.title}):t.s("graphing-calculator-narration-expand-folder-index",{index:r.displayIndex});case"show":return i?t.s("graphing-calculator-narration-show-folder-title",{folder:r.title}):t.s("graphing-calculator-narration-show-folder-index",{index:r.displayIndex});case"hide":return i?t.s("graphing-calculator-narration-hide-folder-title",{folder:r.title}):t.s("graphing-calculator-narration-hide-folder-index",{index:r.displayIndex});case"duplicate":return i?t.s("graphing-calculator-narration-duplicate-folder-title",{folder:r.title}):t.s("graphing-calculator-narration-duplicate-folder-index",{index:r.displayIndex});case"delete":return i?t.s("graphing-calculator-narration-delete-folder-title",{folder:r.title}):t.s("graphing-calculator-narration-delete-folder-index",{index:r.displayIndex});case"edit_title":return t.s("graphing-calculator-narration-edit-folder-title",{index:r.displayIndex})}}switch(e){case"describe":return t.s("graphing-calculator-narration-describe");case"delete":return t.s("graphing-calculator-narration-delete");case"duplicate":return t.s("graphing-calculator-narration-duplicate");case"expand":return t.s("graphing-calculator-narration-expand");case"collapse":return t.s("graphing-calculator-narration-collapse");case"show":return t.s("graphing-calculator-narration-show");case"hide":return t.s("graphing-calculator-narration-hide");case"show-options":return t.s("graphing-calculator-narration-show-options");case"hide-options":return t.s("graphing-calculator-narration-hide-options");case"create_table":return t.s("graphing-calculator-narration-create-table");case"rename":return t.s("graphing-calculator-narration-rename");case"edit_title":return t.s("graphing-calculator-narration-edit-title");default:return e}}function nw(r,e,t={includeDetails:!0}){var a;if(!r)return e.s("graphing-calculator-narration-geometry-nothing-selected");let i=t.description?t.description:"";if(r.type!=="expression"){if(r.type==="image"){let s=i!==""?i:_i(r,"describe"),{x:l,y:c}=r.formula.dimensions;l&&c&&typeof l[0]=="number"&&typeof c[0]=="number"?i=e.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:s,x:mi(e,l[0]),y:fi(e,c[0])}):i=s}}else(!r.latex||!((a=r.formula)!=null&&a.typed_constant_value))&&(i=i!==""?i:_i(r,"describe"));let o=t.poi&&t.poi.sketch.showPOI&&t.poi.type==="static-labeled-point";!i&&Md(r)?(i=wj(r,e,t),i=Cj(i,r,e,t)):t.includeDetails&&t.poi&&!o&&(i=e.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:i,x:mi(e,t.poi.x),y:fi(e,t.poi.y)}));let n=i;return t.includeSelectionState&&!Bf(r)&&!o&&(n=FM(n,r,e)),Bf(r)&&(n=e.s("shared-calculator-narration-item-clickable",{item:n})),n}function wj(r,e,t={includeDetails:!0}){let{value:i,valueType:o}=$p(r,t);if(!i)return e.s("shared-calculator-narration-item-unknown");let n=[];if(__dcg_shared_module_exports__['Ka'](o))n=kB(r,e,t);else switch(o){case __dcg_shared_module_exports__['da']:n=Jk(r,e,t);break;case __dcg_shared_module_exports__['pa']:n=wB(r,e,t);break;case __dcg_shared_module_exports__['ra']:n=vB(r,e,t);break;case __dcg_shared_module_exports__['la']:n=CB(r,e,t);break;case __dcg_shared_module_exports__['ta']:case __dcg_shared_module_exports__['va']:case __dcg_shared_module_exports__['na']:case __dcg_shared_module_exports__['Da']:n=DB(r,e,t);break;case __dcg_shared_module_exports__['xa']:case __dcg_shared_module_exports__['za']:n=SB(r,e,t);break;default:n.push(e.s("shared-calculator-narration-item-unknown"))}let a=n.join(" "),s=r.formula.geometry&&r.formula.geometry.call;return s&&(a=vj(a,s,e)),a}function vj(r,e,t){let i,o=e.parents;if(__dcg_shared_module_exports__['ac'](e.symbol))i=e.symbol;else if(e.symbol==="apply"){let n=o[0],a=n?t.getItemsByIdentifier(n[0]):[];for(let s of a){if(s.type!=="expression")continue;let l=s.formula.geometry;if(!(!l||!l.call)){i=l.call.symbol;break}}}else return r;switch(i){case"dilate":return t.s("graphing-calculator-narration-geometry-dilated-item",{item:r});case"rotate":return t.s("graphing-calculator-narration-geometry-rotated-item",{item:r});case"translate":return t.s("graphing-calculator-narration-geometry-translated-item",{item:r});case"reflect":return t.s("graphing-calculator-narration-geometry-reflected-item",{item:r});default:return t.s("graphing-calculator-narration-geometry-transformed-item",{item:r})}}function Cj(r,e,t,i){var o,n;return i.listIndex!==void 0&&((n=(o=e.formula)==null?void 0:o.geometry)!=null&&n.valueType)&&__dcg_shared_module_exports__['Ka'](e.formula.geometry.valueType)?t.s("graphing-calculator-narration-item-with-list-index",{listIndex:i.listIndex+1,item:r}):i.polygonEdge!==void 0?t.s("graphing-calculator-narration-geometry-edge-of-polygon",{polygonEdge:i.polygonEdge+1,item:r}):r}function FM(r,e,t){return(e&&aa(e)?t.s("shared-calculator-narration-item-selected",{item:r}):t.s("shared-calculator-narration-item-unselected",{item:r})).trim()}function nE(r,e){let t=r[e];return Array.isArray(t)&&r.tableInfo?t[r.tableInfo.rowIndex]:t}var aw=class{constructor(e){this.grapher=e,this.renderedPointsIdOrder=[],this.renderedPoints={},this.speakThrottledAlert=__dcg_shared_module_exports__['K'](()=>{this.speakAriaAlert()},1e3,{leading:!0,trailing:!0})}redraw(e,t){let{ctx:i,projection:o}=e;var n=this.grapher.graphSketches,a=this.renderedPoints;this.renderedPoints={},this.renderedPointsIdOrder=[];let s=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention(),l=s==null?void 0:s.calcId,c=(s==null?void 0:s.listIndex)||0;var p=I=>{let S=!!s&&l===I.sketch.id&&c===I.listIndex;var V=this.processPOI(i,o,I,a[I.id],t,S);V&&(this.renderedPoints[I.id]=V,this.renderedPoints[I.id].poi=I,this.renderedPointsIdOrder.push(I.id))};this.grapher.getSketchOrder().forEach(I=>{var S=n[I];S&&(S.getMovablePoints().forEach(p),S.getStaticLabeledPoints().forEach(p))});var u=this.renderedPoints[this.hoveredPointId],m=this.renderedPoints[this.pressedPointId],h=u&&u.poi,x=m&&m.poi;h||this.setHoveredPointId(void 0),x||this.setPressedPointId(void 0);var C=x||h,D,k;C?(D=C.type==="movable-point"&&C.tableInfo&&C.tableInfo.dragX,k=C.type==="movable-point"&&C.tableInfo&&C.tableInfo.dragY,D&&k||!D&&!k?this.grapher.setLayerClass("movablePoints","dcg-mouse-over-movable-point"):D?this.grapher.setLayerClass("movablePoints","dcg-mouse-over-movable-point-ew"):this.grapher.setLayerClass("movablePoints","dcg-mouse-over-movable-point-ns")):this.grapher.setLayerClass("movablePoints",void 0);let M=this.getPOIUnderAttention();if(!M)this.lastAriaAlert=void 0;else{if(!this.renderedPoints[M.id])return;let S=this.getAriaAlert({id:M.id,lastAriaAlert:this.lastAriaAlert,includeUsageInstructions:!1});S!=null&&S.updated&&this.speakThrottledAlert()}}_clampedOpacity(e){return e<0?0:e>1?1:__dcg_shared_module_exports__['U'](e)?e:1}getAllRenderedObjects(e){return this.renderedPointsIdOrder.filter(t=>e?this.renderedPoints[t].type===e:!0).map(t=>this.renderedPoints[t])}getOrderedTabTargets(e){let t=[];return this.renderedPointsIdOrder.forEach(i=>{let o=this.renderedPoints[i];if(e&&o.type!==e||this.getTabIndex(i)===-1)return;let n=o.poi;t.push({calcId:n.sketch.id,listIndex:n.listIndex,polygonEdge:void 0,description:this.getAriaLabel(i)})}),t}drawForScreenshot(e,t,i,o){var n=this.grapher.graphSketches;for(let c in n){var a=n[c],s=a.branches[0],l;s.graphMode===4&&(l=s.pointOpacity),a.getMovablePoints().forEach(p=>{var u={screenX:t.mapx(p.x),screenY:t.mapy(p.y),color:p.color,pointOpacity:l,animationPercent:0};this.drawMovablePointOnCtx(e,p.sketch,u,i,o)})}}processPOI(e,t,i,o,n,a){var s=i.id,l=i.x,c=i.y,p=t.mapx(l),u=t.mapy(c),m=t.coordsAreOnscreen(p,u,20);if(!(!m&&!a)){var h=i.sketch?this.grapher.controller.getItemModel(i.sketch.id):void 0,x=!!(h&&aa(h));return o||(i.type==="movable-point"?o={type:"movable",id:s,pointOnScreen:m,poi:i,projection:t,screenX,screenY,color:nE(i,"color"),pointOpacity:nE(i,"pointOpacity"),pointIsHovered:!1,pointIsPressed:!1,selected:x,lastHoverActionTime:0,animationPercent:0}:h&&h.type==="expression"&&h.label!==void 0&&h.showLabel&&Gi(h)!=="NONE"?o={type:"draggable-label",id:s,pointOnScreen:m,selected:x,poi:i,projection:t,screenX,screenY}:o={type:"static",id:s,pointOnScreen:m,poi:i,projection:t,screenX,screenY,selected:x}),o.pointOnScreen=m,o.poi=i,o.projection=t,o.screenX=p,o.screenY=u,o.type==="movable"&&(o.color=nE(o.poi,"color"),o.pointOpacity=nE(o.poi,"pointOpacity"),o.selected=x,this.updateMovablePointAnimation(o,a),this.drawMovablePointOnCtx(e,o.poi.sketch,o,n)),o}}drawMovablePointOnCtx(e,t,i,o,n){var x;var a;n?a=n:a=this.grapher.settings.config.projectorMode?13.5:10.5,t.tokenSelected||(t.tokenHovered?a*=$f:t.showHighlight&&(a*=1.2));var s=Array.isArray(i.color)?i.color[0]:i.color,l=i.screenX,c=i.screenY,p=i.animationPercent||0;o.push({left:l-a,right:l+a,top:c-a,bottom:c+a}),e.save();var u=e.globalAlpha;let m=this.shouldDrawGhosted(t.id)?Lk.IS_GHOSTED:Yx;var h=this._clampedOpacity(m*i.pointOpacity);h*=(x=this.grapher.controller.getGeoModel().getToolFadeOpacity(t.id))!=null?x:1,e.fillStyle=s,e.globalAlpha=.35*h,e.beginPath(),e.moveTo(l+a,c),e.arc(l,c,a,0,Math.PI*2,!0),e.closePath(),e.fill(),e.globalAlpha=h,a*=.3+.7*p,e.beginPath(),e.moveTo(l+a,c),e.arc(l,c,a,0,Math.PI*2,!0),e.closePath(),e.fill(),e.globalAlpha=u,e.restore()}updateMovablePointAnimation(e,t){var i=Date.now(),o=e.id,n=this.hoveredPointId===o||t,a=this.pressedPointId===o;e.pointIsPressed=a,n!==e.pointIsHovered&&(e.pointIsHovered=n,e.lastHoverActionTime=i);var s=e.animationPercent||0,l=i-e.lastHoverActionTime,c=.004*l;a?s=1:n?(s+=c,s>=1?s=1:this.requestRedrawNextFrame()):(s-=c,s<=0?s=0:this.requestRedrawNextFrame()),e.animationPercent=s}shouldDrawGhosted(e){if(!e)return!1;let t=this.grapher.controller.getItemModel(e);return!t||t.type!=="expression"?!1:Za(t)}getTabIndex(e){if(this.grapher.controller.getActiveTool()!=="selection")return-1;let t=this.renderedPoints[e];if(!t)return-1;let i=t.poi,o=this.grapher.controller.getItemEditableLabelMode(i.sketch.id),n=this.grapher.controller.getItemModel(i.sketch.id),a=n&&n.type==="expression"&&!vs(n)&&(t.type==="movable"||o===void 0||o==="NONE");var s=this.grapher.settings;let l=s.config.graphpaper&&s.config.enableTabindex;return a&&l?0:-1}getAriaHidden(){var e=this.grapher.settings;return!e.config.graphpaper}getAriaLabel(e){var t=this.getAriaAlert({id:e,includeUsageInstructions:!1});return t&&t.completeMessage}speakAriaAlert(){var i;let e=(i=this.getPOIUnderAttention())==null?void 0:i.id;if(e){let o=this.renderedPoints[e];if(!o||o.type==="static")return this.lastAriaAlert=void 0,!1}let t=this.getAriaAlert({id:e,lastAriaAlert:this.lastAriaAlert,includeUsageInstructions:!0});return this.lastAriaAlert=t,t&&t.completeMessage?(be(t.completeMessage),!0):!1}getAriaAlert(e){let{id:t,lastAriaAlert:i,includeUsageInstructions:o}=e;if(!t)return;var n=this.renderedPoints[t];if(!n)return;let{controller:a}=this.grapher,s=n.poi.sketch?a.getItemModel(n.poi.sketch.id):void 0;if(!(!s||s.type!=="expression")){i&&i.id!==t&&(i=void 0);var l=n.poi,c=n.pointOnScreen,p=n.projection;if(!(!l||!p)){var u=p.viewport;if(u){var m=i==null?void 0:i.label,h=l.ariaLabel;a.isGeometry()&&Md(s)&&(h=Jk(s,a,{poi:l,includeDetails:!1}).join(" "));var x=m!==h,C=!!(i!=null&&i.selected),D=n.selected,k=C!==D,M=i==null?void 0:i.coordX,I=i==null?void 0:i.coordY,S=l.x,V=l.y,P=S!==M||V!==I,L=i&&(x||k||P),B=mi(a,S),R=fi(a,V),W=`${B} ${R}`,re=h||a.s("graphing-calculator-narration-movable-point-prefix"),ne=!a.isGeometry()&&(n.type==="movable"||n.type==="draggable-label")&&o?a.s("graphing-calculator-narration-movable-point-suffix-usage-instructions"):"",X=c?"":a.s("graphing-calculator-narration-movable-point-off-screen-prompt"),b;if(i?x||!P&&k?b=re+X:P?b=W+X:b="":b=a.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:re,x:B,y:R})+ne+X,a.isGeometry()&&(n.type==="movable"||n.type==="draggable-label")){let A=a.getActiveTool();(A==="selection"||A==="box-selection")&&(b=FM(b||h||"",s,a))}return{id:t,coordX:S,coordY:V,label:h,selected:D,completeMessage:b,updated:L}}}}}setHoveredPointId(e){e!==this.hoveredPointId&&(this.hoveredPointId=e,this.requestRedrawNextFrame())}isMovingPoint(){return!!this.pressedPointId}setPressedPointId(e){e!==this.pressedPointId&&(this.pressedPointId=e,this.requestRedrawNextFrame())}getPOIUnderAttention(){let e=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention();if(!e)return;let t=e.listIndex||0;for(let i in this.renderedPoints){let n=this.renderedPoints[i].poi;if(n.sketch.id===e.calcId&&n.listIndex===t)return n}}requestRedrawNextFrame(){this.grapher.controller.requestRedrawGraph()}};function oE(r,e,t){return mi(r,e)+" "+fi(r,t)}function mi(r,e){let t=r.getGraphSettings().showXAxis,i=r.get2dProjection();if(!i)return"";let{width:o}=i.screen;return t?r.s("graphing-calculator-narration-audio-trace-property-x",{x:ca(__dcg_shared_module_exports__['bb'](e,Cg(i,e)).latex)}):r.s("graphing-calculator-narration-x-percentage-coordinate",{x:Math.round(i.mathToPixels.mapX(e)/o*1e3)/10})}function fi(r,e){let t=r.getGraphSettings().showYAxis,i=r.get2dProjection();if(!i)return"";let{height:o}=i.screen;return t?r.s("graphing-calculator-narration-audio-trace-property-y",{y:ca(__dcg_shared_module_exports__['bb'](e,Cg(i,e)).latex)}):r.s("graphing-calculator-narration-y-percentage-coordinate",{y:Math.round(i.mathToPixels.mapY(e)/o*1e3)/10})}var Dj=Math.hypot&&Math.hypot(1/0,NaN)===1/0;function zB(r){return r===1/0||r===-1/0}var nh=Dj?Math.hypot:function(r,e){if(zB(r)||zB(e))return 1/0;if(isNaN(r)||isNaN(e))return NaN;if(r===0&&e===0)return 0;if(Math.abs(r)>Math.abs(e)){let t=e/r;return Math.abs(r)*Math.sqrt(t*t+1)}else{let t=r/e;return Math.abs(e)*Math.sqrt(t*t+1)}};function ob(r){let e=[[r.x0,r.y0],[r.x1,r.y1],[r.x2,r.y2]],[t,i]=__dcg_shared_module_exports__['Db'](e),o=__dcg_shared_module_exports__['yb'](r.x0-t,r.y0-i);return{x:t,y:i,radius:o}}function aE(r){let e=[[r.x0,r.y0],[r.x1,r.y1],[r.x2,r.y2]],[t,i]=__dcg_shared_module_exports__['Db'](e);return{startAngle:Math.atan2(r.y0-i,r.x0-t),deltaAngle:__dcg_shared_module_exports__['Eb'](e)}}var UB=(r,e)=>({x:r.x-e.x,y:r.y-e.y}),Sj=(r,e)=>r.x*e.x+r.y*e.y;function lE(r,e){return nh(r.x-e.x,r.y-e.y)}function HB(r,e){let t={x:r.x1,y:r.y1},i={x:r.x2,y:r.y2},o=UB(e,t),n=UB(i,t),a=lE(t,i),s=a*a;return Sj(o,n)/s}function NM(r){return[{x1:r.left,y1:r.top,x2:r.left,y2:r.bottom,extendStart:!1,extendEnd:!1},{x1:r.left,y1:r.top,x2:r.right,y2:r.top,extendStart:!1,extendEnd:!1},{x1:r.right,y1:r.top,x2:r.right,y2:r.bottom,extendStart:!1,extendEnd:!1},{x1:r.left,y1:r.bottom,x2:r.right,y2:r.bottom,extendStart:!1,extendEnd:!1}]}function kj(r){let{angle:e,width:t,height:i,center:o}=r,n=o.x,a=o.y,s=Math.cos(-e),l=Math.sin(-e),c=t/2,p=i/2,u={x:n+s*-c-l*-p,y:a+l*-c+s*-p},m={x:n+s*c-l*-p,y:a+l*c+s*-p},h={x:n+s*c-l*p,y:a+l*c+s*p},x={x:n+s*-c-l*p,y:a+l*-c+s*p};return[{x1:u.x,y1:u.y,x2:m.x,y2:m.y,extendStart:!1,extendEnd:!1},{x1:m.x,y1:m.y,x2:h.x,y2:h.y,extendStart:!1,extendEnd:!1},{x1:h.x,y1:h.y,x2:x.x,y2:x.y,extendStart:!1,extendEnd:!1},{x1:x.x,y1:x.y,x2:u.x,y2:u.y,extendStart:!1,extendEnd:!1}]}function Ej(r,e){let t=NM(r);return!!(cE(e,t[0])||cE(e,t[1])||cE(e,t[2])||cE(e,t[3]))}function Gj(r,e){let t=NM(r);return!!(zd(e,t[0],!1)||zd(e,t[1],!1)||zd(e,t[2],!1)||zd(e,t[3],!1)||zd(e,t[0],!0)||zd(e,t[1],!0)||zd(e,t[2],!0)||zd(e,t[3],!0))}function Tj(r,e){let t=NM(r);return!!(ah(e,t[0],!1)||ah(e,t[1],!1)||ah(e,t[2],!1)||ah(e,t[3],!1)||ah(e,t[0],!0)||ah(e,t[1],!0)||ah(e,t[2],!0)||ah(e,t[3],!0))}function Ij(r,e){return r.left<=e.left&&r.right>=e.right&&r.top<=e.top&&r.bottom>=e.bottom}function Vj(r,e){return r.left<=e.x&&e.x<=r.right&&r.top<=e.y&&e.y<=r.bottom}function dE(r,e){if(!e.extendStart){let t=r.left<=e.x1&&e.x1<=r.right,i=r.top<=e.y1&&e.y1<=r.bottom;if(t&&i)return!0}return Ej(r,e)}function XB(r,e){let t={x:e.x0,y:e.y0};return!!(Vj(r,t)||Tj(r,e))}function QB(r,e){let t={left:e.x-e.radius,right:e.x+e.radius,top:e.y-e.radius,bottom:e.y+e.radius};return!!(Ij(r,t)||Gj(r,e))}function Mj(r,e){let t=r.x-e.center.x,i=r.y-e.center.y,o=Math.atan2(i,t),n=nh(t,i),a={x:n*Math.cos(o+e.angle),y:n*Math.sin(o+e.angle)};return Math.abs(a.x)<=e.width/2&&Math.abs(a.y)<=e.height/2}function ZB(r,e){if(e.length<4)return!1;let t={x1:NaN,y1:NaN,x2:e[0],y2:e[1],extendStart:!1,extendEnd:!1};for(var i=2;i<e.length;i+=2)if(t.x1=t.x2,t.y1=t.y2,t.x2=e[i],t.y2=e[i+1],dE(r,t))return!0;return!1}function eq(r,e){var t=kj(e);for(let i of t)if(dE(r,i))return!0;return!!Mj({x:r.left,y:r.top},e)}function Aj(r,e,t){let i=e.x1-r.x,o=e.x2-r.x,n=e.y1-r.y,a=e.y2-r.y,s=r.radius,l=o-i,c=a-n,p=l*l+c*c,u=i*a-o*n,m=Math.sqrt(s*s*p-u*u);if(m<0)return;if(c>=0)var h=1;else var h=-1;let x=t?-1*h:1*h;return{x:r.x+(u*c+x*h*l*m)/p,y:r.y+(-u*l+x*Math.abs(c)*m)/p}}function Lj(r,e){let t=r.y2-r.y1,i=r.x1-r.x2,o=e.y2-e.y1,n=e.x1-e.x2,a=t*r.x1+i*r.y1,s=o*e.x1+n*e.y1,l=t*n-o*i;if(l!==0)return{x:(n*a-i*s)/l,y:(t*s-o*a)/l}}function RM(r,e){let t=HB(e,r);return!(isNaN(t)||t<0&&!e.extendStart||t>1&&!e.extendEnd)}function Oj(r,e){let{x:t,y:i}=ob(e),{startAngle:o,deltaAngle:n}=aE(e),a=Math.atan2(r.y-i,r.x-t);return __dcg_shared_module_exports__['Sa'](a,o,n)}function zd(r,e,t){let i=Aj(r,e,t);if(i!=null&&RM(i,e))return i}function ah(r,e,t){let i=zd(ob(r),e,!1)||$B,o=jB(t,YB(r,i),JB(e));if(o||(i=zd(ob(r),e,!0)||$B,o=jB(t,YB(r,i),JB(e))),o&&Oj(i,r))return i}var $B={x:NaN,y:NaN};function cE(r,e){let t=Lj(r,e);if(t!=null&&RM(t,r)&&RM(t,e))return t}function jB(r,e,t){let i=e.x*t.y-e.y*t.x;return i>0&&r||i<0&&!r}function YB(r,e){let{x:t,y:i}=ob(r),{deltaAngle:o}=aE(r);return o>0?{x:i-e.y,y:e.x-t}:{x:e.y-i,y:t-e.x}}function JB(r){return{x:r.x2-r.x1,y:r.y2-r.y1}}var Kt=__dcg_shared_module_exports__['h'](z());var Hn=__dcg_shared_module_exports__['h'](z());xt();function pE(r){return Array.from(r.querySelectorAll('input:enabled, button:enabled, select:enabled, textarea:enabled, [tabindex="0"], a[href]')).filter(e=>!e.getAttribute("aria-hidden")&&!e.getAttribute("aria-disabled")&&Vp(e))}function tq(r){return function(t){if(Ee(t)==hl&&r){let i=pE(r);if(i.length===0)return;let o=i[0],n=i[i.length-1];t.shiftKey&&document.activeElement===o?(t.preventDefault(),H(n).trigger("focus")):!t.shiftKey&&document.activeElement===n?(t.preventDefault(),H(o).trigger("focus")):document.activeElement&&!r.contains(document.activeElement)&&(t.preventDefault(),H(o).trigger("focus"))}}}xt();function Ud(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){let e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}var{IfElse:_j}=Hn.Components,Fj=500,Hd=5,sw=2,BM=class extends Hn.Class{constructor(){super(...arguments),this.offsetLeft=0}init(){this.uuid=this.props.uuid()}gravity(){var e,t;return((t=(e=this.props).gravity)==null?void 0:t.call(e))||"s"}template(){return Hn.createElement("div",{class:()=>{var e,t,i,o;return{"dcg-tooltip-positioning-container":!0,"dcg-tooltip-gravity-n-s":this.gravity()==="n"||this.gravity()==="s","dcg-tooltip-gravity-e-w":this.gravity()==="e"||this.gravity()==="w","dcg-tooltip-theme-light":((t=(e=this.props).theme)==null?void 0:t.call(e))==="light","dcg-tooltip-theme-dark":((o=(i=this.props).theme)==null?void 0:o.call(i))!=="light"}},style:()=>{var e,t,i,o;return{top:`${this.props.hitAreaRect().top+(((t=(e=this.props).offset)==null?void 0:t.call(e).top)||0)}px`,left:`${this.props.hitAreaRect().left+(((o=(i=this.props).offset)==null?void 0:o.call(i).left)||0)}px`,width:`${this.props.hitAreaRect().width}px`,height:`${this.props.hitAreaRect().height}px`}}},Hn.createElement("div",{class:Hn.const("dcg-tooltip-message-container"),style:this.bindFn(this.getMessageStyle)},Hn.createElement("div",{role:Hn.const("tooltip"),id:this.const(this.uuid),class:()=>({"dcg-tooltip-message":!0,"dcg-sticky-not-stuck":this.props.isStickyAndNotStuck()}),onMount:e=>this.tooltipMessage=e,style:()=>({left:`${Math.round(this.offsetLeft)}px`})},_j(()=>!!this.props.customTooltipView,{true:()=>this.props.customTooltipView(),false:()=>Hn.createElement("span",null,this.props.tooltip)}))),Hn.createElement("div",{class:()=>({"dcg-tooltip-arrow":!0,[this.getTooltipGravityClass()]:!0}),style:()=>{var e,t;return((t=(e=this.props).theme)==null?void 0:t.call(e))==="light"?this.getArrowWithBorderStyle():this.getSolidArrowStyle()}}))}updatePositionIfNecessary(){if(this.gravity()!=="s"&&this.gravity()!=="n")return;let e=this.tooltipMessage.getBoundingClientRect(),t=this.tooltipMessage.closest(".dcg-tap-container");if(!t)return;let i=t.getBoundingClientRect();e.right+sw>i.right?this.offsetLeft=i.right-e.right-sw:e.left-sw<i.left&&(this.offsetLeft=i.left-e.left+sw),this.offsetLeft!==0&&this.update()}didMount(){this.updatePositionIfNecessary()}getTooltipGravityClass(){switch(this.gravity()){case"n":return"dcg-tooltip-gravity-n";case"s":return"dcg-tooltip-gravity-s";case"e":return"dcg-tooltip-gravity-e";case"w":return"dcg-tooltip-gravity-w"}}getArrowWithBorderStyle(){let e=this.gravity(),t=this.getBackgroundColor(),i="#bbb",o="8px",n={width:o,height:o,border:`1px solid ${i}`,background:t};switch(e){case"s":return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},n),{top:"100%",left:"50%","margin-top":"1px","border-right":"0","border-bottom":"0"});case"n":return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},n),{bottom:"100%",left:"50%","margin-bottom":"1px","border-left":"0","border-top":"0"});case"e":return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},n),{top:"50%",left:"100%","margin-left":"1px","border-right":"0","border-top":"0"});case"w":return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},n),{top:"50%",right:"100%","margin-right":"1px","border-left":"0","border-bottom":"0"});default:return e}}getSolidArrowStyle(){let e=this.gravity(),t=this.getBackgroundColor(),i=`transparent transparent ${t} transparent`,o=`${t} transparent transparent transparent`,n=`transparent ${t} transparent transparent`,a=`transparent transparent transparent ${t}`,s=`-${Hd}px`;switch(e){case"s":return{top:"100%",left:"50%",border:`${Hd}px solid transparent`,"border-color":i,"margin-top":s,"margin-left":s};case"n":return{bottom:"100%",left:"50%",border:`${Hd}px solid transparent`,"border-color":o,"margin-bottom":s,"margin-left":s};case"e":return{top:"50%",left:"100%",border:`${Hd}px solid transparent`,"border-color":n,"margin-left":`-${Hd}px`,"margin-top":s};case"w":return{top:"50%",right:"100%",border:`${Hd}px solid transparent`,"border-color":a,"margin-right":s,"margin-top":s};default:return e}}getBackgroundColor(){var e,t;return((t=(e=this.props).theme)==null?void 0:t.call(e))==="light"?"#fff":this.props.isStickyAndNotStuck()?"#666":"#000"}getMessageStyle(){let e=this.props.hitAreaRect(),t=this.gravity(),i=this.props.maxWidth();switch(t){case"s":return{top:"100%",width:`${i}px`,transform:"translate(-50%, 0)",left:`${.5*e.width}px`,"margin-top":`${Hd}px`,"text-align":"center"};case"n":return{bottom:"100%",width:`${i}px`,transform:"translate(-50%, 0)",left:`${.5*e.width}px`,"margin-bottom":`${Hd}px`,"text-align":"center"};case"e":return{transform:"translate(0, -50%)",left:"100%",width:`${i}px`,top:`${.5*e.height}px`,"margin-left":`${Hd}px`,"text-align":"left"};case"w":return{transform:"translate(0, -50%)",right:"100%",width:`${i}px`,top:`${.5*e.height}px`,"margin-right":`${Hd}px`,"text-align":"right"};default:return t}}};function Rj(){return document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}var Me=class extends Hn.Class{init(){this.uuid=`dcg-tooltip-${Ud()}`}template(){return Hn.createElement("div",{class:()=>{var e,t;return{"dcg-tooltip-hit-area-container":!0,"dcg-display-block":(t=(e=this.props).displayBlock)==null?void 0:t.call(e),"dcg-tooltip-disabled":this.props.disabled&&this.props.disabled()}},handleevent:Hn.const("true"),didMount:e=>{this.isMounted=!0,this.hitAreaNode=e,this.setupEventListeners(this.hitAreaNode)},onTap:()=>{if(this.shouldStickOnTargetClick())if(this.isStuck)this.clearTimeouts(),this.hideTooltip();else{if(this.props.disabled&&this.props.disabled())return;this.showTooltip(),this.stickTooltip()}else if(this.shouldShowOnTapstart()){if(this.props.disabled&&this.props.disabled())return;this.showTooltip(),this.setUpHideOnExternalMousedown()}else this.hideTooltipImmediately()}},this.children)}shouldShowOnTapstart(){return this.props.showOnTapstart&&this.props.showOnTapstart()}didUpdate(){this.updateTooltip()}updateTooltip(){if(!this.wrapperRef)return;if(!this.props.tooltip()){this.hideTooltip();return}let e=this.hitAreaNode.getBoundingClientRect(),t=this.wrapperRef.elt.getBoundingClientRect(),{originalTop:i,originalLeft:o}=this.wrapperRef,n=e.top-t.top,a=e.left-t.left;Math.abs(n-i)>3||Math.abs(a-o)>3?this.hideTooltip():this.wrapperRef.view.update()}handleShowEvent(e){if(this.props.disabled&&this.props.disabled())return;let t=this.props.delay?this.props.delay():Fj;this.clearTimeouts(),this.showTooltipTimeout=setTimeout(e,t)}hideTooltipImmediately(){this.clearTimeouts(),this.hideTooltip()}handleHideEvent(){this.clearTimeouts(),this.hideTooltipTimeout=setTimeout(this.bindFn(this.hideTooltip),150)}setupEventListeners(e){H(e).on("tipsyshow",t=>{t.target===e&&this.handleShowEvent(()=>{this.showTooltip()})}).on("tipsyhide",t=>{t.target!==e||this.isStuck||this.handleHideEvent()})}willUnmount(){this.clearTimeouts(),this.isMounted=!1,this.hideTooltip()}setUpHideOnExternalMousedown(){H(document).on(`mousedown.dcg-tooltip-${this.uuid} touchstart.dcg-tooltip-${this.uuid} pointerdown.dcg-tooltip-${this.uuid}`,e=>{this.wrapperRef&&(this.hitAreaNode.contains(e.target)||this.wrapperRef.elt.contains(e.target)||this.hideTooltip())})}stickTooltip(){this.isMounted&&this.wrapperRef&&(this.isStuck||(this.setUpHideOnExternalMousedown(),this.isStuck=!0,this.updateTooltip()))}clearTimeouts(){clearTimeout(this.showTooltipTimeout),clearTimeout(this.hideTooltipTimeout)}showTooltip(){var h,x,C;if(!this.isMounted||this.wrapperRef||!this.props.tooltip())return;let e=this.hitAreaNode.getBoundingClientRect(),t=document.createElement("div");t.className="dcg-tooltip-mount-pt";let i=this.hitAreaNode.closest(".dcg-tap-container"),o=Rj();(!!o&&o.contains(this.hitAreaNode)&&o.closest(".dcg-tap-container")?o:i).appendChild(t);let a=t.getBoundingClientRect(),s=e.left-a.left,l=e.top-a.top,c=200;if((x=(h=this.props).noWrap)!=null&&x.call(h)){let D=(C=t.closest(".dcg-tap-container"))==null?void 0:C.getBoundingClientRect();D&&(c=D.width-2*sw)}let p=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{isStickyAndNotStuck:()=>this.shouldStickOnTargetClick()&&!this.isStuck,maxWidth:()=>c,hitAreaRect:()=>({top:l||0,left:s||0,width:e.width||0,height:e.height||0}),uuid:()=>this.uuid});this.setupEventListeners(t),H(t).on("dcg-tap",()=>{this.shouldStickOnTargetClick()&&this.stickTooltip()});let u=Hn.mountToNode(BM,t,p);H(document).on(`keydown.dcg-tooltip-${this.uuid}`,D=>{Ee(D)===hn&&this.hideTooltip()});let m=()=>this.updateTooltip();window.addEventListener("scroll",m,!0),this.wrapperRef={elt:t,view:u,originalLeft:s,originalTop:l,onScroll:m},this.assignAriaDescribedBy()}hideTooltip(){this.clearTimeouts(),this.wrapperRef&&(this.isStuck=!1,H(document).off(`.dcg-tooltip-${this.uuid}`),window.removeEventListener("scroll",this.wrapperRef.onScroll,!0),this.restoreAriaDescribedBy(),Hn.unmountFromNode(this.wrapperRef.elt),this.wrapperRef.elt.parentNode&&this.wrapperRef.elt.parentNode.removeChild(this.wrapperRef.elt),this.wrapperRef=void 0)}assignAriaDescribedBy(){let e=pE(this.hitAreaNode)[0]||this.hitAreaNode;this.originalDescribedBy=e.getAttribute("aria-describedby"),e.setAttribute("aria-describedby",this.uuid)}restoreAriaDescribedBy(){let e=pE(this.hitAreaNode)[0]||this.hitAreaNode;this.originalDescribedBy?e.setAttribute("aria-describedby",this.originalDescribedBy):e.removeAttribute("aria-describedby")}shouldStickOnTargetClick(){return!!this.props.sticky&&this.props.sticky()}};var Yp=__dcg_shared_module_exports__['h'](z());var uE=class extends Yp.Class{template(){return Yp.createElement("div",{class:Yp.const("dcg-dot-dot-dropdown")},Yp.createElement("span",null),Yp.createElement("span",null),Yp.createElement("span",null))}};var Js=__dcg_shared_module_exports__['h'](z());var nb=class extends Js.Class{template(){return Js.createElement("span",{class:Js.const("dcg-navigate-back"),onTap:this.props.onBack,"aria-label":this.props.ariaLabel,role:Js.const("button"),tabindex:Js.const("0"),handleEvent:Js.const("true"),manageFocus:this.const(Qe({controller:this.props.controller(),location:{type:"geo-header-back-link"}}))},Js.createElement("i",{class:Js.const("dcg-icon-chevron-left"),"aria-hidden":Js.const("true")}),Js.createElement("div",{class:Js.const("dcg-navigate-back-message")},this.props.message))}};var Ki=__dcg_shared_module_exports__['h'](z());var Tl=__dcg_shared_module_exports__['h'](z());var st=class extends Tl.Class{template(){return Tl.createElement("div",{role:Tl.const("checkbox"),tabindex:()=>this.props.disabled&&this.props.disabled()?-1:0,"aria-label":()=>{var e,t;return(t=(e=this.props).ariaLabel)==null?void 0:t.call(e)},"aria-labelledby":()=>{var e,t;return(t=(e=this.props).labelledBy)==null?void 0:t.call(e)},"aria-describedby":()=>{var e,t;return(t=(e=this.props).describedBy)==null?void 0:t.call(e)},"aria-disabled":()=>this.props.disabled&&this.props.disabled(),"aria-checked":this.props.checked,manageFocus:()=>{var e,t;return(t=(e=this.props).manageFocus)==null?void 0:t.call(e)},class:()=>({"dcg-component-checkbox":!0,"dcg-checked":this.props.checked(),"dcg-disabled":this.props.disabled&&this.props.disabled(),"dcg-small":this.props.small&&this.props.small(),[this.props.class===void 0?"":this.props.class()]:this.props.class!==void 0}),style:()=>this.props.style?this.props.style():{},onTap:this.bindFn(this.onChange)},Tl.createElement("span",{class:Tl.const("dcg-checkbox")},Tl.createElement("i",{class:Tl.const("dcg-icon-check"),"aria-hidden":Tl.const("true")})),Tl.createElement("span",{class:Tl.const("dcg-checkbox-children")},this.children))}onChange(e){let t=e.target;t&&t.getAttribute("href")||this.props.disabled&&this.props.disabled()||this.props.onChange(!this.props.checked())}};var Es=__dcg_shared_module_exports__['h'](z());var{Input:Nj}=Es.Components,hE=class extends Es.Class{init(){this.controller=this.props.controller(),this.cacheFolderList(),this.newFolderTitle=""}willUpdate(){this.cacheFolderList()}template(){return Es.createElement("div",{class:Es.const("dcg-move-to-folder")},Es.createElement("div",{class:Es.const("dcg-move-to-folder-title")},this.bindFn(this.getMoveMessage)),Es.createElement("div",{class:Es.const("dcg-move-to-folder-flex")},Es.createElement(Nj,{"aria-label":this.bindFn(this.getMoveMessage),value:()=>this.newFolderTitle,onInput:e=>{this.newFolderTitle=e,this.update()},placeholder:()=>this.controller.s("graphing-calculator-label-geometry-move-to-folder-placeholder"),didMount:e=>{e.onkeydown=function(t){let i=Ee(t);(i==="Backspace"||i==="Del")&&t.stopPropagation()}},onEnterPressed:this.bindFn(this.onEnterPressed)}),Es.createElement("div",{class:()=>({"dcg-btn-blue":!0,"dcg-disabled":!this.newFolderTitle}),role:Es.const("button"),tabindex:()=>this.newFolderTitle?0:-1,onTap:this.bindFn(this.createNewFolder)},()=>this.controller.s("graphing-calculator-button-move-to-folder-action"))))}getMoveMessage(){let e=new Vo(this.controller.getAllSelectedItems().length);return this.controller.s("graphing-calculator-text-geometry-move-to-folder-message",{count:e})}onEnterPressed(){let e=!1;this.folderList.forEach(t=>{t.title===this.newFolderTitle&&(e=!0,this.chooseFolder(t.id))}),e||this.createNewFolder()}chooseFolder(e){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"folderId",value:e}})}createNewFolder(){this.newFolderTitle&&this.controller.dispatch({type:"update-all-selected-items",update:{prop:"folderId",value:this.newFolderTitle,createFolder:!0}})}cacheFolderList(){this.folderList=[],this.controller.getAllItemModels().forEach(e=>{e.type==="folder"&&!this.controller.isGeoFolder(e)&&this.folderList.push(e)})}};var fE=__dcg_shared_module_exports__['h'](z());var Rt=__dcg_shared_module_exports__['h'](z());var gE=__dcg_shared_module_exports__['h'](z());var Bj=.9,Dg=class extends gE.Class{template(){return gE.createElement("div",{class:()=>{var e,t;return{"dcg-color-swatch":!0,"dcg-color-evaluation":(t=(e=this.props).isEvaluation)==null?void 0:t.call(e),"dcg-light-color":vk(this.props.color(),this.props.invertSwatches(),Bj)}},style:()=>({background:Kf(this.props.color())})})}};var lw=__dcg_shared_module_exports__['h'](z());var ab=class extends lw.Class{template(){return lw.createElement(Me,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{customTooltipView:()=>lw.createElement(ze,{latex:this.props.tooltip,config:this.const({})}),theme:this.const("light"),noWrap:this.const(!0)}),this.children)}};var{For:qM,If:cw}=Rt.Components,Wn=class extends Rt.Class{init(){this.controller=this.props.controller()}template(){return Rt.createElement("div",{class:Rt.const("dcg-color-picker-container")},Rt.createElement(qM,{each:()=>this.getColorValues()},Rt.createElement("div",{class:Rt.const("dcg-color-picker-menu dcg-do-not-blur")},e=>Rt.createElement("div",{class:Rt.const("dcg-color-tile"),handleevent:Rt.const("true"),role:Rt.const("button"),tabindex:Rt.const("0"),"aria-label":()=>gg(this.controller,e),"aria-pressed":()=>this.isSelected(e),onTap:()=>this.props.onColorSelected(e)},Rt.createElement(Dg,{color:()=>({type:"single-color",value:e}),invertSwatches:()=>this.controller.invertSwatches()}),Rt.createElement(cw,{predicate:()=>this.isSelected(e)},()=>Rt.createElement("i",{class:Rt.const("dcg-icon-check"),"aria-hidden":Rt.const("true")}))))),Rt.createElement(cw,{predicate:()=>this.getUniqueCustomColors().length>0},()=>Rt.createElement(qM,{each:this.bindFn(this.getUniqueCustomColors),key:e=>e.assignmentLatex},Rt.createElement("div",{class:Rt.const("dcg-color-picker-menu dcg-do-not-blur")},e=>Rt.createElement(ab,{tooltip:()=>e.assignmentLatex},Rt.createElement("div",{class:Rt.const("dcg-color-tile"),handleevent:Rt.const("true"),role:Rt.const("button"),tabindex:Rt.const(0),"aria-label":()=>ca(e.assignmentLatex),"aria-pressed":()=>this.props.colorLatex()===e.assignmentLatex,onTap:()=>this.props.onCustomColorSelected(e.assignmentLatex)},Rt.createElement(Dg,{color:()=>this.getColorValue(e),invertSwatches:()=>this.controller.invertSwatches()}),Rt.createElement(cw,{predicate:()=>this.props.colorLatex()===e.assignmentLatex},()=>Rt.createElement("i",{class:()=>this.getCheckmarkClass(e),"aria-hidden":Rt.const("true")}))))))),Rt.createElement(cw,{predicate:()=>this.canUsePatterns()&&this.getAllImages().length>0},()=>Rt.createElement(qM,{each:this.bindFn(this.getAllImages),key:e=>e.id},Rt.createElement("div",{class:Rt.const("dcg-color-picker-menu dcg-do-not-blur")},e=>Rt.createElement(Me,{tooltip:()=>this.controller.raw(e.name)},Rt.createElement("div",{class:Rt.const("dcg-color-tile"),handleevent:Rt.const("true"),role:Rt.const("button"),tabindex:Rt.const(0),"aria-label":()=>this.controller.raw(e.name),"aria-pressed":()=>this.props.colorLatex()===e.url,onTap:()=>this.props.onCustomColorSelected(e.url)},Rt.createElement("div",{class:()=>({"dcg-color-swatch":!0,"dcg-has-background-image":!0}),style:()=>({"background-image":'url("'+e.url+'")'})}),Rt.createElement(cw,{predicate:()=>this.props.colorLatex()===e.url},()=>Rt.createElement("i",{class:()=>"dcg-icon-check dcg-mixed-color","aria-hidden":Rt.const("true")}))))))))}canUsePatterns(){var e,t,i;return(i=(t=(e=this.props).canUsePatterns)==null?void 0:t.call(e))!=null?i:!1}hideColorFunctions(){var e,t,i;return(i=(t=(e=this.props).hideColorFunctions)==null?void 0:t.call(e))!=null?i:!1}isSelected(e){var t=this.props.colorLatex();return t&&__dcg_shared_module_exports__['x'](this.getUniqueCustomColors(),"assignmentLatex").indexOf(t)>=0?!1:this.props.selectedColor()===e}getColorValues(){return __dcg_shared_module_exports__['N'](this.controller.getColors())}getUniqueCustomColors(){if(this.props.hideCustomColors&&this.props.hideCustomColors())return[];let e=[];this.canUsePatterns()&&this.controller.isBeta3DMode()&&(e.push({id:"gradient_u",assignmentLatex:"gradient_u"},{id:"gradient_v",assignmentLatex:"gradient_v"}),e.push({id:"checkers",assignmentLatex:"checkers"})),e.push(...this.controller.getAllColorAssignments()),this.hideColorFunctions()||e.push(...this.controller.getAllColorFunctionAssignments());let t=__dcg_shared_module_exports__['C'](e,i=>i.assignmentLatex);return e.filter(i=>t[i.assignmentLatex]===1)}getAllImages(){return this.controller.getAllImages()}getColorValue(e){switch(e.id){case"gradient_u":case"gradient_v":case"checkers":case"shader":return{type:e.id};default:let t=this.controller.getColorById(e.id);return Array.isArray(t)?{type:"color-array",value:t}:/^data:image/.test(t)?{type:"image",value:t}:{type:"single-color",value:t}}}getCheckmarkClass(e){return vk(this.getColorValue(e),!1)?`dcg-icon-check ${f5(this.getColorValue(e),!1)?"dcg-light-color":"dcg-mixed-color"}`:"dcg-icon-check"}};var mE=class extends fE.Class{init(){this.controller=this.props.controller(),this.cacheSelectedColor()}template(){return fE.createElement(Wn,{controller:this.props.controller,colorLatex:()=>this.colorLatex,selectedColor:()=>this.selectedColor,onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected),hideCustomColors:this.const(!1)})}onCustomColorSelected(e){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"colorLatex",value:e}})}cacheSelectedColor(){let e=__dcg_shared_module_exports__['t'](this.controller.getAllSelectedItems(),t=>t.type==="expression");if(e.length===0){this.selectedColor="",this.colorLatex="";return}this.selectedColor=Nc(e[0]),this.colorLatex=e[0].colorLatex;for(let t=1;t<e.length;t++)if(this.selectedColor!==Nc(e[t])||this.colorLatex!==e[t].colorLatex){this.selectedColor="",this.colorLatex="";return}}willUpdate(){this.cacheSelectedColor()}onColorSelected(e){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"color",value:e}})}getFirstSelectedExpression(){var e=this.controller.getAllSelectedItems();for(let t of e)if(t.type==="expression")return t}};var Xs=__dcg_shared_module_exports__['h'](z());var Ea=__dcg_shared_module_exports__['h'](z());var{For:qj,If:Kj}=Ea.Components,_r=class extends Ea.Class{init(){this.config=this.props.staticConfig()}template(){return Ea.createElement(qj,{each:()=>this.config,key:e=>e.key},Ea.createElement("div",{class:Ea.const("dcg-segmented-control-container"),role:Ea.const("group"),"aria-label":this.props.ariaGroupLabel},e=>Ea.createElement("div",{class:()=>({"dcg-segmented-control-btn":!0,"dcg-selected":e.selected(),"dcg-theme-mini":this.getTheme()==="mini","dcg-theme-default":this.getTheme()==="default","dcg-disabled":this.isDisabled(),[e.class?e.class():""]:!!e.class}),role:Ea.const("button"),tabindex:Ea.const(0),"aria-label":()=>this.getAriaLabel(e),style:()=>({"min-width":this.props.minButtonWidth?this.props.minButtonWidth()+"px":void 0}),"aria-pressed":()=>e.selected(),onTap:()=>{this.isDisabled()||e.onSelect()},manageFocus:()=>{if(e.focusHelperOptions)return Qe(e.focusHelperOptions)}},Ea.createElement(Me,{tooltip:()=>e.tooltip?e.tooltip():"",gravity:()=>e.tooltipGravity?e.tooltipGravity():"s",disabled:()=>!(e.tooltip&&e.tooltip())},Ea.createElement("div",{class:Ea.const("dcg-segmented-control-interior")},()=>e.label?e.label():"",Ea.createElement(Kj,{predicate:()=>!!e.icon},()=>Ea.createElement("i",{class:()=>e.icon?e.icon():""})))))))}getAriaLabel(e){return e.ariaLabel?e.ariaLabel():e.label?e.label():e.tooltip?e.tooltip():""}isDisabled(){return this.props.disabled&&this.props.disabled()}getTheme(){return this.props.theme?this.props.theme():"default"}};var{Input:zj,IfElse:Uj}=Xs.Components,Sg=class extends Xs.Class{template(){return this.controller=this.props.controller(),Xs.createElement("div",{class:()=>({"dcg-label-visible":this.getShowLabel(),"dcg-label-container":!0,"dcg-do-blur":!0}),tapboundary:Xs.const("true"),handleEvent:Xs.const("true")},Xs.createElement(st,{onChange:this.bindFn(this.onCheckboxInput),checked:this.bindFn(this.getShowLabel)},()=>this.controller.s("graphing-calculator-button-label")+(this.getIsDisabled()?"":":")),Uj(this.bindFn(this.hasEditableLabel),{true:()=>Xs.createElement("div",{class:Xs.const("dcg-editable-mode-toggle")},Xs.createElement(_r,{theme:this.const("mini"),staticConfig:this.bindFn(this.getEditableLabelOptions),ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-editable-label-mode")})),false:()=>Xs.createElement(zj,{class:()=>({"dcg-label-input":!0,"dcg-disabled-input":this.getIsDisabled(),"dcg-disabled-editable-input":this.hasEditableLabel(),"dcg-readonly":this.getIsReadonly()}),disabled:this.bindFn(this.getIsReadonly),"aria-label":()=>this.controller.s("graphing-calculator-narration-label-text"),"aria-disabled":()=>this.getIsDisabled()||this.hasEditableLabel()||this.getIsReadonly(),value:this.bindFn(this.getLabel),onInput:this.bindFn(this.onLabelInput)})}))}getEditableLabelOptions(){return[{key:"math",label:()=>this.controller.s("graphing-calculator-button-editable-math"),selected:()=>this.model().editableLabelMode==="MATH",onSelect:()=>this.setEditableLabelMode("MATH")},{key:"text",label:()=>this.controller.s("graphing-calculator-button-editable-text"),selected:()=>this.model().editableLabelMode==="TEXT",onSelect:()=>this.setEditableLabelMode("TEXT")}]}setEditableLabelMode(e){this.controller.dispatch({type:"set-item-editable-label-mode",id:this.id(),editableLabelMode:e})}getIsReadonly(){return this.controller.isItemReadonly(this.model().id)}model(){return this.props.model()}id(){return this.model().id}getLabel(){return this.model().label||""}hasEditableLabel(){return bf(this.model())}getShowLabel(){return _c(this.model())}getIsDisabled(){return this.getLabel().length===0&&!this.getShowLabel()}onLabelInput(e){var t=e;this.controller.dispatch({type:"set-item-label",id:this.id(),label:t}),this.controller.dispatch({type:"set-item-showlabel",id:this.id(),showLabel:!!t})}onCheckboxInput(){if(this.props.useSmartPointLabeling&&this.props.useSmartPointLabeling()){this.controller.dispatch({type:"toggle-label-for-all-selected-points"});return}this.controller.dispatch({type:"set-item-showlabel",id:this.id(),showLabel:!this.getShowLabel()})}};var{If:dw}=Ki.Components,bE=class extends Ki.Class{init(){this.controller=this.props.controller(),this.cacheSectionValues()}willUpdate(){this.cacheSectionValues()}isIconModelFocused(){return this.controller.isFocusLocationFocused({type:"multi-select-more-icon"})}template(){return Ki.createElement("div",{class:()=>({"dcg-generic-options-menu":!0,"dcg-options-menu":!0,"dcg-multi-select-options-menu":!0}),role:Ki.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-options-menu")},Ki.createElement("div",{class:Ki.const("dcg-options-menu-section")},Ki.createElement("div",{class:Ki.const("dcg-multi-select-color-picker")},Ki.createElement(mE,{controller:this.props.controller})),Ki.createElement(dw,{predicate:()=>this.sectionValues.showPointLabels!==void 0},()=>Ki.createElement("div",{class:Ki.const("dcg-checkbox-section")},Ki.createElement(st,{checked:()=>!!this.sectionValues.showPointLabels,onChange:this.bindFn(this.onShowPointLabelChanged)},()=>this.controller.s("graphing-calculator-button-geometry-label-points-checkbox")))),Ki.createElement(dw,{predicate:()=>this.sectionValues.singleLabelableExpressionModel!==void 0},()=>Ki.createElement("div",{class:Ki.const("dcg-checkbox-section")},Ki.createElement(Sg,{controller:this.props.controller,model:()=>this.sectionValues.singleLabelableExpressionModel,useSmartPointLabeling:()=>this.sectionValues.draggableFreePoint!==void 0}))),Ki.createElement(dw,{predicate:()=>this.sectionValues.draggableFreePoint!==void 0},()=>Ki.createElement("div",{class:Ki.const("dcg-checkbox-section")},Ki.createElement(st,{checked:()=>!!this.sectionValues.draggableFreePoint,onChange:this.bindFn(this.onDraggableFreePointChanged)},()=>this.controller.s("graphing-calculator-button-draggable")))),Ki.createElement(dw,{predicate:()=>this.sectionValues.arrowMode!==void 0},()=>Ki.createElement("div",null,()=>this.controller.s("graphing-calculator-text-geometry-arrow-mode",{mode:this.getArrowModeDisplayName()}))),Ki.createElement(dw,{predicate:()=>this.controller.getGraphSettings().config.expressions},()=>Ki.createElement(hE,{controller:this.props.controller}))))}onShowPointLabelChanged(){this.controller.dispatch({type:"toggle-label-for-all-selected-points"})}onDraggableFreePointChanged(e){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"dragMode",value:e?"AUTO":"NONE"}})}cacheSectionValues(){this.sectionValues=this.computeSectionValues()}computeSectionValues(){var n;let e={showPointLabels:[],singleLabelableExpressionModel:[],draggableFreePoint:[],arrowMode:[]},t=this.controller.getAllSelectedItems();for(let a of t){if(a.type!=="expression")return{};let s=(n=a.formula.geometry)==null?void 0:n.valueType;if(s===void 0)return{};if(__dcg_shared_module_exports__['Ka'](s)&&(s=__dcg_shared_module_exports__['La'](s)),!__dcg_shared_module_exports__['Ma'](s))return{};switch(s){case __dcg_shared_module_exports__['da']:e.showPointLabels.push(a.showLabel),e.singleLabelableExpressionModel.push(a),a.formula.move_strategy&&e.draggableFreePoint.push(a.dragMode!=="NONE");break;case __dcg_shared_module_exports__['la']:break;case __dcg_shared_module_exports__['ra']:e.arrowMode.push(a.arrowMode);break;case __dcg_shared_module_exports__['pa']:break;case __dcg_shared_module_exports__['ta']:break;case __dcg_shared_module_exports__['va']:break;case __dcg_shared_module_exports__['Da']:break;case __dcg_shared_module_exports__['na']:e.singleLabelableExpressionModel.push(a),e.arrowMode.push(a.arrowMode);break;case __dcg_shared_module_exports__['xa']:case __dcg_shared_module_exports__['za']:e.singleLabelableExpressionModel.push(a);break;case __dcg_shared_module_exports__['Ba']:break;default:return s}}let i={},o=t.length;for(let a in e){let s=a;switch(s){case"singleLabelableExpressionModel":{let c=e[s];o===1&&c.length===1&&(i[s]=c[0])}break;case"showPointLabels":{let c=e[s];c.length>0&&o>1&&(i[s]=__dcg_shared_module_exports__['u'](c,p=>!!p))}break;case"draggableFreePoint":{let c=e[s];c.length>0&&(i[s]=__dcg_shared_module_exports__['v'](c))}break;case"arrowMode":break;default:return s}}return i}getArrowModeDisplayName(){let e=this.sectionValues.arrowMode;if(!e)return"";switch(e){case"NONE":return this.controller.s("graphing-calculator-text-arrow-mode-none");case"DEFAULT":return this.controller.s("graphing-calculator-text-arrow-mode-default");case"POSITIVE":return this.controller.s("graphing-calculator-text-arrow-mode-positive");case"BOTH":return this.controller.s("graphing-calculator-text-arrow-mode-both")}}};var gr=__dcg_shared_module_exports__['h'](z());var JM={};__dcg_shared_module_exports__['g'](JM,{CLCalculator:()=>rq,Label:()=>__dcg_shared_module_exports__['lb'],applyDiff:()=>sq,applyLocalizationMap:()=>dq,blankGeometryCalculatorState:()=>IY,blankGraphingCalculatorState:()=>TY,builtInFrame:()=>kY,calculateDiff:()=>nq,colorHelpers:()=>__dcg_shared_module_exports__['q'],context:()=>SY,expressionParser:()=>$M,extractLocalizationMap:()=>cq,formatLatex:()=>hq,migrateGeoStateToCalcState:()=>Uc,migrateToLatest:()=>Vc,numberToDecimalString:()=>__dcg_shared_module_exports__['sc'],numberToLatex:()=>__dcg_shared_module_exports__['rc'],parseNodes:()=>Cq,parser:()=>CY,policies:()=>GY,replaceIdentifierWithLatex:()=>RV,treeQueries:()=>DY,types:()=>EY});function rq(r){let e=Vc(r);var t={},i=e.graph.degreeMode,o=e.randomSeed;let n=e.graph.product==="graphing"?"graphing":"geometry";function a(l){switch(l.type){case void 0:case"expression":{let p=__dcg_shared_module_exports__['kd'](__dcg_shared_module_exports__['gd'](l,{is3d:!1}));t[p.id]=p}break;case"table":{let p=Ek(kk(l));t[p.id]=p}break;case"folder":case"text":case"image":break;default:return l}}for(var s of e.expressions.list)a(s);return{setExpression(l){a(l)},getChangeSet(){return{statements:t,isCompleteState:!0,degreeMode:i,globalRandomSeed:o,evaluationMode:n}}}}function sb(r,e){switch(r.type){case"Mul":case"DotMul":case"CrossMul":case"Div":case"Prime":case"Call":case"ImplicitCall":case"Dot":case"Pipes":case"Sqrt":case"Nthroot":case"Frac":case"Derivative":case"Integral":case"EmptyIntegral":case"Sum":case"Product":case"Piecewise":case"Paren":case"Juxt":case"Superscript":case"Bang":case"Index":case"Equals":case"Inequality":case"Tilde":case"Pos":case"Neg":case"Add":case"Sub":case"List":case"Seq":case"Colon":case"Ellipsis":case"PercentOf":case"RightArrow":case"For":case"With":{let i=0;for(let o of r.args)i+=sb(o,e);return i}case"Decimal":return e===void 0||parseFloat(r.val)===e?1:0;case"MixedNumber":{if(e===void 0)return 3;let i=0;return parseFloat(r.whole)===e&&(i+=1),parseFloat(r.num)===e&&(i+=1),parseFloat(r.den)===e&&(i+=1),i}case"Letter":case"EmptyPiecewise":case"Cmd":case"EmptyRangeEnd":return 0;case"Subscript":return sb(r.args[0],e);case"InequalityChain":{let i=0;i+=sb(r.first,e);for(let o of r.chain)i+=sb(o.args[0],e);return i}default:throw`Unexpected surface node ${r.type}.`}}function iq(r){let e=r.length,t=new Array(e),i=new Array(e+1),o=0;for(let s=0;s<e;s++){let l;if(r[i[o]]<r[s])l=o+1;else{let c=1,p=o-1;for(;c<=p;){let u=Math.ceil((c+p)/2);r[i[u]]<r[s]?c=u+1:p=u-1}l=c}t[s]=i[l-1],i[l]=s,l>o&&(o=l)}let n=new Array(o),a=i[o];for(let s=o-1;s>=0;s--)n[s]=r[a],a=t[a];return n}function nq(r,e){return yE(r,e,0)}function yE(r,e,t){let i={};for(let o in r){if(!r.hasOwnProperty(o))continue;if(!e.hasOwnProperty(o)){i[o]={d:1};continue}let n=r[o],a=e[o],s=Hj(n,a,t,o);s&&(i[o]=s)}for(let o in e)e.hasOwnProperty(o)&&!r.hasOwnProperty(o)&&(i[o]={s:e[o]});return i}function Hj(r,e,t,i){if(__dcg_shared_module_exports__['R'](r)&&__dcg_shared_module_exports__['R'](e)){if(t===1&&i==="list"||t===2&&i==="columns")return $j(r,e);if(!__dcg_shared_module_exports__['P'](r,e))return{s:e}}else if(__dcg_shared_module_exports__['S'](r)&&__dcg_shared_module_exports__['S'](e)){let o=yE(r,e,Wj(t,i));if(!__dcg_shared_module_exports__['Q'](o))return{e:o}}else if(!__dcg_shared_module_exports__['P'](r,e))return{s:e}}function Wj(r,e){return r===0&&e==="expressions"?1:3}function $j(r,e){let t={},i={};for(let s=0;s<r.length;s++){if(i[r[s].id]!==void 0)return{s:e};i[r[s].id]=s}let o={};for(let s=0;s<e.length;s++){if(o[e[s].id]!==void 0)return{s:e};o[e[s].id]=s}let n=jj(r,e,i),a=0;for(let s=0;s<r.length;s++){let l=r[s];if(!n[l.id])t[s]={d:1};else{let c=o[l.id],p=e[c],u={};if(a!==c&&(u.a=e.slice(a,c).map(m=>oq(r,i,m))),!__dcg_shared_module_exports__['P'](l,p)){let m=l.type==="table"&&p.type==="table";u.e=yE(l,p,m?2:3)}__dcg_shared_module_exports__['Q'](u)||(t[s]=u),a=c+1}}if(a<e.length&&(t[r.length]={a:e.slice(a,e.length).map(s=>oq(r,i,s))}),!__dcg_shared_module_exports__['Q'](t))return{l:t}}function oq(r,e,t){if(e[t.id]){let i=r[e[t.id]],o={f:e[t.id]};return __dcg_shared_module_exports__['P'](i,t)||(o.e=yE(i,t,3)),{m:o}}return{s:t}}function jj(r,e,t){let i={},o=e.filter(a=>t[a.id]!==void 0).map(a=>t[a.id]),n=iq(o);for(let a of n)i[r[a].id]=!0;return i}function sq(r,e){let t=__dcg_shared_module_exports__['j'](r);return xE(t,e)}function xE(r,e){for(let t of __dcg_shared_module_exports__['M'](e)){let i=e[t];Jj(i)?r[t]=i.s:Xj(i)?delete r[t]:Qj(i)?r[t]=Yj(r[t],i.l):Zj(i)&&(r[t]=xE(r[t],i.e))}return r}function Yj(r,e){let t=[];for(let o=0;o<r.length;o++){let n=e[o];n&&n.a&&t.push(...aq(r,n.a)),n&&n.e?t.push(xE(r[o],n.e)):(!n||!n.d)&&t.push(r[o])}let i=e[r.length];return i&&i.a&&t.push(...aq(r,i.a)),t}function aq(r,e){let t=[];for(let i of e)if(eY(i))t.push(i.s);else if(tY(i)){let o=r[i.m.f];i.m.e?t.push(xE(o,i.m.e)):t.push(o)}return t}function Jj(r){return r.hasOwnProperty("s")}function Xj(r){return r.hasOwnProperty("d")}function Qj(r){return r.hasOwnProperty("l")}function Zj(r){return r.hasOwnProperty("e")}function eY(r){return r.hasOwnProperty("s")}function tY(r){return r.hasOwnProperty("m")}function lq(r){return r.location==="expression"||r.location==="object"?`${r.location}:${r.id}:${r.path}`:`${r.location}:${r.path}`}function KM(r){let e=()=>new Error(`Invalid key: ${r}`),t=r.split(":"),i=t[0];if(!i||i!="expression"&&i!="settings"&&i!="object")throw e();if(i=="settings"){if(t.length!=2)throw e();return{location:i,path:t[1]}}if(t.length!=3)throw e();return{location:i,id:t[1],path:t[2]}}function wE(r,e,t){if(!r)return;let i=e.split("."),o=r;for(let n=0;n<i.length;n++){let a=i[n];if(!o[a])break;n==i.length-1&&typeof o[a]=="string"?o[a]=t:o=o[a]}}function zM(r,e){return(t,i,o,n)=>{if(t){let a=lq(__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},e),{path:i}));r[a]={value:t,type:o,context:n}}}}function rY(r){var i,o;let e={},t=zM(e,{location:"expression",id:r.id});switch(r.type){case"expression":t(r.label,"label","interpolated-string","expression-list-expression-label"),t(r.description,"description","string","expression-list-expression-clickable-description");break;case"image":t(r.image_url,"image_url","image","expression-list-image-url"),t(r.description,"description","string","expression-list-image-clickable-description"),t((i=r.clickableInfo)==null?void 0:i.hoveredImage,"clickableInfo.hoveredImage","image","expression-list-image-clickable-hovered"),t((o=r.clickableInfo)==null?void 0:o.depressedImage,"clickableInfo.depressedImage","image","expression-list-image-clickable-depressed");break;case"text":t(r.text,"text","string","expression-list-note-text");break;case"folder":t(r.title,"title","string","expression-list-folder-title");break}return e}function iY(r){let e={},t=zM(e,{location:"settings"});return t(r.graph.xAxisLabel,"xAxisLabel","string","settings-xaxis-label"),t(r.graph.yAxisLabel,"yAxisLabel","string","settings-yaxis-label"),e}function oY(r){let e={},t=zM(e,{location:"object",id:r.id});return t(r.label,"label","string","geometry-object-label"),r.type==="image"&&t(r.url,"url","image","geometry-object-image-url"),e}function cq(r){let e={};if(r.type=="graph"){let t=r.graphState.expressions.list;for(let o of t){let n=rY(o);for(let a in n)e[a]=n[a]}let i=iY(r.graphState);for(let o in i)e[o]=i[o]}else{let t=r.geometryState.objects;for(let i in t){let o=oY(t[i]);for(let n in o)e[n]=o[n]}}return e}function dq(r,e,t){var o;let i=__dcg_shared_module_exports__['j'](r);if(t==="graph"){let n={},a=(o=i.expressions)==null?void 0:o.list,s=Array.isArray(a)?a:[];for(let l of s)n[l.id]=l;for(let l in e){let c=KM(l);c.location=="expression"?wE(n[c.id],c.path,e[l].value):wE(i.graph,c.path,e[l].value)}}else if(i.objects)for(let n in e){let a=KM(n);a.location=="object"&&wE(i.objects[a.id],a.path,e[n].value)}return i}function zr(r){switch(r.type){case"Equals":return $n(r.args,"=");case"Inequality":let e=r.symbol==="<="?"\\le":r.symbol===">="?"\\ge":r.symbol;return $n(r.args,e);case"InequalityChain":return zr(r.first)+r.chain.map(zr).join("");case"TrailingInequalityPiece":return r.symbol+zr(r.args[0]);case"Tilde":return $n(r.args,"~");case"Pos":return"+"+zr(r.args[0]);case"Neg":return"-"+zr(r.args[0]);case"Add":return $n(r.args,"+");case"Sub":return $n(r.args,"-");case"Mul":return $n(r.args,"*");case"DotMul":return $n(r.args,"\\cdot ");case"CrossMul":return $n(r.args,"\\times ");case"Div":return $n(r.args,"/");case"Bang":return zr(r.args[0])+"!";case"Call":let t=HM(r.args);return t?t.script+"\\left("+t.arg+"\\right)":zr(r.args[0])+"\\left("+zr(r.args[1])+"\\right)";case"Paren":return"\\left("+zr(r.args[0])+"\\right)";case"List":return"\\left["+r.args.map(zr).join(",")+"\\right]";case"Pipes":return"\\left|"+zr(r.args[0])+"\\right|";case"Index":return zr(r.args[0])+"\\left["+zr(r.args[1])+"\\right]";case"Subscript":return $n(r.args,"_",!0);case"Superscript":return $n(r.args,"^",!0);case"Prime":if(r.args[0].type==="Call"){let a=HM(r.args[0].args);return a?a.script+UM(r.nprimes)+"\\left("+a.arg+"\\right)":zr(r.args[0].args[0])+UM(r.nprimes)+"\\left("+zr(r.args[0].args[1])+"\\right)"}return zr(r.args[0])+UM(r.nprimes);case"Seq":return r.args.map(zr).join(",");case"Sqrt":return"\\sqrt"+pw(zr(r.args[0]));case"Nthroot":return"\\sqrt["+zr(r.args[0])+"]"+pw(zr(r.args[1]));case"Frac":return"\\frac{"+zr(r.args[0])+"}{"+zr(r.args[1])+"}";case"Derivative":return"\\frac{d}{d"+zr(r.args[0])+"}"+zr(r.args[1]);case"Integral":case"EmptyIntegral":if(r.args[0].type!=="Cmd")throw new Error("Expected first argument of an integral to be the variable");let i="d"+r.args[0].val;if(r.args.length===3)return uw("int",r.args[1],r.args[2])+i;let o=zr(r.args[3]);return uw("int",r.args[1],r.args[2])+o+i;case"Sum":return pq(r.args,"sum");case"Product":return pq(r.args,"prod");case"Piecewise":return"\\{"+zr(r.args[0])+"\\}";case"EmptyPiecewise":return"\\{\\}";case"Colon":return $n(r.args,":");case"Ellipsis":return $n(r.args,"...");case"For":return $n(r.args,"\\for ");case"With":return $n(r.args,"\\with ");case"Dot":return $n(r.args,".");case"PercentOf":return $n(r.args,"\\% \\of ");case"RightArrow":return $n(r.args,"->");case"Juxt":return $n(r.args,r.args[0].type==="Cmd"?" ":"");case"ImplicitCall":{let a=HM(r.args);return a?a.script+a.arg:$n(r.args,"")}case"MixedNumber":return r.whole+"\\frac{"+r.num+"}{"+r.den+"}";case"Letter":case"Decimal":case"Alphanumeric":return r.val;case"Cmd":return"\\"+r.val;case"EmptyRangeEnd":return"EmptyRangeEnd";case"Err":throw r.error;default:return r}}function pw(r){return r.length>1?"{"+r+"}":r}function uw(r,e,t){let i=pw(zr(e));if(t){let o=pw(zr(t));return`\\${r}_${i}^${o}`}return`\\${r}_${i}`}function $n(r,e,t=!1){let i=zr(r[0]),o=t?pw(zr(r[1])):zr(r[1]);return i+e+o}function pq(r,e){let t=zr(r[0]);return uw(e,r[1],r[2])+t}function UM(r){let e="";for(let t=0;t<r;t++)e+="'";return e}function uq(r){return r.type==="Cmd"&&r.val==="logbase"}function HM(r){let e=r[1],t;if(r[1].type==="Seq"&&r[1].args.length===2&&(e=r[1].args[1],t=r[1].args[0]),r[0].type==="Superscript"&&uq(r[0].args[0]))return{script:uw("log",e,r[0].args[1]),arg:t?zr(t):""};if(uq(r[0]))return{script:uw("log",e),arg:t?zr(t):""}}function hq(r){let e=$M.parse(r.latex);if(e.type=="Err")return;let t=jn(e);for(;t.type==="Paren";)t=t.args[0];return Wd(t)?{latex:r.latex}:{latex:zr(t)}}function nY(r){return r.isPseudoSurfaceNode}function Wd(r){switch(r.type){case"Letter":case"Decimal":case"Cmd":return r.val==="0";case"Paren":return Wd(r.args[0]);default:return!1}}function sh(r){switch(r.type){case"Letter":case"Decimal":case"Cmd":return r.val==="1";case"Paren":return sh(r.args[0]);default:return!1}}function gq(r){return r.type==="Neg"?sh(r.args[0]):r.type==="Paren"?gq(r.args[0]):!1}function vE(r){return{isPseudoSurfaceNode:!0,type:"Decimal",span:r,val:"0"}}function WM(r,e){return{isPseudoSurfaceNode:!0,type:"Neg",span:e,args:[r]}}function aY(r,e){return{isPseudoSurfaceNode:!0,type:"Paren",span:e,args:[r]}}function Qs(r,e){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{span:e})}function jn(r,e){let t;switch(r.type){case"Add":{let n=jn(r.args[0]),a=jn(r.args[1]);if(Wd(n))return Qs(a,r.span);if(Wd(a))return Qs(n,r.span);let s;if(a.type==="Neg"?s=jn(a.args[0]):a.type==="Paren"&&a.args[0].type==="Neg"&&(s=jn(a.args[0].args[0])),s!==void 0)return{isPseudoSurfaceNode:!0,type:"Sub",span:r.span,args:[n,s]};t=[n,a];break}case"Sub":{let n=jn(r.args[0]),a=jn(r.args[1]);if(Wd(n))return WM(a,r.span);if(Wd(a))return Qs(n,r.span);let s;if(a.type==="Neg"?s=a.args[0]:a.type==="Paren"&&a.args[0].type==="Neg"&&(s=a.args[0].args[0]),s)return{isPseudoSurfaceNode:!0,type:"Add",span:r.span,args:[n,s]};t=[n,a];break}case"Mul":{let n=jn(r.args[0]),a=jn(r.args[1]);if(sh(n))return Qs(a,r.span);if(sh(a))return Qs(n,r.span);if(Wd(n)||Wd(a))return vE(r.span);t=[n,a];break}case"Juxt":{let n=jn(r.args[0],r),a=jn(r.args[1],r);if(sh(n))return Qs(a,r.span);if(sh(a))return Qs(n,r.span);if(gq(n))return WM(a,r.span);if(Wd(n)||Wd(a))return vE(r.span);if(n.type==="Neg"){let s=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{type:"Juxt",isPseudoSurfaceNode:!0,args:[n.args[0],a]});return WM(s,r.span)}t=[n,a];break}case"Frac":case"Div":{let n=jn(r.args[0]),a=jn(r.args[1]);if(sh(a))return Qs(n,r.span);t=[n,a];break}case"Superscript":let i=jn(r.args[0]),o=jn(r.args[1]);if(sh(o))return Qs(i,r.span);(e==null?void 0:e.type)==="Juxt"&&e.args[0].type==="Decimal"&&i.type==="Decimal"&&(i=aY(i,i.span)),t=[i,o];break;case"Paren":{let n=jn(r.args[0]);if((e==null?void 0:e.type)!=="Juxt"){if(__dcg_shared_module_exports__['fc'](n))return Qs(n,r.span);let a="args"in n?n.args:void 0;if((!a||a.length<=1)&&n.type!=="Neg")return Qs(n,r.span)}t=[n];break}case"Pos":{let n=jn(r.args[0]);return Qs(n,r.span)}case"Neg":{let n=jn(r.args[0]),a="args"in n?n.args[0]:void 0;if(n.type==="Paren"&&a&&a.type==="Neg"&&a.args[0])return Qs(jn(a.args[0]),r.span);if(n.type==="Neg"&&a)return Qs(a,r.span);t=[n];break}case"Cmd":case"Letter":case"Decimal":case"MixedNumber":case"EmptyRangeEnd":case"EmptyPiecewise":case"InequalityChain":return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{isPseudoSurfaceNode:!0});default:t=r.args.map(n=>nY(n)?n:n.type==="Alphanumeric"?__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},n),{isPseudoSurfaceNode:!0}):jn(n))}return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{isPseudoSurfaceNode:!0,args:t})}var sY={version:$l,randomSeed:"",graph:{viewport:{xmin:-10,ymin:-13.25,xmax:10,ymax:13.25}},expressions:{list:[{id:"1",type:"expression"}]}},lh=sY;function lY(r){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{version:"0"})}var mq=lY;var cY={centerX:0,centerY:0,size:15},dY={scale:1,unit:"",visible:!1,showLegend:!1};function pY(r){let e=r.objects||{},t=__dcg_shared_module_exports__['j'](e);for(let i in t){let o=t[i];o.label&&(o.showLabel=!0)}return{version:"1",objects:t,viewport:r.viewport||cY,customTools:r.customTools||{},grid:r.grid||dY}}var fq=pY;function uY(r){return(r.type==="point"||r.type==="glider")&&!r.draggable}function hY(r){let e=r.objects||{},t=__dcg_shared_module_exports__['j'](e),i=__dcg_shared_module_exports__['j'](r.grid);for(let o in t){let n=t[o];uY(n)&&(n.draggable=!0),n.type==="angle"&&n.showLabel&&!n.label&&(n.label="{angle}"),n.type==="segment"&&n.showLabel&&!n.label&&(n.label="{length}")}return i.unit="",i.scale=1,{version:"2",objects:t,viewport:r.viewport,customTools:r.customTools||{},grid:i}}var bq=hY;function jM(r){return r&&(r.type==="circle"||r.type==="compass")}function gY(r){let e=__dcg_shared_module_exports__['j'](r.objects||{});for(let t in e){let i=e[t];if(i.type==="point")i.y=-i.y;else if(i.type==="glider"){let o=e[i.parents.host];jM(o)&&(i.t=-i.t)}else if(i.type==="intersection"){let o=e[i.parents.host1],n=e[i.parents.host2];jM(o)&&jM(n)&&(i.negRoot=!i.negRoot)}}return{version:"3",objects:e,viewport:r.viewport,customTools:r.customTools||{},graphSettings:{showGrid:!!(r.grid||{}).visible,showAxes:!1,showAxisNumbers:!1}}}var yq=gY;function mY(r){let e=__dcg_shared_module_exports__['j'](r.objects||{});for(let t in e){let i=e[t];i.draggable===!1&&(i.locked=!0),delete i.draggable}return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{version:"4",objects:e})}var xq=mY;var CE=[mq,fq,bq,yq,xq],fY="4";function YM(r){let e=parseInt(fY,10),t=parseInt(r.version||"0",10);for(t>e&&typeof console!="undefined"&&console.warn&&console.warn(`Loading saved state with version ${t}, but last known version is ${e}. States saved in a newer version of the geometry tool may not load correctly in older versions of the tool.`),CE[t]||typeof console!="undefined"&&console.warn&&console.warn(`State has invalid version: ${t}. If a version is present, it should be a non-negative integer less than or equal to ${e}.`),t===0&&(r=CE[0](r));t<e;)t+=1,CE[t]&&(r=CE[t](r));return r}var bY=!1;function kg(r,e){var t=e[r];return t.type==="transformed-object"?kg(t.parents.object,e):t.type}function wq(r){switch(r){case"circle":case"compass":case"arc":return!0}return!1}function yY(r,e,t){var i=kg(e,t);if(i==="circle"||i==="compass"){let o=r/(2*Math.PI);return o<0?o+1:o}return r}function vq(r){switch(r){case"scaled-rotation":case"vector":return!0}return!1}function xY(r){switch(r){case"point":case"midpoint":case"glider":case"intersection":case"polygon":return"P";case"line":case"segment":case"ray":case"vector":case"parallel":case"perpendicular":return"L";case"circle":case"compass":return"C";case"arc":case"angle":return"A";case"image":return"I";case"dilation":case"rotation":case"translation":case"reflection":case"scaled-rotation":return"T";case"transformed-object":return"T";default:return r}}function Uc(r){let e=!bY,t=YM(r),i={},o={},n=I=>{if(o.hasOwnProperty(I))return o[I];let S=kg(I,t.objects);if(e&&!vq(S)){let B=i.token||1;i.token=B+1;let R="\\token{"+B+"}";return o[I]=R,R}let V=xY(S),P=i[V]||1;i[V]=P+1;let L=V+"_{"+P+"}";return o[I]=L,L};function a(I){let S=i[I]||1;return i[I]=S+1,I+"_{"+S+"}"}let s=(I,S,V)=>n(I)+"=\\operatorname{"+S+"}\\left("+V.map(n).join(",")+"\\right)",l=I=>`\\operatorname{segment}\\left(${I}.\\operatorname{start},${I}.\\operatorname{end}\\right)`,{centerX:c,centerY:p,size:u}=t.viewport;u*=1.25;let m=1,h=u/(1+m),x=h*m,C={version:11,randomSeed:"",expressions:{list:[]},graph:{product:"geometry-calculator",viewport:{xmin:c-h,xmax:c+h,ymin:p-x,ymax:p+x},showGrid:!1,showXAxis:!1,showYAxis:!1,squareAxes:!0,degreeMode:!0}};t.graphSettings.showGrid&&(C.graph.showGrid=!0,C.graph.xAxisMinorSubdivisions=1,C.graph.yAxisMinorSubdivisions=1,C.graph.xAxisStep=1,C.graph.yAxisStep=1);let D=C.expressions.list,k=[],M=[];for(let I in t.objects){let S=t.objects[I],V=kg(S.id,t.objects),P={id:S.id,type:"expression",color:S.color,hidden:!!S.hidden};if(e&&!vq(V)&&(P.folderId=__dcg_shared_module_exports__['ad']),S.locked&&(P.dragMode="NONE"),!S.hidden&&S.label&&S.showLabel){if(P.label=S.label,P.showLabel=!0,V==="segment"&&S.label.indexOf("{length}")!==-1)if(S.label==="{length}")P.label="";else{let L=a("l"),B=L+"=\\operatorname{round}\\left(\\operatorname{length}\\left("+n(S.id)+"\\right),2\\right)";M.push({id:"len-"+P.id,type:"expression",latex:B}),P.label=P.label.replace(/\{length\}/g,"${"+L+"}")}if(V==="angle"&&S.label.indexOf("{angle}")!==-1)if(S.label==="{angle}")P.label="";else{let L=a("a"),B=L+"=\\operatorname{round}\\left("+n(S.id)+"\\right)";M.push({id:"angle-"+P.id,type:"expression",latex:B}),P.label=P.label.replace(/\{angle}/g,"${"+L+"}\xB0")}if(V==="polygon"&&S.label.indexOf("{area}")!==-1)if(S.label==="{area}")P.label="";else{let L=a("a"),B=L+"=\\operatorname{round}\\left(\\operatorname{area}\\left("+n(S.id)+"\\right),2\\right)";M.push({id:"area-"+P.id,type:"expression",latex:B}),P.label=P.label.replace(/\{area\}/g,"${"+L+"}")}if(V==="polygon"&&S.label.indexOf("{perimeter}")!==-1){let L=a("p"),B=L+"=\\operatorname{round}\\left(\\operatorname{perimeter}\\left("+n(S.id)+"\\right),2\\right)";M.push({id:"perim-"+P.id,type:"expression",latex:B}),P.label=P.label.replace(/\{perimeter\}/g,"${"+L+"}")}}switch(S.type){case"point":{let J=S.x===null?0:S.x,j=S.y===null?0:S.y;P.latex=n(S.id)+"=\\left("+__dcg_shared_module_exports__['sc'](J)+","+__dcg_shared_module_exports__['sc'](j)+"\\right)";break}case"glider":{let J=kg(S.parents.host,t.objects),j=n(S.parents.host);J==="vector"&&(j=l(j)),P.latex=n(S.id)+"=\\operatorname{glider}\\left("+j+","+__dcg_shared_module_exports__['sc'](yY(S.t,S.parents.host,t.objects))+"\\right)";break}case"intersection":let L=kg(S.parents.host1,t.objects),B=kg(S.parents.host2,t.objects),R=n(S.parents.host1),W=n(S.parents.host2);L==="vector"&&(R=l(R)),B==="vector"&&(W=l(W));let re=S.negRoot;(wq(L)&&!wq(B)||B==="arc")&&(re=!re);let ne=re?[R,W]:[W,R];P.latex=n(I)+"=\\operatorname{intersection}\\left("+ne.join(",")+"\\right)";break;case"midpoint":P.latex=s(S.id,S.type,[S.parents.straight]);break;case"circle":P.latex=s(S.id,S.type,[S.parents.point1,S.parents.point2]);break;case"arc":P.latex=s(S.id,S.type,[S.parents.point1,S.parents.point2,S.parents.point3]);break;case"compass":P.latex=s(S.id,"circle",[S.parents.center,S.parents.straight]);break;case"line":case"segment":case"ray":case"vector":P.latex=s(S.id,S.type,[S.parents.point1,S.parents.point2]);break;case"parallel":case"perpendicular":P.latex=s(S.id,S.type,[S.parents.straight,S.parents.point]);break;case"polygon":P.latex=s(S.id,S.type,S.parents.points);break;case"angle":P.latex=s(S.id,S.type,[S.parents.point1,S.parents.point2,S.parents.point3]);break;case"transformed-object":P.latex=n(S.id)+"="+n(S.parents.transformation)+"\\left("+n(S.parents.object)+"\\right)";break;case"dilation":P.latex=n(S.id)+"\\left(x\\right)=\\operatorname{dilate}\\left(x,"+n(S.parents.center)+","+(S.scaleFactor||"0/0")+"\\right)";break;case"reflection":P.latex=n(S.id)+"\\left(x\\right)=\\operatorname{reflect}\\left(x,"+n(S.parents.straight)+"\\right)";break;case"translation":P.latex=n(S.id)+"\\left(x\\right)=\\operatorname{translate}\\left(x,"+n(S.parents.from)+","+n(S.parents.to)+"\\right)";break;case"rotation":P.latex=n(S.id)+"\\left(x\\right)=\\operatorname{rotate}\\left(x,"+n(S.parents.center)+","+(S.angle||"0/0")+"\\right)";break;case"scaled-rotation":let X=n(S.parents.center),b=n(S.parents.from),A=n(S.parents.to);P.latex=n(S.id)+`\\left(x\\right)=\\operatorname{rotate}\\left(\\operatorname{dilate}\\left(x,${X},\\frac{\\left|${A}-${X}\\right|}{\\left|${b}-${X}\\right|}\\right),${X},\\operatorname{directedangle}\\left(${b},${X},${A}\\right)\\right)`;break;case"image":break;default:return S}P.latex&&(P.folderId===__dcg_shared_module_exports__['ad']?k.push(P):M.push(P))}return D.push({type:"folder",id:__dcg_shared_module_exports__['ad'],title:"geometry",secret:!0}),D.push.apply(D,k),D.push.apply(D,M),C}function wY(r,e){return r==null&&(r=""),__dcg_shared_module_exports__['lc'](r,e)}function vY(r){if(r!=null)try{let e=__dcg_shared_module_exports__['ec'](r);return __dcg_shared_module_exports__['kc'](e)}catch(e){let t=e instanceof Cq.Base?e.getInputSpan():void 0;t||(t=__dcg_shared_module_exports__['_'](r,0,r.length));let i=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},__dcg_shared_module_exports__['hc']()),{originalError:e});return __dcg_shared_module_exports__['gc'](t,i)}}var CY={parse:wY},$M={parse:vY},DY={countNumbers:sb},SY=__dcg_shared_module_exports__['yd'],kY=__dcg_shared_module_exports__['mb'],EY=__dcg_shared_module_exports__['Qa'],Cq=__dcg_shared_module_exports__['qb'],GY={graphing:new __dcg_shared_module_exports__['ld']({enableGeometry:!1,enable3d:!1,beta3d:!1,scales:void 0}),scientific:new __dcg_shared_module_exports__['xd']({singleExpression:!1}),fourFunction:new __dcg_shared_module_exports__['wd']({singleExpression:!1})},TY=lh,IY=Zm;var{Switch:Dq}=gr.Components,$d=class extends gr.Class{template(){return gr.createElement(Dq,{key:()=>this.getLatex().indexOf("\\token")>=0},e=>e?gr.createElement(Kd,{identifier:()=>this.getIdentifier(),insideMQ:()=>!1,controller:()=>this.props.controller(),insideGroup:()=>!1,putInTabOrder:()=>!1}):gr.createElement("span",null,gr.createElement(ze,{config:this.const({}),latex:()=>this.getLatex()})))}getLatex(){return this.props.latex()||"unknown"}getIdentifier(){let e=this.props.latex();return e?__dcg_shared_module_exports__['lb'].latexToIdentifier(e):""}},DE=class extends gr.Class{init(){this.controller=this.props.controller()}template(){return gr.createElement(Dq,{key:this.bindFn(this.getTransformationType)},e=>{switch(e){case"translate":return this.getParents().length===1?gr.createElement("div",null,gr.const("Translate by"),gr.const(" "),gr.createElement($d,{controller:this.props.controller,latex:()=>this.getParents()[0]})):gr.createElement("div",null,gr.const("Translate from"),gr.const(" "),gr.createElement($d,{controller:this.props.controller,latex:()=>this.getParents()[0]}),gr.const(" "),gr.const("to"),gr.const(" "),gr.createElement($d,{controller:this.props.controller,latex:()=>this.getParents()[1]}));case"reflect":return gr.createElement("div",null,gr.const("Reflect over"),gr.const(" "),gr.createElement($d,{controller:this.props.controller,latex:()=>this.getParents()[0]}));case"dilate":return gr.createElement("div",null,gr.const("Dilate at"),gr.const(" "),gr.createElement($d,{controller:this.props.controller,latex:()=>this.getParents()[0]}),gr.const(" by "),gr.createElement($d,{controller:this.props.controller,latex:()=>this.getRawParentLatex(2)}));case"rotate":return gr.createElement("div",null,gr.const("Rotate around"),gr.const(" "),gr.createElement($d,{controller:this.props.controller,latex:()=>this.getParents()[0]}),gr.const(" by "),gr.createElement($d,{controller:this.props.controller,latex:()=>this.getRawParentLatex(2)+(this.controller.getGraphSettings().degreeMode?"\xB0":"")}));case void 0:return gr.createElement("span",null)}})}getParents(){let e=this.getGeometry();return!e||!e.call?[]:e&&e.call?e.call.parents.map(t=>__dcg_shared_module_exports__['lb'].geoParentToLatex(t)):[]}getRawParentLatex(e){var a;var t=(a=this.props.model())==null?void 0:a.latex;if(!t)return"";let o=__dcg_shared_module_exports__['lc'](t)._expression;if(!o)return"";let n=o.args[e];return!n||!n.getInputString?"":n.getInputString()||""}getGeometry(){var e;return(e=this.props.model())==null?void 0:e.formula.geometry}getTransformationType(){var i;let e=this.getGeometry(),t=(i=e==null?void 0:e.call)==null?void 0:i.symbol;switch(t){case"translate":case"dilate":case"reflect":case"rotate":return t}}};var Sq={translate:!0,reflect:!0,dilate:!0,rotate:!0},ibe=__dcg_shared_module_exports__['a']({selection:!0,point:!0,line:!0,segment:!0,ray:!0,vector:!0,circle:!0,arc:!0,parallel:!0,perpendicular:!0,midpoint:!0,polygon:!0,compass:!0,angle:!0,directedangle:!0,"box-selection":!0,"expression-edit":!0},Sq),lb=Object.keys(Sq);var vo=__dcg_shared_module_exports__['h'](z());var{Each:kq,If:VY}=vo.Components,SE=class extends vo.Class{init(){this.controller=this.props.controller(),this.focusOrder=this.getTransformationFocusLocations(),this.cacheExistingTransformations()}willUpdate(){this.cacheExistingTransformations()}handleTap(e,t){e.handle(),e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"select-geo-tool",tool:t,focusGraphPaper:e.device==="keyboard"})}template(){return vo.createElement("div",{class:()=>({"dcg-generic-options-menu":!0,"dcg-options-menu":!0,"dcg-multi-select-transformations-menu":!0}),role:vo.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-transformations-menu")},vo.createElement("div",{onKeydown:this.bindFn(this.handleKeydown),class:vo.const("dcg-new-transformations-container"),role:vo.const("menu"),"aria-orientation":vo.const("horizontal"),"aria-label":()=>this.controller.s("graphing-calculator-label-new-transformation")},kq(()=>this.getTransformations(),{item:e=>vo.createElement("button",{class:()=>({"dcg-new-transformation":!0,"dcg-disabled":!this.controller.isGeoToolEnabled(e),"dcg-will-be-hidden-or-disabled":this.controller.toolWillBeHiddenOrDisabled(e)}),tabindex:()=>this.getTransformations().indexOf(e)===0?0:-1,role:vo.const("menuitemradio"),manageFocus:()=>Qe({controller:this.controller,location:{type:"geo-basic-tool",tool:e}}),"dcg-geo-tool":this.const(e),onTap:t=>this.handleTap(t,e)},vo.createElement("i",{class:()=>this.getTransformationIcon(e)}),()=>this.getTransformationName(e))})),vo.createElement(VY,{predicate:()=>this.cachedExistingTransformations.length>0},()=>vo.createElement("div",{class:vo.const("dcg-transformation-header")},()=>this.controller.s("graphing-calculator-label-recent-transformations"))),vo.createElement("div",{role:vo.const("group"),class:vo.const("dcg-existing-transformations-container"),"aria-label":()=>this.controller.s("graphing-calculator-label-recent-transformations")},kq(()=>this.cachedExistingTransformations,{item:e=>vo.createElement("div",{class:vo.const("dcg-existing-transformation"),role:vo.const("button"),tabindex:vo.const("0"),onTap:()=>this.applyTransformation(e),onPointerOut:t=>this.onPointerOut(t,e),onPointerOver:t=>this.onPointerOver(t,e),willUnmount:()=>this.onImplicitMouseOut(e)},vo.createElement(DE,{controller:this.props.controller,model:()=>e})),key:e=>e.id})))}handleKeydown(e){let t=Ee(e);if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||t!=="Left"&&t!=="Right"&&t!=="Home"&&t!=="End")return;let i=this.controller.getFocusLocation();if(!i)return;let o=__dcg_shared_module_exports__['H'](this.focusOrder,i);if(o===-1)return;e.preventDefault(),e.stopPropagation();let n=o;t==="Left"?n=Math.max(0,o-1):t==="Right"?n=Math.min(this.focusOrder.length-1,o+1):t==="Home"?n=0:t==="End"&&(n=this.focusOrder.length-1),n!==o&&this.controller.dispatch({type:"set-focus-location",location:this.focusOrder[n]})}computeExistingTransformations(){var t,i;let e=[];for(let o of this.controller.getAllItemModels()){if(o.type!=="expression"||!this.controller.isItemInGeoFolder(o.id))continue;let n=(t=o.formula.geometry)==null?void 0:t.call;if(!n||!__dcg_shared_module_exports__['ac'](n.symbol))continue;let a=(i=o.formula.typed_constant_value)==null?void 0:i.valueType;a!==void 0&&__dcg_shared_module_exports__['Pa'](a,__dcg_shared_module_exports__['Ba'])&&e.push(o)}return e.reverse()}cacheExistingTransformations(){this.cachedExistingTransformations=this.computeExistingTransformations()}getTransformations(){return lb.filter(e=>this.controller.isGeoToolVisible(e))}getTransformationIcon(e){switch(e){case"dilate":return"dcg-icon-dilation";case"reflect":return"dcg-icon-reflection";case"rotate":return"dcg-icon-rotation";case"translate":return"dcg-icon-vector"}}getTransformationName(e){switch(e){case"dilate":return this.controller.s("graphing-calculator-text-geometry-tool-dilate-display-name");case"reflect":return this.controller.s("graphing-calculator-text-geometry-tool-reflect-display-name");case"rotate":return this.controller.s("graphing-calculator-text-geometry-tool-rotate-display-name");case"translate":return this.controller.s("graphing-calculator-text-geometry-tool-translate-display-name")}}getTransformationFocusLocations(){let e=[];return this.getTransformations().forEach(t=>{e.push({type:"geo-basic-tool",tool:t})}),e}onPointerOver(e,t){var o;if(e.pointerType!=="mouse")return;let i=(o=Fo(t))==null?void 0:o.identifier;i&&(this.currentlyActiveTokenIdentifier=i,this.controller.dispatch({type:"set-active-token",identifier:this.currentlyActiveTokenIdentifier,style:"hovered"}))}onPointerOut(e,t){var o;if(e.pointerType!=="mouse")return;let i=(o=Fo(t))==null?void 0:o.identifier;i&&this.currentlyActiveTokenIdentifier&&this.currentlyActiveTokenIdentifier===i&&(this.controller.dispatch({type:"unset-active-token",identifier:this.currentlyActiveTokenIdentifier,style:"hovered"}),this.currentlyActiveTokenIdentifier=void 0)}onImplicitMouseOut(e){var i;let t=(i=Fo(e))==null?void 0:i.identifier;t&&this.currentlyActiveTokenIdentifier&&this.currentlyActiveTokenIdentifier===t&&this.controller.runAfterDispatch(()=>{let o=this.currentlyActiveTokenIdentifier;o&&(this.currentlyActiveTokenIdentifier=void 0,this.controller.dispatch({type:"unset-active-token",identifier:o,style:"hovered"}))})}applyTransformation(e){var i;if(!((i=e.formula.geometry)!=null&&i.identifier))return;let t=__dcg_shared_module_exports__['hb'](e.formula.geometry.identifier);this.controller.dispatch({type:"apply-transformation-to-selected",assignmentLatex:t})}};var cb=__dcg_shared_module_exports__['h'](z());xt();var Eq='input, button, textarea, select [role="textbox"], [tabindex="0"], [role="button"]',ec=class extends cb.Class{constructor(){super(...arguments),this.globalKeyDownListener=e=>{let t=Ee(e);t===hn?(e.preventDefault(),e.stopPropagation(),this.focusIcon(),this.hideOptions()):t==="Tab"&&!e.altKey&&!e.ctrlKey&&!e.metaKey&&(e.shiftKey?e.shiftKey&&(this.isIconModelFocused()?(e.preventDefault(),e.stopPropagation(),this.focusLastOption()):this.isFirstOptionViewFocused()&&(e.preventDefault(),e.stopPropagation(),this.focusIcon())):this.isIconModelFocused()?(e.preventDefault(),e.stopPropagation(),this.focusFirstOption()):this.isLastOptionViewFocused()&&(e.preventDefault(),e.stopPropagation(),this.focusIcon()))}}init(){this.controller=this.props.controller()}template(){return cb.createElement("div",{class:cb.const("dcg-options-menu-container"),didMount:this.bindFn(this.didMountView),didUnmount:this.bindFn(this.didUnmountView)},this.children)}didMount(){this.props.openAriaAlert&&be(this.props.openAriaAlert())}willUnmount(){this.props.closeAriaAlert&&be(this.props.closeAriaAlert())}didMountView(e){this.guid=__dcg_shared_module_exports__['V']("dcg-dropdown-menu"),this.openView=e,this.positionMenu(),this.moveFocusIfAppropriate(),this.attachKeyDownListeners(),this.attachScrollTapListeners()}isIconModelFocused(){let e=this.controller.getFocusLocation();return __dcg_shared_module_exports__['P'](e,this.props.menuButtonFocusLocation())}attachKeyDownListeners(){this.props.shouldHandleTabAndEscape()&&document.addEventListener("keydown",this.globalKeyDownListener)}attachScrollTapListeners(){H(document.body).on(`dcg-tapstart.${this.guid}`,e=>{if(!this.openView)return;let{target:t}=e,i=this.controller.getOpenMenuIconSelector();if(i&&t.closest(i))return;if(this.openView.contains(t)){if(!t.matches(Eq))return;let{first:n,last:a}=this.getDOMTabStops();n===t?this.focusFirstOption():a===t&&this.focusLastOption();return}Array.from(document.querySelectorAll(".dcg-keypad,.dcg-show-keypad-container")).some(n=>n.contains(t))||this.hideOptions()})}didUnmountView(){document.removeEventListener("keydown",this.globalKeyDownListener),H(document.body).off(`.${this.guid}`),this.openView=void 0}moveFocusIfAppropriate(){this.shouldMoveFocusToFirstOption()?this.focusFirstOption():this.shouldMoveFocusToLastOption()&&this.focusLastOption()}hideOptions(){this.controller.dispatch({type:"close-item-settings-menu"})}getRootEl(){return this.controller.findEl(this.props.rootElSelector())}positionMenu(){let e=this.controller.getOpenMenuIcon();if(!e||!this.openView)return;let t=this.getRootEl();if(!t)return;let i=t.getBoundingClientRect(),o=e.getBoundingClientRect(),n={top:o.top-i.top,left:o.left-i.left};oa(this.openView,{top:n.top+"px",left:n.left+"px",display:"block"})}focusIcon(){this.controller.focusOpenMenuIcon()}isFirstOptionViewFocused(){let{first:e}=this.getDOMTabStops();return e!==void 0&&e.matches(":focus")}shouldMoveFocusToFirstOption(){if(this.props.focusOnOpen)return this.props.focusOnOpen()==="first";if(this.openView&&this.openView.matches(":focus-within"))return!1;let e=this.controller.getOpenItemMenu();return(e==null?void 0:e.type)===this.props.menuType()&&!!(e!=null&&e.focusFirstOption)}shouldMoveFocusToLastOption(){return this.props.focusOnOpen?this.props.focusOnOpen()==="last":!1}focusFirstOption(){let{first:e}=this.getDOMTabStops();e!==void 0&&e.focus()}focusLastOption(){let{last:e}=this.getDOMTabStops();e!==void 0&&e.focus()}isLastOptionViewFocused(){let{last:e}=this.getDOMTabStops();return e!==void 0&&e.matches(":focus")}getDOMTabStops(){if(this.openView===void 0)return{};let t=this.openView.querySelectorAll(Eq);if(t.length===0)return{};let i=0;for(;!Vp(t.item(i))&&i<t.length;)i++;let o=t.item(i);for(i=t.length-1;!Vp(t.item(i))&&i<t.length;)i--;let n=t.item(i);return{first:o,last:n}}};var{If:kE,Switch:MY}=Kt.Components,EE=class extends Kt.Class{init(){this.controller=this.props.controller(),this.focusOrder=[{type:"geo-header-back-link"},{type:"multi-select-delete-icon"},{type:"multi-select-show-hide-icon"},{type:"multi-select-transformations-icon"},{type:"multi-select-more-icon"}]}template(){return Kt.createElement("div",{class:Kt.const("dcg-multi-select-header dcg-animate-in-after-initial-load"),onKeydown:this.bindFn(this.handleKeydown),role:Kt.const("toolbar"),"aria-label":this.bindFn(this.getSelectedCountString)},Kt.createElement(nb,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-geometry-deselect-all"),controller:this.props.controller,message:this.bindFn(this.getSelectedCountString),onBack:this.bindFn(this.onDone)}),Kt.createElement(kE,{predicate:()=>this.shouldShowDeleteButton()},()=>Kt.createElement(Me,{tooltip:this.bindFn(this.getDeleteItemString)},Kt.createElement("span",{"aria-label":this.bindFn(this.getDeleteItemString),role:Kt.const("button"),tabindex:Kt.const("-1"),handleEvent:Kt.const("true"),class:Kt.const("dcg-multi-select-icon-button dcg-delete-btn"),onTap:this.bindFn(this.deleteSelected),manageFocus:this.const(Qe({controller:this.controller,location:{type:"multi-select-delete-icon"}}))},Kt.createElement("i",{class:Kt.const("dcg-icon-trashcan"),"aria-hidden":Kt.const("true")})))),Kt.createElement(MY,{key:this.bindFn(this.getSelectedItemsKey)},()=>Kt.createElement("div",{class:()=>({"dcg-btn-outline":!0,"dcg-show-hide-btn":!0,"dcg-any-visible-objects":this.anyVisible()}),handleEvent:Kt.const("true"),tabindex:Kt.const("-1"),role:Kt.const("button"),onTap:this.bindFn(this.toggleItemsVisible),manageFocus:this.const(Qe({controller:this.controller,location:{type:"multi-select-show-hide-icon"}}))},Kt.createElement("div",{"aria-hidden":()=>!this.anyVisible()},()=>this.controller.s("graphing-calculator-text-geometry-hide-objects",{count:new Vo(this.getSelectedCount())})),Kt.createElement("div",{"aria-hidden":this.bindFn(this.anyVisible)},()=>this.controller.s("graphing-calculator-text-geometry-show-objects",{count:new Vo(this.getSelectedCount())})))),Kt.createElement(kE,{predicate:()=>this.controller.isSomeTransformToolVisible()},()=>Kt.createElement("div",{class:()=>({"dcg-btn-outline":!0,"dcg-transformations-button":!0,"dcg-transformations-open":this.isTransformationsMenuOpen()}),handleEvent:Kt.const("true"),tabindex:Kt.const("-1"),role:Kt.const("button"),"dcg-open-menu-guid":()=>hw(),onTap:this.bindFn(this.toggleTransformationsMenu),manageFocus:this.const(Qe({controller:this.controller,location:{type:"multi-select-transformations-icon"}}))},this.bindFn(this.getTransformationsString),Kt.createElement("i",{class:Kt.const("dcg-icon-caret-down"),"aria-hidden":Kt.const("true")}))),Kt.createElement(Me,{tooltip:this.bindFn(this.getMoreString)},Kt.createElement("span",{"aria-label":this.bindFn(this.getMoreString),role:Kt.const("button"),tabindex:Kt.const("-1"),handleEvent:Kt.const("true"),"aria-expanded":this.bindFn(this.isMoreMenuOpen),class:Kt.const("dcg-multi-select-icon-button dcg-more-options"),"dcg-open-menu-guid":()=>Eg(),manageFocus:this.const(Qe({controller:this.controller,location:{type:"multi-select-more-icon"}})),onTap:this.bindFn(this.toggleMoreMenu)},Kt.createElement(uE,null))),Kt.createElement(kE,{predicate:this.bindFn(this.isTransformationsMenuOpen)},()=>Kt.createElement(ec,{controller:this.props.controller,shouldHandleTabAndEscape:this.const(!0),menuType:this.const("multi-select-transformations"),menuButtonFocusLocation:this.const({type:"multi-select-transformations-icon"}),rootElSelector:this.const(".dcg-multi-select-header")},Kt.createElement(SE,{controller:this.props.controller}))),Kt.createElement(kE,{predicate:this.bindFn(this.isMoreMenuOpen)},()=>Kt.createElement(ec,{controller:this.props.controller,shouldHandleTabAndEscape:this.const(!0),menuType:this.const("multi-select-more"),menuButtonFocusLocation:this.const({type:"multi-select-more-icon"}),rootElSelector:this.const(".dcg-multi-select-header")},Kt.createElement(bE,{controller:this.props.controller}))))}handleKeydown(e){let t=Ee(e);if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||t!=="Left"&&t!=="Right"&&t!=="Home"&&t!=="End")return;let i=this.controller.getFocusLocation();if(!i)return;let o=__dcg_shared_module_exports__['H'](this.focusOrder,i);if(o===-1)return;e.preventDefault(),e.stopPropagation();let n=o;t==="Left"?n=Math.max(0,o-1):t==="Right"?n=Math.min(this.focusOrder.length-1,o+1):t==="Home"?n=0:t==="End"&&(n=this.focusOrder.length-1),n!==o&&this.controller.dispatch({type:"set-focus-location",location:this.focusOrder[n]})}getSelectedCountString(){return this.controller.getGrapherDimensions().width<450?"":this.controller.s("graphing-calculator-text-geometry-selected-objects",{count:new Vo(this.getSelectedCount())})}getDeletableItems(){return this.controller.getAllSelectedItems().filter(t=>!t.readonly)}shouldShowDeleteButton(){return this.getDeletableItems().length>0}getDeleteItemString(){let e=this.getSelectedCount(),t=this.getDeletableItems().length;return this.controller.s("graphing-calculator-text-geometry-delete-selected-objects",{count:new Vo(t),locked:new Vo(e-t)})}getMoreString(){return this.controller.s("graphing-calculator-text-geometry-multi-select-more-dropdown")}getTransformationsString(){return this.controller.s("graphing-calculator-text-geometry-multi-select-transform")}getSelectedItemsKey(){let e=this.controller.getAllSelectedItems();return __dcg_shared_module_exports__['x'](e,"id").join("-")}toggleItemsVisible(){this.anyVisible()?this.hideSelected():this.showSelected()}anyVisible(){let e=this.controller.getAllSelectedItems();return __dcg_shared_module_exports__['v'](e,t=>!Za(t))}isFolderMenuOpen(){return this.controller.isItemSettingsMenuOpen(AY())}isMoreMenuOpen(){return this.controller.isItemSettingsMenuOpen(Eg())}isTransformationsMenuOpen(){return this.controller.isItemSettingsMenuOpen(hw())}toggleMoreMenu(){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"multi-select-more",guid:Eg(),focusFirstOption:!0}})}toggleTransformationsMenu(){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"multi-select-transformations",guid:hw(),focusFirstOption:!0}})}getSelectedCount(){return this.controller.getAllSelectedItems().length}hideSelected(){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"visible",value:!1}})}showSelected(){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"visible",value:!0}})}onDone(){this.controller.dispatch({type:"set-none-selected"})}deleteSelected(){this.controller.dispatch({type:"delete-all-selected-items"})}};function AY(){return"**multi-select-folder**"}function Eg(){return"**multi-select-more**"}function hw(){return"**multi-select-transformations**"}var Gg=class{constructor(){this.displayName="graphing-calculator-text-geometry-tool-box-selection-display-name";this.toolType="selection";this.icon=[{type:"stroked-path",color:"#aaa",path:[35,35,51,35,51,51,35,51,35,35]},{type:"filled-polygon",color:"#000",path:[50,50,63.5,62,58.25,62.75,62,72.5,59.75,74,55.25,64.25,50.75,68,50,50]}]}getNumberInputLatex(){return""}clearTentativeOutputs(){}canNextInputBePoint(){return!1}getAllValidNextInputTypes(){return __dcg_shared_module_exports__['Ha'].filter(e=>this.isValidNextInputType(e))}isValidNextInputType(e){return e!==__dcg_shared_module_exports__['Ba']}getNonPointInputType(){}getHint(){return""}getExpressionEditHint(e){return this.getHint()}onNumberInput(e){}onMove(e){return!0}onFocus(e){}tryCommitResults(){return{committed:void 0}}shouldUseJitEdges(){return!1}shouldHighlightRelevantObjects(){return!1}};function Gq(r,e){return r===void 0?e===void 0:!(e===void 0||r.calcId!==e.calcId||r.listIndex!==e.listIndex||r.polygonEdge!==e.polygonEdge)}var GE=class{constructor(e){this.poiController=e,this.controller=e.controller,this.grapher=e.manager}getKeyboardAttention(){return this.objectUnderAttention}setKeyboardAttention(e){this.objectUnderAttention=e}findNonGeometryTabTargetsInGraph(){let e=this.grapher.imageLayer.getOrderedTabTargets(),t=this.grapher.clickableObjectsLayer.getOrderedTabTargets(),i=this.grapher.movablePointsLayer.getOrderedTabTargets();return e.concat(t).concat(i)}findTabbableObjectsForCurrentTool(e){let t=e==null?void 0:e.calcId,i={};this.controller.isGeometry()&&this.controller.getGeoModel().getAllChoosableDefsUnordered({mode:"tab"}).forEach(u=>{var h;i[u.calcId]||(i[u.calcId]=[]);let m={calcId:u.calcId,listIndex:u.listIndex,polygonEdge:(h=u.polygonEdgeInfo)==null?void 0:h.edgeNumber,geoDef:__dcg_shared_module_exports__['a']({},u)};i[u.calcId].push(m)});let o=this.controller.getGeoModel().getCurrentTool();(!this.controller.isGeometry()||o.isValidNextInputType(__dcg_shared_module_exports__['ba']))&&this.findNonGeometryTabTargetsInGraph().filter(p=>!(o instanceof Gg&&this.controller.isClickableId(p.calcId))).forEach(p=>{var m;let u=(m=p.listIndex)!=null?m:0;if(!i[p.calcId])i[p.calcId]=[];else if(u&&!(!this.controller.isGeometry()||this.controller.canExpandListForItem(p.calcId)))return;i[p.calcId][u]?i[p.calcId][u].description=p.description:i[p.calcId].push(p)});let n=[],a=-1,s=!1,l=this.grapher.getSketchOrder();for(let c=0;c<l.length;c++){let p=l[c];p===t&&(a=n.length);let u=i[p];if(u){u.sort((m,h)=>m.listIndex!==h.listIndex?m.listIndex===void 0?-1:h.listIndex===void 0?1:m.listIndex-h.listIndex:m.polygonEdge!==h.polygonEdge?m.polygonEdge===void 0?-1:h.polygonEdge===void 0?1:m.polygonEdge-h.polygonEdge:0);for(let m of u)p===t&&(s||(a=n.length),Gq(m,e)&&(s=!0)),n.push(m)}}return{targets:n,currentTabIndex:a,currentIsTabbable:s}}findNextObjFromKeyboard(e,t){let{targets:i,currentIsTabbable:o,currentTabIndex:n}=this.findTabbableObjectsForCurrentTool(t);if(!i.length)return;if(n===-1)return e==="next"?{wrapped:!1,target:i[0]}:{wrapped:!1,target:i[i.length-1]};let a=!1,s=n;return e==="prev"?s-=1:o&&(s+=1),s===-1?(a=!0,s=i.length-1):s>=i.length&&(a=!0,s=0),{wrapped:a,target:i[s]}}focusNextObjFromKeyboard(e={}){let t={allowWrapping:!0,selectNonClickables:!1,direction:"next"},{direction:i,allowWrapping:o,selectNonClickables:n}=__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},t),e),a=this.findNextObjFromKeyboard(i,this.getKeyboardAttention());return!a||!o&&a.wrapped?(n&&this.controller.dispatch({type:"set-none-selected"}),!1):(a.wrapped&&this.controller.isVirtualMouseAllowed()?this.resetBackToGeoKeyboardPt():(n&&(this.controller.isClickableId(a.target.calcId)||!this.controller.isGeoItem(a.target.calcId)?this.controller.dispatch({type:"set-none-selected"}):this.controller.dispatch({type:"set-selected-id",id:a.target.calcId})),this.updateKeyboardAttention(a.target,{describe:!0})),!0)}updateKeyboardAttention(e,t){let i=this.getKeyboardAttention();Gq(e,i)||(this.setKeyboardAttention(e),this.controller.isGeometry()&&this.controller.getGeoModel().onFocus(e==null?void 0:e.geoDef),this.poiController.moveGeoKeyboardPtToFocusedItem(t),t.describe&&this.poiController.describeFocusedItem({includeDetails:!0}))}clearAttentionIfNotTabbable(){let{currentIsTabbable:e}=this.findTabbableObjectsForCurrentTool(this.getKeyboardAttention());e||this.updateKeyboardAttention(void 0,{describe:!1})}handleGrapherGainedFocus(){if(this.controller.getGeoModel().speakCurrentGeoToolHint(),this.controller.isVirtualMouseAllowed())this.resetBackToGeoKeyboardPt();else{let t=this.findTabbableObjectsForCurrentTool(void 0).targets;t.length?(this.setKeyboardAttention(void 0),this.updateKeyboardAttention(t[0],{describe:!0})):be(this.controller.s("graphing-calculator-narration-geometry-no-tool-inputs"))}}resetBackToGeoKeyboardPt(){this.updateKeyboardAttention(void 0,{describe:!0}),this.poiController.geoKeyboardPt.x=this.poiController.geoKeyboardPt.lastArrowedX,this.poiController.geoKeyboardPt.y=this.poiController.geoKeyboardPt.lastArrowedY,this.poiController.handleGeoKeyboardPtMove()}};function XM(r,e){if(r.indexOf("\\idref_{")===0){let t=r.indexOf("}"),i=r.slice(8,t);return e(i)+r.slice(t+1)}else return r}function QM(r,e,t){var a;let i=s=>t?s.map(l=>XM(l,t)):s;switch(r.type){case"point-reference":return{latex:`${r.id}=${r.parents[0]}`,color:r.color};case"point":var{x:o,y:n}=r;return{latex:r.id+"=\\left("+__dcg_shared_module_exports__['rc'](o)+","+__dcg_shared_module_exports__['rc'](n)+"\\right)",color:r.color};case"glider":return{latex:r.id+"=\\operatorname{glider}\\left("+i(r.parents)[0]+","+__dcg_shared_module_exports__['rc'](r.t)+"\\right)",color:r.color};case"polygon":{let p="";return!e&&r.connectBorder&&(p=","+r.parents[0]),{latex:r.id+"=\\operatorname{"+r.type+"}\\left("+i(r.parents).join(",")+p+"\\right)",color:r.color}}case"circle":case"arc":case"compass":case"segment":case"line":case"ray":case"parallel":case"perpendicular":case"intersection":case"midpoint":return{latex:r.id+"=\\operatorname{"+r.type+"}\\left("+i(r.parents).join(",")+"\\right)",color:r.color};case"vector-copy":{let[p,u]=i(r.parents);return{latex:`${r.id}=\\operatorname{translate}\\left(${p},${p}.\\operatorname{start},${u}\\right)`,color:r.color}}case"vector":return{latex:r.id+"=\\operatorname{"+r.type+"}\\left("+i(r.parents).join(",")+"\\right)",color:r.color};case"vector-endpoint":return{latex:`${r.id}=${i(r.parents)[0]}.\\operatorname{${r.location}}`,color:r.color};case"translate":case"reflect":case"dilate":case"rotate":{let p=r.type==="dilate"||r.type==="rotate"?[...i([r.parents[0]]),r.parents[1]]:i(r.parents);return{latex:`${r.id}\\left(x\\right)=\\operatorname{${r.type}}\\left(x,${p.join(",")}\\right)`,color:r.color}}case"angle":case"directedangle":return{showAngleLabel:(a=r.showAngleLabel)!=null?a:!0,latex:r.id+"=\\operatorname{"+r.type+"}\\left("+i(r.parents).join(",")+"\\right)",color:r.color};case"angles":case"directedangles":return{showAngleLabel:e,latex:r.id+"=\\operatorname{"+r.type+"}\\left("+i(r.parents).join(",")+"\\right)"+(r.listAccess!==void 0?"\\left["+r.listAccess+"\\right]":""),color:r.color};case"polygon-segment":return{latex:r.id+"="+i(r.parents)[0]+(r.listAccess!==void 0?"\\left["+r.listAccess+"\\right]":"")+".\\operatorname{segments}\\left["+(r.edgeNumber+1)+"\\right]",color:r.color};case"slider":return{latex:r.latex,color:r.color,sliderInfo:r.sliderInfo};case"expression-edit-preview-latex":if(r.rhsLatex==="")return;let s="\\operatorname{angle}\\left(";return{showAngleLabel:r.rhsLatex.trim().startsWith(s),latex:r.id+"="+r.rhsLatex,color:r.color};default:return r}}function ZM(r,e){__dcg_shared_module_exports__['Ka'](r.valueType)?r.value.forEach((t,i)=>{e({valueType:__dcg_shared_module_exports__['La'](r.valueType),value:t},i+1)}):e(r,void 0)}function Tg(r,e){let{controller:t,expandLists:i=!0}=r;t.getAllItemModels().concat(t.getAllToolPreviewItems()).forEach(n=>{var u;if(!Md(n))return;let a=n.formula.typed_constant_value,s=n.formula.geometry,l=s.identifier,c=l?__dcg_shared_module_exports__['hb'](l):"\\idref_{"+n.id+"}",p=!t.getItemModel(n.id);i&&t.canExpandListForItem(n.id)?ZM(a,(m,h)=>{var D;let x=c+(h===void 0?"":"\\left["+h+"\\right]"),C={calcId:n.id,data:s,hidden:!n.shouldGraph,isGraphable:(D=n.formula)==null?void 0:D.is_graphable,assignment:c,listIndex:h!==void 0?h-1:void 0,typedRuntimeValue:m,referenceLatex:x};e(C,p)}):e({calcId:n.id,data:s,hidden:!n.shouldGraph,isGraphable:(u=n.formula)==null?void 0:u.is_graphable,assignment:c,listIndex:void 0,typedRuntimeValue:a,referenceLatex:c},p)})}function LY(r,e){switch(r.valueType){case __dcg_shared_module_exports__['ha']:return{valueType:__dcg_shared_module_exports__['da'],value:r.value[e]};case __dcg_shared_module_exports__['qa']:return{valueType:__dcg_shared_module_exports__['pa'],value:r.value[e]};case __dcg_shared_module_exports__['oa']:return{valueType:__dcg_shared_module_exports__['na'],value:r.value[e]};case __dcg_shared_module_exports__['wa']:return{valueType:__dcg_shared_module_exports__['va'],value:r.value[e]};case __dcg_shared_module_exports__['Ea']:return{valueType:__dcg_shared_module_exports__['Da'],value:r.value[e]};case __dcg_shared_module_exports__['ua']:return{valueType:__dcg_shared_module_exports__['ta'],value:r.value[e]};case __dcg_shared_module_exports__['ma']:return{valueType:__dcg_shared_module_exports__['la'],value:r.value[e]};case __dcg_shared_module_exports__['sa']:return{valueType:__dcg_shared_module_exports__['ra'],value:r.value[e]};case __dcg_shared_module_exports__['ya']:return{valueType:__dcg_shared_module_exports__['xa'],value:r.value[e]};case __dcg_shared_module_exports__['Aa']:return{valueType:__dcg_shared_module_exports__['za'],value:r.value[e]};case __dcg_shared_module_exports__['ja']:case __dcg_shared_module_exports__['fa']:case __dcg_shared_module_exports__['ea']:case __dcg_shared_module_exports__['Ca']:case __dcg_shared_module_exports__['ga']:case __dcg_shared_module_exports__['ka']:case __dcg_shared_module_exports__['ia']:throw new Error("Programming Error: unexpected type "+__dcg_shared_module_exports__['Ja'](r.valueType));default:throw r.valueType,new Error("Programming Error: expected a list type but found "+__dcg_shared_module_exports__['Ja'](r.valueType))}}function eA(r,e){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{referenceLatex:r.assignment+"\\left["+e+"\\right]",typedRuntimeValue:LY(r.typedRuntimeValue,e),listIndex:e})}function TE(r){switch(r){case __dcg_shared_module_exports__['da']:return"Point";case __dcg_shared_module_exports__['pa']:return"Circle";case __dcg_shared_module_exports__['ra']:return"Arc";case __dcg_shared_module_exports__['la']:return"Polygon";case __dcg_shared_module_exports__['ta']:return"Line";case __dcg_shared_module_exports__['na']:return"Segment";case __dcg_shared_module_exports__['va']:return"Ray";case __dcg_shared_module_exports__['Da']:return"Vector";case __dcg_shared_module_exports__['xa']:return"Angle";case __dcg_shared_module_exports__['za']:return"Angle"}}function Tq(r){if(!r)return;let e=r.typedRuntimeValue;return TE(e.valueType)}function IE(r){if(!r)return 0;if(r.type==="image"&&r.listIndex)return r.listIndex;if("poi"in r)return r.poi.pointIdxOnBranch;if("branchInfo"in r&&r.branchInfo.sketch){let e=r.branchInfo.branch,t=r.branchInfo.sketch.branches[e];return"listIndex"in t&&t.listIndex||0}return 0}var _Y=0,VE=class r{constructor(e,t){this.geoKeyboardPt={x:NaN,y:NaN,lastArrowedX:NaN,lastArrowedY:NaN};this.grapherIsPressed=!1;this.canceledGeoToolplayWhilePressed=!1;this.manager=e,this.controller=e.controller,this.keyboardAttentionManager=new GE(this),this.graphSettings=t,this.elt=this.manager.elt,this.id=_Y++,!(!this.graphSettings.config.graphpaper||this.graphSettings.config.disableMouseInteractions)&&(this.addTouchEventHandlers(),this.addHoverEventHandler(),this.addKeydownEventHandler(),this.addManualUnhoverListener(),this.addGeoEventHandlers())}remove(){this.removeAllGlobalMouseListeners(),this.removeManualUnhoverListener(),this.removeAllGeoListeners(),this.removeHoverEventHandler()}addGlobalMouseListener(e,t){let i=e.split(" ");for(let o of i){let n=o+".dcg-poiController-"+this.id;H(document).on(n,t)}}removeAllGeoListeners(){H(document).off(".dcg-poiController-geo-"+this.id)}removeAllGlobalMouseListeners(){H(document).off(".dcg-poiController-"+this.id)}getToleranceByDevice(e){return e==="touch"?20:10}addGeoEventHandlers(){let e="keydown.dcg-poiController-geo-"+this.id,t="keyup.dcg-poiController-geo-"+this.id,i=e+" "+t;H(document).on(i,o=>{this.controller.isGeoToolActive()&&this.handleGeoShiftKeyChange(o.shiftKey)}),H(document).on("mouseleave.dcg-poiController-geo-"+this.id,()=>{if(this.controller.isGeoToolActive()&&!this.grapherIsPressed){let o=this.controller.getGeoModel();o.onMouseAction("move",{pt:{x:NaN,y:NaN},shift:!1,tolerance:0}),o.onPreviewChange()}}),H(document).on("dcg-tapend.dcg-poiController-geo-"+this.id,o=>{this.controller.isGeoToolActive()&&this.handleGeoTapEnd(o)})}removeHoverEventHandler(){H(document).off(".dcg-poiController-global-hover-"+this.id)}addHoverEventHandler(){let e="dcg-tapmove.dcg-poiController-global-hover-"+this.id;H(document).on(e,t=>{var I;let i=t;if(this.controller.isGeoToolActive()&&this.handleGeoTapMove(i)||(this.lastGeoMouseEvent=void 0,i.device==="touch"))return;let o=document.elementFromPoint(i.clientX,i.clientY),n=!!o&&!!o.closest(".dcg-grapher"),a=(I=this.controller.getGrapher3d())==null?void 0:I.webglLayer,s=this.manager.poiLabelsLayer,l=this.getMouseRelativeToGrapher(i),c=this.getToleranceByDevice(i.device);a&&(a==null||a.setMouse(n?l:void 0));let p;n&&(p=this.getFeatureUnderPoint(l,c));let u;if(p&&p.type==="movable-point"){let S=p.poi,V=S&&S.getMovablePoint();u=V&&V.id}let m,h=0;p&&p.isClickable&&!this.isBoxSelectActive(i)&&!this.manager.movablePointsLayer.isMovingPoint()&&!this.manager.traceLayer.isTracing()&&(m=p.model,h=IE(p));let x=this.manager.clickableObjectsLayer,C={};m&&(C[m.id]={listIndexes:h===void 0?void 0:{[h]:!0}}),x.setHoveredObjects(C);let D;p&&"poi"in p&&p.poi&&(!p.poi.isAttachedToPlottedPoint()||p.poi.hasInteractiveLabel())&&(D=p.poi),D!==s.getHoveredPOI()&&(this.controller.isTraceEnabled()?s.setHoveredPOI(D):s.setHoveredPOI(void 0),this.controller.requestRedrawGraph());let k=!1;if(p&&p.type==="image"){let S=Nd(p.model),V=p.isClickable;k=S&&!V}let M=!1;p&&p.type==="draggable-label"&&(M=!0),k||M?this.manager.setLayerClass("extraMoveCursor","dcg-mouse-over-movable-point"):this.manager.setLayerClass("extraMoveCursor",""),this.manager.movablePointsLayer.setHoveredPointId(u)})}addManualUnhoverListener(){let e=()=>{let t=this.manager;t.poiLabelsLayer.setHoveredPOI(void 0),t.clickableObjectsLayer.setHoveredObjects({}),this.controller.requestRedrawGraph()};H(window).on("blur.dcg-poiController-"+this.id,e),H(this.elt).on("mouseleave",e)}removeManualUnhoverListener(){H(window).off(".dcg-poiController-"+this.id)}add3DTouchEventHandlers(e){let t=e.elt;if(!t)return;let i=e.webglLayer;H(t).on("dcg-tapstart",o=>{var l;if(o.touches.length>1)return;let{x:n,y:a}=this.getMouseRelativeToGrapher(o);i.setMouse({x:n,y:a}),i.pickAtMouseAndReadResults();let s=(l=i.getPickResult())==null?void 0:l.expressionId;s&&this.controller.dispatch({type:"set-selected-id",id:s})})}addTouchEventHandlers(){H(this.elt).on("touchstart",e=>{let t=e;if(!this.isViewportLocked()){t.target.matches("input, textarea")||t.preventDefault();return}let i=this.getMouseRelativeToGrapher(t),o=this.getToleranceByDevice(t.device),n=this.getFeatureUnderPoint(i,o);n&&(n.type==="image"&&!aa(n.model)&&!Nd(n.model)||n.type==="sketch-branch"&&this.graphSettings.config.onlyTraceSelected&&!n.sketch.selected||t.target.matches("input, textarea")||t.preventDefault())}),H(this.elt).on("dcg-tapstart",e=>{let t=e;if(this.controller.isGeoToolActive()&&this.handleGeoTapStart(t)){t.handle();return}let i=this.getMouseRelativeToGrapher(t),o=this.getToleranceByDevice(t.device),n=this.getFeatureUnderPoint(i,o);if(!n){this.isBoxSelectActive(t)||this.controller.dispatch({type:"set-none-selected"}),this.isBoxSelectActive(t)?this.startBoxSelect(t):this.manager.viewportController.beginPanning(t);return}if(n.isClickable&&!this.isBoxSelectActive(t)){let l="model"in n&&n.model;l?this.manager.clickableObjectsLayer.setPressedObject({id:l.id,listIndex:IE(n)}):this.manager.clickableObjectsLayer.setPressedObject(void 0)}else this.manager.clickableObjectsLayer.setPressedObject(void 0);if(n.type==="editable-label"){t.handle();return}else Kr();if(n.type==="draggable-label"){this.startMovingPoints({poiUnderMouse:void 0,evt:t,points:[{type:"draggable-label",label:n.label,startScreenPt:i}]}),t.handle();return}if(n.type==="clickable-label"&&t.handle(),n.type==="image"&&Nd(n.model)&&!this.isBoxSelectActive(t)){let l=!!n.isClickable;if(this.startMovingPoints({poiUnderMouse:void 0,evt:t,points:[{type:"image",image:n.model,startScreenPt:i,shouldDelayUntilRealMove:l}]}),!l){t.handle();return}}let a=!1,s=n.model;if(this.controller.isGeometry()&&s&&s.type==="expression"&&s.formula.geometry){!this.isBoxSelectActive(t)&&!this.controller.isItemSelected(s.id)&&this.controller.dispatch({type:"set-none-selected"});let l;"poi"in n&&(l=n.poi),a=this.startReverseDrag(s.id,t,l),a&&n.type!=="static-point"&&this.manager.clickableObjectsLayer.setPressedObject({id:s.id,listIndex:IE(n)})}if(n.type==="movable-point"&&(t.handle(),t.handle("do-not-clear-poi-labels"),!a)){this.startMovingPoints({poiUnderMouse:n.poi,evt:t,points:[{type:"poi",poi:n.poi,startScreenPt:i}]});return}if(n.type==="static-point"&&!n.isClickable){let l=n.poi;if(this.controller.isGeometry()){if(l&&l.hasInteractiveLabel()){this._togglePOIUnderPoint(i,o)&&t.handle("do-not-clear-poi-labels");return}}else if(l){this._togglePOIUnderPoint(i,o)&&t.handle("do-not-clear-poi-labels");return}(!n.sketch.selected||this.isBoxSelectActive(t))&&n.model&&this.selectItemIfNotSecret(n.model.id,this.isBoxSelectActive(t));return}if(!a&&this._togglePOIUnderPoint(i,o)){t.handle(),t.handle("do-not-clear-poi-labels");return}if(!a&&n.type==="sketch-branch"&&!n.isClickable){let l=!this.controller.isTraceEnabled();if(this.graphSettings.config.onlyTraceSelected){if(t.handle("do-not-clear-poi-labels"),!l&&n.sketch.selected&&!this.isBoxSelectActive(t)){this.startTracingBranch(n.branchInfo,i),t.handle();return}}else{let c=!this.controller.isListEnabled();if(l&&c||(this.selectItemIfNotSecret(n.sketch.id,this.isBoxSelectActive(t)),l))return;this.startTracingBranch(n.branchInfo,i),t.handle(),t.handle("do-not-clear-poi-labels");return}}this.addGlobalMouseListener("dcg-tapmove",l=>{this.manager.clickableObjectsLayer.isAnObjectPressed()?i=this.getMouseRelativeToGrapher(l):(this.removeAllGlobalMouseListeners(),this.manager.viewportController.beginPanning(l))}),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",l=>{this.removeAllGlobalMouseListeners();let c=this.manager.clickableObjectsLayer.getPressedObject(),p=c&&c.id;this.manager.clickableObjectsLayer.setPressedObject(void 0);let u=this.getFeatureUnderPoint(i,o);if(u&&u.isClickable){let m="model"in u&&u.model;m&&m.id===p&&!l.wasHandled("dragged-clickable-object")&&!this.isBoxSelectActive(l)&&this.controller.dispatch({type:"clickable-item-clicked",id:m.id,listIndex:IE(u)});return}if(!a){if(u&&u.type==="sketch-branch"&&(!u.sketch.selected||this.isBoxSelectActive(l))){this.selectItemIfNotSecret(u.model.id,this.isBoxSelectActive(l));return}if(u&&(u.type==="movable-point"||u.type==="static-point")){(!u.sketch.selected||this.isBoxSelectActive(l))&&u.model&&this.selectItemIfNotSecret(u.model.id,this.isBoxSelectActive(l));return}if(u&&u.type==="image"){this.selectItemIfNotSecret(u.model.id,this.isBoxSelectActive(l));return}}})})}isBoxSelectActive(e){if(!this.controller.isMultiSelectEnabled())return!1;let t=this.controller.getActiveTool();return t==="selection"&&e.shiftKey||t==="box-selection"}isViewportLocked(){return this.graphSettings.config.lockViewport||this.graphSettings.userLockedViewport}addKeydownEventHandler(){H(this.elt).on("keydown",e=>{var s,l,c;let t=e;if(this.manager.getAudioTrace().getAudioTraceActive())return;let i=this.manager.movablePointsLayer.getPOIUnderAttention(),o=this.manager.imageLayer.getFocusedImage(),n=Ee(t),a=ki(t);if((n==="Up"||n==="Down"||n==="Left"||n==="Right")&&this.controller.isGraphPaperFocused()){t.stopPropagation(),t.preventDefault();let p=this.keyboardAttentionManager.getKeyboardAttention();if(p&&this.controller.shouldAllowMovingPointsWithKeyboard()){let u=o?o.centerId:p.calcId;if(!u)return;let m=this.getDraggablePointOrAncestors(u);this.movePointsFromKeyboard(m,t),this.controller.getEvaluator().notifyWhenSynced(()=>{this.describeFocusedItem({includeDetails:!0})})}else this.controller.isVirtualMouseAllowed()&&(this.keyboardAttentionManager.updateKeyboardAttention(void 0,{describe:!1}),this.moveGeoPointFromKeyboard(t))}else if(n==="Tab"&&this.controller.isGraphPaperFocused()){let p=t.shiftKey?"prev":"next",u=this.keyboardAttentionManager.getKeyboardAttention();if(!(this.controller.getActiveTool()!=="selection")&&!u&&p==="prev")return;this.handleTabEvent(p,t)}else if((n==="Enter"||n==="Space")&&this.controller.isGraphPaperFocused()&&this.controller.getActiveTool()==="selection"){let p=this.keyboardAttentionManager.getKeyboardAttention();if(p){let u=this.controller.getItemModel(p.calcId);if(u&&!this.isBoxSelectActive(t)){let m=u.type==="expression"&&vs(u),h=u.type==="image"&&cg(u);(m||h)&&this.controller.dispatch({type:"clickable-item-clicked",id:p.calcId,listIndex:p.listIndex})}}t.preventDefault(),t.stopPropagation();return}else if(this.controller.isGeometry()&&this.controller.isGraphPaperFocused()){let p=!1;if(t.ctrlKey&&t.shiftKey&&!t.altKey&&!t.metaKey){let u;if(a==="O"?u={type:"multi-select-more",guid:Eg(),focusFirstOption:!0,previousFocusLocation:{type:"graph-paper"}}:a==="A"&&(u={type:"multi-select-transformations",guid:hw(),focusFirstOption:!0,previousFocusLocation:{type:"graph-paper"}}),u){t.preventDefault(),t.stopPropagation();let m=this.keyboardAttentionManager.getKeyboardAttention();this.controller.getActiveTool()!=="box-selection"&&m&&this.controller.getItemModel(m.calcId)&&this.controller.dispatch({type:"set-selected-id",id:m.calcId}),this.controller.dispatch({type:"toggle-item-settings-menu",menu:u})}}else if(!t.altKey&&!t.ctrlKey&&!t.metaKey){if(n==="Enter"||n==="Space")if(t.preventDefault(),this.controller.getActiveTool()!=="selection"&&t.stopPropagation(),this.controller.getActiveTool()==="box-selection"){let u=((s=this.keyboardAttentionManager.getKeyboardAttention())==null?void 0:s.calcId)||"";this.controller.isClickableId(u)&&(u=""),this.selectItemIfNotSecret(u,!0),this.describeFocusedItem({includeDetails:!1})}else{let u=this.keyboardAttentionManager.getKeyboardAttention();u!=null&&u.geoDef?this.tapGeoObjectFromKeyboard(u.geoDef,t):this.tapGeoPointFromKeyboard(t)}else if(a==="?")t.preventDefault(),t.stopPropagation(),this.controller.getGeoModel().speakCurrentGeoToolHint();else if(a==="D")t.preventDefault(),t.stopPropagation(),this.describeFocusedItem({includeDetails:!0});else if(n==="Backspace"||n==="Del"){t.preventDefault(),t.stopPropagation();let u=this.keyboardAttentionManager.getKeyboardAttention();this.controller.getActiveTool()!=="box-selection"&&u&&this.controller.getItemModel(u.calcId)&&this.controller.dispatch({type:"set-selected-id",id:u.calcId}),this.controller.dispatch({type:"delete-all-selected-items"}),p=!0}else if(a==="-"||a==="="){t.preventDefault(),t.stopPropagation();let u=this.controller.getAllVisibleGeoToolbarItems(),m=u.findIndex(h=>(h==null?void 0:h.current)===this.controller.getActiveTool());for(let h=1;h<u.length;h++){let x=m+(a==="-"?-h:h);x<0&&(x=u.length+x),x>u.length-1&&(x=x-u.length);let C=(l=u[x])==null?void 0:l.current;if(this.selectGeoTool(C)){p=!0;break}}}else if(a==="["||a==="]"){t.preventDefault(),t.stopPropagation();let m=this.controller.getAllVisibleGeoToolbarItems().find(C=>(C==null?void 0:C.current)===this.controller.getActiveTool());if(!m)return;let h=m.dropdown||[m.current];if(h.length===0)return;let x=h.indexOf(m.current);for(let C=1;C<h.length;C++){let D=x+(a==="["?-C:C);D<0&&(D=h.length+D),D>h.length-1&&(D=D-h.length);let k=h[D];if(this.selectGeoTool(k)){p=!0;break}}}else if(!t.shiftKey&&a!==void 0&&a>="0"&&a<="9"){let u=(c=this.controller.getAllVisibleGeoToolbarItems()[t.which-49])==null?void 0:c.current;p=this.selectGeoTool(u)}}p&&this.handleGeoKeyboardPtMove()}else i&&(a==="X"||a==="Y"||a==="L"||a==="C")?this.speakPoint(i,a):o&&(a==="X"||a==="Y"||a==="L")&&this.manager.imageLayer.speakImageAttribute(o,a)})}selectGeoTool(e){return e?this.controller.isGeoToolEnabled(e)?(this.controller.dispatch({type:"select-geo-tool",tool:e}),!0):(be(this.controller.s("graphing-calculator-narration-geometry-tool-disabled",{tool:this.controller.getGeoModel().getDisplayNameForTool(e)})),!1):!1}getMouseRelativeToGrapher(e){let t=this.elt.getBoundingClientRect(),i=e.touches?e.touches[0]:e,o=i.clientX-t.left,n=i.clientY-t.top;return{x:o,y:n}}_getStyledPointRadiusAdjustments(){return{radiusMultiplier:this.graphSettings.getHighlightPropertyMultiplier("pointLineWidth",!1),selectedRadiusMultiplier:this.graphSettings.getHighlightPropertyMultiplier("pointLineWidth",!0),movablePoint:this.graphSettings.config.projectorMode?30/2:22/2}}_getStyledPointRadiusForPOI(e,t){if(e.isMovable())return t.movablePoint;{let i=e.getPointSize()/2,o=e.isSelected()?t.selectedRadiusMultiplier:t.radiusMultiplier;return i*o}}handleTabEvent(e,t){let i=this.controller.getActiveTool()!=="selection";if(this.keyboardAttentionManager.focusNextObjFromKeyboard({direction:e,allowWrapping:i,selectNonClickables:this.controller.getActiveTool()==="selection"})){t==null||t.preventDefault(),t==null||t.stopPropagation();return}else if(!i){this.keyboardAttentionManager.updateKeyboardAttention(void 0,{describe:!1}),e==="prev"&&(t==null||t.preventDefault(),t==null||t.stopPropagation(),this.manager.speakGrapherFocusAriaLabel());return}}_getDistanceFromStyledPOI(e,t){let i=this._getStyledPointRadiusForPOI(e,t.adjustments),o=Math.max(0,t.tolerance-i),n=t.projection.map_pt(e),a=__dcg_shared_module_exports__['Ua'](n.x-t.screenPt.x,n.y-t.screenPt.y),s=Math.max(0,a-i);if(s<=o)return s}_getClosestPoint(e,t,i){let o=1/0,n,a={projection:this.manager.getProjection(),adjustments:this._getStyledPointRadiusAdjustments(),screenPt:t,tolerance:i};for(let s of e){let l=this._getDistanceFromStyledPOI(s,a);l!==void 0&&l<o&&(o=l,n=s)}return n}findIdsThatIntersectBox(e){let t={},i=this.manager.getSketchOrder();for(let o=i.length-1;o>=0;o--){let n=i[o],a=this.controller.getItemModel(n);if(a){if(a.type==="expression"){let s=this.manager.getGraphSketch(n);if(!s||vs(a)||this.controller.isItemNotSelectableBecauseItsSecret(n))continue;let l=s.branches;if(!l||!l.length)continue;for(let c=0;c<l.length;c++)if(this.doesBoxIntersectBranch(l[c],e)){t[a.id]=!0;break}}else if(a.type==="image"){let s=this.manager.getGraphImage(n);if(!s)continue;r.doesBoxIntersectAnyImage(s,e)&&(t[a.id]=!0)}}}return this.manager.poiDotsLayer.getDrawnPOI().forEach(o=>{let n=o.sketch.id,a=this.controller.getItemModel(n);a&&a.type==="expression"&&vs(a)||this.controller.isItemNotSelectableBecauseItsSecret(n)||o.isBareLabel()||(o.isMovable()||o.isAttachedToPlottedPoint())&&r.doesBoxIntersectPOI(o,e)&&(t[n]=!0)}),t}_getStyledLineAdjustments(){return{thicknessMultiplier:this.graphSettings.getHighlightPropertyMultiplier("graphLineWidth",!1),selectedThicknessMultiplier:this.graphSettings.getHighlightPropertyMultiplier("graphLineWidth",!0)}}_getStyledLineThicknessForBranch(e,t,i){let o=Math.max(0,"lineWidth"in e&&e.lineWidth||0)/2;return t?o*i.selectedThicknessMultiplier:o*i.thicknessMultiplier}_getDistanceFromStyledBranch(e,t,i,o){let n=this._getStyledLineThicknessForBranch(e,t,o.adjustments),a=this.calculateDistanceFromBranch(e,o.screenPt,o.projection,i),s=Math.max(0,a-n),l=Math.max(0,o.tolerance-n);if(s<=l)return s}getFeatureUnderPoint(e,t){let i=this.manager.poiLabelsLayer,o=this.manager.getProjection();if(this.manager.scaleAxis)return;let n=i.getInteractiveLabelUnderPoint(e);if(n)switch(n.type){case"editable":return{type:"editable-label",model:n.model,isClickable:void 0};case"draggable":return{type:"draggable-label",label:n.label,isClickable:void 0};case"clickable":return{type:"clickable-label",model:n.model,poi:n.poi,isClickable:!0}}let a=this.manager.getSketchOrder(),s={},l=1,c,p={adjustments:this._getStyledLineAdjustments(),projection:o,screenPt:e,tolerance:t};for(let I=a.length-1;I>=0;I--){let S=a[I],V=this.controller.getItemModel(S),P=l;if(s[S]=P,!!V){if(V.type==="expression"){let L=this.manager.getGraphSketch(S);if(!L)continue;let B=L.branches;if(!B||!B.length)continue;if(L.showHighlight&&!this.controller.isGeometry()&&(P=-1/0,s[S]=P),!c||c.stackingContext>=P){let R=vs(V);for(let W=0;W<B.length;W++){let re=B[W],ne=this._getDistanceFromStyledBranch(re,L.showHighlight,R,p);if(ne!==void 0){let X=!1;c?(P<c.stackingContext||P===c.stackingContext&&ne<c.distance-3.5)&&(X=!0):X=!0,X&&(c={type:"sketch-branch",model:V,sketch:L,distance:ne,stackingContext:P,branchInfo:{id:L.id,branch:W,sketch:L}})}}}}else if(V.type==="image"){let L=this.manager.getGraphImage(S);if(!L)continue;let B=this.getImageInfoUnderMouse(L,o.pixelsToMath.mapPoint(e),t);if(!B)continue;L.foreground?(l+=1,P=l,s[S]=P,l+=1):(P=1/0,s[S]=P),(!c||c.stackingContext>P)&&(c={type:"image",model:L,distance:0,stackingContext:P,listIndex:B.listIndex})}}}let u=[],m=[],h=[],x=[],C=c?c.stackingContext:1/0;this.manager.poiDotsLayer.getDrawnPOI().forEach(I=>{var S;if(!I.isBareLabel())if(I.isMovable()){let V=I.sketch.id,P=this.controller.getItemModel(V),L=P&&P.type==="expression"&&((S=P.formula.geometry)==null?void 0:S.call);L&&L.symbol==="glider"?u.push(I):m.push(I)}else I.isAttachedToPlottedPoint()?s[I.sketch.id]<=C&&h.push(I):x.push(I)});let D=this._getClosestPoint(u,e,t);if(D||(D=this._getClosestPoint(m,e,t)),D)return{type:"movable-point",poi:D,isClickable:void 0,sketch:D.sketch,model:this.controller.getItemModel(D.sketch.id)};let k=this._getClosestPoint(x,e,t);if(k)return{type:"poi",poi:k,isClickable:!1,model:void 0};let M=this._getClosestPoint(h,e,t);if(M){let I=this.controller.getItemModel(M.sketch.id);return I&&I.type==="expression"&&vs(I)?{type:"static-point",poi:M,sketch:M.sketch,isClickable:!0,model:I}:{type:"static-point",poi:M,isClickable:!1,sketch:M.sketch,model:I}}if(c){if(c.type==="sketch-branch")return{type:"sketch-branch",branchInfo:c.branchInfo,sketch:c.sketch,model:c.model,isClickable:vs(c.model),isSelected:this.controller.isItemSelected(c.sketch.id),selectionId:this.controller.isItemSelectable(c.model.id)?c.model.id:void 0};if(c.type==="image")return{type:"image",model:c.model,isClickable:cg(c.model),listIndex:c.listIndex,isSelected:this.controller.isItemSelected(c.model.id),selectionId:this.controller.isItemSelectable(c.model.id)?c.model.id:void 0}}}_togglePOIUnderPoint(e,t){if(!this.controller.isTraceEnabled())return;let i=this.getFeatureUnderPoint(e,t);if(!i||i.isClickable)return!1;let o="poi"in i&&i.poi;return!o||o.isBareLabel()?!1:(this.manager.poiLabelsLayer.isOpenPOI(o)?(this.manager.poiLabelsLayer.closePOI(o),this.manager.poiLabelsLayer.setHoveredPOI(void 0)):(this.manager.poiLabelsLayer.openPOI(o),this.speakPoint(o)),this.controller.requestRedrawGraph(),!0)}getImageInfoUnderMouse(e,t,i){if(!e)return;let o=e.formula;if(!o)return;let n=o.dimensions;if(!(!n.x||!n.y||!n.width||!n.height||!n.radianAngle||!e.shouldGraph))for(let a=n.x.length-1;a>=0;a--){let s=n.x[a],l=n.y[a],c=n.radianAngle[a],p=s+Math.cos(c)*(t.x-s)-Math.sin(c)*(t.y-l),u=l+Math.sin(c)*(t.x-s)+Math.cos(c)*(t.y-l),m=.5*Math.abs(n.width[a]),h=.5*Math.abs(n.height[a]);if(p>s-m&&p<s+m&&u>l-h&&u<l+h)return{listIndex:a}}}doesBoxIntersectBranch(e,t){let i=!1,o=!1;switch(e.graphMode){case 5:case 8:case 2:break;case 6:i=!0;break;case 1:o=!0;break;case 18:case 17:case 19:case 24:return dE(t,{x1:e.segments[0][0],y1:e.segments[0][1],x2:e.segments[0][2],y2:e.segments[0][3],extendStart:e.graphMode===18,extendEnd:e.graphMode!==17});case 20:return QB(t,{x:e.segments[0][0],y:e.segments[0][1],radius:e.segments[0][2]});case 21:case 23:{let[a,s]=e.segments[0],[l,c,p]=e.graphMode===21?this.getBoxIntersectArgsForArc(e):this.getBoxIntersectArgsForAngleMarker(e),u=(p-c)/2+c;return XB(t,{x0:a+l*Math.cos(c),y0:s+l*Math.sin(c),x1:a+l*Math.cos(u),y1:s+l*Math.sin(u),x2:a+l*Math.cos(p),y2:s+l*Math.sin(p)})}default:return!1}let n=e.segments;for(let a=0;a<n.length;a++){let s=n[a];if(i){let l=s;s=[];for(let c=0;c<l.length;c+=2){let p=l[c],u=l[c+1];s.push(u*Math.cos(p),u*Math.sin(p))}}else if(o){let l=s;s=[];for(let c=0;c<l.length;c+=2)s.push(l[c+1],l[c])}if(ZB(t,s))return!0}return!1}getBoxIntersectArgsForArc(e){return[e.segments[0][2],e.segments[0][3],e.segments[0][4]]}getBoxIntersectArgsForAngleMarker(e){let t=e.segments[0][3],i=this.manager.getProjection(),o=th(t,i),n=i.pixelsToMath.dangerouslyGetXScaleFactor(),a=i.pixelsToMath.dangerouslyGetYScaleFactor();return[Math.abs(Math.min(n,a))*o,e.segments[0][2],e.segments[0][2]+t]}static doesBoxIntersectAnyImage(e,t){let i=e.formula;if(!i)return;let o=i.dimensions;if(!(!o.x||!o.y||!o.width||!o.height||!o.radianAngle||!e.shouldGraph)){for(let n=o.x.length-1;n>=0;n--)if(eq(t,{width:o.width[n],height:o.height[n],angle:o.radianAngle[n],center:{x:o.x[n],y:o.y[n]}}))return!0;return!1}}static doesBoxIntersectPOI(e,t){return t.left<=e.x&&e.x<=t.right&&t.top<=e.y&&e.y<=t.bottom}calculateDistanceFromBranch(e,t,i,o){if(e&&e.graphMode===7&&(o||this.controller.isGeometry())){let a=e.segments,s=i.pixelsToMath.mapCoordinatePair([t.x,t.y]);for(let l=0;l<a.length;l++)if(__dcg_shared_module_exports__['xb'](a[l],s))return 0;return 1/0}let n=r.getBranchesDistanceInfo(e,t,i,o,this.controller.isGeometry());return n?n.minDistance:1/0}static getBranchesDistanceInfo(e,t,i,o,n){let a=t.x,s=t.y,{mathToPixels:l,pixelsToMath:c}=i;switch(e.graphMode){case 5:if(!n&&!o)return;break;case 8:if(!o)return;break;case 6:if(!o)return;break;case 2:case 1:break;case 23:{let[k,M,I,S]=e.segments[0],V=l.dangerouslyGetXScaleFactor(),P=l.dangerouslyGetYScaleFactor(),[L,B]=c.mapCoordinatePair([a,s]),R=th(S,i),W=R/V,re=1/0,ne=B-M,X=L-k,b=Math.atan2(ne,X);if(__dcg_shared_module_exports__['Sa'](b,I,S))__dcg_shared_module_exports__['Ua'](ne*P,X*V)<=R+7&&(re=0);else{let A=__dcg_shared_module_exports__['Xa'](L,B,k+W*Math.cos(I),M+W*Math.sin(I),k,M),E=__dcg_shared_module_exports__['Xa'](L,B,k+W*Math.cos(I+S),M+W*Math.sin(I+S),k,M),J=__dcg_shared_module_exports__['Ua'](V*(A[0]-L),P*(A[1]-B)),j=__dcg_shared_module_exports__['Ua'](V*(E[0]-L),P*(E[1]-B));re=Math.min(J,j)}return{closestPoint:{x:a,y:s},minDistance:re,secondDistance:re}}break;case 18:case 17:case 19:case 24:{if(!e.segments.length)return null;let k=l.mapX(e.segments[0][0]),M=l.mapY(e.segments[0][1]),I=l.mapX(e.segments[0][2]),S=l.mapY(e.segments[0][3]),V=e.graphMode===18,P=e.graphMode===18||e.graphMode===19,L=__dcg_shared_module_exports__['Ya'](a,s,k,M,I,S,V,P);if(!L)return null;let B=__dcg_shared_module_exports__['Ua'](L[0]-a,L[1]-s);return{closestPoint:{x:L[0],y:L[1]},minDistance:B,secondDistance:B}}case 21:case 20:{let k=e.segments[0][0],M=e.segments[0][1],I=e.segments[0][2],S=e.graphMode===21?e.segments[0][3]:0,V=e.graphMode===21?e.segments[0][4]:Math.PI*2,P=__dcg_shared_module_exports__['Za'](c.mapX(a),c.mapY(s),k,M,I,S,V);if(!P)return null;let L=l.mapCoordinatePair(P),B=__dcg_shared_module_exports__['Ua'](L[0]-a,L[1]-s);return{closestPoint:{x:L[0],y:L[1]},minDistance:B,secondDistance:B}}default:return}let p=1/0,u=1/0,m,h;for(let k=0;k<e.segments.length;k++){let M=e.segments[k];for(let I=0;I<M.length-3;I+=2){let S=M[I],V=M[I+1],P=M[I+2],L=M[I+3];if(e.graphMode===6){let A=V,E=S;S=A*Math.cos(E),V=A*Math.sin(E);let J=L,j=P;P=J*Math.cos(j),L=J*Math.sin(j)}e.graphMode===1&&([S,V]=[V,S],[P,L]=[L,P]);let[B,R]=l.mapCoordinatePair([S,V]),[W,re]=l.mapCoordinatePair([P,L]),ne=__dcg_shared_module_exports__['Xa'](0,0,B-a,R-s,W-a,re-s),X=__dcg_shared_module_exports__['Ua'](ne[0],ne[1]);ne[e.graphMode===1?1:0]<0?X<p&&(p=X,m=ne):X<u&&(u=X,h=ne)}}let x=p<u?m:h;if(!x)return;let C=x[0]+a,D=x[1]+s;return{closestPoint:{x:C,y:D},minDistance:Math.min(p,u),secondDistance:Math.max(p,u)}}static getBranchesTracePoint(e,t,i,o){let n,a=i.pixelsToMath.mapPoint(t);switch(e.graphMode){case 20:case 21:{let R=e.graphMode===21?e.segments[0][3]:0,W=e.graphMode===21?e.segments[0][4]:Math.PI*2;n=__dcg_shared_module_exports__['Za'](a.x,a.y,e.segments[0][0],e.segments[0][1],e.segments[0][2],R,W);break}case 18:case 19:case 17:n=__dcg_shared_module_exports__['Ya'](a.x,a.y,e.segments[0][0],e.segments[0][1],e.segments[0][2],e.segments[0][3],e.graphMode===18,e.graphMode!==17);break}if(n)return{x:n[0],y:n[1]};if(!e)return;let s="compiled"in e&&e.compiled,l=s&&s.fn;if(!l)return;let c=this.getBranchesDistanceInfo(e,t,i,!1,o);if(!c)return;let{mathToPixels:p,pixelsToMath:u}=i,m,h;e.graphMode===2?(h="x",m="y"):(h="y",m="x",p=new __dcg_shared_module_exports__['Dc'](p.yScale,p.xScale),u=p.inverse());let x=Math.pow(c.minDistance/c.secondDistance,2),C=c.closestPoint[h]*(1-x)+t[h]*x,D=.5,k=.5,M=p.mapY(l(u.mapX(C-D))),I=p.mapY(l(u.mapX(C))),S=p.mapY(l(u.mapX(C+D))),V=D*Math.min(1,k/Math.abs(M-I)),P=D*Math.min(1,k/Math.abs(S-I));isFinite(V)||(V=D),isFinite(P)||(P=D);let L=Ei(u.mapX(C-V),u.mapX(C+P)),B=l(L);if(!isFinite(p.mapY(B))){let R=p.mapX(L)-D,W=p.mapX(L)+D,re=u.mapX(R),ne=u.mapX(W),X=l(re),b=l(ne),A=p.mapY(X),E=p.mapY(b);Math.abs(A-t[m])<Math.abs(E-t[m])?B=X:B=b}return{x:e.graphMode===2?L:B,y:e.graphMode===2?B:L}}getPointInfo(e){switch(e.type){case"movable-point":case"static-labeled-point":return Vq(e);case"poi":return Vq(e.poi.getMovablePoint());case"movable-point-parent":return{calcId:e.id,isReverseDrag:!0};case"image":return{calcId:e.image.formula.center_reference_id,isReverseDrag:!1};case"draggable-label":return{calcId:e.label.model.id,isReverseDrag:!1};default:return e}}getDraggablePointOrAncestors(e){var s,l;if(!this.controller.isGeometry()){let c=this.controller.getItemModel(e);return c&&c.type==="expression"&&qS(c)&&((l=(s=c.formula)==null?void 0:s.typed_constant_value)==null?void 0:l.valueType)===__dcg_shared_module_exports__['da']&&Gi(c)!=="NONE"?[{type:"movable-point-parent",id:e,x:c.formula.typed_constant_value.value[0],y:c.formula.typed_constant_value.value[1],shouldDelayUntilRealMove:!0}]:[]}let t=[e].concat(this.controller.getAllSelectedItems().map(c=>c.id).filter(c=>c!==e)),i=!1,o={},n=[];Tg({controller:this.controller},(c,p)=>{if(!p&&c.typedRuntimeValue.valueType===__dcg_shared_module_exports__['da']&&c.data.isMovablePoint){let[u,m]=c.typedRuntimeValue.value;o[c.calcId]={id:c.calcId,value:{x:u,y:m}}}});let a=this.controller.getGeoModel().getComputedBoard().computeReversibilityLineages(t);for(let c in a){let p=o[c];if(!p){i=!0;break}n.push({type:"movable-point-parent",id:c,x:p.value.x,y:p.value.y,shouldDelayUntilRealMove:!0,transformations:a[c]})}return i?[]:n}getFeatureCenterMathPoint(e){switch(e.type){case"poi":return e.poi;case"movable-point-parent":let t={x:e.x,y:e.y};if(e.transformations){let i=__dcg_shared_module_exports__['Yb'](e.transformations.forward,[t.x,t.y]);t={x:i[0],y:i[1]}}return t;case"image":return{x:e.image.formula.dimensions.x[0],y:e.image.formula.dimensions.y[0]};case"draggable-label":return{x:e.label.x,y:e.label.y}}}startReverseDrag(e,t,i){let o=this.getMouseRelativeToGrapher(t),n=this.getDraggablePointOrAncestors(e).map(a=>__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},a),{startScreenPt:o}));return n.length>0?(this.startMovingPoints({poiUnderMouse:i,evt:t,points:n}),!0):!1}startMovingPoints(e){let t=e.evt,i=e.points,o=!1,n=!1,a=i.map(this.getPointInfo),s=this.controller;function l(){n=!0,s.dispatch({type:"start-moving-points",points:a})}let c=!1;for(let x of i)if(x.shouldDelayUntilRealMove){c=!0;break}c||l();let p;e.poiUnderMouse&&e.poiUnderMouse.isMovable()&&(p=e.poiUnderMouse.getMovablePoint().id),this.manager.movablePointsLayer.setPressedPointId(p);let u=i.map(x=>{let C=this.manager.getProjection().map_pt(this.getFeatureCenterMathPoint(x));return{x:x.startScreenPt.x-C.x,y:x.startScreenPt.y-C.y}}),m,h=()=>{if(!m)return;o=!0,n||l();let x=this.manager.getProjection(),C=this.getMouseRelativeToGrapher(m);m=void 0,this.controller.dispatch({type:"on-move-points",points:i.map(this.getPointInfo),screenPts:u.map(function(D){return{x:C.x-D.x,y:C.y-D.y}}),transform:i.map(D=>D.type==="movable-point-parent"?D.transformations:void 0),previousScreenPts:i.map(D=>D.startScreenPt),projection:x})};this.manager.registerMovablePointListener(h),this.addGlobalMouseListener("dcg-tapmove",x=>{m=x}),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",x=>{if(h(),this.manager.deregisterMovablePointListener(),this.removeAllGlobalMouseListeners(),this.manager.movablePointsLayer.setPressedPointId(void 0),n&&(x.handle("dragged-clickable-object"),this.controller.dispatch({type:"stop-moving-points",points:i.map(this.getPointInfo)})),!o){let C=this.getMouseRelativeToGrapher(t),D=this.getToleranceByDevice(t.device),k=this.getFeatureUnderPoint(C,D);if(k&&k.type==="movable-point")if(this.controller.isGeometry())(!k.sketch.selected||this.isBoxSelectActive(x))&&k.model&&this.selectItemIfNotSecret(k.model.id,this.isBoxSelectActive(x));else return;else if(k&&k.type==="sketch-branch"){let M=k.model;M&&M.formula.geometry&&!k.isClickable&&(!k.sketch.selected||this.isBoxSelectActive(x))&&this.selectItemIfNotSecret(k.model.id,this.isBoxSelectActive(x))}}})}startTracingBranch(e,t){this.manager.markLabelsDirty(),this.lastScreenPt=t;let i=this.manager.getProjection(),n=e.sketch.branches[e.branch],a=r.getBranchesTracePoint(n,t,i,this.controller.isGeometry());a&&this.speakPoint(a),this.manager.traceLayer.setTraceInfo({pt:a,branchInfo:e}),this.controller.requestRedrawGraph(),this.addGlobalMouseListener("dcg-tapmove",this.handleTraceUpdate.bind(this)),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",this.stopTracingBranch.bind(this))}stopTracingBranch(e){this.manager.markLabelsDirty();let t=this.manager.poiLabelsLayer.getHoveredPOI();t&&!this.manager.poiLabelsLayer.isOpenPOI(t)&&(this.manager.poiLabelsLayer.openPOI(t),this.speakPoint(t),this.controller.requestRedrawGraph()),this.lastScreenPt=void 0,this.manager.traceLayer.setTraceInfo(void 0),this.controller.requestRedrawGraph(),this.removeAllGlobalMouseListeners()}handleTraceUpdate(e){if(!this.manager.traceLayer.traceInfo)return;let t=this.manager.getProjection(),i;if(e)i=this.getMouseRelativeToGrapher(e),this.lastScreenPt=i,this.manager.markLabelsDirty();else if(this.lastScreenPt)i=this.lastScreenPt;else return;let o=1/0,n=-1,a=this.manager.traceLayer.traceInfo,s=this.manager.graphSketches[a.branchInfo.sketch.id];if(!s)return;a.branchInfo.sketch=s;let l=a.branchInfo.sketch.branches;for(let u=0;u<l.length;u++){let m=this.calculateDistanceFromBranch(l[u],i,t,!1);m<o&&(n=u,o=m)}let c=l[n],p=c?r.getBranchesTracePoint(c,i,t,this.controller.isGeometry()):void 0;p&&this.speakPoint(p),this.manager.traceLayer.traceInfo.branchInfo.branch=n,this.manager.traceLayer.traceInfo.pt=p,this.controller.requestRedrawGraph()}hasNonlinearMoveStrategy(e){if(!e||e.type!=="movable-point-parent")return!1;let t=this.controller.getItemModel(e.id);if(!t||t.type!=="expression"||!t.formula)return!1;let i=t.formula.move_strategy;return!i||!i[0]?!1:i[0].type==="updateSliderNonlinear"}movePointsFromKeyboard(e,t){if(!t)return;let i=this.manager.getProjection(),o=e.map(h=>{let{x,y:C}=i.map_pt(this.getFeatureCenterMathPoint(h));return{x,y:C}}),n=0,a=0,s=Ee(t),l=(i.pixelCoordinates.right-i.pixelCoordinates.left)/40,c=(i.pixelCoordinates.bottom-i.pixelCoordinates.top)/40,p=s==="Up"||s==="Down"?c:l;p=t.shiftKey?p*5:p;let u,m;if(s==="Up"?(m="y",a-=p,u=t.shiftKey?"bigup":"up"):s==="Down"?(m="y",a+=p,u=t.shiftKey?"bigdown":"down"):s==="Left"?(m="x",n-=p,u=t.shiftKey?"bigdown":"down"):s==="Right"&&(m="x",n+=p,u=t.shiftKey?"bigup":"up"),u){let h=o.map(({x:C,y:D})=>({x:C+n,y:D+a})),x;m==="x"||e.some(C=>this.hasNonlinearMoveStrategy(C))?x={x:u}:m==="y"&&(x={y:u}),this.controller.dispatch({type:"on-move-points",points:e.map(C=>this.getPointInfo(C)),screenPts:h,previousScreenPts:o,transform:e.map(C=>C.type==="movable-point-parent"?C.transformations:void 0),projection:i,keyboardDirection:x})}}getGeoKeyboardPt(){return this.initGeoKeyboardPt(),this.geoKeyboardPt}setGeoKeyboardPt(e){this.geoKeyboardPt=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.geoKeyboardPt),{x:e.x,y:e.y}),e.fromArrowKeys&&(this.geoKeyboardPt.lastArrowedX=e.x,this.geoKeyboardPt.lastArrowedY=e.y),this.controller.requestRedrawGraph()}initGeoKeyboardPt(){if(!isNaN(this.geoKeyboardPt.x)&&!isNaN(this.geoKeyboardPt.y))return;let e=this.manager.getProjection();if(!e)return;let t=e.viewport,i=rh(e),o=i.minorStepX,n=i.minorStepY,a=Math.round((t.xmin+t.xmax)/2/o)*o,s=Math.round((t.ymin+t.ymax)/2/n)*n;this.setGeoKeyboardPt({x:a,y:s})}moveGeoPointFromKeyboard(e){if(!e)return;this.initGeoKeyboardPt();let t=this.manager.getProjection();if(!t)return;let i=t.viewport,o=rh(t),n=o.minorStepX/4,a=o.minorStepY/4,s=this.geoKeyboardPt.x,l=this.geoKeyboardPt.y,c=Ee(e);if(c==="Down"?e.ctrlKey?l=i.ymin:l=Math.max(Math.round((l-a)/a)*a,i.ymin):c==="Up"?e.ctrlKey?l=i.ymax:l=Math.min(Math.round((l+a)/a)*a,i.ymax):c==="Left"?e.ctrlKey?s=i.xmin:s=Math.max(Math.round((s-n)/n)*n,i.xmin):c==="Right"&&(e.ctrlKey?s=i.xmax:s=Math.min(Math.round((s+n)/n)*n,i.xmax)),s!==this.geoKeyboardPt.x||l!==this.geoKeyboardPt.y){this.setGeoKeyboardPt({x:s,y:l,fromArrowKeys:!0}),this.handleGeoKeyboardPtMove(e),At(oE(this.controller,this.geoKeyboardPt.x,this.geoKeyboardPt.y));let p=this.manager.clickableObjectsLayer.getHoveredObjects();for(let u in p){let m=this.controller.getItemModel(u);m!==void 0&&At(this.controller.s("graphing-calculator-narration-geometry-near-item",{item:nw(m,this.controller,{includeDetails:!1})}))}be()}}handleGeoKeyboardPtMove(e){this.initGeoKeyboardPt();let t=this.controller.getGeoModel(),i=!!(e&&e.shiftKey);t.onMouseAction("move",{pt:this.geoKeyboardPt,shift:i,tolerance:this.getToleranceByDevice("keyboard")}),t.onPreviewChange()}tapGeoObjectFromKeyboard(e,t){var a;let i=this.controller.getGeoModel(),o=i.getCurrentTool();if(!o)return;o.onFocus(e);let n=o.tryCommitResults();n.committed&&this.controller.dispatch(__dcg_shared_module_exports__['a']({type:"commit-geo-objects",shiftKey:t.shiftKey},n)),i.updateNextObjectId(i.controller.findLastTokenNumber()+1),i.clearHoveredObjects(),i.onPreviewChange(),this.speakGeoReleaseAction(this.controller.getActiveTool(),(a=o.getSpec)==null?void 0:a.call(o),n.committed),this.keyboardAttentionManager.clearAttentionIfNotTabbable()}tapGeoPointFromKeyboard(e){var l;this.initGeoKeyboardPt();let t=this.controller.getGeoModel(),i=this.controller.getActiveTool(),o=t.getCurrentTool(),n=(l=o.getSpec)==null?void 0:l.call(o),a=!!e.shiftKey,s=t.onMouseAction("release",{pt:this.geoKeyboardPt,shift:a,tolerance:this.getToleranceByDevice("keyboard")});s.committed&&this.controller.dispatch(__dcg_shared_module_exports__['a']({type:"commit-geo-objects",shiftKey:e.shiftKey},s)),t.onMouseAction("move",{pt:this.geoKeyboardPt,shift:a,tolerance:this.getToleranceByDevice("keyboard")}),t.onPreviewChange(),this.speakGeoReleaseAction(i,n,s.committed),this.keyboardAttentionManager.clearAttentionIfNotTabbable()}speakGeoReleaseAction(e,t,i){var o;if(i!==void 0){let n=Object.keys(i);if(!n.length||!t)return;let a="";if(e==="point"||e==="expression-edit"){for(let s in i){let l=i[s];if(l){if(l.type==="point-reference"){a=this.controller.s("graphing-calculator-text-geometry-tool-point-display-name");break}else if(l.type==="intersection"){a=this.controller.s("graphing-calculator-text-geometry-intersection");break}else if(l.type==="glider"){a=this.controller.s("graphing-calculator-text-geometry-glider");break}else if(l.type==="vector-endpoint"){l.location==="start"?a=this.controller.s("graphing-calculator-text-geometry-tool-vector-start-point-display-name"):a=this.controller.s("graphing-calculator-text-geometry-tool-vector-end-point-display-name");break}}}a===""&&(a=this.controller.s("graphing-calculator-text-geometry-tool-point-display-name"))}else{let s=(o=t.outputs[0])==null?void 0:o.type;switch(s){case"arc":a=this.controller.s("graphing-calculator-text-geometry-tool-arc-display-name");break;case"circle":a=this.controller.s("graphing-calculator-text-geometry-tool-circle-display-name");break;case"line":a=this.controller.s("graphing-calculator-text-geometry-tool-line-display-name");break;case"segment":a=this.controller.s("graphing-calculator-text-geometry-tool-segment-display-name");break;case"ray":a=this.controller.s("graphing-calculator-text-geometry-tool-ray-display-name");break;case"vector-copy":a=this.controller.s("graphing-calculator-text-geometry-tool-vector-copy-display-name");break;case"vector":a=this.controller.s("graphing-calculator-text-geometry-tool-vector-display-name");break;case"parallel":a=this.controller.s("graphing-calculator-text-geometry-tool-parallel-display-name");break;case"perpendicular":a=this.controller.s("graphing-calculator-text-geometry-tool-perpendicular-display-name");break;case"midpoint":a=this.controller.s("graphing-calculator-text-geometry-tool-midpoint-display-name");break;case"polygon":a=this.controller.s("graphing-calculator-text-geometry-tool-polygon-display-name");break;case"angle":a=this.controller.s("graphing-calculator-text-geometry-tool-angle-display-name");break;case"directedangle":a=this.controller.s("graphing-calculator-text-geometry-tool-directed-angle-display-name");break;case"reflect":a=this.controller.s("graphing-calculator-text-geometry-tool-reflect-display-name");break;case"translate":a=this.controller.s("graphing-calculator-text-geometry-tool-translate-display-name");break;case"dilate":a=this.controller.s("graphing-calculator-text-geometry-tool-dilate-display-name");break;case"rotate":a=this.controller.s("graphing-calculator-text-geometry-tool-rotate-display-name");break;case"vector-endpoint":case"expression-edit-preview-latex":case"point":case"intersection":case"glider":case"slider":case"angles":case"directedangles":case"compass":case"polygon-segment":case"point-reference":case void 0:a=this.controller.s("shared-calculator-narration-item-unknown");break;default:let l=s;throw new Error("Exhaustive Check failed"+l)}}n.length===1?be(this.controller.s("graphing-calculator-narration-geometry-added-object-type",{type:a})):a!=="graphing-calculator-text-geometry-point"?n.length===2?be(this.controller.s("graphing-calculator-narration-geometry-added-object-type-and-point",{type:a})):be(this.controller.s("graphing-calculator-narration-geometry-added-object-type-and-points",{type:a,points:n.length-1})):be(this.controller.s("graphing-calculator-narration-geometry-added-points",{points:n.length}))}else this.controller.getGeoModel().speakCurrentGeoToolHint()}describeFocusedItem(e){let t=this.keyboardAttentionManager.getKeyboardAttention(),i=this.controller.getItemModel((t==null?void 0:t.calcId)||"");this.controller.getEvaluator().notifyWhenSynced(()=>{var o,n;if(!this.controller.isGeometry()&&i&&i.type==="image"&&((o=this.manager.imageLayer.getFocusedImage())==null?void 0:o.id)===i.id){this.manager.imageLayer.speakAriaAlert();return}i&&((n=this.manager.movablePointsLayer.getPOIUnderAttention())==null?void 0:n.sketch.id)===i.id&&this.manager.movablePointsLayer.speakAriaAlert()||be(nw(i,this.controller,{includeDetails:e.includeDetails,description:t==null?void 0:t.description,poi:this.manager.movablePointsLayer.getPOIUnderAttention(),listIndex:t==null?void 0:t.listIndex,polygonEdge:t==null?void 0:t.polygonEdge,includeSelectionState:this.controller.isGeometry()&&(this.controller.getActiveTool()==="box-selection"||this.controller.getActiveTool()==="selection")}))})}getPointFromFocusedItem(){var p;let e=this.keyboardAttentionManager.getKeyboardAttention(),t=this.controller.getItemModel((e==null?void 0:e.calcId)||"");if(!t||t.type!=="expression"||!t.latex)return;let i=t.formula.typed_constant_value;if(!i||!this.manager.getProjection())return;let n=i.valueType,a=i.value;if(__dcg_shared_module_exports__['Ka'](i.valueType)){let u=e==null?void 0:e.listIndex;u&&(n=__dcg_shared_module_exports__['La'](n),a=a[u])}let s=e==null?void 0:e.polygonEdge;if(n===__dcg_shared_module_exports__['la']&&s!==void 0&&s>=0&&a.length>s){let u=a[s],m=a[(s+1)%a.length];n=__dcg_shared_module_exports__['na'],a=[u,m]}let l=NaN,c=NaN;return n===__dcg_shared_module_exports__['da']?(l=a[0],c=a[1]):n===__dcg_shared_module_exports__['ta']||n===__dcg_shared_module_exports__['va']||n===__dcg_shared_module_exports__['na']?(l=(a[0][0]+a[1][0])/2,c=(a[0][1]+a[1][1])/2):n===__dcg_shared_module_exports__['Da']?(l=a[1][0]+a[0][0]/2,c=a[1][1]+a[0][1]/2):(p=a[0])!=null&&p.length&&(l=a[0][0],c=a[0][1]),{x:l,y:c}}moveGeoKeyboardPtToFocusedItem(e){let t=this.getPointFromFocusedItem();if(!t)return;let{x:i,y:o}=t,n=this.keyboardAttentionManager.getKeyboardAttention();this.controller.getGeoModel().setObjectHovered({calcId:(n==null?void 0:n.calcId)||"",listIndex:void 0}),!isNaN(i)&&!isNaN(o)?(this.setGeoKeyboardPt({x:i,y:o}),this.controller.isVirtualMouseAllowed()&&e.describe&&be(this.controller.s("graphing-calculator-narration-geometry-moved-to-coordinates",{x:mi(this.controller,i),y:fi(this.controller,o)}))):this.controller.isVirtualMouseAllowed()&&e.describe&&be(this.controller.s("graphing-calculator-narration-geometry-unable-to-move"))}speakPoint(e,t){if(!(!e||!this.manager.getAudioTrace()||!this.manager.getProjection()))switch(t){case"X":be(mi(this.controller,e.x));break;case"Y":be(fi(this.controller,e.y));break;case"L":"ariaLabel"in e&&e.ariaLabel?be(e.ariaLabel):be(this.controller.s("graphing-calculator-narration-poi-graph-point"));break;case"C":"sketch"in e&&be(gg(this.controller,e.sketch.color))}}selectItemIfNotSecret(e,t){this.controller.isItemNotSelectableBecauseItsSecret(e)||(!this.controller.isMultiSelectEnabled()||!t?this.controller.dispatch({type:"set-selected-id",id:e}):this.controller.dispatch({type:"toggle-selected-with-multi-select",id:e}))}convertTouchEventToMathPoint(e){let{clientX:t,clientY:i}=e.changedTouches[0],o=this.manager.elt.getBoundingClientRect();return this.controller.getGeoModel().convertCanvasPixelsToPoint({x:t-o.left,y:i-o.top})}handleGeoTapStart(e){let t=this.controller.getGeoModel();this.grapherIsPressed=!0,this.canceledGeoToolplayWhilePressed=!1;let i=!!e.shiftKey,o=this.convertTouchEventToMathPoint(e);return this.lastGeoMouseEvent=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},o),{shift:i}),t.onMouseAction("move",{pt:o,shift:i,tolerance:this.getToleranceByDevice(e.device)}).handled?(Iq(e)?this.handleGeoTapMove(e):(t.onPreviewChange(),this.updateGeoHoveredObjects()),t.getToolMode()==="expression-edit"&&e.preventDefault(),!0):!1}handleGeoShiftKeyChange(e){let t=this.lastGeoMouseEvent;if(!t||t.shift===e)return;t.shift=e;let i=this.controller.getGeoModel();i.onMouseAction("move",{pt:{x:t.x,y:t.y},shift:t.shift,tolerance:this.getToleranceByDevice("mouse")}),i.onPreviewChange()}handleGeoTapMove(e){let t=this.controller.getGeoModel(),i;if(!(e.target&&e.target.closest(".dcg-geometry-toolbar-view"))&&(this.isEventWithinInstance(e)||this.grapherIsPressed)){let n=this.convertTouchEventToMathPoint(e),a=!!e.shiftKey;this.lastGeoMouseEvent=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},n),{shift:a}),i=t.onMouseAction("move",{pt:n,shift:a,tolerance:this.getToleranceByDevice(e.device)}).handled}else this.lastGeoMouseEvent=void 0,t.onMouseAction("move",{pt:{x:NaN,y:NaN},shift:!1,tolerance:0}),i=!0;return t.onPreviewChange(),i}replayGeoTapMove(){let e=this.controller.getGeoModel(),t=this.lastGeoMouseEvent;t&&(e.onMouseAction("move",{pt:{x:t.x,y:t.y},shift:t.shift,tolerance:this.getToleranceByDevice("mouse")}),e.onPreviewChange())}handleGeoTapEnd(e){var s;if(!this.grapherIsPressed)return;let t=this.controller.getGeoModel();this.grapherIsPressed=!1,this.lastGeoMouseEvent=void 0;let i=this.canceledGeoToolplayWhilePressed?{committed:void 0}:t.onMouseAction("release",{pt:this.convertTouchEventToMathPoint(e),shift:!!e.shiftKey,tolerance:this.getToleranceByDevice(e.device)});this.canceledGeoToolplayWhilePressed=!1,i.committed&&this.controller.dispatch(__dcg_shared_module_exports__['a']({type:"commit-geo-objects",shiftKey:e.shiftKey},i)),this.isEventWithinInstance(e)&&Iq(e)?this.handleGeoTapMove(e):t.onPreviewChange();let o=this.controller.getActiveTool(),n=t.getCurrentTool(),a=(s=n.getSpec)==null?void 0:s.call(n);this.speakGeoReleaseAction(o,a,i.committed),t.getToolMode()==="expression-edit"&&e.preventDefault()}isEventWithinInstance(e){return e.target?this.manager.elt.contains(e.target):!1}updateGeoHoveredObjects(){let e=this.controller.getGeoModel(),t={};e.getHoveredItems().forEach(i=>{let o;if("tokenId"in i){let n=this.controller.getGeoTokenInfoFromIdentifier(__dcg_shared_module_exports__['jb'](i.tokenId));o=n&&n.calcId}else o=i.calcId;if(o!==void 0){let n=t[o];n?i.listIndex===void 0?n.listIndexes=void 0:n.listIndexes!==void 0&&(n.listIndexes[i.listIndex]=!0):t[o]={listIndexes:i.listIndex===void 0?void 0:{[i.listIndex]:!0}}}}),this.manager.clickableObjectsLayer.setHoveredObjects(t)}cancelGeoToolplay(){this.canceledGeoToolplayWhilePressed=this.grapherIsPressed,this.updateGeoHoveredObjects()}startBoxSelect(e){let t={};this.controller.getAllSelectedItems().forEach(n=>t[n.id]=!0);let i=this.manager.getProjection().reverse_map_pt(this.getMouseRelativeToGrapher(e)),o;this.addGlobalMouseListener("dcg-tapmove",n=>{o=this.manager.getProjection().reverse_map_pt(this.getMouseRelativeToGrapher(n));let a={left:Math.min(i.x,o.x),top:Math.min(i.y,o.y),right:Math.max(i.x,o.x),bottom:Math.max(i.y,o.y)};this.manager.setBoxSelectRectangle(a);let s=this.findIdsThatIntersectBox(a);this.controller.dispatch({type:"set-all-selected-ids",ids:__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},t),s)})}),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",n=>{this.removeAllGlobalMouseListeners(),this.manager.setBoxSelectRectangle(void 0),o||this.controller.dispatch({type:"set-none-selected"})})}};function Iq(r){return r.device==="mouse"}function Vq(r){return{calcId:r.sketch.id,isReverseDrag:!1,scaleFactor:r.type==="movable-point"?r.scaleFactor:void 0,tableInfo:r.type==="movable-point"?r.tableInfo:void 0}}xt();var ns=class ns{constructor(e=0,t=0,i=1,o=i){this.tx=e,this.ty=t,this.sx=i,this.sy=o}toJSON(){return{tx:this.tx,ty:this.ty,sx:this.sx,sy:this.sy}}compose(e){return new ns(this.sx*e.tx+this.tx,this.sy*e.ty+this.ty,this.sx*e.sx,this.sy*e.sy)}translate(e,t){let i=t===void 0?e.x:t.x-e.x,o=t===void 0?e.y:t.y-e.y;return new ns(this.tx+i,this.ty+o,this.sx,this.sy)}scale(e,t){return ns.scale(e,t).compose(this)}scaleAtPoint(e,t,i=t){return ns.scaleAtPoint(e,t,i).compose(this)}mapX(e){return this.sx*e+this.tx}mapY(e){return this.sy*e+this.ty}mapPoint(e){return{x:this.mapX(e.x),y:this.mapY(e.y)}}mapRect(e){return{left:this.mapX(e.left),right:this.mapX(e.right),bottom:this.mapY(e.bottom),top:this.mapY(e.top)}}};ns.scale=function(e,t=e){return new ns(0,0,e,t)},ns.translate=function(e,t){return new ns().translate(e,t)},ns.scaleAtPoint=function(e,t,i=t){return i===void 0&&(i=t),new ns(e.x*(1-t),e.y*(1-i),t,i)},ns.fromRects=function(e,t){let i=(t.right-t.left)/(e.right-e.left),o=(t.top-t.bottom)/(e.top-e.bottom);return new ns(t.left-i*e.left,t.bottom-o*e.bottom,i,o)},ns.fromJSON=function(e){return new ns(e.tx,e.ty,e.sx,e.sy)};var ch=ns;var Wc=class{constructor(e,t,i){this.screen=e,this.viewport=t,this.settings=i,this.mathCoordinates=__dcg_shared_module_exports__['Cc'](t),this.pixelCoordinates=__dcg_shared_module_exports__['Bc'](e),this.updateScalePairs()}updateScalePairs(){let{xAxisScale:e,yAxisScale:t}=this.settings;this.mathToPixels=__dcg_shared_module_exports__['Dc'].fromRects(this.mathCoordinates,this.pixelCoordinates,{xAxisScale:e,yAxisScale:t}),this.pixelsToMath=this.mathToPixels.inverse()}mapx(e){return this.mathToPixels.mapX(e)}mapy(e){return this.mathToPixels.mapY(e)}reverse_mapx(e){return this.pixelsToMath.mapX(e)}reverse_mapy(e){return this.pixelsToMath.mapY(e)}mapAlongAxis(e,t){switch(t){case"x":return this.mapx(e);case"y":return this.mapy(e);default:{let i=t;throw new Error(`Unknown axis: ${i}`)}}}reverseMapAlongAxis(e,t){switch(t){case"x":return this.reverse_mapx(e);case"y":return this.reverse_mapy(e);default:{let i=t;throw new Error(`Unknown axis: ${i}`)}}}map_pt(e){return this.mathToPixels.mapPoint(e)}map_xy_pairs(e){for(var t=[],i=0;i<e.length;i+=2)t.push(this.mapx(e[i])),t.push(this.mapy(e[i+1]));return t}reverse_map_pt(e){return this.pixelsToMath.mapPoint(e)}coordsAreOnscreen(e,t,i=0){return e>-i&&t>-i&&e<this.screen.width+i&&t<this.screen.height+i}closestPointOnScreen(e){let t=this.pixelCoordinates;return{x:Math.min(Math.max(e.x,t.left),t.right),y:Math.min(Math.max(e.y,t.top),t.bottom)}}};var{log10:ME}=Math;function tA(r,e){var t=e.x-r.x,i=e.y-r.y,o=.5*(r.x+e.x),n=.5*(r.y+e.y),a=.5*__dcg_shared_module_exports__['Ua'](t,i);return{center:$c(o,n),radius:a}}function Mq(r,e){var t={x:2*r.x-e.x,y:2*r.y-e.y};return tA(e,t)}function Aq(r,e){for(var t=[],i=0;i<r.length;i++)t.push($c(r[i].pageX-e.left,r[i].pageY-e.top));return t}function $c(r,e){return{x:r,y:e}}function Lq(r){return $c(.5*(r.left+r.right),.5*(r.bottom+r.top))}var NY=0,AE=class{constructor(e,t){this.s=jl(()=>this.grapher.settings.config.language);this.grapher=e,this.elt=e.elt,this.id=NY++,this.controller=t,this.isScalingEnabled=!1,this.mousePt=$c(0,0),this.lastScrollZoom=Date.now(),this.preventScrollZoom=!1,this.addMouseWheelEventHandler(),this.addTouchEventHandler()}remove(){H(window).off(".viewportcontroller-"+this.id)}getViewport(){return this.grapher.getProjection().viewport}getProjection(){return this.grapher.getProjection()}isViewportLocked(){var e=this.getProjection().settings;return e.config.lockViewport||e.userLockedViewport}updateMouse(e){var t=this.elt.getBoundingClientRect();this.mousePt=$c(e.clientX-t.left,e.clientY-t.top)}updateScaleAxis(){this.isMouseInViewport()&&(this.isMouseNearYAxis()?this.grapher.scaleAxis="y":this.isMouseNearXAxis()?this.grapher.scaleAxis="x":this.grapher.scaleAxis="both"),this.updateCursor(),this.controller.requestRedrawGraph()}updateCursor(){this.elt.classList.toggle("dcg-scale-horizontal",this.grapher.scaleAxis==="x"),this.elt.classList.toggle("dcg-scale-vertical",this.grapher.scaleAxis==="y"),this.elt.classList.toggle("dcg-scale-both",this.grapher.scaleAxis==="both")}isMouseNearOrigin(){var e=this.getProjection(),t=e.mathToPixels.mapPoint($c(0,0));return Math.abs(this.mousePt.x-t.x)<50&&Math.abs(this.mousePt.y-t.y)<50}isMouseNearXAxis(){var e=this.getProjection(),t=e.pixelCoordinates,i=e.mathToPixels.mapY(0);return i=Math.min(Math.max(t.top,i),t.bottom),Math.abs(this.mousePt.y-i)<40&&e.settings.showXAxis}isMouseNearYAxis(){var e=this.getProjection(),t=e.pixelCoordinates,i=e.mathToPixels.mapX(0);return i=Math.min(Math.max(t.left,i),t.right),Math.abs(this.mousePt.x-i)<40&&e.settings.showYAxis}isMouseInViewport(){var e=this.getProjection(),t=e.mathCoordinates,i=e.pixelsToMath.mapPoint(this.mousePt);return i.x>=t.left&&i.x<=t.right&&i.y>=t.bottom&&i.y<=t.top}_setViewportWithoutCancellingAnimation(e){if(e.isValid(this.controller.getAxisScaleSettings())&&!e.equals(this.getViewport())){var i=this.getProjection();this.grapher._setProjection(new Wc(i.screen,e,i.settings))}}setViewport(e){this.cancelAnimation(),this._setViewportWithoutCancellingAnimation(e)}setScreen(e){var t=this.getProjection();let i=t.settings.squareAxes?t.viewport.squareYAxis(e,t.settings):t.viewport;var o=new Wc(e,i,t.settings);this.grapher._setProjection(o)}getTransformedViewport(e){let{pixelCoordinates:t,mathCoordinates:i,settings:o}=this.getProjection(),{xAxisScale:n,yAxisScale:a}=o,s=e.mapRect(t);var l=__dcg_shared_module_exports__['Dc'].fromRectsInverse(i,s,{xAxisScale:n,yAxisScale:a}).mapRect(t);return new lo(l.left,l.right,l.bottom,l.top)}transformViewport(e){this.setViewport(this.getTransformedViewport(e)),(this.grapher.scaleAxis==="x"||this.grapher.scaleAxis==="y")&&this.controller.markSquareAxesAfterUserEditedViewport()}animateToViewport(e){this.cancelAnimation();let t=this.getProjection(),i=t.viewport,o=t.mathToPixels;var n=0,a,s=l=>{a||(a=l);var c=(l-a)/500;if(n+=c,n<1){this.__animationTimeout=requestAnimationFrame(s);let p=o.interpolateX(i.xmin,e.xmin,n),u=o.interpolateX(i.xmax,e.xmax,n),m=o.interpolateY(i.ymin,e.ymin,n),h=o.interpolateY(i.ymax,e.ymax,n);this._setViewportWithoutCancellingAnimation(new lo(p,u,m,h)),this.grapher.debounceUserRequestedViewportChange()}else this.setViewport(lo.fromObject(e)),this.grapher.debounceUserRequestedViewportChange(),this.controller.markSquareAxesAfterUserEditedViewport()};this.__animationTimeout=requestAnimationFrame(s)}cancelAnimation(){cancelAnimationFrame(this.__animationTimeout)}addMouseWheelEventHandler(){var e=!1,t,i;H(window).on("scroll.viewportcontroller-"+this.id,function(a){e=!0}),H(window).on("wheel.viewportcontroller-"+this.id,function(a){t=a.clientX,i=a.clientY}),H(window).on("mousemove.viewportcontroller-"+this.id,function(a){if(e){var s=a.clientX-t,l=a.clientY-i,c=s*s+l*l;c<100||(e=!1)}});var o=0,n=a=>{let s=a.originalEvent;if(s.deltaX===0&&s.deltaY===0)return;var l=Date.now();let c=l-this.lastScrollZoom;if(this.preventScrollZoom&&c>50&&(this.preventScrollZoom=!1),this.lastScrollZoom=l,this.preventScrollZoom)return;var p=this.getProjection();if(this.isViewportLocked())return;var u=p.mathToPixels;if(e)return;s.preventDefault(),this.updateMouse(s);var m=u.mapPoint($c(0,0));let x=(s.deltaY===0?-s.deltaX:-s.deltaY)>0?1:-1;var C=this.isMouseNearOrigin()&&x>0?m:this.mousePt;if(o>0)return;o+=1,requestAnimationFrame(function(){o--});let{xAxisScale:D,yAxisScale:k}=p.settings,M=.0625;(D==="logarithmic"||k==="logarithmic")&&c<25&&(M*=Math.max(10,c)/25);var I=x>0?1+M:1/(1+M),S=this.grapher.scaleAxis,V=S==="x"||S==="both"||!S?I:1,P=S==="y"||S==="both"||!S?I:1;let L=ch.scaleAtPoint(C,V,P),B=this.getTransformedViewport(L);x==-1&&this.tooBig(B)||x==1&&this.tooSmall(B)||(this.transformViewport(L),this.grapher.debounceUserRequestedViewportChange())};H(this.elt).on("wheel",n)}applyPanTouchChanges(e,t){if(!this.isViewportLocked()&&!this.isScalingEnabled){var i=$c(t[0].x-e[0].x,t[0].y-e[0].y);this.transformViewport(ch.translate(i)),this.grapher.debounceUserRequestedViewportChange()}}chooseDragScaleCenter(){var e=this.getProjection(),t=e.pixelCoordinates,i=e.mathToPixels.mapX(0),o=e.mathToPixels.mapY(0);return i=Math.min(Math.max(t.left,i),t.right),o=Math.min(Math.max(t.top,o),t.bottom),$c(i,o)}applyScaleTouchChanges(e,t){if(this.isViewportLocked())return;var i=this.grapher.scaleAxis,o,n;if(e.length===2&&t.length===2)o=tA(e[0],e[1]),n=tA(t[0],t[1]);else if(t.length===1){var a=this.chooseDragScaleCenter();o=Mq(a,e[0]),n=Mq(a,t[0])}else return;var s=n.radius/o.radius,l=i==="y"?1:s,c=i==="x"?1:s,p=ch.scaleAtPoint(o.center,l,c).translate(o.center,n.center);let u=this.getTransformedViewport(p);s<1&&this.tooBig(u)||s>1&&this.tooSmall(u)||(this.transformViewport(p),this.grapher.debounceUserRequestedViewportChange())}addTouchEventHandler(){var e=[],t=!1,i=!0,o=!0,n=h=>{t||this.isViewportLocked()||(this.updateMouse(h.originalEvent),this.isScalingEnabled&&this.updateScaleAxis())};H(window).on("mousemove.viewportcontroller-"+this.id,n),this.beginPanning=h=>{var x=this.getProjection();if(!this.isViewportLocked()&&!t&&h.touches.length===h.changedTouches.length){t=!0,this.grapher.isDragging=!0,this.updateMouse(h);var C=x.mathToPixels.mapPoint($c(0,0)),D=this.grapher.scaleAxis;(D==="x"||D==="both")&&(i=this.mousePt.x>C.x),(D==="y"||D==="both")&&(o=this.mousePt.y>C.y),this.controller.dispatch({type:"grapher/drag-start"}),H(document).on("dcg-tapmove.graphdrag",u),H(document).on("dcg-tapstart.graphdrag dcg-tapend.graphdrag dcg-tapcancel.graphdrag",m)}};var a=h=>{if(!(h.length<2)){var x=this.grapher.getProjection(),C=x.pixelCoordinates,D=x.mathToPixels.mapX(0),k=x.mathToPixels.mapY(0),M=40;D=Math.min(Math.max(C.left,D),C.right),k=Math.min(Math.max(C.top,k),C.bottom);var I=h[1].x-h[0].x,S=h[1].y-h[0].y;return Math.abs(h[0].x-D)<M&&Math.abs(h[1].x-D)<M&&Math.abs(S)>3*Math.abs(I)&&x.settings.showYAxis?"y":Math.abs(h[0].y-k)<M&&Math.abs(h[1].y-k)<M&&Math.abs(I)>3*Math.abs(S)&&x.settings.showXAxis?"x":"both"}},s=h=>(this.grapher.scaleAxis||(this.grapher.scaleAxis=a(h)),this.grapher.scaleAxis),l=()=>{this.grapher.scaleAxis&&(this.grapher.scaleAxis=void 0,this.controller.requestRedrawGraph(),this.updateCursor())},c=()=>{this.isScalingEnabled=!1,this.preventScrollZoom=!0,l()},p=h=>h.altKey||h.ctrlKey||h.metaKey,u=h=>{let x=h;if(t&&!this.isViewportLocked()){var C=Aq(x.touches,ao(this.elt));if(e.length===2&&C.length===2)s(C),this.applyScaleTouchChanges(e,C);else if(e.length===1&&this.isScalingEnabled){this.updateMouse(x);var D=this.grapher.scaleAxis,k=this.getProjection(),M=k.mathToPixels.mapPoint($c(0,0)),I,S,V=5,P=i?1:-1,L=o?1:-1;if((D==="x"||D==="both")&&(I=this.mousePt.x>M.x+V*P),(D==="y"||D==="both")&&(S=this.mousePt.y>M.y+V*L),D==="x"&&i!==I||D==="y"&&o!==S||D==="both"&&i!==I&&o!==S)return;this.applyScaleTouchChanges(e,C)}else l();e.length===1&&this.applyPanTouchChanges(e,C),this.controller.dispatch({type:"grapher/drag-move"}),e=C}},m=h=>{let x=h;t&&(this.cancelAnimation(),e=Aq(x.touches,ao(this.elt)),x.touches.length===0&&(t=!1,this.grapher.isDragging=!1,H(document).off(".graphdrag"),this.grapher.debounceUserRequestedViewportChange(),this.controller.dispatch({type:"grapher/drag-end"})),(x.touches.length===0||x.touches.length===1&&!this.isScalingEnabled)&&l())};H(window).on("keydown.viewportcontroller-"+this.id,h=>{this.controller.isGeoToolActive()||this.isViewportLocked()||(Ee(h)===Jy&&!p(h)&&this.shouldAllowShiftScaling()?(this.isScalingEnabled=!0,this.grapher.scaleAxis||this.updateScaleAxis()):c())}),H(window).on("keyup.viewportcontroller-"+this.id+" blur.viewportcontroller-"+this.id,c)}shouldAllowShiftScaling(){return!this.controller.isGeometry()}zoom(e){var t=this.getProjection().pixelCoordinates;if(e==="in"){let o=this.getTransformedViewport(ch.scaleAtPoint(Lq(t),2));this.tooSmall(o)||this.animateToViewport(o),be(this.s("graphing-calculator-narration-viewport-zoom-in"))}else if(e==="out"){let o=this.getTransformedViewport(ch.scaleAtPoint(Lq(t),.5));this.tooBig(o)||this.animateToViewport(o),be(this.s("graphing-calculator-narration-viewport-zoom-out"))}else if(e==="square"){var i=this.getSquareViewport();this.getProjection().settings.setProperty("squareAxes",!0),this.animateToViewport(i),be(this.s("graphing-calculator-narration-viewport-zoom-square"))}else e==="default"&&this.setDefaultViewport()}tooBig(e){let t=this.getProjection(),{xAxisScale:i,yAxisScale:o}=t.settings,{xmin:n,xmax:a,ymin:s,ymax:l}=e;return i==="logarithmic"&&ME(a)-ME(n)>60||o==="logarithmic"&&ME(l)-ME(s)>60||this.controller.isGeometry()&&a-n>1e5}tooSmall(e){let{xmin:t,xmax:i}=e;return this.controller.isGeometry()&&i-t<1e-4}zoomSquareImmediately(){this.setViewport(this.getSquareViewport())}zoomCustom(e){this.animateToViewport(e),be(this.s("graphing-calculator-narration-viewport-updated"))}setDefaultViewport(){let e=this.controller.getDefaultViewport();this.animateToViewport(e),be(this.s("graphing-calculator-narration-viewport-default"))}isDefaultViewportRestored(){let e=this.getProjection(),{xAxisScale:t,yAxisScale:i}=e.settings,o=t==="linear",n=i==="linear",a=e.viewport,s=this.controller.getDefaultViewport(),l=o?a.xmax-a.xmin:Math.log(a.xmax/a.xmin),c=n?a.ymax-a.ymin:Math.log(a.ymax/a.ymin),p=o?a.xmin-s.xmin:Math.log(a.xmin/s.xmin),u=o?a.xmax-s.xmax:Math.log(a.xmax/s.xmax),m=n?a.ymin-s.ymin:Math.log(a.ymin/s.ymin),h=n?a.ymax-s.ymax:Math.log(a.ymax/s.ymax),x=.025;return Math.abs(p/l)<x&&Math.abs(u/l)<x&&Math.abs(m/c)<x&&Math.abs(h/c)<x}getSquareViewport(){let e=this.getProjection();return e.settings.lastChangedAxis==="y"?e.viewport.squareXAxis(e.screen,e.settings):e.viewport.squareYAxis(e.screen,e.settings)}};var Ew=__dcg_shared_module_exports__['h'](z());xt();var jd=class{constructor(e,t){this.width=e,this.height=t}};var db=class{constructor(e,t){this.is3d=!1;this.color="#000000",this.style="normal",this.showPOI=!1,this.showHighlight=!1,this.selected=!1,this.tokenHovered=!1,this.tokenSelected=!1,this.labels=[],this.id=e,this.branches=t!==void 0?t:[],this.getPOI().forEach(i=>{i.type===1008&&this.labels.push({type:"poi",poi:i})}),t.forEach((i,o)=>{if(i.graphMode===22){if(i.objectType===17){let n=new jp(0,0,1008,this,o,0,!1);this.labels.push({id:"label-"+e+"-"+(i.listIndex||0),type:"segment",poi:n,segments:i.segments[0],text:i.labels&&i.labels[0]||""})}else if(i.objectType===16){let n=new jp(0,0,1008,this,o,0,!1);this.labels.push({id:"label-"+e+"-"+(i.listIndex||0),type:"polygon",poi:n,segments:i.segments[0],text:i.labels&&i.labels[0]||""})}else if(i.objectType===23){let n=new jp(0,0,1008,this,o,0,!1);this.labels.push({id:"label-"+e+"-"+(i.listIndex||0),type:"angle",poi:n,segments:i.segments[0],text:i.labels&&i.labels[0]||""})}}})}getPOI(){if(this.__cachedPOI)return this.__cachedPOI;this.__cachedPOI=[],this.__cachedPOIIds={};for(let e=0;e<this.branches.length;e++){let t=this.branches[e];if(t.graphMode===1||t.graphMode===2){let i=t.poi;i.zeros&&this._pushPOI(i.zeros,e,1002),i.intercept&&this._pushPOI(i.intercept,e,1003),i.extrema&&this._pushPOI(i.extrema,e,1004),i.intersections&&this._pushPOI(i.intersections,e,1001)}else if(t.graphMode===3||t.graphMode===4){let i=t.poi,o=t.graphMode===3&&t.interactiveLabel===!0;if(t.showLabel===!0||o){let n=t.nakedLabel;i.defined&&this._pushPOI(i.defined,e,1008,n)}else i.defined&&this._pushPOI(i.defined,e,1006)}}return this.__cachedPOI}getBranchPOI(e){return this.getPOI().filter(t=>t.branch===e)}getMovablePoints(){if(this.__cachedMovablePoints)return this.__cachedMovablePoints;this.__cachedMovablePoints=[];let e=this.branches[0];if(e&&e.segments.length===1&&e.graphMode===4){let t=e.segments[0];for(let i=0;i<t.length;i++){let o;e.tableId&&(o={tableId:e.tableId,columnId:this.id,rowIndex:e.movablePointInfo[i].index,dragX:e.movablePointInfo[i].dragX,dragY:e.movablePointInfo[i].dragY});let n=e.scaleFactors?e.scaleFactors[0][i]:void 0,a=o?o.rowIndex:i,s=e.segments.length===1&&e.labels&&e.labels[i]?e.labels[i]:void 0,l=e.hasOwnProperty("pointOpacity")?e.pointOpacity:1;this.__cachedMovablePoints.push({type:"movable-point",id:"movable:["+this.id+","+a+"]",listIndex:a,sketch:this,color:this.color,pointOpacity:l,tableInfo:o,scaleFactor:n,x:t[i][0],y:t[i][1],label:s,ariaLabel:s&&ka(s)})}}return this.__cachedMovablePoints}getMovablePointByIndex(e){return this.getMovablePoints()[e]}getStaticLabeledPoints(){if(this.__cachedStaticLabeledPoints)return this.__cachedStaticLabeledPoints;let e=this.branches[0];return this.__cachedStaticLabeledPoints=[],this.getPOI().forEach(t=>{if(t.type!==1006&&t.type!==1008||e.graphMode!==3)return;var i=e.showLabel;let o=t.getLabel();!i&&o===""||this.__cachedStaticLabeledPoints.push({type:"static-labeled-point",id:"static["+this.id+","+t.id+"]",listIndex:t.pointIdxOnBranch,x:t.x,y:t.y,sketch:t.sketch,label:o,ariaLabel:o!==""?ka(o):void 0})}),this.__cachedStaticLabeledPoints}_pushPOI(e,t,i,o=!1){for(let n=0,a=e.x.length;n<a;n++){let s=new jp(e.x[n],e.y[n],i,this,t,n,o);e.intersects&&(s.intersects=e.intersects[n]),this.__cachedPOI.push(s),this.__cachedPOIIds[s.id]=s}}updateIntersections(e){for(let i=0,o=this.branches.length;i<o;i++){let n=this.branches[i];n.graphMode!==15&&n.graphMode!==22&&(n.poi.intersections=e[i])}let t=this.__cachedPOI;this.__cachedPOI=[],t.forEach(i=>{i.type!==1001?this.__cachedPOI.push(i):delete this.__cachedPOIIds[i.id]});for(let i=0;i<this.branches.length;i++){let o=this.branches[i];if(o.graphMode===1||o.graphMode===2){let n=o.poi;n.intersections&&this._pushPOI(n.intersections,i,1001)}}}getPOIById(e){return this.__cachedPOIIds[e]}updateFrom(e){if(!e)return;this.showPOI=e.showPOI,this.showHighlight=e.showHighlight,this.selected=e.selected,this.tokenSelected=e.tokenSelected,this.tokenHovered=e.tokenHovered;let t=this.branches[0].graphMode;if(t===3||t===4){let i=!0;for(let o=0;o<this.__cachedPOI.length;o++){let n=e.__cachedPOI[o],a=this.__cachedPOI[o];if(!n||n.type!==a.type){i=!1;break}}if(i)for(let o=0;o<this.__cachedPOI.length;o++){let n=e.__cachedPOI[o],a=this.__cachedPOI[o];delete this.__cachedPOIIds[a.id],this.__cachedPOIIds[n.id]=a,a.id=n.id}}}};var _E=class{constructor(e,t){this.is3d=!0;this.color="#000000",this.showHighlight=!1,this.selected=!1,this.id=e,this.branches=t!==void 0?t:[]}updateFrom(e){e&&(this.showHighlight=e.showHighlight,this.selected=e.selected)}};function Oq(r){return r.is3d}function Il(r,e){if(Oq(e)||r.isGeoUIActive()&&r.getAllToolPreviewItems().filter(i=>i.id===e.id).length>0)return!1;for(let t of e.branches)if(jc(t))return!0;return!1}function jc(r){switch(r.graphMode){case 8:case 5:case 6:return Pr("audioTraceSimult")&&r.segments.length>0;case 1:case 2:case 3:case 4:return r.segments.length>0;default:return!1}}function Pq(r){for(let e=0;e<r.branches.length;e++)if(jc(r.branches[e]))return e;return 0}function gw(r,e){let t=0;for(let i=0;i<=e;i++)jc(r.branches[i])&&(t+=1);return t}function _q(r){switch(r.graphMode){case 1:case 2:case 3:case 4:return!0;default:return!1}}function Fq(r,e){switch(e){case 2:case 8:case 5:case 6:case 3:case 4:return{independentMin:r.xmin,independentMax:r.xmax,dependentMin:r.ymin,dependentMax:r.ymax};case 1:return{independentMin:r.ymin,independentMax:r.ymax,dependentMin:r.xmin,dependentMax:r.xmax};default:throw rA(e)}}function rA(r){return`Unexpected graph mode. Received ${r}`}function iA(r){let e=Math.random()*2-1;return(r+.2*e)/1.02}function Rq(r,e){if(r===1)return e.y;if(r===2||r===8||r===5||r===6)return e.x;throw rA(r)}function Nq(r,e){let t=([i,o])=>{let n=e!=null&&e.degreeMode?i*Math.PI/180:i;return[o*Math.cos(n),o*Math.sin(n)]};return __dcg_shared_module_exports__['E'](__dcg_shared_module_exports__['J'](r,2).map(i=>t(i)),!0)}function oA(r,e,t){let i=__dcg_shared_module_exports__['Jc'](r,e.mathToPixels,t),o=__dcg_shared_module_exports__['Lc'](i,{xmin:0,xmax:e.screen.width,ymin:0,ymax:e.screen.height}),n=e.pixelsToMath;return t===__dcg_shared_module_exports__['Ic']&&(n=new __dcg_shared_module_exports__['Dc'](n.yScale,n.xScale)),o.map(s=>__dcg_shared_module_exports__['Jc'](s,n,t))}function Bq(r,e){return r[0]-e[0]}function qq(r){switch(r.graphMode){case 2:case 3:case 4:return{independent:r.x,dependent:r.y};case 1:return{independent:r.y,dependent:r.x};default:throw rA(r.graphMode)}}var qY=.1;function nA(r){return r<0?qY:0}function KY(r,e,t){return{x:r.x,y:r.y,branch:r.branch,reportedBranch:t,type:r.type,graphMode:e,intersects:r.intersects}}var pb=101,FE=class{constructor(e,t,i){this.grapher=i,this.controller=e,this.audiograph=t,this.reset()}reset(){this.currentPoint=void 0,this.resetToFirstBranch(),this.sampledPoints=[],this.pois=[],this.independent=0}resetToFirstBranch(){let e=this.getCurrentSketch();this.branch=e?Pq(e):0}getBranchPoints(e){let t=[];if(e>=0)for(let i of this.getSampledPoints())i.branch===e&&t.push(i);return t}resetTracePoint(){this.grapher.traceLayer.setTraceInfo(void 0),this.grapher.traceLayer.setTraceLine(void 0),this.drawTracePoint(this.getCurrentPoint())}drawTracePoint(e){let t=this.getCurrentSketch();if(!e||!t)return;let i=t.branches[this.branch];if(!i||i.graphMode===3)return;let n={x:e.x,y:e.y},a={branchInfo:{branch:e.branch,id:t.id,sketch:t},pt:n};__dcg_shared_module_exports__['P'](a,this.grapher.traceLayer.getTraceInfo())||(this.grapher.traceLayer.setTraceInfo(a),this.controller.requestRedrawGraph())}drawTraceLine(e,t){if(e===void 0||!t)return;let i=this.getCurrentSketch();t===1?this.grapher.traceLayer.setTraceLine({x:void 0,y:e,color:i==null?void 0:i.color}):this.grapher.traceLayer.setTraceLine({x:e,y:void 0,color:i==null?void 0:i.color})}moveToOrigin(){let e=this.getCurrentSketch();if(!e||!Il(this.controller,e))return;let t=e.branches[this.branch];if(!jc(t))return;let i=t.graphMode;if(i===2)this.setIndependent("x",0);else if(i===1)this.setIndependent("y",0);else if(i===3){let o=this.getSortedPOI()[0];this.setIndependent("x",o?o.x:0)}}getCurrentSketch(){let e,t=this.getSelectedItem();if(t){let i=this.audiograph.getFocusedCell();if(t.type==="table"){if(i&&(e=this.getGraphSketchForTableCell(t,i)),!e){for(let o of t.columnModels)if(e=this.grapher.getGraphSketch(o.id),e!==void 0)break}}else e=this.grapher.getGraphSketch(t.id)}return e}getFirstTraceableSketch(e){let t,i=this.controller.getItemCount(),o=this.controller.shouldAudioTraceReverseExpressions();for(let n=0;n<i;n++){let a=o?i-1-n:n,s=this.controller.getItemModelByIndex(a);if(s&&this.canTrace(s)){let l=o?this.prevTableColumn(s):this.nextTableColumn(s);if(l?(this.audiograph.setFocusedCell(l),t=this.getGraphSketchForTableCell(s,l)):t=this.grapher.getGraphSketch(s.id),t){e&&e.selectAssociatedExpression&&this.controller.dispatch({type:"set-selected-index",index:a});break}}}return t}canTrace(e){if(e.type==="image")return!1;if("shouldGraph"in e){let t=this.grapher.getGraphSketch(e.id);return t?Il(this.controller,t):!1}return!1}getTraceableExpressionCount(){let e=0,t=this.controller.getItemCount();for(let i=0;i<t;i++){let o=this.controller.getItemModelByIndex(i);o&&this.canTrace(o)&&e++}return e}computeStepSizes(){let e=this.grapher.getProjection().viewport;if(!e)return;let t=e.xmin,i=e.xmax,o=e.ymin,n=e.ymax,a=this.getCurrentSketch();if(!a||!Il(this.controller,a))return;let s=a.branches[this.branch];if(!jc(s))return;let l=s.graphMode;if(l===2)this.independent<t?this.independent=t:this.independent>i&&(this.independent=i);else if(l===1)this.independent<o?this.independent=o:this.independent>n&&(this.independent=n);else if(l===3){let c,p;this.independent<t?(p=this.getSortedPOI()[0],this.independent=p&&p.x!==void 0?p.x:0):this.independent>i&&(c=this.getSortedPOI(),p=c[c.length-1],this.independent=p&&p.x!==void 0?p.x:0)}}getPoint(e,t){let i,o=this.getCurrentSketch();if(!o||!Il(this.controller,o))return i;let n,a,s,l=0,c=o.branches[e];if(!c)return;let p=gw(o,e);"compiled"in c&&c.compiled&&(s=c.compiled.fn),a=c.graphMode;let u=this.grapher.getProjection(),{mathToPixels:m,pixelsToMath:h,screen:x}=u;if(a===2||a===8){let C=h.mapX(m.mapX(t)+x.width/(pb-1));n=this.getInterveningPOIs(t,C,e,a)[0],(!n||n.x!==t||n.branch!==e)&&(n=void 0,l=s?s(t):0),n?i={x:n.x,y:n.y,type:n.type,typeChain:n.typeChain,branch:n.branch,reportedBranch:p,graphMode:a,intersects:n.intersects}:s&&(i={x:t,y:l,branch:e,reportedBranch:p,graphMode:a})}else if(a===1){let C=h.mapY(m.mapY(t)-x.height/(pb-1));n=this.getInterveningPOIs(t,C,e,a)[0],(!n||n.y!==t||n.branch!==e)&&(n=void 0,l=s?s(t):0),n?i={x:n.x,y:n.y,type:n.type,typeChain:n.typeChain,branch:n.branch,reportedBranch:p,graphMode:a,intersects:n.intersects}:s&&(i={y:t,x:l,branch:e,reportedBranch:p,graphMode:a})}else if(a===3){let C=h.mapX(m.mapX(t)+x.width/(pb-1));n=this.getInterveningPOIs(t,C,e,a)[0],n&&n.x===t&&n.branch===e?i={x:n.x,y:n.y,type:n.type,typeChain:n.typeChain,branch:n.branch,reportedBranch:p,graphMode:a,intersects:n.intersects}:i={x:t,y:NaN,branch:e,reportedBranch:p,graphMode:a}}return i}getSampledPoints(){return this.sampledPoints.length===0&&this.updateSampledPoints(),this.sampledPoints}updateSampledPoints(){let e=this.getCurrentSketch();if(!e||!Il(this.controller,e))return;let t=[],i=this.grapher.getProjection(),o=i.viewport;for(let n=0;n<e.branches.length;n++){let a=e.branches[n];if(!jc(a))continue;let s=a.graphMode,l=0,c=0,p=[],u;if(s===2||s===3)l=o.xmin,c=o.xmax,u=(m,h,x)=>i.mathToPixels.interpolateX(m,h,x);else if(s===1)l=o.ymin,c=o.ymax,u=(m,h,x)=>i.mathToPixels.interpolateY(m,h,x);else continue;for(let m=0;m<pb;m++){let h=u(l,c,m/(pb-1)),x=__dcg_shared_module_exports__['bb'](h).value,C=u(l,c,(m+1)/(pb-1)),D=__dcg_shared_module_exports__['bb'](C).value,k=this.getInterveningPOIs(x,D,n,s);if(k.length>0)p.push.apply(p,k);else{let M=this.getPoint(n,x);M&&p.push(M)}}t.push.apply(t,this.removeDuplicates(p,s))}this.sampledPoints=t}getCurrentPoint(){return this.currentPoint||this.updateCurrentPoint(),this.currentPoint}updateCurrentPoint(e){if(e){this.currentPoint=e;let t=e.graphMode;t===2||t===3?this.independent=e.x!==void 0?e.x:0:t===1&&(this.independent=e.y!==void 0?e.y:0),this.branch=e.branch}else this.currentPoint=this.getPoint(this.branch,this.independent)}prevPoint(){this.moveToPoint(-1)}nextPoint(){this.moveToPoint(1)}firstPoint(){let e=this.getSampledPoints();e.length>0&&this.updateCurrentPoint(e[0])}lastPoint(){let e=this.getSampledPoints();e.length>0&&this.updateCurrentPoint(e[e.length-1])}moveToPoint(e){let t=this.getCurrentPoint();if(!t)return;if(t.graphMode===3){this.moveToPOI(e);return}let i=this.getSampledPoints(),o=this.getClosestPointIndexOnSameBranch(i,t);if(o!==-1){let n=o+e;n<=0?(n=0,At(this.controller.s("graphing-calculator-narration-audio-trace-first-point"))):n>=i.length-1&&(n=i.length-1,At(this.controller.s("graphing-calculator-narration-audio-trace-last-point")));let a=i[n];this.updateCurrentPoint(a)}}canMoveToPrevPoint(){let e=this.getCurrentPoint();if(!e)return!1;if(e.graphMode===3)return this.canMoveToPrevPOI();let t=this.getSampledPoints(),i=this.getClosestPointIndexOnSameBranch(t,e);return i!==-1&&i>0}canMoveToNextPoint(){let e=this.getCurrentPoint();if(!e)return!1;if(e.graphMode===3)return this.canMoveToNextPOI();let t=this.getSampledPoints(),i=this.getClosestPointIndexOnSameBranch(t,e);return i!==-1&&i<t.length-1}prevPOI(){this.moveToPOI(-1)}nextPOI(){this.moveToPOI(1)}getSortedPOI(){return(!this.pois||this.pois.length===0)&&this.updatePOI(),this.pois}updatePOI(){let e=[],t,i=[],o=this.getCurrentSketch();if(!(!o||!Il(this.controller,o))){for(let n=0;n<o.branches.length;n++){let a=o.branches[n];if(!a)continue;let s=gw(o,n),l=a.graphMode;if(i=[],t=o.getBranchPOI(n),t.length>0){l===2||l===3?i=__dcg_shared_module_exports__['B'](t,"x"):l===1&&(i=__dcg_shared_module_exports__['B'](t,"y"));let c=[];for(let p of i)c.push(KY(p,l,s));e.push.apply(e,this.removeDuplicates(c,l))}}this.pois=e}}removeDuplicates(e,t){let i=[];for(let o of e){if(o=__dcg_shared_module_exports__['a']({},o),o.graphMode=t,i.length===0){i.push(o);continue}let n=i[i.length-1];__dcg_shared_module_exports__['bb'](n.x).value===__dcg_shared_module_exports__['bb'](o.x).value&&__dcg_shared_module_exports__['bb'](n.y).value===__dcg_shared_module_exports__['bb'](o.y).value&&n.branch===o.branch?(n.typeChain||(n.typeChain=n.type!==void 0?[n.type]:[]),o.type!==void 0&&n.typeChain.indexOf(o.type)===-1&&n.typeChain.push(o.type),o.type===1001&&o.intersects&&n.intersects===void 0&&(n.intersects=o.intersects)):i.push(o)}return i}getInterveningPOIs(e,t,i,o){let n=[],a=this.getSortedPOI(),s=NaN;for(let l of a)l&&((o===2||o===3)&&!isNaN(l.x)?s=l.x:o===1&&!isNaN(l.y)&&(s=l.y),l.branch===i&&!isNaN(s)&&(e<=s&&s<t||t<=s&&s<e)&&n.push(l));return e>t?n.reverse():n}setIndependent(e,t){let i=this.getSampledPoints();for(let n of i)if(n&&n.hasOwnProperty(e)&&n[e]===t){if(e==="x"){this.independent=n.x!==void 0?n.x:0,this.updateCurrentPoint();return}else if(e==="y"){this.independent=n.y!==void 0?n.y:0,this.updateCurrentPoint();return}}let o=!0;if(i.length>0){let n=Math.floor((i.length-1)/2),a=i[n];a&&(e==="x"?(this.independent=a.x!==void 0?a.x:0,o=!1):e==="y"&&(this.independent=a.y!==void 0?a.y:0,o=!1))}o&&(this.independent=0),this.resetToFirstBranch(),this.updateCurrentPoint()}moveToPOI(e){if(!this.getCurrentPoint())return;let i=this.getSampledPoints(),o=this.getPOIIndexByDirection(e);o===-1?At(this.controller.s("graphing-calculator-narration-audio-trace-no-more-pois")):this.updateCurrentPoint(i[o])}getPOIIndexByDirection(e){let t=this.getCurrentPoint();if(!t)return-1;let i=this.getSampledPoints(),o=this.getClosestPointIndexOnSameBranch(i,t),n=-1;if(o!==-1){let a=t.graphMode,s=e===1?i.length-1:0;for(let l=o;l!==s+e;l+=e){let c=i[l];if(((a===2||a===3)&&t.x!==c.x||a===1&&t.y!==c.y)&&c.type!==void 0){n=l;break}}}return n}canMoveToPrevPOI(){return this.getPOIIndexByDirection(-1)!==-1}canMoveToNextPOI(){return this.getPOIIndexByDirection(1)!==-1}getClosestPointIndexOnSameBranch(e,t){let i=-1,o=1/0;if(e.length>0&&t){let n=t.graphMode;for(let a=0;a<e.length;a++){let s=e[a];if(t.branch!==s.branch)continue;let l;n===2||n===3?l=Math.abs(s.x-t.x):l=Math.abs(s.y-t.y),l<o&&(i=a,o=l)}}return i}prevCurve(){this.controller.shouldAudioTraceReverseExpressions()?this.curveDown():this.curveUp()}nextCurve(){this.controller.shouldAudioTraceReverseExpressions()?this.curveUp():this.curveDown()}curveUp(){let e=this.getSelectedItem();if(!e)return;let t=this.prevTableColumn(e);if(t)this.audiograph.setFocusedCell(t);else{let i=e.index,o=this.findPrevTraceableIndex({index:i,focusTableCell:!0});if(o!==-1){let n=this.controller.getItemModelByIndex(o);n&&this.controller.dispatch({type:"set-selected-id",id:n.id})}}(t||this.getSelectedItem()!==e)&&this.audiograph.enterAudioTrace()}curveDown(){let e=this.getSelectedItem();if(!e)return;let t=this.nextTableColumn(e);if(t)this.audiograph.setFocusedCell(t);else{let i=e.index,o=this.findNextTraceableIndex({index:i,focusTableCell:!0});if(o!==-1){let n=this.controller.getItemModelByIndex(o);n&&this.controller.dispatch({type:"set-selected-id",id:n.id})}}(t||this.getSelectedItem()!==e)&&this.audiograph.enterAudioTrace()}canMoveToPrevCurve(){let e=this.getSelectedItem();return e?this.controller.shouldAudioTraceReverseExpressions()?this.findNextTraceableIndex({index:e.index,focusTableCell:!1})!==-1:this.findPrevTraceableIndex({index:e.index,focusTableCell:!1})!==-1:!1}canMoveToNextCurve(){let e=this.getSelectedItem();return e?this.controller.shouldAudioTraceReverseExpressions()?this.findPrevTraceableIndex({index:e.index,focusTableCell:!1})!==-1:this.findNextTraceableIndex({index:e.index,focusTableCell:!1})!==-1:!1}findPrevTraceableIndex(e){let t=e.index,i;do{t--,i=this.controller.getItemModelByIndex(t);let o=i&&this.prevTableColumn(i);if(o)return e.focusTableCell&&this.audiograph.setFocusedCell(o),t}while(i&&!this.canTrace(i));return i?t:-1}findNextTraceableIndex(e){let t=e.index,i;do{t++,i=this.controller.getItemModelByIndex(t);let o=i&&this.nextTableColumn(i);if(o)return e.focusTableCell&&this.audiograph.setFocusedCell(o),t}while(i&&!this.canTrace(i));return i?t:-1}prevTableColumn(e){return this.tableColumn(e,-1)}nextTableColumn(e){return this.tableColumn(e,1)}tableColumn(e,t){let i;if(e&&e.type==="table"){let o=this.audiograph.getFocusedCell(),n,a,s;t===-1?(n=o?Math.max(o.location.column-1,0):NaN,a=o&&o.tableId===e.id&&!isNaN(n)?n:e.columnModels.length-1,s=0):(n=o?Math.min(o.location.column+1,e.columnModels.length-1):NaN,a=o&&o.tableId===e.id&&!isNaN(n)?n:0,s=e.columnModels.length-1);let l=(s-a)/t;if(isFinite(l)&&l>=0)for(let c=a;c!==s;c+=t){let p=e.columnModels[c];if(p&&this.grapher.getGraphSketch(p.id)){i={tableId:e.id,location:{column:c,row:0}};break}}}return i}getGraphSketchForTableCell(e,t){if(!e||e.type!=="table"||!t)return;let i=e.columnModels[t.location.column];if(i)return this.grapher.getGraphSketch(i.id)}getSelectedItemId(){let e=this.controller.getSelectedItem();return e&&e.type==="folder"?Ik(e):e==null?void 0:e.id}getSelectedItem(){let e=this.controller.getSelectedItem();if(e&&e.type==="folder"){var t=Ik(e);return t===void 0?void 0:this.controller.getItemModel(t)}return e}};xt();function mw(r){var V;let e=r.getGrapher();if(!e)return"";let t=e.viewportController.getViewport(),i=e.getProjection(),{showGrid:o,showXAxis:n,xAxisNumbers:a,showYAxis:s,yAxisNumbers:l,xAxisLabel:c,yAxisLabel:p}=e.settings,u=!1,m="",h=!1;r.is3dProduct()&&(n=s=u=e.settings.showAxis3D,c=p=m="",a=l=h=e.settings.showNumbers3D,o=n&&e.settings.showPlane3D);let x=[],C=ca(__dcg_shared_module_exports__['lb'].value(t.xmin,Cg(i,t.xmin)).latex),D=ca(__dcg_shared_module_exports__['lb'].value(t.xmax,Cg(i,t.xmax)).latex),k=ca(__dcg_shared_module_exports__['lb'].value(t.ymin,iE(i,t.ymin)).latex),M=ca(__dcg_shared_module_exports__['lb'].value(t.ymax,iE(i,t.ymax)).latex),I=t.zmin?ca(__dcg_shared_module_exports__['lb'].value(t.zmin).latex):"",S=t.zmax?ca(__dcg_shared_module_exports__['lb'].value(t.zmax).latex):"";if(n&&(a&&c!==""?x.push(r.s("graphing-calculator-narration-audio-trace-description-visible-x-axis-range-and-label",{xmin:C,xmax:D,label:c})):a&&c===""?x.push(r.s("graphing-calculator-narration-audio-trace-description-visible-x-axis-range",{xmin:C,xmax:D})):!a&&c!==""?x.push(r.s("graphing-calculator-narration-audio-trace-description-visible-x-axis-and-label",{label:c})):!a&&c===""&&x.push(r.s("graphing-calculator-narration-audio-trace-description-visible-x-axis"))),s&&(l&&p!==""?x.push(r.s("graphing-calculator-narration-audio-trace-description-visible-y-axis-range-and-label",{ymin:k,ymax:M,label:p})):l&&p===""?x.push(r.s("graphing-calculator-narration-audio-trace-description-visible-y-axis-range",{ymin:k,ymax:M})):!l&&p!==""?x.push(r.s("graphing-calculator-narration-audio-trace-description-visible-y-axis-and-label",{label:p})):!l&&p===""&&x.push(r.s("graphing-calculator-narration-audio-trace-description-visible-y-axis"))),u&&(h&&m!==""?x.push(r.s("graphing-calculator-narration-audio-trace-description-visible-z-axis-range-and-label",{zmin:I,zmax:S,label:m})):h&&m===""?x.push(r.s("graphing-calculator-narration-audio-trace-description-visible-z-axis-range",{zmin:I,zmax:S})):!h&&m!==""?x.push(r.s("graphing-calculator-narration-audio-trace-description-visible-z-axis-and-label",{label:m})):!h&&m===""&&x.push(r.s("graphing-calculator-narration-audio-trace-description-visible-z-axis"))),o&&x.push(r.s("graphing-calculator-narration-audio-trace-description-visible-grid")),r.is3dProduct()&&x.push(zY(r)),!r.isGeometry()&&!r.is3dProduct()){let P=(V=r.getGrapher())==null?void 0:V.graphSketches,L=0;for(let B in P)Il(r,P[B])&&(L+=1);x.push(r.s("graphing-calculator-narration-audio-trace-traceable-curves",{sketchCount:new Vo(L)}))}return x.join(" ").trim()}function zY(r){return""}var UY={};__dcg_shared_module_exports__['g'](UY,{default:()=>aA});var aA=__dcg_shared_module_exports__['i']("//tQxAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAAIAAAHVwAgICAgICAgICAgICBAQEBAQEBAQEBAQEBgYGBgYGBgYGBgYGBggICAgICAgICAgICAoKCgoKCgoKCgoKCgoMDAwMDAwMDAwMDAwODg4ODg4ODg4ODg4OD///////////////8AAAA5TEFNRTMuOThyAaUAAAAALmcAABRAJAiwQgAAQAAAB1cctrbdAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/7UMQAAAjsKyK0YYABp52xtx8wAgAgBd34IAhAgnsECEe7QIAAgsPxACDgcBAEHQfD/g+D4PggCAIf///ghLny4Pg+D5+sHz/wf+XPwfB8H3iMHwfwffUCYPvz/Y7Hg/H4/H4/H4HAwADcoDwAP7XfuAFtXrhzjsjOXP8iCYM4IBVoH2DGAhQR2hm5vikA2IVEPX9nQaITi6IiLCKX/fxcg/DdGmS5BP7fIGQ0hw7DQi5Q//8midImXygdJ0tlz/1NAgXIANV6MA2Vy2y27jv/+1LEBIALOHOTvGGAMXWhbnTxGZ+LOa2FNMsDtj9/jUmPqqqARrNvlVjDDoGZqq0T11A0DVqeEnlQk8q4sVEp0FcqdxLoEJ0RPYWvIlQkbGA0Anw6VJJgqRKw1NJaAXkR4ag0/FwCCABbbdbJA0fzVgdvgvu5Px6Rwiv3VllZVDREqmWntLyBDka3sz951iTve+ddHP0/M3P/+ydU4zbqOZOeop5jfu1kwk8VezPeGc1hRMbWrJNv6SO/fH0Mc15KYvKqAAAAdrdsrbBDuBpp4v/7UsQGgguVE2ekjNP5aSBo6YSNgKAQUoCZEBJK8q73G/nhJFFmLY5dNc4b7gjBRyEs5yjJokY9TBoU/pXQBglyNjeiA87V8vkzaw019YTu2fxY0t6gteLMI37f9fYw7UVnWoE4NJOSpQBu3GfVAIVACgw+IikZZAnB7UKlLGnha4PDbIhsBhk4RYmlE2hYZ8NrQ5HnyEUvZxDyVG1hM33ZZH0OlrJV5///3/51qTGtJgxhREVLEfoO1w6686eRAAAAUicksbA1qegZCe2AuEgJ//tSxAkCDF0XSaw8ailyn+l1h4w1BvVY04S56fYY5nGkBZHMGLBjHDUMlORG4wcCT9R6RB+3vM8jVMU1hmlOoXIOMKqotE2HxWYNJq/7EZ2l63NJ+Z2aTA4Yq+7t0PhOxCz9WP1mA3DJZZGDkRfq+qFAGwhwHUAVqBfDiMUlypaMWApR1VoWLChfUpJzkBDMCTf85UZr6jyHa1psZnTS5iKatTVKcX/Ker9zMvM1T0okGyiQcreJbU1tc+Yj/ms3395FBIADkjlkjbAZNdiwgRD/+1LEBwAL8Tdbp6Rh+XmT6XWHjCx5U4sTCtlUidNtS9I7oUx7oxdIZlOghkIQYzB0vxtMs6QgCg4WMVakQMM5HRfrsdIEftM0yfOHnNGkiPRMoWCKSsxsChat8/vYw4c4t+CMMB5AAAAXZrftWiEVdbSgnURZoWvK2KhK9GfCkIGnQKxIqbYJ0JCNFJ3St1wuUNRLW4Kw5VhLVGrmgYKhhRe1qzzC7SqFFyjJlIqXcPD6gw//epZ9bwQFw+s+rdVAFtzl0AAAA3I3JK0QJxtCHv/7UsQGAApAM0WssGFpSCKqNYMMvgZph6CwIhKEt0yEiMwFKpnDBBajVc5jbTM7KayRt3I43h8Ag05kd9AtqO0bItmf/+Aevzf7dx28sK0hvP//3/izNwf1pfEAgANutuOJACSqWvuW+SKNLQSpOQKsrX3XxnZxy2Rus0Q1irPy9Mkg4kZGJFRQUax4R+jsACwavqYd2bmRX/6VnKrLk2Z2VGYwQNCIEasJh7/oBScAAMtBNgBWssKw0uCAgKkVpJirpZyBklUCwqaSIkW6BgIY//tSxBIDSYw3Km0kSoEzi9KAliSw9QNAydBqoFQVEQNBwiJYiBWdDqxiwVBUGqg6JgaBoGj3//////huVcFQsIRoPjBXLBGA8AkCwOhcD4KAmFAtEYcR6E8gD2OAXJ2N//uSJVZVJNRdh0gkLCwuKioqz4sLC3//////4sLC31ioqKpAoqKirOgFqkxBTUUzLjk4LjKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+1LEIwPAAAGkAAAAIAAANIAAAASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqg==");yl();var RE=class{suspend(){return new Promise((e,t)=>{if(this.audioContext)this.audioContext.suspend().then(()=>{e()}).catch(i=>{fn(i),t(i)});else{e();return}})}getResumedAudioContext(){return new Promise((e,t)=>{if(!this.audioContext){let i=window.AudioContext||window.webkitAudioContext;if(!i){t();return}try{this.audioContext=new i({latencyHint:"interactive",sampleRate:44100})}catch(o){t(o)}}this.audioContext&&(this.audioContext.state!=="running"?this.audioContext.resume().then(()=>{e({audioContext:this.audioContext,poiBuffer:this.poiBuffer})}).catch(i=>{fn(i),t(i)}):this.audioContext.resume().then(()=>{e({audioContext:this.audioContext,poiBuffer:this.poiBuffer})}).catch(i=>{fn(i),t(i)}))})}};yl();var Jp=.075,bi=.0015,Kq=125,zq=330,Uq=2e3,WY=27.5,$Y=4186,sA=.04,lA=.2,Hq=25;function Wq(r){return r<2e3?.002:.005}function jY(r){return{segments:r.clippedSegments.length,totalPoints:r.clippedSegments.map(e=>e.length).reduce((e,t)=>e+t,0),graphMode:r.graphMode,duration:r.duration,discrete:r.discrete}}var fw=class{constructor(e,t){this.audioContext=e.audioContext,this.audioContext&&(this.oscillator=new OscillatorNode(this.audioContext,{periodicWave:e.getBaseWaveform()}),this.firstHarmonic=new OscillatorNode(this.audioContext,{periodicWave:e.getFirstHarmonicWaveform()}),this.firstHarmonicGain=new GainNode(this.audioContext,{gain:0}),this.pan=new StereoPannerNode(this.audioContext,{pan:0}),this.gain=new GainNode(this.audioContext,{gain:0}),this.oscillatorGain=new GainNode(this.audioContext,{gain:.5}),this.oscillatorGain.connect(this.gain),this.oscillator.connect(this.oscillatorGain),this.firstHarmonic.connect(this.firstHarmonicGain),this.firstHarmonicGain.connect(this.gain),this.gain.connect(this.pan),this.pan.connect(t),this.oscillator.start(),this.firstHarmonic.start(),this.brownNoiseGain=new GainNode(this.audioContext,{gain:0}),this.brownNoiseSource=new AudioBufferSourceNode(this.audioContext,{buffer:e.brownNoiseSample,loop:!0}),this.brownNoiseSource.start(),this.brownNoiseSource.connect(this.brownNoiseGain),this.brownNoiseGain.connect(this.pan))}stop(e){let t=Math.max(this.audioContext.currentTime,e);this.gain.gain.setTargetAtTime(0,t,bi),this.brownNoiseGain.gain.setTargetAtTime(0,t,bi),setTimeout(()=>{this.oscillator.stop(),this.firstHarmonic.stop(),this.brownNoiseSource.stop(),this.pan.disconnect()},1e3*(2*bi+Math.max(0,e-this.audioContext.currentTime))+1)}};function YY(r){if(r.length<=2)return[r];let e=__dcg_shared_module_exports__['J'](r,2),t=0,i=[[e[0]]],o=e[0][0]<e[1][0];for(let n=1;n<e.length;n++)i[t].push(e[n]),n<e.length-1&&o!==e[n][0]<e[n+1][0]&&(o=!o,t++,i[t]=[e[n]]);return i.map(n=>__dcg_shared_module_exports__['E'](n))}function JY(r){let e=__dcg_shared_module_exports__['J'](r,2);return e.sort((t,i)=>t[0]-i[0]),__dcg_shared_module_exports__['E'](e)}var NE=class{constructor({controller:e,agNavigator:t,audioEnabled:i}){this.isPlayingOneBranch=!1;this.FREQ_MIN=Kq;this.FREQ_MAX=Uq;this.FREQ_BASE=zq;e&&(this.controller=e),this.audioContextManager=new RE,this.audioGraphNavigator=t,this.audioEnabled=i,this.screenDuration=5,this.audioVolume=.5}getBaseWaveform(){var i;let e=new Float32Array([0,1,0,.25]),t=new Float32Array([1,0,.25,0]);return(i=this.audioContext)==null?void 0:i.createPeriodicWave(e,t)}getFirstHarmonicWaveform(){var i;let e=new Float32Array([0,0,0,.25,0,0,0,0]),t=new Float32Array([1,0,1,0,.25,0,.3,0]);return(i=this.audioContext)==null?void 0:i.createPeriodicWave(e,t)}async prepareSynthesizer(){if(!this.audioEnabled()||!this.audioContextManager||!this.audioGraphNavigator)return;try{this.audioContext=(await this.audioContextManager.getResumedAudioContext()).audioContext,this.playbackSupported=!0}catch(i){this.playbackSupported=!1;return}this.audioContext.destination.disconnect(),this.mainGainNode=new GainNode(this.audioContext,{gain:this.audioVolume}),this.mainGainNode.gain.value=this.audioVolume,this.mainGainNode.connect(this.audioContext.destination);let e=this.audioContext.sampleRate*this.screenDuration;this.brownNoiseSample=this.audioContext.createBuffer(1,e,this.audioContext.sampleRate);let t=iA(0);for(let i=0;i<e;i++)t=iA(t),this.brownNoiseSample.getChannelData(0)[i]=t;if(!this.poiBufferSample)try{this.poiBufferSample=await this.audioContext.decodeAudioData(aA.buffer.slice(0))}catch(i){fn(i)}}releaseAudio(){var e;this.stop(),(e=this.audioContextManager)==null||e.suspend()}playPoint(e){!_q(e)||!this.audioContextManager||this.prepareSynthesizer().then(()=>{this.setupScales(e.graphMode);let t=new fw(this,this.mainGainNode),{gain:i,brownNoiseGain:o,oscillator:n,firstHarmonic:a,firstHarmonicGain:s,pan:l}=t;this.turnMainGainOn();let{independent:c,dependent:p}=qq(e),u=this.mapDependentToFrequency(p),m=this.audioContext.currentTime;if(!u||!this.viewportBounds){t.stop(m);return}else t.stop(m+Jp+bi);if(p<this.viewportBounds.dependentMin||p>this.viewportBounds.dependentMax){o.gain.setTargetAtTime(sA,m,bi),o.gain.setTargetAtTime(0,m+Jp,bi);return}if(n.frequency.value=u,a.frequency.value=u,i.gain.setTargetAtTime(1,m,bi),e.x>0&&s.gain.setTargetAtTime(.15,m,bi),o.gain.setTargetAtTime(nA(p),m,bi),l.pan.setTargetAtTime(this.getPanValueFromIndependent(c),m,bi),e.intersects){let h=this.audioContext.createBufferSource();h.connect(i),h.buffer=this.poiBufferSample;try{h==null||h.start(this.audioContext.currentTime)}catch(x){}}})}playCurrentSketch(e="sequential"){this.audioContextManager&&this.prepareSynthesizer().then(()=>{this.isPlaying=!0,this.isPlayingOneBranch=!1,this.controller.runAfterDispatch(()=>this.controller.dispatch({type:"render"})),this.prepareToPlay(e),this.startPlayingTime=this.audioContext.currentTime+bi,this.currentPlayLoopStartTime=this.startPlayingTime,this.lagLoggingData||(this.lagLoggingData={startPlayingTime:this.startPlayingTime,branchCount:this.branches.length,branchInfo:this.branches.map(t=>jY(t)),branchIteratorStartTimes:[],branchIteratorRunTimes:[],branchIteratorCallCount:0,branchLags:[],screenDuration:this.screenDuration}),e==="sequential"?(this.currentPlayLoopBranchIndex=0,this.playBranchIterators=[this.playBranch(this.currentPlayLoopBranchIndex,this.currentPlayLoopStartTime)],this.lagLoggingData&&(this.lagLoggingData.proposedDuration=this.branches.reduce((t,i)=>{var o;return t+((o=i.duration)!=null?o:0)},0)),this.sequentialPlayLoop()):e==="simultaneous"&&(this.playBranchIterators=this.branches.map((t,i)=>this.playBranch(i,this.currentPlayLoopStartTime)),this.playBranchIterators.push(this.playBlankSpace(this.currentPlayLoopStartTime)),this.simultaneousPlayLoop())})}stop(){var o,n,a,s,l,c;clearTimeout(this.timeoutId),this.isPlaying=!1,this.startPlayingTime=void 0;let e=(o=this.audioContext)==null?void 0:o.currentTime;if(!e)return;this.lagLoggingData&&(this.lagLoggingData.actualDuration=e-this.lagLoggingData.startPlayingTime,this.lagLoggingData.stopPlayingTime=e,(a=(n=this.controller).logJSON)==null||a.call(n,"audio-trace::stop-graph",this.lagLoggingData),this.lagLoggingData=void 0);let t=(s=this.playBranchIterators)==null?void 0:s.map(p=>p.next()).filter(p=>!p.done);t==null||t.forEach(p=>{var u,m;return(m=(u=p.value).synthStopCallback)==null?void 0:m.call(u,e)}),this.playBranchIterators=[],(l=this.mainGainNode)==null||l.gain.cancelScheduledValues(e),(c=this.mainGainNode)==null||c.gain.setTargetAtTime(0,e,bi);let i=this.mainGainNode;setTimeout(()=>i.disconnect(),1e3*2*bi+1),this.controller.runAfterDispatch(()=>this.controller.dispatch({type:"render"}))}getGraphMode(){if(this.branches)return this.currentPlayLoopBranchIndex!==void 0?this.branches[this.currentPlayLoopBranchIndex].graphMode:this.branches[0].graphMode}playBranchByIndex(e){this.audioContext&&this.prepareSynthesizer().then(()=>{this.prepareToPlay("simultaneous"),this.isPlayingOneBranch=!0,this.isPlaying=!0,this.startPlayingTime=this.audioContext.currentTime+bi,this.currentPlayLoopStartTime=this.startPlayingTime,this.currentPlayLoopBranchIndex=e,this.branches[0].graphMode===8||this.branches[0].graphMode==5||this.branches[0].graphMode==6?(this.playBranchIterators=this.branches.map((t,i)=>this.playBranch(i,this.currentPlayLoopStartTime)),this.playBranchIterators.push(this.playBlankSpace(this.currentPlayLoopStartTime))):this.playBranchIterators=[this.playBranch(e,this.startPlayingTime)],this.simultaneousPlayLoop()})}getPlaybackSupported(){return this.playbackSupported}getIsPlaying(){return this.isPlaying}getAudioSpeed(){return this.screenDuration*10}setAudioSpeed(e){this.screenDuration=e/10}getAudioVolume(){return this.audioVolume}setAudioVolume(e){var t;this.audioVolume=e,(t=this.mainGainNode)==null||t.gain.setTargetAtTime(this.audioVolume,0,bi)}getCurrentIndependentValue(){var i,o;if(!this.getIsPlaying()||this.startPlayingTime===void 0)return;if(this.isPlayingOneBranch)return(o=(i=this.branches[this.currentPlayLoopBranchIndex]).mapTimeToIndependent)==null?void 0:o.call(i,this.audioContext.currentTime-this.startPlayingTime);let e=this.audioContext.currentTime-this.startPlayingTime,t=0;for(let n of this.branches)if(!(!n.duration||!n.mapIndependentToTime||!n.mapTimeToIndependent)){if(e-t>=n.duration){t+=n.duration;continue}return n.mapTimeToIndependent(e-t)}}getCurrentBranchIndex(){if(!this.getIsPlaying()||this.startPlayingTime===void 0)return;if(this.isPlayingOneBranch)return this.currentPlayLoopBranchIndex;let e=this.audioContext.currentTime-this.startPlayingTime,t=0;for(let i=0;i<this.branches.length;i++){let o=this.branches[i];if(o.duration){if(e-t>=o.duration){t+=o.duration;continue}return i}}}preprocessBranch(e,t){switch(e.graphMode){case 8:case 5:case 6:let i=[],o=e.segments;if(e.graphMode===6){let n=this.controller.getViewState();o=o.map(a=>Nq(a,n))}for(let n of o){let s=oA(n,t,__dcg_shared_module_exports__['Hc']);i.push(...s.filter(l=>l.length>2))}return i=__dcg_shared_module_exports__['E'](i.map(n=>YY(n).map(a=>JY(a))),!0),i.sort((n,a)=>n[0]-a[0]),i.map(n=>({graphMode:e.graphMode,discrete:!1,poi:e.poi,clippedSegments:[n]})).filter(n=>n.clippedSegments.length>0);case 2:case 1:{let n=[];for(let a of e.segments){let s=e.graphMode===2?__dcg_shared_module_exports__['Hc']:__dcg_shared_module_exports__['Ic'],l=oA(a,t,s);n.push(...l.filter(c=>c.length>2))}return n.sort((a,s)=>a[0]-s[0]),{graphMode:e.graphMode,discrete:!1,clippedSegments:n,poi:e.poi}}case 3:case 4:{let{viewport:n}=t,a=e.segments[0].slice();a.sort(Bq);let s=[],l=[];for(let c of a)s.push(c[0],c[1]),c[0]>=n.xmin&&c[1]<=n.xmax&&c[1]>=n.ymin&&c[1]<=n.ymax&&l.push(c[0],c[1]);return{graphMode:2,discrete:!0,clippedSegments:[l],poi:void 0}}default:throw new Error(`Unimplemented graph mode: ${e.graphMode}`)}}turnMainGainOn(){var e,t;(e=this.mainGainNode)==null||e.gain.cancelScheduledValues(0),(t=this.mainGainNode)==null||t.gain.setTargetAtTime(this.audioVolume,0,bi)}getPanValueFromIndependent(e){return this.dependentScale?__dcg_shared_module_exports__['Ab'](2*__dcg_shared_module_exports__['zc'](this.dependentScale,e)-1,-1,1):0}setupScales(e){this.projection=this.controller.get2dProjection(),this.viewportBounds=Fq(this.projection.viewport,e);let t=e===1?this.projection.settings.yAxisScale:this.projection.settings.xAxisScale,i=e===1?this.projection.settings.xAxisScale:this.projection.settings.yAxisScale;this.independentScale=__dcg_shared_module_exports__['yc'](t,[this.viewportBounds.independentMin,this.viewportBounds.independentMax],[0,this.screenDuration]),this.dependentScale=__dcg_shared_module_exports__['yc'](i,[this.viewportBounds.dependentMin,this.viewportBounds.dependentMax],[0,1]),this.viewportBounds.dependentMax<=$Y&&this.viewportBounds.dependentMin>=WY&&this.viewportBounds.dependentMax-this.viewportBounds.dependentMin>=1e3?(this.FREQ_MIN=this.viewportBounds.dependentMin,this.FREQ_MAX=this.viewportBounds.dependentMax,this.FREQ_BASE=void 0):(this.FREQ_MIN=Kq,this.FREQ_MAX=Uq,this.FREQ_BASE=zq)}densifyBranches(){this.branches.map(e=>{if(e.discrete)return e;let t=this.independentScale,i=this.dependentScale;return!t||!i||!e.clippedSegments||(e.clippedSegments=e.clippedSegments.map(o=>{let n=[];for(let a=0;a<o.length;a+=2){let s=this.mapDependentToFrequency(o[a+1]),l=this.mapDependentToFrequency(o[a+3]);if(n.push(o[a]),n.push(o[a+1]),s&&l&&isFinite(s)&&isFinite(l)&&Math.abs((l-s)/s)>=Wq(Math.min(l,s))){let c=Math.ceil(Math.abs((l-s)/s)/Wq(Math.min(l,s)));for(let p=1;p<c;p++)n.push(__dcg_shared_module_exports__['Ac'](t.type,o[a],o[a+2],p*1/c)),n.push(__dcg_shared_module_exports__['Ac'](i.type,o[a+1],o[a+3],p*1/c))}}return n})),e})}setupToPlayBranches(e){if(!this.audioGraphNavigator||!this.audioContext||!this.mainGainNode)return;let t=this.audioGraphNavigator.getCurrentSketch();if(!t)return;let i=this.controller.get2dProjection();if(this.branches=__dcg_shared_module_exports__['E'](t.branches.filter(o=>jc(o)).map(o=>this.preprocessBranch(o,i))),this.setupScales(this.branches[0].graphMode),this.densifyBranches(),e==="simultaneous"){let o=Math.min(...this.branches.map(c=>c.clippedSegments[0][0])),n=Math.max(...this.branches.map(c=>c.clippedSegments.slice(-1)[0].slice(-2)[0])),a=this.mapIndependentToTime(n)-this.mapIndependentToTime(o),s=__dcg_shared_module_exports__['yc'](this.branches[0].graphMode===1?this.projection.settings.yAxisScale:this.projection.settings.xAxisScale,[o,n],[0,a]),l=__dcg_shared_module_exports__['yc'](this.branches[0].graphMode===1?this.projection.settings.yAxisScale:this.projection.settings.xAxisScale,[0,a],[o,n]);this.branches.forEach(c=>{c.duration=c.discrete?a+Jp:a,c.mapIndependentToTime=p=>__dcg_shared_module_exports__['zc'](s,p),c.mapTimeToIndependent=p=>__dcg_shared_module_exports__['zc'](l,p)})}else this.branches.forEach(o=>{let n=o.clippedSegments[0][0],a=o.clippedSegments.slice(-1)[0].slice(-2)[0];o.duration=this.mapIndependentToTime(a)-this.mapIndependentToTime(n),o.discrete&&(o.duration+=Jp);let s=__dcg_shared_module_exports__['yc'](this.branches[0].graphMode===1?this.projection.settings.yAxisScale:this.projection.settings.xAxisScale,[n,a],[0,o.duration]),l=__dcg_shared_module_exports__['yc'](this.branches[0].graphMode===1?this.projection.settings.yAxisScale:this.projection.settings.xAxisScale,[0,o.duration],[n,a]);o.mapIndependentToTime=c=>__dcg_shared_module_exports__['zc'](s,c),o.mapTimeToIndependent=c=>__dcg_shared_module_exports__['zc'](l,c)})}prepareToPlay(e){this.setupToPlayBranches(e),this.turnMainGainOn(),clearInterval(this.timeoutId)}sequentialPlayLoop(){var i,o,n,a,s;let e=this.audioContext.currentTime,t=(i=this.playBranchIterators[0])==null?void 0:i.next();if(this.lagLoggingData&&(this.lagLoggingData.branchIteratorCallCount++,this.audioContext.currentTime-e>0&&(this.lagLoggingData.branchIteratorStartTimes.push(e),this.lagLoggingData.branchIteratorRunTimes.push(this.audioContext.currentTime-e))),!!t){if(t.done)if(((o=t.value)==null?void 0:o.duration)!==void 0&&(this.currentPlayLoopStartTime=((n=t.value.startTime)!=null?n:this.currentPlayLoopStartTime)+t.value.duration),this.currentPlayLoopBranchIndex<this.branches.length-1)this.currentPlayLoopBranchIndex++,this.playBranchIterators[0]=this.playBranch(this.currentPlayLoopBranchIndex,this.currentPlayLoopStartTime),this.sequentialPlayLoop();else{(a=this.mainGainNode)==null||a.gain.cancelScheduledValues(this.currentPlayLoopStartTime),(s=this.mainGainNode)==null||s.gain.setTargetAtTime(0,this.currentPlayLoopStartTime,bi),clearTimeout(this.timeoutId),this.timeoutId=setTimeout(()=>this.stop(),1e3*(Math.max(this.currentPlayLoopStartTime-this.audioContext.currentTime,0)+bi));return}this.timeoutId=setTimeout(()=>this.sequentialPlayLoop(),Hq)}}simultaneousPlayLoop(){var t,i;let e=this.playBranchIterators.map(o=>o.next());if(e.every(o=>o.done)){let o=this.currentPlayLoopStartTime+Math.max(...e.map(n=>{var a;return(a=n.value)!=null&&a.duration&&isFinite(n.value.duration)?n.value.duration:0}));(t=this.mainGainNode)==null||t.gain.cancelScheduledValues(o),(i=this.mainGainNode)==null||i.gain.setTargetAtTime(0,o,bi),this.timeoutId=setTimeout(()=>this.stop(),1e3*(Math.max(o-this.audioContext.currentTime,0)+bi))}else this.timeoutId=setTimeout(()=>this.simultaneousPlayLoop(),Hq)}*playBlankSpace(e){let t=Math.max(this.audioContext.currentTime,e),i=new fw(this,this.mainGainNode),{oscillator:o,pan:n,brownNoiseGain:a,gain:s}=i;o.stop(),s.gain.setTargetAtTime(1,t,bi);let l=this.branches.map(u=>{if(u.mapIndependentToTime)return[u.clippedSegments[0][0],u.clippedSegments.slice(-1)[0].slice(-2)[0]]}).filter(u=>!!u),c=[];for(l.sort((u,m)=>u[0]-m[0]);l.length>0;){let u=l[0];l=l.filter(m=>m[1]>u[1]),l.filter(m=>m[0]<=u[1]).length===0&&c.push([u[1],Math.min(...l.map(m=>m[0]))])}c=c.filter(u=>isFinite(u[0])&&isFinite(u[1]));let p=u=>{i.stop(u)};for(let u of c){let m=t+this.mapIndependentToTime(u[0]),h=t+this.mapIndependentToTime(u[1]);for(;m>this.audioContext.currentTime+lA;)yield{synthStopCallback:p};a.gain.setTargetAtTime(sA,m,bi),a.gain.setTargetAtTime(0,h,bi),n.pan.setValueAtTime(this.getPanValueFromIndependent(u[0]),m),n.pan.linearRampToValueAtTime(this.getPanValueFromIndependent(u[1]),h)}return{duration:0}}*playBranch(e,t){var x,C,D,k;let i=this.branches[e];if(!(i!=null&&i.duration)||!(i!=null&&i.mapIndependentToTime))return{duration:0};let o=Math.max(this.audioContext.currentTime,t),n=new fw(this,this.mainGainNode),{oscillator:a,gain:s,firstHarmonic:l,firstHarmonicGain:c,pan:p,brownNoiseGain:u}=n,m=i.clippedSegments;if(i.poi&&i.poi.intersections&&this.poiBufferSample){let M=Rq(i.graphMode,i.poi.intersections);for(let I of M){let S=this.audioContext.createBufferSource();S.connect(s),S.buffer=this.poiBufferSample;try{S==null||S.start(o+i.mapIndependentToTime(I))}catch(V){}}}let h=M=>{n.stop(M)};for(let M=0;M<m.length;M++){let I=m[M];for(let S=0;S<I.length;S+=2){let V=S===0,P=S+2>=I.length,L=o+i.mapIndependentToTime(I[S]),B=this.mapDependentToFrequency(I[S+1]);for(;L>this.audioContext.currentTime+lA;)yield{synthStopCallback:h,duration:void 0};if(L<this.audioContext.currentTime-lA&&this.lagLoggingData&&this.lagLoggingData.branchLags.push({branchIndex:e,segmentIndex:M,pos:S,nextTime:L,proposedStartTime:t,lagAmount:this.audioContext.currentTime-L,currentTime:this.audioContext.currentTime}),V&&(c.gain.cancelScheduledValues(L),u.gain.cancelScheduledValues(L),s.gain.setTargetAtTime(1,L,bi)),B!==void 0&&isFinite(B)){if(i.discrete){let re=S>=2?o+i.mapIndependentToTime(I[S-2]):void 0,ne=S+2<I.length?o+i.mapIndependentToTime(I[S+2]):void 0,X=re!==void 0?Math.max(L-Jp/2,re+Jp/2):L-Jp/2,b=ne!==void 0?Math.min(ne,L+Jp/2):L+Jp/2;a.frequency.setValueAtTime(B,X),l.frequency.setValueAtTime(B,X),c.gain.setTargetAtTime(I[S]>0?.15:0,X,bi),c.gain.setTargetAtTime(0,b,bi),s.gain.setTargetAtTime(1,X,bi),s.gain.setTargetAtTime(0,b,bi)}else{a.frequency.linearRampToValueAtTime(B,L),l.frequency.linearRampToValueAtTime(B,L);let re=L;if(S>=2&&I[S-2]<=0!=I[S]<=0){let X=I[S-2],b=I[S];re=o+i.mapIndependentToTime(__dcg_shared_module_exports__['Ac']((C=(x=this.independentScale)==null?void 0:x.type)!=null?C:"linear",X,b,Math.abs(b)/(Math.abs(b)+Math.abs(X))))}c.gain.setTargetAtTime(I[S]>0?.15:0,re,bi)}let R=L;if(S>=2&&I[S+1]<=0!=I[S-1]<=0){let re=I[S-2],ne=I[S],X=I[S-1],b=I[S+1];R=o+i.mapIndependentToTime(__dcg_shared_module_exports__['Ac']((k=(D=this.independentScale)==null?void 0:D.type)!=null?k:"linear",re,ne,Math.abs(X)/(Math.abs(X)+Math.abs(b))))}u.gain.setTargetAtTime(nA(I[S+1]),R,bi)}P&&(s.gain.setTargetAtTime(0,L,bi),M<i.clippedSegments.length-1&&u.gain.setTargetAtTime(sA,L,bi)),S===0?p.pan.setValueAtTime(this.getPanValueFromIndependent(I[S]),L):p.pan.linearRampToValueAtTime(this.getPanValueFromIndependent(I[S]),L)}}return i.duration=Math.max(0,i.duration,this.audioContext.currentTime-t),n.stop(o+i.duration),{duration:i.duration,startTime:o}}mapIndependentToTime(e){return this.independentScale?__dcg_shared_module_exports__['zc'](this.independentScale,e):0}mapDependentToFrequency(e){if(!this.dependentScale)return;let t=__dcg_shared_module_exports__['zc'](this.dependentScale,e);if(this.FREQ_BASE)return Math.min(Math.max(this.FREQ_BASE*Math.pow(2,t),this.FREQ_MIN),this.FREQ_MAX);{let i=this.FREQ_MAX-this.FREQ_MIN;return Math.min(Math.max(this.FREQ_MIN+i*t,this.FREQ_MIN),this.FREQ_MAX)}}};var bw=[{speed:1600,displayedSpeed:"1/32 x"},{speed:1200,displayedSpeed:"1/24 x"},{speed:800,displayedSpeed:"1/16 x"},{speed:400,displayedSpeed:"1/8 x"},{speed:200,displayedSpeed:"1/4 x"},{speed:100,displayedSpeed:"1/2 x"},{speed:50,displayedSpeed:"1 x"},{speed:25,displayedSpeed:"2 x"},{speed:12.5,displayedSpeed:"4 x"},{speed:6.25,displayedSpeed:"8 x"}],BE=class{constructor(e,t){this.grapher=t,this.controller=e,this.audioTraceActive=!1,this.wasFocusInExpressionsView=!1,this.focusedCell=void 0,this.sliderTraceActive=!1,this.sliderIndex=0,this.sliderArray=[],this.lastSpokenBranch=1,this.agNavigator=new FE(e,this,this.grapher),this.agSynthesizer=new NE({controller:e,agNavigator:this.agNavigator,audioEnabled:()=>this.controller.getAudio()}),this.audioSpeedIndex=6,this.agSynthesizer.releaseAudio()}remove(){}handleKeydown(e){let t=e.altKey&&!e.metaKey&&!e.ctrlKey&&!e.shiftKey;t&&ki(e)==="S"?this.agNavigator.getSelectedItem()&&(this.audioTraceActive||this.isFocusInExpressionsView())&&(e.preventDefault(),e.stopPropagation(),this.describeCurve()):t&&ki(e)==="G"?(this.audioTraceActive||this.isFocusInExpressionsView())&&(e.preventDefault(),e.stopPropagation(),this.describeAxes()):t&&ki(e)==="T"?(e.preventDefault(),e.stopPropagation(),this.toggleAudioTrace()):this.audioTraceActive&&(this.sliderTraceActive?this.sliderTraceKeydown(e):(this.stopAnimations(),this.audioTraceKeydown(e)))}sliderTraceKeydown(e){let t=e.altKey||e.metaKey,i=!t&&!e.ctrlKey&&!e.shiftKey;i&&Ee(e)===Cd||ki(e)==="J"?(e.preventDefault(),e.stopPropagation(),this.decrementSliderValue()):i&&Ee(e)===Dd||ki(e)==="L"?(e.preventDefault(),e.stopPropagation(),this.incrementSliderValue()):i&&Ee(e)===Nm?(e.preventDefault(),e.stopPropagation(),this.decrementBigSliderValue()):i&&Ee(e)===Rm?(e.preventDefault(),e.stopPropagation(),this.incrementBigSliderValue()):!t&&(Ee(e)===mn||!e.shiftKey&&Ee(e)===hl||ki(e)==="K")?(e.preventDefault(),e.stopPropagation(),this.nextSlider()):!t&&(Ee(e)===gn||e.shiftKey&&Ee(e)===hl||ki(e)==="I")?(e.preventDefault(),e.stopPropagation(),this.prevSlider()):i&&Ee(e)===Lu||ki(e)==="U"?(e.preventDefault(),e.stopPropagation(),this.sliderMin()):i&&Ee(e)===Au||ki(e)==="N"?(e.preventDefault(),e.stopPropagation(),this.sliderMax()):this.audioTraceKeydown(e)}audioTraceKeydown(e){let t=e.altKey||e.metaKey,i=t&&!e.ctrlKey&&!e.shiftKey,o=!t&&!e.ctrlKey&&!e.shiftKey,n=ki(e);if(Ee(e)===gn&&i)e.preventDefault(),e.stopPropagation(),tn(),this.agNavigator.prevCurve();else if(Ee(e)===mn&&i)e.preventDefault(),e.stopPropagation(),tn(),this.agNavigator.nextCurve();else if(o&&Ee(e)===Cd||Ee(e)===gn||n==="J")e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"keypad/audio-trace",command:"previous-point"});else if(o&&Ee(e)===Dd||Ee(e)===mn||n==="L")e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"keypad/audio-trace",command:"next-point"});else if(!t&&(Ee(e)===Nm||!e.shiftKey&&Ee(e)===hl||n==="I"))e.preventDefault(),e.stopPropagation(),this.reportAndMoveToNextPOI();else if(!t&&(Ee(e)===Rm||e.shiftKey&&Ee(e)===hl||n==="K"))e.preventDefault(),e.stopPropagation(),this.reportAndMoveToPrevPOI();else if(o&&Ee(e)===Lu||n==="U")e.preventDefault(),e.stopPropagation(),this.reportAndMoveToFirstPoint();else if(o&&Ee(e)===Au||n==="N")e.preventDefault(),e.stopPropagation(),this.reportAndMoveToLastPoint();else if(o&&n==="X")e.preventDefault(),e.stopPropagation(),this.reportX();else if(o&&n==="P")e.preventDefault(),e.stopPropagation(),this.reportPOICount();else if(o&&n==="Y")e.preventDefault(),e.stopPropagation(),this.reportY();else if(o&&n==="T")e.preventDefault(),e.stopPropagation(),this.reportType();else if(o&&n==="B")e.preventDefault(),e.stopPropagation(),this.reportBranch();else if(o&&n==="O")e.preventDefault(),e.stopPropagation(),this.reportAndMoveToOrigin();else if(o&&n==="H")e.preventDefault(),e.stopPropagation(),this.hearGraph();else if(o&&typeof n=="string"&&n>="0"&&n<="9"){if(e.preventDefault(),e.stopPropagation(),tn(),!this.controller.getAudio()){be(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"));return}this.agSynthesizer.stop();let a=this.agNavigator.getCurrentSketch();if(a){let s;e.which===48?s=9:s=e.which-49;let l=s,c=-1;for(let p=0;p<a.branches.length;p++)if(jc(a.branches[p])&&(l-=1),l<0){c=p;break}c>=0?this.agSynthesizer.getPlaybackSupported()?(this.agSynthesizer.playBranchByIndex(c),this.grapher.traceLayer.setTraceInfo(void 0),this.graphAnimationTimeoutId=requestAnimationFrame(()=>this.animateCurrentSketchLine())):be(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-play")):be(this.controller.s("graphing-calculator-narration-audio-trace-branch-not-found",{branch:s+1}))}else be(this.controller.s("graphing-calculator-narration-audio-trace-description-no-curve-selected"))}else t&&typeof n=="string"&&n>="1"&&n<="5"?(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-audio-trace-speed",speed:parseInt(n,10)+3})):!e.altKey&&!e.ctrlKey&&!e.metaKey&&n==="V"?(e.preventDefault(),e.stopPropagation(),this.controller.getAudio()?e.shiftKey?this.controller.dispatch({type:"keypad/audio-trace",command:"volume-down"}):this.controller.dispatch({type:"keypad/audio-trace",command:"volume-up"}):be(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-play"))):o&&n==="A"?(e.preventDefault(),e.stopPropagation(),tn(),this.queueAnimatingPoints(!0),be()):o&&n==="S"&&this.controller.isListEnabled()?(e.preventDefault(),e.stopPropagation(),this.toggleSliderTrace()):o&&n==="C"?(e.preventDefault(),e.stopPropagation(),this.reportColor()):o&&this.exitAudioTrace();this.controller.dispatch({type:"render"})}describeCurve(){tn();let e=this.agNavigator.getCurrentSketch();if(!e){be(this.controller.s("graphing-calculator-narration-audio-trace-description-no-curve-selected"));return}At(this.controller.s("graphing-calculator-narration-audio-trace-description-color",{color:gg(this.controller,e.color)}));let t=gw(e,e.branches.length-1);t>1&&At(this.controller.s("graphing-calculator-narration-audio-trace-description-branch-count",{branches:t}));let i=!1,o=!1;for(let a of e.branches)if(t===1&&a.segments.length>0&&a.hasOwnProperty("operator")){if(a.graphMode===2){if(a.operator===">"||a.operator===">="){At(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-above"));break}else if(a.operator==="<"||a.operator==="<="){At(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-below"));break}}else if(a.graphMode===1){if(a.operator===">"||a.operator===">="){At(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-right"));break}else if(a.operator==="<"||a.operator==="<="){At(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-left"));break}}}else t>1&&(a.graphMode===2||a.graphMode===1?(a.operator==="<"||a.operator==="<="||a.operator===">"||a.operator===">=")&&(i=!0):a.graphMode===7&&(o=!0));i&&o&&At(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-in-regions"));let n=e.getPOI();if(n.length>0){let a=[];for(let s of n)a[s.type]===void 0?a[s.type]=1:a[s.type]+=1;a.forEach((s,l)=>{l===1001?At(s===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-intersection"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-intersections",{count:s})):l===1002?At(s===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-root"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-roots",{count:s})):l===1003?At(s===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-intercept"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-intercepts",{count:s})):l===1004?At(s===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-extremum"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-extrema",{count:s})):l===1008&&At(s===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-label"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-labels",{count:s}))})}be()}describeAxes(){tn(),be(mw(this.controller))}queueCoordinates(e,t,i=!1){if(!this.grapher.getProjection().viewport||!e)return;let n=this.agNavigator.getCurrentSketch();(e.hasOwnProperty("branch")&&n&&n.branches.length>1&&this.lastSpokenBranch!==e.reportedBranch||t==="branch")&&typeof e.reportedBranch=="number"&&At(this.controller.s("graphing-calculator-narration-audio-trace-property-branch-number",{branch:e.reportedBranch})),this.lastSpokenBranch=e.reportedBranch?e.reportedBranch:e.branch+1,e.hasOwnProperty("type")&&!t?At(this.controller.s("graphing-calculator-narration-audio-trace-property-type-before-coordinates",{type:this.describePOI(e)})):t==="type"&&At(this.describePOI(e)),(!t||t==="x")&&At(mi(this.controller,e.x)),(!t||t==="y")&&At(fi(this.controller,e.y)),i&&be()}describePOI(e){if(e.typeChain){let t=[];for(let i=0;i<e.typeChain.length;i++)t.push(this.poiTypeToText(e,i));return t.join(", ")}else return this.poiTypeToText(e)}poiTypeToText(e,t){switch(t&&e.typeChain?e.typeChain[t]:e.type){case 1001:let o=this.getIntersectingCurves(e);return o!==""?this.controller.s("graphing-calculator-narration-audio-trace-point-type-intersection-with-curves",{curves:o}):this.controller.s("graphing-calculator-narration-audio-trace-point-type-intersection");case 1002:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-root");case 1003:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-intercept");case 1004:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-extremum");case 1006:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-definition");case 1007:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-trace");case 1008:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-label");default:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-not-a-poi")}}getIntersectingCurves(e){return!e||!e.intersects?"":this.getExpressionAriaLabel(e.intersects)}getExpressionAriaLabel(e){let t=this.controller.getItemModel(e);return t?t.type==="expression"&&t.label?ka(t.label):t.type==="table"&&this.focusedCell?this.controller.s("graphing-calculator-narration-audio-trace-expression-with-column",{index:t.displayIndex,column:this.focusedCell.location.column+1}):_i(t,"describe"):""}exitAudioTrace(e){if(this.audioTraceActive){if(this.audioTraceActive=!1,this.controller.isKeypadEnabled()&&this.controller.dispatch({type:"keypad/123"}),e||(e=this.controller.s("graphing-calculator-text-audio-trace-off")),this.controller.dispatch({type:"toast/close"}),this.wasFocusInExpressionsView){let t=this.agNavigator.getSelectedItem();(!t||!this.controller.isItemSelectable(t.id))&&(t=this.controller.getFirstFullyVisibleItem()),t&&this.controller.isItemSelectable(t.id)&&this.controller.dispatch({type:"move-focus-to-item",id:t.id,where:t.type==="table"&&this.focusedCell!==void 0?__dcg_shared_module_exports__['a']({location:"cell"},this.focusedCell.location):"end"})}this.wasFocusInExpressionsView=!1,this.focusedCell=void 0,this.stopAnimations(),this.sliderTraceActive=!1,this.sliderIndex=0,this.agSynthesizer.stop(),this.agSynthesizer.releaseAudio(),this.agNavigator.reset(),this.lastSpokenBranch=1,this.grapher.traceLayer.setTraceInfo(void 0),this.grapher.traceLayer.setTraceLine(void 0),this.controller.requestRedrawGraph(),be(e),this.resumeAnimations()}}isFocusInExpressionsView(){return!!this.controller.getFocusedItem()}canAudioTraceCurrentExp(){let e=this.agNavigator.getSelectedItem();return e?e.type==="table"?!!this.agNavigator.getCurrentSketch():this.agNavigator.canTrace(e):!1}enterAudioTrace(e){let t=this.agNavigator.getSelectedItem(),i=t&&t.type!=="table"&&!this.agNavigator.canTrace(t)?this.getExpressionAriaLabel(t.id):void 0,o=!1;this.audioTraceActive||(this.wasFocusInExpressionsView=this.isFocusInExpressionsView(),t&&i&&At(this.controller.s("graphing-calculator-narration-audio-trace-unsupported-expression",{expression:i})),o=!!i||!this.wasFocusInExpressionsView);let n;if(o)n=this.agNavigator.getFirstTraceableSketch({selectAssociatedExpression:!0});else if(!i){if(t&&t.type==="expression"&&t.formula&&t.formula.error)return this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-narration-audio-trace-description-no-curve-selected")}});if(t&&t.type==="table"){let a=Sa(t);(!this.focusedCell||this.focusedCell.tableId!==t.id||a&&(a.column!==this.focusedCell.location.column||a.row!==this.focusedCell.location.row))&&(this.focusedCell=a!==void 0?{tableId:t.id,location:a}:void 0)}else this.focusedCell=void 0;n=this.agNavigator.getCurrentSketch()}if(!n){this.agNavigator.reset(),this.lastSpokenBranch=1,this.exitAudioTrace(),n=this.agNavigator.getCurrentSketch();let a=n==null?void 0:n.branches[0].graphMode;return a===8&&!Pr("audioTraceSimult")?(this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-audio-trace-no-implicit-support")}})):a===5&&!Pr("audioTraceSimult")?(this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-audio-trace-no-parametric-support")}})):a===6&&!Pr("audioTraceSimult")?(this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-audio-trace-no-polar-support")}})):this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-narration-audio-trace-description-no-curve-selected")}})}if(this.agNavigator.reset(),this.agNavigator.computeStepSizes(),this.lastSpokenBranch=1,this.grapher.traceLayer.clearOpenedPOI(),this.controller.requestRedrawGraph(),!this.audioTraceActive&&(this.controller.isKeypadEnabled()||this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-audio-trace-on"),noAria:!0,onHide:()=>this.exitAudioTrace(),hideAfter:0}}),i&&n&&At(this.controller.s("graphing-calculator-narration-audio-trace-tracing-different-expression",{expression:this.getExpressionAriaLabel(n.id)})),At(this.controller.s("graphing-calculator-text-audio-trace-on")),this.controller.getAudio()||At(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled")),this.pauseAnimations(),this.queueAnimatingPoints(!1),this.agSynthesizer.prepareSynthesizer(),(!e||!e.fromKeypad)&&(At(this.controller.s("graphing-calculator-narration-audio-trace-instructions-use-arrow-keys")),this.controller.getAudio()&&At(this.controller.s("graphing-calculator-narration-audio-trace-instructions-hear-graph")),this.agNavigator.getTraceableExpressionCount()>1&&(oi?At(this.controller.s("graphing-calculator-narration-audio-trace-instructions-expression-navigation-mac")):At(this.controller.s("graphing-calculator-narration-audio-trace-instructions-expression-navigation-windows"))),oi?At(this.controller.s("graphing-calculator-narration-audio-trace-instructions-disable-mac")):At(this.controller.s("graphing-calculator-narration-audio-trace-instructions-disable-windows"))),this.wasFocusInExpressionsView)){let a=this.controller.findEl(".dcg-graph-outer");a&&(H(a).one("focusin",()=>{setTimeout(()=>{be()},0)}),this.controller.dispatch({type:"set-focus-location",location:{type:"graph-paper"}}))}this.agNavigator.moveToOrigin(),At(this.getExpressionAriaLabel(n.id)),this.reportAudioTrace({playSound:!1}),this.wasFocusInExpressionsView||be(),this.audioTraceActive=!0,this.controller.isKeypadEnabled()&&this.controller.dispatch({type:"keypad/audio"})}checkIfSelectedItemChanged(e){this.lastSelectedId!==e&&(this.lastSelectedId=e,this.audioTraceActive&&(e?(At(this.getExpressionAriaLabel(e)),this.exitSliderTrace(),this.agNavigator.updatePOI(),this.agNavigator.moveToOrigin(),this.reportAudioTrace(),be()):this.exitAudioTrace()))}pauseAnimations(){this.sliderArray.length=0,this.controller.getAllModelsWithSliders().forEach(t=>{t.slider.isPlaying&&(this.controller.dispatch({type:"set-slider-isplaying",id:t.id,isPlaying:!1}),this.sliderArray.push(t))})}resumeAnimations(){if(this.sliderArray.length!==0){for(let e=0;e<this.sliderArray.length;e++){let t=this.sliderArray[e];t.slider.isPlaying!==!0&&this.controller.dispatch({type:"set-slider-isplaying",id:t.id,isPlaying:!0})}this.sliderArray.length=0}}stopAnimations(){this.controller.getAllModelsWithSliders().forEach(t=>{t.slider.isPlaying&&this.controller.dispatch({type:"set-slider-isplaying",id:t.id,isPlaying:!1})})}getAnimatingVars(){let e=[];for(let t=0;t<this.sliderArray.length;t++)e.push('"'+In(this.sliderArray[t])+'"');return e}hasActiveSliders(){let e=this.controller.getAllModelsWithSliders();for(let t=0;t<e.length;t++)if(e[t].slider.isPlaying)return!0;return!1}queueAnimatingPoints(e){this.sliderArray.length===1?At(this.controller.s("graphing-calculator-narration-audio-trace-one-slider-paused")):this.sliderArray.length>1?At(this.controller.s("graphing-calculator-narration-audio-trace-multiple-sliders-paused",{sliders:this.sliderArray.length})):e&&At(this.controller.s("graphing-calculator-narration-audio-trace-no-sliders-paused"))}queueSliderLatex(){this.hasActiveSliders()||this.agSynthesizer.stop();let e=this.getSelectedSlider();e?At(e.latex):At(this.controller.s("graphing-calculator-narration-audio-trace-slider-value-unknown"))}getSelectedSlider(){let e=this.controller.getAllModelsWithSliders();return this.sliderIndex<=e.length-1?e[this.sliderIndex]:null}incrementSliderValue(){this.adjustSlider("up")}decrementSliderValue(){this.adjustSlider("down")}incrementBigSliderValue(){this.adjustSlider("bigup")}decrementBigSliderValue(){this.adjustSlider("bigdown")}nextSlider(){this.adjustSlider("next")}prevSlider(){this.adjustSlider("prev")}sliderMin(){this.adjustSlider("min")}sliderMax(){this.adjustSlider("max")}adjustSlider(e){let t=this.getSelectedSlider();if(!t){At(this.controller.s("graphing-calculator-narration-audio-trace-cannot-change-slider-value"));return}let i=t.latex,o=this.controller.getAllModelsWithSliders().length;switch(e){case"up":case"down":case"bigup":case"bigdown":case"min":case"max":this.controller.dispatch({type:"adjust-slider-by-keyboard",id:t.id,adjustment:e}),this.queueSliderLatex(),be();break;case"next":this.sliderIndex++,this.sliderIndex>=o&&(At(this.controller.s("graphing-calculator-narration-audio-trace-last-slider")),this.sliderIndex=o-1),this.queueSliderLatex(),be();return;case"prev":this.sliderIndex--,this.sliderIndex<0&&(At(this.controller.s("graphing-calculator-narration-audio-trace-first-slider")),this.sliderIndex=0),this.queueSliderLatex(),be();return}!t.slider.isPlaying&&i!==t.latex&&(this.queueSliderLatex(),be())}toggleAudioTrace(){this.audioTraceActive?this.exitAudioTrace():this.enterAudioTrace()}toggleSliderTrace(){this.sliderTraceActive?this.exitSliderTrace():this.enterSliderTrace()}enterSliderTrace(){if(this.sliderTraceActive)return;this.sliderIndex=0,this.controller.getAllModelsWithSliders().length!==0?(At(this.controller.s("graphing-calculator-narration-slider-trace-on")),this.queueSliderLatex(),this.sliderTraceActive=!0):(At(this.controller.s("graphing-calculator-narration-slider-trace-no-sliders")),this.sliderTraceActive=!1),be()}exitSliderTrace(){this.sliderTraceActive&&(At(this.controller.s("graphing-calculator-narration-slider-trace-off")),this.sliderTraceActive=!1,this.sliderIndex=0,be())}recomputePoints(){!this.audioTraceActive||this.agSynthesizer.getIsPlaying()||(this.agNavigator.updatePOI(),this.agNavigator.updateSampledPoints(),this.agNavigator.updateCurrentPoint(),this.agNavigator.resetTracePoint(),this.agNavigator.computeStepSizes())}reportAndMoveToPrevPoint(){tn(),this.agNavigator.prevPoint(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToNextPoint(){tn(),this.agNavigator.nextPoint(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToOrigin(){tn(),this.agNavigator.moveToOrigin(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToPrevPOI(){tn(),this.agNavigator.prevPOI(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToNextPOI(){tn(),this.agNavigator.nextPOI(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToFirstPoint(){tn(),this.agNavigator.firstPoint(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToLastPoint(){tn(),this.agNavigator.lastPoint(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportX(){tn(),this.reportAudioTrace({propToSpeak:"x",playSound:!1})}reportY(){tn(),this.reportAudioTrace({propToSpeak:"y",playSound:!1})}reportColor(){tn();let e=this.agNavigator.getCurrentSketch();e?At(gg(this.controller,e.color)):At(this.controller.s("graphing-calculator-narration-color-unknown")),be()}reportPOICount(){tn();let e=this.agNavigator.getCurrentSketch(),t=e?e.getPOI().length:0;be(this.controller.s("graphing-calculator-narration-audio-trace-poi-count",{x:t}))}reportType(){tn(),this.reportAudioTrace({propToSpeak:"type",playSound:!1})}reportBranch(){tn(),this.reportAudioTrace({propToSpeak:"branch",playSound:!1})}describePoint(){tn(),this.reportAudioTrace({playSound:!1}),be()}playCurrentPoint(){let e=this.agNavigator.getCurrentPoint();e&&this.agSynthesizer.playPoint(e)}reportAudioTrace(e){let t=this.agNavigator.getCurrentPoint();if(!t)return;let i=e&&e.propToSpeak,o=this.controller.getAudio()&&this.agSynthesizer.getPlaybackSupported()&&(e&&e.playSound!==void 0?e.playSound:!0),n=e&&e.speakCoordinates!==void 0?e.speakCoordinates:!0;this.agSynthesizer.stop(),o&&this.playCurrentPoint(),n&&(this.queueCoordinates(t,i),setTimeout(function(){be()},i?0:100))}adjustPlaybackSpeed(e){if(!this.controller.getAudio()){be(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"));return}if(e<0||e>=bw.length)return;this.audioSpeedIndex=e;let t=bw[e];return this.agSynthesizer.setAudioSpeed(t.speed),be(this.controller.s("graphing-calculator-narration-audio-trace-playback-speed",{speed:t.displayedSpeed}))}speedUp(){this.adjustPlaybackSpeed(this.audioSpeedIndex+1)}speedDown(){this.adjustPlaybackSpeed(this.audioSpeedIndex-1)}adjustVolume(e){if(tn(),!this.controller.getAudio()){be(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"));return}let t=this.agSynthesizer.getAudioVolume(),i=e==="up"?Math.min(100,Math.round((t+.1)*100)):Math.max(0,Math.round((t-.1)*100));this.agSynthesizer.setAudioVolume(i/100),this.playCurrentPoint(),be(this.controller.s("graphing-calculator-narration-audio-trace-volume",{volume:i}))}getFocusedCell(){return this.focusedCell}setFocusedCell(e){this.focusedCell=e}getAudioTraceActive(){return this.audioTraceActive}isAudioTracing(){return!!this.agSynthesizer&&this.agSynthesizer.getIsPlaying()}handleEvaluatorChange(e){}hearGraph(){var e,t;if(tn(),!this.controller.getAudio()){be(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"));return}if(this.agSynthesizer.getPlaybackSupported()){this.agSynthesizer.stop();let i=this.agNavigator.getCurrentSketch();if((t=(e=this.controller).logJSON)==null||t.call(e,"audio-trace::hear-graph",{}),i&&Il(this.controller,i)){let o=Pr("audioTraceSimult")?"simultaneous":"sequential";this.agSynthesizer.playCurrentSketch(o),o==="simultaneous"?(this.grapher.traceLayer.setTraceInfo(void 0),requestAnimationFrame(()=>this.animateCurrentSketchLine())):(this.grapher.traceLayer.setTraceLine(void 0),requestAnimationFrame(()=>this.animateCurrentSketchPoint()))}else be(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-trace-this-expression"))}else be(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-play"))}animateCurrentSketchPoint(){if(this.graphAnimationTimeoutId&&cancelAnimationFrame(this.graphAnimationTimeoutId),this.graphAnimationTimeoutId=requestAnimationFrame(()=>this.animateCurrentSketchPoint()),!this.agSynthesizer.getIsPlaying())return;let e=this.agSynthesizer.getCurrentIndependentValue(),t=this.agSynthesizer.getCurrentBranchIndex();e!==void 0&&t!==void 0&&this.agNavigator.drawTracePoint(this.agNavigator.getPoint(t,e))}animateCurrentSketchLine(){if(this.graphAnimationTimeoutId&&cancelAnimationFrame(this.graphAnimationTimeoutId),this.graphAnimationTimeoutId=requestAnimationFrame(()=>this.animateCurrentSketchLine()),!this.agSynthesizer.getIsPlaying())return;let e=this.agSynthesizer.getCurrentIndependentValue();e!==void 0&&this.agNavigator.drawTraceLine(e,this.agSynthesizer.getGraphMode())}stopGraph(){this.agSynthesizer.stop(),this.graphAnimationTimeoutId&&cancelAnimationFrame(this.graphAnimationTimeoutId)}getAudioSpeedIndex(){return this.audioSpeedIndex}getAudioVolume(){var e;return(e=this.agSynthesizer.getAudioVolume())!=null?e:.5}};var Xd={};__dcg_shared_module_exports__['g'](Xd,{UnicodeBraille:()=>Ba,latexToNemeth:()=>Xp,latexToUeb:()=>Qp,nemethToLatex:()=>IA,uebToLatex:()=>VA,version:()=>FX});var s8=Object.defineProperty,XY=Object.getOwnPropertyNames,$q=Object.getOwnPropertySymbols,QY=Object.prototype.hasOwnProperty,ZY=Object.prototype.propertyIsEnumerable,jq=(r,e,t)=>e in r?s8(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ub=(r,e)=>{for(var t in e||(e={}))QY.call(e,t)&&jq(r,t,e[t]);if($q)for(var t of $q(e))ZY.call(e,t)&&jq(r,t,e[t]);return r},hb=(r=>typeof __dcg_shared_module_exports__['c']!="undefined"?__dcg_shared_module_exports__['c']:typeof Proxy!="undefined"?new Proxy(r,{get:(e,t)=>(typeof __dcg_shared_module_exports__['c']!="undefined"?__dcg_shared_module_exports__['c']:e)[t]}):r)(function(r){if(typeof __dcg_shared_module_exports__['c']!="undefined")return __dcg_shared_module_exports__['c'].apply(this,arguments);throw new Error('Dynamic require of "'+r+'" is not supported')}),yA=(r,e)=>function(){return e||(0,r[XY(r)[0]])((e={exports:{}}).exports,e),e.exports},xA=(r,e)=>{for(var t in e)s8(r,t,{get:e[t],enumerable:!0})},eJ=yA({"generated/latex.jison.js"(r,e){"use strict";var t=function(){var i=function(ne,X,b,A){for(b=b||{},A=ne.length;A--;b[ne[A]]=X);return b},o=[1,13],n=[1,14],a=[1,15],s=[1,16],l=[1,17],c=[1,21],p=[1,18],u=[1,19],m=[1,20],h=[1,22],x=[1,23],C=[1,28],D=[1,30],k=[1,31],M=[1,32],I=[1,33],S=[1,29],V=[5,21,27,38],P=[5,19,21,22,23,24,25,26,27,28,32,33,34,35,36,37,38],L=[5,10,12,13,14,19,21,22,23,24,25,26,27,28,32,33,34,35,36,37,38],B=[5,10,19,21,22,23,24,25,26,27,28,32,33,34,35,36,37,38],R={trace:function(){},yy:{},symbols_:{error:2,sentence:3,group:4,EOF:5,level:6,expression:7,subscript:8,superscript:9,_:10,atom:11,"^":12,"PRIMES^":13,PRIMES:14,delimited_group:15,typeform:16,frac:17,radical:18,LEFT:19,delimiter:20,RIGHT:21,FRAC:22,OPERATOR_NAME:23,MATHRM:24,TEXT:25,RADICAL_OPTARG:26,CLOSE_OPTARG:27,RADICAL:28,curly_group:29,greek:30,command:31,SYMBOL:32,DELIMITER:33,DELIMITER_COMMAND:34,GREEK:35,COMMAND:36,"{":37,"}":38,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",10:"_",12:"^",13:"PRIMES^",14:"PRIMES",19:"LEFT",21:"RIGHT",22:"FRAC",23:"OPERATOR_NAME",24:"MATHRM",25:"TEXT",26:"RADICAL_OPTARG",27:"CLOSE_OPTARG",28:"RADICAL",32:"SYMBOL",33:"DELIMITER",34:"DELIMITER_COMMAND",35:"GREEK",36:"COMMAND",37:"{",38:"}"},productions_:[0,[3,2],[3,1],[4,3],[4,2],[4,1],[4,2],[4,1],[6,2],[6,2],[6,1],[6,1],[8,2],[9,2],[9,2],[9,1],[7,1],[7,1],[7,1],[7,1],[7,1],[15,5],[15,4],[17,3],[16,2],[16,2],[16,2],[18,4],[18,3],[18,2],[18,2],[11,1],[11,1],[11,1],[11,1],[11,1],[20,1],[20,1],[30,1],[31,1],[29,3],[29,2]],performAction:function(X,b,A,E,J,j,ce){var te=j.length-1;switch(J){case 1:return j[te-1];case 2:return E.group();case 3:this.$=E.group(j[te-2],j[te-1],j[te]);break;case 4:case 6:this.$=E.group(j[te-1],j[te]);break;case 5:case 7:this.$=E.group(j[te]);break;case 8:this.$=E.level({_:E.group(j[te-1]),"^":E.group(j[te])});break;case 9:this.$=E.level({_:E.group(j[te]),"^":E.group(j[te-1])});break;case 10:this.$=E.level({"^":E.group(j[te])});break;case 11:this.$=E.level({_:E.group(j[te])});break;case 12:case 13:this.$=j[te];break;case 14:this.$=E.processPrimes(j[te-1],j[te]);break;case 15:this.$=E.processPrimes(j[te],E.group());break;case 21:this.$=E.group(j[te-3],j[te-2],j[te]);break;case 22:this.$=E.group(j[te-2],j[te]);break;case 23:this.$=E.fraction(E.group(j[te-1]),E.group(j[te]));break;case 24:this.$=E.typeform("operator_name",E.group(j[te]));break;case 25:this.$=E.typeform("mathrm",E.group(j[te]));break;case 26:this.$=E.typeform("text",E.group(j[te]));break;case 27:this.$=E.radical(j[te],E.group(j[te-2]));break;case 28:this.$=E.radical(E.group(j[te]),E.group());break;case 29:case 30:this.$=E.radical(E.group(j[te]));break;case 35:case 36:this.$=E.terminal(j[te]);break;case 37:case 39:this.$=E.command(j[te]);break;case 38:this.$=E.greek(j[te]);break;case 40:this.$=j[te-1];break;case 41:this.$=E.group();break}},table:[{3:1,4:2,5:[1,3],6:4,7:5,8:6,9:7,10:o,11:12,12:n,13:a,14:s,15:8,16:9,17:10,18:11,19:l,20:25,22:c,23:p,24:u,25:m,26:h,28:x,29:24,30:26,31:27,32:C,33:D,34:k,35:M,36:I,37:S},{1:[3]},{5:[1,34]},{1:[2,2]},i(V,[2,5],{15:8,16:9,17:10,18:11,11:12,29:24,20:25,30:26,31:27,7:35,19:l,22:c,23:p,24:u,25:m,26:h,28:x,32:C,33:D,34:k,35:M,36:I,37:S}),i(V,[2,7],{6:4,7:5,8:6,9:7,15:8,16:9,17:10,18:11,11:12,29:24,20:25,30:26,31:27,4:36,10:o,12:n,13:a,14:s,19:l,22:c,23:p,24:u,25:m,26:h,28:x,32:C,33:D,34:k,35:M,36:I,37:S}),i(P,[2,11],{9:37,12:n,13:a,14:s}),i(P,[2,10],{8:38,10:o}),i(L,[2,16]),i(L,[2,17]),i(L,[2,18]),i(L,[2,19]),i(L,[2,20]),{11:39,20:25,29:24,30:26,31:27,32:C,33:D,34:k,35:M,36:I,37:S},{11:40,20:25,29:24,30:26,31:27,32:C,33:D,34:k,35:M,36:I,37:S},{11:41,20:25,29:24,30:26,31:27,32:C,33:D,34:k,35:M,36:I,37:S},i(B,[2,15]),{20:42,33:D,34:k},{11:43,20:25,29:24,30:26,31:27,32:C,33:D,34:k,35:M,36:I,37:S},{11:44,20:25,29:24,30:26,31:27,32:C,33:D,34:k,35:M,36:I,37:S},{11:45,20:25,29:24,30:26,31:27,32:C,33:D,34:k,35:M,36:I,37:S},{11:46,20:25,29:24,30:26,31:27,32:C,33:D,34:k,35:M,36:I,37:S},{4:47,6:4,7:5,8:6,9:7,10:o,11:12,12:n,13:a,14:s,15:8,16:9,17:10,18:11,19:l,20:25,22:c,23:p,24:u,25:m,26:h,27:[1,48],28:x,29:24,30:26,31:27,32:C,33:D,34:k,35:M,36:I,37:S},{11:49,17:50,20:25,22:c,29:24,30:26,31:27,32:C,33:D,34:k,35:M,36:I,37:S},i(L,[2,31]),i(L,[2,32]),i(L,[2,33]),i(L,[2,34]),i(L,[2,35]),{4:51,6:4,7:5,8:6,9:7,10:o,11:12,12:n,13:a,14:s,15:8,16:9,17:10,18:11,19:l,20:25,22:c,23:p,24:u,25:m,26:h,28:x,29:24,30:26,31:27,32:C,33:D,34:k,35:M,36:I,37:S,38:[1,52]},i(L,[2,36]),i(L,[2,37]),i(L,[2,38]),i(L,[2,39]),{1:[2,1]},i(V,[2,4],{6:4,7:5,8:6,9:7,15:8,16:9,17:10,18:11,11:12,29:24,20:25,30:26,31:27,4:53,10:o,12:n,13:a,14:s,19:l,22:c,23:p,24:u,25:m,26:h,28:x,32:C,33:D,34:k,35:M,36:I,37:S}),i(V,[2,6]),i(P,[2,8]),i(P,[2,9]),i([5,12,13,14,19,21,22,23,24,25,26,27,28,32,33,34,35,36,37,38],[2,12]),i(B,[2,13]),i(B,[2,14]),{4:54,6:4,7:5,8:6,9:7,10:o,11:12,12:n,13:a,14:s,15:8,16:9,17:10,18:11,19:l,20:25,21:[1,55],22:c,23:p,24:u,25:m,26:h,28:x,29:24,30:26,31:27,32:C,33:D,34:k,35:M,36:I,37:S},i(L,[2,24]),i(L,[2,25]),i(L,[2,26]),{11:56,20:25,29:24,30:26,31:27,32:C,33:D,34:k,35:M,36:I,37:S},{27:[1,57]},{11:58,20:25,29:24,30:26,31:27,32:C,33:D,34:k,35:M,36:I,37:S},i(L,[2,29]),i(L,[2,30]),{38:[1,59]},i(L,[2,41]),i(V,[2,3]),{21:[1,60]},{20:61,33:D,34:k},i(L,[2,23]),{11:62,20:25,29:24,30:26,31:27,32:C,33:D,34:k,35:M,36:I,37:S},i(L,[2,28]),i(L,[2,40]),{20:63,33:D,34:k},i(L,[2,22]),i(L,[2,27]),i(L,[2,21])],defaultActions:{3:[2,2],34:[2,1]},parseError:function(X,b){if(b.recoverable)this.trace(X);else{var A=new Error(X);throw A.hash=b,A}},parse:function(X){var b=this,A=[0],E=[],J=[null],j=[],ce=this.table,te="",pe=0,he=0,ae=0,ie=2,de=1,Ie=j.slice.call(arguments,1),Se=Object.create(this.lexer),ot={yy:{}};for(var Ze in this.yy)Object.prototype.hasOwnProperty.call(this.yy,Ze)&&(ot.yy[Ze]=this.yy[Ze]);Se.setInput(X,ot.yy),ot.yy.lexer=Se,ot.yy.parser=this,typeof Se.yylloc=="undefined"&&(Se.yylloc={});var at=Se.yylloc;j.push(at);var Vt=Se.options&&Se.options.ranges;typeof ot.yy.parseError=="function"?this.parseError=ot.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function Dt(wi){A.length=A.length-2*wi,J.length=J.length-wi,j.length=j.length-wi}for(var Mr=function(){var wi;return wi=Se.lex()||de,typeof wi!="number"&&(wi=b.symbols_[wi]||wi),wi},Ot,Le,fo,Wi,fe,Yo,tt={},ft,gt,xe,Pt;;){if(fo=A[A.length-1],this.defaultActions[fo]?Wi=this.defaultActions[fo]:((Ot===null||typeof Ot=="undefined")&&(Ot=Mr()),Wi=ce[fo]&&ce[fo][Ot]),typeof Wi=="undefined"||!Wi.length||!Wi[0]){var Fe="";Pt=[];for(ft in ce[fo])this.terminals_[ft]&&ft>ie&&Pt.push("'"+this.terminals_[ft]+"'");Se.showPosition?Fe="Parse error on line "+(pe+1)+`:
`+Se.showPosition()+`
Expecting `+Pt.join(", ")+", got '"+(this.terminals_[Ot]||Ot)+"'":Fe="Parse error on line "+(pe+1)+": Unexpected "+(Ot==de?"end of input":"'"+(this.terminals_[Ot]||Ot)+"'"),this.parseError(Fe,{text:Se.match,token:this.terminals_[Ot]||Ot,line:Se.yylineno,loc:at,expected:Pt})}if(Wi[0]instanceof Array&&Wi.length>1)throw new Error("Parse Error: multiple actions possible at state: "+fo+", token: "+Ot);switch(Wi[0]){case 1:A.push(Ot),J.push(Se.yytext),j.push(Se.yylloc),A.push(Wi[1]),Ot=null,Le?(Ot=Le,Le=null):(he=Se.yyleng,te=Se.yytext,pe=Se.yylineno,at=Se.yylloc,ae>0&&ae--);break;case 2:if(gt=this.productions_[Wi[1]][1],tt.$=J[J.length-gt],tt._$={first_line:j[j.length-(gt||1)].first_line,last_line:j[j.length-1].last_line,first_column:j[j.length-(gt||1)].first_column,last_column:j[j.length-1].last_column},Vt&&(tt._$.range=[j[j.length-(gt||1)].range[0],j[j.length-1].range[1]]),Yo=this.performAction.apply(tt,[te,he,pe,ot.yy,Wi[1],J,j].concat(Ie)),typeof Yo!="undefined")return Yo;gt&&(A=A.slice(0,-1*gt*2),J=J.slice(0,-1*gt),j=j.slice(0,-1*gt)),A.push(this.productions_[Wi[1]][0]),J.push(tt.$),j.push(tt._$),xe=ce[A[A.length-2]][A[A.length-1]],A.push(xe);break;case 3:return!0}}return!0}},W=function(){var ne={EOF:1,parseError:function(b,A){if(this.yy.parser)this.yy.parser.parseError(b,A);else throw new Error(b)},setInput:function(X,b){return this.yy=b||this.yy||{},this._input=X,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var X=this._input[0];this.yytext+=X,this.yyleng++,this.offset++,this.match+=X,this.matched+=X;var b=X.match(/(?:\r\n?|\n).*/g);return b?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),X},unput:function(X){var b=X.length,A=X.split(/(?:\r\n?|\n)/g);this._input=X+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-b),this.offset-=b;var E=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),A.length-1&&(this.yylineno-=A.length-1);var J=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:A?(A.length===E.length?this.yylloc.first_column:0)+E[E.length-A.length].length-A[0].length:this.yylloc.first_column-b},this.options.ranges&&(this.yylloc.range=[J[0],J[0]+this.yyleng-b]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(X){this.unput(this.match.slice(X))},pastInput:function(){var X=this.matched.substr(0,this.matched.length-this.match.length);return(X.length>20?"...":"")+X.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var X=this.match;return X.length<20&&(X+=this._input.substr(0,20-X.length)),(X.substr(0,20)+(X.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var X=this.pastInput(),b=new Array(X.length+1).join("-");return X+this.upcomingInput()+`
`+b+"^"},test_match:function(X,b){var A,E,J;if(this.options.backtrack_lexer&&(J={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(J.yylloc.range=this.yylloc.range.slice(0))),E=X[0].match(/(?:\r\n?|\n).*/g),E&&(this.yylineno+=E.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:E?E[E.length-1].length-E[E.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+X[0].length},this.yytext+=X[0],this.match+=X[0],this.matches=X,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(X[0].length),this.matched+=X[0],A=this.performAction.call(this,this.yy,this,b,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),A)return A;if(this._backtrack){for(var j in J)this[j]=J[j];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var X,b,A,E;this._more||(this.yytext="",this.match="");for(var J=this._currentRules(),j=0;j<J.length;j++)if(A=this._input.match(this.rules[J[j]]),A&&(!b||A[0].length>b[0].length)){if(b=A,E=j,this.options.backtrack_lexer){if(X=this.test_match(A,J[j]),X!==!1)return X;if(this._backtrack){b=!1;continue}else return!1}else if(!this.options.flex)break}return b?(X=this.test_match(b,J[E]),X!==!1?X:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var b=this.next();return b||this.lex()},begin:function(b){this.conditionStack.push(b)},popState:function(){var b=this.conditionStack.length-1;return b>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(b){return b=this.conditionStack.length-1-Math.abs(b||0),b>=0?this.conditionStack[b]:"INITIAL"},pushState:function(b){this.begin(b)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(b,A,E,J){var j=J;switch(E){case 0:break;case 1:return this.begin("optarg"),26;break;case 2:return this.popState(),27;break;case 3:return 23;case 4:return 24;case 5:return 25;case 6:return 28;case 7:return 22;case 8:return 13;case 9:return 14;case 10:return 12;case 11:return 10;case 12:return 19;case 13:return 21;case 14:return 34;case 15:return 33;case 16:return 37;case 17:return 38;case 18:return 32;case 19:return 32;case 20:return 32;case 21:return 35;case 22:return 35;case 23:return 36;case 24:return 32;case 25:return 5}},rules:[/^(?:\s+)/,/^(?:(\\sqrt)\s*\[)/,/^(?:\])/,/^(?:(\\operatorname))/,/^(?:(\\mathrm))/,/^(?:(\\text))/,/^(?:(\\sqrt))/,/^(?:(\\frac))/,/^(?:'+\^)/,/^(?:'+)/,/^(?:\^)/,/^(?:[_])/,/^(?:(\\left))/,/^(?:(\\right))/,/^(?:(\\langle|\\rangle|\\vert|\\Vert))/,/^(?:\[|\]|\\\{|\\\}|\(|\)|\||\\\|)/,/^(?:\{)/,/^(?:\})/,/^(?:\\(infty))/,/^(?:\\(int))/,/^(?:!)/,/^(?:\\(alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|omicron|pi|rho|sigma|tau|xi|upsilon|phi|chi|psi|omega))/,/^(?:\\(Alpha|Beta|Gamma|Delta|Epsilon|Zeta|Eta|Theta|Iota|Kappa|Lambda|Mu|Nu|Omicron|Pi|Rho|Sigma|Tau|Xi|Upsilon|Phi|Chi|Psi|Omega))/,/^(?:\\[A-Za-z]+)/,/^(?:\\.|.)/,/^(?:$)/],conditions:{optarg:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],inclusive:!0},INITIAL:{rules:[0,1,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],inclusive:!0}}};return ne}();R.lexer=W;function re(){this.yy={}}return re.prototype=R,R.Parser=re,new re}();typeof hb!="undefined"&&typeof r!="undefined"&&(r.parser=t,r.Parser=t.Parser,r.parse=function(){return t.parse.apply(t,arguments)},r.main=function(){},typeof e!="undefined"&&hb.main===e&&r.main(process.argv.slice(1)))}}),l8=yA({"generated/nemeth-to-latex.jison.js"(r,e){"use strict";var t=function(){var i=function(Yo,tt,ft,gt){for(ft=ft||{},gt=Yo.length;gt--;ft[Yo[gt]]=tt);return ft},o=[1,11],n=[1,12],a=[1,13],s=[1,71],l=[1,72],c=[1,70],p=[1,38],u=[1,39],m=[1,60],h=[1,61],x=[1,62],C=[1,63],D=[1,64],k=[1,65],M=[1,66],I=[1,67],S=[1,68],V=[1,69],P=[1,40],L=[1,34],B=[1,35],R=[1,36],W=[1,37],re=[1,41],ne=[1,42],X=[1,43],b=[1,44],A=[1,45],E=[1,46],J=[1,47],j=[1,48],ce=[1,49],te=[1,50],pe=[1,51],he=[1,52],ae=[1,53],ie=[1,54],de=[1,17],Ie=[1,55],Se=[1,56],ot=[1,57],Ze=[1,58],at=[1,59],Vt=[5,12,13,14,18,24,25],Dt=[5,11,12,13,14,15,17,18,20,21,23,24,25,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,83],Mr=[1,76],Ot=[5,11,12,13,14,15,17,18,20,21,23,24,25,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,78,79,80,81,83],Le=[5,11,12,13,14,15,17,18,20,21,23,24,25,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83],fo={trace:function(){},yy:{},symbols_:{error:2,sentence:3,group:4,EOF:5,element:6,index_element:7,modified_expression:8,radical:9,primes:10,OPEN_MODEXP:11,MODEXP_UNDER:12,MODEXP_OVER:13,CLOSE_MODEXP:14,RADICAL_INDEX:15,index_group:16,OPEN_RADICAL:17,CLOSE_RADICAL:18,level:19,LEVEL:20,BASELINE:21,frac:22,OPEN_FRAC:23,SLASH:24,CLOSE_FRAC:25,subscript_head:26,number:27,atom:28,command:29,greek:30,letter:31,comma:32,period:33,space:34,operation:35,comparison:36,level_with_comparison:37,ellipsis:38,colon:39,infinity:40,integral:41,factorial:42,ampersand:43,question_mark:44,bracket:45,",":46,".":47,"[":48,"{":49,"(":50,"]":51,"}":52,")":53,LANGLE:54,RANGLE:55,PIPE:56,DOUBLE_PIPE:57,SPACE:58,COMMAND:59,GREEK:60,LETTER:61,CAPITAL_LETTER:62,"+":63,"-":64,CDOT:65,TIMES:66,"*":67,"/":68,DIV:69,PERCENT_OF:70,PERCENT:71,TO:72,COMPARISON:73,LEVEL_WITH_COMPARISON:74,ELLIPSIS:75,COLON:76,NUMBER:77,INFINITY:78,INTEGRAL:79,FACTORIAL:80,"&":81,PRIMES:82,"?":83,unknown:84,UNKNOWN:85,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",11:"OPEN_MODEXP",12:"MODEXP_UNDER",13:"MODEXP_OVER",14:"CLOSE_MODEXP",15:"RADICAL_INDEX",17:"OPEN_RADICAL",18:"CLOSE_RADICAL",20:"LEVEL",21:"BASELINE",23:"OPEN_FRAC",24:"SLASH",25:"CLOSE_FRAC",46:",",47:".",48:"[",49:"{",50:"(",51:"]",52:"}",53:")",54:"LANGLE",55:"RANGLE",56:"PIPE",57:"DOUBLE_PIPE",58:"SPACE",59:"COMMAND",60:"GREEK",61:"LETTER",62:"CAPITAL_LETTER",63:"+",64:"-",65:"CDOT",66:"TIMES",67:"*",68:"/",69:"DIV",70:"PERCENT_OF",71:"PERCENT",72:"TO",73:"COMPARISON",74:"LEVEL_WITH_COMPARISON",75:"ELLIPSIS",76:"COLON",77:"NUMBER",78:"INFINITY",79:"INTEGRAL",80:"FACTORIAL",81:"&",82:"PRIMES",83:"?",85:"UNKNOWN"},productions_:[0,[3,2],[3,1],[4,2],[4,1],[6,1],[6,1],[6,2],[6,1],[8,7],[8,6],[8,5],[8,6],[8,5],[8,5],[8,4],[8,4],[8,3],[8,4],[8,4],[8,4],[8,4],[8,3],[8,3],[8,2],[9,5],[9,4],[9,4],[9,3],[9,3],[9,2],[19,1],[19,1],[22,5],[22,4],[22,4],[22,3],[16,2],[16,1],[7,3],[7,2],[7,2],[7,3],[7,2],[7,2],[7,1],[7,1],[7,1],[26,1],[26,1],[26,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[32,1],[33,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[34,1],[29,1],[30,1],[31,1],[31,1],[35,1],[35,1],[35,1],[35,1],[35,1],[35,1],[35,1],[35,1],[35,1],[35,1],[36,1],[37,1],[38,1],[39,1],[27,1],[40,1],[41,1],[42,1],[43,1],[10,1],[44,1],[84,1]],performAction:function(tt,ft,gt,xe,Pt,Fe,wi){var Ce=Fe.length-1;switch(Pt){case 1:return Fe[Ce-1];case 2:return xe.group();case 3:case 37:case 41:case 43:case 44:this.$=xe.group(Fe[Ce-1],Fe[Ce]);break;case 4:case 38:this.$=xe.group(Fe[Ce]);break;case 7:this.$=xe.group(Fe[Ce-1],Fe[Ce]);break;case 9:this.$=xe.modified_expression(Fe[Ce-5],Fe[Ce-3],Fe[Ce-1]);break;case 10:this.$=xe.modified_expression(Fe[Ce-4],Fe[Ce-2]);break;case 11:this.$=xe.modified_expression(Fe[Ce-3],Fe[Ce-1]);break;case 12:this.$=xe.modified_expression(Fe[Ce-4],xe.group(),Fe[Ce-1]);break;case 13:this.$=xe.modified_expression(Fe[Ce-3],xe.group(),Fe[Ce-1]);break;case 14:this.$=xe.modified_expression(Fe[Ce-3],xe.group(),xe.group());break;case 15:case 16:this.$=xe.modified_expression(Fe[Ce-2],xe.group());break;case 17:this.$=xe.modified_expression(Fe[Ce-1]);break;case 18:case 19:case 22:case 23:case 24:this.$=xe.modified_expression(xe.group());break;case 20:case 21:xe.warnOrError("Multi-level modified expressions are not supported."),this.$=xe.modified_expression(xe.group());break;case 25:this.$=xe.radical(Fe[Ce-1],Fe[Ce-3]);break;case 26:this.$=xe.radical(Fe[Ce-1],xe.group());break;case 27:this.$=xe.radical(xe.group(),Fe[Ce-2]);break;case 28:this.$=xe.radical(xe.group(),xe.group());break;case 29:this.$=xe.radical(Fe[Ce-1]);break;case 30:this.$=xe.radical(xe.group());break;case 31:this.$=xe.level(Fe[Ce]);break;case 32:this.$=xe.baseline();break;case 33:this.$=xe.fraction(Fe[Ce-3],Fe[Ce-1]);break;case 34:this.$=xe.fraction(Fe[Ce-2],xe.group());break;case 35:this.$=xe.fraction(xe.group(),Fe[Ce-1]);break;case 36:this.$=xe.fraction(xe.group(),xe.group());break;case 39:this.$=xe.group(xe.simple_subscript(Fe[Ce-2],Fe[Ce]),Fe[Ce-1]);break;case 40:this.$=xe.simple_subscript(Fe[Ce-1],Fe[Ce]);break;case 42:xe.warnOrError("Illegal use of Nemeth primes"),this.$=xe.group(xe.simple_subscript(Fe[Ce-2],Fe[Ce-1]),Fe[Ce]);break;case 67:this.$=xe.terminal(",");break;case 68:this.$=xe.terminal(".");break;case 69:this.$=xe.terminal("[");break;case 70:this.$=xe.terminal("\\{");break;case 71:this.$=xe.terminal("(");break;case 72:this.$=xe.terminal("]");break;case 73:this.$=xe.terminal("\\}");break;case 74:this.$=xe.terminal(")");break;case 75:this.$=xe.terminal("\\langle ");break;case 76:this.$=xe.terminal("\\rangle ");break;case 77:this.$=xe.terminal("|");break;case 78:this.$=xe.terminal("\\|");break;case 79:this.$=xe.terminal(" ");break;case 80:this.$=xe.command(Fe[Ce].toLowerCase());break;case 81:this.$=xe.terminal(xe.greek(Fe[Ce]));break;case 82:this.$=xe.terminal(Fe[Ce].toLowerCase());break;case 83:this.$=xe.terminal(Fe[Ce].toUpperCase());break;case 84:this.$=xe.terminal("+");break;case 85:this.$=xe.terminal("-");break;case 86:this.$=xe.terminal("\\cdot ");break;case 87:this.$=xe.terminal("\\times ");break;case 88:this.$=xe.terminal("*");break;case 89:this.$=xe.terminal("/");break;case 90:this.$=xe.terminal("\\div ");break;case 91:this.$=xe.terminal("\\%\\operatorname{of}");break;case 92:this.$=xe.terminal("\\%");break;case 93:this.$=xe.terminal("\\to ");break;case 94:this.$=xe.comparison(Fe[Ce].trim());break;case 95:this.$=xe.level_with_comparison(Fe[Ce].trim());break;case 96:this.$=xe.terminal("\\ldots ");break;case 97:this.$=xe.terminal(":");break;case 98:this.$=xe.terminal(Fe[Ce]);break;case 99:this.$=xe.terminal("\\infty ");break;case 100:this.$=xe.terminal("\\int ");break;case 101:this.$=xe.terminal("!");break;case 102:this.$=xe.terminal("\\&");break;case 103:this.$=xe.primes(Fe[Ce]);break;case 104:this.$=xe.terminal("?");break}},table:[{3:1,4:2,5:[1,3],6:4,7:5,8:6,9:7,11:o,15:n,17:a,19:33,20:s,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:p,47:u,48:m,49:h,50:x,51:C,52:D,53:k,54:M,55:I,56:S,57:V,58:P,59:L,60:B,61:R,62:W,63:re,64:ne,65:X,66:b,67:A,68:E,69:J,70:j,71:ce,72:te,73:pe,74:he,75:ae,76:ie,77:de,78:Ie,79:Se,80:ot,81:Ze,83:at},{1:[3]},{5:[1,73]},{1:[2,2]},i(Vt,[2,4],{6:4,7:5,8:6,9:7,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,22:32,19:33,4:74,11:o,15:n,17:a,20:s,21:l,23:c,46:p,47:u,48:m,49:h,50:x,51:C,52:D,53:k,54:M,55:I,56:S,57:V,58:P,59:L,60:B,61:R,62:W,63:re,64:ne,65:X,66:b,67:A,68:E,69:J,70:j,71:ce,72:te,73:pe,74:he,75:ae,76:ie,77:de,78:Ie,79:Se,80:ot,81:Ze,83:at}),i(Dt,[2,5]),i(Dt,[2,6]),i(Dt,[2,8],{10:75,82:Mr}),i(Ot,[2,45],{10:77,27:78,77:de,82:Mr}),i(Dt,[2,46],{10:79,82:Mr}),i(Dt,[2,47],{10:80,82:Mr}),{4:81,6:4,7:5,8:6,9:7,11:o,12:[1,83],13:[1,82],14:[1,84],15:n,17:a,19:33,20:s,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:p,47:u,48:m,49:h,50:x,51:C,52:D,53:k,54:M,55:I,56:S,57:V,58:P,59:L,60:B,61:R,62:W,63:re,64:ne,65:X,66:b,67:A,68:E,69:J,70:j,71:ce,72:te,73:pe,74:he,75:ae,76:ie,77:de,78:Ie,79:Se,80:ot,81:Ze,83:at},{7:87,16:85,17:[1,86],19:33,20:s,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:p,47:u,48:m,49:h,50:x,51:C,52:D,53:k,54:M,55:I,56:S,57:V,58:P,59:L,60:B,61:R,62:W,63:re,64:ne,65:X,66:b,67:A,68:E,69:J,70:j,71:ce,72:te,73:pe,74:he,75:ae,76:ie,77:de,78:Ie,79:Se,80:ot,81:Ze,83:at},{4:88,6:4,7:5,8:6,9:7,11:o,15:n,17:a,18:[1,89],19:33,20:s,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:p,47:u,48:m,49:h,50:x,51:C,52:D,53:k,54:M,55:I,56:S,57:V,58:P,59:L,60:B,61:R,62:W,63:re,64:ne,65:X,66:b,67:A,68:E,69:J,70:j,71:ce,72:te,73:pe,74:he,75:ae,76:ie,77:de,78:Ie,79:Se,80:ot,81:Ze,83:at},i(Le,[2,48]),i(Le,[2,49]),i(Le,[2,50]),i(Le,[2,98]),i(Le,[2,51]),i(Le,[2,52]),i(Le,[2,53]),i(Le,[2,54]),i(Le,[2,55]),i(Le,[2,56]),i(Le,[2,57]),i(Le,[2,58]),i(Le,[2,59]),i(Le,[2,60]),i(Le,[2,61]),i(Le,[2,62]),i(Le,[2,63]),i(Le,[2,64]),i(Le,[2,65]),i(Le,[2,66]),i(Le,[2,80]),i(Le,[2,81]),i(Le,[2,82]),i(Le,[2,83]),i(Le,[2,67]),i(Le,[2,68]),i(Le,[2,79]),i(Le,[2,84]),i(Le,[2,85]),i(Le,[2,86]),i(Le,[2,87]),i(Le,[2,88]),i(Le,[2,89]),i(Le,[2,90]),i(Le,[2,91]),i(Le,[2,92]),i(Le,[2,93]),i(Le,[2,94]),i(Le,[2,95]),i(Le,[2,96]),i(Le,[2,97]),i(Le,[2,99]),i(Le,[2,100]),i(Le,[2,101]),i(Le,[2,102]),i(Le,[2,104]),i(Le,[2,69]),i(Le,[2,70]),i(Le,[2,71]),i(Le,[2,72]),i(Le,[2,73]),i(Le,[2,74]),i(Le,[2,75]),i(Le,[2,76]),i(Le,[2,77]),i(Le,[2,78]),{4:90,6:4,7:5,8:6,9:7,11:o,15:n,17:a,19:33,20:s,21:l,22:32,23:c,24:[1,91],26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:p,47:u,48:m,49:h,50:x,51:C,52:D,53:k,54:M,55:I,56:S,57:V,58:P,59:L,60:B,61:R,62:W,63:re,64:ne,65:X,66:b,67:A,68:E,69:J,70:j,71:ce,72:te,73:pe,74:he,75:ae,76:ie,77:de,78:Ie,79:Se,80:ot,81:Ze,83:at},i(Le,[2,31]),i(Le,[2,32]),{1:[2,1]},i(Vt,[2,3]),i(Dt,[2,7]),i(Dt,[2,103]),i(Ot,[2,41],{27:92,77:de}),i(Dt,[2,40],{10:93,82:Mr}),i(Dt,[2,43]),i(Dt,[2,44]),{12:[1,94],13:[1,95],14:[1,96]},{12:[1,97],13:[1,98],14:[1,99]},{12:[1,101],13:[1,100],14:[1,102]},i(Dt,[2,24]),{17:[1,103]},{4:104,6:4,7:5,8:6,9:7,11:o,15:n,17:a,18:[1,105],19:33,20:s,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:p,47:u,48:m,49:h,50:x,51:C,52:D,53:k,54:M,55:I,56:S,57:V,58:P,59:L,60:B,61:R,62:W,63:re,64:ne,65:X,66:b,67:A,68:E,69:J,70:j,71:ce,72:te,73:pe,74:he,75:ae,76:ie,77:de,78:Ie,79:Se,80:ot,81:Ze,83:at},{7:87,16:106,17:[2,38],19:33,20:s,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:p,47:u,48:m,49:h,50:x,51:C,52:D,53:k,54:M,55:I,56:S,57:V,58:P,59:L,60:B,61:R,62:W,63:re,64:ne,65:X,66:b,67:A,68:E,69:J,70:j,71:ce,72:te,73:pe,74:he,75:ae,76:ie,77:de,78:Ie,79:Se,80:ot,81:Ze,83:at},{18:[1,107]},i(Le,[2,30]),{24:[1,108]},{4:109,6:4,7:5,8:6,9:7,11:o,15:n,17:a,19:33,20:s,21:l,22:32,23:c,25:[1,110],26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:p,47:u,48:m,49:h,50:x,51:C,52:D,53:k,54:M,55:I,56:S,57:V,58:P,59:L,60:B,61:R,62:W,63:re,64:ne,65:X,66:b,67:A,68:E,69:J,70:j,71:ce,72:te,73:pe,74:he,75:ae,76:ie,77:de,78:Ie,79:Se,80:ot,81:Ze,83:at},i(Dt,[2,39]),i(Dt,[2,42]),{4:111,6:4,7:5,8:6,9:7,11:o,13:[1,112],14:[1,113],15:n,17:a,19:33,20:s,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:p,47:u,48:m,49:h,50:x,51:C,52:D,53:k,54:M,55:I,56:S,57:V,58:P,59:L,60:B,61:R,62:W,63:re,64:ne,65:X,66:b,67:A,68:E,69:J,70:j,71:ce,72:te,73:pe,74:he,75:ae,76:ie,77:de,78:Ie,79:Se,80:ot,81:Ze,83:at},{4:114,6:4,7:5,8:6,9:7,11:o,14:[1,115],15:n,17:a,19:33,20:s,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:p,47:u,48:m,49:h,50:x,51:C,52:D,53:k,54:M,55:I,56:S,57:V,58:P,59:L,60:B,61:R,62:W,63:re,64:ne,65:X,66:b,67:A,68:E,69:J,70:j,71:ce,72:te,73:pe,74:he,75:ae,76:ie,77:de,78:Ie,79:Se,80:ot,81:Ze,83:at},i(Dt,[2,17]),{14:[1,116]},{14:[1,117]},i(Dt,[2,22]),{14:[1,118]},{14:[1,119]},i(Dt,[2,23]),{4:120,6:4,7:5,8:6,9:7,11:o,15:n,17:a,18:[1,121],19:33,20:s,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:p,47:u,48:m,49:h,50:x,51:C,52:D,53:k,54:M,55:I,56:S,57:V,58:P,59:L,60:B,61:R,62:W,63:re,64:ne,65:X,66:b,67:A,68:E,69:J,70:j,71:ce,72:te,73:pe,74:he,75:ae,76:ie,77:de,78:Ie,79:Se,80:ot,81:Ze,83:at},{18:[1,122]},i(Le,[2,28]),{17:[2,37]},i(Le,[2,29]),{4:123,6:4,7:5,8:6,9:7,11:o,15:n,17:a,19:33,20:s,21:l,22:32,23:c,25:[1,124],26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:p,47:u,48:m,49:h,50:x,51:C,52:D,53:k,54:M,55:I,56:S,57:V,58:P,59:L,60:B,61:R,62:W,63:re,64:ne,65:X,66:b,67:A,68:E,69:J,70:j,71:ce,72:te,73:pe,74:he,75:ae,76:ie,77:de,78:Ie,79:Se,80:ot,81:Ze,83:at},{25:[1,125]},i(Le,[2,36]),{13:[1,126],14:[1,127]},{4:128,6:4,7:5,8:6,9:7,11:o,14:[1,129],15:n,17:a,19:33,20:s,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:p,47:u,48:m,49:h,50:x,51:C,52:D,53:k,54:M,55:I,56:S,57:V,58:P,59:L,60:B,61:R,62:W,63:re,64:ne,65:X,66:b,67:A,68:E,69:J,70:j,71:ce,72:te,73:pe,74:he,75:ae,76:ie,77:de,78:Ie,79:Se,80:ot,81:Ze,83:at},i(Dt,[2,16]),{14:[1,130]},i(Dt,[2,15]),i(Dt,[2,18]),i(Dt,[2,20]),i(Dt,[2,19]),i(Dt,[2,21]),{18:[1,131]},i(Le,[2,27]),i(Le,[2,26]),{25:[1,132]},i(Le,[2,34]),i(Le,[2,35]),{4:133,6:4,7:5,8:6,9:7,11:o,14:[1,134],15:n,17:a,19:33,20:s,21:l,22:32,23:c,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:p,47:u,48:m,49:h,50:x,51:C,52:D,53:k,54:M,55:I,56:S,57:V,58:P,59:L,60:B,61:R,62:W,63:re,64:ne,65:X,66:b,67:A,68:E,69:J,70:j,71:ce,72:te,73:pe,74:he,75:ae,76:ie,77:de,78:Ie,79:Se,80:ot,81:Ze,83:at},i(Dt,[2,11]),{14:[1,135]},i(Dt,[2,14]),i(Dt,[2,13]),i(Le,[2,25]),i(Le,[2,33]),{14:[1,136]},i(Dt,[2,10]),i(Dt,[2,12]),i(Dt,[2,9])],defaultActions:{3:[2,2],73:[2,1],106:[2,37]},parseError:function(tt,ft){if(ft.recoverable)this.trace(tt);else{var gt=new Error(tt);throw gt.hash=ft,gt}},parse:function(tt){var ft=this,gt=[0],xe=[],Pt=[null],Fe=[],wi=this.table,Ce="",Ct=0,Tt=0,ke=0,pi=2,pt=1,_l=Fe.slice.call(arguments,1),Gt=Object.create(this.lexer),Eo={yy:{}};for(var $i in this.yy)Object.prototype.hasOwnProperty.call(this.yy,$i)&&(Eo.yy[$i]=this.yy[$i]);Gt.setInput(tt,Eo.yy),Eo.yy.lexer=Gt,Eo.yy.parser=this,typeof Gt.yylloc=="undefined"&&(Gt.yylloc={});var ro=Gt.yylloc;Fe.push(ro);var Rn=Gt.options&&Gt.options.ranges;typeof Eo.yy.parseError=="function"?this.parseError=Eo.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function wc(ta){gt.length=gt.length-2*ta,Pt.length=Pt.length-ta,Fe.length=Fe.length-ta}for(var _a=function(){var ta;return ta=Gt.lex()||pt,typeof ta!="number"&&(ta=ft.symbols_[ta]||ta),ta},_t,va,io,En,bu,vc,ea={},Nr,Jo,Ya,Gn;;){if(io=gt[gt.length-1],this.defaultActions[io]?En=this.defaultActions[io]:((_t===null||typeof _t=="undefined")&&(_t=_a()),En=wi[io]&&wi[io][_t]),typeof En=="undefined"||!En.length||!En[0]){var Cc="";Gn=[];for(Nr in wi[io])this.terminals_[Nr]&&Nr>pi&&Gn.push("'"+this.terminals_[Nr]+"'");Gt.showPosition?Cc="Parse error on line "+(Ct+1)+`:
`+Gt.showPosition()+`
Expecting `+Gn.join(", ")+", got '"+(this.terminals_[_t]||_t)+"'":Cc="Parse error on line "+(Ct+1)+": Unexpected "+(_t==pt?"end of input":"'"+(this.terminals_[_t]||_t)+"'"),this.parseError(Cc,{text:Gt.match,token:this.terminals_[_t]||_t,line:Gt.yylineno,loc:ro,expected:Gn})}if(En[0]instanceof Array&&En.length>1)throw new Error("Parse Error: multiple actions possible at state: "+io+", token: "+_t);switch(En[0]){case 1:gt.push(_t),Pt.push(Gt.yytext),Fe.push(Gt.yylloc),gt.push(En[1]),_t=null,va?(_t=va,va=null):(Tt=Gt.yyleng,Ce=Gt.yytext,Ct=Gt.yylineno,ro=Gt.yylloc,ke>0&&ke--);break;case 2:if(Jo=this.productions_[En[1]][1],ea.$=Pt[Pt.length-Jo],ea._$={first_line:Fe[Fe.length-(Jo||1)].first_line,last_line:Fe[Fe.length-1].last_line,first_column:Fe[Fe.length-(Jo||1)].first_column,last_column:Fe[Fe.length-1].last_column},Rn&&(ea._$.range=[Fe[Fe.length-(Jo||1)].range[0],Fe[Fe.length-1].range[1]]),vc=this.performAction.apply(ea,[Ce,Tt,Ct,Eo.yy,En[1],Pt,Fe].concat(_l)),typeof vc!="undefined")return vc;Jo&&(gt=gt.slice(0,-1*Jo*2),Pt=Pt.slice(0,-1*Jo),Fe=Fe.slice(0,-1*Jo)),gt.push(this.productions_[En[1]][0]),Pt.push(ea.$),Fe.push(ea._$),Ya=wi[gt[gt.length-2]][gt[gt.length-1]],gt.push(Ya);break;case 3:return!0}}return!0}},Wi=function(){var Yo={EOF:1,parseError:function(ft,gt){if(this.yy.parser)this.yy.parser.parseError(ft,gt);else throw new Error(ft)},setInput:function(tt,ft){return this.yy=ft||this.yy||{},this._input=tt,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var tt=this._input[0];this.yytext+=tt,this.yyleng++,this.offset++,this.match+=tt,this.matched+=tt;var ft=tt.match(/(?:\r\n?|\n).*/g);return ft?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),tt},unput:function(tt){var ft=tt.length,gt=tt.split(/(?:\r\n?|\n)/g);this._input=tt+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-ft),this.offset-=ft;var xe=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),gt.length-1&&(this.yylineno-=gt.length-1);var Pt=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:gt?(gt.length===xe.length?this.yylloc.first_column:0)+xe[xe.length-gt.length].length-gt[0].length:this.yylloc.first_column-ft},this.options.ranges&&(this.yylloc.range=[Pt[0],Pt[0]+this.yyleng-ft]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(tt){this.unput(this.match.slice(tt))},pastInput:function(){var tt=this.matched.substr(0,this.matched.length-this.match.length);return(tt.length>20?"...":"")+tt.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var tt=this.match;return tt.length<20&&(tt+=this._input.substr(0,20-tt.length)),(tt.substr(0,20)+(tt.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var tt=this.pastInput(),ft=new Array(tt.length+1).join("-");return tt+this.upcomingInput()+`
`+ft+"^"},test_match:function(tt,ft){var gt,xe,Pt;if(this.options.backtrack_lexer&&(Pt={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(Pt.yylloc.range=this.yylloc.range.slice(0))),xe=tt[0].match(/(?:\r\n?|\n).*/g),xe&&(this.yylineno+=xe.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:xe?xe[xe.length-1].length-xe[xe.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+tt[0].length},this.yytext+=tt[0],this.match+=tt[0],this.matches=tt,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(tt[0].length),this.matched+=tt[0],gt=this.performAction.call(this,this.yy,this,ft,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),gt)return gt;if(this._backtrack){for(var Fe in Pt)this[Fe]=Pt[Fe];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var tt,ft,gt,xe;this._more||(this.yytext="",this.match="");for(var Pt=this._currentRules(),Fe=0;Fe<Pt.length;Fe++)if(gt=this._input.match(this.rules[Pt[Fe]]),gt&&(!ft||gt[0].length>ft[0].length)){if(ft=gt,xe=Fe,this.options.backtrack_lexer){if(tt=this.test_match(gt,Pt[Fe]),tt!==!1)return tt;if(this._backtrack){ft=!1;continue}else return!1}else if(!this.options.flex)break}return ft?(tt=this.test_match(ft,Pt[xe]),tt!==!1?tt:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var ft=this.next();return ft||this.lex()},begin:function(ft){this.conditionStack.push(ft)},popState:function(){var ft=this.conditionStack.length-1;return ft>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(ft){return ft=this.conditionStack.length-1-Math.abs(ft||0),ft>=0?this.conditionStack[ft]:"INITIAL"},pushState:function(ft){this.begin(ft)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(ft,gt,xe,Pt){var Fe=Pt;switch(xe){case 0:return this.begin("modexp"),11;break;case 1:return 21;case 2:return this.begin("modexp"),11;break;case 3:return 12;case 4:return 13;case 5:return this.popState(),14;break;case 6:return 63;case 7:return 64;case 8:return 65;case 9:return 66;case 10:return 67;case 11:return 68;case 12:return 69;case 13:return 54;case 14:return 48;case 15:return 49;case 16:return 50;case 17:return 55;case 18:return 51;case 19:return 52;case 20:return 53;case 21:return 57;case 22:return 56;case 23:return 76;case 24:return 70;case 25:return 71;case 26:return 72;case 27:return 74;case 28:return 74;case 29:return 74;case 30:return 74;case 31:return 74;case 32:return 74;case 33:return 74;case 34:return 74;case 35:return 74;case 36:return 73;case 37:return 74;case 38:return 74;case 39:return 73;case 40:return 73;case 41:return 73;case 42:return 73;case 43:return 73;case 44:return 73;case 45:return 73;case 46:return 73;case 47:return 73;case 48:return 73;case 49:return 75;case 50:return 20;case 51:return 47;case 52:return 21;case 53:return 82;case 54:return 60;case 55:return 15;case 56:return this.begin("radical"),17;break;case 57:return this.popState(),18;break;case 58:return 18;case 59:return 79;case 60:return 81;case 61:return 80;case 62:return 59;case 63:return 59;case 64:return gt.yytext=this.matches[1],77;break;case 65:return 23;case 66:return 24;case 67:return 25;case 68:return gt.yytext=this.matches[1],62;break;case 69:return 61;case 70:return 78;case 71:return 83;case 72:return 46;case 73:return 47;case 74:return 58;case 75:return 5;case 76:return 85}},rules:[/^(?:"(?=[^>\]]+%))/,/^(?:")/,/^(?:"(?=[^>\]]+\]|[^>\]]+%))/,/^(?:%)/,/^(?:<)/,/^(?:\])/,/^(?:[+])/,/^(?:[-])/,/^(?:[*])/,/^(?:[@][*])/,/^(?:[@][\#])/,/^(?:[_][/])/,/^(?:[.][/])/,/^(?:[.][.][(])/,/^(?:[@][(])/,/^(?:[.][(])/,/^(?:[(])/,/^(?:[.][.][)])/,/^(?:[@][)])/,/^(?:[.][)])/,/^(?:[)])/,/^(?:[\\][\\])/,/^(?:[\\])/,/^(?:[_][3])/,/^(?:[@][0][O][F][ ]?)/,/^(?:[@][0])/,/^(?:[ ][$]O[ ])/,/^(?:[ ][\^;]+[.]K[ ])/,/^(?:[\^;]+[=])/,/^(?:[ ][\^;]+[/][.]K[ ])/,/^(?:[ ][\^;]+[@][:][@][:][ ])/,/^(?:[ ][\^;]+["]K[:][ ])/,/^(?:[ ][\^;]+[.]1[:][ ])/,/^(?:[ ][\^;]+["]K[ ])/,/^(?:[ ][\^;]+[.]1[ ])/,/^(?:[ ][\^;]+[/][$][L][ ])/,/^(?:[ ][.]K[ ])/,/^(?:[ ][\^;]+[/]?[$][L][ ])/,/^(?:[ ][\^;]+[$]P[ ])/,/^(?:[=])/,/^(?:[ ][/][.]K[ ])/,/^(?:[ ][@][:][@][:][ ])/,/^(?:[ ]["]K[:][ ])/,/^(?:[ ][.]1[:][ ])/,/^(?:[ ]["]K[ ])/,/^(?:[ ][.]1[ ])/,/^(?:[@][:])/,/^(?:[ ][/]?[$][L][ ])/,/^(?:[ ][$]P[ ])/,/^(?:[ ]['][']['][ ])/,/^(?:[\^;]+)/,/^(?:[.]["])/,/^(?:["])/,/^(?:[']+)/,/^(?:[.][,]?[ABGDEZ\?\:IKLMNXOPRSTUYF\&W])/,/^(?:[.]*[<])/,/^(?:[.]*[>])/,/^(?:[.]*\])/,/^(?:[.]*\])/,/^(?:!)/,/^(?:[_]&)/,/^(?:&)/,/^(?:(ARC)?(SIN|COS|TAN|CSC|SEC|COT)(H)?)/,/^(?:(ARG|DET|EXP|IM|INF|LIM|LN|LOG|MAX|MIN|MOD|RE|SUP))/,/^(?:#?(\d*\.?\d+))/,/^(?:[,]*[?])/,/^(?:[,]*[/])/,/^(?:[,]*#)/,/^(?:[,]([A-Z]))/,/^(?:[A-Z])/,/^(?:[,][=])/,/^(?:[_][8])/,/^(?:[,][ ]?)/,/^(?:[.])/,/^(?:[ ])/,/^(?:$)/,/^(?:.)/],conditions:{radical:{rules:[0,1,2,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76],inclusive:!0},modexp:{rules:[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76],inclusive:!0},INITIAL:{rules:[2,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76],inclusive:!0}}};return Yo}();fo.lexer=Wi;function fe(){this.yy={}}return fe.prototype=fo,fo.Parser=fe,new fe}();typeof hb!="undefined"&&typeof r!="undefined"&&(r.parser=t,r.Parser=t.Parser,r.parse=function(){return t.parse.apply(t,arguments)},r.main=function(){},typeof e!="undefined"&&hb.main===e&&r.main(process.argv.slice(1)))}}),c8=yA({"generated/ueb-to-latex.jison.js"(r,e){"use strict";var t=function(){var i=function(wi,Ce,Ct,Tt){for(Ct=Ct||{},Tt=wi.length;Tt--;Ct[wi[Tt]]=Ce);return Ct},o=[1,15],n=[1,16],a=[1,17],s=[1,36],l=[1,18],c=[1,37],p=[1,38],u=[1,14],m=[1,46],h=[1,47],x=[1,39],C=[1,40],D=[1,41],k=[1,56],M=[1,42],I=[1,43],S=[1,44],V=[1,45],P=[1,54],L=[1,55],B=[1,57],R=[1,58],W=[1,59],re=[1,60],ne=[1,61],X=[1,62],b=[1,63],A=[1,64],E=[1,65],J=[1,66],j=[1,67],ce=[1,68],te=[1,69],pe=[1,70],he=[1,71],ae=[1,72],ie=[1,73],de=[1,74],Ie=[1,75],Se=[1,76],ot=[1,77],Ze=[1,48],at=[1,49],Vt=[1,50],Dt=[1,51],Mr=[1,52],Ot=[1,78],Le=[1,53],fo=[5,14,18,19,29,52,53,54],Wi=[5,10,13,14,15,18,19,29,52,53,54],fe=[5,10,13,14,15,17,18,19,21,23,24,28,29,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89],Yo=[1,86],tt=[1,87],ft=[1,88],gt=[10,13,15,17,21,23,24,28,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89],xe={trace:function(){},yy:{},symbols_:{error:2,sentence:3,group:4,EOF:5,expression_group:6,delimited_expression:7,level:8,radical:9,LEVEL:10,basic_token:11,bracketed_expression:12,RADICAL_WITH_INDEX:13,CLOSE_RADICAL:14,RADICAL:15,frac:16,OPEN_FRAC:17,OVER:18,CLOSE_FRAC:19,simple_frac:20,NUMBER:21,NUMBER_FRAC_DENOMINATOR:22,NUMBER_FRAC_NUMERATOR_BAD:23,NUMBER_FRAC_DENOMINATOR_BAD:24,atom:25,lbracket:26,rbracket:27,OPEN_GROUP:28,CLOSE_GROUP:29,command:30,greek:31,letter:32,comma:33,period:34,colon:35,infinity:36,integral:37,factorial:38,ampersand:39,question_mark:40,bracket:41,space:42,operation:43,comparison:44,ellipsis:45,primes:46,",":47,".":48,"[":49,"{":50,"(":51,"]":52,"}":53,")":54,SPACE:55,COMMAND:56,GREEK:57,CAPITAL_LETTER:58,LETTER:59,PIPE:60,DOUBLE_PIPE:61,"+":62,"-":63,CDOT:64,TIMES:65,"*":66,DIV:67,SLASH:68,PERCENT_OF:69,PERCENT:70,TO:71,"=":72,NEQ:73,"<":74,">":75,LEQ:76,APPROX:77,GEQ:78,TILDE:79,PARALLEL:80,PERPENDICULAR:81,ELLIPSIS:82,COLON:83,INFINITY:84,INTEGRAL:85,FACTORIAL:86,"&":87,PRIMES:88,"?":89,unknown:90,UNKNOWN:91,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",10:"LEVEL",13:"RADICAL_WITH_INDEX",14:"CLOSE_RADICAL",15:"RADICAL",17:"OPEN_FRAC",18:"OVER",19:"CLOSE_FRAC",21:"NUMBER",22:"NUMBER_FRAC_DENOMINATOR",23:"NUMBER_FRAC_NUMERATOR_BAD",24:"NUMBER_FRAC_DENOMINATOR_BAD",28:"OPEN_GROUP",29:"CLOSE_GROUP",47:",",48:".",49:"[",50:"{",51:"(",52:"]",53:"}",54:")",55:"SPACE",56:"COMMAND",57:"GREEK",58:"CAPITAL_LETTER",59:"LETTER",60:"PIPE",61:"DOUBLE_PIPE",62:"+",63:"-",64:"CDOT",65:"TIMES",66:"*",67:"DIV",68:"SLASH",69:"PERCENT_OF",70:"PERCENT",71:"TO",72:"=",73:"NEQ",74:"<",75:">",76:"LEQ",77:"APPROX",78:"GEQ",79:"TILDE",80:"PARALLEL",81:"PERPENDICULAR",82:"ELLIPSIS",83:"COLON",84:"INFINITY",85:"INTEGRAL",86:"FACTORIAL",87:"&",88:"PRIMES",89:"?",91:"UNKNOWN"},productions_:[0,[3,2],[3,1],[4,3],[4,2],[4,1],[4,2],[4,1],[7,1],[7,1],[8,2],[8,2],[8,2],[9,4],[9,3],[9,3],[9,2],[9,4],[9,3],[9,2],[16,5],[16,4],[16,4],[16,3],[16,2],[20,2],[20,1],[20,1],[11,1],[11,1],[11,1],[6,2],[6,2],[6,1],[6,1],[12,3],[12,2],[12,3],[12,2],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[33,1],[34,1],[26,1],[26,1],[26,1],[27,1],[27,1],[27,1],[42,1],[30,1],[31,1],[32,1],[32,1],[41,1],[41,1],[43,1],[43,1],[43,1],[43,1],[43,1],[43,1],[43,1],[43,1],[43,1],[43,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[45,1],[35,1],[36,1],[37,1],[38,1],[39,1],[46,1],[40,1],[90,1]],performAction:function(Ce,Ct,Tt,ke,pi,pt,_l){var Gt=pt.length-1;switch(pi){case 1:return pt[Gt-1];case 2:return ke.group();case 3:case 35:this.$=ke.group(pt[Gt-2],pt[Gt-1],pt[Gt]);break;case 4:case 6:case 31:case 32:case 36:this.$=ke.group(pt[Gt-1],pt[Gt]);break;case 5:case 7:case 33:case 34:this.$=ke.group(pt[Gt]);break;case 10:case 11:case 12:this.$=ke.basic_level(pt[Gt-1],ke.group(pt[Gt]));break;case 13:case 17:this.$=ke.radical(pt[Gt-1],ke.group(pt[Gt-2]));break;case 14:case 15:this.$=ke.radical(ke.group(),ke.group(pt[Gt-1]));break;case 16:this.$=ke.radical(ke.group(),ke.group());break;case 18:this.$=ke.radical(pt[Gt-1]);break;case 19:this.$=ke.radical(ke.group());break;case 20:this.$=ke.fraction(pt[Gt-3],pt[Gt-1]);break;case 21:this.$=ke.fraction(pt[Gt-2],ke.group());break;case 22:this.$=ke.fraction(ke.group(),pt[Gt-1]);break;case 23:case 24:this.$=ke.fraction(ke.group(),ke.group());break;case 25:this.$=ke.fraction(ke.group(ke.terminal(ke.to_number(pt[Gt-1]))),ke.group(ke.terminal(ke.to_number(pt[Gt]))));break;case 26:this.$=ke.fraction(ke.group(ke.terminal(ke.to_number(pt[Gt]))),ke.group());break;case 27:this.$=ke.fraction(ke.group(),ke.group(ke.terminal(ke.to_number(pt[$01]))));break;case 37:this.$=ke.group(pt[Gt-1]);break;case 38:this.$=ke.group();break;case 39:this.$=ke.terminal(ke.to_number(pt[Gt]));break;case 57:this.$=ke.terminal(",");break;case 58:this.$=ke.terminal(".");break;case 59:this.$=ke.terminal("[");break;case 60:this.$=ke.terminal("\\{");break;case 61:this.$=ke.terminal("(");break;case 62:this.$=ke.terminal("]");break;case 63:this.$=ke.terminal("\\}");break;case 64:this.$=ke.terminal(")");break;case 65:this.$=ke.terminal(" ");break;case 66:this.$=ke.command("\\"+pt[Gt].trim().toLowerCase());break;case 67:this.$=ke.terminal(ke.greek(pt[Gt]));break;case 68:this.$=ke.terminal(pt[Gt].toUpperCase());break;case 69:this.$=ke.terminal(pt[Gt].toLowerCase());break;case 70:this.$=ke.terminal("|");break;case 71:this.$=ke.terminal("\\|");break;case 72:this.$=ke.terminal("+");break;case 73:this.$=ke.terminal("-");break;case 74:this.$=ke.terminal("\\cdot ");break;case 75:this.$=ke.terminal("\\times ");break;case 76:this.$=ke.terminal("*");break;case 77:this.$=ke.terminal("\\div ");break;case 78:this.$=ke.terminal("/");break;case 79:this.$=ke.terminal("\\%\\operatorname{of}");break;case 80:this.$=ke.terminal("\\%");break;case 81:this.$=ke.terminal("\\to ");break;case 82:this.$=ke.terminal("=");break;case 83:this.$=ke.terminal("\\neq ");break;case 84:this.$=ke.terminal("<");break;case 85:this.$=ke.terminal(">");break;case 86:this.$=ke.terminal("\\leq ");break;case 87:this.$=ke.terminal("\\approx ");break;case 88:this.$=ke.terminal("\\geq ");break;case 89:this.$=ke.terminal("\\sim ");break;case 90:this.$=ke.terminal("\\parallel ");break;case 91:this.$=ke.terminal("\\perp ");break;case 92:this.$=ke.terminal("\\ldots ");break;case 93:this.$=ke.terminal(":");break;case 94:this.$=ke.terminal("\\infty ");break;case 95:this.$=ke.terminal("\\int ");break;case 96:this.$=ke.terminal("!");break;case 97:this.$=ke.terminal("\\&");break;case 98:this.$=ke.primes(pt[Gt]);break;case 99:this.$=ke.terminal("?");break}},table:[{3:1,4:2,5:[1,3],6:4,7:5,8:8,9:9,10:o,11:6,12:7,13:n,15:a,16:11,17:s,20:12,21:l,23:c,24:p,25:10,26:13,28:u,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:m,48:h,49:x,50:C,51:D,55:k,56:M,57:I,58:S,59:V,60:P,61:L,62:B,63:R,64:W,65:re,66:ne,67:X,68:b,69:A,70:E,71:J,72:j,73:ce,74:te,75:pe,76:he,77:ae,78:ie,79:de,80:Ie,81:Se,82:ot,83:Ze,84:at,85:Vt,86:Dt,87:Mr,88:Ot,89:Le},{1:[3]},{5:[1,79]},{1:[2,2]},i(fo,[2,5],{8:8,9:9,7:80,10:o,13:n,15:a}),i(fo,[2,7],{6:4,7:5,11:6,12:7,8:8,9:9,25:10,16:11,20:12,26:13,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,4:81,10:o,13:n,15:a,17:s,21:l,23:c,24:p,28:u,47:m,48:h,49:x,50:C,51:D,55:k,56:M,57:I,58:S,59:V,60:P,61:L,62:B,63:R,64:W,65:re,66:ne,67:X,68:b,69:A,70:E,71:J,72:j,73:ce,74:te,75:pe,76:he,77:ae,78:ie,79:de,80:Ie,81:Se,82:ot,83:Ze,84:at,85:Vt,86:Dt,87:Mr,88:Ot,89:Le}),i(Wi,[2,33],{11:6,12:7,25:10,16:11,20:12,26:13,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,6:82,17:s,21:l,23:c,24:p,28:u,47:m,48:h,49:x,50:C,51:D,55:k,56:M,57:I,58:S,59:V,60:P,61:L,62:B,63:R,64:W,65:re,66:ne,67:X,68:b,69:A,70:E,71:J,72:j,73:ce,74:te,75:pe,76:he,77:ae,78:ie,79:de,80:Ie,81:Se,82:ot,83:Ze,84:at,85:Vt,86:Dt,87:Mr,88:Ot,89:Le}),i(Wi,[2,34],{11:6,12:7,25:10,16:11,20:12,26:13,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,6:83,17:s,21:l,23:c,24:p,28:u,47:m,48:h,49:x,50:C,51:D,55:k,56:M,57:I,58:S,59:V,60:P,61:L,62:B,63:R,64:W,65:re,66:ne,67:X,68:b,69:A,70:E,71:J,72:j,73:ce,74:te,75:pe,76:he,77:ae,78:ie,79:de,80:Ie,81:Se,82:ot,83:Ze,84:at,85:Vt,86:Dt,87:Mr,88:Ot,89:Le}),i(fe,[2,8]),i(fe,[2,9]),i(fe,[2,28]),i(fe,[2,29]),i(fe,[2,30]),{4:84,6:4,7:5,8:8,9:9,10:o,11:6,12:7,13:n,15:a,16:11,17:s,20:12,21:l,23:c,24:p,25:10,26:13,27:85,28:u,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:m,48:h,49:x,50:C,51:D,52:Yo,53:tt,54:ft,55:k,56:M,57:I,58:S,59:V,60:P,61:L,62:B,63:R,64:W,65:re,66:ne,67:X,68:b,69:A,70:E,71:J,72:j,73:ce,74:te,75:pe,76:he,77:ae,78:ie,79:de,80:Ie,81:Se,82:ot,83:Ze,84:at,85:Vt,86:Dt,87:Mr,88:Ot,89:Le},{4:89,6:4,7:5,8:8,9:9,10:o,11:6,12:7,13:n,15:a,16:11,17:s,20:12,21:l,23:c,24:p,25:10,26:13,28:u,29:[1,90],30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:m,48:h,49:x,50:C,51:D,55:k,56:M,57:I,58:S,59:V,60:P,61:L,62:B,63:R,64:W,65:re,66:ne,67:X,68:b,69:A,70:E,71:J,72:j,73:ce,74:te,75:pe,76:he,77:ae,78:ie,79:de,80:Ie,81:Se,82:ot,83:Ze,84:at,85:Vt,86:Dt,87:Mr,88:Ot,89:Le},{9:93,11:91,12:92,13:n,15:a,16:11,17:s,20:12,21:l,23:c,24:p,25:10,26:13,28:u,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:m,48:h,49:x,50:C,51:D,55:k,56:M,57:I,58:S,59:V,60:P,61:L,62:B,63:R,64:W,65:re,66:ne,67:X,68:b,69:A,70:E,71:J,72:j,73:ce,74:te,75:pe,76:he,77:ae,78:ie,79:de,80:Ie,81:Se,82:ot,83:Ze,84:at,85:Vt,86:Dt,87:Mr,88:Ot,89:Le},{11:94,12:95,14:[1,96],16:11,17:s,20:12,21:l,23:c,24:p,25:10,26:13,28:u,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:m,48:h,49:x,50:C,51:D,55:k,56:M,57:I,58:S,59:V,60:P,61:L,62:B,63:R,64:W,65:re,66:ne,67:X,68:b,69:A,70:E,71:J,72:j,73:ce,74:te,75:pe,76:he,77:ae,78:ie,79:de,80:Ie,81:Se,82:ot,83:Ze,84:at,85:Vt,86:Dt,87:Mr,88:Ot,89:Le},{4:97,6:4,7:5,8:8,9:9,10:o,11:6,12:7,13:n,14:[1,98],15:a,16:11,17:s,20:12,21:l,23:c,24:p,25:10,26:13,28:u,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:m,48:h,49:x,50:C,51:D,55:k,56:M,57:I,58:S,59:V,60:P,61:L,62:B,63:R,64:W,65:re,66:ne,67:X,68:b,69:A,70:E,71:J,72:j,73:ce,74:te,75:pe,76:he,77:ae,78:ie,79:de,80:Ie,81:Se,82:ot,83:Ze,84:at,85:Vt,86:Dt,87:Mr,88:Ot,89:Le},i(fe,[2,39],{22:[1,99]}),i(fe,[2,40]),i(fe,[2,41]),i(fe,[2,42]),i(fe,[2,43]),i(fe,[2,44]),i(fe,[2,45]),i(fe,[2,46]),i(fe,[2,47]),i(fe,[2,48]),i(fe,[2,49]),i(fe,[2,50]),i(fe,[2,51]),i(fe,[2,52]),i(fe,[2,53]),i(fe,[2,54]),i(fe,[2,55]),i(fe,[2,56]),{4:100,6:4,7:5,8:8,9:9,10:o,11:6,12:7,13:n,15:a,16:11,17:s,18:[1,101],19:[1,102],20:12,21:l,23:c,24:p,25:10,26:13,28:u,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:m,48:h,49:x,50:C,51:D,55:k,56:M,57:I,58:S,59:V,60:P,61:L,62:B,63:R,64:W,65:re,66:ne,67:X,68:b,69:A,70:E,71:J,72:j,73:ce,74:te,75:pe,76:he,77:ae,78:ie,79:de,80:Ie,81:Se,82:ot,83:Ze,84:at,85:Vt,86:Dt,87:Mr,88:Ot,89:Le},i(fe,[2,26]),i(fe,[2,27]),i(gt,[2,59]),i(gt,[2,60]),i(gt,[2,61]),i(fe,[2,66]),i(fe,[2,67]),i(fe,[2,68]),i(fe,[2,69]),i(fe,[2,57]),i(fe,[2,58]),i(fe,[2,93]),i(fe,[2,94]),i(fe,[2,95]),i(fe,[2,96]),i(fe,[2,97]),i(fe,[2,99]),i(fe,[2,70]),i(fe,[2,71]),i(fe,[2,65]),i(fe,[2,72]),i(fe,[2,73]),i(fe,[2,74]),i(fe,[2,75]),i(fe,[2,76]),i(fe,[2,77]),i(fe,[2,78]),i(fe,[2,79]),i(fe,[2,80]),i(fe,[2,81]),i(fe,[2,82]),i(fe,[2,83]),i(fe,[2,84]),i(fe,[2,85]),i(fe,[2,86]),i(fe,[2,87]),i(fe,[2,88]),i(fe,[2,89]),i(fe,[2,90]),i(fe,[2,91]),i(fe,[2,92]),i(fe,[2,98]),{1:[2,1]},i(fo,[2,4],{6:4,7:5,11:6,12:7,8:8,9:9,25:10,16:11,20:12,26:13,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,4:103,10:o,13:n,15:a,17:s,21:l,23:c,24:p,28:u,47:m,48:h,49:x,50:C,51:D,55:k,56:M,57:I,58:S,59:V,60:P,61:L,62:B,63:R,64:W,65:re,66:ne,67:X,68:b,69:A,70:E,71:J,72:j,73:ce,74:te,75:pe,76:he,77:ae,78:ie,79:de,80:Ie,81:Se,82:ot,83:Ze,84:at,85:Vt,86:Dt,87:Mr,88:Ot,89:Le}),i(fo,[2,6]),i(Wi,[2,31]),i(Wi,[2,32]),{27:104,52:Yo,53:tt,54:ft},i(fe,[2,36]),i(fe,[2,62]),i(fe,[2,63]),i(fe,[2,64]),{29:[1,105]},i(fe,[2,38]),i(fe,[2,10]),i(fe,[2,11]),i(fe,[2,12]),{4:106,6:4,7:5,8:8,9:9,10:o,11:6,12:7,13:n,14:[1,107],15:a,16:11,17:s,20:12,21:l,23:c,24:p,25:10,26:13,28:u,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:m,48:h,49:x,50:C,51:D,55:k,56:M,57:I,58:S,59:V,60:P,61:L,62:B,63:R,64:W,65:re,66:ne,67:X,68:b,69:A,70:E,71:J,72:j,73:ce,74:te,75:pe,76:he,77:ae,78:ie,79:de,80:Ie,81:Se,82:ot,83:Ze,84:at,85:Vt,86:Dt,87:Mr,88:Ot,89:Le},{4:109,6:4,7:5,8:8,9:9,10:o,11:6,12:7,13:n,14:[1,108],15:a,16:11,17:s,20:12,21:l,23:c,24:p,25:10,26:13,28:u,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:m,48:h,49:x,50:C,51:D,55:k,56:M,57:I,58:S,59:V,60:P,61:L,62:B,63:R,64:W,65:re,66:ne,67:X,68:b,69:A,70:E,71:J,72:j,73:ce,74:te,75:pe,76:he,77:ae,78:ie,79:de,80:Ie,81:Se,82:ot,83:Ze,84:at,85:Vt,86:Dt,87:Mr,88:Ot,89:Le},i(fe,[2,16]),{14:[1,110]},i(fe,[2,19]),i(fe,[2,25]),{18:[1,111]},{4:112,6:4,7:5,8:8,9:9,10:o,11:6,12:7,13:n,15:a,16:11,17:s,19:[1,113],20:12,21:l,23:c,24:p,25:10,26:13,28:u,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:m,48:h,49:x,50:C,51:D,55:k,56:M,57:I,58:S,59:V,60:P,61:L,62:B,63:R,64:W,65:re,66:ne,67:X,68:b,69:A,70:E,71:J,72:j,73:ce,74:te,75:pe,76:he,77:ae,78:ie,79:de,80:Ie,81:Se,82:ot,83:Ze,84:at,85:Vt,86:Dt,87:Mr,88:Ot,89:Le},i(fe,[2,24]),i(fo,[2,3]),i(fe,[2,35]),i(fe,[2,37]),{14:[1,114]},i(fe,[2,15]),i(fe,[2,14]),{14:[1,115]},i(fe,[2,18]),{4:116,6:4,7:5,8:8,9:9,10:o,11:6,12:7,13:n,15:a,16:11,17:s,19:[1,117],20:12,21:l,23:c,24:p,25:10,26:13,28:u,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:m,48:h,49:x,50:C,51:D,55:k,56:M,57:I,58:S,59:V,60:P,61:L,62:B,63:R,64:W,65:re,66:ne,67:X,68:b,69:A,70:E,71:J,72:j,73:ce,74:te,75:pe,76:he,77:ae,78:ie,79:de,80:Ie,81:Se,82:ot,83:Ze,84:at,85:Vt,86:Dt,87:Mr,88:Ot,89:Le},{19:[1,118]},i(fe,[2,23]),i(fe,[2,13]),i(fe,[2,17]),{19:[1,119]},i(fe,[2,21]),i(fe,[2,22]),i(fe,[2,20])],defaultActions:{3:[2,2],79:[2,1]},parseError:function(Ce,Ct){if(Ct.recoverable)this.trace(Ce);else{var Tt=new Error(Ce);throw Tt.hash=Ct,Tt}},parse:function(Ce){var Ct=this,Tt=[0],ke=[],pi=[null],pt=[],_l=this.table,Gt="",Eo=0,$i=0,ro=0,Rn=2,wc=1,_a=pt.slice.call(arguments,1),_t=Object.create(this.lexer),va={yy:{}};for(var io in this.yy)Object.prototype.hasOwnProperty.call(this.yy,io)&&(va.yy[io]=this.yy[io]);_t.setInput(Ce,va.yy),va.yy.lexer=_t,va.yy.parser=this,typeof _t.yylloc=="undefined"&&(_t.yylloc={});var En=_t.yylloc;pt.push(En);var bu=_t.options&&_t.options.ranges;typeof va.yy.parseError=="function"?this.parseError=va.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function vc(gs){Tt.length=Tt.length-2*gs,pi.length=pi.length-gs,pt.length=pt.length-gs}for(var ea=function(){var gs;return gs=_t.lex()||wc,typeof gs!="number"&&(gs=Ct.symbols_[gs]||gs),gs},Nr,Jo,Ya,Gn,Cc,ta,Fl={},Rl,bo,pp,Nl;;){if(Ya=Tt[Tt.length-1],this.defaultActions[Ya]?Gn=this.defaultActions[Ya]:((Nr===null||typeof Nr=="undefined")&&(Nr=ea()),Gn=_l[Ya]&&_l[Ya][Nr]),typeof Gn=="undefined"||!Gn.length||!Gn[0]){var yu="";Nl=[];for(Rl in _l[Ya])this.terminals_[Rl]&&Rl>Rn&&Nl.push("'"+this.terminals_[Rl]+"'");_t.showPosition?yu="Parse error on line "+(Eo+1)+`:
`+_t.showPosition()+`
Expecting `+Nl.join(", ")+", got '"+(this.terminals_[Nr]||Nr)+"'":yu="Parse error on line "+(Eo+1)+": Unexpected "+(Nr==wc?"end of input":"'"+(this.terminals_[Nr]||Nr)+"'"),this.parseError(yu,{text:_t.match,token:this.terminals_[Nr]||Nr,line:_t.yylineno,loc:En,expected:Nl})}if(Gn[0]instanceof Array&&Gn.length>1)throw new Error("Parse Error: multiple actions possible at state: "+Ya+", token: "+Nr);switch(Gn[0]){case 1:Tt.push(Nr),pi.push(_t.yytext),pt.push(_t.yylloc),Tt.push(Gn[1]),Nr=null,Jo?(Nr=Jo,Jo=null):($i=_t.yyleng,Gt=_t.yytext,Eo=_t.yylineno,En=_t.yylloc,ro>0&&ro--);break;case 2:if(bo=this.productions_[Gn[1]][1],Fl.$=pi[pi.length-bo],Fl._$={first_line:pt[pt.length-(bo||1)].first_line,last_line:pt[pt.length-1].last_line,first_column:pt[pt.length-(bo||1)].first_column,last_column:pt[pt.length-1].last_column},bu&&(Fl._$.range=[pt[pt.length-(bo||1)].range[0],pt[pt.length-1].range[1]]),ta=this.performAction.apply(Fl,[Gt,$i,Eo,va.yy,Gn[1],pi,pt].concat(_a)),typeof ta!="undefined")return ta;bo&&(Tt=Tt.slice(0,-1*bo*2),pi=pi.slice(0,-1*bo),pt=pt.slice(0,-1*bo)),Tt.push(this.productions_[Gn[1]][0]),pi.push(Fl.$),pt.push(Fl._$),pp=_l[Tt[Tt.length-2]][Tt[Tt.length-1]],Tt.push(pp);break;case 3:return!0}}return!0}},Pt=function(){var wi={EOF:1,parseError:function(Ct,Tt){if(this.yy.parser)this.yy.parser.parseError(Ct,Tt);else throw new Error(Ct)},setInput:function(Ce,Ct){return this.yy=Ct||this.yy||{},this._input=Ce,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var Ce=this._input[0];this.yytext+=Ce,this.yyleng++,this.offset++,this.match+=Ce,this.matched+=Ce;var Ct=Ce.match(/(?:\r\n?|\n).*/g);return Ct?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),Ce},unput:function(Ce){var Ct=Ce.length,Tt=Ce.split(/(?:\r\n?|\n)/g);this._input=Ce+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-Ct),this.offset-=Ct;var ke=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),Tt.length-1&&(this.yylineno-=Tt.length-1);var pi=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:Tt?(Tt.length===ke.length?this.yylloc.first_column:0)+ke[ke.length-Tt.length].length-Tt[0].length:this.yylloc.first_column-Ct},this.options.ranges&&(this.yylloc.range=[pi[0],pi[0]+this.yyleng-Ct]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(Ce){this.unput(this.match.slice(Ce))},pastInput:function(){var Ce=this.matched.substr(0,this.matched.length-this.match.length);return(Ce.length>20?"...":"")+Ce.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var Ce=this.match;return Ce.length<20&&(Ce+=this._input.substr(0,20-Ce.length)),(Ce.substr(0,20)+(Ce.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var Ce=this.pastInput(),Ct=new Array(Ce.length+1).join("-");return Ce+this.upcomingInput()+`
`+Ct+"^"},test_match:function(Ce,Ct){var Tt,ke,pi;if(this.options.backtrack_lexer&&(pi={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(pi.yylloc.range=this.yylloc.range.slice(0))),ke=Ce[0].match(/(?:\r\n?|\n).*/g),ke&&(this.yylineno+=ke.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:ke?ke[ke.length-1].length-ke[ke.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+Ce[0].length},this.yytext+=Ce[0],this.match+=Ce[0],this.matches=Ce,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(Ce[0].length),this.matched+=Ce[0],Tt=this.performAction.call(this,this.yy,this,Ct,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),Tt)return Tt;if(this._backtrack){for(var pt in pi)this[pt]=pi[pt];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var Ce,Ct,Tt,ke;this._more||(this.yytext="",this.match="");for(var pi=this._currentRules(),pt=0;pt<pi.length;pt++)if(Tt=this._input.match(this.rules[pi[pt]]),Tt&&(!Ct||Tt[0].length>Ct[0].length)){if(Ct=Tt,ke=pt,this.options.backtrack_lexer){if(Ce=this.test_match(Tt,pi[pt]),Ce!==!1)return Ce;if(this._backtrack){Ct=!1;continue}else return!1}else if(!this.options.flex)break}return Ct?(Ce=this.test_match(Ct,pi[ke]),Ce!==!1?Ce:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var Ct=this.next();return Ct||this.lex()},begin:function(Ct){this.conditionStack.push(Ct)},popState:function(){var Ct=this.conditionStack.length-1;return Ct>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(Ct){return Ct=this.conditionStack.length-1-Math.abs(Ct||0),Ct>=0?this.conditionStack[Ct]:"INITIAL"},pushState:function(Ct){this.begin(Ct)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(Ct,Tt,ke,pi){var pt=pi;switch(ke){case 0:this.begin("captext");return;case 1:return 58;case 2:return this.popState(),58;break;case 3:return 62;case 4:return 63;case 5:return 64;case 6:return 65;case 7:return 66;case 8:return 67;case 9:return 49;case 10:return 50;case 11:return 51;case 12:return 52;case 13:return 53;case 14:return 54;case 15:return 73;case 16:return 76;case 17:return 77;case 18:return 78;case 19:return 72;case 20:return 74;case 21:return 75;case 22:return 79;case 23:return 69;case 24:return 70;case 25:return 71;case 26:return 82;case 27:return 13;case 28:return 15;case 29:return 14;case 30:return 10;case 31:return 28;case 32:return 29;case 33:return 85;case 34:return 86;case 35:return 87;case 36:return 17;case 37:return 18;case 38:return 19;case 39:return 80;case 40:return 81;case 41:return 84;case 42:return Tt.yytext=this.matches[1],21;break;case 43:return Tt.yytext=this.matches[1],22;break;case 44:return Tt.yytext=this.matches[1],24;break;case 45:return 68;case 46:return 47;case 47:return 48;case 48:return 88;case 49:return 61;case 50:return 60;case 51:return 83;case 52:return 56;case 53:return 56;case 54:return 57;case 55:return Tt.yytext=this.matches[1],58;break;case 56:return 59;case 57:return;case 58:return 89;case 59:return;case 60:return 55;case 61:return 5;case 62:return 91}},rules:[/^(?:([,][,])(?=[A-Z]))/,/^(?:[A-Z](?=[A-Z]))/,/^(?:[A-Z])/,/^(?:["][6])/,/^(?:["][-])/,/^(?:["][4])/,/^(?:["][8])/,/^(?:["][9])/,/^(?:["][/])/,/^(?:[.][<])/,/^(?:[_][<])/,/^(?:["][<])/,/^(?:[.][>])/,/^(?:[_][>])/,/^(?:["][>])/,/^(?:["][7][@][:])/,/^(?:[_][@][<])/,/^(?:[\^][9])/,/^(?:[_][@][>])/,/^(?:["][7])/,/^(?:[@][<])/,/^(?:[@][>])/,/^(?:[@][9])/,/^(?:[.][0][O][F][ ]?)/,/^(?:[.][0])/,/^(?:[:][O])/,/^(?:[4][4][4])/,/^(?:[%][9])/,/^(?:[%])/,/^(?:[\+])/,/^(?:[95]+(?=.))/,/^(?:[<])/,/^(?:[>])/,/^(?:!)/,/^(?:[6])/,/^(?:[@]&)/,/^(?:[(])/,/^(?:[.][/])/,/^(?:[)])/,/^(?:#[L])/,/^(?:#-)/,/^(?:#=)/,/^(?:#([A-J4]+))/,/^(?:[/]([A-J4]+))/,/^(?:[#][/]([A-J4]+))/,/^(?:[_]?[/])/,/^(?:[1])/,/^(?:[4])/,/^(?:[7]+)/,/^(?:[_][\\][_][\\])/,/^(?:[_][\\])/,/^(?:[3])/,/^(?:(ARC)?(SIN|COS|TAN|CSC|SEC|COT)(H)?)/,/^(?:(ARG|DET|EXP|IM|INF|LIM|LN|LOG|MAX|MIN|MOD|RE|SUP))/,/^(?:[,]?[.][ABGDEZ\?\:IKLMNXOPRSTUYF\&W])/,/^(?:[,]([A-Z]))/,/^(?:[A-Z])/,/^(?:[,]['])/,/^(?:[8])/,/^(?:[;])/,/^(?:[ ])/,/^(?:$)/,/^(?:.)/],conditions:{captext:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62],inclusive:!0},INITIAL:{rules:[0,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62],inclusive:!0}}};return wi}();xe.lexer=Pt;function Fe(){this.yy={}}return Fe.prototype=xe,xe.Parser=Fe,new Fe}();typeof hb!="undefined"&&typeof r!="undefined"&&(r.parser=t,r.Parser=t.Parser,r.parse=function(){return t.parse.apply(t,arguments)},r.main=function(){},typeof e!="undefined"&&hb.main===e&&r.main(process.argv.slice(1)))}}),wA=["abs","ans","arccosh","arccot","arccoth","arccsc","arccsch","arcsec","arcsech","arcsinh","arctanh","binomialdist","boxplot","cdf","ceil","corr","cov","csch","distance","dotplot","erf","floor","gcf","histogram","IndependentTTest","iTTest","ittest","lcm","length","mad","mcd","mcm","mean","median","midpoint","mod","nCr","normaldist","nPr","pdf","poissondist","polygon","quantile","quartile","random","round","sech","sign","signum","sgn","stdDev","stddev","stdDevP","stddevp","stdev","stdevp","tdist","total","TScore","TScore","Tscore","tscore","tscore","TTest","ttest","var","variance","varp"],YE=wA,tJ=p8(wA),vA;function d8(r){let e=!1,t=0,i="",o="";for(let n of r)if(n.type==="terminal"&&/[A-Za-z]/.test(n.value))i+=n.value,t++;else break;return o=i.replace(vA,"\\operatorname{$1}"),e=t>0&&o!==i,{modified:e,terminalCount:t,value:o}}function CA(r){return YE.indexOf(r.toLowerCase())!==-1}function JE(r){if(!Array.isArray(r))throw new Error("Operator names must be an array, got "+typeof r);for(let e of r)if(typeof e!="string")throw new Error("Operator names must be strings, found "+typeof e);YE=r,rJ()}function XE(){YE=wA,vA=tJ}function rJ(){vA=p8(YE)}function p8(r){let e=r.sort((t,i)=>i.length-t.length||i.localeCompare(t)).join("|");return new RegExp("("+e+")","g")}var u8={};xA(u8,{command:()=>DA,fraction:()=>nJ,greek:()=>iJ,group:()=>SA,level:()=>g8,processPrimes:()=>oJ,radical:()=>aJ,terminal:()=>h8,typeform:()=>m8});function h8(r){return{type:"terminal",value:r}}function DA(r){return{type:"command",value:r}}function iJ(r){return{type:"greek",value:r}}function g8(r){return{subscript:r._,superscript:r["^"],type:"level"}}function oJ(r,e){let t=[],i=r.match(/'+/);if(i!==null){let o=i[0].length;for(let n=0;n<o;n++)t.push(DA("\\prime"))}return SA(t,e)}function nJ(r,e){return{type:"fraction",numerator:r,denominator:e}}function m8(r,e){return{name:r,type:"typeform",value:e}}function aJ(r,e){return{type:"radical",index:e,radicand:r}}function SA(...r){return Array.prototype.concat.apply([],r)}var qE={"~":"\\ ","\\,":"\\ ","\\:":"\\ ","\\;":"\\ ","\\!":"\\ "},Yq={"\\Vert":"\\|","\\ge":"\\geq","\\le":"\\leq","\\vert":"|"},sJ={"\\space":!0};function ph(r){let e=[];for(let t=0;t<r.length;t++){let i=r[t];switch(i.type){case"command":let o=i.value.slice(1).trim();Yq.hasOwnProperty(i.value)?e.push(DA(Yq[i.value])):CA(o)?e.push(m8("operator_name",lJ(o))):sJ[i.value]||e.push(i);break;case"level":let n={subscript:i.subscript&&i.subscript.length>0?ph(i.subscript):void 0,superscript:i.superscript&&i.superscript.length>0?ph(i.superscript):void 0,type:i.type};(n.subscript||n.superscript)&&e.push(n);break;case"fraction":e.push({denominator:ph(i.denominator),numerator:ph(i.numerator),type:i.type});break;case"radical":e.push({index:i.index?ph(i.index):void 0,radicand:ph(i.radicand),type:i.type});break;case"terminal":cJ(r.slice(t))?(e.push({type:"command",value:"\\ldots"}),t+=2):e.push({type:i.type,value:qE.hasOwnProperty(i.value)?qE[i.value]:i.value});break;case"typeform":e.push(i);break;case"greek":e.push({type:i.type,value:qE.hasOwnProperty(i.value)?qE[i.value]:i.value});break;default:throw new Error(`Unexpected item:
`+JSON.stringify({group:r,item:i}))}}return e}function lJ(r){let e=[];for(let t of r)e.push(h8(t));return e}function cJ(r){let e=0;for(let t=0;t<Math.min(3,r.length);t++){let i=r[t];i.type==="terminal"&&i.value==="."&&e++}return e===3}function kA(r){if(!r.hash)throw r;return{_diagnostic:{expected:r.hash.expected,message:r.message,text:r.hash.text,token:r.hash.token},location:r.hash.loc}}var f8=eJ();f8.parser.yy=u8;function b8(r){try{return{isError:!1,value:f8.parser.parse(r)}}catch(e){return{isError:!0,error:kA(e)}}}function dJ(r){return r.isError}function pJ(r,e){return dJ(r)?r:{isError:!1,value:e(r.value)}}function gb(r,e){let t=pJ(r,e);return r.warnings&&(t.warnings=r.warnings),t}function uJ(r){return gb(b8(r),e=>DJ(ph(e)))}var Jq={"!":"&","*":"@#",",":", ","/":"_/",":":"_3","<":' "K ',"=":" .K ",">":" .1 ","?":"_8","[":"@(","\\ ":" ","\\%":"@0","\\&":"_&","\\,":" ","\\infty":",=","\\int":"!","\\{":".(","\\|":"\\\\","\\}":".)","]":"@)","|":"\\"};function cA(r){return/^[a-z]$/.test(r.value)?r.value.toUpperCase():/^[A-Z]$/.test(r.value)?","+r.value:/^[0-9.]$/.test(r.value)||/^[+\-()]$/.test(r.value)?r.value:Jq.hasOwnProperty(r.value)?Jq[r.value]:"[terminal: "+r.value+"]"}var Xq={"\\Vert":"\\\\","\\cdot":"*","\\div":"./","\\ge":" .1: ","\\geq":" .1: ","\\langle":"..(","\\ldots":" ''' ","\\le":' "K: ',"\\leq":' "K: ',"\\ne":" /.K ","\\neq":" /.K ","\\approx":" @:@: ","\\nparallel":" /$L ","\\parallel":" $L ","\\perp":" $P ","\\prime":"'","\\prod":".,P","\\rangle":"..)","\\sim":"@:","\\sum":".,S","\\times":"@*","\\to":" $O ","\\vert":"\\"},Qq={"\\Alpha":".,A","\\Beta":".,B","\\Chi":".,&","\\Delta":".,D","\\Epsilon":".,E","\\Eta":".,:","\\Gamma":".,G","\\Iota":".,I","\\Kappa":".,K","\\Lambda":".,L","\\Mu":".,M","\\Nu":".,N","\\Omega":".,W","\\Omicron":".,O","\\Phi":".,F","\\Pi":".,P","\\Psi":".,Y","\\Rho":".,R","\\Sigma":".,S","\\Tau":".,T","\\Theta":".,?","\\Upsilon":".,U","\\Xi":".,X","\\Zeta":".,Z","\\alpha":".A","\\beta":".B","\\chi":".&","\\delta":".D","\\epsilon":".E","\\eta":".:","\\gamma":".G","\\iota":".I","\\kappa":".K","\\lambda":".L","\\mu":".M","\\nu":".N","\\omega":".W","\\omicron":".O","\\phi":".F","\\pi":".P","\\psi":".Y","\\rho":".R","\\sigma":".S","\\tau":".T","\\theta":".?","\\upsilon":".U","\\xi":".X","\\zeta":".Z"};function Zq(r){return Xq.hasOwnProperty(r.value)?Xq[r.value]:r.value.slice(1).toUpperCase()+" "}function hJ(r){return Qq.hasOwnProperty(r.value)?Qq[r.value]:r.value.slice(1).toUpperCase()+" "}function gJ(r){return r.value==="\\space"}function mJ(r,e){return r.isStartOfLine&&/^-?$/.test(e)||/\s-?$/.test(e)||r.wasFraction}function fJ(r){return r.value==="\\sum"||r.value==="\\prod"}function bJ(r,e){if(e>=r.length)return!1;let t=r[e];if(t.type==="terminal"){if(/^[0-9]$/.test(t.value))return!0;if(t.value!=="."||e+1>=r.length)return!1;if(t=r[e+1],t.type==="terminal")return/^[0-9]$/.test(t.value)}return!1}function hh(r,e){let t="",i=r.levelIndicator,o=0,n=!1;for(let a=0;a<e.length;a++){bJ(e,a)&&(i===""&&/[A-Z]$/.test(t)?t+=Yd(i):mJ(r,t)&&(t+="#"));let s=e[a],l=a<e.length-1?e[a+1]:null;switch(s.type!=="level"&&i!==r.levelIndicator&&(dA(s)?i="":(r.wasModifiedExpression&&r.levelIndicator===""?r=Vl(r,{wasModifiedExpression:!1}):t+=Yd(r.levelIndicator),i=r.levelIndicator)),s.type){case"terminal":!r.wasModifiedExpression&&i!==""&&dA(s)?t+=" "+Yd(i)+cA(s).trim()+" ":t+=cA(s),s.value==="."&&l&&(l.type==="terminal"&&/^[^_\d,]/.test(cA(l))||l.type==="greek")&&(t+='"'),r=Vl(r,{wasFraction:!1,wasRomanCommand:!1});break;case"command":if(!gJ(s)){let h=fJ(s);h&&(t+='"'),!h&&i!==""&&dA(s)?t+=" "+Yd(i)+Zq(s).trim()+" ":t+=Zq(s),r=Vl(r,{wasFraction:!1,wasModifiedExpression:h,wasRomanCommand:!0})}break;case"greek":t+=hJ(s),r=Vl(r,{wasFraction:!1});break;case"fraction":let c=yJ(r,s);t+=c.value,o=Math.max(o,c.fractionLevel),r=Vl(r,{wasFraction:!0,wasRomanCommand:!1});break;case"radical":let p=xJ(r,s);t+=p.value,o=Math.max(o,p.fractionLevel),r=Vl(r,{wasFraction:!1,wasRomanCommand:!1});break;case"level":!r.wasModifiedExpression&&r.wasRomanCommand?(n=/\s$/.test(t),n&&(t=t.replace(/\s$/,""))):n=!1;let u=t.length>0&&/[A-Za-z]/.test(t[t.length-1])===!0,m=wJ(r,u,n,s);t+=m.value,i=m.levelIndicator,r=Vl(r,{wasFraction:!1,wasRomanCommand:!1});break;case"typeform":t+=hh(r,s.value).value,s.name==="operator_name"&&(t+=" "),r=Vl(r,{wasFraction:!1,wasModifiedExpression:!1,wasRomanCommand:!1});break}}return{fractionLevel:o,levelIndicator:i,value:t}}function yJ(r,e){r=Vl(r,{isStartOfLine:!1});let t=hh(r,e.numerator),i=hh(r,e.denominator),o=Math.max(t.fractionLevel,i.fractionLevel),n="";for(let s=0;s<o;s++)n+=",";let a=n+"?"+t.value;return t.levelIndicator!==r.levelIndicator&&(a+=Yd(r.levelIndicator)),/\.$/.test(t.value)&&(a+='"'),a+=n+"/"+i.value,i.levelIndicator!==r.levelIndicator&&(a+=Yd(r.levelIndicator)),/\.$/.test(i.value)&&(a+='"'),a+=n+"#",{fractionLevel:o+1,value:a}}function xJ(r,e){let t=r.radicalLevel,i="",o="";for(let a=0;a<t;a++)o+=".";if(e.index){i+=o+"<";let a=hh(Vl(r,{isStartOfLine:!1}),e.index);i+=a.value,/\.$/.test(a.value)&&(i+='"'),a.levelIndicator!==r.levelIndicator&&(i+=Yd(r.levelIndicator)),i+=">"}else i+=o+">";let n=hh(Vl(r,{isStartOfLine:!1,radicalLevel:t+1}),e.radicand);return i+=n.value,/\.$/.test(n.value)&&(i+='"'),n.levelIndicator!==r.levelIndicator&&(i+=Yd(r.levelIndicator)),i+=o+"]",{fractionLevel:n.fractionLevel,value:i}}function wJ(r,e,t,i){let o=r.levelIndicator,n="",a=vJ(i.superscript);if(n+=a,i.subscript){r.wasModifiedExpression&&(n+="%"),o=r.levelIndicator+";";let s=hh(Vl(r,{isStartOfLine:!1,levelIndicator:o}),i.subscript);e&&/^[0-9]*(\.|\,)?[0-9]+$/.test(s.value)&&o.length<=1?o=r.levelIndicator:!r.wasModifiedExpression&&i.subscript[0]&&i.subscript[0].type!=="level"&&(n+=Yd(o)),n+=s.value,/\.$/.test(s.value)&&(n+='"')}if(i.superscript){r.wasModifiedExpression&&(n+="<"),o=r.levelIndicator+"^";let s=hh(Vl(r,{isStartOfLine:!1,levelIndicator:o}),i.superscript.slice(a.length));!r.wasModifiedExpression&&i.superscript[0]&&i.superscript[0].type!=="level"&&s.value!==""&&(n+=Yd(o)),n+=s.value,/\.$/.test(s.value)&&(n+='"')}return r.wasModifiedExpression?n+="]":r.wasRomanCommand&&t&&(n+=" ",o=o.slice(0,o.length-1)),{levelIndicator:o,value:n}}function vJ(r){let e="";if(r)for(let t of r)if(t.type==="command"&&t.value==="\\prime")e+="'";else break;return e}function Yd(r){return r||'"'}function CJ(){return{isStartOfLine:!0,levelIndicator:"",radicalLevel:0,wasFraction:!1,wasModifiedExpression:!1,wasRomanCommand:!1}}function Vl(r,e){return ub(ub({},r),e)}function dA(r){return r.type==="terminal"||r.type==="command"?/^<|>|\=|\\leq?|\\geq?|\\neq?$/.test(r.value):!1}function DJ(r){let e=CJ();return hh(e,r).value}function SJ(r){return gb(b8(r),e=>_J(ph(e)))}var e8={"!":"6","(":'"<',")":'">',"*":'"9',"+":'"6',",":"1","-":'"-',".":"4","/":"_/",":":"3","<":"@<","=":'"7',">":"@>","?":"8","[":".<","\\ ":" ","\\%":".0","\\&":"@&","\\,":" ","\\infty":"#=","\\int":"!","\\{":"_<","\\|":"_\\_\\","\\}":"_>","]":".>","|":"_\\"};function kJ(r,e,t){let i="",o=e.value,n=t&&t.type==="terminal"?t.value:"";return y8(o,r)&&(i+=";"),/^[\D]/.test(o)&&(r=Jd(r,{wasNumber:!1})),/^[a-z]$/.test(o)?r.capsLock?(r=Jd(r,{capsLock:!1}),i+=",'"+o.toUpperCase()):i+=o.toUpperCase():/^[A-Z]$/.test(o)?r.capsLock?i+=o:/[A-Z]/.test(n)?(r=Jd(r,{capsLock:!0}),i+=",,"+o):i+=","+o:(r=Jd(r,{capsLock:!1}),/^[0-9.]$/.test(o)?i+=VJ(o):e8.hasOwnProperty(o)?i+=e8[o]:i+="[terminal: "+o+"]"),{value:i,ctx:r}}var t8={"\\Vert":"_\\_\\","\\cdot":'"4',"\\div":'"/',"\\ge":"_@>","\\geq":"_@>","\\langle":"@<","\\ldots":"444","\\le":"_@<","\\leq":"_@<","\\ne":'"7@:',"\\neq":'"7@:',"\\approx":"^9","\\parallel":"#L","\\perp":"#-","\\prime":"7","\\prod":",.P","\\rangle":"@>","\\sim":"@9","\\sum":",.S","\\times":'"8',"\\to":":O","\\vert":"_\\"},r8={"\\Alpha":",.A","\\Beta":",.B","\\Chi":",.&","\\Delta":",.D","\\Epsilon":",.E","\\Eta":",.:","\\Gamma":",.G","\\Iota":",.I","\\Kappa":",.K","\\Lambda":",.L","\\Mu":",.M","\\Nu":",.N","\\Omega":",.W","\\Omicron":",.O","\\Phi":",.F","\\Pi":",.P","\\Psi":",.Y","\\Rho":",.R","\\Sigma":",.S","\\Tau":",.T","\\Theta":",.?","\\Upsilon":",.U","\\Xi":",.X","\\Zeta":",.Z","\\alpha":".A","\\beta":".B","\\chi":".&","\\delta":".D","\\epsilon":".E","\\eta":".:","\\gamma":".G","\\iota":".I","\\kappa":".K","\\lambda":".L","\\mu":".M","\\nu":".N","\\omega":".W","\\omicron":".O","\\phi":".F","\\pi":".P","\\psi":".Y","\\rho":".R","\\sigma":".S","\\tau":".T","\\theta":".?","\\upsilon":".U","\\xi":".X","\\zeta":".Z"};function EJ(r,e){let t;return t8.hasOwnProperty(r.value)?t=t8[r.value]:t=r.value.slice(1).toUpperCase()+" ",y8(t,e)&&(t=";"+t),/^[\D]/.test(t)&&(e=Jd(e,{wasNumber:!1})),{value:t,ctx:e}}function GJ(r){return r8.hasOwnProperty(r.value)?r8[r.value]:r.value.slice(1).toUpperCase()+" "}function TJ(r){return r.value==="\\space"}function IJ(r,e){if(e<r.length){let t=r[e];if(t.type==="terminal"){if(/^\d$/.test(t.value))return!0;if(t.value!=="."||e+1>=r.length)return!1;if(t=r[e+1],t.type==="terminal")return/^\d$/.test(t.value)}}return!1}function VJ(r){let e="",t="A".charCodeAt(0)-1;for(let i of r)i===","?e+="1":i==="."?e+="4":i==="0"?e+="J":e+=String.fromCharCode(t+Number(i));return e}function gh(r,e){let t,i,o="",n=!0;for(let a=0;a<e.length;a++){IJ(e,a)?(r=Jd(r,{wasNumber:!0}),n&&(o+="#",n=!1)):n=!0;let s=e[a];switch(s.type){case"terminal":let l=a<e.length-1?e[a+1]:void 0;t=kJ(r,s,l),r=t.ctx,o+=t.value,o[o.length-1]===" "&&(n=!0);break;case"command":TJ(s)||(i=EJ(s,r),r=i.ctx,o+=i.value,o[o.length-1]===" "&&(n=!0));break;case"greek":o+=GJ(s),o[o.length-1]===" "&&(n=!0);break;case"fraction":let c=MJ(r,s);o+=c.value,r=c.ctx,n=!1;break;case"radical":let p=AJ(r,s);o+=p.value,n=!0;break;case"level":let u=LJ(r,s);o+=u.value,r=u.ctx,n=!0;break;case"typeform":let m=gh(r,s.value).value;o+=m,/(ARC)?(SIN|COS|TAN|CSC|SEC|COT)(H)?/.test(m)&&(o+=" ");break}}return{ctx:r,value:o}}function y8(r,e){return e.wasNumber&&/^[A-Ja-j]/.test(r)}function MJ(r,e){let t=gh(r,e.numerator),i=gh(r,e.denominator),o;return hA(t.value)&&hA(i.value)?(r=Jd(r,{wasNumber:!0}),o=t.value+"/"+i.value.slice(1)):(r=Jd(r,{wasNumber:!1}),o="("+t.value+"./"+i.value+")"),{ctx:r,value:o}}function hA(r){return/^\#[A-J41]+$/.test(r)}function AJ(r,e){let t="%",i=gh(r,e.radicand);if(e.index){let o=gh(r,SA(g8({"^":e.index})));t+=o.value,/\#[A-J]$/.test(o.value)&&/^[A-J]/.test(i.value)&&(t+=";")}return t+=i.value+"+",{ctx:r,value:t}}function LJ(r,e){let t="",i=OJ(e.superscript);t+=i;let o;if(e.subscript){let n=gh(r,e.subscript);o8(e.subscript,n.value,0)?o="<"+i8(n.value)+">":o=n.value,r=Jd(r,{wasNumber:n.ctx.wasNumber}),o!==""&&(t+="5"+o)}if(e.superscript){let n=gh(r,e.superscript.slice(i.length));o8(e.superscript,n.value,i.length)?o="<"+i8(n.value)+">":o=n.value,r=Jd(r,{wasNumber:n.ctx.wasNumber}),(i===""||o!=="")&&(t+="9"+o)}return{ctx:r,value:t}}function i8(r){return/^;/.test(r)?r.slice(1):r}function OJ(r){let e="";if(r)for(let t of r)if(t.type==="command"&&t.value==="\\prime")e+="7";else break;return e}function o8(r,e,t){let i=r[0],o=(e.match(/\</g)||[]).length,n=/^["|\.|_]?\</.test(e),a=(e.match(/\>/g)||[]).length,s=/["|\.|_]?\>$/.test(e);return!hA(e)&&r.length-t>1&&o===0&&a===0||o>0&&a>0&&(!n||!s)||o>1||a>1||i&&i.type==="typeform"}function PJ(){return{capsLock:!1,wasNumber:!1}}function Jd(r,e){return ub(ub({},r),e)}function _J(r){let e=PJ();return gh(e,r).value}var gA={};xA(gA,{baseline:()=>qJ,command:()=>RJ,comparison:()=>BJ,expression:()=>WJ,fraction:()=>zJ,greek:()=>jJ,group:()=>YJ,level:()=>EA,level_with_comparison:()=>NJ,modified_expression:()=>UJ,primes:()=>KJ,radical:()=>HJ,simple_subscript:()=>$J,terminal:()=>FJ});function FJ(r){return{type:"terminal",value:r}}function RJ(r){return{type:"command",value:"\\"+r.trim()+" "}}var x8={'"K':"<",'"K:':"\\leq ",$L:"\\parallel ",$O:"\\to ",$P:"\\perp ",".1":">",".1:":"\\geq ",".K":"=","@:@:":"\\approx","/$L":"\\nparallel ","/.K":"\\neq ","=":"=","@:":"\\sim "};function NJ(r){let e=/[\^;]+/.exec(r),t=e?e.toString():"",i=r.slice(EA.length);return{type:"level_with_comparison",level:t,value:x8[i]}}function BJ(r){return{type:"comparison",value:x8[r]}}function EA(r){return{type:"level",value:r}}function qJ(){return EA("")}function KJ(r){return{type:"primes",value:r}}function zJ(r,e){return{type:"fraction",numerator:r,denominator:e}}function UJ(r,e,t){return{type:"modified_expression",expression:r,under:e,over:t}}function HJ(r,e){return{type:"radical",value:r,index:e}}function WJ(r){return{type:"expression",value:r}}function $J(r,e){return{type:"simple_subscript",base:r,subscript:e}}var n8={".&":"\\chi",".,&":"\\Chi",".,:":"\\Eta",".,?":"\\Theta",".,A":"\\Alpha",".,B":"\\Beta",".,D":"\\Delta",".,E":"\\Epsilon",".,F":"\\Phi",".,G":"\\Gamma",".,I":"\\Iota",".,K":"\\Kappa",".,L":"\\Lambda",".,M":"\\Mu",".,N":"\\Nu",".,O":"\\Omicron",".,P":"\\prod",".,R":"\\Rho",".,S":"\\sum",".,T":"\\Tau",".,U":"\\Upsilon",".,W":"\\Omega",".,X":"\\Xi",".,Y":"\\Psi",".,Z":"\\Zeta",".:":"\\eta",".?":"\\theta",".A":"\\alpha",".B":"\\beta",".D":"\\delta",".E":"\\epsilon",".F":"\\phi",".G":"\\gamma",".I":"\\iota",".K":"\\kappa",".L":"\\lambda",".M":"\\mu",".N":"\\nu",".O":"\\omicron",".P":"\\pi",".R":"\\rho",".S":"\\sigma",".T":"\\tau",".U":"\\upsilon",".W":"\\omega",".X":"\\xi",".Y":"\\psi",".Z":"\\zeta"};function jJ(r){if(n8.hasOwnProperty(r))return n8[r]+" ";throw new Error("Unknown Greek letter")}function YJ(...r){return Array.prototype.concat.apply([],r)}var GA=l8(),WE=GA.parser.lexer,Vg=Object.create(WE),JJ=Vg,xw=GA.parser.terminals_,bn=GA.parser.symbols_;Vg.setInput=function(r,e){this.delimiterStack=[],this.outputQueue=[],this.canAcceptPrimes=!1,WE.setInput.call(this,r,e)};Vg.lex=function(){let r=-1;if(!this)return r;if(this.outputQueue.length)return this.outputQueue.shift();let e=WE.lex.call(this);for(;xw[e]==="UNKNOWN"||!this.canAcceptPrimes&&xw[e]==="PRIMES";)this.warn(),e=WE.lex.call(this);this.canAcceptPrimes=!0;let t,i,o=this.delimiterStack?this.delimiterStack[this.delimiterStack.length-1]:-1;switch(xw[e]){case"OPEN_FRAC":case"OPEN_MODEXP":this.delimiterStack.push(e),this.canAcceptPrimes=!1;break;case"RADICAL_INDEX":o===bn.RADICAL_INDEX&&(this.delimiterStack.pop(),this.pushCloseTokens(o)),this.delimiterStack.push(e),this.canAcceptPrimes=!1;break;case"OPEN_RADICAL":o===bn.RADICAL_INDEX&&this.delimiterStack.pop(),this.delimiterStack.push(e),this.canAcceptPrimes=!1;break;case"SLASH":for(t=!1;this.delimiterStack.length;)if(i=this.delimiterStack.pop()||-1,i===bn.OPEN_FRAC){t=!0;break}else this.pushCloseTokens(i);t||this.pushOpenTokens(e),this.delimiterStack.push(e),this.canAcceptPrimes=!1;break;case"CLOSE_FRAC":for(t=!1;this.delimiterStack.length;)if(i=this.delimiterStack.pop()||-1,i===bn.SLASH){t=!0;break}else if(i===bn.OPEN_FRAC){this.addMissingToken(bn.SLASH),t=!0;break}else this.pushCloseTokens(i);if(!t)return this.warn(),this.canAcceptPrimes=!1,this.lex();break;case"CLOSE_RADICAL":for(t=!1;this.delimiterStack.length;)if(i=this.delimiterStack.pop()||-1,i===bn.OPEN_RADICAL){t=!0;break}else if(i===bn.RADICAL_INDEX){t=!0,this.addMissingToken(bn.OPEN_RADICAL);break}else this.pushCloseTokens(i);t||this.pushOpenTokens(e);break;case"CLOSE_MODEXP":for(t=!1;this.delimiterStack.length;)if(i=this.delimiterStack.pop()||-1,i===bn.OPEN_MODEXP){t=!0;break}else this.pushCloseTokens(i);t||this.pushOpenTokens(e);break;case"EOF":for(;this.delimiterStack.length;)i=this.delimiterStack.pop()||-1,this.pushCloseTokens(i);break}return this.outputQueue.push(e),r=this.outputQueue.shift()||-1,r};Vg.warn=function(){this.yylloc&&this.yy.warnings.push({location:this.yylloc})};Vg.addMissingToken=function(r){this.outputQueue.push(r),this.warn()};Vg.pushCloseTokens=function(r){switch(xw[r]){case"OPEN_FRAC":this.addMissingToken(bn.SLASH),this.addMissingToken(bn.CLOSE_FRAC);break;case"SLASH":this.addMissingToken(bn.CLOSE_FRAC);break;case"RADICAL_INDEX":this.addMissingToken(bn.OPEN_RADICAL),this.addMissingToken(bn.CLOSE_RADICAL);break;case"OPEN_RADICAL":this.addMissingToken(bn.CLOSE_RADICAL);break;case"OPEN_MODEXP":this.addMissingToken(bn.CLOSE_MODEXP);break}};Vg.pushOpenTokens=function(r){switch(xw[r]){case"SLASH":this.addMissingToken(bn.OPEN_FRAC);break;case"CLOSE_FRAC":this.addMissingToken(bn.OPEN_FRAC),this.addMissingToken(bn.SLASH);break;case"CLOSE_RADICAL":this.addMissingToken(bn.OPEN_RADICAL);break;case"CLOSE_MODEXP":this.addMissingToken(bn.OPEN_MODEXP);break}};var XJ=l8();function QJ(r,e){e||(e={});let t=XJ.parser,i=Object.create(t);i.yy=gA,i.yy.warnOrError=n=>{i.parseError(n,{recoverable:!1})};let o=Object.create(t);o.yy=ub({warnings:[]},gA),o.yy.warnOrError=n=>{o.yy.warnings.push(n)},o.lexer=JJ,e.strict?t=i:t=o;try{return{isError:!1,value:t.parse(r),warnings:t.yy.warnings||[]}}catch(n){return{error:kA(n),isError:!0}}}function uh(r,e){let t="",i=e,o="",n=!1,a="",s="",l=ZJ(r);for(let c=0;c<r.length;c++){let p=r[c],u=c+1<r.length?r[c+1]:null;switch(p.type){case"terminal":let m=d8(r.slice(c));m.value!==""?(t+=m.value,c+=m.terminalCount-1,n=n||m.modified):p.value===" "?(n?(o=a,t+=yw(i,o),i=o):t+="\\ ",n=!1):(l[c]===UE?t+="\\left":l[c]===mA&&(t+="\\right"),t+=p.value);break;case"comparison":o="",t+=yw(i,o),i=o,n=!1,t+=p.value;break;case"level_with_comparison":t+=yw(i,p.level),i=p.level,n=!1,t+=p.value;break;case"command":let h=p.value.slice(1).trim();u&&u.type==="terminal"&&/[a-z]/.test(u.value)?(t+=h,n=!1):CA(h)?(t+="\\operatorname{"+h+"}",n=!0):(t+=p.value,n=!0),a=i;break;case"expression":t+=p.value;break;case"fraction":t+=iX(p.numerator,p.denominator,i);break;case"modified_expression":t+=uh(p.expression,i)+" ",p.under&&(t+="_{"+uh(p.under,i)+"}"),p.over&&(t+="^{"+uh(p.over,i)+"}");break;case"radical":t+="\\sqrt",p.index&&(t+="["+uh(p.index,i)+"]"),t+="{"+uh(p.value,i)+"}";break;case"simple_subscript":i===""?(t+=p.base.value+"_{"+p.subscript.value+"}",p.base.type==="command"&&(n=!0,a=i)):t+=p.base.value+p.subscript.value;break;case"level":t+=yw(i,p.value,s),i=p.value,p.value==="^"&&s!==""&&(s="");break;case"primes":u&&u.type==="level"&&u.value===";"?s=p.value:i!==""?(t+=Array(p.value.length+1).join("\\prime "),s=""):(t+=p.value,s="");break}}return t+=yw(i,e)+s,t.replace(/([^\\])( )$/,"$1")}var UE=1,mA=-1,KE=0,pA=2;function ZJ(r){let e=[],t=[];for(let i=0;i<r.length;i++){let o=r[i];if(eX(o))e.push({direction:UE,index:i}),t.push(KE);else if(tX(o)){for(;e.length&&e[e.length-1].direction===pA;)e.pop();if(e.length){let n=e.pop();if(n){let a=n.index;t[a]=UE,t.push(mA)}}else t.push(KE)}else if(rX(o))if(e.length&&e[e.length-1].direction===pA){let n=e.pop();if(n){let a=n.index;t[a]=UE,t.push(mA)}}else e.push({direction:pA,index:i}),t.push(KE);else t.push(KE)}return t}function eX(r){return r.type==="terminal"?/^(\\langle |\[|\(|\\{)$/.test(r.value):!1}function tX(r){return r.type==="terminal"?/^(\\rangle |\]|\)|\\})$/.test(r.value):!1}function rX(r){return r.type==="terminal"?/^(\\\||\|)$/.test(r.value):!1}function iX(r,e,t){return"\\frac{"+uh(r,t)+"}{"+uh(e,t)+"}"}function yw(r,e,t){let i="",o,n,a,s=Math.max(r.length,e.length);for(o=0;o<s&&r[o]===e[o];o++);for(n=r.length-1;n>=o;n--)i+="}";for(a=o;a<e.length;a++)e[a]==="^"&&(t&&(i+=t),i+="^{"),e[a]===";"&&(i+="_{");return i}function oX(r){return uh(r,"")}function nX(r,e){return e&&e.operatorNames?JE(e.operatorNames):XE(),gb(QJ(r,e),oX)}var TA=c8(),$E=TA.parser.lexer,Mg=Object.create($E),aX=Mg,jE=TA.parser.terminals_,da=TA.parser.symbols_;Mg.setInput=function(r,e){this.delimiterStack=[],this.outputQueue=[],$E.setInput.call(this,r,e)};Mg.lex=function(){let r=-1;if(this.outputQueue.length)return this.outputQueue.shift();let e=$E.lex.call(this);for(;jE[e]==="UNKNOWN";)this.warn(),e=$E.lex.call(this);let t,i,o=this.delimiterStack?this.delimiterStack[this.delimiterStack.length-1]:-1;switch(jE[e]){case"OPEN_FRAC":this.delimiterStack.push(e);break;case"OPEN_GROUP":this.delimiterStack.push(e);break;case"RADICAL_WITH_INDEX":o===da.RADICAL_WITH_INDEX&&(this.delimiterStack.pop(),this.pushCloseTokens(o)),this.delimiterStack.push(e);break;case"RADICAL":o===da.RADICAL_WITH_INDEX&&this.delimiterStack.pop(),this.delimiterStack.push(e);break;case"OVER":for(t=!1;this.delimiterStack.length;)if(i=this.delimiterStack.pop()||-1,i===da.OPEN_FRAC){t=!0;break}else this.pushCloseTokens(i);t||this.pushOpenTokens(e),this.delimiterStack.push(e);break;case"CLOSE_FRAC":for(t=!1;this.delimiterStack.length;)if(i=this.delimiterStack.pop()||-1,i===da.OVER){t=!0;break}else if(i===da.OPEN_FRAC){this.outputQueue.push(da.OVER),t=!0;break}else this.pushCloseTokens(i);t||this.pushOpenTokens(e);break;case"CLOSE_GROUP":for(t=!1;this.delimiterStack.length;)if(i=this.delimiterStack.pop()||-1,i===da.OPEN_GROUP){t=!0;break}else this.pushCloseTokens(i);t||this.pushOpenTokens(e);break;case"CLOSE_RADICAL":for(t=!1;this.delimiterStack.length;)if(i=this.delimiterStack.pop()||-1,i===da.RADICAL||i===da.RADICAL_WITH_INDEX){t=!0;break}else this.pushCloseTokens(i);t||this.pushOpenTokens(e);break;case"EOF":for(;this.delimiterStack.length;)i=this.delimiterStack.pop()||-1,this.pushCloseTokens(i);break}return this.outputQueue.push(e),r=this.outputQueue.shift()||-1,r};Mg.warn=function(){this.yylloc&&this.yy.warnings.push({location:this.yylloc})};Mg.addMissingToken=function(r){this.outputQueue.push(r),this.warn()};Mg.pushCloseTokens=function(r){switch(jE[r]){case"OPEN_FRAC":this.addMissingToken(da.OVER),this.addMissingToken(da.CLOSE_FRAC);break;case"OVER":this.addMissingToken(da.CLOSE_FRAC);break;case"OPEN_GROUP":this.addMissingToken(da.CLOSE_GROUP);break;case"RADICAL_WITH_INDEX":case"RADICAL":this.addMissingToken(da.CLOSE_RADICAL);break}};Mg.pushOpenTokens=function(r){switch(jE[r]){case"OVER":this.addMissingToken(da.OPEN_FRAC);break;case"CLOSE_FRAC":this.addMissingToken(da.OPEN_FRAC),this.addMissingToken(da.OVER);break;case"CLOSE_GROUP":this.addMissingToken(da.OPEN_GROUP);break;case"CLOSE_RADICAL":this.addMissingToken(da.RADICAL);break}};var fA={};xA(fA,{basic_level:()=>cX,bracketed_level:()=>dX,command:()=>lX,expression:()=>gX,fraction:()=>uX,greek:()=>fX,group:()=>mX,primes:()=>pX,radical:()=>hX,terminal:()=>sX,to_number:()=>bX});function sX(r){return{type:"terminal",value:r}}function lX(r){return{type:"command",value:r}}function cX(r,e){return{type:"basic_level",level:r,value:e}}function dX(r,e,t,i){return{type:"bracketed_level",level:r,lbrack:e,value:t,rbrack:i}}function pX(r){return{type:"primes",value:r.length>0?Array(r.length+1).join("'"):""}}function uX(r,e){return{type:"fraction",numerator:r,denominator:e}}function hX(r,e){return{type:"radical",value:r,index:e}}function gX(r){return{type:"expression",value:r}}function mX(...r){return Array.prototype.concat.apply([],r)}var a8={",.&":"\\Chi",",.:":"\\Eta",",.?":"\\Theta",",.A":"\\Alpha",",.B":"\\Beta",",.D":"\\Delta",",.E":"\\Epsilon",",.F":"\\Phi",",.G":"\\Gamma",",.I":"\\Iota",",.K":"\\Kappa",",.L":"\\Lambda",",.M":"\\Mu",",.N":"\\Nu",",.O":"\\Omicron",",.P":"\\prod",",.R":"\\Rho",",.S":"\\sum",",.T":"\\Tau",",.U":"\\Upsilon",",.W":"\\Omega",",.X":"\\Xi",",.Y":"\\Psi",",.Z":"\\Zeta",".&":"\\chi",".:":"\\eta",".?":"\\theta",".A":"\\alpha",".B":"\\beta",".D":"\\delta",".E":"\\epsilon",".F":"\\phi",".G":"\\gamma",".I":"\\iota",".K":"\\kappa",".L":"\\lambda",".M":"\\mu",".N":"\\nu",".O":"\\omicron",".P":"\\pi",".R":"\\rho",".S":"\\sigma",".T":"\\tau",".U":"\\upsilon",".W":"\\omega",".X":"\\xi",".Y":"\\psi",".Z":"\\zeta"};function fX(r){if(a8.hasOwnProperty(r))return a8[r]+" ";throw new Error("Unknown Greek letter")}function bX(r){let e="",t="A".charCodeAt(0)-1;for(let i of r)i==="4"?e+=".":i==="J"?e+="0":e+=i.charCodeAt(0)-t;return e}var yX=c8();function xX(r,e){e||(e={});let t=yX.parser,i=Object.create(t);i.yy=fA;let o=Object.create(t);o.yy=ub({warnings:[]},fA),o.lexer=aX,e.strict?t=i:t=o;try{return{isError:!1,value:t.parse(r),warnings:t.yy.warnings||[]}}catch(n){return{error:kA(n),isError:!0}}}function Ig(r,e){let t="",i=!1,o="",n=wX(r);for(let a=0;a<r.length;a++){let s=r[a],l=a+1<r.length?r[a+1]:null;switch(s.type){case"terminal":let c=d8(r.slice(a));c.value!==""?(t+=c.value,a+=c.terminalCount-1):s.value===" "&&!i?t+="\\ ":(n[a]===HE?t+="\\left":n[a]===bA&&(t+="\\right"),t+=s.value),i=!1;break;case"command":let p=s.value.slice(1).trim();l&&l.type==="terminal"&&/[a-z]/.test(l.value)?(t+=p,i=!1):CA(p)?(t+="\\operatorname{"+p+"}",i=!0):(t+=s.value,i=!0);break;case"expression":t+=s.value;break;case"fraction":t+=SX(s.numerator,s.denominator);break;case"radical":t+="\\sqrt",s.index&&(t+="["+Ig(s.index)+"]"),t+="{"+Ig(s.value)+"}";break;case"basic_level":t+=kX(s.level,s.value,o),s.level==="9"&&(o="");break;case"bracketed_level":t+=EX(s.level,s.lbrack,s.value,s.rbrack,o),s.level==="9"&&(o="");break;case"primes":l&&(l.type==="basic_level"||l.type==="bracketed_level")&&l.level==="5"?o=s.value:e&&e!==""?(t+=Array(s.value.length+1).join("\\prime "),o=""):(t+=s.value,o="");break}}return t+=o,t.replace(/([^\\])( )$/,"$1")}var HE=1,bA=-1,zE=0,uA=2;function wX(r){let e=[],t=[];for(let i=0;i<r.length;i++){let o=r[i];if(vX(o))e.push({direction:HE,index:i}),t.push(zE);else if(CX(o)){for(;e.length&&e[e.length-1].direction===uA;)e.pop();if(e.length){let n=e.pop();if(n){let a=n.index;t[a]=HE,t.push(bA)}}else t.push(zE)}else if(DX(o))if(e.length&&e[e.length-1].direction===uA){let n=e.pop();if(n){let a=n.index;t[a]=HE,t.push(bA)}}else e.push({direction:uA,index:i}),t.push(zE);else t.push(zE)}return t}function vX(r){return r.type==="terminal"?/^(\\langle |\[|\(|\\{)$/.test(r.value):!1}function CX(r){return r.type==="terminal"?/^(\\rangle |\]|\)|\\})$/.test(r.value):!1}function DX(r){return r.type==="terminal"?/^(\\\||\|)$/.test(r.value):!1}function SX(r,e){return"\\frac{"+Ig(r)+"}{"+Ig(e)+"}"}function kX(r,e,t){let i="",o="{"+Ig(e,r)+"}";return r==="9"?i+=t+"^"+o:r==="5"&&(i+="_"+o),i}function EX(r,e,t,i,o){let n="",a="{"+e+Ig(t,r)+i+"}";return r==="9"?n+=o+"^"+a:r==="5"&&(n+="_"+a),n}var GX=Ig;function TX(r,e){return e&&e.operatorNames?JE(e.operatorNames):XE(),gb(xX(r,e),t=>GX(t,""))}var w8=` A1B'K2L@CIF/MSP"E3H9O6R^DJG>NTQ,*5<-U8V.%[$+X!&;:4\\0Z7(_?W]#Y)=`,v8=10240;function IX(r){return String.fromCharCode(v8+r)}function VX(r){return r.charCodeAt(0)-v8}function MX(r){return w8[r]}function AX(r){return w8.indexOf(r)}function LX(r){let e="";for(let t of r)e+=IX(AX(t));return e}function C8(r){let e="";for(let t of r)e+=MX(VX(t));return e}function OX(r){return C8(r).replace(/[@-^]/g,e=>String.fromCharCode(e.charCodeAt(0)+32))}function PX(r){let e="";if(r)for(let t of r){let i=t.charCodeAt(0);96<=i&&i<=127&&(i-=32,t=String.fromCharCode(i)),32<=i&&i<=95&&(t=LX(t),i=t.charCodeAt(0)),10305<=i&&i<=10495&&(i=10240+(i-1024)%64,t=String.fromCharCode(i)),10240<=i&&i<=10304?e+=t:e+=String.fromCharCode(10240)}return e}function _X(r){for(let e=0;e<r.length;e++){let t=r.charCodeAt(e);if(t<10240||t>10304)return!1}return!0}function D8(r){if(!_X(r))throw new Error("EncodingError: Expected input to be six-dot unicode braille characters.")}function IA(r,e){return D8(r),nX(Ba.toBrailleAscii(r),e)}function Xp(r,e){return e&&e.operatorNames?JE(e.operatorNames):XE(),gb(uJ(r),Ba.coerceToSixDotCells)}function VA(r,e){return D8(r),TX(Ba.toBrailleAscii(r),e)}function Qp(r,e){return e&&e.operatorNames?JE(e.operatorNames):XE(),gb(SJ(r),Ba.coerceToSixDotCells)}var Ba={coerceToSixDotCells:PX,toBrailleAscii:C8,toExpandedBrailleAscii:OX},FX="1.0.3";var RX=10240;function NX(r,e,t,i,o){let{dotSpacing:n}=r,a=1+n;var s=o.charCodeAt(0)-RX;s&1&&e.fillRect(t,i,1,1),s&2&&e.fillRect(t,i+a,1,1),s&4&&e.fillRect(t,i+2*a,1,1),s&8&&e.fillRect(t+a,i,1,1),s&16&&e.fillRect(t+a,i+a,1,1),s&32&&e.fillRect(t+a,i+2*a,1,1)}function e0(r,e){let{x:t,y:i,width:o,height:n}=e,a=r.getImageData(t,i,o,n).data;for(let s=3;s<a.length;s+=4)if(a[s]!==0)return!1;return!0}function BX(r,e){let{x:t,y:i,width:o,height:n}=e,a=r.getImageData(t,i,o,n).data;for(let s=3;s<a.length;s+=4)if(a[s]===0)return!1;return!0}function MA(r,e,t,i,o){return e0(e,r0(r,t,i,o))}function qX(r,e,t,i,o){let{dotSpacing:n}=r,a=3+2*n;for(var s=0;s<o.length;s++)NX(r,e,t+a*s,i,o[s])}function eu(r,e){let{dotSpacing:t}=r;return(2+t)*e.length+(1+t)*(e.length-1)}function t0(r,e){let{dotSpacing:t}=r;return 3+2*t}function r0(r,e,t,i){let{cellPadding:o}=r;return{x:e-o,y:t-o,width:eu(r,i)+2*o,height:t0(r,i)+2*o}}function QE(r,e){if(!r)return e;let t=Math.min(r.x,e.x),i=Math.min(r.y,e.y),o=Math.max(r.x+r.width,e.x+e.width)-t,n=Math.max(r.y+r.height,e.y+e.height)-i;return{x:t,y:i,width:o,height:n}}function S8(r,e,t){return Math.min(Math.max(r,e),t)}function ww(r,e,t,i,o){return{x:S8(t,0,e.canvas.width-eu(r,o)),y:S8(i,0,e.canvas.height-t0(r,o))}}function vw(r,e,t,i,o){let n=e.fillStyle;e.fillStyle="white";let a=r0(r,t,i,o);e.fillRect(a.x,a.y,a.width,a.height),e.fillStyle="black",qX(r,e,t,i,o),e.fillStyle=n}function AA(r,e,t,i){let{cellPadding:o}=r;return{x:Math.round(e-(eu(r,i)+o)),y:t}}function KX(r){return r.replace(/\u283C(?!$)/g,"")}function Zp(r,e){let t=e==="nemeth"?Xp(r):Qp(r);return t.isError?"":KX(t.value)}function fb(r,e){return e>=0?r*Math.pow(10,e):r/Math.pow(10,-e)}function E8(r,e,t,i){let[o,n]=t,a=Math.ceil(Math.log(n-o)/Math.LN10)-1,s=a,l=5,c=15;e:for(let u=a;a-u<4;u--)for(let m of[5,2,1]){let h=fb(m,u),x=Math.floor(o/h)+1,C=Math.ceil(n/h)-1;var p=Math.abs(i(h)-i(0));let D=Zp(String(fb(x*m,u)),e),k=Zp(String(fb(C*m,u)),e);if(p<eu(r,D)+eu(r," ")||p<eu(r,k)+eu(r," ")||C-x>=c)break e;s=u,l=m}return{int:l,exp:s}}function G8(r,e,t){return E8(r,e,[t.viewport.xmin,t.viewport.xmax],i=>t.mapx(i))}function zX(r,e,t){return t.viewport.isSquare(t.screen,{xAxisScale:t.settings.xAxisScale,yAxisScale:t.settings.yAxisScale})?G8(r,e,t):E8(r,e,[t.viewport.ymin,t.viewport.ymax],i=>t.mapy(i))}function k8(r,e){let{int:t,exp:i}=r,[o,n]=e,a=Math.ceil(o/fb(t,i)),s=Math.floor(n/fb(t,i)),l=[];for(var c=a;c<=s;c++)l.push(fb(c*t,i));return l}function UX(r,e,t){return{x:k8(G8(r,e,t),[t.viewport.xmin,t.viewport.xmax]),y:k8(zX(r,e,t),[t.viewport.ymin,t.viewport.ymax])}}function T8(r,e,t,i,o){if(t.margins===void 0||e===void 0)return;let n=HX(i),a=t.margins,s=__dcg_shared_module_exports__['a']({},e.settings),l=s.showGrid&&WX(i),c=!!s.showXAxis,p=!!s.showYAxis,u=!!s.xAxisNumbers,m=s.xAxisArrowMode,h=!!s.yAxisNumbers,x=s.yAxisArrowMode,C=n.graphLineWidth,D={showGrid:!1,xAxisNumbers:!1,xAxisArrowMode:"NONE",yAxisNumbers:!1,yAxisArrowMode:"NONE",showXAxis:!1,showYAxis:!1,graphLineWidth:C,pointLineWidth:2.5,curveOpacity:1,globalCurveColor:"#000",disableFill:!0};for(let J in D)e.settings[J]=D[J];let k=r.width-a.right-a.left,M=r.height-a.top-a.bottom,I=new jd(k,M),S=e.getProjection().viewport;e.settings.squareAxes&&(S=S.squareCrop(I,e.settings));let V=new Wc(I,S,e.settings),P=r.getContext("2d"),L=document.createElement("canvas");L.width=k,L.height=M;let B=L.getContext("2d"),R=document.createElement("canvas");R.width=k,R.height=M;let W=R.getContext("2d"),re=document.createElement("canvas");re.width=k,re.height=M;let ne=re.getContext("2d"),X=document.createElement("canvas");X.width=k,X.height=M;let b=X.getContext("2d"),A=document.createElement("canvas");A.width=k,A.height=M;let E=A.getContext("2d");if(P!==null&&b!==null&&B!==null&&ne!==null&&E!==null&&W!==null){e.settings.disableFill=!0,e.screenshotToCanvas(X,{width:k,height:M,targetPixelRatio:1,transparentBackground:!0}),e.settings.disableFill=!1,e.screenshotToCanvas(L,{width:k,height:M,targetPixelRatio:1,transparentBackground:!0}),P.fillStyle="white",P.fillRect(0,0,r.width,r.height);let J=Math.round(V.mapx(0)),j=Math.round(V.mapy(0)),ce=s.xAxisLabel!==""?s.xAxisLabel.replace(/ /g,"\\ "):"x",te=s.yAxisLabel!==""?s.yAxisLabel.replace(/ /g,"\\ "):"y",pe=1;if(c&&V.coordsAreOnscreen(k-6,j-8,0)){let ie=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},n),{cellPadding:n.cellPadding+pe}),de=2+2*t0(ie,ce),Ie=k-2,Se=j-de,ot=Zp(ce,o);({x:Ie,y:Se}=AA(ie,Ie,Se,ot)),{x:Ie,y:Se}=ww(ie,B,Ie,Se,ot),vw(ie,E,Ie,Se,ot)}if(p&&V.coordsAreOnscreen(J+4,1,0)){let ie=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},n),{cellPadding:n.cellPadding+pe}),de=J+4,Ie=1,Se=Zp(te,o);({x:de,y:Ie}=ww(ie,B,de,Ie,Se)),vw(ie,E,de,Ie,Se)}let{x:he,y:ae}=UX(n,o,V);if(c){let ie;for(let de of he){if(de===0&&p)continue;let Ie=Math.round(V.mapx(de));if(!(Ie<2||Ie>V.screen.width-2)&&u){let Se=eu(n,Zp("-1",o))-eu(n,Zp("1",o)),ot=de<0?Se+1:1,Ze=Ie-ot,at=j+4,Vt=Zp(""+de,o);({x:Ze,y:at}=ww(n,E,Ze,at,Vt)),MA(n,b,Ze,at,Vt)&&(vw(n,E,Ze,at,Vt),ie=QE(ie,r0(n,Ze,at,Vt)))}}n.embossPatternInequalities&&ie&&(ie=QE(ie,{x:0,y:j,width:k,height:0}),ne.fillStyle="white",ne.fillRect(ie.x,ie.y,ie.width,ie.height))}if(p){let ie;for(let de of ae){if(de===0&&c)continue;let Ie=Math.round(V.mapy(de));if(Ie<2||Ie>V.screen.height-2)continue;let Se=-Math.ceil(t0(n," ")/2);if(h){let ot=J-4,Ze=Ie+Se,at=Zp(""+de,o);({x:ot,y:Ze}=AA(n,ot,Ze,at)),{x:ot,y:Ze}=ww(n,E,ot,Ze,at),MA(n,b,ot,Ze,at)&&(vw(n,E,ot,Ze,at),ie=QE(ie,r0(n,ot,Ze,at)))}}n.embossPatternInequalities&&ie&&(ie=QE(ie,{x:J,y:0,width:0,height:M}),ne.fillStyle="white",ne.fillRect(ie.x,ie.y,ie.width,ie.height))}if(c&&p){let ie=J-2,de=j+2,Ie=Zp(u||h?"0":"o",o);({x:ie,y:de}=AA(n,ie,de,Ie)),V.coordsAreOnscreen(ie,de,0)&&({x:ie,y:de}=ww(n,E,ie,de,Ie),MA(n,b,ie,de,Ie)&&vw(n,E,ie,de,Ie))}for(let ie of he){let de=Math.round(V.mapx(ie));de<2||de>V.screen.width-2||p&&ie===0||l&&Cw(ne,"white",de-1,0,M,3)}for(let ie of ae){let de=Math.round(V.mapy(ie));de<2||de>V.screen.height-2||c&&ie===0||l&&Dw(ne,"white",de-1,0,k,3)}c&&Dw(ne,"white",j-3,0,k,7),p&&Cw(ne,"white",J-3,0,M,7);for(let ie of he){let de=Math.round(V.mapx(ie));de<2||de>V.screen.width-2||p&&ie===0||(l?Cw(ne,ZE(i),de,0,M):c&&Cw(ne,ZE(i),de,j-3,j+2))}for(let ie of ae){let de=Math.round(V.mapy(ie));de<2||de>V.screen.height-2||c&&ie===0||(l?Dw(ne,ZE(i),de,0,k):p&&Dw(ne,ZE(i),de,J-3,J+2))}if(c&&Dw(ne,mb(i),j,0,k),p&&Cw(ne,mb(i),J,0,M),x!=="NONE"&&(JX(ne,mb(i),J,0),x==="BOTH"&&YX(ne,mb(i),J,M-1)),m!=="NONE"&&($X(ne,mb(i),k-1,j),m==="BOTH"&&jX(ne,mb(i),0,j)),n.embossPatternInequalities)for(let ie=0;ie<k;ie+=6)for(let de=0;de<M;de+=6){let Ie={x:ie,y:de,width:3,height:3};BX(B,Ie)&&e0(ne,Ie)&&e0(b,Ie)&&e0(E,Ie)&&XX(W,"black",ie,de)}n.embossPatternInequalities||P.drawImage(L,a.left,a.top),P.drawImage(re,a.left,a.top),P.drawImage(X,a.left,a.top),P.drawImage(A,a.left,a.top),n.embossPatternInequalities&&P.drawImage(R,a.left,a.top)}for(let J in D)e.settings[J]=s[J]}function HX(r){if(r==="etc8"||r==="etc11")return{dotSpacing:0,cellPadding:1,graphLineWidth:1.75,embossPatternInequalities:!0};if(r==="vpmax8"||r==="vpmax11")return{dotSpacing:1,cellPadding:2,graphLineWidth:1,embossPatternInequalities:!1};{let e=r;throw new Error(`Unexpected embosser model ${e}`)}}function WX(r){if(r==="etc8"||r==="etc11")return!1;if(r==="vpmax8"||r==="vpmax11")return!0;{let e=r;throw new Error(`Unexpected embosser model ${e}`)}}function mb(r){switch(r){case"vpmax8":case"vpmax11":return"rgb(145, 145, 145)";case"etc8":case"etc11":return"rgb(0, 0, 0)";default:let e=r;throw new Error("Unexpected embosser model: "+e)}}function ZE(r){switch(r){case"vpmax8":case"vpmax11":return"rgb(219, 219, 219)";case"etc8":case"etc11":return"rgb(0, 0, 0)";default:let e=r;throw new Error("Unexpected embosser model: "+e)}}function Cw(r,e,t,i,o,n=1){let a=r.fillStyle;r.fillStyle=e,r.fillRect(t-1,i,n,o-i),r.fillStyle=a}function Dw(r,e,t,i,o,n=1){let a=r.fillStyle;r.fillStyle=e,r.fillRect(i,t-1,o-i,n),r.fillStyle=a}function $X(r,e,t,i){let o=r.fillStyle;r.fillStyle=e;for(var n=-2;n<=2;n++)r.fillRect(t-Math.abs(n),i-1+n,1,1);r.fillStyle=o}function jX(r,e,t,i){let o=r.fillStyle;r.fillStyle=e;for(var n=-2;n<=2;n++)r.fillRect(t+Math.abs(n),i-1+n,1,1);r.fillStyle=o}function YX(r,e,t,i){let o=r.fillStyle;r.fillStyle=e;for(var n=-2;n<=2;n++)r.fillRect(t-1+n,i-Math.abs(n),1,1);r.fillStyle=o}function JX(r,e,t,i){let o=r.fillStyle;r.fillStyle=e;for(var n=-2;n<=2;n++)r.fillRect(t-1+n,i+Math.abs(n),1,1);r.fillStyle=o}function XX(r,e,t,i){let o=r.fillStyle;r.fillStyle=e,r.fillRect(t+1,i,1,1),r.fillRect(t,i+1,1,1),r.fillRect(t+1,i+1,1,1),r.fillRect(t+2,i+1,1,1),r.fillRect(t+1,i+2,1,1),r.fillStyle=o}var mh={};mh.vpmax8={width:170,height:220,margins:{left:5,top:15,right:5,bottom:50},name:r=>r.s("graphing-calculator-label-braille-size-vpmax8")};mh.vpmax11={width:230,height:220,margins:{left:15,top:15,right:5,bottom:5},name:r=>r.s("graphing-calculator-label-braille-size-vpmax11")};mh.etc8={width:96,height:96,margins:{left:5,top:15,right:0,bottom:0},name:r=>r.s("graphing-calculator-label-braille-size-etc8")};mh.etc11={width:132,height:134,margins:{left:10,top:15,right:5,bottom:5},name:r=>r.s("graphing-calculator-label-braille-size-etc11")};var Sw=class{constructor(e){this.grapher=e,this.controller=this.grapher.controller,this.renderedTabTargetOrder=[],this.renderedTabTargets={}}redrawToCtx(e,t,i){let{ctx:o,projection:n}=e;this.renderedTabTargets={},this.renderedTabTargetOrder=[],Ra(o,"background-images"),(i===void 0||i.length<__dcg_shared_module_exports__['D'](t))&&(i=__dcg_shared_module_exports__['M'](t));for(let s of i){let l=t[s];l&&l.shouldGraph&&!l.foreground&&Pk(e,l,this.grapher.clickableObjectsLayer,{currentKeyboardAttention:this.controller.get2dPOIController().keyboardAttentionManager.getKeyboardAttention(),cacheRenderedSvgs:this.controller.getGraphSettings().config.cacheRenderedSvgs});var a=this.controller.getItemModel(s);if(a&&a.type==="image"&&a.shouldGraph&&Nd(a)){let c=a.formula.dimensions;if(!c||!c.x||!c.y||!c.width||!c.height||!c.radianAngle)continue;for(let p=0;p<c.x.length;p++)if(isFinite(c.x[p])&&isFinite(c.y[p])&&isFinite(c.width[p])&&isFinite(c.height[p])&&isFinite(c.radianAngle[p])){this.renderedTabTargetOrder.push(s),this.renderedTabTargets[s]={id:s,description:this.getComputedDescription(a,p),x:c.x[p],y:c.y[p],radianAngle:c.radianAngle[p],width:c.width[p],height:c.height[p],widthScale:Math.abs(n.mapx(1)-n.mapx(0)),heightScale:Math.abs(n.mapy(1)-n.mapy(0)),screenX:n.mapx(c.x[p]),screenY:n.mapy(c.y[p]),centerId:a.formula.center_reference_id,selected:aa(a)};break}}}Na(o),this.speakAriaAlert()}getOrderedTabTargets(){return this.getTabIndex()===-1?[]:this.renderedTabTargetOrder.map(e=>{var i;let t=this.renderedTabTargets[e];return{calcId:t.id,listIndex:void 0,polygonEdge:void 0,description:this.controller.isGeometry()||(i=this.getAriaAlert({id:t.id,includeUsageInstructions:!0}))==null?void 0:i.completeMessage}})}getStyle(e){var t=this.renderedTabTargets[e];if(!t)return;let{screenX:i,screenY:o,radianAngle:n,width:a,height:s,widthScale:l,heightScale:c}=t,p=c/l,u=a*l,m=s*c/p,h=i-u/2,x=o-m/2;var C=`translate(${h}px, ${x}px)`,D=n?` rotate(${n}rad)`:"",k=p===1?"":` scale(1,${p})`;return{position:"absolute",top:0,left:0,transform:C+k+D,width:u+"px",height:m+"px"}}getTabIndex(){if(this.controller.getActiveTool()!=="selection")return-1;var e=this.grapher.settings;return e.config.graphpaper&&e.config.enableTabindex?0:-1}getAriaHidden(){var e=this.grapher.settings;return!e.config.graphpaper}getComputedDescription(e,t){let i=e.formula&&e.formula.computed_description&&e.formula.computed_description[t];return i&&i!==""?ka(i):this.grapher.getAudioTrace().getExpressionAriaLabel(e.id)}getAriaLabel(e){var t=this.getAriaAlert({id:e,includeUsageInstructions:!1});return t&&t.completeMessage}speakAriaAlert(){if(this.controller.isGeometry())return;let e=this.getFocusedImage();if(!e){this.lastAriaAlert=void 0;return}let t=e.id,i=this.getAriaAlert({id:t,lastAriaAlert:this.lastAriaAlert,includeUsageInstructions:!0});this.lastAriaAlert=i,i&&i.completeMessage&&be(i.completeMessage)}getAriaAlert(e){let{id:t,lastAriaAlert:i,includeUsageInstructions:o}=e;if(t){var n=this.controller.getItemModel(t);if(!(!n||n.type!=="image")){var a=this.renderedTabTargets[t];if(a){i&&i.id!==t&&(i=void 0);var s=i==null?void 0:i.label,l=a.description,c=s!==l,p=!!(i!=null&&i.selected),u=a.selected,m=p!==u,h=i&&i.coordX,x=i&&i.coordY,C=a.x,D=a.y,k=C!==h||D!==x,M=this.grapher.getProjection(),I=mi(this.controller,C),S=fi(this.controller,D),V=`${I} ${S}`,P=l,L=o?this.controller.s("graphing-calculator-narration-movable-point-suffix-usage-instructions"):"",B=this.isImageFullyVisible(n,M)?"":this.controller.s("graphing-calculator-narration-draggable-image-off-screen-prompt"),R;return i?c||!k&&m?R=P+B:k?R=V+B:R="":R=this.controller.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:P,x:I,y:S})+L+B,{id:t,coordX:C,coordY:D,label:l,completeMessage:R}}}}}getFocusedImage(){let e=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention();return e?this.renderedTabTargets[e.calcId]:void 0}speakImageAttribute(e,t){if(e){var i=this.grapher.getAudioTrace();if(i){var o=this.grapher.getProjection();if(o)switch(t){case"X":be(mi(this.controller,e.x));break;case"Y":be(fi(this.controller,e.y));break;case"L":be(e.description);break}}}}hasNonlinearMoveStrategy(e){if(!e)return!1;var t=this.controller.getItemModel(e);if(!t||t.type!=="expression"||!t.formula)return!1;var i=t.formula.move_strategy;return!i||!i[0]?!1:i[0].type==="updateSliderNonlinear"}isImageFullyVisible(e,t){let i=e.formula.dimensions;if(!i||!i.x||!i.y)return!1;for(let o=0;o<i.x.length;o++)if(!t.coordsAreOnscreen(t.mapx(i.x[o]),t.mapy(i.y[o])))return!1;return!0}};function ZX(r,e){return`${r}_dcg_delim_${e}`}var kw=class{constructor(e){this.hoveredObjects={},this.grapher=e,this.controller=this.grapher.controller,this.renderedTabTargetOrder=[],this.renderedTabTargets={}}getOrderedTabTargets(){return this.renderedTabTargetOrder.map(e=>{let t=this.renderedTabTargets[e];return{calcId:t.id,listIndex:t.listIndex,polygonEdge:void 0,description:t.description}})}redraw(){this.renderedTabTargets={},this.renderedTabTargetOrder=[];let e=this.grapher.getSketchOrder();for(let t of e){let i=this.controller.getItemModel(t);if(!i)continue;let o=this.grapher.getGraphSketch(t),n=this.grapher.getGraphImage(t);if(o&&i.type==="expression"&&vs(i))for(let a=0;a<o.branches.length;a++){let s=o.branches[a];if(!s.segments||s.segments.length===0)continue;let l=0;s.graphMode===3||s.graphMode===4?o.getBranchPOI(a).forEach(c=>{l=c.pointIdxOnBranch||0,isFinite(c.x)&&isFinite(c.y)&&this.addTabTarget(i,l)}):(l="listIndex"in s&&s.listIndex!==void 0?s.listIndex:0,s.segments.length>0&&this.addTabTarget(i,l))}else if(n&&n.shouldGraph&&i.type==="image"&&cg(i)){let a=i.formula&&i.formula.dimensions;if(!a||!a.x||!a.y||!a.width||!a.height||!a.radianAngle)continue;for(let s=0;s<a.x.length;s++)isFinite(a.x[s])&&isFinite(a.y[s])&&isFinite(a.width[s])&&isFinite(a.height[s])&&isFinite(a.radianAngle[s])&&this.addTabTarget(i,s)}}Object.keys(this.hoveredObjects).length||this.pressedObject?this.grapher.setLayerClass("clickableObjects","dcg-mouse-over-clickable-object"):this.grapher.setLayerClass("clickableObjects",void 0)}addTabTarget(e,t){let i=ZX(e.id,t);this.renderedTabTargetOrder.indexOf(i)!==-1||this.renderedTabTargets[i]!==void 0||(this.renderedTabTargetOrder.push(i),this.renderedTabTargets[i]={type:e.type,id:e.id,listIndex:t,description:this.getComputedDescription(e,t)})}getTabIndex(e){if(this.controller.getActiveTool()!=="selection"||!this.renderedTabTargets[e])return-1;let i=this.grapher.settings;return!i.config.graphpaper||!i.config.enableTabindex?-1:0}getAriaHidden(){return!this.grapher.settings.config.graphpaper}getCachedDescription(e){return this.renderedTabTargets[e].description}getComputedDescription(e,t){let i=e.formula&&e.formula.computed_description&&e.formula.computed_description[t];return i&&i!==""?ka(i):this.grapher.getAudioTrace().getExpressionAriaLabel(e.id)}getModelId(e){let t=this.renderedTabTargets[e];return t?t.id:""}getListIndex(e){let t=this.renderedTabTargets[e];if(t)return t.listIndex}isKeyboardFocused(e,t){if(!e)return!1;let i=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention(),o=i==null?void 0:i.calcId;return e===o&&(t===void 0||t===(i==null?void 0:i.listIndex))}shouldDrawHovered(e,t,i){if(!t)return!1;if(this.isKeyboardFocused(t,i))return!0;let{translationPreviewVectorParents:o,rotationPreviewAngleMarkerParents:n}=e.transformationPreviewParentData;if(o.has(t)||n.has(t)&&!this.controller.isToolPreviewItem(t))return!0;if(this.isAnObjectPressed()&&!this.isObjectPressed(t))return!1;let a=this.getHoveredObjectById(t);return a?a.listIndexes===void 0||i===void 0?!0:!!a.listIndexes[i]:!1}setHoveredObjects(e){__dcg_shared_module_exports__['P'](e,this.hoveredObjects)||(this.hoveredObjects=e,this.requestRedrawNextFrame())}getHoveredObjects(){let e=this.grapher.poiController.keyboardAttentionManager.getKeyboardAttention();if(e){let t=__dcg_shared_module_exports__['j'](this.hoveredObjects),i=t[e.calcId],o=e.listIndex||0;return i?i.listIndexes?i.listIndexes[o]=!0:i.listIndexes={[o]:!0}:(i={listIndexes:{[o]:!0}},t[e.calcId]=i),t}else return this.hoveredObjects}getHoveredObjectById(e){return this.getHoveredObjects()[e]}shouldDrawPressed(e,t){if(!e)return!1;let i=this.pressedObject;return!i||i.id!==e?!1:t===void 0?!0:i.listIndex===t}isObjectPressed(e){return e===void 0?!1:!!(this.pressedObject&&this.pressedObject.id===e)}setPressedObject(e){!e&&!this.pressedObject||e&&this.pressedObject&&e.id===this.pressedObject.id&&e.listIndex===this.pressedObject.listIndex||(this.pressedObject=e,this.requestRedrawNextFrame())}getPressedObject(){return this.pressedObject}isAnObjectPressed(){return!!this.pressedObject}requestRedrawNextFrame(){this.controller.requestRedrawGraph()}shouldDrawGhosted(e){if(!e)return!1;let t=this.controller.getItemModel(e);return!t||t.type!=="expression"?!1:Za(t)}};Lp();var Yc=class extends jr{generateDefaultName(){return"does not matter"}};var I8="graphing-calculator-text-geometry-tool-rotation-hint-center",eQ="graphing-calculator-text-geometry-tool-rotation-hint-angle",tQ="graphing-calculator-text-geometry-tool-rotation-hint-angle-start",rQ="graphing-calculator-text-geometry-tool-rotation-hint-angle-vertex",iQ="graphing-calculator-text-geometry-tool-rotation-hint-angle-end",Ag=class extends Yc{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-rotate-display-name",this.toolName="rotation",this.toolType="transformation"}getMode(){let{idMap:t}=this.model.getNonObjectsState().ui.currentTool;return t["2-number"]?"number":"directed-angle"}getExpressionEditHint(t){return t===0?this.s(I8):this.s(eQ)}onNumberInput(t){super.onNumberInput(t),this.clearTentativeOutputs()}onMove(t){return this.getMode()==="number"&&this.model.getNonObjectsState().ui.currentTool.inputIndex===1?!1:super.onMove(t)}getSpecIdToLockIn(t,i){if(i===1){let o=t.inputs[i];return this.getMode()==="number"?`${o.id}-number`:o.id}return super.getSpecIdToLockIn(t,i)}isDegenerateInput(t){let{inputIndex:i,idMap:o}=this.model.getNonObjectsState().ui.currentTool;return this.getMode()==="directed-angle"&&i>0&&o[1]===t?o[1]===o[3]&&i===3:super.isDegenerateInput(t)}getPartialAnglePreviewInfo(){let{inputIndex:t,idMap:i}=this.model.getNonObjectsState().ui.currentTool;if(t>0){let o=this.model.findDefsForInputId(i[1])[0];if(!o)return;let n=[o.typedRuntimeValue],a=this.model.findDefsForInputId(i[2])[0],s=this.model.findDefsForInputId(i[3])[0];if(a&&s&&n.push(a.typedRuntimeValue,s.typedRuntimeValue),o)return{id:i["angle-output"],type:"rotation-with-incomplete-angle",args:n}}}getSpec(){let t={inputs:[{type:"point",id:"1",hint:I8},{type:"union",valueTypes:[__dcg_shared_module_exports__['da'],__dcg_shared_module_exports__['za']],id:"2",hint:tQ,numberInputInfo:{defaultLatex:"",sliderInfo:{value:this.model.controller.isDegreeMode()?"90":"1.57079632679",min:"0",max:this.model.controller.isDegreeMode()?"360":"2\\pi"}}}],outputs:[]},i={id:"number-output",type:"rotate",hidden:this.getMode()!=="number",name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2-number"}]};if(this.getMode()==="directed-angle"){let{idMap:o,inputIndex:n}=this.model.getNonObjectsState().ui.currentTool;n>1&&delete t.inputs[1].numberInputInfo;let a=o[2],s=!1,l=a&&this.model.findDefsForInputId(a)[0];s=!!(l&&l.typedRuntimeValue.valueType==__dcg_shared_module_exports__['da']),s?(t.inputs.push({type:"point",id:"3",hint:rQ},{type:"point",id:"4",hint:iQ}),t.outputs.push({id:"directed-angle",type:"directedangle",hidden:!1,showAngleLabel:!1,parents:[{type:"reference-input",id:"2"},{type:"reference-input",id:"3"},{type:"reference-input",id:"4"}]},{id:"angle-output",type:"rotate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"directed-angle"}]})):t.outputs.push({id:"angle-output",type:"rotate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]})}else t.outputs.push(i);return t}};var oQ=Da().reflectionArc,nQ=14,V8=2.5,aQ=40,sQ=15,lQ=.75,cQ=1;function fh(r){return r.valueType===__dcg_shared_module_exports__['da']?r.value:r.valueType===__dcg_shared_module_exports__['ha']?r.value[0]:void 0}function dQ(r){return r.valueType===__dcg_shared_module_exports__['Da']?r.value:r.valueType===__dcg_shared_module_exports__['Ea']?r.value[0]:void 0}function pQ(r){return r.valueType===__dcg_shared_module_exports__['ta']||r.valueType===__dcg_shared_module_exports__['va']||r.valueType===__dcg_shared_module_exports__['na']||r.valueType===__dcg_shared_module_exports__['Da']?{segment:r.valueType===__dcg_shared_module_exports__['na'],value:r.value}:r.valueType===__dcg_shared_module_exports__['ua']||r.valueType===__dcg_shared_module_exports__['wa']||r.valueType===__dcg_shared_module_exports__['oa']||r.valueType===__dcg_shared_module_exports__['Ea']?{segment:r.valueType===__dcg_shared_module_exports__['oa'],value:r.value[0]}:void 0}function M8(r){return r.valueType===__dcg_shared_module_exports__['ca']?r.value:r.valueType===__dcg_shared_module_exports__['fa']?r.value[0]:void 0}function A8(r){return r.valueType===__dcg_shared_module_exports__['za']?r.value:r.valueType===__dcg_shared_module_exports__['Aa']?r.value[0]:void 0}var i0=class{constructor(e){this.controller=e.controller}getTransformationPreviewInfoFromItem(e,t){var n;if(e.type!=="expression"||e.hidden)return;let{translationsWithVisibleVectorParent:i}=t.transformationPreviewParentData;if(i.has(e.id))return;let o=(n=e.formula.geometry)==null?void 0:n.transformation_preview_info;if(o)return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},o),{id:e.id})}getInprogressTransformation(e){let t=this.controller.getAllToolPreviewItems();for(let o of t){let n=this.getTransformationPreviewInfoFromItem(o,e);if(n)return n}let i=this.controller.getGeoModel().getCurrentTool();if(i instanceof Ag)return i.getPartialAnglePreviewInfo()}getHoveredOrSelectedTransformations(e){let t=this.controller.getAllSelectedItems(),i=this.controller.getHoveredOrFocusedTokenIdentifier(),o=i?this.controller.getItemsByIdentifier(i)[0]:void 0;o&&!t.some(a=>a.id===o.id)&&t.push(o);let n=[];return t.forEach(a=>{if(a.type!=="expression")return;let s=this.getTransformationPreviewInfoFromItem(a,e);s&&n.push(s)}),n}drawTranslationPreview(e,t,i,o){let n=t.mapx(i[0]),a=t.mapy(i[1]),s=t.mapx(o[0]),l=t.mapy(o[1]);e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=5,e.moveTo(n,a),e.lineTo(s,l),qc(e,n,a,s,l,20),e.stroke(),e.restore()}drawReflectionPreview(e,t,i){let o=i.value,n=i.segment,[a,s,l,c]=yg([o[0][0],o[0][1],o[1][0],o[1][1]],t,18).clipped,p=(a+l)/2,u=(s+c)/2;if(n){let[M,I,S,V]=yg([o[0][0],o[0][1],o[1][0],o[1][1]],t,17).clipped;p=(M+S)/2,u=(I+V)/2}if(isNaN(p)&&isNaN(u))return;let m=40,h=m/__dcg_shared_module_exports__['Ua'](a-l,s-c),x=p+(c-s)*h,C=u-(l-a)*h,D=p-(c-s)*h,k=u+(l-a)*h;if(e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=4,e.moveTo(a,s),e.lineTo(l,c),oQ){let M=Math.atan2(C-u,x-p),I=m,S=m*.7;e.moveTo(x,C),e.ellipse(p,u,I,S,M,0,Math.PI,!1);let V=.35,P=M+Math.PI/2+V,L=M+Math.PI/2-V;qc(e,x+Math.cos(P),C+Math.sin(P),x,C,10),qc(e,D+Math.cos(L),k+Math.sin(L),D,k,10)}else e.moveTo(x,C),e.lineTo(D,k),qc(e,p,u,x,C,10),qc(e,p,u,D,k,10);e.stroke(),e.restore()}drawDilationPreview(e,t,i,o){e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=3;let n=o<.6||o>1.4&&o<2?6:10,a=t.pixelsToMath.mapX(25)-t.pixelsToMath.mapX(0);[[a,0],[0,a],[-a,0],[0,-a]].forEach(s=>{let l=[i[0]+s[0],i[1]+s[1]],c=__dcg_shared_module_exports__['Yb'](__dcg_shared_module_exports__['Vb'](i,o),l),[p,u]=t.map_xy_pairs(l),[m,h]=t.map_xy_pairs(c);e.moveTo(p,u),e.lineTo(m,h),qc(e,p,u,m,h,n)}),e.stroke(),e.restore()}drawRotationPreview(e,t,i,o,n,a){if(this.drawRotationCenterPreview(e,t,i),!(n===void 0||!isFinite(n))){if(a!==void 0&&a!==0&&isFinite(a)){if(o&&o[0]===i[0]&&o[1]===i[1])return;this.drawFullRotationAngle(e,t,i,n,a,!1)}else if(o){this.drawPlaceholderRotationAngle(e,t,o,n);return}}}drawFullRotationAngle(e,t,i,o,n,a){e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=V8;let s=aQ,l=-o,c=-n,p,u;if(a){let k=yg([i[0],i[1],i[0]+Math.cos(o),i[1]+Math.sin(o)],t,19).clipped;p=k[0],u=k[1];let M=yg([i[0],i[1],i[0]+Math.cos(o+n),i[1]+Math.sin(o+n)],t,19).clipped;e.moveTo(p,u),e.lineTo(k[2],k[3]),e.moveTo(p,u),e.lineTo(M[2],M[3]);let I=s*Math.abs(c),S=.5*(1-lQ)*I,V=Math.min(S,sQ),P=(c>0?1:-1)*V/s;l+=P,c-=2*P}else[p,u]=t.map_xy_pairs(i);let m=c<=0,h=p+s*Math.cos(l),x=u+s*Math.sin(l),C=p+s*Math.cos(l+c),D=u+s*Math.sin(l+c);e.moveTo(h,x),e.arc(p,u,s,l,l+c,m),CM(e,C,D,l,c,10,s),e.stroke(),e.restore()}drawPlaceholderRotationAngle(e,t,i,o){e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=cQ;let n=-o,[a,s]=t.map_xy_pairs(i);e.moveTo(a,s);let l=1.5*th(0,t);e.lineTo(a+l*Math.cos(n),s+l*Math.sin(n)),e.stroke(),e.restore()}drawRotationCenterPreview(e,t,i){let[o,n]=t.map_xy_pairs(i);e.save(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=V8,e.beginPath(),e.arc(o,n,nQ,0,2*Math.PI),e.stroke(),e.restore()}redrawToCtx(e){let{ctx:t,projection:i}=e,o=this.getInprogressTransformation(e),n=this.getHoveredOrSelectedTransformations(e);o&&n.push(o);for(let a=0;a<n.length;a++){let s=n[a],l=s.args;switch(s.type){case"translate":if(l.length===2){let c=fh(l[0]),p=fh(l[1]);c&&p&&this.drawTranslationPreview(t,i,c,p)}else if(l.length===1){let c=dQ(l[0]);if(c){let[p,u]=Wp(c);this.drawTranslationPreview(t,i,p,u)}}break;case"reflect":{let c=pQ(l[0]);c&&this.drawReflectionPreview(t,i,c)}break;case"dilate":{let c=fh(l[0]),p=M8(l[1]);c&&p!==void 0&&isFinite(p)&&p!==1&&this.drawDilationPreview(t,i,c,p)}break;case"rotate":{let c=fh(l[0]);if(!c)return;let p=M8(l[1]),u=A8(l[1]),m,h;if(p!==void 0)h=this.controller.isDegreeMode()?p*Math.PI/180:p,m=0;else if(u)m=u[1],h=u[2],e.transformationPreviewParentData.rotationsWithVisibleAndCenteredAngle.has(s.id)&&(h=void 0);else return;this.drawRotationPreview(t,i,c,u?u[0]:void 0,m,h)}break;case"rotation-with-incomplete-angle":{let c=fh(l[0]);if(!c)return;let p,u;if(l.length>=3){let m=fh(l[1]);if(p=fh(l[2]),!c||!m||!p)return;let h=m[0]-p[0],x=m[1]-p[1];u=Math.atan2(x,h)}this.drawRotationPreview(t,i,c,p,u,void 0)}}}}};function L8(r){var c,p,u,m,h,x,C,D,k,M;let e=new Set,t=new Set,i=new Set,o=new Set,n={},a={};for(let I of[...r.getAllItemModels(),...r.getAllToolPreviewItems()]){if(I.type!=="expression"||Za(I))continue;let S=I.formula.typed_constant_value;if(!S)continue;if(__dcg_shared_module_exports__['Pa'](S.valueType,__dcg_shared_module_exports__['Da'])){let P=(c=Fo(I))==null?void 0:c.identifier;P&&(n[P]=I.id)}let V=A8(S);if(V){let P=(p=Fo(I))==null?void 0:p.identifier;P&&(a[P]={id:I.id,value:V})}}let s=r.getHoveredOrFocusedTokenIdentifier(),l=[...r.getAllItemModels().filter(I=>{var S;if(r.isItemSelected(I.id))return!0;if(I.type==="expression"&&s){let V=(S=Fo(I))==null?void 0:S.identifier;return s===V}return!1}),...r.getAllToolPreviewItems()];for(let I of l){if(I.type!=="expression")continue;let S=I.formula.geometry,V=S==null?void 0:S.transformation_preview_info;if(((u=S==null?void 0:S.call)==null?void 0:u.symbol)==="translate"&&(V==null?void 0:V.args.length)===1&&__dcg_shared_module_exports__['Pa'](V.args[0].valueType,__dcg_shared_module_exports__['Da'])){let P=(x=(h=(m=I.formula.geometry)==null?void 0:m.call)==null?void 0:h.parents)==null?void 0:x[0];if(!P)continue;let L=n[P[0]];L&&(e.add(I.id),t.add(L))}if(((C=S==null?void 0:S.call)==null?void 0:C.symbol)==="rotate"&&(V!=null&&V.args)&&(V==null?void 0:V.args.length)>1&&__dcg_shared_module_exports__['Pa'](V.args[1].valueType,__dcg_shared_module_exports__['za'])){let P=(M=(k=(D=I.formula.geometry)==null?void 0:D.call)==null?void 0:k.parents)==null?void 0:M[1];if(!P)continue;let L=a[P[0]];if(!L)continue;o.add(L.id);let B=fh(V.args[0]);if(!B)continue;L.value[0][0]===B[0]&&L.value[0][1]===B[1]&&i.add(I.id)}}return{translationsWithVisibleVectorParent:e,translationPreviewVectorParents:t,rotationsWithVisibleAndCenteredAngle:i,rotationPreviewAngleMarkerParents:o}}var{floor:Lg,ceil:Og,round:uQ,log10:o0,log2:O8,abs:bh}=Math,s0=class{redrawToCtx(e,t){let{ctx:i,projection:o}=e;Ra(i,"graphpaper");let n=o.settings.showGrid&&!o.settings.threeDMode;if(o.settings.polarMode&&n){let a=uB(o);Ra(i,"grid"),this.drawPolarGrid(i,o,a),Na(i),Ra(i,"axis"),this.drawAxes(i,o,t);let s=this.drawPolarStepNumbers(i,o,a);this.drawLabels(i,o,s),Na(i)}else{let a=rh(o),s=LA(o);n&&(Ra(i,"grid"),this.drawCartesianGrid(i,o,a,s),Na(i));let l=!n&&!o.settings.threeDMode;Ra(i,"axis"),o.settings.threeDMode||this.drawAxes(i,o,t);let c=this.drawCartesianStepNumbers(i,o,a,l,s);this.drawLabels(i,o,c),Na(i)}Na(i)}addTextShadow(e,t){let{threeDMode:i,showPlane3D:o}=t.settings;e.strokeStyle=t.settings.getBackgroundColor({invertWhite:i}),e.lineWidth=3,i&&(!o||t.settings.invertedColors)&&(e.lineWidth=1.5),e.miterLimit=2}drawPolarGrid(e,t,i){e.save();let o=t.settings.minorAxisOpacity,a=1-(1-t.settings.majorAxisOpacity)/(1-o),s=__dcg_shared_module_exports__['$a'](t.mapx(0)),l=__dcg_shared_module_exports__['$a'](t.mapy(0)),c=t.screen.height/(t.viewport.ymax-t.viewport.ymin),p=t.screen.width/(t.viewport.xmax-t.viewport.xmin),u=c/p,m=p/c,h=l/u,x=t.viewport.smallestR(),C=t.viewport.largestR(),D=i.minorStepR*Math.max(1,Math.floor(x/i.minorStepR)),k=i.majorStepR*Math.max(1,Math.floor(x/i.majorStepR));e.lineWidth=1,e.strokeStyle="rgba(0, 0 , 0, "+o+")";for(let I of Jc(D,C,i.minorStepR)){Qi(e,"dcg-svg-minor-gridline"),e.beginPath(),Oi(e),e.scale(1,u);let S=t.mapx(I)-s;e.moveTo(s+S,h),e.arc(s,h,S,0,2*Math.PI),e.scale(1,m),e.stroke()}let M=x>0?5:15;for(let I of Jc(0,359,M)){if((I===0||I===180)&&t.settings.showXAxis||(I===90||I===270)&&t.settings.showYAxis)continue;Qi(e,"dcg-svg-minor-gridline"),e.beginPath(),Oi(e),e.moveTo(s,l);let S=t.mapx(C*Math.cos(I*Math.PI/180)),V=t.mapy(C*Math.sin(I*Math.PI/180));e.lineTo(__dcg_shared_module_exports__['$a'](S),__dcg_shared_module_exports__['$a'](V)),e.stroke()}e.lineWidth=1,e.strokeStyle="rgba(0, 0 , 0, "+a+")";for(let I of Jc(k,C,i.majorStepR)){Qi(e,"dcg-svg-major-gridline"),e.beginPath(),Oi(e),e.scale(1,u);let S=t.mapx(I)-s;e.moveTo(s+S,h),e.arc(s,h,S,0,2*Math.PI),e.scale(1,m),e.stroke()}e.restore()}drawCartesianGrid(e,t,i,o=LA(t)){e.save();let{xmin:n,xmax:a,ymin:s,ymax:l}=t.viewport,c=t.screen.width,p=t.screen.height,u=p,m=0;t.settings.restrictGridToFirstQuadrant&&(n=0,s=0,u=t.mapy(0),m=t.mapx(0));let h=t.settings.minorAxisOpacity*o.x.unitOpacity,x=t.settings.minorAxisOpacity*o.y.unitOpacity,C=t.settings.majorAxisOpacity;e.lineWidth=1;let D=b=>{if(b===0&&t.settings.showYAxis)return;let A=__dcg_shared_module_exports__['$a'](t.mapx(b));A===__dcg_shared_module_exports__['$a'](0)||A===__dcg_shared_module_exports__['$a'](c)||(e.beginPath(),e.moveTo(A,0),e.lineTo(A,u),e.stroke())},k=b=>{if(b===0&&t.settings.showXAxis)return;let A=__dcg_shared_module_exports__['$a'](t.mapy(b));A===__dcg_shared_module_exports__['$a'](0)||A===__dcg_shared_module_exports__['$a'](p)||(e.beginPath(),e.moveTo(m,A),e.lineTo(c,A),e.stroke())};Qi(e,"dcg-svg-minor-gridline");let{majorStepX:M,majorStepY:I,minorStepX:S,minorStepY:V}=i,P=t.settings.xAxisScale==="logarithmic",L=t.settings.yAxisScale==="logarithmic",B=P?o.x.minor:Jc(n,a,S),R=L?o.y.minor:Jc(s,l,V);e.strokeStyle="rgba(0, 0 , 0, "+h+")";for(let b of B)D(b);e.strokeStyle="rgba(0, 0 , 0, "+x+")";for(let b of R)k(b);Oi(e);let W=1-(1-C)/(1-h),re=1-(1-C)/(1-x);Qi(e,"dcg-svg-major-gridline");let ne=P?o.x.major:Jc(n,a,M),X=L?o.y.major:Jc(s,l,I);e.strokeStyle="rgba(0, 0 , 0, "+W+")";for(let b of ne)D(b);e.strokeStyle="rgba(0, 0 , 0, "+re+")";for(let b of X)k(b);Oi(e),e.restore()}drawAxes(e,t,i){let o=t.settings.axisLineOffset,n=t.settings.axisOpacity.toString(),a="rgba(127,205,230,"+n+")",s="rgba(0,0,0,"+n+")",l=t.settings.xAxisArrowMode,c=t.settings.yAxisArrowMode,p=t.settings.showXAxis,u=t.settings.showYAxis,m=1,h=Math.round(t.mapx(0))-o,x=Math.round(t.mapy(0))-o,C=t.screen.height,D=t.screen.width;function k(S,V,P){e.save();let L=Math.PI/12,B=8*Math.max(e.lineWidth,1.5);e.lineJoin="round",e.fillStyle=s,e.strokeStyle=s,e.beginPath(),e.moveTo(S,V),e.lineTo(S+Math.cos(P-L)*B,V+Math.sin(P-L)*B),e.lineTo(S+Math.cos(P+L)*B,V+Math.sin(P+L)*B),e.lineTo(S,V),e.lineTo(S+Math.cos(P-L)*B,V+Math.sin(P-L)*B),e.stroke(),e.fill(),e.restore()}let M=C,I=0;t.settings.restrictGridToFirstQuadrant&&(M=x,I=h,l==="BOTH"&&(l="POSITIVE"),c==="BOTH"&&(c="POSITIVE")),u&&(Ra(e,"yaxis"),t.settings.takingScreenshot&&Jx(e,t.settings.yAxisLabel||"Y axis"),e.save(),Qi(e,"dcg-svg-axis-line"),e.lineWidth=t.settings.axisLineWidth*(i==="y"?m:1),e.strokeStyle=i==="y"?a:s,c==="BOTH"?(e.beginPath(),e.moveTo(h,2*t.settings.axisLineWidth),e.lineTo(h,C-2*t.settings.axisLineWidth),e.stroke(),k(h,C-t.settings.axisLineWidth,3*Math.PI/2),k(h,t.settings.axisLineWidth,Math.PI/2)):c==="POSITIVE"?(e.beginPath(),e.moveTo(h,2*t.settings.axisLineWidth),e.lineTo(h,M),e.stroke(),k(h,t.settings.axisLineWidth,Math.PI/2)):(e.beginPath(),e.moveTo(h,0),e.lineTo(h,M),e.stroke()),Oi(e),e.restore(),Na(e)),p&&(Ra(e,"xaxis"),t.settings.takingScreenshot&&Jx(e,t.settings.xAxisLabel||"X axis"),e.save(),Qi(e,"dcg-svg-axis-line"),e.lineWidth=t.settings.axisLineWidth*(i==="x"?m:1),e.strokeStyle=i==="x"?a:s,l==="BOTH"?(e.beginPath(),e.moveTo(2*t.settings.axisLineWidth,x),e.lineTo(D-2*t.settings.axisLineWidth,x),e.stroke(),k(t.settings.axisLineWidth,x,0),k(D-t.settings.axisLineWidth,x,Math.PI)):l==="POSITIVE"?(e.beginPath(),e.lineTo(I,x),e.lineTo(D-2*t.settings.axisLineWidth,x),e.stroke(),k(D-t.settings.axisLineWidth,x,Math.PI)):(e.beginPath(),e.lineTo(I,x),e.lineTo(D,x),e.stroke()),Oi(e),e.restore(),Na(e))}drawPolarStepNumbers(e,t,i){e.save();let o=t.settings.showGrid,n=t.settings.xAxisNumbers&&t.settings.showXAxis,a=t.settings.yAxisNumbers&&t.settings.showYAxis,s=o&&t.settings.polarNumbers,l=t.viewport.largestR(),c=t.viewport.smallestR(),p=t.viewport.xmin,u=t.viewport.xmax,m=t.viewport.ymin,h=t.viewport.ymax,x=t.screen.width,C=t.screen.height,D={left:3,right:x-3,top:3,bottom:C-3},k=t.settings.labelHangingColor,M=t.settings.getTextColor(),I=t.settings.labelSize,S=I;this.addTextShadow(e,t),e.fillStyle=M;function V(E,J,j){let ce=Math.sqrt(E*E-J*J);m<=ce&&ce<=h&&j.push({x:t.mapx(J),y:t.mapy(ce)}),m<=-ce&&-ce<=h&&j.push({x:t.mapx(J),y:t.mapy(-ce)})}function P(E,J,j){let ce=Math.sqrt(E*E-J*J);p<=ce&&ce<=u&&j.push({x:t.mapx(ce),y:t.mapy(J)}),p<=-ce&&-ce<=u&&j.push({x:t.mapx(-ce),y:t.mapy(J)})}let L=t.mapx(0),B=t.mapy(0),R=m<=0&&0<=h,W=p<=0&&0<=u,re=R&&n,ne=W&&a,X="";if(!re&&!ne&&o){let E=bh(L),J=bh(L-x),j=bh(B),ce=bh(B-C),te,pe,he,ae;E<=J?(te="left",he=E):(te="right",he=J),j<=ce?(pe="top",ae=j):(pe="bottom",ae=ce),n&&a?X=he<=ae?te:pe:a?X=te:n&&(X=pe)}let b={left:0,right:x,top:B-1,bottom:B+1},A={left:L-1,right:L+1,top:0,bottom:C};for(let E of Jc(0,l,i.majorStepR)){let J=[],j=[],ce=[],te=new js(__dcg_shared_module_exports__['bb'](E,l),I),pe=te.getRect();switch(E>0?(ne&&m<=E&&E<=h&&j.push({x:L-pe.right-5,y:t.mapy(E)}),ne&&m<=-E&&-E<=h&&j.push({x:L-pe.right-5,y:t.mapy(-E)}),re&&p<=E&&E<=u&&J.push({x:t.mapx(E),y:B-pe.top+3}),re&&p<=-E&&-E<=u&&J.push({x:t.mapx(-E),y:B-pe.top+3})):ne&&!n&&m<=E&&E<=h?j.push({x:L-pe.right-5,y:t.mapy(E)}):re&&!a&&p<=E&&E<=u&&J.push({x:t.mapx(E),y:B-pe.top+3}),X){case"top":P(E,h,ce);break;case"bottom":P(E,m,ce);break;case"left":V(E,p,ce);break;case"right":V(E,u,ce);break}J.forEach(function(he){he=te.clampBoundsWithinRect(he,D),te.drawCenteredAt(e,he,"dcg-svg-axis-value"),n0(b,te.getRectWhenCenteredAt(he))}),j.forEach(function(he){he=te.clampBoundsWithinRect(he,D),te.drawCenteredAt(e,he,"dcg-svg-axis-value"),n0(A,te.getRectWhenCenteredAt(he))}),ce.forEach(function(he){he=te.clampBoundsWithinRect(he,D),te.drawCenteredAt(e,he,"dcg-svg-axis-value")})}if(s){let E=Math.ceil(c/i.majorStepR),J=Math.floor(l/i.majorStepR),ce=Math.ceil((E+J)/2)*i.majorStepR,te=c>0?15:30;for(let pe of Jc(0,359,te)){let he;t.settings.degreeMode?he=pe.toString()+"\xB0":he=__dcg_shared_module_exports__['bb'](pe*Math.PI/180,2*Math.PI).string;let ae=e.measureText(he).width/2,ie=ce/1.05,de=ie*Math.cos(pe*Math.PI/180),Ie=ie*Math.sin(pe*Math.PI/180);if(de<p||de>u||Ie<m||Ie>h)continue;let Se=t.mapx(de),ot=t.mapy(Ie);pe===0||pe===180?ot-=S:(pe===90||pe===270)&&(Se+=ae+3);let Ze=__dcg_shared_module_exports__['Ab'](Se,3+ae,x-3-ae),at=__dcg_shared_module_exports__['Ab'](ot,3+S,C-3-S);at=js.computeBaselineFromCenter(at,I),Qi(e,"dcg-svg-polar-axis-value"),e.save(),Oi(e),e.fillStyle=k,js.setCtxFontSize(e,I),e.strokeText(he,Ze,at),e.fillText(he,Ze,at),e.restore()}}return e.restore(),{x:b,y:A}}drawLabels(e,t,i){let o=t.viewport.xmin,n=t.viewport.xmax,a=t.viewport.ymin,s=t.viewport.ymax,l=t.screen.width,c=t.screen.height,p=(n-o)/l,u=(s-a)/c,m=t.settings.getTextColor(),h=t.mapx(0),x=t.mapy(0),C=t.settings.labelSize,D=15,k=t.settings.showXAxis&&t.settings.xAxisLabel,M=t.settings.showYAxis&&t.settings.yAxisLabel,I=i.x,S=i.y;if(k&&I){Qi(e,"dcg-svg-axis-label"),e.save(),Oi(e),e.fillStyle=m;let V;if(e.__xLabelOffset&&t.settings.isViewportTransient&&a0(e.__xLabelOffset.xscale,p)&&a0(e.__xLabelOffset.yscale,u)&&(V={x:e.__xLabelOffset.x+h,y:e.__xLabelOffset.y+x}),this._setAxisLabelFont(e,k,C,t),!V){let P=e.measureText(k).width,L=l-P-D,B=C;I.bottom+B<c?V={x:L,y:I.bottom+B}:V={x:L,y:I.top-B/2},e.__xLabelOffset={x:V.x-h,y:V.y-x,xscale:p,yscale:u}}e.strokeText(k,V.x,V.y),e.fillText(k,V.x,V.y),e.restore()}else e.__xLabelPosition=null;if(M&&S){Qi(e,"dcg-svg-axis-label"),e.save(),Oi(e),e.fillStyle=m;let V;if(e.__yLabelOffset&&t.settings.isViewportTransient&&a0(e.__yLabelOffset.xscale,p)&&a0(e.__yLabelOffset.yscale,u)&&(V={x:e.__yLabelOffset.x+h,y:e.__yLabelOffset.y+x}),this._setAxisLabelFont(e,M,C,t),!V){let P=e.measureText(M).width,L=C,B=P+5;if(!this._isShortMathyLabel(M)){let W=P;P=L,L=W,B=P*.5}let R=0+D+L;S.left-P>0?V={x:S.left-B,y:R}:V={x:S.right+P,y:R},e.__yLabelOffset={x:V.x-h,y:V.y-x,xscale:p,yscale:u}}e.translate(V.x,V.y),this._isShortMathyLabel(M)||e.rotate(-Math.PI/2),e.strokeText(M,0,0),e.fillText(M,0,0),e.restore()}else e.__yLabelPosition=null}_isShortMathyLabel(e){return e.trim().match(/^([a-zA-Z]?)\(?([a-zA-Z]?)\)?$/)}_setAxisLabelFont(e,t,i,o){this.addTextShadow(e,o),this._isShortMathyLabel(t)?e.font="italic "+Math.round(i*1.4)+"px Times":e.font=Math.round(i*1.2)+"px Arial"}drawCartesianStepNumbers(e,t,i,o,n=LA(t)){e.save();let{showXAxis:a,showYAxis:s}=t.settings,l=a&&t.settings.xAxisNumbers,c=s&&t.settings.yAxisNumbers,{xmin:p,xmax:u,ymin:m,ymax:h}=t.viewport,x=t.screen.width,C=t.screen.height,D={left:3,top:3,right:x-3,bottom:C-3};t.settings.restrictGridToFirstQuadrant&&(p=0,m=0);let k=t.settings.getTextColor({invertBlack:t.settings.threeDMode}),M=t.settings.threeDMode?k:t.settings.labelHangingColor,I=t.mapx(0),S=t.mapy(0),V=t.settings.labelSize;this.addTextShadow(e,t);let P={left:0,right:x,top:S-1,bottom:S+1},L={left:I-1,right:I+1,top:0,bottom:C};if(t.settings.threeDMode&&!t.settings.showNumbers3D)return{x:P,y:L};let B=5,R=!1;if(a&&s&&(l||c)){R=!0,e.fillStyle=k;let b=new js(__dcg_shared_module_exports__['bb'](0,1),V);b.drawCenteredAt(e,{x:I-b.getRect().right-B,y:S-b.getRect().top+B},"dcg-svg-axis-value")}let{majorStepX:W,majorStepY:re}=i,ne=[],X=[];if(l){let b=t.settings.xAxisScale==="logarithmic",A=b?n.x.label:Jc(p,u,W);for(let E of A){let J=b?void 0:u-p,j=__dcg_shared_module_exports__['bb'](E,J,b),ce=new js(j,V);ce.getString()==="0"&&R||ne.push(ce)}}if(c){let b=t.settings.yAxisScale==="logarithmic",A=b?n.y.label:Jc(m,h,re);for(let E of A){let J=b?void 0:h-m,j=__dcg_shared_module_exports__['bb'](E,J,b),ce=new js(j,V);ce.getString()==="0"&&R||X.push(ce)}}if(o){e.save(),Qi(e,"dcg-svg-tickmark");let b=t.settings.axisLineOffset,E="rgba(0,0,0,"+t.settings.axisOpacity.toString()+")";e.lineWidth=t.settings.axisLineWidth,e.strokeStyle=E;let J=Math.round(t.mapy(0))-b,j=Math.round(t.mapx(0))-b,ce=Math.round(2*e.lineWidth)-b;e.beginPath(),ne.forEach(function(te){let pe=Math.round(t.mapx(te.getValue()))-b;e.moveTo(pe,J-ce),e.lineTo(pe,J+ce)}),X.forEach(function(te){let pe=Math.round(t.mapy(te.getValue()))-b;e.moveTo(j-ce,pe),e.lineTo(j+ce,pe)}),e.stroke(),Oi(e),e.restore()}return ne.forEach(function(b){let A={x:t.mapx(b.getValue())-.5*b.getMinusWidth(),y:S-b.getRect().top+B},E=b.clampBoundsWithinRect(A,D);e.fillStyle=A.y===E.y||t.settings.yAxisScale==="logarithmic"?k:M;let J="dcg-svg-axis-value";A.x!==E.x&&(J+=" dcg-svg-offcenter-axis-value"),b.drawCenteredAt(e,E,J),n0(P,b.getRectWhenCenteredAt(E)),Oi(e)}),X.forEach(function(b){let A={x:I-B-b.getRect().right,y:t.mapy(b.getValue())},E=b.clampBoundsWithinRect(A,D);e.fillStyle=A.x===E.x||t.settings.xAxisScale==="logarithmic"?k:M;let J="dcg-svg-axis-value";A.y!==E.y&&(J+=" dcg-svg-offcenter-axis-value"),b.drawCenteredAt(e,E,J),n0(L,b.getRectWhenCenteredAt(E)),Oi(e)}),e.restore(),{x:P,y:L}}};function Jc(r,e,t){let i=Math.ceil(r/t),o=Math.floor(e/t);if(!hQ({nmin:i,nmax:o}))return[];let n=[];for(var a=i;a<=o;a++)n.push(a*t);return n}var hQ=({nmin:r,nmax:e})=>isFinite(e-r)&&e-r<=1e4;function LA(r){return{x:P8("x",r),y:P8("y",r)}}function P8(r,e){let t=new Set,i=new Set,o=new Set,n=1;function a(ae){return I?e.mapx(ae):e.mapy(ae)}function s(ae,ie){return bh(a(ie)-a(ae))}let l=(ae,ie)=>{let de=ae*ie,Ie=(ae+1)*ie;if(de<S&&Ie<S||de>V&&Ie>V)return;let Se=ae>=5?s(7*ie,8*ie):ae>=2?s(3*ie,4*ie):s(ie,2*ie),ot=Se/s(de,Ie);if(Se<40)return;let Ze={settings:{pixelsPerLabel:e.settings.pixelsPerLabel*ot,labelSize:e.settings.labelSize,xAxisNumber:e.settings.xAxisNumbers,yAxisNumber:e.settings.yAxisNumbers},screen:{width:Se,height:Se},viewport:{xmin:de,ymin:de,xmax:Ie,ymax:Ie}},{minorStepX:at,majorStepX:Vt}=rh(Ze),Dt=Math.max(de,S),Mr=Math.min(Ie,V);for(let Ot=Lg(Dt/at);Ot<Og(Mr/at);Ot++)o.add(Ot*at);for(let Ot=Lg(Dt/Vt);Ot<Og(Mr/Vt);Ot++){let Le=Ot*Vt;Le<=de||Le>=Ie||(i.add(Le),t.add(Le))}},c={label:[],major:[],minor:[],unitOpacity:1},{xAxisScale:p,yAxisScale:u,pixelsPerLabel:m}=e.settings,{xmin:h,xmax:x,ymin:C,ymax:D}=e.viewport,{width:k,height:M}=e.screen,I=r==="x",[S,V]=I?[h,x]:[C,D],P=I?k:M,L=I?p:u,B=e.settings.xAxisMinorSubdivisions!==0;if(L!=="logarithmic")return c;let R=Lg(o0(S)),W=Og(o0(V)),re=Og(o0(V)-o0(S)),ne=s(10**R,10**(R+1)),X=15,b=100,A=ne>X,E=[];ne>6.25*m&&(E=[2,3,4,6,8]),ne>12*m&&(E=[2,3,4,5,6,7,8]),ne>14*m&&(E=[2,3,4,5,6,7,8,9]);let J=E.length!=0;if(X<=ne&&ne<=b&&(n=Math.sqrt((ne-X)/(b-X))),!isFinite(re))return c;let j=Lg(P/m),ce=Math.max(1,2**uQ(O8(re/j)));for(let ae=Og(R/ce);ae<=Lg(W/ce);ae++)t.add(10**(ae*ce));i=new Set([...t]);let te=Lg(P/X),pe=Math.max(1,2**Og(O8(re/te)));for(let ae=Og(R/pe);ae<=Lg(W/pe);ae++)(A?i:o).add(10**(ae*pe));if(A)for(let ae=R;ae<W;ae++){let ie=10**ae;for(let de of E)t.add(de*ie);if(J){for(let de=2;de<=9;de++)i.add(de*ie);for(let de=1;de<=9;de++)l(de,ie)}else for(let de=2;de<=9;de++)o.add(de*ie)}B&&(o=new Set);let he=I?e.reverse_mapx(a(S)+m/4):e.reverse_mapy(a(S)-2*e.settings.labelSize);return{label:[...t].filter(ae=>he<=ae&&ae<=V),major:[...i].filter(ae=>S<=ae&&ae<=V),minor:[...o].filter(ae=>S<=ae&&ae<=V),unitOpacity:n}}function n0(r,e){e.left<r.left&&(r.left=e.left),e.right>r.right&&(r.right=e.right),e.top<r.top&&(r.top=e.top),e.bottom>r.bottom&&(r.bottom=e.bottom)}function a0(r,e){let t=bh(r),i=bh(e),o=1e-4;return bh(t-i)<=(t<i?i:t)*o}var Qd=__dcg_shared_module_exports__['h'](z()),l0=class extends Qd.Class{template(){return Qd.createElement("div",{class:Qd.const("dcg-calculator-api-container"),style:()=>({width:this.props.width(),height:this.props.height(),position:"fixed",left:"0px",top:"0px"})},Qd.createElement("div",{class:Qd.const("dcg-container")},Qd.createElement("div",{class:Qd.const("dcg-grapher"),style:()=>({"font-size":this.props.concreteFontSize()})})))}};var as=__dcg_shared_module_exports__['h'](z());var{If:gQ}=as.Components,c0=class extends as.Class{init(){this.grapher=this.props.grapher(),this.controller=this.grapher.controller,this.width=0,this.height=0,this.pixelRatio=0}getDevicePixelRatio(){return window.devicePixelRatio||1}template(){return as.createElement("div",{class:as.const("dcg-graph-outer"),didMount:e=>this.rootNode=e,manageFocus:this.const(Qe({controller:this.controller,location:{type:"graph-paper"}}))},as.createElement("div",{tabindex:()=>this.getShiftTabElementTabIndex(),onFocus:()=>{let e=this.rootNode.getAttribute("aria-label")||"";this.rootNode.setAttribute("aria-label",""),this.rootNode.focus(),this.rootNode.setAttribute("aria-label",e),this.controller.get2dPOIController().handleTabEvent("prev")}}),as.createElement(gQ,{predicate:()=>this.isIOSAndIframe()},()=>as.createElement("div",{style:as.const("width:1px; height:.5px; pointer-events:none; opacity: 0;"),"aria-hidden":as.const("true")},as.const("text"))),as.createElement("canvas",{class:as.const("dcg-graph-inner"),didMount:e=>{this.canvasNode=e,this.ctx=this.canvasNode.getContext("2d"),this.resize(0,0)},style:()=>({position:"relative",display:"block",outline:"none","-webkit-transform":this.isIOSAndIframe()?"translate3d(0,-.25px,0)":void 0})}))}getShiftTabElementTabIndex(){var t;return((t=this.rootNode)==null?void 0:t.getAttribute("tabindex"))!=="0"||this.controller.getActiveTool()!=="selection"||this.rootNode===document.activeElement?"-1":"0"}isIOSAndIframe(){return Iu&&Ip}resize(e,t,i){var o;i=i||this.getDevicePixelRatio(),!(e===this.width&&t===this.height&&i===this.pixelRatio)&&(this.width=e,this.height=t,this.canvasNode.style.width=e+"px",this.canvasNode.style.height=t+"px",this.canvasNode.setAttribute("width",""+e*i),this.canvasNode.setAttribute("height",""+t*i),this.pixelRatio=i,this.ctx=this.canvasNode.getContext("2d"),(o=this.ctx)==null||o.scale(i,i),this.update())}getAriaLabel(e){let t=[],{graphDescription:i}=this.grapher.settings.config;if(this.grapher.type==="3d"&&this.controller.is3dProduct())i!==void 0?t.push(i):(t.push(`${this.controller.s("graphing-calculator-narration-3d-graphpaper-label")}.`),t.push(mw(this.controller)));else if(this.grapher.type==="2d"&&!this.controller.is3dProduct()){let o=this.grapher.getAudioTrace();if(!o)return"";i!==void 0?t.push(i):(t.push(`${this.controller.s("graphing-calculator-narration-graphpaper-label")}.`),t.push(mw(this.controller)),e>0&&(o.getAudioTraceActive()||o.agNavigator.getFirstTraceableSketch({selectAssociatedExpression:!1})!==void 0&&(oi?t.push(this.controller.s("graphing-calculator-narration-audio-instructions-enter-audio-trace-mac")):t.push(this.controller.s("graphing-calculator-narration-audio-instructions-enter-audio-trace-windows")))))}if(t.length)return t.join(" ").trim()}updateAria(e,t){let i=this.getAriaLabel(t);i!==void 0?(this.rootNode.setAttribute("role","img"),this.rootNode.setAttribute("aria-roledescription",this.controller.s("graphing-calculator-narration-graphpaper-label")),this.rootNode.setAttribute("aria-label",i),this.rootNode.setAttribute("aria-hidden",!e||!this.grapher.settings.config.graphpaper?"true":"false"),this.rootNode.setAttribute("tabindex",e&&this.grapher.settings.config.graphpaper&&this.grapher.settings.config.enableTabindex?"0":"-1")):["role","aria-roledescription","aria-label","aria-hidden","tabindex"].forEach(n=>this.rootNode.removeAttribute(n)),this.update()}speakAriaLabelAgain(){let e=this.rootNode.getAttribute("aria-label");e&&be(e)}};var _8=__dcg_shared_module_exports__['h'](z());var OA=class{constructor(e){this.elt=e.elt,this.settings=e.settings,this.controller=e.controller,this.evaluator=e.evaluator,this.elt.style.overflow="hidden"}},PA=class extends OA{constructor(t){super(t);this.canvasLayer=_8.mountToNode(c0,this.elt,{grapher:()=>this}),this.elt.appendChild(this.canvasLayer.rootNode)}getImageData(t,i,o,n){var a;return(a=this.canvasLayer.ctx)==null?void 0:a.getImageData(t,i,o,n)}_setIsVisible(t){t!==this.isVisible&&(this.isVisible=t,t?this.controller.requestRedrawGraph():this.canvasLayer.resize(0,0))}getIsVisible(){return this.isVisible}},_A=class extends PA{setSketchOrder(t){__dcg_shared_module_exports__['P'](this.__sketchOrder,t)||(this.__sketchOrder=t,this.controller.requestRedrawGraph())}getSketchOrder(){return this.__sketchOrder}},FA=class extends _A{constructor(t){super(t);this.__redrawRequested=!1;this.events=new kr}redrawAllLayers(){this.__redrawRequested=!0}redrawAllLayersSynchronously(){return this._redrawAllLayers()}notifyAfterRedraw(t){if(!this.__redrawRequested)t();else{this.notifyAfterRedraw_i?this.notifyAfterRedraw_i++:this.notifyAfterRedraw_i=1;let i="redraw.notifyAfterRedraw"+this.notifyAfterRedraw_i;this.events.observeEvent(i,()=>{this.events.unobserveEvent(i),t()})}}},RA=class extends FA{getUserRequestedViewport(){return this._lastUserRequestedViewport}setUserRequestedViewport(t){this._lastUserRequestedViewportUpdateToken||(this._lastUserRequestedViewportUpdateToken=0),this._lastUserRequestedViewportUpdateToken+=1,this._lastUserRequestedViewport=__dcg_shared_module_exports__['j'](t),this._afterViewportChange()}getCurrentViewport(){return this.viewportController.getViewport().toObject()}debounceUserRequestedViewportChange(){this.__debouncedViewportCommit||(this.__debouncedViewportCommit=__dcg_shared_module_exports__['L']((o,n)=>{if(!this.isDragging&&this._lastUserRequestedViewportUpdateToken===n){if(this._lastUserRequestedViewport){var a=lo.fromObject(this._lastUserRequestedViewport),s=this.computeConcreteViewport(a);if(s.equals(o))return}this.controller.dispatch({type:"commit-user-requested-viewport",viewport:o})}},1e3));let t=this.getCurrentViewport();this.__debouncedViewportCommit(t,this._lastUserRequestedViewportUpdateToken)}},NA=class extends RA{getState(e){let t=__dcg_shared_module_exports__['a']({},this.getCurrentViewport());this.controller.is3dProduct()||(delete t.zmin,delete t.zmax);let i={viewport:t};return this.settings.stateProperties.forEach(o=>{o!=="randomSeed"&&(!this.controller.is3dProduct()&&J_(o)||(i[o]=this.settings[o]))}),e.stripDefaults&&(i=__dcg_shared_module_exports__['Sc'](Fu,i)),i}getUndoRedoDiffState(){let e=this.getUndoRedoFullState();return e.speed3D!==0&&delete e.worldRotation3D,e}getUndoRedoFullState(){let e={};return this.settings.stateProperties.forEach(t=>{e[t]=this.settings[t]}),e.viewport=this.getUserRequestedViewport(),e}},d0=class extends NA{};function mQ(){return new jd(1024,768)}function F8(r){let{xAxisScale:e,yAxisScale:t}=r;return new lo(...e==="linear"?[-Qu,Qu]:[10**-Zu,10**Zu],...t==="linear"?[-Qu,Qu]:[10**-Zu,10**Zu])}var Pg=class r extends d0{constructor(t,i,o,n){super({elt:t,settings:i,controller:o,evaluator:n});this.type="2d";this.__screenRequested3D=new jd(768,768);this.lastActiveToken={selected:void 0,hovered:void 0};this._layerClasses={};this._classLayers={};let a=mQ(),s=F8(i).squareYAxis(a,i);this.setUserRequestedViewport(s),this.__projection=new Wc(a,s,i),this.markLabelsDirty=__dcg_shared_module_exports__['L'](()=>{this.evaluator.notifyWhenSynced(()=>{this.poiLabelsLayer.markLabelsDirty(),this.controller.requestRedrawGraph()})},300),this.poiController=new VE(this,i),this.viewportController=new AE(this,this.controller),this.showPOIDots=!0,this.graphSketches={},this.graphImages={},this.audioGraph=new BE(o,this),this.boxSelectLayer=new zk;var l=document.createElement("div");this.elt.appendChild(l),this.imageLayer=new Sw(this),this.gridLayer=new s0,this.poiDotsLayer=new Kk(this.controller),this.graphsLayer=new eh(this.controller,this.settings,u=>this.audioGraph.getExpressionAriaLabel(u)),this.transformationPreviewLayer=new i0(this),this.clickableObjectsLayer=new kw(this),this.movablePointsLayer=new aw(this);var c=document.createElement("div");this.elt.appendChild(c),this.poiLabelsLayer=Ew.mountToNode(ib,c,{grapher:()=>this});var p=document.createElement("div");this.elt.appendChild(p),this.geoKeyboardCursorLayer=Ew.mountToNode(Uk,p,{grapher:()=>this}),this.traceLayer=this.poiLabelsLayer,this.scaleAxis=void 0}privateGetGridLayer(){return this.gridLayer}static copyGraphProperties(t,i){t=__dcg_shared_module_exports__['Uc'](Fu,t);let o=__dcg_shared_module_exports__['a']({},t);delete o.viewport;let n=i.validateSettings(o);for(let a in n)i.setProperty(a,n[a]);return t}remove(){this.elt.remove(),this.poiController.remove(),this.viewportController.remove(),this.audioGraph.remove()}tick(t){this.__redrawRequested&&this._redrawAllLayers(),this.__movablePointListener&&this.__movablePointListener()}registerMovablePointListener(t){this.__movablePointListener=t}deregisterMovablePointListener(){this.__movablePointListener=void 0}clear(){this.graphSketches={},this.graphImages={}}getGraphSketch(t){return this.graphSketches[t]}getGraphImage(t){return this.graphImages[t]}addGraphSketch(t){this.graphSketches[t.id]=t}removeGraphSketch(t){delete this.graphSketches[t]}addGraphImage(t){t.imageObj.width&&t.imageObj.height?(this.graphImages[t.id]=t,this.controller.requestRedrawGraph()):H(t.imageObj).on("load.calc_load",()=>this.addGraphImage(t))}removeGraphImage(t){let i=this.graphImages[t];i&&H(i.imageObj).off("load.calc_load"),delete this.graphImages[t],this.controller.requestRedrawGraph()}setBoxSelectRectangle(t){this.boxSelectRectangle=t,this.controller.requestRedrawGraph()}getProjection(){return this.__projection}_setProjection(t){this.__projection=t,this.controller.requestRedrawGraph()}getAudioTrace(){return this.audioGraph}getDefaultViewport(){let t=this.getProjection();return F8(this.settings).squareYAxis(t.screen,this.settings)}_updateScreenSize(t,i){if(t<=0||i<=0)return;let n=this.getProjection().screen;if(n.width===t&&n.height===i)return;let a=new jd(t,i);this.viewportController.setScreen(a)}update(){let{top:t,left:i,width:o,height:n}=this.controller.computeMajorLayout().grapher,a=this.controller.isGraphPaperFocused()&&!this.poiController.keyboardAttentionManager.getKeyboardAttention()&&!this.controller.getSelectedGeoExpression()&&!this.geoKeyboardCursorLayer.showCursor()&&!this.controller.inAudioTraceMode();this.elt.classList.toggle("dcg-grapher-focused",a),this.controller.isThreeDMode()&&({width:o,height:n}=this.__screenRequested3D),o>0&&n>0?(this._setIsVisible(!0),this._updateScreenSize(o,n),oa(this.elt,{position:"absolute",left:i+"px",top:t+"px",width:o+"px",height:n+"px"})):this._setIsVisible(!1)}setActiveToken(t,i){var o=this.lastActiveToken[i];this.lastActiveToken[i]=t;var n=t&&this.getGraphSketch(t),a=o&&this.getGraphSketch(o);a!==n&&(a&&(i==="selected"?a.tokenSelected=!1:i==="hovered"&&(a.tokenHovered=!1)),n&&(i==="selected"?n.tokenSelected=!0:i==="hovered"&&(n.tokenHovered=!0))),this.controller.requestRedrawGraph()}deselectSketch(t){let i=this.getGraphSketch(t);i&&(i.selected=!1,i.showPOI=!1,i.showHighlight=!1)}selectSketch(t){let i=this.getGraphSketch(t);i&&(i.selected=!0,i.showPOI=this.controller.isTraceEnabled(),i.showHighlight=!0)}updateSketch(t,i){let o=this.getGraphSketch(t);if(!i.length){this.removeGraphSketch(t);return}let n=new db(t,i);i[0].graphMode!==15&&(n.color=i[0].color,i[0].style&&(n.style=i[0].style)),o&&n.updateFrom(o);let a=!!this.controller.getPropagatedSelectedIds()[t];n.selected=a,n.tokenHovered=t===String(this.lastActiveToken.hovered),n.tokenSelected=t===String(this.lastActiveToken.selected),n.showPOI=a&&this.controller.isTraceEnabled(),n.showHighlight=a,this.addGraphSketch(n)}updateIntersections(t,i){let o=this.getGraphSketch(t);o&&o.updateIntersections(i)}_clear(){let i=this.getProjection().screen;this.canvasLayer.resize(i.width,i.height),this.canvasLayer.ctx&&(this.canvasLayer.ctx.clearRect(0,0,i.width,i.height),this.controller.isThreeDMode()&&!this.controller.getInvertedColors()&&(this.canvasLayer.ctx.fillStyle="rgba(255,255,255,0.001961)",this.canvasLayer.ctx.fillRect(0,0,i.width,i.height)))}isDrawingPlaneFor3dMode(){return this.controller.showPlane3D()||this.controller.showNumbers3D()}createDrawContext(){if(this.canvasLayer.ctx)return{ctx:this.canvasLayer.ctx,projection:this.getProjection(),transformationPreviewParentData:L8(this.controller)}}_redrawAllLayers(){if(this.update(),!this.isVisible&&!this.isDrawingPlaneFor3dMode())return;this.__redrawRequested=!1,this._clear();let t=this.createDrawContext();this.audioGraph.recomputePoints(),this._recomputeClickableObjects(),this._redrawImageLayer(t),this._redrawGridLayer(t),this._redrawGraphsLayer(t),this._redrawPointsAndLabels(t),this._redrawTransformationPreviewLayer(t),this._redrawBoxSelectLayer(t),this._redrawGeoKeyboardCursorLayer(),this._updateCanvasLayerAria(),this.events.triggerEvent("redraw",void 0);let i=this.controller.getGrapher3d();this.isDrawingPlaneFor3dMode()&&i&&i.webglLayer.updatePlaneMap()}_redrawGridLayer(t){t&&this.gridLayer.redrawToCtx(t,this.scaleAxis)}_recomputeClickableObjects(){this.clickableObjectsLayer.redraw()}_redrawGraphsLayer(t){t&&this.graphsLayer.redrawToCtx(t,this.graphSketches,this.graphImages,this.__sketchOrder,this.poiLabelsLayer,this.clickableObjectsLayer)}_redrawTransformationPreviewLayer(t){t&&this.transformationPreviewLayer.redrawToCtx(t)}_redrawBoxSelectLayer(t){t&&this.boxSelectLayer.redrawToCtx(t,this.boxSelectRectangle)}_redrawGeoKeyboardCursorLayer(){this.geoKeyboardCursorLayer.update()}_updateCanvasLayerAria(){let t=0;for(let i in this.graphSketches)Il(this.controller,this.graphSketches[i])&&(t+=1);this.canvasLayer.updateAria(this.isVisible,t)}_redrawPointsAndLabels(t){if(!t)return;let i=[];this.controller.isThreeDMode()||this.movablePointsLayer.redraw(t,i),this.showPOIDots&&!this.controller.isThreeDMode()&&this.poiDotsLayer.redrawToCtx(t,this.graphSketches,this.poiLabelsLayer,this.clickableObjectsLayer,this.__sketchOrder);let o=this.elt.getBoundingClientRect();if(this.controller.isThreeDMode())this.poiLabelsLayer.drawForScreenshot(t,t.ctx,this.size(),i);else{let n=this.controller.findEl(".dcg-overgraph-pillbox-elements"),a=this.controller.findEl(".dcg-graphpaper-branding");__dcg_shared_module_exports__['r']([n,a],s=>{if(!s)return;let l=s.getBoundingClientRect();i.push({left:l.left-o.left,top:l.top-o.top,right:l.right-o.left,bottom:l.bottom-o.top})}),this.poiLabelsLayer.redraw(t,this.size(),i)}}size(){let t=this.canvasLayer.ctx;if(!t)return{width:0,height:0};let i=t.canvas.getBoundingClientRect();return{width:i.width,height:i.height}}_redrawImageLayer(t){t&&(this.controller.isThreeDMode()||this.imageLayer.redrawToCtx(t,this.graphImages,this.__sketchOrder))}_parseScreenshotOpts(t){return fQ(t,this.settings,this.getProjection().screen)}_syncScreenshotReturnCanvas(t){var i=document.createElement("canvas");if(t&&t.braille){let{embosserModel:o,brailleMode:n}=t.braille,a=mh[o];i.width=a.width,i.height=a.height,T8(i,this,a,o,n)}else{let o=this._parseScreenshotOpts(t);i.width=o.width*o.targetPixelRatio,i.height=o.height*o.targetPixelRatio,this.screenshotToCanvas(i,t)}return i}screenshot(t){return this._syncScreenshotReturnCanvas(t).toDataURL("image/png")}asyncScreenshot(t,i){let o=!1;!t.transparentBackground&&t.showLabels&&(t=__dcg_shared_module_exports__['j'](t),t.transparentBackground=!0,o=!0);let n=this._syncScreenshotReturnCanvas(t),a=n.getContext("2d"),s=n,l=a;t&&t.format==="svg"&&(o=!1,t.transparentBackground&&(t=__dcg_shared_module_exports__['j'](t),t.transparentBackground=!1),l=new dB(n.width,n.height),s={getContext:()=>l,width:n.width,height:n.height},this.screenshotToCanvas(s,t));let c=this.makeScreenshotProjection(t),p=[];if(t.showMovablePoints&&this.movablePointsLayer.drawForScreenshot(l,c,p),t.showLabels){var u=c.screen.width,m=c.screen.height,h=c.settings.labelSize||15,x=1;(u<200||m<200)&&(x=.9);let C=h*x+"px",D=document.createElement("div");D.classList.add("dcg-calculator-screenshot-labels-container"),Ew.mountToNode(l0,D,{concreteFontSize:()=>C,width:()=>`${c.screen.width}px`,height:()=>`${c.screen.height}px`}),document.body.append(D);let k=Ew.mountToNode(ib,D.querySelector(".dcg-grapher"),{grapher:()=>this}),M={width:c.screen.width,height:c.screen.height};k.drawForScreenshot({projection:c,ctx:a,transformationPreviewParentData:{translationPreviewVectorParents:new Set,translationsWithVisibleVectorParent:new Set,rotationPreviewAngleMarkerParents:new Set,rotationsWithVisibleAndCenteredAngle:new Set}},l,M,p),D.remove()}o&&(l.globalCompositeOperation="destination-over",l.fillStyle="#FFF",l.fillRect(0,0,s.width,s.height)),t&&t.format==="svg"?i(l.getSerializedSvg()):i(s.toDataURL("image/png"))}makeScreenshotProjection(t){let{width:i,height:o,settings:n}=this._parseScreenshotOpts(t),a=new jd(i,o),s=this.getProjection().viewport;return this.settings.squareAxes&&(s=s.squareCrop(a,this.settings)),new Wc(a,s,n)}screenshotToCanvas(t,i){let o=this._parseScreenshotOpts(i),{targetPixelRatio:n,transparentBackground:a}=o,s=t.getContext("2d");s.scale(n,n);let l=this.makeScreenshotProjection(i);l.settings.takingScreenshot=!0,Ra(s,"background"),Qi(s,"dcg-svg-background"),a?s.clearRect(0,0,l.screen.width,l.screen.height):(s.fillStyle="white",s.fillRect(0,0,l.screen.width,l.screen.height)),Oi(s),Na(s);let c={ctx:s,projection:l,transformationPreviewParentData:{translationPreviewVectorParents:new Set,translationsWithVisibleVectorParent:new Set,rotationPreviewAngleMarkerParents:new Set,rotationsWithVisibleAndCenteredAngle:new Set}};this.imageLayer.redrawToCtx(c,this.graphImages,this.__sketchOrder),this.gridLayer.redrawToCtx(c),this.graphsLayer.redrawToCtx(c,this.graphSketches,this.graphImages,this.__sketchOrder,this.poiLabelsLayer,this.clickableObjectsLayer,i)}speakGrapherFocusAriaLabel(){this.canvasLayer.speakAriaLabelAgain()}_afterViewportChange(){}setGrapherState(t,i){if((!i||!i.doNotClear)&&this.clear(),t=r.copyGraphProperties(t,this.settings),"viewport"in t){let o=lo.fromObject(t.viewport);this.setUserRequestedViewport(o);let n=this.computeConcreteViewport(o);this.viewportController.setViewport(n)}this.controller.requestRedrawGraph()}computeConcreteViewport(t){let i=this.getProjection().screen;return this.settings.squareAxes&&!t.isSquare(i,this.controller.getAxisScaleSettings())?t.squareYAxis(i,this.settings):t}classLayers(t){var i,o;return(o=(i=this._classLayers)[t])!=null?o:i[t]=new Set}setLayerClass(t,i){var o=this._layerClasses[t];if(this._layerClasses[t]=i,o!==i){if(o){let n=this.classLayers(o);n.delete(t),n.size===0&&this.elt.classList.remove(o)}i&&(this.classLayers(i).add(t),this.elt.classList.add(i))}}setCanvasSizeFor3D(t,i){this.__screenRequested3D=new jd(t,i)}getCanvasNode(){return this.canvasLayer.canvasNode}};function fQ(r,e,t){let i,o,n,a,s,l;return r?(i=r.width||r.height||t.width,o=r.height||r.width||t.height,n=r.targetPixelRatio||1,n<1&&(n=1),a=(i<256||o<256)&&!r.preserveAxisNumbers,s=Pp.fromObject(r.settings||e),l=!!r.transparentBackground):(i=t.width,o=t.height,n=1,a=!1,s=Pp.fromObject(e),l=!1),a&&(s.setProperty("xAxisNumbers",!1),s.setProperty("yAxisNumbers",!1),s.setProperty("polarNumbers",!1)),{width:i,height:o,targetPixelRatio:n,settings:s,transparentBackground:l}}var Gw=class{constructor(){this.displayName="graphing-calculator-text-geometry-tool-selection-display-name";this.toolType="selection";this.icon=[{type:"filled-polygon",color:"#000",path:[40,30,58,46,51,47,56,60,53,62,47,49,41,54,40,30]}]}getNumberInputLatex(){return""}clearTentativeOutputs(){}canNextInputBePoint(){return!1}getAllValidNextInputTypes(){return __dcg_shared_module_exports__['Ha'].filter(e=>this.isValidNextInputType(e))}isValidNextInputType(e){return e!==__dcg_shared_module_exports__['Ba']}getNonPointInputType(){}getHint(){return""}getExpressionEditHint(e){return this.getHint()}onNumberInput(e){}onMove(e){return!0}onFocus(e){}tryCommitResults(){return{committed:void 0}}shouldUseJitEdges(){return!1}shouldHighlightRelevantObjects(){return!1}};var R8="graphing-calculator-text-geometry-tool-point-hint",Tw=class extends jr{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-point-display-name",this.toolName="point",this.toolType="simple",this.icon=[{type:"point",x:50,y:50,size:"large"}]}getExpressionEditHint(t){return this.s(R8)}getSpec(){return{inputs:[{type:"point",id:"1",hint:R8}],outputs:[]}}};var N8="graphing-calculator-text-geometry-tool-line-hint-start",B8="graphing-calculator-text-geometry-tool-line-hint-end",Iw=class extends jr{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-line-display-name",this.toolType="simple",this.toolName="line",this.icon=[{type:"stroked-path",path:[78,22,22,78],lineWidth:"large"},{type:"point",x:68,y:32},{type:"point",x:32,y:68}]}getExpressionEditHint(t){return t===0?this.s(N8):this.s(B8)}getSpec(){return{inputs:[{type:"point",id:"1",hint:N8},{type:"point",id:"2",hint:B8}],outputs:[{id:"3",type:"line",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var q8="graphing-calculator-text-geometry-tool-segment-hint-start",K8="graphing-calculator-text-geometry-tool-segment-hint-end",Vw=class extends jr{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-segment-display-name",this.toolName="segment",this.toolType="simple",this.icon=[{type:"stroked-path",path:[68,32,32,68],lineWidth:"large"},{type:"point",x:68,y:32},{type:"point",x:32,y:68}]}getExpressionEditHint(t){return t===0?this.s(q8):this.s(K8)}getSpec(){return{inputs:[{type:"point",id:"1",hint:q8},{type:"point",id:"2",hint:K8}],outputs:[{id:"3",type:"segment",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var z8="graphing-calculator-text-geometry-tool-ray-hint-start",U8="graphing-calculator-text-geometry-tool-ray-hint-end",Mw=class extends jr{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-ray-display-name",this.toolName="ray",this.toolType="simple",this.icon=[{type:"stroked-path",path:[78,22,32,68],lineWidth:"large"},{type:"point",x:68,y:32},{type:"point",x:32,y:68}]}getExpressionEditHint(t){return t===0?this.s(z8):this.s(U8)}getSpec(){return{inputs:[{type:"point",id:"1",hint:z8},{type:"point",id:"2",hint:U8}],outputs:[{id:"3",type:"ray",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var H8="graphing-calculator-text-geometry-tool-circle-hint-center",W8="graphing-calculator-text-geometry-tool-circle-hint-radius",Aw=class extends jr{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-circle-display-name",this.toolName="circle",this.toolType="simple",this.icon=[{type:"circle",x:50,y:50,radius:26},{type:"point",x:50,y:50},{type:"point",x:68,y:32}]}getExpressionEditHint(t){return t===0?this.s(H8):this.s(W8)}getSpec(){return{inputs:[{type:"point",id:"1",hint:H8},{type:"point",id:"2",hint:W8}],outputs:[{id:"3",type:"circle",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var $8="graphing-calculator-text-geometry-tool-arc-hint-1",j8="graphing-calculator-text-geometry-tool-arc-hint-2",Y8="graphing-calculator-text-geometry-tool-arc-hint-3",Lw=class extends jr{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-arc-display-name",this.toolName="arc",this.toolType="complex";let i=50,o=80,n=80,a=-3,s=-2.6,l=-1.7;this.icon=[{type:"arc",x:o,y:n,radius:i,startAngle:a,endAngle:l},{type:"point",x:o+i*Math.cos(a),y:n+i*Math.sin(a)},{type:"point",x:o+i*Math.cos(s),y:n+i*Math.sin(s)},{type:"point",x:o+i*Math.cos(l),y:n+i*Math.sin(l)}]}getExpressionEditHint(t){return t===0?this.s($8):t===1?this.s(j8):this.s(Y8)}getSpec(){return{inputs:[{type:"point",id:"1",hint:$8},{type:"point",id:"2",hint:j8},{type:"point",id:"3",hint:Y8}],outputs:[{id:"4",type:"arc",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"},{type:"reference-input",id:"3"}]}]}}};var J8="graphing-calculator-text-geometry-tool-parallel-hint-straight-line",X8="graphing-calculator-text-geometry-tool-parallel-hint-point",Ow=class extends jr{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-parallel-display-name",this.toolName="parallel",this.toolType="complex",this.icon=[{type:"stroked-path",color:"light",path:[25,50,75,30],lineWidth:"large"},{type:"stroked-path",path:[25,70,75,50],lineWidth:"large"},{type:"point",x:50,y:60,size:"medium"}]}getExpressionEditHint(t){return t===0?this.s(J8):this.s(X8)}getSpec(){return{inputs:[{type:"straight",id:"1",hint:J8},{type:"point",id:"2",hint:X8}],outputs:[{id:"3",type:"parallel",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var Q8="graphing-calculator-text-geometry-tool-perpendicular-hint-straight-line",Z8="graphing-calculator-text-geometry-tool-perpendicular-hint-point",Pw=class extends jr{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-perpendicular-display-name",this.toolName="perpendicular",this.toolType="complex",this.icon=[{type:"stroked-path",color:"light",path:[40,25,60,75],lineWidth:"large"},{type:"stroked-path",path:[25,60,75,40],lineWidth:"large"},{type:"point",x:50,y:50,size:"medium"}]}getExpressionEditHint(t){return t===0?this.s(Q8):this.s(Z8)}getSpec(){return{inputs:[{type:"straight",id:"1",hint:Q8},{type:"point",id:"2",hint:Z8}],outputs:[{id:"3",type:"perpendicular",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var BA="graphing-calculator-text-geometry-tool-midpoint-hint",_w=class extends jr{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-midpoint-display-name",this.toolName="midpoint",this.toolType="simple",this.icon=[{type:"stroked-path",path:[32,32,68,68]},{type:"point",x:50,y:50,size:"large"},{type:"point",x:32,y:32,size:"medium"},{type:"point",x:68,y:68,size:"medium"}]}getExpressionEditHint(t){return this.getHint()}canNextInputBePoint(){return!0}getNonPointInputType(){let{inputIndex:t}=this.model.getNonObjectsState().ui.currentTool;if(t===0)return"segment"}getSpec(){let{idMap:t}=this.model.getNonObjectsState().ui.currentTool,i=this.model.getUncommittedObjects(),o=t[1],n=!1;if(i[o]&&bQ(i[o]))n=!0;else{let a=o&&this.model.findDefsForInputId(o)[0];n=!!(a&&a.typedRuntimeValue.valueType==__dcg_shared_module_exports__['da'])}return n?{inputs:[{type:"union",valueTypes:[__dcg_shared_module_exports__['da'],__dcg_shared_module_exports__['na']],id:"1",hint:BA},{type:"point",id:"2",hint:BA}],outputs:[{id:"midpoint-output",type:"midpoint",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}:{inputs:[{type:"segment",id:"1",hint:BA}],outputs:[{id:"midpoint-output",type:"midpoint",hidden:!1,parents:[{type:"reference-input",id:"1"}]}]}}};function bQ(r){switch(r.type){case"point":case"intersection":case"glider":case"point-reference":case"midpoint":case"vector-endpoint":return!0;case"polygon":case"circle":case"arc":case"compass":case"segment":case"line":case"ray":case"vector":case"vector-copy":case"parallel":case"perpendicular":case"translate":case"reflect":case"dilate":case"rotate":case"angle":case"directedangle":case"angles":case"directedangles":case"polygon-segment":case"slider":case"expression-edit-preview-latex":return!1;default:return r}}var yQ="graphing-calculator-text-geometry-tool-polygon-hint-first-point",eK="graphing-calculator-text-geometry-tool-polygon-hint-next-point",xQ="graphing-calculator-text-geometry-tool-polygon-hint-finish-point",Fw=class extends jr{constructor(t){super(t);this.model=t;this.addExtraPoint=!1;this.mouseOverFirstPoint=!1;this.mouseOverLastPoint=!1;this.displayName="graphing-calculator-text-geometry-tool-polygon-display-name",this.toolName="polygon",this.toolType="complex",this.icon=[{type:"filled-polygon",path:[55,30,30,30,35,70,70,60,55,30]},{type:"stroked-path",path:[55,30,30,30,35,70,70,60,55,30]},{type:"point",x:55,y:30},{type:"point",x:30,y:30},{type:"point",x:35,y:70},{type:"point",x:70,y:60}]}clearTentativeOutputs(){let t=this.addExtraPoint;this.addExtraPoint=!0,super.clearTentativeOutputs(),this.addExtraPoint=t}getHint(){let t=this.model.getNonObjectsState().ui.currentTool.inputIndex;return t===0?this.s(yQ):t<3?this.s(eK):this.s(xQ)}getExpressionEditHint(t){return this.s(eK)}canNextInputBePoint(){return!0}isDegenerateInput(t){return!1}getSpec(){let{inputIndex:t}=this.model.getNonObjectsState().ui.currentTool,i=t;this.addExtraPoint&&(i+=1),i<2&&(i=2);let o={inputs:[],outputs:[]},n=[];for(let a=0;a<i;a++){let s=a.toString();n.push({type:"reference-input",id:s}),o.inputs.push({type:"point",id:s})}return o.outputs.push({id:"polygon",type:"polygon",hidden:!1,parents:n,connectBorder:this.mouseOverFirstPoint}),o}tryCommitResults(){let t=this.getSpec();if(this.model.attemptLockToolInputIn(t),this.addExtraPoint=!1,!this.mouseOverFirstPoint&&!this.mouseOverLastPoint)return{committed:void 0};if(this._isReadyToCommit()){this.mouseOverFirstPoint=!1,this.mouseOverLastPoint=!1;let i=this.model.getUncommittedObjects(),o=__dcg_shared_module_exports__['a']({},this.model.getNonObjectsState().ui.currentTool.idMap);return this.model.commitObjects(),this.model.deselectAllObjects(),this.model.cancelToolplay(),{committed:i,toolIdToLatex:o}}return{committed:void 0}}tentativelyAddInput({target:t,pointInfo:i},o){this.mouseOverFirstPoint=!1,this.mouseOverLastPoint=!1,this.addExtraPoint=!1;let n=t?this.getExpandedReferenceForDef(t,o):i==null?void 0:i.reference,{idMap:a,inputIndex:s}=this.model.getNonObjectsState().ui.currentTool;if(this.mouseOverFirstPoint=a[0]===n,this.mouseOverLastPoint=a[s-1]===n,!this.mouseOverFirstPoint&&!this.mouseOverLastPoint)this.addExtraPoint=!0;else{t||(t=i==null?void 0:i.def),t&&this.model.setObjectHovered({calcId:t.calcId,listIndex:this.getListIndexForHover(t,o)});return}super.tentativelyAddInput({target:t,pointInfo:i},o)}onMove(t){let i=this.model.getObjectDefUnderMouse(t.pt,t.tolerance);if(i){let o=this.getExpandedReferenceForDef(i,t.shift),{idMap:n,inputIndex:a}=this.model.getNonObjectsState().ui.currentTool;this.mouseOverFirstPoint=n[0]===o,this.mouseOverLastPoint=n[a-1]===o}return this.addExtraPoint=!this.mouseOverFirstPoint&&!this.mouseOverLastPoint,super.onMove(t)}};var wQ="graphing-calculator-text-geometry-tool-compass-hint-segment",vQ="graphing-calculator-text-geometry-tool-compass-hint-center",Rw=class extends jr{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-compass-display-name",this.toolName="compass",this.toolType="complex",this.icon=[{type:"stroked-path",path:[50,50,75,50]},{type:"circle",x:50,y:50,radius:25}]}getExpressionEditHint(t){return this.getHint()}getSpec(){return{inputs:[{type:"segment",id:"1",hint:wQ},{type:"point",id:"2",hint:vQ}],outputs:[{id:"3",type:"circle",hidden:!1,parents:[{type:"reference-input",id:"2"},{type:"reference-input",id:"1"}]}]}}};var tK="graphing-calculator-text-geometry-tool-angle-hint-1",rK="graphing-calculator-text-geometry-tool-angle-hint-2",iK="graphing-calculator-text-geometry-tool-angle-hint-3",oK="graphing-calculator-text-geometry-tool-angles-hint-1",_g=class extends jr{constructor(t){super(t);this.model=t;this.toolType="complex",this.displayName="graphing-calculator-text-geometry-tool-angle-display-name",this.toolName="angle",this.angleType="angle",this.anglesType="angles",this.icon=[{type:"stroked-path",path:[40,30,30,70,70,70],color:"#CCC"},{type:"angle",x:30,y:70,radius:20,startAngle:-1.325817,deltaAngle:1.325817,isDirected:!1},{type:"point",x:30,y:70},{type:"point",x:40,y:30},{type:"point",x:70,y:70}]}canNextInputBePoint(){return!0}shouldReferenceSpecificItemInList(t,i){return __dcg_shared_module_exports__['Pa'](t.typedRuntimeValue.valueType,__dcg_shared_module_exports__['la'])?!0:super.shouldReferenceSpecificItemInList(t,i)}getNonPointInputType(){let{inputIndex:t}=this.model.getNonObjectsState().ui.currentTool;if(t===0)return"polygon"}getExpressionEditHint(t){return t===0?this.s(tK):t===1?this.s(rK):this.s(iK)}getSpec(){let{inputIndex:t,idMap:i}=this.model.getNonObjectsState().ui.currentTool,o=i[1];if(!t&&!o)return{inputs:[{type:"polygon",id:"1",hint:oK}],outputs:[{id:"2",type:this.anglesType,listAccess:void 0,hidden:!1,parents:[{type:"reference-input",id:"1"}]}]};let n=[];if(o&&this.model.findDefsForInputId(o).forEach(s=>{let l=s.typedRuntimeValue;if(l.valueType===__dcg_shared_module_exports__['la']){let c=l.value.length;c>0&&n.push({referenceLatex:s.referenceLatex,sides:c})}}),n.length){let a=[],s=2;return n.forEach(l=>{for(var c=0;c<l.sides;c++)a.push({id:s+"",type:this.anglesType,listAccess:c+1,hidden:!1,parents:[{type:"hardcoded",id:l.referenceLatex}]}),s+=1}),{inputs:[{type:"polygon",id:"1",hint:oK}],outputs:a}}return{inputs:[{type:"point",id:"1",hint:tK},{type:"point",id:"2",hint:rK},{type:"point",id:"3",hint:iK}],outputs:[{id:"4",type:this.angleType,hidden:!1,showAngleLabel:!0,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"},{type:"reference-input",id:"3"}]}]}}};var Nw=class extends _g{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-directedangle-display-name",this.toolName="directedangle",this.angleType="directedangle",this.anglesType="directedangles",this.icon=[{type:"stroked-path",path:[40,30,30,70,70,70],color:"#CCC"},{type:"angle",x:30,y:70,radius:20,isDirected:!0,startAngle:-1.325817,deltaAngle:1.325817},{type:"stroked-path",path:[35,50,41,50,37,55,35,50],color:"#000",lineWidth:"medium"},{type:"point",x:30,y:70},{type:"point",x:40,y:30},{type:"point",x:70,y:70}]}};var nK="graphing-calculator-text-geometry-tool-reflection-hint-choose-line",Bw=class extends Yc{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-reflect-display-name",this.toolName="reflection",this.toolType="transformation"}getExpressionEditHint(t){return this.s(nK)}getSpec(){return{inputs:[{type:"straight",id:"1",hint:nK}],outputs:[{id:"2",type:"reflect",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"}]}]}}};var qA="graphing-calculator-text-geometry-tool-translation-hint-from-with-vector",aK="graphing-calculator-text-geometry-tool-translation-hint-to",qw=class extends Yc{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-translate-display-name",this.toolName="translation",this.toolType="transformation"}getExpressionEditHint(t){return t===0?this.s(qA):this.s(aK)}firstInputIsVector(){let{idMap:t}=this.model.getNonObjectsState().ui.currentTool,i=t[1],o=i&&this.model.findDefsForInputId(i)[0];return o&&o.typedRuntimeValue.valueType===__dcg_shared_module_exports__['Da']}getSpec(){return this.firstInputIsVector()?{inputs:[{type:"union",valueTypes:[__dcg_shared_module_exports__['da'],__dcg_shared_module_exports__['Da']],id:"1",hint:qA}],outputs:[{id:"3",type:"translate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"}]}]}:{inputs:[{type:"union",valueTypes:[__dcg_shared_module_exports__['da'],__dcg_shared_module_exports__['Da']],id:"1",hint:qA},{type:"point",id:"2",hint:aK}],outputs:[{id:"3",type:"translate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var sK="graphing-calculator-text-geometry-tool-dilation-hint-center",lK="graphing-calculator-text-geometry-tool-dilation-hint-scale-factor",Kw=class extends Yc{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-dilate-display-name",this.toolName="dilation",this.toolType="transformation"}getExpressionEditHint(t){return t===0?this.s(sK):this.s(lK)}getSpecIdToLockIn(t,i){return i===1?"2-number":super.getSpecIdToLockIn(t,i)}getSpec(){return{inputs:[{type:"point",id:"1",hint:sK},{type:"union",valueTypes:[],id:"2",hint:lK,numberInputInfo:{defaultLatex:"2",sliderInfo:{value:"2",min:"0",max:"5"}}}],outputs:[{id:"3",type:"dilate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2-number"}]}]}}};var yh=class extends jr{constructor(t){super(t);this.model=t;this.displayName="graphing-calculator-text-geometry-tool-expression-edit-display-name",this.toolType="custom",this.toolName="expression-edit"}getHint(){let t=this.model.controller.getValidCursorContext();if((t==null?void 0:t.type)!=="expression-arguments"||!t.functionSymbol)return this.getGenericHint();let i=this.model.getTool(t.functionSymbol);if(!i)return this.getGenericHint();let o=t.argIndex;return t.positionWithinArg==="end"&&(o+=1),i.getExpressionEditHint(o)}getGenericHint(){let t=this.getAllValidNextInputTypes();if(t.some(o=>o===__dcg_shared_module_exports__['ba']||o===__dcg_shared_module_exports__['ea']))return wo("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-any-object");let i=t.filter(o=>!(__dcg_shared_module_exports__['Ka'](o)&&t.find(n=>__dcg_shared_module_exports__['La'](o)===n))).map(o=>kd(__dcg_shared_module_exports__['Ja'](o),nx()));return i.length===0?wo("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-0"):i.length===1?wo("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-1",{type:i[0]}):i.length===2?wo("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-2",{type1:i[0],type2:i[1]}):wo("graphing-calculator-text-geometry-tool-expression-edit-generic-hint-many",{types:i.join(", ")})}getExpressionEditHint(t){return this.getHint()}getSpec(){let t=this.model.controller.getSelectedItem(),i=KA(this.model.controller.getValidCursorContext());return!i||!t||t.type!=="expression"?{inputs:[],outputs:[]}:{inputs:[{type:"union",valueTypes:i,id:"1"}],outputs:[{type:"expression-edit-preview-latex",rhsLatex:this.buildPreviewLatex(),hidden:!1,color:t.color,id:"2",parents:[]}]}}onMove(t){super.onMove(t);let{idMap:i,inputIndex:o}=this.model.getNonObjectsState().ui.currentTool,n=this.getSpec().inputs[o];return!!(n&&i[n.id])}buildPreviewLatex(){let t="",i="",o=this.model.controller.getValidCursorContext();if((o==null?void 0:o.type)==="empty")return"";(o==null?void 0:o.type)==="expression-arguments"&&((o==null?void 0:o.positionWithinArg)==="end"?t=",":(o==null?void 0:o.positionWithinArg)==="start"&&(i=","));let n=this.model.getNonObjectsState().ui.currentTool.idMap,a=t+n[1]+i,s=this.model.controller.getSelectedItem();if((s==null?void 0:s.type)!=="expression")return"";let l=_e.getFocusedMathquill(),c=l==null?void 0:l.selection();if((c==null?void 0:c.latex)!==s.latex)return"";let p=s.latex.slice(0,c.startIndex)+a+s.latex.slice(c.endIndex);return Fo(s)?p.slice(s.latex.indexOf("=")+1):p}canNextInputBePoint(){let t=this.model.controller.getValidCursorContext();if((t==null?void 0:t.type)!=="expression-arguments"||t.expressionType!=="FunctionCall"&&t.expressionType!=="List")return!1;let i=KA(t);if(!i)return!1;let o=!1;for(let n of i){if(__dcg_shared_module_exports__['Pa'](n,__dcg_shared_module_exports__['ba']))return!1;__dcg_shared_module_exports__['Pa'](n,__dcg_shared_module_exports__['da'])&&(o=!0)}return o}shouldHighlightRelevantObjects(){let t=this.model.controller.getValidCursorContext();if((t==null?void 0:t.type)==="empty")return!1;let i=KA(t);return!(!i||i.some(o=>__dcg_shared_module_exports__['Pa'](o,__dcg_shared_module_exports__['ba']))||i.every(o=>__dcg_shared_module_exports__['Pa'](o,__dcg_shared_module_exports__['ca'])||__dcg_shared_module_exports__['Pa'](o,__dcg_shared_module_exports__['xa'])||__dcg_shared_module_exports__['Pa'](o,__dcg_shared_module_exports__['za'])))}};function KA(r){if((r==null?void 0:r.type)==="empty")return[__dcg_shared_module_exports__['xa'],__dcg_shared_module_exports__['za'],__dcg_shared_module_exports__['ya'],__dcg_shared_module_exports__['Aa'],__dcg_shared_module_exports__['Da']];let e=(r==null?void 0:r.type)==="expression-arguments"?r.allowedTypesForInsertedArg:r==null?void 0:r.allowedTypes;return e==null?void 0:e.filter(t=>!__dcg_shared_module_exports__['Pa'](t,__dcg_shared_module_exports__['Fa']))}var CQ={selection:Gw,point:Tw,line:Iw,segment:Vw,ray:Mw,vector:iw,circle:Aw,arc:Lw,parallel:Ow,perpendicular:Pw,midpoint:_w,polygon:Fw,compass:Rw,angle:_g,directedangle:Nw,reflect:Bw,translate:qw,rotate:Ag,dilate:Kw,"box-selection":Gg,"expression-edit":yh},zA=CQ;function DQ(r,e){var a;if(e.typedRuntimeValue.valueType===__dcg_shared_module_exports__['Ba'])return[];let t=e.data.call;if(!t||!t.parents)return[];let i=t.symbol,o=t.parents.map(bb),n;switch(i){case"circle":{let[s,l]=o,c=l&&((a=r[l])==null?void 0:a.typedRuntimeValue.valueType);c&&__dcg_shared_module_exports__['Pa'](c,__dcg_shared_module_exports__['na'])?n=[s]:n=[s,l];break}case"apply":{n=[o[1]];break}case"parallel":case"perpendicular":{n=[o[1]];break}case"polygon":{n=o.every(s=>s!==void 0)?o:[];break}default:n=o}return n.filter(dK)}var SQ=[[1,0],[0,0],!1],zw=class zw{constructor(e,t){let i=(e==null?void 0:e.list)||[];t&&(i=i.concat(t)),this.list=i;let o=(e==null?void 0:e.forward)||SQ;t&&(o=__dcg_shared_module_exports__['Wb'](o,t.value)),this.forward=o,this.inverse=__dcg_shared_module_exports__['Xb'](o)}add(e){return new zw(this,e)}equals(e){if(this.list.length!==e.list.length)return!1;for(let t=this.list.length-1;t>=0;t--){let i=this.list[t],o=e.list[t];if(!__dcg_shared_module_exports__['P'](i,o))return!1}return!0}isCompletelyRigid(){return this.list.length===0}};zw.COMPLETELY_RIGID=new zw(void 0);var p0=zw;function kQ(r){var i,o;let e={},t={};for(let n in r){let a=r[n];if(!a)continue;for(let l of((i=a.data.call)==null?void 0:i.parents)||[]){let c=bb(l);c&&(e[c]||(e[c]=[]),(o=e[c])==null||o.push(a.assignment))}let s=DQ(r,a);t[a.assignment]=s}return{parentToChildren:e,childToReversibilityParents:t}}function cK(r){let e=[],t={},i,o=1,n=2;function a(s){var l;t[s]!==n&&(t[s]=o,(l=r[s])==null||l.forEach(a),t[s]=n,e.unshift(s))}for(let s in r)t[s]===i&&a(s);return e}function UA(r,e){var u,m,h,x,C,D,k,M,I,S;let t={},i={},o={},n={},a={};for(let V of e)a[V]=!0,o[V]=p0.COMPLETELY_RIGID;let{parentToChildren:s,childToReversibilityParents:l}=kQ(r);for(let V of cK(l)){let P=r[V];if(!P)continue;let L=(u=P.data.call)==null?void 0:u.symbol,B=(((m=P.data.call)==null?void 0:m.parents)||[]).map(bb).filter(dK);if(o[P.assignment])if(P.typedRuntimeValue.valueType===__dcg_shared_module_exports__['da']&&!L)t[P.assignment]=o[P.assignment];else if(L==="glider"&&B.length&&!a[B[0]])i[P.assignment]=o[P.assignment];else{let R=o[P.assignment];if(L==="apply"){let re=(h=r[B[0]])==null?void 0:h.typedRuntimeValue;if((re==null?void 0:re.valueType)!==__dcg_shared_module_exports__['Ba'])continue;R=R.add(re)}let W=(x=l[P.assignment])!=null?x:[];for(let re of W)o[re]?R.equals(o[re])||(o[re]=p0.COMPLETELY_RIGID,n[re]=!0):o[re]=R}}let c={};for(let V in o)c[V]=!0;for(let V of cK(s))if(c[V]){for(let P of s[V]||[])c[P]=!0;if(o[V]){let P=l[V]||[];for(let L of P)n[L]&&(n[V]=!0)}}for(let V in i){let L=(((D=(C=r[V])==null?void 0:C.data.call)==null?void 0:D.parents)||[]).map(bb)[0];L&&c[L]&&(n[L]=!0)}for(let V in r){if(!c[V])continue;let P=r[V],L=(k=P==null?void 0:P.data.call)==null?void 0:k.symbol,B=(((M=P==null?void 0:P.data.call)==null?void 0:M.parents)||[]).map(bb);if(L==="apply"&&o[V]){let R=B[1],W=B[0];if(!R||!W)continue;let re=(((S=(I=r[W])==null?void 0:I.data.call)==null?void 0:S.parents)||[]).map(bb),ne=re.some(b=>b&&c[b]);if(o[V].isCompletelyRigid()&&o[R].isCompletelyRigid()||ne){n[R]=!0;for(let b of re)b&&(n[b]=!0)}}}let p=[];for(let V in n)a[V]||p.push(V);return p.length?UA(r,e.concat(p)):__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},t),i)}function bb(r){return r?__dcg_shared_module_exports__['hb'](r[0]):void 0}function dK(r){return r!==void 0}var Uw=class{constructor(){this._nextId=0;this._defs={}}clear(){this._nextId=0,this._defs={}}add(e,t){let i;t?(i=e.assignment,e.listIndex!==void 0&&(i+="\\left["+e.listIndex+"\\right]")):i="**geo-internal-id-"+this._nextId++,this._defs[i]=e}computeReversibilityLineages(e){var s;let t=this.buildAssignmentMap(),i={};for(let l in t){let c=t[l];c&&(i[c.calcId]=c)}let o=[];for(let l of e){let c=i[l];if(!c)return{};o.push(c.assignment)}let n=UA(this.buildAssignmentMap(),o),a={};for(let l in n){let c=(s=t[l])==null?void 0:s.calcId;c&&(a[c]=n[l])}return a}buildAssignmentMap(){let e={};for(let t in this._defs){let i=this._defs[t];i&&(e[i.assignment]=i)}return e}getDepthValues(){var c,p;var e={},t={};let i=this.buildAssignmentMap();for(let u in i){let m=i[u];if(!m)continue;let h=__dcg_shared_module_exports__['jb'](m.assignment),x=[],C=[];(c=m.data.call)!=null&&c.parents?C=(p=m.data.call)==null?void 0:p.parents:m.data.assignmentRhsReference&&(C=[m.data.assignmentRhsReference]),C.forEach(D=>{let k=D&&D[0];k&&(x.push(k),t[k]||(t[k]=[]),t[k].push(__dcg_shared_module_exports__['jb'](h)))}),e[h]=x}let o=u=>{if(n[u]!==void 0)return n[u];var m=-1,h=e[u]||[];for(let C=0;C<h.length;C++){let D=o(h[C]);D>m&&(m=D)}let x=m+1;return n[u]=x,x};var n={};for(var a in e)n[a]=o(a);var s={},l={};for(var a in t){let m=n[a],h=1/0;t[a].forEach(x=>{let C=n[x];C>m&&(m=C),C<h&&(h=C)}),s[a]=m,l[a]=h}return{createdDepth:n,lastReferencedDepth:s,firstReferencedDepth:l}}};function pK(r,e,t){let o=.5/(2*t*e);return Ei(r-o,r+o)}function Hw(r,e,t,i,o=0){let n=__dcg_shared_module_exports__['Wa'](r.x,r.y,0,t[0],t[1],0,i[0],i[1],0);o&&(n+=o);let s=.5/(__dcg_shared_module_exports__['Cb'](t,i)*e);return Ei(n-s,n+s)}function Xc(r,e){for(let t of e)t&&(t.min!==void 0&&r<t.min?r=t.min:t.max!==void 0&&r>t.max&&(r=t.max));return r}function u0(r,e,t,i){if(!t)return 0;var o=r.mapx(1)-r.mapx(0);switch(t.valueType){case __dcg_shared_module_exports__['pa']:{let a=e.x-t.value[0][0],s=e.y-t.value[0][1],l=Math.atan2(s,a)/(2*Math.PI);l<0&&(l+=1),l=pK(l,o,t.value[1]);let c=Xc(0,[i]),p=Xc(1,[i]);if(l>=c&&l<=p)return l;{let u=__dcg_shared_module_exports__['Ib'](t.value,c),m=__dcg_shared_module_exports__['Ib'](t.value,p),h=__dcg_shared_module_exports__['Cb'](u,[e.x,e.y]),x=__dcg_shared_module_exports__['Cb'](m,[e.x,e.y]);return h<=x?c:p}}case __dcg_shared_module_exports__['ra']:{let a=__dcg_shared_module_exports__['Lb'](t.value);if(!a)return 0;if(a.type==="segment"){let s=Hw(e,o,a.start,a.end);return Xc(s,[{min:0,max:1},i])}else if(a.type==="rays"){let s=__dcg_shared_module_exports__['Cb'](a.start1,[e.x,e.y]),l=__dcg_shared_module_exports__['Cb'](a.start2,[e.x,e.y]),c=!i||i.min===void 0?-1/0:i.min,p=!i||i.max===void 0?1/0:i.max;return s<l?c>0?p>=1?1:c:Xc(-Hw(e,o,a.start1,a.end1),[{min:void 0,max:0},i]):p<1?c<=0?0:p:Xc(Hw(e,o,a.start2,a.end2,1),[{min:1,max:void 0},i])}else if(a.type=="arc"){let[s,l]=a.center,{radius:c,startAngle:p}=a,u=__dcg_shared_module_exports__['Eb'](t.value),m=e.x-s,h=e.y-l,x=__dcg_shared_module_exports__['Ra'](Math.atan2(h,m),p,u);if(x>=0&&x<=1)x=pK(x,o,c);else{let k=lE(e,{x:s+c*Math.cos(p),y:l+c*Math.sin(p)}),M=lE(e,{x:s+c*Math.cos(p+u),y:l+c*Math.sin(p+u)});k<=M?x=0:x=1}let C=Xc(0,[i]),D=Xc(1,[i]);if(x>=C&&x<=D)return x;{let k=__dcg_shared_module_exports__['Jb'](t.value,C),M=__dcg_shared_module_exports__['Jb'](t.value,D),I=__dcg_shared_module_exports__['Cb'](k,[e.x,e.y]),S=__dcg_shared_module_exports__['Cb'](M,[e.x,e.y]);return I<=S?C:D}}return Xc(0,[i])}case __dcg_shared_module_exports__['va']:case __dcg_shared_module_exports__['na']:case __dcg_shared_module_exports__['ta']:{let a=Hw(e,o,t.value[0],t.value[1]);return Xc(a,[{min:t.valueType===__dcg_shared_module_exports__['ta']?void 0:0,max:t.valueType!==__dcg_shared_module_exports__['na']?void 0:1},i])}case __dcg_shared_module_exports__['la']:{let a=t.value,s=1/0,l=Xc(0,[i]),c=i&&i.min!==void 0?i.min:-1/0,p=i&&i.max!==void 0?i.max:1/0,u=Math.floor(Math.max(c,0)),m=Math.ceil(Math.min(p,a.length));for(let h=u;h<m;h++){let x=a[h],C=a[(h+1)%a.length],D=Xc(Hw(e,o,x,C,h),[{min:h,max:h+1},i]),k=__dcg_shared_module_exports__['Kb'](t.value,D),M=__dcg_shared_module_exports__['Cb'](k,[e.x,e.y]);M<s&&(s=M,l=D)}return l}case __dcg_shared_module_exports__['da']:case __dcg_shared_module_exports__['xa']:case __dcg_shared_module_exports__['za']:case __dcg_shared_module_exports__['Ba']:case __dcg_shared_module_exports__['Da']:return 0;default:return t}}function uK(r,e){switch(r.valueType){case __dcg_shared_module_exports__['pa']:return __dcg_shared_module_exports__['Ib'](r.value,e);case __dcg_shared_module_exports__['ra']:return __dcg_shared_module_exports__['Jb'](r.value,e);case __dcg_shared_module_exports__['va']:return __dcg_shared_module_exports__['Hb'](r.value,e);case __dcg_shared_module_exports__['na']:return __dcg_shared_module_exports__['Gb'](r.value,e);case __dcg_shared_module_exports__['ta']:return __dcg_shared_module_exports__['Fb'](r.value,e);case __dcg_shared_module_exports__['la']:return __dcg_shared_module_exports__['Kb'](r.value,e);case __dcg_shared_module_exports__['da']:case __dcg_shared_module_exports__['xa']:case __dcg_shared_module_exports__['za']:case __dcg_shared_module_exports__['Ba']:case __dcg_shared_module_exports__['Da']:return[NaN,NaN];default:return r}}function EQ(r,e){if(!e)return!1;let{left:t,right:i,top:o,bottom:n}=r.pixelCoordinates,{x:a,y:s}=e.mathPoint;if(e.transform){let l=e.model.formula.typed_constant_value;if((l==null?void 0:l.valueType)!==__dcg_shared_module_exports__['da'])throw new Error(`Expected movable point to be a Point but found ${l?__dcg_shared_module_exports__['Ia'](l.valueType):void 0} instead`);a=a!=null?a:l.value[0],s=s!=null?s:l.value[1],[a,s]=__dcg_shared_module_exports__['Yb'](e.transform.forward,[a,s])}if(a!==void 0){let l=r.mathToPixels.mapX(a);if(l<t-.5||l>i+.5)return!1}if(s!==void 0){let l=r.mathToPixels.mapY(s);if(l<o-.5||l>n+.5)return!1}return!0}function hK(r,e){if(e.length===1&&!EQ(r,e[0]))return!1;let t=!1;for(let i of e){if(i.newPointLatex){let o=i.model.latex;Cs(i.model,i.newPointLatex),t=t||o!==i.model.latex}for(let o in i.sliderUpdates){let{value:n,model:a}=i.sliderUpdates[o];i.commitSliderSoftLimits&&gf(a);let s=a.latex;pS(a,n),t=t||s!==a.latex}}return t}function gK({projection:r,transform:e,controller:t,strategy:i,mode:o,clampToViewport:n}){var S;let a=t.getItemModel(i.id);if(!a||a.type!=="expression")throw new Error(`Programming error: updateSliderNonlinear move strategy should point to an expression item, but found ${a==null?void 0:a.type}`);let s=o==="up"||o==="bigup",l=((S=a.slider)==null?void 0:S.step)!==""&&(s&&!a.slider.hardMax||!s&&!a.slider.hardMin);i.compiled.fn||__dcg_shared_module_exports__['$b'](i.compiled);let c=i.compiled.fn;e&&(c=V=>__dcg_shared_module_exports__['Yb'](e.forward,i.compiled.fn(V)));let p=V=>{let[P,L]=c(V);return{x:P,y:L}=r.mathToPixels.mapPoint({x:P,y:L}),[P,L]},u=ws(a),[m,h]=p(u),x=D1(a,o,{ignoreSoftLimits:l}),C=x,[D,k]=p(C),M=__dcg_shared_module_exports__['Ua'](D-m,k-h);if(M<1){let V=__dcg_shared_module_exports__['wb'](p,[m+(D-m)/M,h+(k-h)/M],C,C>u?C:i.min,C<u?C:i.max,1);if(V){let P=Ei(V[0],V[1]);(o==="bigup"||o==="bigdown")&&(P=u+(P-u)*5);let L=Xl(a,__dcg_shared_module_exports__['vb'](P,i.min,i.max),{ignoreSoftLimits:l}),[B,R]=p(L);__dcg_shared_module_exports__['Ua'](B-m,R-h)>M&&(x=L)}}n&&(x=fK(r,ws(a),x,c));let I=c(x);return{mathPoint:{x:I[0],y:I[1]},sliderUpdates:{[i.id]:{model:a,value:x}}}}function mK({controller:r,projection:e,transform:t,strategy:i,targetScreenPoint:o,clampToViewport:n}){let a={mathPoint:{},sliderUpdates:{}},s=r.getItemModel(i.id);if(!s||s.type!=="expression")throw new Error(`Programming error: updateSliderNonlinear move strategy should point to an expression item, but found ${s==null?void 0:s.type}`);i.compiled.fn||__dcg_shared_module_exports__['$b'](i.compiled);let l=i.compiled.fn;t&&(l=I=>__dcg_shared_module_exports__['Yb'](t.forward,i.compiled.fn(I)));let c=I=>{let[S,V]=l(I);return{x:S,y:V}=e.mathToPixels.mapPoint({x:S,y:V}),[S,V]},p=i.initialValue,u=i.min,m=i.max,h=[o.x,o.y],x=__dcg_shared_module_exports__['wb'](c,h,p,u,m,1);if(!x)return a;let C=Ei(x[0],x[1]);u!==void 0&&C<u&&(C=u),m!==void 0&&C>m&&(C=m);let D=Xl(s,C,{ignoreSoftLimits:!0});n&&(D=fK(e,ws(s),D,l));let[k,M]=l(D);return a.mathPoint.x=k,a.mathPoint.y=M,a.sliderUpdates[s.id]={value:D,model:s},a}function WA({controller:r,projection:e,transform:t,strategy:i,targetScreenPoint:o}){let n=e.reverse_map_pt(o);if(t){let p=__dcg_shared_module_exports__['Yb'](t.inverse,[n.x,n.y]);n={x:p[0],y:p[1]}}let a=i.type==="updateSliderForGlider"?{min:i.min,max:i.max}:void 0,s=u0(e,n,i.movesOn,a);if(!isFinite(s))return;let l=uK(i.movesOn,s),c={mathPoint:{x:l[0],y:l[1]},newPointLatex:void 0,sliderUpdates:{}};if(i.type==="updateGliderParameter"){let p=i.span;c.newPointLatex=p.input.slice(0,p.start)+__dcg_shared_module_exports__['sc'](s)+p.input.slice(p.end)}else if(i.type==="updateSliderForGlider"){let p=r.getItemModel(i.id);p&&p.type==="expression"&&(c.sliderUpdates[p.id]={value:s,model:p})}return c}function fK(r,e,t,i){let o=p=>{let[u,m]=i(p);return r.mathToPixels.mapPoint({x:u,y:m})},n=({x:p,y:u})=>{let{left:m,right:h,top:x,bottom:C}=r.pixelCoordinates;return p>=m&&p<=h&&u>=x&&u<=C},a=e,s=o(e),l=t,c=o(t);if(n(c)||!n(s))return t;for(;;){let p=s.x-c.x,u=s.y-c.y;if(p*p+u*u<.5)break;let m=__dcg_shared_module_exports__['ub'](a,l);if(m===a||m===l){[a,l]=n(s)?[a,a]:[l,l];break}let h=o(m);n(h)!==n(s)?[l,c]=[m,h]:[a,s]=[m,h]}return Ei(a,l)}function $A({controller:r,projection:e,transform:t,formula:i,moveStrategy:o,dragMode:n,targetScreenPoint:a,clampToViewport:s}){if(t){let{x:h,y:x}=e.pixelsToMath.mapPoint(a),[C,D]=__dcg_shared_module_exports__['Yb'](t.inverse,[h,x]);a=e.mathToPixels.mapPoint({x:C,y:D})}var l=e.pixelsToMath.mapRect({left:a.x-.5,right:a.x+.5,top:a.y+.5,bottom:a.y-.5}),c=[{min:l.left,max:l.right},{min:l.top,max:l.bottom}];let p={mathPoint:{},sliderUpdates:{}},[u,m]=o;if(u.type==="updateCoordinate"||m.type==="updateCoordinate"){let h=GQ(i,c,n);if(h){let{latex:x,x:C,y:D}=h;(C!==void 0||D!==void 0)&&(p.newPointLatex=x,p.mathPoint.x=C!=null?C:p.mathPoint.x,p.mathPoint.y=D!=null?D:p.mathPoint.y)}}for(let h of[0,1]){let x=o[h];if(HA(h,n)&&x.type==="updateSlider"){let C=r.getItemModel(x.id);if(!C||C.type!=="expression")continue;let[D,k]=x.coefficients,M=Ei(k*c[h].min+D,k*c[h].max+D),I=Xl(C,M,{ignoreSoftLimits:!0}),S=(I-D)/k;if(!s||t){p.mathPoint[h===0?"x":"y"]=S,p.sliderUpdates[C.id]={value:I,model:C};continue}let[V,P]=h===0?[e.mathCoordinates.left,e.mathCoordinates.right]:[e.mathCoordinates.bottom,e.mathCoordinates.top],L=S<V?V:S>P?P:void 0;L!==void 0&&Ql(C)===void 0?(p.mathPoint[h===0?"x":"y"]=L,p.sliderUpdates[C.id]={value:k*L+D,model:C}):(p.mathPoint[h===0?"x":"y"]=S,p.sliderUpdates[C.id]={value:I,model:C})}}return p}function GQ(r,e,t){if(!r.move_strategy)throw new Error("Programming error: expected move_strategy to be defined.");var i=Ei(e[0].min,e[0].max),o=Ei(e[1].min,e[1].max);let[n,a]=r.move_strategy,s=!1,l=!1,c,p="",u=0;if(n.type==="updateCoordinate"&&HA(0,t)&&(c=n.inputSpan.input,s=!0,p+=c.slice(u,n.inputSpan.start),p+=__dcg_shared_module_exports__['sc'](i),u=n.inputSpan.end),a.type==="updateCoordinate"&&HA(1,t)&&(c=a.inputSpan.input,l=!0,p+=c.slice(u,a.inputSpan.start),p+=__dcg_shared_module_exports__['sc'](o),u=a.inputSpan.end),c!==void 0)return p+=c.slice(u),{latex:p,x:s?i:void 0,y:l?o:void 0}}function HA(r,e){switch(e){case"X":return r===0;case"Y":return r===1;case"XY":return!0;default:return!1}}function bK(r,e,t){t.forEach(i=>{TQ(r,e,i)})}function yK(r,e,t,i,o,n,a){var p;let s=!1,l=e.length===1,c=[];for(let u=0;u<e.length;u++){let m=e[u];if(m.tableInfo){VQ(r,m,i[u],o),s=!0;continue}let h=r.getItemModel(m.calcId);if(h){if(h.type==="image")s=s||LQ(r,h,m,i[u],o);else if(h.type==="expression"){let x=OQ({controller:r,movedExpr:h,dragMode:(p=Gi(h,{isReverseDrag:m.isReverseDrag}))!=null?p:"NONE",currentScreenPoint:t[u],targetScreenPoint:i[u],projection:o,transform:n&&n[u],isOnlyPoint:l,keyboardDirection:a});x&&c.push(x)}}}return s=s||hK(o,c),s}function xK(r,e){e.forEach(t=>{IQ(r,t)})}function TQ(r,e,t){if(t.tableInfo){Zr(e,void 0);let s=r.getItemModel(t.tableInfo.tableId);if(!s||s.type!=="table")return;gM(s,!0)}else{let s=r.getItemModel(t.calcId);if(!s||!(s.type==="expression"||s.type==="image")||!s.formula||!s.formula.move_strategy)return;for(var i=s.formula.move_strategy,o=0;o<i.length;o++){let l=i[o];if(i[o].type==="updateCoordinate"||i[o].type==="updateGliderParameter")s.type==="image"?X1(s,!0):s.type==="expression"&&E1(s,!0);else if(l.type==="updateSlider"||l.type==="updateSliderNonlinear"||l.type==="updateSliderForGlider"){var n=r.getItemModel(l.id);if(!n||n.type!=="expression")continue;var a;if(s.type==="expression"?a=Gi(s,{isReverseDrag:t.isReverseDrag}):a=void 0,a==="NONE"||o===0&&a==="Y"||o===1&&a==="X")continue;fx(n,!0)}}}}function IQ(r,e){for(let t of r.getAllItemModels())t.type==="table"?t.draggingOnGraphpaper&&gM(t,!1):t.type==="expression"?(t.sliderDragging&&fx(t,!1),t.draggingOnGraphpaper&&E1(t,!1)):t.type==="image"&&t.draggingOnGraphpaper&&X1(t,!1)}function VQ(r,e,t,i){var o=e.tableInfo.tableId,n=e.tableInfo.rowIndex,a=e.tableInfo.columnId,s=e.tableInfo.dragX,l=e.tableInfo.dragY,c=r.getItemModel(o);if(!(!c||c.type!=="table")){var p=la(c,a);if(p){var u=i.closestPointOnScreen(t),m=i.pixelsToMath.mapRect(wK(u,.5)),h={x:__dcg_shared_module_exports__['rc'](Ei(m.left,m.right)),y:__dcg_shared_module_exports__['rc'](Ei(m.top,m.bottom))};if(s&&qp(c,{row:n+1,column:0},h.x),l){let x=p.index;qp(c,{row:n+1,column:x},h.y)}}}}function wK(r,e){return{left:r.x-e,right:r.x+e,top:r.y+e,bottom:r.y-e}}function MQ(r,e,t){if(t[0]===0&&t[1]===0)return{x:e.x,y:e.y,width:r.width,height:r.height};let i=Math.cos(r.radianAngle),o=Math.sin(r.radianAngle),n=e.x-r.x,a=e.y-r.y;if(t[0]===0)return{x:r.x,y:r.y,width:r.width,height:2*t[1]*(i*a+o*n)};if(t[1]===0)return{x:r.x,y:r.y,width:2*t[0]*(i*n-o*a),height:r.height};var s=2*(r.width*t[0]*(i*n-o*a)+r.height*t[1]*(o*n+i*a))/(r.width*r.width+r.height*r.height);return{x:r.x,y:r.y,width:s*r.width,height:s*r.height}}function AQ(r,e,t){let i=[{x:e.left,y:e.bottom},{x:e.left,y:e.top},{x:e.right,y:e.top},{x:e.right,y:e.bottom}],o=["x","y","width","height"],n={x:1/0,y:1/0,width:1/0,height:1/0},a={x:-1/0,y:-1/0,width:-1/0,height:-1/0};for(let s of i){let l=MQ(r,s,t);for(let c of o)n[c]=Math.min(n[c],l[c]),a[c]=Math.max(a[c],l[c])}return{min:n,max:a}}function Ww(r){return r===void 0?NaN:r[0]}function LQ(r,e,t,i,o){var j;var n=e.formula;if(!n||((j=n.move_strategy)==null?void 0:j.length)!==4)return!1;var a=n.dimensions,s={x:Ww(a.x),y:Ww(a.y),width:Ww(a.width),height:Ww(a.height),radianAngle:Ww(a.radianAngle)},l=t.scaleFactor||[0,0],c=l[0]!==0&&l[1]!==0,p=o.closestPointOnScreen(i),u=o.pixelsToMath.mapRect(wK(p,c?.05:.5)),m=AQ(s,u,l),h=o.mathToPixels.mapRect({left:s.x-.5*s.width,right:s.x+.5*s.width,top:s.y-.5*s.height,bottom:s.y+.5*s.height}),x=Math.abs(h.right-h.left),C=Math.abs(h.bottom-h.top),D=o.mathToPixels.mapRect({left:m.min.x-.5*m.min.width,right:m.min.x+.5*m.min.width,top:m.min.y-.5*m.min.height,bottom:m.min.y+.5*m.min.height}),k=Math.abs(D.right-D.left),M=Math.abs(D.bottom-D.top);if(k<x&&k<1||M<C&&M<1)return!1;var I=["width","height","x","y"];let S=!1;for(var V=0;V<I.length;V++){var P=I[V],L=n.move_strategy[V];switch(L.type){case"updateCoordinate":var B=Ei(m.min[P],m.max[P]),R=L.inputSpan.input,W=__dcg_shared_module_exports__['rc'](B);switch(P){case"width":case"height":$s(e,P,W);break;case"x":if(n.move_strategy[3].type==="updateCoordinate"){let te=n.move_strategy[3],pe=Ei(m.min.y,m.max.y),he=__dcg_shared_module_exports__['rc'](pe),ae=R.slice(0,L.inputSpan.start)+W+R.slice(L.inputSpan.end,te.inputSpan.start)+he+R.slice(te.inputSpan.end);$s(e,"center",ae)}else{let te=R.slice(0,L.inputSpan.start)+W+R.slice(L.inputSpan.end);$s(e,"center",te)}break;case"y":if(n.move_strategy[2].type!=="updateCoordinate"){let te=R.slice(0,L.inputSpan.start)+W+R.slice(L.inputSpan.end);$s(e,"center",te)}break;default:return P}S=!0;break;case"updateSlider":var re=r.getItemModel(L.id);if(!re||re.type!=="expression")continue;var ne=L.coefficients[0],X=L.coefficients[1],b=X*m.min[P]+ne,A=X*m.max[P]+ne,E=Ei(b,A),J=re.latex;pS(re,E),re.latex!==J&&(S=!0);break}}return S}function OQ({controller:r,movedExpr:e,dragMode:t,currentScreenPoint:i,targetScreenPoint:o,projection:n,transform:a,isOnlyPoint:s,keyboardDirection:l}){var x,C;let c=e.formula;if(!c||((x=c.move_strategy)==null?void 0:x.length)!==2)return;let[p,u]=c.move_strategy;if(s&&p.type==="updateCoordinate"&&u.type==="updateCoordinate"){let D=n.reverse_map_pt(o),k=jA(n,D);k&&(o=n.map_pt(k))}let m=s?n.closestPointOnScreen(o):o;if(!l){let D;switch(p.type){case"updateSliderNonlinear":D=mK({controller:r,projection:n,transform:a,strategy:p,targetScreenPoint:m,clampToViewport:s});break;case"updateGliderParameter":case"updateSliderForGlider":D=WA({controller:r,projection:n,transform:a,strategy:p,targetScreenPoint:m});break;default:D=$A({controller:r,projection:n,transform:a,formula:c,moveStrategy:c.move_strategy,dragMode:t,targetScreenPoint:m,clampToViewport:s})}return D&&__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},D),{commitSliderSoftLimits:!1,transform:a,model:e})}let h;if(p.type==="updateSliderNonlinear"){if(!(l!=null&&l.x))return;h=gK({projection:n,transform:a,controller:r,strategy:p,mode:l.x,clampToViewport:s})}else if(p.type==="updateGliderParameter"||p.type==="updateSliderForGlider")h=WA({controller:r,projection:n,transform:a,strategy:p,targetScreenPoint:m});else{let D=l.x?0:1,k=l.x?m.x-i.x:m.y-i.y,M=c.move_strategy[D];if(M.type==="updateSlider"){let I=r.getItemModel(M.id);if((I==null?void 0:I.type)!=="expression")throw new Error(`Programming error: updateSlider move strategy should point to an expression item, but found ${I==null?void 0:I.type}`);let S=Ql(I);if(S){let V=n.mathToPixels.mapPoint({x:0,y:0}),P=M.coefficients[1],L=Math.abs(D===0?n.mathToPixels.mapX(S/P)-V.x:n.mathToPixels.mapY(S/P)-V.y),B=Math.ceil(1/L);k=L*B*(k>0?1:-1);let R=(C=l.x)!=null?C:l.y;(R==="bigup"||R==="bigdown")&&(k*=5)}}h=$A({controller:r,projection:n,transform:a,formula:c,moveStrategy:c.move_strategy,dragMode:t,targetScreenPoint:{x:i.x+(D===0?k:0),y:i.y+(D===1?k:0)},clampToViewport:s})}return h&&__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},h),{commitSliderSoftLimits:!0,transform:a,model:e})}function jA(r,e){if(!r.settings.showGrid)return;let t=rh(r),i=t.minorStepX,o=t.minorStepY,n=r.map_pt(e),a=Math.round(e.x/i)*i,s=Math.round(e.y/o)*o,l=5,c={x:a,y:s},p=r.map_pt(c);if(__dcg_shared_module_exports__['Ua'](p.x-n.x,p.y-n.y)<=l)return c}function DK(r,e){let t={i:0,x:NaN,y:NaN},i={i:1,x:NaN,y:NaN};if(!r||!e)return[t,i];let o=vK(r.typedRuntimeValue),n=vK(e.typedRuntimeValue);if(!o||!n)return[t,i];let a=CK(o,n);return t.x=a[0],t.y=a[1],a=CK(n,o),i.x=a[0],i.y=a[1],[t,i]}function vK(r){switch(r.valueType){case __dcg_shared_module_exports__['na']:case __dcg_shared_module_exports__['ta']:case __dcg_shared_module_exports__['va']:return{type:"straight",def:r.value};case __dcg_shared_module_exports__['Da']:return{type:"straight",def:Wp(r.value)};case __dcg_shared_module_exports__['pa']:return{type:"circle",def:r.value};case __dcg_shared_module_exports__['ra']:return{type:"arc",def:r.value}}}function CK(r,e){switch(r.type){case"straight":switch(e.type){case"straight":return __dcg_shared_module_exports__['Pb'](r.def,e.def);case"circle":return __dcg_shared_module_exports__['Nb'](r.def,e.def);case"arc":return __dcg_shared_module_exports__['Rb'](r.def,e.def)}case"circle":switch(e.type){case"straight":return __dcg_shared_module_exports__['Ob'](r.def,e.def);case"circle":return __dcg_shared_module_exports__['Mb'](r.def,e.def);case"arc":return __dcg_shared_module_exports__['Qb'](r.def,e.def)}case"arc":switch(e.type){case"straight":return __dcg_shared_module_exports__['Tb'](r.def,e.def);case"circle":return __dcg_shared_module_exports__['Sb'](r.def,e.def);case"arc":return __dcg_shared_module_exports__['Ub'](r.def,e.def)}}return[NaN,NaN]}var SK=[{key:"compass",objects:"Segment + Point"},{key:"midpoint",objects:"Segment"},{key:"parallel",objects:"Line + Point"},{key:"perpendicular",objects:"Line + Point"},{key:"image",objects:"2 Points"}];function Qc(r){return __dcg_shared_module_exports__['O'](r)}function Zc(r){this.setState(r)}Zc.prototype.setState=function(r){this.state=r};Zc.prototype.getState=function(){return this.state};Zc.prototype.set=function(r,e){if(arguments.length===1){this.state=r;return}else if(typeof r=="string"){this.state=Qc(this.state),this.state[r]=e;return}var t=r.length-2,i=r[t+1],o;this.state=o=Qc(this.state);for(var n=0;n<=t;n++){var a=r[n];o=o[a]=Qc(o[a])}o[i]=e};Zc.prototype.deepMutate=function(r,e){if(arguments.length===1){e=r,this.state=__dcg_shared_module_exports__['j'](this.state),e(this.state);return}else if(typeof r=="string"){this.state=Qc(this.state),this.state[r]=__dcg_shared_module_exports__['j'](this.state[r]),e(this.state[r]);return}for(var t=r.length-2,i=r[t+1],o=this.state=Qc(this.state),n=0;n<=t;n++){var a=r[n];o=o[a]=Qc(o[a])}o=o[i]=__dcg_shared_module_exports__['j'](o[i]),e(o)};Zc.prototype.shallowMutate=function(r,e){if(arguments.length===1){e=r,this.state=Qc(this.state),e(this.state);return}else if(typeof r=="string"){this.state=Qc(this.state),this.state[r]=Qc(this.state[r]),e(this.state[r]);return}for(var t=r.length-1,i=this.state=Qc(this.state),o=0;o<=t;o++){var n=r[o];i=i[n]=Qc(i[n])}e(i)};Zc.areShallowEqual=function(r,e){};Zc.areDeepEqual=function(r,e){};function Fg(r){return r?!!(PQ(r)&&r!=="Vector"||r==="Circle"||r==="Arc"||r==="Polygon"):!1}function PQ(r){if(!r)return!1;switch(r){case"Line":case"Ray":case"Vector":case"Segment":return!0}return!1}yl();var _Q=!0,FQ=!1,EK="**dcg_geo_tool_output_slider**";function RQ(){return{point:__dcg_shared_module_exports__['o'].PURPLE,line:__dcg_shared_module_exports__['o'].BLUE,circle:__dcg_shared_module_exports__['o'].GREEN,polygon:__dcg_shared_module_exports__['o'].BLUE,angle:__dcg_shared_module_exports__['o'].BLACK}}function NQ(r,e){let t=[],i=r.parents;for(let o=0;o<i.length;o++){let n=i[o];n.type==="hardcoded"?t[o]=n.id:t[o]=e[n.id]}return t}var $w=class{constructor(e){this._nextObjectId=0;this.clear(),this.controller=e,this.s=this.controller.s,this._tools={};for(let t in zA)this._tools[t]=new zA[t](this)}onPreviewChange(){var a;var e=this.controller.getToolPreviewJSONState(),t=this.getUncommittedObjects();if(this.getCurrentTool()instanceof yh&&!this.controller.getValidCursorContext()){t=__dcg_shared_module_exports__['a']({},t);for(let s in e){let l=e[s];l.type==="expression-edit-preview-latex"&&(t[s]=l)}}for(var o in t){var n=t[o];n.type==="polygon"&&this.isObjectHovered(n.parents[0])&&n.parents.push(n.parents[0])}__dcg_shared_module_exports__['P'](e,t)?this.controller.dispatch({type:"render"}):this.controller.dispatch({type:"set-tool-preview-state",state:t}),(a=this.controller.get2dPOIController())==null||a.updateGeoHoveredObjects()}peekNextObjectId(){return"\\token{"+this._nextObjectId.toString()+"}"}generateObjectId(){let e=this.peekNextObjectId();return this._nextObjectId+=1,e}updateNextObjectId(e){e>this._nextObjectId&&(this._nextObjectId=e)}clear(){let e={objects:{},ui:{currentTool:{name:"selection",idMap:{},reusableInputIdMap:{},lockedIds:{},inputIndex:0,outputHistory:{}},colors:RQ()},hoveredObjects:[],uncommittedIds:{},selectedIds:{},nextSelectionNumber:1,fadeAnimations:{},maxAnimationEndTime:0};this.store?this.store.set(e):this.store=new Zc(e)}onFocus(e){this.clearHoveredObjects(),this.getCurrentTool().onFocus(e),this.onPreviewChange()}onMouseAction(e,t){e==="release"&&this.controller.clearRecentlyUsedComplexTool();let i=this.getCurrentTool();if(i instanceof yh&&!this.controller.getValidCursorContext())return{committed:void 0,handled:!1};switch(this.updateNextObjectId(this.controller.findLastTokenNumber()+1),this.clearHoveredObjects(),e){case"move":return{committed:void 0,handled:i.onMove(t)};case"release":i.onMove(t);let o=i.tryCommitResults();return o.committed?__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},o),{handled:!0}):{committed:void 0,handled:!1}}}getNonObjectsState(){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.store.getState()),{objects:void 0})}getCurrentTool(){return this.getTool(this.getToolMode())}getTool(e){return this._tools[e]}defaultColorForObject(e,t){switch(t.type){case"point":case"point-reference":case"midpoint":case"glider":case"intersection":case"vector-endpoint":return e.colors.point;case"line":case"segment":case"polygon-segment":case"ray":case"vector":case"vector-copy":case"perpendicular":case"parallel":return e.colors.line;case"circle":case"compass":case"arc":return e.colors.circle;case"polygon":return e.colors.polygon;case"angle":case"angles":case"directedangle":case"directedangles":return e.colors.angle;case"dilate":case"reflect":case"rotate":case"translate":return __dcg_shared_module_exports__['o'].GRAY;case"slider":return __dcg_shared_module_exports__['o'].BLACK;case"expression-edit-preview-latex":return t.color||__dcg_shared_module_exports__['o'].BLACK;default:return t}}_deselectAll(){this.store.shallowMutate(e=>{e.nextSelectionNumber=1,e.selectedIds={}})}_modifySelection(e){let t=this.getNonObjectsState().nextSelectionNumber;this.store.shallowMutate("selectedIds",i=>{for(let o in e)e[o]?i[o]||(i[o]=t,t+=1):delete i[o]}),this.store.set("nextSelectionNumber",t)}_addObjects(e){this.store.shallowMutate("objects",t=>{for(let i of e)t[i.id]=i})}_deleteObjects(e){if(!e.length)return;let t={};this.store.shallowMutate("objects",i=>{for(let o of e)t[o]=FQ,delete i[o]}),this._modifySelection(t),this.store.shallowMutate("uncommittedIds",i=>{for(let o of e)delete i[o]})}createCustomToolOutput(e){var n;this.generateIdsForNewToolOutputs(e);let{idMap:t}=this.getNonObjectsState().ui.currentTool,i=[],o=this.getNonObjectsState().ui;for(let a of e.outputs){let s=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},a),{id:t[a.id],color:this.defaultColorForObject(o,a),parents:NQ(a,t)});i.push(s)}for(let a of e.inputs)if((n=a.numberInputInfo)!=null&&n.sliderInfo){let s=a.numberInputInfo.sliderInfo,l=t[`${a.id}-number`];if(ys(l)){let c=U_(l);if(c&&c in __dcg_shared_module_exports__['mb'])continue;this.controller.getItemsByIdentifier(__dcg_shared_module_exports__['jb'](l)).length||i.push({type:"slider",latex:l+"="+s.value,sliderInfo:s,id:EK,parents:[],hidden:!1,color:"#000"})}}this._shouldNewObjectsBeMarkedUncommitted()&&this.store.shallowMutate("uncommittedIds",a=>{for(let s of i)a[s.id]=!0}),this._addObjects(i)}_getReusableIdForCurrentInput(e){let t=this.getCurrentTool();if(!t.getSpec)return;let{inputIndex:i,reusableInputIdMap:o}=this.getNonObjectsState().ui.currentTool,a=t.getSpec().inputs[i];if(!a)return;let s=a.id;return e!==void 0&&(s+="-"+e),o[s]}_createInputObject(e,t){let i,o=this._shouldNewObjectsBeMarkedUncommitted();o?i=this._getReusableIdForCurrentInput(t)||this.generateObjectId():i=this.generateObjectId(),o&&this.store.set(["uncommittedIds",i],!0);let n=this.defaultColorForObject(this.getNonObjectsState().ui,e),a=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({hidden:e.type==="point"&&!!e.previewOnly},e),{id:i,color:n});return this._addObjects([a]),i}attemptLockToolInputIn(e){let{inputIndex:t,idMap:i}=this.getNonObjectsState().ui.currentTool,o=this.getCurrentTool();if(!(o instanceof jr))return;let n=o.getSpecIdToLockIn(e,t);if(!n)return;let a=i[n];if(!a){this.getCurrentTool().canNextInputBePoint()||this.controller.dispatch({type:"select-geo-tool",tool:"selection"});return}let s=a&&this.store.getState().objects[a];if(s&&s.type==="point"&&s.previewOnly){this.controller.dispatch({type:"select-geo-tool",tool:"selection"});return}this.store.set(["ui","currentTool","inputIndex"],t+1),this.store.set(["ui","currentTool","lockedIds",a],!0);for(var l=0;l<2;l++){let c=n+"-"+l,p=i[c];p&&this.store.set(["ui","currentTool","lockedIds",p],!0)}o.didLockInput(e),this.updateFadeAnimations()}generateIdsForNewToolOutputs(e){let{idMap:t}=this.getNonObjectsState().ui.currentTool,i=!1,o={};for(let n of e.outputs)t[n.id]||(i=!0,o[n.id]=this.generateObjectId());i&&this.store.set(["ui","currentTool","idMap"],__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},t),o))}tentativelyMatchToolInput(e,t){let{currentTool:i}=this.getNonObjectsState().ui,o=i.inputIndex,n=e.inputs[o];if(!n)return;let a=n.id;this.store.set(["ui","currentTool","idMap",a],t)}storeNumberInputLatex(e,t){let{currentTool:i}=this.getNonObjectsState().ui,o=i.inputIndex,n=e.inputs[o];if(!(n!=null&&n.numberInputInfo))return;let a=n.id;this.store.set(["ui","currentTool","idMap",`${a}-number`],t)}createToolInputDependency(e,t,i){let o=this._createInputObject(e,i),{currentTool:n}=this.getNonObjectsState().ui,a=n.inputIndex,s=t.inputs[a];if(!s)throw fn("geo tool could not find input in spec",{metaData:{fnArgs:{objectDef:e,toolSpec:t,depIndex:i},localVars:{newObjectId:o,currentTool:n,inputIndex:a,input:s},toolState:this.store.getState()}}),new Error("programming error: could not find input "+a+" in spec");let l=s.id;return this.store.set(["ui","currentTool","idMap",l+"-"+i],o),o}isObjectALockedToolInput(e){return!!this.getNonObjectsState().ui.currentTool.lockedIds[e]}isDegenerateInput(e){let t=this.getCurrentTool();return t instanceof jr?t.isDegenerateInput(e):!1}getEnabledAdditionalTools(){return SK.filter(e=>!0)}getAdditionalTools(){return this.getEnabledAdditionalTools()}isAnyAdditionalToolEnabled(){return this.getAdditionalTools().length>0}setObjectSelected(e){let t={};t[e]=_Q,this._modifySelection(t)}setObjectsSelected(e){__dcg_shared_module_exports__['r'](e,t=>{this.setObjectSelected(t)})}deleteSelectedObjects(){let e=this.getSelectedObjectIdsUnsorted();this._deleteObjects(e)}isObjectHovered(e){let t=this.getNonObjectsState().hoveredObjects;for(let i of t)if("calcId"in i&&i.calcId===e)return!0;return!1}isObjectUncommitted(e){return!!this.getNonObjectsState().uncommittedIds[e]}getUncommittedObjectIds(){return Object.keys(this.getNonObjectsState().uncommittedIds)}getUncommittedObjects(){let e={},t=this.store.getState().objects,i=this.getUncommittedObjectIds();for(let o of i)e[o]=t[o];return e}isValidNextInputType(e){let t=this.getCurrentTool(),i=t.getNonPointInputType();return e&&__dcg_shared_module_exports__['Ka'](e)&&(e=__dcg_shared_module_exports__['La'](e)),!!(i&&e&&Yk(e,i)||t.canNextInputBePoint()&&e&&Yk(e,"point"))}recordCommittedOutput(e){this.store.shallowMutate(["ui","currentTool","outputHistory"],t=>{t[e]=!0})}updateFadeAnimations(){let e=this.controller.getAllItemModels(),t=Date.now(),i=-1/0;this.store.shallowMutate(["fadeAnimations"],o=>{var s,l;if(this.getCurrentTool().shouldHighlightRelevantObjects())for(let c of e){if(c.type!=="expression"||!c.latex)continue;let p=c.id,u=(s=c.formula)==null?void 0:s.geometry,m,h=u==null?void 0:u.valueType;u!=null&&u.unconstructable?m="fade-out":this.isValidNextInputType(__dcg_shared_module_exports__['da'])&&(Fg(TE(h))||__dcg_shared_module_exports__['Ka'](h)&&Fg(TE(__dcg_shared_module_exports__['La'](h))))||h&&__dcg_shared_module_exports__['Pa'](h,__dcg_shared_module_exports__['la'])&&this.isValidNextInputType(__dcg_shared_module_exports__['na'])||this.isValidNextInputType(h)||this.store.getState().ui.currentTool.outputHistory[p]?m="fade-in":m="fade-out";let x=this.store.getState().fadeAnimations[p];if(x&&x.type!==m){let C=__dcg_shared_module_exports__['Ab'](t-x.start,0,150),D=t+C-150;o[p]={type:m,start:D},i=Math.max(i,D)}else if(m==="fade-out"){let C=(l=x==null?void 0:x.start)!=null?l:t;o[p]={type:"fade-out",start:C},i=Math.max(i,C)}}else{for(let c in o)o[c]={type:"fade-in",start:t-150};i=t-150}}),isFinite(i)&&this.store.set("maxAnimationEndTime",i+150)}getToolFadeOpacity(e){let t=this.controller.getItemModel(e);if((t==null?void 0:t.type)!=="expression")return 1;let i=this.store.getState().fadeAnimations[t.id];if(!i)return 1;let o=Date.now(),n=__dcg_shared_module_exports__['Ab']((o-i.start)/150,0,1),a=i.type==="fade-in"?.2:1,s=i.type==="fade-in"?1:.2;return a*(1-n)+s*n}isFading(){return Date.now()<=this.store.getState().maxAnimationEndTime}isObjectSelected(e){return!!this.getNonObjectsState().selectedIds[e]}getSelectedObjectIdsUnsorted(){return Object.keys(this.getNonObjectsState().selectedIds)}getSelectedObjectIdsSorted(){let e=this.getNonObjectsState().selectedIds,t=this.getSelectedObjectIdsUnsorted();return __dcg_shared_module_exports__['B'](t,o=>e[o])}deselectAllObjects(){this._deselectAll()}getToolMode(){return this.getNonObjectsState().ui.currentTool.name}setToolMode(e){let t=this.getToolMode();this.store.set(["ui","currentTool"],{name:e,idMap:{},reusableInputIdMap:{},lockedIds:{},inputIndex:0,outputHistory:e!==t?{}:this.store.getState().ui.currentTool.outputHistory}),this.updateFadeAnimations(),e!==t&&this.controller.isGraphPaperFocused()&&(At(this.getCurrentToolDisplayName()+"."),this.speakCurrentGeoToolHint())}resetToolMode(){this.setToolMode(this.getToolMode())}areAnyObjectsHovered(){return!!this.getNonObjectsState().hoveredObjects.length}setObjectHovered(e){this.store.deepMutate(t=>{t.hoveredObjects.push(e)})}objectIsInstanceOf(e,t){let i=e==null?void 0:e.typedRuntimeValue.valueType;if(i)return Yk(i,t)}getSelectionBox(){return this.getTool("selection").getSelectionBox()}commitObjects(){this.store.set("uncommittedIds",{}),this.store.set("objects",{})}applyTransformation(e){}getProjection(){return this.controller.get2dProjection()}_getPixelsAwayFromDef(e,t,i){let o=i.typedRuntimeValue;switch(o.valueType){case __dcg_shared_module_exports__['da']:{let a=t.mapx(o.value[0]),s=t.mapy(o.value[1]);return __dcg_shared_module_exports__['Ua'](e.x-a,e.y-s)-6}case __dcg_shared_module_exports__['ta']:case __dcg_shared_module_exports__['na']:case __dcg_shared_module_exports__['va']:case __dcg_shared_module_exports__['Da']:{let n,a,s,l;if(o.valueType===__dcg_shared_module_exports__['Da']){let[[m,h],[x,C]]=Wp(o.value);n=t.mapx(m),s=t.mapy(h),a=t.mapx(x),l=t.mapy(C)}else n=t.mapx(o.value[0][0]),s=t.mapy(o.value[0][1]),a=t.mapx(o.value[1][0]),l=t.mapy(o.value[1][1]);let c=o.valueType===__dcg_shared_module_exports__['ta'],p=o.valueType===__dcg_shared_module_exports__['ta']||o.valueType===__dcg_shared_module_exports__['va'],u=__dcg_shared_module_exports__['Ya'](e.x,e.y,n,s,a,l,c,p);return u?__dcg_shared_module_exports__['Ua'](u[0]-e.x,u[1]-e.y):1/0}case __dcg_shared_module_exports__['pa']:{let n=o.value[0][0],a=o.value[0][1],s=o.value[1],l=0,c=Math.PI*2,p=t.reverse_mapx(e.x),u=t.reverse_mapy(e.y),m=__dcg_shared_module_exports__['Za'](p,u,n,a,s,l,c);return m?t.screen.width/(t.viewport.xmax-t.viewport.xmin)*__dcg_shared_module_exports__['Ua'](m[0]-p,m[1]-u):1/0}case __dcg_shared_module_exports__['ra']:{let n=__dcg_shared_module_exports__['Lb'](o.value);if(!n)return 1/0;let a=(s,l,c,p)=>{let u=t.mapx(s[0]),m=t.mapy(s[1]),h=t.mapx(l[0]),x=t.mapy(l[1]),C=__dcg_shared_module_exports__['Ya'](e.x,e.y,u,m,h,x,c,p);return C?__dcg_shared_module_exports__['Ua'](C[0]-e.x,C[1]-e.y):1/0};if(n.type==="arc"){let s=t.reverse_mapx(e.x),l=t.reverse_mapy(e.y),c=__dcg_shared_module_exports__['Za'](s,l,n.center[0],n.center[1],n.radius,n.startAngle,n.endAngle);return c?t.screen.width/(t.viewport.xmax-t.viewport.xmin)*__dcg_shared_module_exports__['Ua'](c[0]-s,c[1]-l):1/0}else return n.type==="segment"?a(n.start,n.end,!1,!1):Math.min(a(n.start1,n.end1,!1,!0),a(n.start2,n.end2,!1,!0))}case __dcg_shared_module_exports__['la']:{let n=[];return o.value.forEach(a=>{n.push(t.mapx(a[0]),t.mapy(a[1]))}),__dcg_shared_module_exports__['xb'](n,[e.x,e.y])?0:1/0}case __dcg_shared_module_exports__['xa']:case __dcg_shared_module_exports__['za']:{let n=t.screen.width/(t.viewport.xmax-t.viewport.xmin),a=t.screen.height/(t.viewport.ymax-t.viewport.ymin),[[s,l],c,p]=o.value,u=th(p,t),m=u/n,h=t.reverse_mapx(e.x),x=t.reverse_mapy(e.y),C=1/0,D=x-l,k=h-s,M=Math.atan2(D,k);if(__dcg_shared_module_exports__['Sa'](M,c,p))__dcg_shared_module_exports__['Ua'](D*a,k*n)<=u+7&&(C=0);else{let I=__dcg_shared_module_exports__['Xa'](h,x,s+m*Math.cos(c),l+m*Math.sin(c),s,l),S=__dcg_shared_module_exports__['Xa'](h,x,s+m*Math.cos(c+p),l+m*Math.sin(c+p),s,l),V=__dcg_shared_module_exports__['Ua'](n*(I[0]-h),a*(I[1]-x)),P=__dcg_shared_module_exports__['Ua'](n*(S[0]-h),a*(S[1]-x));C=Math.min(V,P)}return C}case __dcg_shared_module_exports__['Ba']:return 1/0;default:return 1/0}}getAllChoosableDefsUnordered(e){var m;if(!this.controller.isGeometry())return[];let t=[],i=e.mode==="tab",o=e.mode==="mouse",n=i&&this.controller.getActiveTool()==="box-selection",a=!1,s=!1,l=this.getCurrentTool();(m=l.isValidNextInputType)!=null&&m.call(l,__dcg_shared_module_exports__['da'])&&(a=!0),l.shouldUseJitEdges()&&(l.isValidNextInputType(__dcg_shared_module_exports__['na'])||l.isValidNextInputType(__dcg_shared_module_exports__['ta'])||l.isValidNextInputType(__dcg_shared_module_exports__['va']))&&(s=!0);let c=o&&a;c&&(s=!0);let{lockedIds:p,reusableInputIdMap:u}=this.store.getState().ui.currentTool;return Tg({controller:this.controller},(h,x)=>{var D,k;if(!h.isGraphable)return;let C=h.assignment;for(let M in u)if(u[M]===C&&!p[C])return;if(!h.hidden&&!h.data.unconstructable&&!(this.getToolMode()==="expression-edit"&&((D=h.data)!=null&&D.depends_on_selected))&&!(n&&this.controller.isClickableId(h.calcId))&&!(i&&this.isDegenerateInput(h==null?void 0:h.assignment))&&!(i&&x)){if(h.typedRuntimeValue.valueType===__dcg_shared_module_exports__['la'])if(h.typedRuntimeValue.value.length){if(s){let M=h;if(M.typedRuntimeValue.valueType===__dcg_shared_module_exports__['la']){let I=M.typedRuntimeValue.value;for(let S=0;S<I.length;S++){let V=I[S],P=I[(S+1)%I.length],L=M.referenceLatex+".\\operatorname{segments}\\left["+(S+1)+"\\right]",B={calcId:M.calcId,listIndex:M.listIndex,hidden:M.hidden,assignment:L,referenceLatex:L,data:M.data,typedRuntimeValue:{valueType:__dcg_shared_module_exports__['na'],value:[V,P]},polygonEdgeInfo:{edgeNumber:S,polygonDef:M}};t.push(B)}}}}else return;if(c&&!__dcg_shared_module_exports__['Pa'](h.typedRuntimeValue.valueType,__dcg_shared_module_exports__['la'])){t.push(h);return}if((k=l.isValidNextInputType)!=null&&k.call(l,h.typedRuntimeValue.valueType)){t.push(h);return}}}),t}_getObjectsUnderMouse(e,t){let i=this.getAllChoosableDefsUnordered({mode:"mouse"}),o=this.getProjection(),n=[];i.forEach(l=>{let c=this._getPixelsAwayFromDef(e,o,l),p=l.polygonEdgeInfo?-1:0;if(c<=t){let u={def:l,layerNumber:p,pixelsAway:c};n.push(u)}});let a=this.controller.get2dSketchOrder(),s={};for(let l=0;l<a.length;l++)s[a[l]]=l;return n.sort((l,c)=>{let p=c.layerNumber-l.layerNumber;if(p!==0)return p;let u=l.pixelsAway-c.pixelsAway;if(u!==0)return u;let m=s[l.def.calcId];return s[c.def.calcId]-m}),n}convertCanvasPixelsToPoint(e){return this.getProjection().reverse_map_pt(e)}convertPointToCanvasPixels(e){return this.getProjection().map_pt(e)}deleteObjectsAndRememberReusableId(e){for(let t in e)this._deleteObjects([e[t]]);this._deleteObjects([EK]),this.store.shallowMutate(["ui","currentTool"],t=>t.reusableInputIdMap=e)}getObjectDefUnderMouse(e,t){let i=this.convertPointToCanvasPixels(e),o=this._getObjectsUnderMouse(i,t)[0];return o&&o.def}getOrCreatePointNearMouse(e,t){let i=this.convertPointToCanvasPixels(e),o=this._getObjectsUnderMouse(i,t),n=[];for(let m of o){let h=m.def,x=Tq(h);x==="Point"?n.push({def:h,type:x}):(Fg(x)||x==="Vector")&&n.push({def:h,type:x})}let{def:a,type:s}=n[0]||{},{def:l,type:c}=n[1]||{},p=this.controller.isGeoToolEnabled("point");if(s==="Point")return{type:"def",def:a};if(Fg(s)&&Fg(c)){let m=DK(a,l).map(h=>({x:h.x,y:h.y,i:h.i,pixelsFromPoint:GK(this.getProjection(),nh(h.x-e.x,h.y-e.y))}));if(m.sort((h,x)=>h.pixelsFromPoint-x.pixelsFromPoint),m=m.filter(h=>h.pixelsFromPoint<5),m[0]){let h=m[0].i===0?[a,l]:[l,a],x=this.findIncidentPointDef(a,l);if(x!=null&&x.hidden){let C=!1,D;if(ZM(x.typedRuntimeValue,(k,M)=>{let[I,S]=k.value,V=this.getProjection().mathToPixels.mapPoint({x:I,y:S});nh(V.x-i.x,V.y-i.y)<t&&(C=!0,D=M)}),C)return D!==void 0&&(x=eA(x,D)),{type:"spec",spec:{type:"point-reference",targetSpec:{type:"intersection",parentDefs:h},parentDefs:[x]}}}return{type:"spec",spec:{type:"intersection",parentDefs:h}}}else if(p)return TK(this.getProjection(),e,a)}else{if(p&&Fg(s))return TK(this.getProjection(),e,a);if(s==="Vector"){let h=Wp(a.typedRuntimeValue.value).map((x,C)=>({index:C,point:{x:x[0],y:x[1]},pixelsFromPoint:GK(this.getProjection(),nh(x[0]-e.x,x[1]-e.y))})).sort((x,C)=>x.pixelsFromPoint-C.pixelsFromPoint).filter(x=>x.pixelsFromPoint<5);if(h.length>0)return qQ(a,h[0].index===1?1:0)}}let u=BQ(this.getProjection(),e);return{type:"spec",spec:{type:"point",x:u.x,y:u.y,parentDefs:[],previewOnly:!p}}}findIncidentPointDef(e,t){let i=e.typedRuntimeValue.valueType,o=t.typedRuntimeValue.valueType,n={};Tg({controller:this.controller,expandLists:!1},s=>{if(s.data.identifier&&__dcg_shared_module_exports__['Pa'](s.typedRuntimeValue.valueType,__dcg_shared_module_exports__['da'])){let l=s.data.identifier;n[l]=s}});let a=__dcg_shared_module_exports__['mc']({getGeometryTree:s=>s.data.call,isPointOrListOfPoints:s=>__dcg_shared_module_exports__['Pa'](s.typedRuntimeValue.valueType,__dcg_shared_module_exports__['da']),lookup:s=>n[s],resolvesTo:(s,l)=>s===l.data.identifier},e,i,t,o);if(a){let[s,l]=a,c=n[s];return l===void 0?c:eA(c,l)}}_shouldNewObjectsBeMarkedUncommitted(){return this.getToolMode()!=="selection"}clearHoveredObjects(){this.store.set("hoveredObjects",[])}getHoveredItems(){return this.store.getState().hoveredObjects}cancelToolplay(){this._deleteObjects(this.getUncommittedObjectIds()),this.clearHoveredObjects(),this.resetToolMode()}isToolplayActive(){return this.getNonObjectsState().ui.currentTool.inputIndex>0}getComputedBoard(){let e=new Uw;return Tg({controller:this.controller},(t,i)=>{e.add(t,i)}),e}findDefsForInputId(e){let t=[];return Tg({controller:this.controller},i=>{(i.assignment===e||i.referenceLatex===e)&&t.push(i)}),t}isCreatingNewTransform(){return this.getCurrentTool().toolType==="transformation"}getCurrentToolDisplayName(){return this.controller.s(this.getCurrentTool().displayName)}isCurrentToolComplex(){return this.getCurrentTool().toolType==="complex"}isCurrentToolSingleUse(){return this.getCurrentTool().toolType==="transformation"}getIconInstructionsForTool(e){let t=this.getTool(e);return t?t.icon:[]}getDisplayNameForTool(e){let t=this.getTool(e);return t?this.controller.s(t.displayName):""}speakCurrentGeoToolHint(){be(this.getCurrentTool().getHint())}};function BQ(r,e){var t=jA(r,e);t&&(e=t);var i=.5/IK(r);return{x:Ei(e.x-i,e.x+i),y:Ei(e.y-i,e.y+i)}}function IK(r){return r.mapx(1)-r.mapx(0)}function GK(r,e){return IK(r)*e-6}function TK(r,e,t){var i=u0(r,e,t.typedRuntimeValue);return{type:"spec",spec:{type:"glider",t:i,parentDefs:[t]}}}function qQ(r,e){return{type:"spec",spec:{type:"vector-endpoint",location:e?"end":"start",parentDefs:[r]}}}function KQ(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}var zQ="ID_",Zd=function(){function r(){KQ(this,r),this._callbacks={},this._isDispatching=!1,this._isHandled={},this._isPending={},this._lastID=1}return r.prototype.register=function(t){var i=zQ+this._lastID++;return this._callbacks[i]=t,i},r.prototype.unregister=function(t){this._callbacks[t]||jw(!1,"Dispatcher.unregister(...): `%s` does not map to a registered callback.",t),delete this._callbacks[t]},r.prototype.waitFor=function(t){this._isDispatching||jw(!1,"Dispatcher.waitFor(...): Must be invoked while dispatching.");for(var i=0;i<t.length;i++){var o=t[i];if(this._isPending[o]){this._isHandled[o]||jw(!1,"Dispatcher.waitFor(...): Circular dependency detected while waiting for `%s`.",o);continue}this._callbacks[o]||jw(!1,"Dispatcher.waitFor(...): `%s` does not map to a registered callback.",o),this._invokeCallback(o)}},r.prototype.dispatch=function(t){this._isDispatching&&jw(!1,"Dispatch.dispatch(...): Cannot dispatch in the middle of a dispatch."),this._startDispatching(t);try{for(var i in this._callbacks)this._isPending[i]||this._invokeCallback(i)}finally{this._stopDispatching()}},r.prototype.isDispatching=function(){return this._isDispatching},r.prototype._invokeCallback=function(t){this._isPending[t]=!0,this._callbacks[t](this._pendingPayload),this._isHandled[t]=!0},r.prototype._startDispatching=function(t){for(var i in this._callbacks)this._isPending[i]=!1,this._isHandled[i]=!1;this._pendingPayload=t,this._isDispatching=!0},r.prototype._stopDispatching=function(){delete this._pendingPayload,this._isDispatching=!1},r}();function jw(r,e,t,i,o,n,a,s){if(e===void 0)throw new Error("invariant requires an error message argument");if(!r){var l;if(e===void 0)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[t,i,o,n,a,s],p=0;l=new Error(e.replace(/%s/g,function(){return c[p++]})),l.name="Invariant Violation"}throw l.framesToPop=1,l}}var tu=class{constructor(e=100){this.clear(),this._sizeLimit=e}clear(){this._stack=[],this._stackPointer=-1}getState(){return this._stack[this._stackPointer]}serializeForBugsnag(){function e(t){try{return JSON.stringify(t,null,2)}catch(i){return"[[could not jsonify]]"}}return{currentState:e(this._stack[this._stackPointer]),undoState:e(this._stack[this._stackPointer-1]),redoState:e(this._stack[this._stackPointer+1])}}addState(e){this.canRedo()&&this._stack.splice(this._stackPointer+1),this._stack.push(e),this._stack.length>this._sizeLimit&&this._stack.shift(),this._stackPointer=this._stack.length-1}replaceState(e){this.canRedo()&&this._stack.splice(this._stackPointer+1),this.replaceInteriorState(e)}replaceInteriorState(e){this._stack.length===0?(this._stack.push(e),this._stackPointer=0):this._stack[this._stackPointer]=e}canUndo(){return this._stackPointer>0}canRedo(){return this._stackPointer<this._stack.length-1}undo(){this.canUndo()&&(this._stackPointer-=1)}redo(){this.canRedo()&&(this._stackPointer+=1)}};var VK=r=>({value:"0",min:"0",max:r.degreeMode?"360":"2\\pi"}),UQ={latex:void 0,polarDomainMin:void 0,polarDomainMax:void 0,parametricDomainMin:void 0,parametricDomain3DuMin:void 0,parametricDomain3DvMin:void 0,clickableInfoLatex:void 0,parametricDomainMax:void 0,parametricDomain3DuMax:void 0,parametricDomain3DvMax:void 0,colorLatex:void 0,tableColumnColorLatex:void 0,cdfMin:()=>({value:"0",min:"-10",max:"10"}),cdfMax:()=>({value:"0",min:"-10",max:"10"}),pointSize:()=>({value:9+"",min:"0",max:"10"}),tableColumnPointSize:()=>({value:9+"",min:"0",max:"10"}),labelAngle:VK,labelSize:()=>({value:"1",min:"0",max:"5"}),lineWidth:()=>({value:2.5+"",min:"0",max:"10"}),resolution:()=>({value:"50",min:"2",max:"100",step:"1"}),checkers:()=>({value:__dcg_shared_module_exports__['wc']+"",min:"1",max:"1000"}),tableColumnLineWidth:()=>({value:2.5+"",min:"0",max:"10"}),fillOpacity:()=>({value:.4+"",min:"0",max:"1"}),lineOpacity:()=>({value:.9+"",min:"0",max:"1"}),tableColumnLineOpacity:()=>({value:.9+"",min:"0",max:"1"}),pointOpacity:()=>({value:.9+"",min:"0",max:"1"}),tableColumnPointOpacity:()=>({value:.9+"",min:"0",max:"1"}),sliderMin:void 0,sliderMax:void 0,sliderStep:void 0,residualVariable:void 0,tableHeader:void 0,tableCellValue:void 0,imageOpacity:()=>({value:"1",min:"0",max:"1"}),imageCenter:void 0,imageHeight:()=>({value:"10",min:"-10",max:"10"}),imageWidth:()=>({value:"10",min:"-10",max:"10"}),imageAngle:VK,tickerMinStep:()=>({value:"0",min:"0"}),tickerHandler:void 0},MK={rgb:{paramBounds:r=>({value:"0",min:"0",max:"255",step:"1"})},hsv:{paramBounds:r=>r===0?{value:"0",min:"0",max:"360",step:"1"}:{value:"0.5",min:"0",max:"1"}}};function OK(r,e,t){var i=r.map(function(a){return{location:a.location,parsed:__dcg_shared_module_exports__['lc'](a.latex)}}),o={};for(let a of e)for(let s of i){var n=HQ(a,s,t);n&&n.length&&(o[a]=n[0])}return o}function HQ(r,{parsed:e,location:t},i){if(e.type==="Identifier"&&e._symbol===r){let n=UQ[t];return n?[n(i)]:void 0}e.type==="Assignment"&&(e=e._expression);let o=[];switch(e.type){case"FunctionCall":{let n=e._symbol;if(MK.hasOwnProperty(n)){let a=MK[n];e.args.forEach(function(s,l){if(s.type==="Identifier"&&s._symbol===r){var c=a.paramBounds(l);c&&o.push(c)}})}break}default:return}return o}function yn(r,e,t){let i=$Q(r,e,t);Fi(r,i)}function Fi(r,e){if(r.focusLocation=e,!e||(e.type==="ticker"&&(r.getListModel().ticker.playing=!1,Zr(r.getListModel(),void 0)),e.type==="settings"||e.type==="generic-menu"||e.type==="editable-label"||e.type==="add-item-btn"||e.type==="add-expression-btn"||e.type==="add-note-btn"||e.type==="add-table-btn"||e.type==="add-folder-btn"||e.type==="add-ticker-btn"||e.type==="add-image-btn"||e.type==="edit-list-toggle"||e.type==="hide-expression-list-btn"||e.type==="show-expression-list-btn"||e.type==="zoom-in-btn"||e.type==="zoom-restore-btn"||e.type==="search-expressions"||e.type==="replace-expressions"||e.type==="ticker"||e.type==="geo-token"||e.type==="geo-show-constructions-icon"||e.type==="geo-basic-tool"||e.type==="geo-basic-tool-menu-item"||e.type==="multi-select-more-icon"||e.type==="multi-select-transformations-icon"||e.type==="geo-header-back-link"||e.type==="multi-select-delete-icon"||e.type==="multi-select-show-hide-icon"||e.type==="new-transformation-number"||e.type==="label-points-icon"||e.type==="graph-paper"||e.type==="quest"))return;let t=r.getItemModel(e.id);if(e.type==="expression-menu"){Zr(r.getListModel(),void 0);return}else Zr(r.getListModel(),t);t&&t.type==="expression"&&Hs(t,!1)}function $Q(r,e,t){let i=r.getItemModel(e);if(!i)return;let o=r.isInEditListMode()||r.isItemReadonly(i.id);switch(i.type){case"expression":return{type:o?"readonly-expression":i.type,id:e};case"folder":case"text":return{type:i.type,id:e};case"table":{let a={row:1,column:0},s=!1;return t&&(t.location==="cell"?a={row:t.row,column:t.column}:t==="end"?a={row:Sl(i),column:0}:t==="start"?a={row:0,column:0}:t==="container"&&(s=!0)),s?{type:"table-container",id:e}:{type:i.type,id:e,location:a}}case"image":return{type:i.type,id:e,location:"name"};default:return i}}function PK(r){var e=r.getSelectedItem();if(e&&e.type==="expression"&&!e.readonly){yn(r,e.id);return}if(e&&e.type==="table"&&r.focusLocation&&!e.readonly)return;var t=r.getFirstFullyVisibleItem();let i=r.getListModel();for(;t&&(t.type!=="expression"||t.readonly);)t=ug(i,t.index);if(t){yn(r,t.id);return}let o=r.createItemModel({type:"expression",id:r.generateId(),color:r.getNextColor()});Rc(r.getListModel(),o),yn(r,o.id)}function _K(r){let e=r.focusLocation;if(e&&!(e.type==="settings"||e.type==="generic-menu"||e.type==="editable-label"||e.type==="add-item-btn"||e.type==="add-expression-btn"||e.type==="add-note-btn"||e.type==="add-table-btn"||e.type==="add-ticker-btn"||e.type==="add-folder-btn"||e.type==="add-image-btn"||e.type==="edit-list-toggle"||e.type==="hide-expression-list-btn"||e.type==="show-expression-list-btn"||e.type==="zoom-in-btn"||e.type==="zoom-restore-btn"||e.type==="search-expressions"||e.type==="replace-expressions"||e.type==="ticker"||e.type==="geo-token"||e.type==="geo-show-constructions-icon"||e.type==="geo-basic-tool"||e.type==="geo-basic-tool-menu-item"||e.type==="multi-select-more-icon"||e.type==="multi-select-transformations-icon"||e.type==="geo-header-back-link"||e.type==="multi-select-delete-icon"||e.type==="multi-select-show-hide-icon"||e.type==="new-transformation-number"||e.type==="label-points-icon"||e.type==="graph-paper"||e.type==="quest"))return r.getItemModel(e.id)}function xb(r,e,t){Fi(r,{type:"table",id:e,location:t})}function RK(r,e,t){var i=r.getItemModel(e);if(!i||i.type!=="table")return;let o=i;var n=Sa(o),a=n?n.row:-1,s=n?n.column:-1,l=o.columnModels,c=Sl(o),p=l.length,u=(D,k)=>{D===-1?YA(r):D>c?JA(r):(k===-1?(k=p-1,D--):k===p&&(D++,k=0),xb(r,e,{row:D,column:k}))},m=D=>{c>2&&M5(o,a-1),xb(r,e,{row:D,column:s})},h=D=>{s===0||p<=2||(A5(o,s),xb(r,e,{row:a,column:D}))};let x=!!o.columnModels[0].disabled;switch(t){case"Left":u(a,s-1);break;case"Right":u(a,s+1);break;case"Up":u(a-1,s);break;case"Down":u(a+1,s);break;case"Enter":if(a>=c)return ZA(r);if(s>0||x)return u(a+1,s);if(a===c-1){let D=L5(o,a);hM(o,a);for(var C=0;C<D.length;C++)qp(o,{row:a+1,column:C},D[C]);xb(r,e,{row:a+1,column:s});return}hM(o,a),xb(r,e,{row:a+1,column:s});break;case"Backspace":a===0?s===0?XA(r):s===p-1||s===1&&p===3?u(0,s-1):h(s-1):s!==0?u(a,s-1):a===c||x?u(a-1,s):m(a-1);break;case"Delete":a===0?s===0?QA(r):s<p-1&&h(s):a>=c||x||m(a);break}}function YA(r){var e=r.getSelectedItem();!e||r.inAudioTraceMode()||(!sk(r.getListModel())&&r.getTickerOpen()&&Fi(r,{type:"ticker",location:"handler"}),e=r.getSelectedItem(),!e)||yn(r,e.id,"end")}function JA(r){var t;if(!r.inAudioTraceMode()){if(((t=r.getFocusLocation())==null?void 0:t.type)==="ticker"){let i=Af(r.getListModel());if(i)return yn(r,i.id,"start")}if(!lk(r.getListModel())&&!r.isInEditListMode()){let i=r.createItemModel({type:"expression",id:r.generateId(),color:r.getNextColor()});Rc(r.getListModel(),i),Zr(r.getListModel(),i)}var e=r.getSelectedItem();e&&yn(r,e.id,"start")}}function XA(r){if(r.isInEditListMode())return;var e=r.getSelectedItem();if(!e||r.getItemCount()===1&&e.type==="expression")return;var t=e.type==="text";let i=Ws(e);if(i){let o=r.getNumberOfItemsInFolder(i.id);if(e.index===i.index+o){sa(e,"");return}}if(eL(r,{moveSelection:!0}),t&&pl&&Ip){Zr(r.getListModel(),void 0);return}e=r.getSelectedItem(),e&&yn(r,e.id,"end")}function QA(r){if(!r.isInEditListMode()){var e=r.getSelectedItem();e&&(r.getItemCount()===1&&e.type==="expression"||(tL(r,{moveSelection:!0}),e=r.getSelectedItem(),e&&yn(r,e.id,"start")))}}function ZA(r){if(!r.isInEditListMode()){var e=r.getSelectedItem();if(e){if(e.type==="text"&&pl&&Ip){Kr(),Zr(r.getListModel(),void 0);return}if(Ux(e).length&&r.areSlidersEnabled())return r.createSlidersForItem(e.id,Ux(e).concat(""));var t=r.createItemModel({type:"expression",id:r.generateId(),color:r.getNextColor()}),i=e.index+1;e.type==="folder"&&e.collapsed&&(i+=r.getNumberOfItemsInFolder(e.id)),Dl(r.getListModel(),t,i),Zr(r.getListModel(),t),e.type==="folder"&&!e.collapsed?sa(t,e.id):e.type!=="folder"&&e.folderId&&sa(t,e.folderId),e=r.getSelectedItem(),e&&yn(r,e.id)}}}function eL(r,{moveSelection:e}){let t=r.getSelectedItem(),i=r.getListModel();if(!t||t.readonly)return;let o=pg(i,t.index);if(r._removeExpressionSynchronously(t),e){if(!o){let n=Af(i);n&&(o=n)}Zr(i,o)}else Zr(i,void 0)}function tL(r,{moveSelection:e}){let t=r.getSelectedItem(),i=r.getListModel();if(!t||t.readonly)return;let o=ug(i,t.index);if(r._removeExpressionSynchronously(t),e){if(!o){let n=ik(i);n&&(o=n)}Zr(i,o)}else Zr(i,void 0)}function YQ(r){switch(r){case"histogram":case"dotplot":return 12;case"boxplot":return 40}return 1/0}function JQ(r){return r==="boxplot"||r==="dotplot"||r=="histogram"}function XQ(r){return r==="boxplot"?3:.5}function QQ(r,e){if(r.type==="dotplot"||r.type==="histogram"){let o=Math.max(1,r.xmax-r.xmin)*80/(r.binWidth?r.binWidth:1),n=.5*(e.screen.width-o)/o;return Math.max(.2,n)}return .5}function ZQ(r,e,t){r=__dcg_shared_module_exports__['j'](r);let i=1.2;return e&&r.xmax<0&&r.xmin<0&&r.xmax/(r.xmin-r.xmax)<i&&(r.xmax=0),e&&r.xmax>0&&r.xmin>0&&r.xmin/(r.xmax-r.xmin)<i&&(r.xmin=0),t&&r.ymax<0&&r.ymin<0&&r.ymax/(r.ymin-r.ymax)<i&&(r.ymax=0),t&&r.ymax>0&&r.ymin>0&&r.ymin/(r.ymax-r.ymin)<i&&(r.ymin=0),r}function eZ(r,e,t,i){let o=r.type,n=QQ(r,e),a=XQ(o),s,l,c,p;if(r.xmin===r.xmax&&(t?(r.xmin-=.5,r.xmax+=.5):(r.xmin*=.5,r.xmax/=.5)),r.ymin===r.ymax&&(i?(r.ymin-=.5,r.ymax+=.5):(r.ymin*=.5,r.ymax/=.5)),t){let u=(r.xmax-r.xmin)*n;s=r.xmin-u,l=r.xmax+u}else{let u=(r.xmax/r.xmin)**n;s=r.xmin/u,l=r.xmax*u}if(i){let u=(r.ymax-r.ymin)*a;c=r.ymin-u,p=r.ymax+u}else{let u=(r.ymax/r.ymin)**a;c=r.ymin/u,p=r.ymax*u}if(JQ(o)){let u=e.screen.height/e.screen.width,m=(l-s)*u;if(m>r.ymax-r.ymin&&m<YQ(o)*(r.ymax-r.ymin)){let h=.5*(r.ymax+r.ymin);p=h+.5*m,c=h-.5*m}}return{xmin:s,xmax:l,ymin:c,ymax:p}}function rL(r,e){var t=Jw(r,e);if(!t)return!1;let{xAxisScale:i,yAxisScale:o}=e.settings;if(!lo.fromObject(t).isValid({xAxisScale:i,yAxisScale:o}))return!1;var a=e.mapx(t.xmin),s=e.mapx(t.xmax),l=e.mapy(t.ymin),c=e.mapy(t.ymax),p=10,u=Math.abs(a)<=p&&Math.abs(c)<=p&&Math.abs(s-e.screen.width)<=p&&Math.abs(l-e.screen.height)<=p;return!u}function Jw(r,e){let t=1/0,i=-1/0,o=1/0,n=-1/0,a=0,s=r.length,l=e.settings.xAxisScale==="linear",c=e.settings.yAxisScale==="linear";for(let p=0;p<s;p++){let u=ZQ(r[p],l,c);if(!isFinite(u.xmax-u.xmin)||!isFinite(u.ymax-u.ymin)){a+=1;continue}if(!l&&!(u.xmax>0&&u.xmin>0)||!c&&!(u.ymax>0&&u.ymin>0)){a+=1;continue}let m=eZ(u,e,l,c);m.xmin<t&&(t=m.xmin),m.xmax>i&&(i=m.xmax),m.ymin<o&&(o=m.ymin),m.ymax>n&&(n=m.ymax)}if(a!==s)return{xmin:t,xmax:i,ymin:o,ymax:n}}function NK(r){switch(r){case"letters":return"capitalLetters";case"noQwertyLetters":return"noQwertyCapitalLetters";case"noQwertyCapitalLetters":return"noQwertyLetters";default:return"letters"}}function BK(r){switch(r){case"mainNumbers":return"mainNumbers3D";default:return r}}function iL(r){return{keypadMinimized:!a_,keypadLayout:"mainNumbers",keypadFunctionsOpen:!1,graphSettingsOpen:!1,addExpressionOpen:!1,expressionsVisible:!!r.expressions,inEditListMode:!1,isFileDraggedOver:!1,expressionsHiddenTime:void 0}}var KK={xmin:"",xmax:"",xstep:"",ymin:"",ymax:"",ystep:"",zmin:"",zmax:""};function zK(r){return r in KK}function tZ(r){let e=r.split("\xD7");return(e.length>1&&e[0]==="1"?e.slice(1):e).join("\\cdot")}function Rg(r,e){let t=__dcg_shared_module_exports__['bb'](r,e),i="";if(t.mantissa)i=tZ(t.mantissa)+"^{"+t.superscript+"}";else{let o=t.string.split("/");o.length===2?o[0][0]==="-"?i="-\\frac{"+o[0].slice(1)+"}{"+o[1]+"}":i="\\frac{"+o[0]+"}{"+o[1]+"}":i=t.string}return i=i.replace(/π/,"\\pi"),i}function rZ(r,e){let t=e.xAxisScale==="linear"?r.xmax-r.xmin:void 0,i=e.yAxisScale==="linear"?r.ymax-r.ymin:void 0,o={xmin:Rg(r.xmin,t),xmax:Rg(r.xmax,t),ymin:Rg(r.ymin,i),ymax:Rg(r.ymax,i)};return r.zmin!==void 0&&r.zmax!==void 0&&(o.zmin=Rg(r.zmin,r.zmax-r.zmin),o.zmax=Rg(r.zmax,r.zmax-r.zmin)),o}function qK(r,e){return r===0?"":Rg(r,e)}function UK(r,e){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},rZ(r,e.scales)),{xstep:qK(e.steps.xAxisStep,r.xmax-r.xmin),ystep:qK(e.steps.yAxisStep,r.ymax-r.ymin)})}function oL(){return{limitLatex:__dcg_shared_module_exports__['a']({},KK)}}xt();yl();function HK(r){let e=[],t=r.getAllItemModels();for(let i of t){let o=r.getItemRootNodeById(i.id);o&&e.push(o)}return e}function oZ(r){let e=r.getAllItemModels();for(let t=e.length-1;t>=0;t--){let i=e[t];if(i.dcgView)return i.id}}function WK(r,e){let t=HK(r),i=0,o=t.length-1;for(;i<=o;){let n=i+Math.floor((o-i)/2),a=t[n],s=a.getBoundingClientRect();if(s.top>e)o=n-1;else if(s.bottom<e)i=n+1;else return a}}function nZ(r,e){let t=HK(r),i=0,o=t.length-1,n;for(;i<=o;){let a=i+Math.floor((o-i)/2),s=t[a];s.getBoundingClientRect().top>e?(o=a-1,n=s):i=a+1}return n}function $K(r,e){let t=Zw(r);if(!t)return;if(e){let o=r.getItemRootNodeById(e);if(o){let n=o.getBoundingClientRect();if(n.height>0&&n.top<=t.top&&n.bottom>=t.top)return e}}let i=WK(r,t.top);return i?i.getAttribute("expr-id"):nL(r)}function jK(r,e){let t=Zw(r);if(!t)return;let i=oZ(r);if(!i)return;if(e){let n=r.getItemRootNodeById(e);if(n){let a=n.getBoundingClientRect();if(a.height>0&&a.top<=t.bottom&&a.bottom>=t.bottom||e===i&&a.bottom<=t.bottom)return e}}let o=WK(r,t.bottom);return o&&o.getAttribute("expr-id")||i}function nL(r){let e=Zw(r);if(!e)return;let t=nZ(r,e.top-2);if(t)return t.getAttribute("expr-id")}function Xw(r){return r.findEl(".dcg-exppanel")}function Qw(r){return Xw(r)}function Zw(r){let e=Xw(r);if(e)return e.getBoundingClientRect()}function YK(r){let e=Xw(r);if(!e)return;let t=e.getBoundingClientRect(),i=e.scrollTop;return t.top-i}function JK(r){let e=r.findEl(".dcg-expressionlist");if(!e)return;let t=e.getBoundingClientRect();return{width:t.width,height:t.height}}function XK(r){let e=Qw(r);if(!e)return;let t=e.querySelector(".dcg-drag-container > *");if(!t)return;let i=t.getBoundingClientRect();return{width:i.width,height:i.height}}xt();var ev=class{constructor(e){this.active=!1,this.controller=e;let t=Qw(e);t&&(this.exppanel=t)}startDragging(e){this.active=!0,this.mousePt=e,this.setupEventListeners()}applyDrag(){var I;let t=this.controller.getListModel().dragState;if(!t)return;this.scheduleUpdateScroll();let i=this.measureDOM(t);if(!i)return;let{floatingPreviewRect:o,dragState:n,visibleRects:a}=i,s=this.controller.getItemModel(n.firstItemId);if(!s)return;let l=s.index,c=a[0];if(c&&c.id!==s.id){let S=this.controller.getItemModel(c.id);S&&S.index>l&&(l=S.index-1)}let{cachedNamedAssignmentLatex:p,cachedTokenAssignmentLatex:u}=n;for(let{id:S,rect:V}of a){if(S===s.id)continue;let P=this.controller.getItemModel(S);if(!P)return;if(P.index<s.index){if(o.top<V.top+V.height/2){l=P.index;break}}else o.bottom>V.top+V.height/2&&(l=P.index,P.type==="folder"&&P.collapsed&&(l+=this.controller.getNumberOfItemsInFolder(P.id)))}let m,h;l>s.index?(m=l,h=l+1):l<s.index?(m=l-1,h=l):(m=l-1,h=l+1);let x=this.controller.getItemModelByIndex(m),C=this.controller.getItemModelByIndex(h),D="",k="";x&&(x.type==="folder"?D=x.id:D=x.folderId),C&&(C.type==="folder"?k=C.id:k=C.folderId);let M="";if(D&&(k===D?s.type==="folder"?l=s.index:M=D:s.type!=="folder"&&this.isPreviewTopContainedInFolder(i,D)&&(M=D)),s.type==="expression")if(n.renderType==="token"){if(t.renderType==="expression"&&(p=s.latex,this.controller.convertToTokenAssignment(s,u)),n.dragTarget.type==="token")l=n.dragTarget.originalIndex,M=((I=this.controller.getGeometryFolder())==null?void 0:I.id)||"";else if(n.dragTarget.type==="expression"){let S=this.controller.getGeometryFolder();if(S){let V=this.controller.getNumberOfItemsInFolder(S.id);s.type==="expression"&&s.folderId===S.id&&(V-=1),l=S.index+V+1,M=S.id}}}else n.renderType==="expression"&&t.renderType==="token"&&(u=s.latex,this.controller.convertToNamedAssignment(s,p));return{dragState:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},n),{cachedNamedAssignmentLatex:p,cachedTokenAssignmentLatex:u}),newIndex:l,folderId:M}}measureDOM(e){let t=YK(this.controller),i=JK(this.controller),o=XK(this.controller);if(t===void 0||!i||!o)return;let n=i.height,a=o.height,s=!1,l=this.controller.getExppanelSelector(),c=l==null?void 0:l.querySelector(".dcg-template-expressioneach"),p=c==null?void 0:c.getBoundingClientRect();p&&p.top<=e.mousePt.y&&(s=!0);let u=!1,m=l==null?void 0:l.querySelector(".dcg-geo-show-constructions-pane"),h=m==null?void 0:m.getBoundingClientRect();h&&h.bottom>e.mousePt.y&&(u=!0);let x=!1;(e.dragTarget.type==="token"&&!s||e.dragTarget.type==="expression"&&u&&!s&&this.controller.canDraggedItemBeMovedIntoTokenPane())&&(x=!0);let C=e.grabOffset;x?C={x:o.width/2,y:o.height/2}:e.dragTarget.type==="token"&&(C={x:0,y:o.height/2});let D=e.mousePt.y-C.y+2,k=D-t;k=Math.max(k,-a/2),k=Math.min(k,n-a);let M=0;if(x){M=e.mousePt.x-C.x;let B=4;M=Math.min(M,i.width-o.width-B),M=Math.max(M,0),k=Math.max(k,2)}let I={left:M,top:D,bottom:D+a,height:a},S=this.controller.findFirstVisibleItem(),V=this.controller.findLastVisibleItem(),P=[];if(S&&V)for(var L=S.index;L<=V.index;L++){let B=this.controller.getItemModelByIndex(L);if(!B)continue;let R=this.controller.getItemRootNodeById(B.id);if(R&&B.id!==e.firstItemId){let W=R.getBoundingClientRect();P.push({id:B.id,rect:W})}}return{dragState:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},e),{itemTop:k,itemLeft:M,renderType:x?"token":"expression"}),floatingPreviewRect:I,visibleRects:P}}isPreviewTopContainedInFolder(e,t){let{visibleRects:i,floatingPreviewRect:o}=e;for(let{id:n,rect:a}of i)if(a.top<=o.top&&a.bottom>=o.top){let s=this.controller.getItemModel(n);if(!s)return!1;if(s.type==="folder"&&s.id===t||s.type!=="folder"&&s.folderId===t)return!0}return!1}scheduleUpdateScroll(){this.updateScrollScheduled||(this.updateScrollScheduled=!0,requestAnimationFrame(()=>{this.updateScroll(),this.updateScrollScheduled=!1}))}stop(){this.active=!1,this.tearDownEventListeners(),this.controller.dispatch({type:"stop-dragdrop"})}setupEventListeners(){H(document).on("dcg-tapmove.dragdrop",e=>{this.mousePt.x=e.changedTouches[0].clientX,this.mousePt.y=e.changedTouches[0].clientY,this.controller.dispatch({type:"update-dragdrop",mousePt:this.mousePt})}),H(document).on("dcg-tapend.dragdrop",e=>{this.stop(),e.handle("dragdrop")})}tearDownEventListeners(){H(document).off(".dragdrop")}updateScroll(){if(this.active){var e=this.exppanel.getBoundingClientRect(),t=0;t=Math.min(t,this.mousePt.y-e.top),t=Math.max(t,this.mousePt.y-e.bottom+30),t=t*e.height/900,t&&(this.exppanel.scrollTop=this.exppanel.scrollTop+t)}}};var aZ={loga:(r,e)=>{_e.canAcceptText(r,e.capExpressionSize,"\\log_{}\\left(\\right)")&&(r.write("\\log_{}"),r.typedText("("),r.keystroke("Left"),r.keystroke("Down"))},nthroot:(r,e)=>{_e.canAcceptText(r,e.capExpressionSize,"\\sqrt[]{}")&&(r.write("\\sqrt[]{}"),r.keystroke("Left"),r.keystroke("Left"))},ddx:(r,e)=>{_e.canAcceptText(r,e.capExpressionSize,"\\frac{d}{dx}")&&r.write("\\frac{d}{dx}")},arcsin:(r,e)=>{_e.canAcceptText(r,e.capExpressionSize,"\\sin^{-1}\\left(\\right)")&&(r.write("sin^{-1}"),r.typedText("("))},arccos:(r,e)=>{_e.canAcceptText(r,e.capExpressionSize,"\\cos^{-1}\\left(\\right)")&&(r.write("cos^{-1}"),r.typedText("("))},arctan:(r,e)=>{_e.canAcceptText(r,e.capExpressionSize,"\\tan^{-1}\\left(\\right)")&&(r.write("tan^{-1}"),r.typedText("("))},arcsec:(r,e)=>{_e.canAcceptText(r,e.capExpressionSize,"\\sec^{-1}\\left(\\right)")&&(r.write("sec^{-1}"),r.typedText("("))},arccsc:(r,e)=>{_e.canAcceptText(r,e.capExpressionSize,"\\csc^{-1}\\left(\\right)")&&(r.write("csc^{-1}"),r.typedText("("))},arccot:(r,e)=>{_e.canAcceptText(r,e.capExpressionSize,"\\cot^{-1}\\left(\\right)")&&(r.write("cot^{-1}"),r.typedText("("))},"A^T":(r,e)=>{_e.canAcceptText(r,e.capExpressionSize,"^{T}")&&(r.typedText("^T"),r.keystroke("Right"))},"A^-1":(r,e)=>{_e.canAcceptText(r,e.capExpressionSize,"^{-1}")&&(r.typedText("^-1"),r.keystroke("Right"))},"A^2":(r,e)=>{_e.canAcceptText(r,e.capExpressionSize,"^{2}")&&(r.typedText("^2"),r.keystroke("Right"))},"a^2":(r,e)=>{_e.canAcceptText(r,e.capExpressionSize,"^{2}")&&(r.typedText("^2"),r.keystroke("Right"))},"a^3":(r,e)=>{_e.canAcceptText(r,e.capExpressionSize,"^{3}")&&(r.typedText("^3"),r.keystroke("Right"))},"a/b":(r,e)=>{_e.canAcceptText(r,e.capExpressionSize,"\\frac{}{}")&&(r.write("\\frac{}{}"),r.keystroke("Left"))},integral:(r,e)=>{_e.canAcceptText(r,e.capExpressionSize,"\\int_{}^{}")&&r.cmd("integral")}};function wb(r,e,t){aZ[e](r,t)}function QK(r){if(!r)return;let e=[];for(let t of r.split(" ")){let i=t.indexOf("|"),o=i!==-1?t.slice(0,i):t;e.push(o)}return e}function vb(r,e,t){let i=QK(t);return e==="nemeth"?Xp(r,{operatorNames:i}):e==="ueb"?Qp(r,{operatorNames:i}):{isError:!0,error:"Braille mode should be 'nemeth' or 'ueb'"}}function g0(r,e,t){let i=QK(t);return e==="nemeth"?IA(r,{operatorNames:i}):e==="ueb"?VA(r,{operatorNames:i}):{isError:!0,error:"Braille mode should be 'nemeth' or 'ueb'"}}var Ga=__dcg_shared_module_exports__['h'](z());var Cb=__dcg_shared_module_exports__['h'](z());xt();var{Input:sZ}=Cb.Components,Ng=class extends Cb.Class{init(){this.ASCIICharacters=` A1B'K2L@CIF/MSP"E3H9O6R^DJG>NTQ,*5<-U8V.%[$+X!&;:4\\0Z7(_?W]#Y)=`,this.ASCIITable=[],this.HomeRowCharacters="FDSJKL",this.charCodes=[],this.sixKeyModel={keysDown:0,stickyKeysDown:0};let e;for(e=0;e<this.ASCIICharacters.length;e++)this.ASCIITable.push(this.ASCIICharacters.charCodeAt(e));for(e=0;e<this.HomeRowCharacters.length;e++)this.charCodes.push(this.HomeRowCharacters.charCodeAt(e))}template(){return Cb.createElement(sZ,{class:this.const("dcg-braille-input dcg-do-blur"),tabindex:()=>this.props.tabindex?this.props.tabindex():0,readonly:()=>this.props.isStatic()?"true":void 0,autocomplete:this.const("off"),autocorrect:this.const("off"),autocapitalize:this.const("off"),spellcheck:this.const("false"),onKeydown:this.bindFn(this.onKeydown),onKeyup:this.bindFn(this.onKeyup),onInput:this.bindFn(this.props.onInput),value:()=>this.props.value(),"aria-label":()=>this.props.ariaLabel()||Ks(""),didMount:this.bindFn(this.didMount),didUnmount:this.bindFn(this.props.didUnmount),placeholder:()=>this.props.placeholder?this.props.placeholder():"",size:()=>this.props.size&&this.props.size()})}didMount(e){this.rootNode=e,H(this.rootNode).on("focus",t=>{this.props.shouldFocus()||this.props.onFocusedChanged(!0,t.originalEvent||t)}).on("blur",t=>{this.props.shouldFocus()&&this.props.onFocusedChanged(!1,t.originalEvent||t)}),this.props.didMount(e),this.updateFocus()}didUpdate(){this.updateFocus()}updateFocus(){this.rootNode&&(this.props.shouldFocus()&&document.activeElement!==this.rootNode&&this.rootNode.focus(),!this.props.shouldFocus()&&document.activeElement===this.rootNode&&this.rootNode.blur())}onKeydown(e){let t=this.charCodes.indexOf(e.which);!this.props.isStatic()&&this.isSixKeyInput()&&!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&t!==-1?(this.sixKeyModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.sixKeyModel),{keysDown:this.addKey(this.sixKeyModel.keysDown,t),stickyKeysDown:this.addKey(this.sixKeyModel.stickyKeysDown,t)}),e.preventDefault()):this.props.onKeydown&&this.props.onKeydown(e)}onKeyup(e){let t=this.charCodes.indexOf(e.which),i=!1;return!this.props.isStatic()&&this.isSixKeyInput()&&!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&t!==-1?(this.sixKeyModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.sixKeyModel),{keysDown:this.removeKey(this.sixKeyModel.keysDown,t)}),this.sixKeyModel.keysDown===0&&(this.addCharacter(this.bitsToASCII(this.sixKeyModel.stickyKeysDown)),this.sixKeyModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.sixKeyModel),{stickyKeysDown:0}))):i=!0,i||e.preventDefault(),i}addKey(e,t){return e|1<<t}removeKey(e,t){return e&~(1<<t)}bitsToASCII(e){return String.fromCharCode(this.ASCIITable[e])}addCharacter(e){this.rootNode&&!this.props.isStatic()&&(this.rootNode.setRangeText(e,this.rootNode.selectionStart,this.rootNode.selectionEnd,"end"),this.props.onInput(this.rootNode.value))}isSixKeyInput(){return typeof this.props.sixKeyInput=="function"&&this.props.sixKeyInput()}};var{If:lL}=Ga.Components,co=class extends Ga.Class{init(){this.currentBrailleValue=this.getBrailleFromLatex(this.props.latex()),this.currentBrailleMode=this.props.mode(),this.hasTranslationError=!1,this.currentLatex=this.props.latex()}isFocused(){return this.brailleInput!==void 0&&document.activeElement==this.brailleInput}getBrailleShouldFocus(){return this.props.mode()!=="none"&&this.props.brailleShouldFocus&&this.props.brailleShouldFocus()}isStatic(){return!!this.props.isStatic&&this.props.isStatic()}isInline(){return!!this.props.isInline&&this.props.isInline()}hasError(){return!!this.props.hasError&&this.props.hasError()}willUpdate(){let e=this.currentLatex!==this.props.latex(),t=this.props.mode(),i=t!==this.currentBrailleMode&&t!=="none";this.isFocused()&&!e&&!i||(this.currentLatex=this.props.latex(),(i||!this.hasTranslationError||e||this.isStatic())&&(this.currentBrailleValue=this.getBrailleFromLatex(this.props.latex()),this.hasTranslationError=!1),this.currentBrailleMode=t)}onBrailleInput(e){if(!this.props.onBrailleInput)return;let t=this.getLatexFromBraille(e);this.hasTranslationError=t.isError;let i=this.props.capExpressionSize&&this.props.capExpressionSize();if(!t.isError&&i&&i.exceedsLimit(t.value)){i.onExpressionSizeExceeded();return}this.currentBrailleValue=e,t.isError||(this.currentLatex=t.value,this.props.onBrailleInput(t.value))}getBrailleFromLatex(e,t=!1){let i=vb(e,this.props.mode(),this.props.operatorNames&&this.props.operatorNames());return i.isError?"":t?i.value:Ba.toExpandedBrailleAscii(i.value)}getLatexFromBraille(e){return g0(Ba.coerceToSixDotCells(e),this.props.mode(),this.props.operatorNames&&this.props.operatorNames())}getBrailleLabel(e){return this.getBrailleFromLatex(e.replace(/\s/,"\\ "))}shouldShowBraille(){let e=this.props.mode();return e==="nemeth"||e==="ueb"}isOverflowingLeft(){return this.brailleInput?this.brailleInput.scrollLeft>0:!1}isOverflowingRight(){if(!this.brailleInput)return!1;let e=this.brailleInput.getBoundingClientRect().width,t=this.brailleInput.scrollWidth,i=this.brailleInput.scrollLeft;return t>e+i+2}didMountBrailleInput(e){this.brailleInput=e}didUnmountBrailleInput(){this.brailleInput=void 0}handleBrailleFocusChanged(e,t){this.props.onBrailleFocusedChanged&&this.props.onBrailleFocusedChanged(e,t),this.brailleInput&&(e&&this.props.selectOnFocus&&this.props.selectOnFocus()&&this.brailleInput.select(),this.isStatic()&&this.brailleInput.scrollTo(0,0))}getTooltipText(){let e=this.props.placeholder&&!this.isFocused()?this.props.placeholder():"";return Ks(this.props.latex()||e)}template(){return Ga.createElement("div",{class:Ga.const("dcg-mathquill-wrapper")},Ga.createElement(lL,{predicate:()=>this.shouldShowBraille()},()=>Ga.createElement("div",{class:()=>({"dcg-mathquill-braille":!0,"dcg-focus":this.getBrailleShouldFocus(),"dcg-invalid":this.hasError(),"dcg-mathquill-static-braille":this.isStatic(),"dcg-mathquill-braille-overflow-left":this.isOverflowingLeft(),"dcg-mathquill-braille-overflow-right":this.isOverflowingRight()}),"data-dcg-label":()=>this.props.dataLabelAttributeValue?this.props.dataLabelAttributeValue():void 0},Ga.createElement(ab,{tooltip:()=>this.getTooltipText(),gravity:this.const("s"),delay:this.const(0),showOnTapstart:this.const(!0)},Ga.createElement(lL,{predicate:()=>this.isInline()},()=>Ga.createElement("span",{class:Ga.const("dcg-inline-braille")},()=>Ks(this.getBrailleFromLatex(this.props.latex(),!0)))),Ga.createElement(lL,{predicate:()=>!this.isInline()},()=>Ga.createElement(Ng,{ariaLabel:()=>Ks(this.props.ariaLabel?this.getBrailleLabel(this.props.ariaLabel()):""),didMount:this.bindFn(this.didMountBrailleInput),didUnmount:this.bindFn(this.didUnmountBrailleInput),onFocusedChanged:this.bindFn(this.handleBrailleFocusChanged),shouldFocus:this.bindFn(this.getBrailleShouldFocus),onKeydown:this.props.onBrailleKeydown,onInput:this.bindFn(this.onBrailleInput),sixKeyInput:this.props.sixKeyInput,value:()=>this.currentBrailleValue,placeholder:()=>Ks(this.props.placeholder?this.getBrailleFromLatex(this.props.placeholder()):""),tabindex:()=>this.props.tabindex?this.props.tabindex():0,isStatic:this.bindFn(this.isStatic),size:()=>this.currentBrailleValue&&this.currentBrailleValue.length||1}))))),Ga.createElement("div",{class:Ga.const("dcg-typeset-math"),style:()=>({display:this.shouldShowBraille()&&!this.isInline()?"none":void 0}),"aria-hidden":()=>this.shouldShowBraille()},this.children))}};function Gs(){if(!(!document.activeElement||!document.activeElement.classList.contains("dcg-braille-input")))return document.activeElement}function Db(r){return!r||r.value===""}function lZ(r){for(let e in r)return!1;return!0}function cZ(r){var i;if(r.type!=="expression")return;let e=r.formula.assignment;return e||((i=r.formula.geometry)==null?void 0:i.identifier)}function dZ(r){var t,i;let e={lookupIdentifier:{},lookupCalcId:{}};for(let o of r){let n={calcId:o.id,identifier:cZ(o),referencesTheseIdentifiers:{},referencedByTheseCalcIds:{}};e.lookupCalcId[n.calcId]=n,n.identifier&&(e.lookupIdentifier[n.identifier]=n)}for(let o of r){let n=e.lookupCalcId[o.id];if(n){if(o.type==="expression"){o.folderId===__dcg_shared_module_exports__['ad']&&(n.isGarbageCollectable=!o.readonly,(o.latex.indexOf("\\operatorname{segments}")!==-1||Od(o))&&(n.deleteIfNotReferenced=!0));let a=(i=(t=o.formula.geometry)==null?void 0:t.call)==null?void 0:i.parents;a&&a.forEach(s=>{if(!s)return;let l=s[0];ZK(e,n,l)})}Tf(o,a=>{var s=a.match(/(\\token{[0-9]+})/g);if(s)for(let l of s){let c=__dcg_shared_module_exports__['jb'](l);c!==n.identifier&&ZK(e,n,c)}})}}return e}function ZK(r,e,t){e.referencesTheseIdentifiers[t]=!0;let i=r.lookupIdentifier[t];i&&(i.referencedByTheseCalcIds[e.calcId]=!0)}function pZ(r,e,t){var c;let i=[];for(let p of e){let u=r.lookupCalcId[p];if(u){i.push(u);var o=u.referencesTheseIdentifiers;for(let m in o){let h=r.lookupIdentifier[m];h&&delete h.referencedByTheseCalcIds[u.calcId]}}}var n={};for(let p in t)for(let u of t[p]){let m=r.lookupIdentifier[u];m&&delete m.referencedByTheseCalcIds[p],n[u]=!0}var a={};for(let p of i){let u=p.referencesTheseIdentifiers;for(let h in u)n[h]=!0;let m=p.identifier;if(m){var s=(c=r.lookupIdentifier[m])==null?void 0:c.referencedByTheseCalcIds;if(s)for(let h in s){let x=r.lookupCalcId[h];x&&x.isGarbageCollectable&&(a[h]=!0)}}}for(let p in n){let u=r.lookupIdentifier[p];if(u&&u.deleteIfNotReferenced){var l=u.referencedByTheseCalcIds;u.calcId&&u.isGarbageCollectable&&lZ(l)&&(a[u.calcId]=!0)}}for(let p of i)delete r.lookupCalcId[p.calcId],p.identifier&&delete r.lookupIdentifier[p.identifier];return Object.keys(a)}function e4(r,e,t){var c,p;let i=r.getAllItemModels(),o=e.map(u=>u.id),n=dZ(i.concat(e));var a={};let s={};for(let u in t){let{nextLatex:m}=t[u],h=r.getItemModel(u);if((h==null?void 0:h.type)!=="expression")continue;let x={};for(let D of((p=(c=h.formula.geometry)==null?void 0:c.call)==null?void 0:p.parents)||[]){if(!D)continue;let[k]=D;x[k]=!0}for(let D in x)Ic(m,__dcg_shared_module_exports__['hb'](D))&&delete x[D];let C=Object.keys(x);C.length&&(s[u]=C)}let l=Object.keys(s).length>0;for(;o.length||l;){l=!1,o=pZ(n,o,s);for(let u of o)a[u]=!0}return Object.keys(a)}var t4={version:$l,randomSeed:"",graph:{product:"graphing-3d",threeDMode:!0,viewport:__dcg_shared_module_exports__['a']({},__dcg_shared_module_exports__['W'])},expressions:{list:[{id:"1",type:"expression"}]}};function m0(r){return/^\s*https?:\/\/([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/calculator\/./.test(r)}function cL(r){return/^\s*https?:\/\/([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/(geometry|geometry-beta)\/./.test(r)}function dL(r){return/^\s*https?:\/\/([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/3d\/./.test(r)}function pL(r){return/^\s*https?:\/\/([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/geometry-legacy\/./.test(r)}function r4(r){return m0(r)?"graphing":cL(r)?"geometry-calculator":pL(r)?"geometry":dL(r)?"graphing-3d":void 0}function i4(r){return/^\s*https?:\/\/([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/geo-states\/./.test(r)}var Co=__dcg_shared_module_exports__['h'](z()),f0=class extends Co.Class{template(){return Co.createElement("form",{name:Co.const("open_graph_on_web"),target:Co.const("_blank"),method:Co.const("POST"),action:()=>this.props.saveURL(),style:()=>({display:"none"})},Co.createElement("input",{type:Co.const("text"),name:Co.const("is_open_on_web"),value:Co.const("true")}),Co.createElement("input",{type:Co.const("text"),name:Co.const("my_graphs"),value:Co.const("false")}),Co.createElement("input",{type:Co.const("text"),name:Co.const("is_update"),value:Co.const("false")}),Co.createElement("input",{type:Co.const("text"),name:Co.const("calc_state"),value:()=>this.props.stateData()}),Co.createElement("input",{type:Co.const("text"),name:Co.const("thumb_data"),value:()=>this.props.thumbData()}))}};var o4,n4=(o4=new URLSearchParams(window.location.search).get("translucent-opacity"))!=null?o4:"0.8";function gL(r){switch(r){case"parallel":case"perpendicular":case"compass":return!0}return!1}function a4(r){var e;switch(r.type){case"tick":return!1;case"tick-ticker":return!1;case"on-evaluator-changes":return!!((e=r.eventUpdates)!=null&&e.userAction);default:return!0}}var Bg=class{constructor(e){this.__nextItemId=0;this.__pendingImageUploads={};this.__lastSelectedIdsForPropagation={};this.nextSubscription=0;this.subscriptions={};this._queuedCallbacks=[];this._hasUnsavedChanges=!1;this.shouldScrollSelectedItemIntoViewAfterDispatch=!1;this.lastParsableObjects={};this.isExpressionSearchStrValidForReplace=!1;this.isExpressionReplaceStrValidForReplace=!1;this.expressionSearchCount=0;this.expressionSearchOpen=!1;this.geoUIActive=!1;this.showConstructionsOpen=!1;this.show3DNotice=!1;this.showTermsNotice=!1;this.activeTool="selection";this.geometryGettingStartedMessageState="pick-a-tool";this.activeTokens={selected:void 0,hovered:void 0};this.apiMethodCallStackInfo={apiMethodCallDepth:0,withHistoryReplacementDepth:0};this.canShowKeyboardShortcuts=!1;this.toastData={};this.s=jl(()=>this.graphSettings.config.language);this.raw=(e,t)=>Ks(e,t);this.hasTranslation=e=>{let t=this.graphSettings.config.language;return XV(e,t)};this.unpack=e=>{let t=this.graphSettings.config.language;return kd(e,t)};this.dispatch=e=>{if(e.type==="blur-focus-location"&&this.dispatcher.isDispatching()){this.runAfterDispatch(()=>{this.dispatch(e)});return}if(e.type==="set-focus-location"&&this.dispatcher.isDispatching()){this.runAfterDispatch(()=>{this.dispatch(e)});return}if(e.type==="tick"&&this.dispatcher.isDispatching()){this.runAfterDispatch(()=>{this.dispatch(e)});return}e.type==="tick"||rg("dispatch::"+this.bugsnagContext,{type:e.type}),this.dispatcher.isDispatching()&&rg("dispatch-in-dispatch::"+this.bugsnagContext,{type:e.type}),this.dispatcher.dispatch(e),this.onEventsEmitted&&this.onEventsEmitted(this.enqueuedEvents);let t;for(;t=this._queuedCallbacks.shift();)t()};this._requiresTickNextFrame=!1;this.cachedGeoTokenDepths={};this.cachedGeoTokenInfo={};this.toolPreviewJSONState={};this.updateViews=()=>{for(var e in this.subscriptions)this.subscriptions[e]()};this.bugsnagContext="";this.inPrintMode=!1;this.lastInfiniteScrollFirstDOM=void 0;this.lastInfiniteScrollLastDOM=void 0;this.hasDispatchSinceLastInfiniteScrollUpdate=!1;this.stateStack=new tu;this.isCurrentlyDoingSetState=!1;this.isCurrentlyDoingRestoreState=!1;this.getQuestIsActive=()=>!1;var t,i;this.graphSettings=e,(i=(t=this.graphSettings).setController)==null||i.call(t,this),this.listModel=O3(this),this.layoutModel=iL(this.graphSettings.config),this.layoutMeasurements={width:0,height:0},this.settingsViewModel=oL(),this.geometryToolbarModel=M3(),this.imageRetryState={lastAttemptTime:0,attempts:0},this.makeGeoAPI(),this.setupDispatcher()}has3DNotice(){return this.show3DNotice}hasTermsNotice(){return this.showTermsNotice}hasUnsavedChanges(){return this._hasUnsavedChanges}getExpressionSearchOpen(){return this.expressionSearchOpen}getShowConstructionsOpen(){return this.showConstructionsOpen}getGeoToolbarSuppressedByAuthor(){return this.geometryToolbarModel.toolbar==="none"&&!this.shouldShowAuthorFeatures()}shouldShowGeoToolbar(){return this.isGeoUIActive()&&!this.getGeoToolbarSuppressedByAuthor()}isGeoUIActive(){return this.geoUIActive}isGeoToolActive(){return this.activeTool!=="selection"&&this.activeTool!=="box-selection"}getActiveTool(){return this.activeTool}canExpandListForItem(e){let t=this.getItemModel(e);return t?!this.isGeometry()||this.activeTool!=="selection"&&this.activeTool!=="box-selection"||this.isClickableId(e)||"label"in t&&t.label!=="":!1}getGeoModel(){return this.geoModel}getGeoToolbarGroupKeys(){return tk(this.geometryToolbarModel,this.shouldShowAuthorFeatures()).groups}getGeoToolbarItemsForGroup(e){let{items:t}=tk(this.geometryToolbarModel,this.shouldShowAuthorFeatures());return t[e]}getAllVisibleGeoToolbarItems(){let e=this.getGeoToolbarGroupKeys(),t=[];for(let i of e){let o=this.getGeoToolbarItemsForGroup(i);o&&t.push(o)}return t}getTickerOpen(){return this.areActionsEnabled()?this.listModel.ticker.open:!1}getTickerPlaying(){return this.areActionsEnabled()?this.listModel.ticker.playing:!1}hasVisibleToast(){return!__dcg_shared_module_exports__['Q'](this.toastData)}hasVisibleAndUndoableToast(){return typeof this.toastData.undoCallback=="function"}toastUndo(){typeof this.toastData.undoCallback=="function"&&(this.toastData.undoCallback(),this.dispatch({type:"toast/close"}))}runAfterDispatch(e){this.dispatcher.isDispatching()?this._queuedCallbacks.push(e):e()}enqueueEvent(e,t){var n;let i=this.apiMethodCallStackInfo.apiMethodCallDepth>0,o=t&&!i&&a4(t)||!!((n=this.enqueuedEvents[e])!=null&&n.isUserInitiated)||e==="userMovedPoint";this.enqueuedEvents[e]={isUserInitiated:o}}pushWithHistoryReplacement(){this.apiMethodCallStackInfo.withHistoryReplacementDepth++}popWithHistoryReplacement(){if(this.apiMethodCallStackInfo.withHistoryReplacementDepth--,this.apiMethodCallStackInfo.withHistoryReplacementDepth<0)throw new Error("Programming Error: withHistoryReplacementDepth < 0")}pushAPIMethodCall(){this.apiMethodCallStackInfo.apiMethodCallDepth++}popAPIMethodCall(){this.apiMethodCallStackInfo.apiMethodCallDepth--}getGrapherDimensions(){let e=this.getGrapher();if(!e)return{width:0,height:0};let{width:t,height:i}=e.getProjection().screen;return{width:t,height:i}}setRandomSeed(e){this.graphSettings.setProperty("randomSeed",e)}getRandomSeed(){return this.graphSettings.randomSeed}shouldDispatchTickNextFrame(){return!!this._requiresTickNextFrame}markTickRequiredNextFrame(){this._requiresTickNextFrame=!0}handleTick(e){this.areActionsEnabled()&&x3(this.listModel.ticker,{currentFrameTime:e,previousFrameTime:this.lastFrameTime})?this.dispatch({type:"tick-ticker",time:e}):this.shouldDispatchTickNextFrame()&&this.dispatch({type:"tick",time:e}),this.getGeoModel().isFading()&&this.requestRedrawGraph(),this.lastFrameTime=e}setupDispatcher(){this.dispatcher=new Zd,this.dispatcher.register(e=>{var l;let t=this.getSelectedItem(),i=this.getFocusLocation();this.shouldScrollSelectedItemIntoViewAfterDispatch=!1;let o;this.enqueuedEvents={change:void 0,graphReset:void 0,clearUnsavedChanges:void 0,openDrawer:void 0,showHotkeysModal:void 0,userMovedPoint:void 0,userClickedObject:void 0,userEditedLabel:void 0},e.type==="tick"&&(this._requiresTickNextFrame=!1),this.isCurrentlyDoingSetState=!1,this.isCurrentlyDoingRestoreState=!1,this.handleDispatchedAction(e),this.constrainMultiSelect(),this.updateTheComputedWorld();var n=this.getImageToRetry();(this.getPlayingSliders().length>0||this.isDragDropActive()||n)&&this.markTickRequiredNextFrame(),n&&this.retryLoadingFailedImage(n),this.updateGeometryGettingStartedMessageState(),e.type!=="undo"&&e.type!=="redo"&&!this.isDragDropActive()&&this.commitUndoRedoSynchronously(e),this.requestParseForAllItems(),this.isCurrentlyDoingSetState=!1,this.isCurrentlyDoingRestoreState=!1,this.enqueuedEvents.change&&((l=this.getGrapher2d())==null||l.markLabelsDirty()),this.enqueuedEvents.clearUnsavedChanges?this._hasUnsavedChanges=!1:this.enqueuedEvents.change&&(this._hasUnsavedChanges=!0);let a=this.getSelectedItem();a?(!t||t.guid!==a.guid)&&(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0):this.shouldScrollSelectedItemIntoViewAfterDispatch=!1;let s=this.getFocusLocation();s&&!__dcg_shared_module_exports__['P'](s,i)&&this.getFocusedItem()==a&&(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0),i&&t&&t.type==="table"&&i.type==="table"&&(!s||s.type!=="table"||i.id!==s.id)&&t.isExpanded&&(zf(t,!1),s||(o=t)),s&&a&&a.type==="table"&&D5(a),(e.type==="adjust-slider-by-dragging-thumb"||e.type==="adjust-slider-by-keyboard")&&(o=this.getItemModel(e.id)),this.updateRenderShellsBeforePaint(),this.updateViews(),o?this.scrollItemIntoView(o):this.shouldScrollSelectedItemIntoViewAfterDispatch&&this.scrollSelectedItemIntoView(),this.updateDragDrop(),this.updateRenderShellsAfterDispatch()})}updateGeometryGettingStartedMessageState(){if(!this.isGeometry())return;let e=this.geometryGettingStartedMessageState,t=this.getActiveTool(),i=t==="selection"||t==="box-selection"||t==="expression-edit";if(e==="hidden")return;if(this.isGraphSettingsOpen()||this.getGraphSettings().showGrid||this.getGraphSettings().showYAxis){this.geometryGettingStartedMessageState="hidden";return}let o=this.getItemModelByIndex(1);if(this.getItemCount()>2||!o||o.type!=="expression"||o.latex!==""||this.geoModel.getNonObjectsState().ui.currentTool.inputIndex>0){this.geometryGettingStartedMessageState="hidden";return}i||(this.geometryGettingStartedMessageState="construct")}getGeometryGettingStartedMessageState(){return this.geometryGettingStartedMessageState}handleDispatchedAction(e){var p,u,m,h,x,C,D,k,M,I,S,V,P;switch(e.type){case"render":break;case"undo":this.isGeoToolActive()&&this.cancelGeoToolplay(),this.undo();break;case"redo":this.isGeoToolActive()&&this.cancelGeoToolplay(),this.redo();break;case"clear-undoredo-history":this.clearUndoRedoHistory();break;case"on-special-key-pressed":e.key==="Enter"?ZA(this):e.key==="Up"?YA(this):e.key==="Down"?JA(this):e.key==="Backspace"?XA(this):e.key==="Delete"&&QA(this);break;case"select-previous-expression":sk(this.listModel);break;case"select-next-expression":lk(this.listModel);break;case"toggle-label-for-all-selected-points":this.toggleLabelForAllSelectedObjects();break;case"update-all-selected-items":{let b=e.update;if(e.update.prop==="folderId"){let A;if(e.update.createFolder){A=this.generateId();let ae=this.createItemModel({type:"folder",id:A,title:e.update.value}),ie=this.getItemCount()-1,de=Mf(this.listModel,ie);de&&de.type==="expression"&&de.latex===""?this._toplevelReplaceItemAt(this.getItemCount()-1,ae,!1):Rc(this.listModel,ae)}else A=e.update.value;let E=this.getItemModel(A);if(!E||E.type!=="folder")return;let J={},j={};this.getAllSelectedItems().forEach(ae=>{var ie;if(!(ae.type==="folder"||ae.folderId===A)&&(J[ae.id]=ae,ae.type==="expression")){let de=(ie=ae.formula.geometry)==null?void 0:ie.call;if(de&&de.symbol==="apply"){let Ie=de.parents[0]&&de.parents[0][0];Ie&&(j[Ie]=!0)}}});for(let ae in j){let ie=_f(this.listModel,ae);ie.length===1&&ie[0].folderId!==A&&(J[ie[0].id]=ie[0])}let ce={},te=[];for(let ae in J){let ie=J[ae];te.push(ie)}te.forEach(ae=>{if(ae.type==="expression"){let ie=I1(ae);ie&&(ce[ae.id]=ie)}}),te.sort((ae,ie)=>ae.index-ie.index);let pe=this.findLastSubscriptForLetters();te.forEach(ae=>{if(ae.type==="expression"){var ie=ce[ae.id];if(ie){let de=this.getAutonameLatexForExpression(ae,pe);Ju(this.listModel,ie,de)}}}),te.forEach(ae=>{Nf(this.listModel,ae.id)});let he=E.index+this.getNumberOfItemsInFolder(A)+1;te.forEach(ae=>{Dl(this.listModel,ae,he),he+=1}),te.forEach(ae=>{sa(ae,A)})}else if(b.prop==="visible")this.getAllSelectedItems().forEach(A=>{this._setItemHidden(A.id,!b.value),b.value===!1&&A.type==="expression"&&ag(A,!1)});else if(e.update.prop==="color"){let A=e.update.value;this.getAllSelectedItems().forEach(E=>{E.type==="expression"&&wS(E,A)})}else if(e.update.prop==="colorLatex"){let A=e.update.value;this.getAllSelectedItems().forEach(E=>{E.type==="expression"&&Ix(E,A)})}else if(e.update.prop==="showLabel"){let A=e.update.value;this.getAllSelectedItems().forEach(E=>{E.type==="expression"&&ag(E,A)})}else if(e.update.prop==="label"){let A=e.update.value;this.getAllSelectedItems().forEach(E=>{E.type==="expression"&&Rp(E,A)})}else if(e.update.prop==="dragMode"){let A=e.update.value;this.getAllSelectedItems().forEach(E=>{E.type==="expression"&&sg(E,A)})}else if(e.update.prop==="lineWidth"){let A=e.update.value;this.getAllSelectedItems().forEach(E=>{E.type==="expression"&&ff(E,A)})}else if(e.update.prop==="lineOpacity"){let A=e.update.value;this.getAllSelectedItems().forEach(E=>{E.type==="expression"&&mf(E,A)})}else if(e.update.prop==="lineStyle"){let A=e.update.value;this.getAllSelectedItems().forEach(E=>{E.type==="expression"&&DS(E,A)})}else if(e.update.prop==="strictIntersection"){let A=e.update.value;this.getAllSelectedItems().forEach(E=>{E.type==="expression"&&rN(E,A)})}}break;case"delete-all-selected-items":{let{deletedItems:b,readonlyItemsNotDeleted:A}=sM(this.listModel,Object.keys(this.getSelectedExpressionIds()));this.garbageCollectGeo(b,{}),this.ensureAtLeastOneVisibleItem(),(b.length>0||A.length>0)&&be(this.s("graphing-calculator-narration-items-deleted",{count:new Vo(b.length),locked:new Vo(A.length)}));break}case"upward-delete-selected-expression":eL(this,{moveSelection:!1});break;case"downward-delete-selected-expression":tL(this,{moveSelection:!1});break;case"table-show-more-rows":{let b=this.getItemModel(e.id);if(!b||b.type!=="table")return;let A=fg(b);if(!A)return;Zr(this.listModel,b),zf(b,!0),Fi(this,{type:"table",id:b.id,location:{row:A.min,column:0}})}break;case"navigate-table-by-key":RK(this,e.id,e.key);break;case"delete-item-and-animate-out":this._deleteItemAndAnimateOut(e.id,e.setFocusAfterDelete);break;case"finish-deleting-item-after-animation":this._finishDeletingItemAfterAnimation(e.id,e.setFocusAfterDelete);break;case"expression-zoom-fit":this._expressionZoomFit(e.id,e.focusAfterTap);break;case"set-expression-properties-from-api":this._setExpressionPropertiesFromAPI(e.id,e.properties);break;case"add-item-to-end-from-api":this._addItemToEndFromAPI(this.createItemModel(e.state));break;case"duplicate-expression":{let b=this.getItemModel(e.id);if(!b||b.type==="folder")return;this.copyExpressionToIndex(b,b.index+1)}break;case"duplicate-folder":{let{id:b}=e,A=this.getItemModel(b);if(!A||A.type!=="folder")return;let E=this.createItemModel(__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},KS(A,{stripDefaults:!1})),{id:this.generateId()})),J=this.getNumberOfItemsInFolder(b),j=J+1;this._toplevelInsertItemAt(A.index+j,E,!1,void 0);let ce=A.index+1,te=ce+J;for(let pe=ce;pe<=te;pe++){let he=Mf(this.listModel,pe);if(!he||he.type==="folder")return;this.copyExpressionToIndex(he,pe+j,E.id)}}break;case"insert-item-at-index":{let b=this.createItemModel(e.state);this._toplevelInsertItemAt(e.index,b,e.focus,e.folderId)}break;case"new-expression-at-end":{this.setGeoTool("selection");let b=this.createItemModel({type:"expression",id:this.generateId(),color:this.getNextColor()});this.setEditListMode(!1),Rc(this.listModel,b),yn(this,b.id)}break;case"new-expression":{let b=this.createItemModel({type:"expression",id:this.generateId(),color:this.getNextColor()});this.setEditListMode(!1),this._toplevelNewItemAtSelection(b,{shouldFocus:!0}),this._closeAddExpression()}break;case"new-text":{let b=this.createItemModel({id:this.generateId(),type:"text"});this._toplevelNewItemAtSelection(b,{shouldFocus:!0}),this._closeAddExpression()}break;case"new-folder":{let b=this.createItemModel({type:"folder",id:this.generateId()});this._toplevelNewItemAtSelection(b,{shouldFocus:!0}),this._closeAddExpression()}break;case"new-images":this._uploadImagesAndWaitForThemToLoad({files:e.files}),this._closeAddExpression();break;case"change-image":this._uploadImagesAndWaitForThemToLoad({files:e.files,id:e.id});break;case"new-table":{let b=this._createTableItem();this._toplevelNewItemAtSelection(b,{shouldFocus:!0}),this._closeAddExpression()}break;case"paste-table":this._pasteTable(e.data);break;case"insert-several-expressions":this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,this._insertSeveralExpressions(e.expressions);break;case"append-number-list":this._appendNumberList(e.latex);break;case"remove-item-by-id":Nf(this.listModel,e.id);break;case"replace-item-at-index":{let b=this.createItemModel(e.state);this._toplevelReplaceItemAt(e.index,b,e.focus)}break;case"create-sliders-for-item":this.createSlidersForItem(e.id,e.variables);break;case"create-sliders-for-ticker":this.createSlidersForTicker(e.variables);break;case"convert-image-to-draggable":this.convertImageToDraggable(e.id);break;case"start-dragdrop":{let b=this.getItemModel(e.dragTarget.calcId);if(!b)return;let A={x:0,y:0},E=this.getItemRootNodeById(b.id);if(E){let ce=E.getBoundingClientRect();A.y=e.grabPt.y-ce.top,A.x=e.grabPt.x-ce.left}this.isItemSelected(b.id)?Zr(this.listModel,b):Zr(this.listModel,void 0);let J=!1,j=1;b.type==="folder"&&(j+=this.getNumberOfItemsInFolder(b.id),b.collapsed||(J=!0,Cf(b,!0))),zx(this.listModel,{firstItemId:b.id,numberOfItems:j,expandFolder:J,grabOffset:A,mousePt:e.mousePt,dragTarget:e.dragTarget,renderType:e.dragTarget.type,itemTop:0,itemLeft:0}),this.dragdrop_expressions.startDragging(e.mousePt)}break;case"update-dragdrop":{let b=this.listModel.dragState;if(!b)return;zx(this.listModel,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},b),{mousePt:e.mousePt}))}break;case"stop-dragdrop":{let b=this.listModel.dragState;if(!b)return;let A=this.getItemModel(b.firstItemId);if(!A)return;A.type==="folder"&&b.expandFolder&&Cf(A,!1),zx(this.listModel,void 0),this.ensureAtLeastOneVisibleItem()}break;case"set-selected-id":{let b=this.getItemModel(e.id);Zr(this.listModel,b)}break;case"set-all-selected-ids":dM(this.listModel,e.ids);break;case"toggle-selected-with-multi-select":cM(this.listModel,e.id);break;case"set-selected-index":{let b=this.getItemModelByIndex(e.index);Zr(this.listModel,b)}break;case"set-none-selected":Zr(this.listModel,void 0);break;case"set-focus-location":{let b=e.location?e.location.type:"";if(b==="expression"&&this.setGeoTool("selection"),b==="table"&&(this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{inEditListMode:!1})),b==="graph-paper"){this.setGraphPaperFocus({isFocused:!0});break}Fi(this,e.location)}break;case"focus-first-expression":{this.focusFirstExpression();break}case"move-focus-to-item":yn(this,e.id,e.where);break;case"blur-focus-location":this.isFocusLocationFocused(e.location)&&Fi(this,void 0),((p=e.location)==null?void 0:p.type)==="graph-paper"&&this.setGraphPaperFocus({isFocused:!1});break;case"set-folder-collapsed":{let b=this.getItemModel(e.id);if(!b||b.type!=="folder")return;Cf(b,e.isCollapsed)}break;case"set-all-folders-collapsed":p5(this.listModel,e.isCollapsed);break;case"set-item-secret":{let b=this.getItemModel(e.id);if(!b)return;uM(b,e.isSecret)}break;case"set-item-readonly":{let{id:b,readonly:A}=e,E=this.getItemModel(b);if(!E)return;if(Ck(E,A),E.type==="folder")for(let J of N3(this.listModel,b))Ck(J,A)}break;case"set-tablecolumn-color":{let b=this.getItemModel(e.tableId);if(!b||b.type!=="table")return;q5(b,e.columnId,e.color)}break;case"set-tablecolumn-colorlatex":{let b=this.getItemModel(e.tableId);if(!b||b.type!=="table")return;gk(b,e.columnId,e.colorLatex)}break;case"set-show-cdf":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;DN(b,e.showCDF)}break;case"set-cdf-min":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;PS(b,e.latex)}break;case"set-cdf-max":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;_S(b,e.latex)}break;case"toggle-item-hidden":this._toggleItemHidden(e.id);break;case"toggle-tablecolumn-hidden":this._toggleTableColumnHidden(e.tableId,e.columnId);break;case"toggle-item-settings-menu":this.isItemSettingsMenuOpen(e.menu.guid)?this.closeItemSettingsMenu():(this.listModel.openItemMenu=e.menu,e.menu.focusFirstOption&&(e.menu.type==="geo-tool-dropdown"?Fi(this,{type:"geo-basic-tool-menu-item",tool:e.menu.tools[0]}):e.menu.type==="multi-select-more"||e.menu.type==="multi-select-transformations"?Fi(this,{type:"generic-menu",where:"start"}):Fi(this,{type:"expression-menu",id:e.menu.model.id,location:"start"})));break;case"close-item-settings-menu":this.closeItemSettingsMenu();break;case"toggle-fraction-evaluation":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;let A=Uu(b);jR(b,!A)}break;case"set-item-label":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;Rp(b,e.label),this.enqueueEvent("userEditedLabel",e)}break;case"set-item-showlabel":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;ag(b,e.showLabel),!e.showLabel&&!Wu(b)&&(Mx(b,!1),kS(b,"NONE"))}break;case"set-item-color":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;wS(b,e.color)}break;case"set-item-description":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression"&&b.type!=="image")return;b.type==="expression"?YR(b,e.description):b.type==="image"&&ZN(b,e.description)}break;case"set-item-fill":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;L1(b,e.fill),this._setItemHidden(b.id,yf(b))}break;case"set-image-opacity":{let b=this.getItemModel(e.id);if(!b||b.type!=="image")return;r3(b,e.opacity),this._setItemHidden(b.id,!1)}break;case"set-image-in-foreground":{let b=this.getItemModel(e.id);if(!b||b.type!=="image")return;J1(b,e.foreground)}break;case"image-upload-error":this.__pendingImageUploads[e.token]&&(delete this.__pendingImageUploads[e.token],this._showToast({message:this.s("graphing-calculator-text-toast-image-upload-failed")}));break;case"image-upload-success":{if(this.__pendingImageUploads[e.token])if(delete this.__pendingImageUploads[e.token],e.id){let b=this.getItemModel(e.id);b&&b.type==="image"&&i3(b,e.url)}else{let b=this.createItemModel({type:"image",id:this.generateId(),width:e.width,height:e.height,image_url:e.url,name:e.name});this._toplevelNewItemAtSelection(b,{shouldFocus:!1})}this.isUploadingImages()||(this.toastData={})}break;case"image-load-success":{let b=this.getItemModel(e.id);if(!b||b.type!=="image")return;YS(b,"loaded"),this.imageRetryState={lastAttemptTime:0,attempts:0}}break;case"image-load-error":{let b=this.getItemModel(e.id);if(!b||b.type!=="image")return;YS(b,"failed")}break;case"image-retry-loading":{let b=this.getItemModel(e.id);if(!b||b.type!=="image")return;Q1(b)}break;case"set-item-dragmode":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;sg(b,e.dragMode)}break;case"set-tablecolumn-dragmode":{let b=this.getItemModel(e.tableId);if(!b||b.type!=="table")return;B5(b,e.columnId,e.dragMode),e.dragMode!=="NONE"&&this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-points":{let b=this.getItemModel(e.tableId);if(!b||b.type!=="table")return;fM(b,e.columnId,e.bool),this._setTableColumnHidden(e.tableId,e.columnId,Tk(b,e.columnId))}break;case"set-tablecolumn-lines":{let b=this.getItemModel(e.tableId);if(!b||b.type!=="table")return;R5(b,e.columnId,e.bool),this._setTableColumnHidden(e.tableId,e.columnId,Tk(b,e.columnId))}break;case"set-tablecolumn-linestyle":{let b=this.getItemModel(e.tableId);if(!b||b.type!=="table")return;N5(b,e.columnId,e.lineStyle),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-linewidth":{let b=this.getItemModel(e.tableId);if(!b||b.type!=="table")return;dk(b,e.columnId,e.lineWidth),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-lineopacity":{let b=this.getItemModel(e.tableId);if(!b||b.type!=="table")return;pk(b,e.columnId,e.lineOpacity),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-pointsize":{let b=this.getItemModel(e.tableId);if(!b||b.type!=="table")return;uk(b,e.columnId,e.pointSize),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-pointopacity":{let b=this.getItemModel(e.tableId);if(!b||b.type!=="table")return;hk(b,e.columnId,e.pointOpacity),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-pointstyle":{let b=this.getItemModel(e.tableId);if(!b||b.type!=="table")return;F5(b,e.columnId,e.pointStyle),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-item-points":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;O1(b,e.points),this._setItemHidden(e.id,yf(b)),!e.points&&b.dragMode!=="NONE"&&sg(b,"NONE")}break;case"set-item-pointstyle":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;P1(b,e.pointStyle),this._setItemHidden(e.id,!1)}break;case"set-item-lines":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;_1(b,e.lines),this._setItemHidden(e.id,yf(b))}break;case"set-item-extend-to-3D":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;QR(b,e.extendTo3D),this._setItemHidden(e.id,!1);let A=(u=this.grapher3d)==null?void 0:u.transition;A&&e.extendTo3D&&(A.objectIdExtendingTo3D&&((m=this.grapher3d)==null||m.webglLayer.setZboundsOnSurfaces(A.objectIdExtendingTo3D,-1/0,1/0)),A.objectIdExtendingTo3D=b.id,A.startTime=-1,A.duration=150)}break;case"set-item-linestyle":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;DS(b,e.lineStyle),this._setItemHidden(e.id,!1)}break;case"set-item-arrow-mode":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;ZR(b,e.value),this._setItemHidden(e.id,!1);break}case"set-item-label-dropdown-open":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;XR(b,e.open)}break;case"set-item-fillopacity":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;Ex(b,e.fillOpacity),this._setItemHidden(e.id,!1)}break;case"set-item-lineopacity":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;mf(b,e.lineOpacity),this._setItemHidden(e.id,!1)}break;case"set-item-pointopacity":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;Gx(b,e.pointOpacity),b.showLabel||this._setItemHidden(e.id,!1)}break;case"set-item-pointsize":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;Tx(b,e.pointSize),this._setItemHidden(e.id,!1)}break;case"set-item-linewidth":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;ff(b,e.lineWidth),this._setItemHidden(e.id,!1)}break;case"set-item-resolution":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;vS(b,e.resolution),this._setItemHidden(e.id,!1)}break;case"set-item-checkers":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;CS(b,e.checkers),this._setItemHidden(e.id,!1)}break;case"set-item-polar-coordinate-system":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;JR(b,e.polarCoordinateSystem),this._setItemHidden(e.id,!1)}break;case"set-item-colorlatex":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;Ix(b,e.colorLatex)}break;case"set-item-labelSize":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;Vx(b,e.labelSize)}break;case"set-item-labelangle":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;SS(b,e.labelAngle)}break;case"set-item-label-orientation":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;F1(b,e.labelOrientation)}break;case"set-suppress-text-outline":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;eN(b,e.suppressTextOutline)}break;case"set-item-interactive-label":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;Mx(b,e.interactiveLabel),e.interactiveLabel&&kS(b,"NONE")}break;case"set-item-editable-label-mode":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;b.editableLabelMode!=="NONE"&&e.editableLabelMode!=="NONE"&&b.editableLabelMode!==e.editableLabelMode&&Rp(b,""),kS(b,e.editableLabelMode),e.editableLabelMode!=="NONE"&&Mx(b,!1)}break;case"plot-residuals":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;var t=b.formula.regression;if(!t)return;var i=t.residualSuggestionId;if(!i)return;var o=this.getItemModel(i);if(!o)return;Gk(o,{latex:__dcg_shared_module_exports__['hb'](t.residualVariable),columnIndex:o.columnModels.length-1})}break;case"toggle-logmode":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;var n=b.isLogModeRegression;A1(b,!n)}break;case"set-item-latex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;let A=e.latex,E=b.latex;if(this.garbageCollectGeo([],{[b.id]:{prevLatex:E,nextLatex:A}}),(A==='"'||A==="note")&&this.areNotesEnabled()){let J=this.createItemModel({id:this.generateId(),type:"text"});this._toplevelReplaceItemAt(b.index,J,!0)}else if(A==="")VN(b);else if(A==="ticker"&&this.canAddTicker())this.listModel.ticker.open=!0,this.focusLocation={type:"ticker",location:"handler"},this._removeExpressionSynchronously(b);else if(A==="folder"&&this.areFoldersEnabled()){let J=this.createItemModel({id:this.generateId(),type:"folder"});Ws(b)?(this._toplevelNewItemAtSelection(J,{shouldFocus:!0}),Cs(b,"")):this._toplevelReplaceItemAt(b.index,J,!0)}else if(A==="table"){let J=this._createTableItem();this._toplevelReplaceItemAt(b.index,J,!0)}else!this.isGeometry()&&(A==="betchacant"||A==="pride"||A==="teapot"&&this.is3dProduct())?this.runAfterDispatch(()=>{this.triggerEasterEgg&&this.triggerEasterEgg(A)}):(Cs(b,A),this.lastUserUpdatedExpressionItem=b)}break;case"set-visualization-prop":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;LR(b,e.prop,e.value)}break;case"set-clickableinfo-prop":{let b=this.getItemModel(e.id);if(!b)return;b.type==="expression"?OR(b,e.prop,e.value):b.type==="image"&&JS(b,e.prop,e.value)}break;case"set-clickableinfo-rule-latex":{let b=this.getItemModel(e.id);if(!b)return;b.type==="expression"?gS(b,e.latex):b.type==="image"&&d3(b,e.latex)}break;case"set-folder-title":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let b=this.getItemModel(e.id);if(!b||b.type!=="folder")return;ON(b,e.title)}break;case"set-image-mq-attribute":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let b=this.getItemModel(e.id);if(!b||b.type!=="image")return;$s(b,e.attribute,e.latex)}break;case"set-image-name":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let b=this.getItemModel(e.id);if(!b||b.type!=="image")return;e3(b,e.name)}break;case"set-image-draggable":{let b=this.getItemModel(e.id);if(!b||b.type!=="image")return;let A=Df(b);if(!A)return;Y1(b,e.draggable),e.draggable&&(Gi(A)==="NONE"||A.dragMode==="AUTO")&&sg(A,"XY")}break;case"set-graph-settings":{for(let b in e)b!=="type"&&(b==="xAxisScale"?this.switchAxisScale("xAxisScale",e.xAxisScale):b==="yAxisScale"?this.switchAxisScale("yAxisScale",e.yAxisScale):this.graphSettings.setProperty(b,e[b]));this.grapher3d&&this.isThreeDMode()&&(this.grapher2d.redrawAllLayersSynchronously(),"backgroundColor3d"in e&&this.grapher3d.webglLayer.setBackgroundColor(e.backgroundColor3d),this.apply3dProps(e))}break;case"set-polar-mode":if(this.graphSettings.setProperty("polarMode",e.polarMode),e.polarMode){let b=this.graphSettings.xAxisScale==="logarithmic"||this.graphSettings.yAxisScale==="logarithmic",A=this.getGrapher2d();b&&A&&(this.graphSettings.setProperty("xAxisScale","linear"),this.graphSettings.setProperty("yAxisScale","linear"),A.viewportController.setViewport(A.getDefaultViewport()),A.getProjection().updateScalePairs())}break;case"set-polar-domain-minlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;yx(b,e.latex)}break;case"set-polar-domain-maxlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;Cx(b,e.latex)}break;case"set-parametric-domain-minlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;xx(b,e.latex)}break;case"set-parametric-domain3Du-minlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;wx(b,e.latex)}break;case"set-parametric-domain3Dv-minlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;vx(b,e.latex)}break;case"set-parametric-domain-maxlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;Dx(b,e.latex)}break;case"set-parametric-domain3Du-maxlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;Sx(b,e.latex)}break;case"set-parametric-domain3Dv-maxlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;kx(b,e.latex)}break;case"set-note-text":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let b=this.getItemModel(e.id);if(!b||b.type!=="text")return;BN(b,e.text)}break;case"set-edit-list-mode":{let b=Ff(this.listModel);if(this.setEditListMode(e.isEditListMode),e.focusExpressionList){if(b===void 0&&(b=this.getItemModelByIndex(0)),!b)return;yn(this,b.id,b.type==="table"&&e.isEditListMode?"container":"start")}else Zr(this.listModel,void 0),Fi(this,void 0)}break;case"set-ghost-mode":this.getGraphSettings().config.setProperty("ghostMode",e.value);break;case"set-projector-mode":this.getGraphSettings().config.setProperty("projectorMode",e.value),this.isThreeDMode()&&this.grapher2d.redrawAllLayersSynchronously();break;case"set-inverted-colors":this.getGraphSettings().config.setProperty("invertedColors",e.value);break;case"set-tablecell-latex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let b=this.getItemModel(e.tableId);if(!b||b.type!=="table")return;qp(b,e.cell,e.latex)}break;case"set-state":this.externalSetState(e.state,e.opts);break;case"set-blank":this.externalSetState(this.getBlankState({degreeMode:e.degreeMode}),e.opts);break;case"clear-unsaved-changes":this.enqueueEvent("clearUnsavedChanges",e);break;case"reset-graph":{let b=this.getState();this.externalSetState(this.graphSettings.defaultState,{allowUndo:!0});let A=this.getItemModelByIndex(0);A&&yn(this,A.id,"end"),this._showToast({message:this.s("graphing-calculator-text-toast-graph-reset"),undoCallback:()=>this.dispatch({type:"set-state",state:b,opts:{allowUndo:!0}})}),this.enqueueEvent("graphReset",e)}break;case"clear-graph":{if(this.triggerClearGraph){this.runAfterDispatch(()=>this.triggerClearGraph());return}let b=this.getState();this.externalSetState(this.getBlankState(),{allowUndo:!0});let A=this.getItemModelByIndex(0);A&&yn(this,A.id,"end"),this._showToast({message:this.s("graphing-calculator-text-toast-graph-cleared"),undoCallback:()=>this.dispatch({type:"set-state",state:b,opts:{allowUndo:!0}})}),this.enqueueEvent("graphReset",e)}break;case"on-evaluator-changes":{if(this.onEvaluatorChangesSpy&&this.onEvaluatorChangesSpy(e.changes,e.timingData,e.graphData,e.eventUpdates),l5(this.listModel,e.changes),!e.graphData)break;for(let b in e.graphData.addedGraphs){let A=e.graphData.addedGraphs[b];if(__dcg_shared_module_exports__['Zb'](A)){let E=A.filter(j=>!__dcg_shared_module_exports__['nc'](j.graphMode)),J=A.filter(j=>__dcg_shared_module_exports__['nc'](j.graphMode));(h=this.grapher2d)==null||h.updateSketch(b,E),(x=this.grapher3d)==null||x.updateSketch(b,J),s5(this.listModel,b,A)}}for(let b in e.graphData.removedGraphs)(C=this.grapher2d)==null||C.removeGraphSketch(b),(D=this.grapher3d)==null||D.removeGraphSketch(b);if(this.isThreeDMode())(k=this.grapher2d)==null||k.redrawAllLayersSynchronously();else{for(let b in e.graphData.intersections){let A=e.graphData.intersections[b];__dcg_shared_module_exports__['Zb'](A)&&((M=this.grapher2d)==null||M.updateIntersections(b,A))}(I=this.get2dPOIController())==null||I.handleTraceUpdate(),(S=this.getAudioGraph())==null||S.handleEvaluatorChange(e.graphData)}if(e.eventUpdates){let b=!1;for(let A in e.eventUpdates.updates)if(this.doesIdentifierBlockActionUpdate(A)){b=!0;break}if(!b){for(let A in e.eventUpdates.updates)this.updateLatexForIdentifier(A,e.eventUpdates.updates[A]);e.eventUpdates.objectClicked&&this.enqueueEvent("userClickedObject",e),this.onActionUpdatesAppliedSpy&&this.onActionUpdatesAppliedSpy(e.eventUpdates)}}}break;case"add-helper-expression":J3(this.listModel,e.state);break;case"tick":this._tickSliders(e.time);break;case"tick-ticker":this.tickTicker(e.time);break;case"adjust-slider-by-keyboard":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;ER(b,e.adjustment)}break;case"adjust-slider-by-dragging-thumb":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;GR(b,e.target)}break;case"set-slider-minlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;uf(b,e.latex)}break;case"set-slider-maxlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;hf(b,e.latex)}break;case"set-slider-steplatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;bx(b,e.latex)}break;case"set-slider-dragging":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;fx(b,e.dragging)}break;case"play-slider-from-min":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;let A=xl(b);if(isNaN(A))return;let E=qu(b.latex,A);Hs(b,!1),Cs(b,E),Hs(b,!0)}break;case"set-slider-isplaying":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;Hs(b,e.isPlaying)}break;case"set-slider-loopmode":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;WR(b,e.loopMode)}break;case"set-slider-animationperiod":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression")return;$R(b,e.animationPeriod)}break;case"show-expressions-list":this._showExpressions(e.focusHideIcon);break;case"hide-expressions-list":this._hideExpressions(e.focusShowIcon);break;case"open-drawer":this.enqueueEvent("openDrawer",e);break;case"re-randomize":this.setRandomSeed(Sd());break;case"resize-exp-list":this._setExpListWidth(e.expListWidth);break;case"toast/show":this._showToast(e.toast);break;case"toast/close":this.closeToast();break;case"toast/undo":let L=this.toastData.undoCallback;L&&this.runAfterDispatch(L),this.toastData={};break;case"toast/learn-more":let B=this.toastData.learnMoreCallback;B&&this.runAfterDispatch(B),this.toastData={};break;case"start-moving-points":bK(this,this.listModel,e.points);break;case"stop-moving-points":xK(this,e.points);break;case"on-move-points":yK(this,e.points,e.previousScreenPts,e.screenPts,e.projection,e.transform,e.keyboardDirection)&&this.enqueueEvent("userMovedPoint",e);break;case"commit-user-requested-viewport":this._commitUserRequestedViewport(e.viewport);break;case"commit-user-requested-rotation":this.graphSettings.setProperty("worldRotation3D",e.worldRotation3D),this.graphSettings.setProperty("axis3D",e.axis3D),this.graphSettings.setProperty("speed3D",e.speed3D);break;case"toggle-lock-viewport":this.graphSettings.setProperty("userLockedViewport",!this.graphSettings.userLockedViewport);break;case"set-axis-limit-latex":this._setAxisLimitLatex(e.limit,e.latex),e.updateYZAlso&&(this._setAxisLimitLatex(e.limit==="xmin"?"ymin":"ymax",e.latex),this._setAxisLimitLatex(e.limit==="xmin"?"zmin":"zmax",e.latex)),this.lastDirectlyEditedViewport=(V=this.getGrapher())==null?void 0:V.getCurrentViewport();break;case"toggle-graph-settings":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{graphSettingsOpen:!this.layoutModel.graphSettingsOpen}),Zr(this.listModel,void 0),e.focusOnOpen&&(this.layoutModel.graphSettingsOpen?this.is3dProduct()?Fi(this,{type:"settings",location:"reverse-contrast"}):this.getGraphSettings().config.projectorMode?Fi(this,{type:"settings",location:"large-size"}):Fi(this,{type:"settings",location:"default-size"}):Fi(this,{type:"settings",location:"icon"}));break;case"close-graph-settings":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{graphSettingsOpen:!1}),e.focusIconAfterClose&&Fi(this,{type:"settings",location:"icon"});break;case"toggle-add-expression":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{addExpressionOpen:!this.layoutModel.addExpressionOpen}),e.focusOnOpen&&this.layoutModel.addExpressionOpen&&Fi(this,{type:"add-expression-btn"});break;case"close-add-expression":this._closeAddExpression(),e.focusIconAfterClose&&Fi(this,{type:"add-item-btn"});break;case"ui/container-resized":this.layoutMeasurements={width:e.size.width,height:e.size.height},this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;break;case"enter-printmode":this.inPrintMode=!0;break;case"exit-printmode":this.inPrintMode=!1;break;case"expression-size-exceeded":this._showToast({message:this.s("graphing-calculator-text-toast-expression-size-limit")});break;case"keypad/set-layout":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{keypadLayout:e.layout,keypadFunctionsOpen:!1});break;case"keypad/set-minimized":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{keypadMinimized:e.minimized,keypadLayout:"mainNumbers"}),this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,this.needsFakeKeypad()||PK(this),be(e.minimized?this.s("graphing-calculator-narration-keypad-hidden"):this.s("graphing-calculator-narration-keypad-visible"));break;case"keypad/type-text":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{keypadFunctionsOpen:!1}),this.runAfterDispatch(()=>{let b=_e.getFocusedMathquill();b&&_e.canAcceptText(b,this.getCapExpressionSize(),e.text)&&(b.typedText(e.text),_e.simulateUserChangedLatex(b))});break;case"keypad/press-key":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{keypadFunctionsOpen:!1}),this.runAfterDispatch(()=>{let b=_e.getFocusedMathquill();b&&_e.simulateKeypress(b,e.key)});break;case"keypad/audio-trace":this.handleAudioTraceCommand(e.command);break;case"set-audio-trace-speed":this.setAudioTraceSpeed(e.speed);break;case"keypad/custom-command":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{keypadFunctionsOpen:!1}),this.runAfterDispatch(()=>{let b=_e.getFocusedMathquill();b&&(wb(b,e.command,{capExpressionSize:this.getCapExpressionSize()}),_e.simulateUserChangedLatex(b))});break;case"keypad/shift":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{keypadLayout:NK(this.getKeypadLayout()),keypadFunctionsOpen:!1});break;case"keypad/123":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{keypadLayout:"mainNumbers",keypadFunctionsOpen:!1});break;case"keypad/abc":this.isQwertyKeyboardEnabled()?this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{keypadLayout:"letters",keypadFunctionsOpen:!1}):this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{keypadLayout:"noQwertyLetters",keypadFunctionsOpen:!1});break;case"keypad/audio":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{keypadMinimized:!1,keypadLayout:"audio",keypadFunctionsOpen:!1});break;case"keypad/functions":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{keypadFunctionsOpen:!this.isKeypadFunctionsPopoverOpen()});break;case"grapher/drag-start":break;case"grapher/drag-move":break;case"grapher/drag-end":break;case"open-on-web":this._openOnWeb();break;case"file-is-dragged-over":this.listModel.openItemMenu=void 0,this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{isFileDraggedOver:!0});break;case"file-is-not-dragged-over":this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{isFileDraggedOver:!1});break;case"zoom":(P=this.getGrapher())==null||P.viewportController.zoom(e.direction);break;case"set-hovered-image":{let b=this.getItemModel(e.id);if(!b||b.type!=="image")return;JS(b,"hoveredImage",e.url)}break;case"set-depressed-image":{let b=this.getItemModel(e.id);if(!b||b.type!=="image")return;JS(b,"depressedImage",e.url)}break;case"clickable-item-clicked":this.handleClickableItemClicked(e.id,e.listIndex);break;case"action-single-step":{let b=this.getItemModel(e.id);if(!b||b.type!=="expression"||!b.formula.action_value)return;this.evaluator.addActionStepEvent(b.id)}break;case"update-expression-search-str":this.updateExpressionSearchStr(e.str);break;case"update-expression-replace-str":this.updateExpressionReplaceStr(e.str);break;case"rename-identifier-global":this.suggestedIdentifierRename=void 0,Ju(this.listModel,e.search,e.replace);break;case"rename-identifier-in-item":this.suggestedIdentifierRename=void 0;let R=this.getItemModel(e.id);R&&R.type==="folder"?Ju(this.listModel,e.search,e.replace,{limitToFolder:e.id}):Ju(this.listModel,e.search,e.replace,{limitToItem:e.id});break;case"update-ticker-handlerlatex":this.updateTickerHandlerLatex(e.latex);break;case"update-ticker-minsteplatex":this.updateTickerMinStepLatex(e.latex);break;case"set-braille-mode":this.setBrailleMode(e.mode);break;case"set-six-key-input":this.setSixKeyInput(e.useSixKeyInput);break;case"set-show-constructions-open":if(this.showConstructionsOpen=e.open,e.setFocus)if(!e.open)Fi(this,{type:"geo-show-constructions-icon"});else for(let b in this.cachedGeoTokenInfo){let{calcId:A}=this.cachedGeoTokenInfo[b];if(this.getItemModel(A)){Fi(this,{type:"geo-token",identifier:b});break}}break;case"select-geo-tool":this.listModel.openItemMenu=void 0,this.clearRecentlyUsedComplexTool(),this.setGeoTool(e.tool),__dcg_shared_module_exports__['ac'](e.tool)||e.tool==="selection"||Zr(this.listModel,void 0),e.focusGraphPaper&&this.setGraphPaperFocus({isFocused:!0}),this.closeToast();break;case"cancel-geo-toolplay":this.cancelGeoToolplay();break;case"commit-geo-objects":{let b=[],A=[];var a=this.findLastSubscriptForLetters(),s={};let E=te=>{let pe=s[te];if(pe)return pe.assignmentLatex;let he=this.getItemModel(te);if(!he||he.type!=="expression")return te;var ae=this._autoNameExpression(he,a);return pe=s[te]={model:he,assignmentLatex:ae},pe.assignmentLatex},J=[];for(let te in e.committed){var l=e.committed[te];__dcg_shared_module_exports__['ac'](l.type)&&J.push(te);var c=QM(l,!0,E);c&&(c.sliderInfo?A.push({latex:c.latex,color:c.color,sliderInfo:c.sliderInfo}):b.push(__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},c),{tokenId:te})))}let j=this.listModel.__toolPreviewIdToModel;if(b.length){let te=this.getGeometryFolder(),pe=te?te.index+this.getNumberOfItemsInFolder(te.id)+1:0;b.forEach(he=>{var ie;let ae;for(let de in j){let Ie=j[de];if(((ie=Fo(Ie))==null?void 0:ie.latex)===he.tokenId){ae=Ie;break}}ae?(ae.latex=he.latex,ae.color=he.color,ae.showLabel=!!he.showLabel,ae.showAngleLabel=he.showAngleLabel!==!1,te&&(ae.folderId=te.id)):ae=this.createItemModel({id:this.generateId(),type:"expression",showLabel:he.showLabel,showAngleLabel:he.showAngleLabel,latex:he.latex,folderId:te&&te.id,color:he.color}),te?(Dl(this.listModel,ae,pe),pe+=1):Rc(this.listModel,ae),this.getGeoModel().recordCommittedOutput(ae.id),this.recordComplexToolUse()})}A.forEach(te=>{let pe;for(let he in j){let ae=j[he];if(ae.latex===te.latex){pe=ae;break}}pe?(pe.latex=te.latex,pe.color=te.color,uf(pe,te.sliderInfo.min),hf(pe,te.sliderInfo.max)):pe=this.createItemModel({id:this.generateId(),type:"expression",latex:te.latex,color:te.color,slider:{hardMin:!0,hardMax:!0,min:te.sliderInfo.min,max:te.sliderInfo.max}}),Dl(this.listModel,pe,0),this.getGeoModel().recordCommittedOutput(pe.id)}),J.length===1&&this.transformAllSelectedItemsByAssignmentLatex(J[0]),this.geoModel.isCurrentToolSingleUse()&&this.setGeoTool("selection");let ce=e.toolIdToLatex[1];if(this.geoModel.getToolMode()==="expression-edit"&&ce){let te=XM(ce,E);this.writeIdentifierIntoCurrentMathquill(te)}this.isGeometry()&&this.getGeoModel().updateFadeAnimations()}break;case"rename-identifier":{let b=e.from,A=e.to,E=__dcg_shared_module_exports__['jb'](b),J=this.getGeometryFolder();J&&this.getItemsByIdentifier(E).forEach(j=>{e.geoFolder&&j.folderId!==J.id?(sa(j,J.id),Xu(this.listModel,j.index,J.index+1,1)):!e.geoFolder&&j.folderId===J.id&&(Xu(this.listModel,j.index,J.index+this.getNumberOfItemsInFolder(J.id),1),sa(j,""))}),Ju(this.listModel,b,A)}break;case"set-active-token":this.activeTokens[e.style]=e.identifier;break;case"unset-active-token":this.activeTokens[e.style]===e.identifier&&(this.activeTokens[e.style]=void 0);break;case"select-expression-that-defines-token":{let b=this.getExpressionIdForIdentifier(e.identifier);if(!b||(this.setGeoTool("selection"),this.isItemNotSelectableBecauseItsSecret(b)))return;e.multiSelectMode||e.toggle?cM(this.listModel,b):this.tryInsertTokenIntoMathquill(b,void 0)||Zr(this.listModel,this.getItemModel(b))}break;case"close-expression-search":this.expressionSearchOpen=!1,this.updateExpressionSearchStr("");let W=this.getItemModelByIndex(0);W&&yn(this,W.id,"end");break;case"open-expression-search":this.expressionSearchOpen=!0,this.focusLocation={type:"search-expressions"};let re=e.latex;e.rename&&!ys(re)&&(re="");let ne=e.rename?re?`\\operatorname{rename}\\ ${re}\\to`:"\\operatorname{rename}\\ ":re;this.updateExpressionSearchStr(ne);break;case"open-ticker":this.listModel.ticker.open=!0,this.focusLocation={type:"ticker",location:"handler"},this._closeAddExpression();break;case"close-ticker":this.listModel.ticker.open=!1,this.listModel.ticker.playing=!1,this.listModel.ticker.minStepLatex="",this.listModel.ticker.handlerLatex="";break;case"toggle-ticker":this.listModel.ticker.playing=!this.listModel.ticker.playing,this.listModel.ticker.lastTickTime=void 0,this.pauseAllSliders();break;case"set-tool-preview-state":this.setToolPreviewState(e.state);break;case"apply-transformation-to-selected":this.transformAllSelectedItemsByAssignmentLatex(e.assignmentLatex),this.closeItemSettingsMenu();break;case"dismiss-3d-notice":this.show3DNotice=!1,e.focusFirstExpression&&this.focusFirstExpression();break;case"dismiss-terms-notice":this.showTermsNotice=!1,e.focusFirstExpression&&this.focusFirstExpression();break;case"set-geometry-toolbar":{A3(this.geometryToolbarModel,e.toolbar);break}case"set-geometry-custom-toolbar-setting":{ek(this.geometryToolbarModel,e.tool,e.value);break}case"set-author-mode":{this.setAuthorMode(e.enabled);break}case"set-translucent-surfaces":{this.getGraphSettings().config.setProperty("translucentSurfaces",e.value);break}default:return e}}switchAxisScale(e,t){var o;if(!t||t===this.graphSettings[e])return;this.graphSettings.setProperty("polarMode",!1);let i;this.getAllItemModels().forEach(n=>{if(this.isExpressionZoomFit(n)){if(!this.getBoundingBoxesForZoomFit(n))return;i=n.id}}),this.graphSettings.setProperty(e,t),(o=this.getGrapher2d())==null||o.getProjection().updateScalePairs(),!(i&&this._expressionZoomFit(i,!1,!0))&&this.enforceAxisLimitsForScale(e)}clearRecentlyUsedComplexTool(){clearTimeout(this.recentlyCompletedComplexToolTimeout),this.recentlyCompletedComplexToolTimeout=void 0}recordComplexToolUse(){let e=this.getActiveTool();gL(e)&&(clearTimeout(this.recentlyCompletedComplexToolTimeout),this.recentlyCompletedComplexToolTimeout=setTimeout(()=>{this.recentlyCompletedComplexToolTimeout=void 0,this.dispatch({type:"render"})},2e3))}getComplexToolWasRecentlyUsed(){return!!this.recentlyCompletedComplexToolTimeout}enforceAxisLimitsForScale(e){let t=this.getGrapher2d();if(!t)return;let i=t.getDefaultViewport();if(!i)return;e==="xAxisScale"?(this._setAxisLimitLatex("xmin",__dcg_shared_module_exports__['gb'](i.xmin)),this._setAxisLimitLatex("xmax",__dcg_shared_module_exports__['gb'](i.xmax))):(this._setAxisLimitLatex("ymin",__dcg_shared_module_exports__['gb'](i.ymin)),this._setAxisLimitLatex("ymax",__dcg_shared_module_exports__['gb'](i.ymax))),this.graphSettings.xAxisScale===this.graphSettings.yAxisScale&&(this.graphSettings.setProperty("lastChangedAxis",e==="xAxisScale"?"y":"x"),t.viewportController.zoomSquareImmediately(),this.markSquareAxesAfterUserEditedViewport());let o=t.viewportController.getViewport(),n=t.getProjection(),{xmin:a,xmax:s,ymin:l,ymax:c}=o,p=this.getGraphSettings().config.logScales;if(e==="xAxisScale"&&p){let u=n.mapx(a),m=n.mapx(s),h=Ei(n.reverse_mapx(u-.25),n.reverse_mapx(u+.25)),x=Ei(n.reverse_mapx(m-.25),n.reverse_mapx(m+.25));this._setAxisLimitLatex("xmin",__dcg_shared_module_exports__['gb'](h)),this._setAxisLimitLatex("xmax",__dcg_shared_module_exports__['gb'](x))}if(e==="yAxisScale"&&p){let u=n.mapy(l),m=n.mapy(c),h=Ei(n.reverse_mapy(u-.25),n.reverse_mapy(u+.25)),x=Ei(n.reverse_mapy(m-.25),n.reverse_mapy(m+.25));this._setAxisLimitLatex("ymin",__dcg_shared_module_exports__['gb'](h)),this._setAxisLimitLatex("ymax",__dcg_shared_module_exports__['gb'](x))}this.lastDirectlyEditedViewport=t.getCurrentViewport()}updateGraphSettingsViewportLimitsLatex(e){this._setAxisLimitLatex("xmin",e.xmin+""),this._setAxisLimitLatex("xmax",e.xmax+""),this._setAxisLimitLatex("ymin",e.ymin+""),this._setAxisLimitLatex("ymax",e.ymax+""),this._setAxisLimitLatex("zmin",e.zmin+""),this._setAxisLimitLatex("zmax",e.zmax+"")}transformAllSelectedItemsByAssignmentLatex(e){var m,h;let t=ak(this.listModel),i=this.findLastTokenNumber()+1,o=this.findLastSubscriptForLetters(),n=this.getGeometryFolder(),a=n?n.index+this.getNumberOfItemsInFolder(n.id)+1:0,s={};for(let x of t){if(x.type!=="expression")continue;var l=x.formula.geometry;if(!l)continue;var c=(m=x.formula.typed_constant_value)==null?void 0:m.valueType;if(!c||__dcg_shared_module_exports__['Pa'](c,__dcg_shared_module_exports__['Ba']))continue;var p=(h=Fo(x))==null?void 0:h.latex;p||(p=this._autoNameExpression(x,o));let C=`\\token{${i}}`;i+=1;let D=`${C}=${e}\\left(${p}\\right)`,k=this.createItemModel({id:this.generateId(),type:"expression",showLabel:x.showLabel&&!x.label,showAngleLabel:x.showAngleLabel&&!x.label,latex:D,folderId:n&&n.id,color:x.color});s[k.id]=!0,n?(Dl(this.listModel,k,a),a+=1):Rc(this.listModel,k)}let u=Object.keys(s);if(u.length&&dM(this.listModel,s),u.length===1){let x=u[0];this.runAfterDispatch(()=>{this.getItemModel(x)&&this.get2dPOIController().keyboardAttentionManager.updateKeyboardAttention({calcId:x,listIndex:void 0,polygonEdge:void 0},{describe:!1})})}}convertToTokenAssignment(e,t=""){var n;let i=(n=Fo(e))==null?void 0:n.latex,o=t?rx(t)||"":"\\token{"+(this.findLastTokenNumber()+1)+"}";i?Ju(this.listModel,i,o):Cs(e,o+"="+e.latex)}convertToNamedAssignment(e,t=""){let i=I1(e);if(!i)return;let o=t?rx(t):this.getAutonameLatexForExpression(e);o?Ju(this.listModel,i,o):Cs(e,t)}getAutonameLatexForExpression(e,t){if(t||(t=this.findLastSubscriptForLetters()),V1(e)==="point"&&e.label&&ys(e.label)&&this.countGlobalIdentifierOccurences(e.label)===0)return e.label;var i=qR(e),o=(t[i]||0)+1;return t[i]=o,i+"_{"+o+"}"}_autoNameExpression(e,t){let i=this.getAutonameLatexForExpression(e,t);return Cs(e,i+"="+e.latex),i}isGeoToolVisible(e,{ignoreAuthorMode:t}={ignoreAuthorMode:!1}){return!t&&this.shouldShowAuthorFeatures()?!0:dg(this.geometryToolbarModel,e)}isGeoToolEnabled(e,{ignoreAuthorMode:t}={ignoreAuthorMode:!1}){return!t&&this.shouldShowAuthorFeatures()?!0:Ef(this.geometryToolbarModel,e)}isSomeTransformToolVisible(){return lb.some(e=>this.isGeoToolVisible(e))}setGeoTool(e){if(!this.geoUIActive||this.activeTool===e||!this.isGeoToolEnabled(e))return;L3(this.geometryToolbarModel,e,this.shouldShowAuthorFeatures()),this.activeTool=e,this.getGeoModel().setToolMode(e),this.cancelGeoToolplay()}cancelGeoToolplay(){var t;let e=this.getGeoModel();e.cancelToolplay(),e.deselectAllObjects(),this.setToolPreviewState({}),(t=this.get2dPOIController())==null||t.cancelGeoToolplay()}setToolPreviewState(e){var i;this.toolPreviewJSONState=e;var t=this.listModel.__toolPreviewIdToModel;this.listModel.__toolPreviewIdToModel={};for(let o in e){let n=e[o],a=QM(n,!1);if(!a)continue;let s;for(let l in t){let c=t[n.type==="expression-edit-preview-latex"?Vf:l];if(((i=Fo(c))==null?void 0:i.latex)===o){s=c;break}}s?(s.latex=a.latex,s.color=a.color,s.showAngleLabel=!!a.showAngleLabel,s.hidden=n.hidden):s=yS({id:n.type==="expression-edit-preview-latex"?Vf:this.generateId(),type:"expression",color:a.color,latex:a.latex,showAngleLabel:!!a.showAngleLabel,hidden:n.hidden},this),this.listModel.__toolPreviewIdToModel[s.id]=s}}isGeoItem(e){let t=this.getItemModel(e);return t&&t.type==="expression"&&t.formula&&t.formula.geometry&&!t.formula.error}getSelectedGeoExpression(){var e=this.getSelectedItem();if(e&&this.isGeoItem(e.id)&&e.type==="expression")return e}getGeometryFolder(){let e=this.getItemModel(__dcg_shared_module_exports__['ad']);return e&&e.type==="folder"?e:void 0}isItemInGeoFolder(e){var t=this.getItemModel(e);return!t||t.type==="folder"?!1:t.folderId===__dcg_shared_module_exports__['ad']}isGeoFolder(e){return e.id===__dcg_shared_module_exports__['ad']}isItemNotSelectableBecauseItsSecret(e){return!(this.shouldShowAuthorFeatures()||this.isItemInGeoFolder(e)||!this.isItemSecret(e))}pauseAllSliders(){this.getPlayingSliders().forEach(e=>{Hs(e,!1)})}countGlobalIdentifierOccurences(e){return H3(this.listModel,e)}handleClickableItemClicked(e,t){let i=this.getItemModel(e);Bf(i)&&this.evaluator.addClickEvent(i.id,t)}canAddTicker(){return!this.getTickerOpen()}countIdentifierAssignments(e){return _f(this.listModel,e).length}doesIdentifierBlockActionUpdate(e){var t=this.getFocusLocation(),i=_f(this.listModel,e);for(let o of i)if((t==null?void 0:t.type)==="expression"&&t.id===o.id||UR(o))return!0;return!1}getItemsByIdentifier(e){return _f(this.listModel,e)}isAtLeastOnePointSelected(){let e=this.getAllSelectedItems();for(var t=0;t<e.length;t++){let i=e[t];if(i.type==="expression"&&Od(i))return!0}return!1}toggleLabelForAllSelectedObjects(){let e=[],t=[];this.getAllSelectedItems().forEach(o=>{o.type==="expression"&&Od(o)&&(o.showLabel?t.push(o):e.push(o))});let i=/^([A-Z])([0-9]*)$/;if(e.length){let o=0;this.getAllItemModels().forEach(n=>{if(n.type!=="expression"||!n.showLabel||!n.label)return;let a=n.label.match(i);if(!a)return;let s=a[1].charCodeAt(0)-65;a[2]&&(s+=parseInt(a[2])*26),s>=o&&(o=s+1)}),e.forEach(n=>{if(!n.label){let a=o;o++;let s=String.fromCharCode(a%26+65),l=Math.floor(a/26),c=l>0?l+"":"";Rp(n,s+c)}ag(n,!0)})}else t.length&&t.forEach(o=>{i.test(o.label)&&Rp(o,""),ag(o,!1)})}updateLatexForIdentifier(e,t){var i=_f(this.listModel,e);if(i.length===1){var o=i[0];o.slider.isPlaying?(Hs(o,!1),Cs(o,t),Hs(o,!0)):Cs(o,t)}}updateExpressionSearchStr(e){this.rawExpressionSearchStr=e;let t="\\operatorname{rename}";if(e.indexOf(t)===0){let o=e.slice(t.length).replace(/\\ /g,"").split(/\\to(?![a-zA-Z])/);o.length===2?(this.expressionSearchStr=o[0],this.isExpressionSearchStrValidForReplace=ys(this.expressionSearchStr),this.updateExpressionReplaceStr(o[1])):(this.expressionSearchStr=o[0],this.isExpressionSearchStrValidForReplace=!1,this.updateExpressionReplaceStr(""));let n=z3(this.listModel,this.getExpressionSearchStr());this.expressionSearchCount=this.expressionSearchOpen?n:0}else this.expressionSearchStr=e.length>1&&"rename".indexOf(e)===0?"":e,this.isExpressionSearchStrValidForReplace=!1,this.updateExpressionReplaceStr(""),this.filterItemsBySearch()}filterItemsBySearch(){if(!this.getExpressionReplaceStr()){let e=U3(this.listModel,this.getExpressionSearchStr());this.expressionSearchCount=this.expressionSearchOpen?e:0}}updateExpressionReplaceStr(e){this.expressionReplaceStr=e,this.isExpressionReplaceStrValidForReplace=ys(e)}getIsExpressionSearchStrValidForReplace(){return this.isExpressionSearchStrValidForReplace}getIsExpressionReplaceStrValidForReplace(){return this.isExpressionReplaceStrValidForReplace}isSearchReplaceValid(){return this.getIsExpressionSearchStrValidForReplace()&&this.getIsExpressionReplaceStrValidForReplace()}shouldShowReplaceIcon(){return this.isSearchReplaceValid()}updateTickerHandlerLatex(e){this.listModel.ticker.handlerLatex=e}updateTickerMinStepLatex(e){this.listModel.ticker.minStepLatex=e}getRawExpressionSearchStr(){return this.rawExpressionSearchStr||""}getExpressionSearchStr(){return this.expressionSearchStr||""}getExpressionReplaceStr(){return this.expressionReplaceStr||""}getExpressionSearchCount(){return this.expressionSearchCount||0}getTicker(){return this.listModel.ticker}getTickerHandlerLatex(){return this.listModel.ticker.handlerLatex||""}getTickerMinStepLatex(){return this.listModel.ticker.minStepLatex||""}getTickerAvgDelta(){return this.listModel.ticker.avgDelta}getBrailleMode(){return this.graphSettings.config.brailleMode}setBrailleMode(e){this.graphSettings.config.setProperty("brailleMode",e)}getSixKeyInput(){return this.graphSettings.config.sixKeyInput}setSixKeyInput(e){this.graphSettings.config.setProperty("sixKeyInput",e)}getBrailleControls(){return this.graphSettings.config.brailleControls}setBrailleControls(e){this.graphSettings.config.setProperty("brailleControls",e)}getAudio(){return this.graphSettings.config.audio}setAudio(e){this.graphSettings.config.setProperty("audio",e)}setEditListMode(e){this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{inEditListMode:e})}generateTableXSubscript(){return ok(this.listModel)}findLastTokenNumber(){return W3(this.listModel)}findLastSubscriptForLetters(){return $3(this.listModel)}_createTableItem(){let e=this.generateTableXSubscript(),t=mM(e,[[],[]],this);return this.createItemModel(t)}_populateSettingsViewLimitLatex(){let e=this.getGrapher();if(!e)return;let t=e.getCurrentViewport();this.isGraphSettingsOpen()&&__dcg_shared_module_exports__['P'](t,this.lastDirectlyEditedViewport)||(this.settingsViewModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.settingsViewModel),{limitLatex:UK(t,{steps:this.getAxisStepSettings(),scales:this.getAxisScaleSettings()})}))}getAxisStepSettings(){return{xAxisStep:this.graphSettings.xAxisStep,yAxisStep:this.graphSettings.yAxisStep}}getAxisScaleSettings(){return{xAxisScale:this.graphSettings.xAxisScale,yAxisScale:this.graphSettings.yAxisScale}}getDefaultAxisScaleSettings(){var t,i;let{defaultState:e}=this.graphSettings;return{xAxisScale:((t=e==null?void 0:e.graph)==null?void 0:t.xAxisScale)||"linear",yAxisScale:((i=e==null?void 0:e.graph)==null?void 0:i.yAxisScale)||"linear"}}getSettingsViewModel(){return this.settingsViewModel}getListModel(){return this.listModel}getGeometryToolbarModel(){return this.geometryToolbarModel}hasBackgroundColor(){return this.getBackgroundColor()!=="#ffffff"}getBackgroundColor(){return this.getGraphSettings().getBackgroundColor()}getTextColor(){return this.getGraphSettings().getTextColor()}getPillboxBackgroundColor(){return __dcg_shared_module_exports__['m'](this.getBackgroundColor(),-.07)}subscribeToChanges(e){let t=this.nextSubscription;return this.nextSubscription+=1,this.subscriptions[t]=e,()=>{delete this.subscriptions[t]}}updateTheComputedWorld(){var p,u,m,h,x,C,D;hg(this.listModel);let t=this.getSelectedItem()&&this.activeTool==="expression-edit"&&this.listModel.__toolPreviewIdToModel[Vf]&&((p=this.getGrapher())!=null&&p.graphSketches[Vf])?"preview":"actual";j3(this.listModel,t),(u=this.grapher2d)==null||u.setSketchOrder(this.listModel.drawOrder),(m=this.grapher3d)==null||m.setSketchOrder(this.listModel.drawOrder);let i={},o=k=>{var I;let M=(I=Fo(k))==null?void 0:I.identifier;M&&(M[0]==="$"||k.formula.geometry)&&M&&(i[M]?i[M].multiple=!0:i[M]={model:k,multiple:!1})};for(let k of this.getAllToolPreviewItems())M1(k),o(k);for(let k of this.getAllItemModels())switch(k.type){case"expression":M1(k),o(k);break;case"image":o3(k);break;case"table":V5(k);break;case"folder":AN(k);break;case"text":KN(k);break;default:return k}this.geoUIActive=this.isGeometry()&&!this.getGraphSettings().config.hideGeoUI,this.cachedGeoTokenInfo={};for(let k in i){let{multiple:M,model:I}=i[k],S="blue",V="unknown",P="unknown",L=!1,B=!1,R=!1,W=Za(I);!M&&I?(S=Nc(I),L=BR(I),P=zR(I),V=V1(I),I.error&&(B=!0,S="#")):(V="error",B=!0),V&&I?this.isItemSelected(I.id)&&(R=!0):B=!0;let re=nw(I,this,{includeDetails:!1}),ne=(I==null?void 0:I.label)||"";this.cachedGeoTokenInfo[k]={groupType:V,iconType:P,isList:L,hasError:B,color:S,isSelected:R,isHidden:W,description:re,label:ne,calcId:I&&I.id||""}}this.cachedGeoTokenDepths={};let{createdDepth:n,firstReferencedDepth:a}=this.geoModel.getComputedBoard().getDepthValues();for(let k in this.cachedGeoTokenInfo){let{calcId:M}=this.cachedGeoTokenInfo[k],I=this.getItemModel(M);if(!I)continue;let S=k;if(!(k in n)&&I.type==="expression"&&(M===this.getDraggedItemId()||I===this.getFocusedItem())){let W=I.formula.assignment;W&&W in n&&(S=W)}let V=n[S]||0,P=a[S];P=isFinite(P)?P:0;let L=Math.max(V,P-1)+"",B=this.cachedGeoTokenDepths[L];B||(B=[],this.cachedGeoTokenDepths[L]=B);let R=this.cachedGeoTokenInfo[k];B.push({color:R.color,groupType:R.groupType,identifier:k,calcId:M})}y3(this.listModel.ticker);let s=this.getFocusLocation();if(s&&s.type==="expression"&&s.isFakeGraphFocus&&(this.getValidCursorContext()||Fi(this,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},s),{isFakeGraphFocus:void 0}))),this.isCurrentFocusLocationValid()||Fi(this,void 0),this.listModel.openItemMenu){let k=this.getOpenMenuIcon();document.body&&k&&document.body.contains(k)||(this.listModel.openItemMenu=void 0)}let l=this.getSelectedItem();l&&!this.getItemModel(l.id)&&Zr(this.listModel,void 0),this._populateSettingsViewLimitLatex(),this.propagateSelection(),this.propagateActiveTokens(),this.isKeypadOpen()||(this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{keypadFunctionsOpen:!1})),this.updateSuggestedIdentifierRenameInfo(),this.isGeometry()&&l&&l.type==="expression"?this.getValidCursorContext()?(this.setGeoTool("expression-edit"),this.geoModel.updateFadeAnimations()):this.geoModel.getToolMode()==="expression-edit"&&this.setGeoTool("selection"):this.geoModel.getToolMode()==="expression-edit"&&this.setGeoTool("selection");let c=this.getValidCursorContext();this.isGeometry()&&this.getGeoModel().getToolMode()==="expression-edit"&&!__dcg_shared_module_exports__['P'](c,this.lastCursorContext)&&this.runAfterDispatch(()=>{var k;(k=this.get2dPOIController())==null||k.replayGeoTapMove()}),this.lastCursorContext=c,(x=(h=this.grapher2d)==null?void 0:h.poiController)!=null&&x.keyboardAttentionManager.getKeyboardAttention()&&!this.isGraphPaperFocused()&&((D=(C=this.grapher2d)==null?void 0:C.poiController)==null||D.keyboardAttentionManager.setKeyboardAttention(void 0)),this.isGeometry()&&(G3(this.geometryToolbarModel),this.isGeoToolEnabled(this.getActiveTool())||this.setGeoTool("selection")),this.runAfterDispatch(()=>{var k,M;this.isThreeDMode()||((k=this.grapher2d)==null||k.audioGraph.checkIfSelectedItemChanged(l?l.id:void 0),this.focusLocation&&this.focusLocation.type!=="graph-paper"&&((M=this.grapher2d)==null||M.audioGraph.exitAudioTrace()))})}getOpenMenuIconSelector(){let e=this.getOpenItemMenu();return e?`[dcg-open-menu-guid="${e.guid}"]`:void 0}getOpenMenuIcon(){let e=this.getOpenMenuIconSelector();return e?this.findEl(e):void 0}propagateSelection(){let e=this.getGrapher();e?this.__lastSelectedIdsForPropagation=j5(this,e,this.__lastSelectedIdsForPropagation):this.__lastSelectedIdsForPropagation={}}propagateActiveTokens(){var e,t;this.isThreeDMode()||((e=this.grapher2d)==null||e.setActiveToken(this.getExpressionIdForIdentifier(this.activeTokens.selected),"selected"),(t=this.grapher2d)==null||t.setActiveToken(this.getExpressionIdForIdentifier(this.activeTokens.hovered),"hovered"))}getHoveredOrFocusedTokenIdentifier(){if(this.activeTokens.hovered)return this.activeTokens.hovered;let e=this.getFocusLocation();if(e&&e.type==="geo-token")return e.identifier}doesLatexContainToken(e){return KR(e)}getToolPreviewJSONState(){return this.toolPreviewJSONState}garbageCollectGeo(e,t){if(!this.isGeometry())return;let i=e4(this,e,t);i.length&&sM(this.listModel,i)}ensureAtLeastOneVisibleItem(){if(Z3(this.listModel)){let e=this.createItemModel({type:"expression",id:this.generateId(),color:this.getNextColor()});Rc(this.listModel,e)}}getExpressionIdForIdentifier(e){if(e){var t=this.getItemsByIdentifier(e);if(t.length===1)return t[0].id}}getValidCursorContext(){var o;let e=this.getSelectedItem();if(!e||e.type!=="expression")return;let t=e.formula.cursor_context,i=(o=_e.getFocusedMathquill())==null?void 0:o.selection();if((t==null?void 0:t.type)==="expression-arguments"){let{argIndex:n,positionWithinArg:a}=t;if(!(n===t.argCount-1&&a==="end"||t.positionWithinArg==="start-to-end"&&(i==null?void 0:i.startIndex)!==void 0&&(i==null?void 0:i.startIndex)===(i==null?void 0:i.endIndex)))return}if((e==null?void 0:e.type)==="expression"&&e.latex===(t==null?void 0:t.selection.input)&&(i==null?void 0:i.startIndex)===(t==null?void 0:t.selection.start)&&(i==null?void 0:i.endIndex)===(t==null?void 0:t.selection.end)&&(i==null?void 0:i.latex)===(t==null?void 0:t.selection.input))return t}tryInsertTokenIntoMathquill(e,t){if(!this.isGeometry()||!e)return!1;var i=this.getItemModel(e);if(!i||i.type!=="expression")return!1;let o=i.formula.typed_constant_value;t===0&&(!o||!__dcg_shared_module_exports__['Ka'](o.valueType))&&(t=void 0);var n,a,s=In(i);if(s?a=__dcg_shared_module_exports__['hb'](s):i.formula.geometry&&(a=this.getAutonameLatexForExpression(i),n=a),!a)return!1;t!==void 0&&(a+="\\left["+(t+1)+"\\right]");var l=this.getFocusLocation();if(!l||!this.seemsLikeInsertingTokenWillImproveThings(o==null?void 0:o.valueType))return!1;var c=l.type==="expression";return c?(n&&(Gi(i)==="NONE"&&i.dragMode==="AUTO"&&sg(i,"NONE"),Cs(i,n+"="+i.latex)),this.writeIdentifierIntoCurrentMathquill(a),!0):!1}seemsLikeInsertingTokenWillImproveThings(e){let t=this.getValidCursorContext();if(t){if(!e)return!1;let i=__dcg_shared_module_exports__['Ka'](e)?__dcg_shared_module_exports__['La'](e):e;return(t.type==="expression-arguments"?t.allowedTypesForInsertedArg:t.allowedTypes).some(n=>__dcg_shared_module_exports__['Na'](i,n))}return!1}writeIdentifierIntoCurrentMathquill(e){this.runAfterDispatch(()=>{let t=this.getValidCursorContext(),i=_e.getFocusedMathquill();if(!i)return;let o="",n="";(t==null?void 0:t.type)==="expression-arguments"&&((t==null?void 0:t.positionWithinArg)==="end"?o=",":(t==null?void 0:t.positionWithinArg)==="start"&&(n=","));let a=`${o}${e}${n}`,s=!1;if((t==null?void 0:t.type)==="expression-arguments"&&t.polygonVertices){let{argIndex:l,polygonVertices:c,positionWithinArg:p}=t;(e===c.firstLatex||e===c.lastLatex)&&(p==="end"||p==="start-to-end")&&l===t.argCount-1&&(a="",s=!0)}else(t==null?void 0:t.type)==="expression-arguments"&&(s=t.isLastValidArg);_e.canAcceptText(i,this.getCapExpressionSize(),a)&&(i.write(a),_e.simulateUserChangedLatex(i),s&&i.keystroke("Right"))})}getSelectedExpressionIds(){return t5(this.listModel)}getPropagatedSelectedIds(){return this.__lastSelectedIdsForPropagation}areParsableObjectsEqual(e,t){return e===t?!0:__dcg_shared_module_exports__['P'](__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},e),{regressionParameters:void 0}),__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{regressionParameters:void 0}))}requestParseForAllItems(){var o,n,a;(this.isCurrentlyDoingSetState||this.isCurrentlyDoingRestoreState)&&(this.lastParsableObjects={},this.evaluator.clearStatementsAndStartCompleteState(),this.isCurrentlyDoingRestoreState&&this.evaluator.markUndoRedoState());var e={},t=this.lastParsableObjects;for(let s of this.getAllItemModels())switch(s.type){case"expression":case"image":case"table":e[s.guid]=s.cachedParsableState;break;case"folder":case"text":break;default:return s}for(let s of q3(this.listModel))e[s.guid]=s.cachedParsableState;for(let s of Of(this.listModel)){let l=this.getSelectedItem(),c=this.activeTool==="polygon";if(this.activeTool==="expression-edit"&&(l==null?void 0:l.type)==="expression"&&((n=(o=l.formula.geometry)==null?void 0:o.call)==null?void 0:n.symbol)==="polygon"&&((a=l.formula.cursor_context)==null?void 0:a.type)==="expression-arguments"){let{positionWithinArg:p,argIndex:u}=l.formula.cursor_context;c=(p==="end"||p==="start-to-end")&&u===l.formula.geometry.call.parents.length-1}e[s.guid]=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},s.cachedParsableState),{shouldOmitLastPolygonSegment:c})}let i=this.getFocusedItem();if((i==null?void 0:i.type)==="expression"){let s=_e.getFocusedMathquill(),l=s==null?void 0:s.selection();(l==null?void 0:l.latex)===i.latex&&(e[i.guid]=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},i.cachedParsableState),{latexSelection:{start:l.startIndex,end:l.endIndex}}))}if(this.is3dProduct()&&this.getTranslucentSurfaces())for(let s in e){let l=e[s];l.type==="statement"&&(e[s]=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},l),{fillOpacity:n4}))}this.listModel.ticker.cachedParsableState&&(e[this.listModel.ticker.guid]=this.listModel.ticker.cachedParsableState);for(let s of T3(this.geometryToolbarModel))e[s.id]=s;for(let s in t){let l=t[s],c=e[s];if(l.type==="image"&&(!c||c.type!==l.type||c.guid!==l.guid)&&this.grapher2d&&this.grapher2d.removeGraphImage(l.id),!c&&(this.evaluator.removeStatement(l.id),l.type==="table"))for(let p of l.columns)this.evaluator.removeStatement(p.id)}for(let s in e){let l=e[s],c=t[s];if(l.type==="image"&&(!c||l.type!==c.type||l.guid!==c.guid)&&this.grapher2d){let p=this.getItemModel(l.id);p&&p.type==="image"&&this.grapher2d.addGraphImage(p)}this.areParsableObjectsEqual(l,c)||(this.grapher2d&&l.type==="statement"&&l.latex===""&&this.grapher2d.removeGraphSketch(l.id),this.evaluator.addStatement(l))}this.lastParsableObjects=e}getViewState(){let e=this.getGrapher();if(e){let t=e.getProjection();return{viewport:t.viewport.toObject(),screen:t.screen,xAxisScale:t.settings.xAxisScale,yAxisScale:t.settings.yAxisScale,degreeMode:t.settings.degreeMode}}else return}getTokenRenderInfoByIdentifier(e){let t=this.cachedGeoTokenInfo[e];return t||(t={iconType:"unknown",isList:!1,hasError:!0,isSelected:!1,groupType:"unknown",color:"",isHidden:!1,description:"",label:"",calcId:""}),t}setEvaluator(e){this.evaluator=e}getEvaluator(){return this.evaluator}setGrapher2d(e){this.grapher2d=e}setGrapher3d(e){this.grapher3d=e,this.grapher2d.poiController.add3DTouchEventHandlers(e)}getGrapher(){return this.isThreeDMode()?this.grapher3d:this.grapher2d}getGrapher2d(){return this.grapher2d}getGrapher3d(){return this.grapher3d}get2dPOIController(){var e;return(e=this.grapher2d)==null?void 0:e.poiController}isDefaultViewportRestored(){var e;return!!((e=this.getGrapher())!=null&&e.viewportController.isDefaultViewportRestored())}requestRedrawGraph(){var e,t;(e=this.grapher2d)==null||e.redrawAllLayers(),this.isThreeDMode()&&((t=this.grapher3d)==null||t.redrawAllLayers())}get2dProjection(){var e;return(e=this.grapher2d)==null?void 0:e.getProjection()}get2dSketchOrder(){var e;return(e=this.grapher2d)==null?void 0:e.getSketchOrder()}getBoundingBoxesForZoomFit(e){if(!(!this.grapher2d&&!this.grapher3d)&&this.isZoomFitEnabled()&&!(e.type!=="expression"&&e.type!=="table")&&!(e.type==="expression"&&(e.error||!e.shouldGraph||!e.formula.is_graphable)))return e.boundingBoxes}isExpressionZoomFit(e){if(this.isThreeDMode())return!1;let t=this.getBoundingBoxesForZoomFit(e),i=this.get2dProjection();return!i||!t?!1:!rL(t,i)&&!!Jw(t,i)}viewportIsLocked(){return this.getLockViewportConfigSetting()||this.getLockViewportUserSetting()}showExpressionZoomFitButton(e){if(this.viewportIsLocked()||this.isGeometry()||this.is3dProduct())return!1;let t=this.getBoundingBoxesForZoomFit(e),i=this.get2dProjection();return!!(i&&t&&rL(t,i))}setBugsnagContext(e){this.bugsnagContext=e}getItemRootNodeById(e){let t=this.getItemModel(e);if(t&&t.dcgView)return t.dcgView.findRootNode()}getItemNodeById(e){return this.getItemRootNodeById(e)}generateId(){var e=this.__nextItemId;return this.__nextItemId+=1,e+""}getNextColor(){return _3(this.listModel)}getNextDisplayIndex(){return this.listModel.nextDisplayIndex}_clearPendingImageUploads(){this.__pendingImageUploads={}}isUploadingImages(){return Object.keys(this.__pendingImageUploads).length>0}getExpressionAnalysis(){return this.listModel.expressionAnalysis}createItemModel(e){return If(this.listModel,e)}getItemModel(e,t){return Fc(this.listModel,e,t)}getHiddenGeoItemCount(){return Q3(this.listModel)}getColorById(e){let t=this.getItemModel(e);return!t||t.type!=="expression"?"":C1(t)}getAllColorAssignments(){let e=[];for(let t of this.getAllItemModels()){if(t.type!=="expression")continue;let i=In(t);if(!i)continue;let o=this.getEvaluationValueForItem(t.id);(typeof o=="string"||Array.isArray(o)&&typeof o[0]=="string")&&e.push({id:t.id,assignmentLatex:__dcg_shared_module_exports__['hb'](i)})}return e}getAllColorFunctionAssignments(){let e=[];if(!this.isBeta3DMode())return e;for(let t of this.getAllItemModels()){if(t.type!=="expression")continue;let i=In(t),o=G1(t);!i||!o||e.push({id:"shader",assignmentLatex:"shader:"+__dcg_shared_module_exports__['hb'](i)})}return e}getShader(e){for(let t of this.getAllItemModels()){if(t.type!=="expression")continue;let i=In(t);if(i&&__dcg_shared_module_exports__['hb'](i)===e){let o=G1(t);if(o)return o}}return{source:"",shaderFunctions:{}}}getAllImages(){let e=[];if(!this.isBeta3DMode())return e;for(let t of this.getAllItemModels())t.type==="image"&&e.push({id:t.id,url:t.image_url,name:t.name});return e}getItemModelByIndex(e){return Mf(this.listModel,e)}getItemCount(){return Kx(this.listModel)}getItemEditableLabelMode(e){let t=this.getItemModel(e);if(!(!t||t.type!=="expression"))return tN(t)}isItemSecret(e){let t=this.getItemModel(e);return t?qx(t):!1}isItemReadonly(e){let t=this.getItemModel(e);return t?iM(t):!1}isItemSelected(e){let t=this.getItemModel(e);return!!t&&aa(t)}hasAnyItemsSelected(){return this.getAllSelectedItems().length>0}hasMultipleItemsSelected(){return this.getAllSelectedItems().length>1}isItemSelectable(e){let t=this.getItemModel(e);return t?Lf(t):!1}anyItemDependsOnRandomSeed(){return c5(this.listModel)}areActionsEnabled(){return this.graphSettings.config.actions==="auto"?d5(this.listModel):!!this.graphSettings.config.actions}getAllItemModels(){return nM(this.listModel)}getAllToolPreviewItems(){return Of(this.listModel)}isToolPreviewItem(e){return Y3(this.listModel,e)}getAllModelsWithSliders(){return e5(this.listModel)}getGraphSettings(){return this.graphSettings}getAudioGraph(){var e;if(!this.isThreeDMode())return(e=this.grapher2d)==null?void 0:e.audioGraph}inAudioTraceMode(){let e=this.getAudioGraph();return!!(e&&e.audioTraceActive)}canAudioTrace(){let e=this.getAudioGraph();return e?e.canAudioTraceCurrentExp():!1}isAudioTracing(){let e=this.getAudioGraph();return e?e.isAudioTracing():!1}expressionsAreFullWidth(){return this.isNarrow()||this.graphSettings.config.graphpaper===!1}getExpListWidthString(){return this.expressionsAreFullWidth()?"100%":this.rootElt?this._getExpListWidth()+"px":"0"}getExpListWidth(){return this.rootElt?this._getExpListWidth():0}findFirstVisibleItem(){let e=$K(this,this._previousFirstVisibleId);if(this._previousFirstVisibleId=e,e)return this.getItemModel(e)}findLastVisibleItem(){let e=jK(this,this._previousLastVisibleId);if(this._previousLastVisibleId=e,e)return this.getItemModel(e)}updateRenderShellsAfterDispatch(){if(!this.rootElt||!this.isListVisible())return;let e=this.findFirstVisibleItem(),t=this.findLastVisibleItem();var i=e&&this.getItemRootNodeById(e.id),o=t&&this.getItemRootNodeById(t.id);if(i===this.lastInfiniteScrollFirstDOM&&o===this.lastInfiniteScrollLastDOM&&!this.hasDispatchSinceLastInfiniteScrollUpdate)return;this.lastInfiniteScrollFirstDOM=i,this.lastInfiniteScrollLastDOM=o,this.hasDispatchSinceLastInfiniteScrollUpdate=!1;let n=!1,a=e?e.index:1/0,s=t?t.index:1/0,l=this.listModel.dragState&&this.listModel.dragState.firstItemId,c,p=this.getOpenItemMenu();p&&p.type!=="multi-select-more"&&p.type!=="multi-select-transformations"&&p.type!=="geo-tool-dropdown"&&(c=p.model.id);for(let m of this.getAllItemModels()){var u=(m.index<a||m.index>s||m.isHiddenFromUI)&&!(m.type==="expression"&&m.sliderDragging);if(l==m.id&&(u=!1),c===m.id&&(u=!1),m.renderShell!==u&&(m.renderShell=u,n=!0,u)){let h=this.getItemRootNodeById(m.id);if(h){let x=h.getBoundingClientRect().height;x>0&&(m.cachedRenderHeight=x)}}}n&&this.markTickRequiredNextFrame()}updateRenderShellsBeforePaint(){if(this.hasDispatchSinceLastInfiniteScrollUpdate=!0,this.inPrintMode){for(let t of this.getAllItemModels())t.renderShell=!1;return}for(let t of this.getAllItemModels())t.isHiddenFromUI&&(t.renderShell=!0),t.type==="expression"&&t.sliderDragging&&(t.renderShell=!1);let e=this.getSelectedItem();e&&!this.isGeoItem(e.id)&&(e.renderShell=!1)}updateDragDrop(){let e=this.listModel.dragState;if(!e)return;let t=this.getItemModel(e.firstItemId);if(!t)return;let i=this.dragdrop_expressions.applyDrag();i&&(zx(this.listModel,i.dragState),sa(t,i.folderId),t.index!==i.newIndex&&Xu(this.listModel,t.index,i.newIndex,e.numberOfItems))}_tickSliders(e){this.getPlayingSliders().forEach(function(t){TR(t,e)})}tickTicker(e){let t=this.listModel.ticker.lastTickTime===void 0;this.evaluator.addClockTickEvent(this.listModel.ticker.id,t),w3(this.listModel.ticker,e)}stopAllSliders(){for(let e of this.getAllItemModels())e.type==="expression"&&e.slider.isPlaying&&Hs(e,!1)}getPlayingSliders(){var e=this.getAllItemModels(),t=[];for(let i of e)i.type==="expression"&&i.sliderExists&&i.slider.isPlaying&&t.push(i);return t}areAnyImagesLoading(){return P3(this.listModel)}_commitUserRequestedViewport(e){var t;(t=this.getGrapher())==null||t.setUserRequestedViewport(e)}_setAxisLimitLatex(e,t){this.settingsViewModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.settingsViewModel),{limitLatex:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.settingsViewModel.limitLatex),{[e]:t})});let o=t===""&&(e==="xstep"||e==="ystep")?0:gi(t,this.graphSettings.degreeMode),n=this.getGrapher();switch(e){case"xstep":{if(!ef(o))return;this.graphSettings.setProperty("xAxisStep",o)}break;case"ystep":{if(!ef(o))return;this.graphSettings.setProperty("yAxisStep",o)}break;case"xmin":case"xmax":case"ymin":case"ymax":case"zmin":case"zmax":{if(!n)return;let a=n.viewportController.getViewport(),s="xmin";e==="xmin"&&(s="xmax"),e==="ymax"&&(s="ymin"),e==="ymin"&&(s="ymax"),e==="zmax"&&(s="zmin"),e==="zmin"&&(s="zmax");let l=gi(this.settingsViewModel.limitLatex[s]||"",this.graphSettings.degreeMode),c=lo.fromObject(__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},a.toObject()),{[e]:o,[s]:l}));if(!c.isValid(this.getAxisScaleSettings()))return;n.viewportController.setViewport(c);let u;switch(e){case"xmin":case"xmax":u="x";break;case"ymin":case"ymax":u="y";break;case"zmin":case"zmax":u="z";break;default:let m=e;throw new Error(`Invalid limit: ${m}`)}this.graphSettings.setProperty("lastChangedAxis",u),this.markSquareAxesAfterUserEditedViewport()}break}if(n){let a=n.viewportController.getViewport().toObject();this._commitUserRequestedViewport(a)}}unmarkLastChangedAxis(){this.graphSettings.setProperty("lastChangedAxis",void 0)}markSquareAxesAfterUserEditedViewport(){let e=this.getGrapher();if(!e)return;let t=e.viewportController.getViewport(),i=this.isThreeDMode()?t.isSquare3D():t.isSquare(e.getProjection().screen,this.getAxisScaleSettings());this.graphSettings.setProperty("squareAxes",i)}getLockViewportConfigSetting(){return this.graphSettings.config.lockViewport}getLockViewportUserSetting(){return this.graphSettings.userLockedViewport}canUserAddExpressions(){return!!this.graphSettings.config.expressions}areNotesEnabled(){return!!this.graphSettings.config.notes}areSlidersEnabled(){return!!this.graphSettings.config.sliders}areLinksEnabled(){return!!this.graphSettings.config.links}areImagesEnabled(){let e=window.FileReader,t=pl&&Yy&&Yy[0]===8&&Yy[1]===0&&Yy[2]===0;return!!(this.graphSettings.config.images&&e&&!t&&(!this.is3dProduct()||this.isBeta3DMode()))}areFoldersEnabled(){return!!this.graphSettings.config.folders}isDecimalToFractionEnabled(){return!!this.graphSettings.config.decimalToFraction}isTraceEnabled(){return!!this.graphSettings.config.trace}areFunctionsRestricted(){return!!this.graphSettings.config.restrictedFunctions}areGeometryFunctionsForceEnabled(){return!!this.graphSettings.config.forceEnableGeometryFunctions}isQwertyKeyboardEnabled(){return!!this.graphSettings.config.qwertyKeyboard}isZoomFitEnabled(){return!!this.graphSettings.config.zoomFit}canEditOnWeb(){return!!this.graphSettings.config.editOnWeb}hasTransparentBackground(){return!!this.graphSettings.config.transparentBackground}shouldAudioTraceReverseExpressions(){return!!this.graphSettings.config.audioTraceReverseExpressions}hasDefaultState(){return!!this.graphSettings.defaultState}getDefaultViewport(){var t;var e=this.graphSettings.defaultState;return e&&e.graph?e.graph.viewport:(t=this.getGrapher())==null?void 0:t.getDefaultViewport()}getColors(){return this.isThreeDMode()?__dcg_shared_module_exports__['p']:this.graphSettings.config.colors}getImageOpacities(){return["0.2","0.4","0.6","0.8","1"]}getUIDragModes(){return["X","Y","XY"]}getNumberOfItemsInFolder(e){return F3(this.listModel,e)}getEnabledDragModesForItem(e){let t=this.getItemModel(e);if(!t||t.type!=="expression")return[];let i=t.formula,o=[];if(!i.move_strategy)return o;let n=i.move_strategy[0].type!=="none",a=i.move_strategy[1].type!=="none",s=n&&a;return n&&o.push("X"),a&&o.push("Y"),s&&o.push("XY"),o}shouldShowEvaluationForItem(e){let t=this.getItemModel(e);return!t||t.type!=="expression"?!1:v1(t)}getEvaluationValueForItem(e){let t=this.getItemModel(e);return t?t.type!=="expression"?NaN:C1(t):NaN}canDisplayEvaluationForItemAsFraction(e){if(!this.isDecimalToFractionEnabled())return!1;let t=this.getItemModel(e);if(!t||t.type!=="expression"||zu(t))return!1;let i=this.getEvaluationValueForItem(e);return typeof i!="number"?!1:__dcg_shared_module_exports__['db'](i)}shouldEvaluationForItemDisplayAsFraction(e){if(!this.isDecimalToFractionEnabled())return!1;let t=this.getItemModel(e);return!t||t.type!=="expression"?!1:Uu(t)}getEvaluationLabelOptionsForItem(e){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},SR),{displayAsFraction:this.shouldEvaluationForItemDisplayAsFraction(e)})}getPointStyles(){return["POINT","OPEN","CROSS"]}getLineStyles(){return["SOLID","DASHED","DOTTED"]}getOpacities(){return[.2,.4,.8]}isInEditListMode(){return this.layoutModel.inEditListMode}authorFeaturesAvailable(){return!!this.graphSettings.config.authorFeatures}shouldShowAuthorFeatures(){return this.authorFeaturesAvailable()&&!!this.graphSettings.config.authorMode}toolWillBeHiddenOrDisabled(e){return this.shouldShowAuthorFeatures()&&(!this.isGeoToolVisible(e,{ignoreAuthorMode:!0})||!this.isGeoToolEnabled(e,{ignoreAuthorMode:!0}))}setAuthorMode(e){this.graphSettings.config.setProperty("authorMode",e)}getInvertedColors(){return!!this.graphSettings.config.invertedColors}invertSwatches(){return this.isThreeDMode()&&this.getInvertedColors()}canUseAdvancedStyling(){return this.graphSettings.config.advancedStyling}isDegreeMode(){return this.graphSettings.degreeMode}isThreeDMode(){return this.graphSettings.threeDMode}showPlane3D(){let{threeDMode:e,showAxis3D:t,showPlane3D:i}=this.graphSettings;return e&&t&&i}showNumbers3D(){let{threeDMode:e,showAxis3D:t,showNumbers3D:i}=this.graphSettings;return e&&t&&i}getTranslucentSurfaces(){return!!this.graphSettings.config.translucentSurfaces}isBeta3DMode(){return this.isThreeDMode()&&Pr("beta3d")}areLogModeRegressionsForced(){return this.graphSettings.config.forceLogModeRegressions}setAllRegressionsToLogMode(){for(let e of this.getAllItemModels())e.type==="expression"&&e.formula&&e.formula.is_regression&&A1(e,!0)}isGraphSettingsOpen(){return this.layoutModel.graphSettingsOpen}isAddExpressionOpen(){return this.layoutModel.addExpressionOpen}shouldRenderList(){if(this.layoutModel.expressionsVisible)return!0;var e=this.layoutModel.expressionsHiddenTime;return e===void 0?!1:Date.now()-e<=500}isListVisible(){return this.layoutModel.expressionsVisible}isGrapherEnabled(){return this.graphSettings.config.graphpaper!==!1}isListEnabled(){return this.graphSettings.config.expressions!==!1}areDistributionsEnabled(){return this.graphSettings.config.distributions===!0}isExpressionListFocused(){let e=this.getFocusLocation();if(!e)return!1;switch(e.type){case"settings":case"generic-menu":case"expression-menu":case"editable-label":case"geo-token":case"multi-select-more-icon":case"multi-select-transformations-icon":case"geo-header-back-link":case"multi-select-delete-icon":case"multi-select-show-hide-icon":case"new-transformation-number":case"label-points-icon":case"geo-show-constructions-icon":case"geo-basic-tool":case"geo-basic-tool-menu-item":case"regression-output":case"graph-paper":case"zoom-in-btn":case"zoom-restore-btn":case"quest":return!1;case"distribution-param":case"cdf-limit":case"slider-limit":case"domain-limit":case"expression":case"visualization-prop":case"search-expressions":case"replace-expressions":case"ticker":case"table":case"image":case"readonly-expression":case"braille-output":case"table-container":case"text":case"folder":case"add-item-btn":case"add-expression-btn":case"add-note-btn":case"add-table-btn":case"add-folder-btn":case"add-ticker-btn":case"add-image-btn":case"change-image-btn":case"edit-list-toggle":case"expression-icon":case"image-icon":case"slider-icon":case"slider-animation-properties-icon":case"slider-thumb":case"table-icon":case"action-icon":case"hide-expression-list-btn":case"show-expression-list-btn":case"top-level-icon":return!0;default:return e}}needsFakeKeypad(){if(this.inAudioTraceMode()&&this.isKeypadEnabled())return!0;let e=this.getFocusLocation();if(!e||this.getBrailleMode()!=="none"&&Gs())return!1;switch(e.type){case"settings":return zK(e.location);case"new-transformation-number":case"distribution-param":case"cdf-limit":case"slider-limit":case"domain-limit":case"expression":case"visualization-prop":case"search-expressions":case"replace-expressions":case"ticker":return!0;case"expression-menu":return e.location==="opacity"||e.location==="linewidth"||e.location==="lineopacity"||e.location==="pointopacity"||e.location==="pointsize"||e.location==="labelsize"||e.location==="labelangle"||e.location==="updaterule";case"table":{if(this.isInEditListMode())return!1;let o=e.location;if(o.row===0)return!0;var t=this.getItemModel(e.id);if(!t||t.type!=="table")return!1;let n=t.columnModels[o.column];return n?!n.disabled:!1}case"image":return e.location!=="name";case"readonly-expression":case"braille-output":case"regression-output":case"graph-paper":case"table-container":case"text":case"folder":case"add-item-btn":case"add-expression-btn":case"add-note-btn":case"add-table-btn":case"add-folder-btn":case"add-ticker-btn":case"add-image-btn":case"change-image-btn":case"edit-list-toggle":case"hide-expression-list-btn":case"show-expression-list-btn":case"geo-token":case"multi-select-more-icon":case"multi-select-transformations-icon":case"geo-header-back-link":case"multi-select-delete-icon":case"multi-select-show-hide-icon":case"label-points-icon":case"geo-show-constructions-icon":case"geo-basic-tool":case"geo-basic-tool-menu-item":case"generic-menu":case"zoom-in-btn":case"zoom-restore-btn":case"quest":return!1;case"expression-icon":case"image-icon":case"slider-icon":case"action-icon":case"slider-animation-properties-icon":case"slider-thumb":case"table-icon":case"top-level-icon":return!1;case"editable-label":return this.getItemEditableLabelMode(e.id)==="MATH";default:return e}}isIdentifierRenameValid(e){return ys(e)?!K3(this.listModel,e):!1}getBrandingMode(){return this.getEditLink()?"static-edit-link":this.getGraphSettings().config.editOnWeb?"edit-link":"powered-by"}getEditLink(){return window.iframeEmbedBrandingLink}_expressionZoomFit(e,t,i=!1){let o=this.getItemModel(e);if(this.isThreeDMode()||!this.grapher2d||!this.isZoomFitEnabled()||!o||o.type!=="expression"&&o.type!=="table"||!o.boundingBoxes||!o.boundingBoxes.length)return!1;var n=this.grapher2d.viewportController;if(!("zoomCustom"in n))return!1;let a=Jw(o.boundingBoxes,n.getProjection());return a?(i?n.setViewport(lo.fromObject(a)):n.zoomCustom(a),t&&Fi(this,{type:"zoom-restore-btn"}),!0):!1}_deleteItemAndAnimateOut(e,t){let o=this.getItemNodeById(e);o&&(oa(o,{transition:.2+"s",opacity:"0",transform:"scale(.1, .1)"}),setTimeout(()=>{this.dispatch({type:"finish-deleting-item-after-animation",id:e,setFocusAfterDelete:t})},1e3*.2))}_finishDeletingItemAfterAnimation(e,t){let i=this.getItemModel(e);if(!i)return;let o=this.getItemNodeById(e),n=o&&document.activeElement&&o.contains(document.activeElement),a=pg(this.listModel,i.index);if(this._removeExpressionSynchronously(i),!(!t||!n)){if(!a){let s=Af(this.listModel);s&&(a=s)}a&&yn(this,a.id,"end")}}_removeExpressionSynchronously(e){let t=Rf(this.listModel,e.index);this.garbageCollectGeo(t,{}),this.ensureAtLeastOneVisibleItem()}setRootElt(e){this.rootElt=e,this.dragdrop_expressions=new ev(this)}getRootElt(){return this.rootElt}_hideExpressions(e){this.graphSettings.config.expressions&&(Zr(this.listModel,void 0),this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{expressionsVisible:!1,expressionsHiddenTime:Date.now()}),e?Fi(this,{type:"show-expression-list-btn"}):Kr())}_showExpressions(e){this.graphSettings.config.expressions&&(this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{expressionsVisible:!0}),e?Fi(this,{type:"hide-expression-list-btn"}):Kr())}_showToast(e){if(this.toastData=e,this.toastData.hasOwnProperty("undoCallback")&&!ul){let i=oi?this.s("graphing-calculator-text-toast-undo-cmd-z"):this.s("graphing-calculator-text-toast-undo-ctrl-z");this.toastData.message+=" "+i}clearTimeout(this._hideToastTimeout);let t=typeof e.hideAfter=="number"?e.hideAfter:6e3;t>0&&(this._hideToastTimeout=setTimeout(()=>{this.dispatch({type:"toast/close",onHide:this.toastData.onHide})},t))}_setExpressionPropertiesFromAPI(e,t){let i=this.getItemModel(e);if(i)if(i.type==="table"&&t.columns){t=__dcg_shared_module_exports__['j'](t);let a=_5(i,t);var o=If(this.listModel,a);this._toplevelReplaceItemAt(i.index,o,!1)}else{let a=this.getItemModel(e);if(!a)return;for(var n in t)if(t.hasOwnProperty(n))switch(n){case"slider":{if(a.type!=="expression")continue;let s=t[n];s.hasOwnProperty("min")&&uf(a,s.min),s.hasOwnProperty("max")&&hf(a,s.max),s.hasOwnProperty("step")&&bx(a,s.step),s.hasOwnProperty("isPlaying")&&Hs(a,s.isPlaying)}break;case"polarDomain":{if(a.type!=="expression")continue;yx(a,__dcg_shared_module_exports__['rc'](t.polarDomain.min)),Cx(a,__dcg_shared_module_exports__['rc'](t.polarDomain.max))}break;case"parametricDomain":{if(a.type!=="expression")continue;xx(a,__dcg_shared_module_exports__['rc'](t.parametricDomain.min)),Dx(a,__dcg_shared_module_exports__['rc'](t.parametricDomain.max))}break;case"parametricDomain3Du":{if(a.type!=="expression")continue;wx(a,__dcg_shared_module_exports__['rc'](t.parametricDomain3Du.min)),Sx(a,__dcg_shared_module_exports__['rc'](t.parametricDomain3Du.max))}break;case"parametricDomain3Dv":{if(a.type!=="expression")continue;vx(a,__dcg_shared_module_exports__['rc'](t.parametricDomain3Dv.min)),kx(a,__dcg_shared_module_exports__['rc'](t.parametricDomain3Dv.max))}break;case"hidden":this._setItemHidden(e,t.hidden);break;case"secret":uM(a,t.secret);break;case"readonly":Ck(a,t.readonly);break;case"color":{if(a.type!=="expression")continue;wS(a,t.color)}break;case"dragMode":{if(a.type!=="expression")continue;sg(a,t.dragMode)}break;case"label":{if(a.type!=="expression")continue;Rp(a,t.label)}break;case"showLabel":{if(a.type!=="expression")continue;ag(a,t.showLabel)}break;case"labelSize":{if(a.type!=="expression")continue;Vx(a,t.labelSize)}break;case"labelOrientation":{if(a.type!=="expression")continue;F1(a,t.labelOrientation)}break;case"latex":if(a.type!=="expression")continue;Cs(a,t.latex);break;case"points":if(a.type!=="expression")continue;O1(a,!!t.points);break;case"lines":if(a.type!=="expression")continue;_1(a,!!t.lines);break;case"pointStyle":if(a.type!=="expression")continue;P1(a,t.pointStyle);break;case"pointSize":if(a.type!=="expression")continue;Tx(a,t.pointSize);break;case"pointOpacity":if(a.type!=="expression")continue;Gx(a,t.pointOpacity);break;case"lineStyle":if(a.type!=="expression")continue;DS(a,t.lineStyle);break;case"lineWidth":if(a.type!=="expression")continue;ff(a,t.lineWidth);break;case"lineOpacity":if(a.type!=="expression")continue;mf(a,t.lineOpacity);break;case"fill":if(a.type!=="expression")continue;L1(a,t.fill);break;case"fillOpacity":if(a.type!=="expression")continue;Ex(a,t.fillOpacity);break;case"id":case"type":case"domain":break;default:throw new Error("trying to call setProperty for: "+n)}}}_isParentFolderHidden(e){let t=this.getItemModel(e);if(!t)return!1;let i=Ws(t);return i?i.hidden:!1}_toggleItemHidden(e){if(this._isParentFolderHidden(e))this._setItemHidden(e,!1);else{let t=this.getItemModel(e);if(!t)return;switch(t.type){case"expression":this._setItemHidden(e,!Za(t));break;case"image":case"folder":this._setItemHidden(e,!t.hidden);break;case"table":case"text":break;default:return t}}}_toggleTableColumnHidden(e,t){if(this._isParentFolderHidden(e))this._setTableColumnHidden(e,t,!1);else{let i=this.getItemModel(e);if(!i||i.type!=="table")return;let o=la(i,t);if(!o)return;this._setTableColumnHidden(e,t,!o.hidden)}}_setTableColumnHidden(e,t,i){let o=this.getItemModel(e);if(!o||o.type!=="table")return;let n=Tk(o,t);!i&&this._isParentFolderHidden(e)&&this._setItemHidden(o.folderId,!1),K5(o,t,i),!i&&n&&fM(o,t,!0)}_setItemHidden(e,t){let i=this.getItemModel(e);if(i)switch(!t&&i.type!=="folder"&&this._isParentFolderHidden(i.id)&&this._setItemHidden(i.folderId,!1),i.type){case"expression":oN(i,t);break;case"folder":PN(i,t);break;case"image":XN(i,t);break;case"table":case"text":break;default:return i}}_addItemToEndFromAPI(e){let t=ik(this.listModel);!e.secret&&t&&t.type==="expression"&&t.latex===""&&Rf(this.listModel,t.index),Rc(this.listModel,e)}copyExpressionToIndex(e,t,i){let o={stripDefaults:!1},n;switch(e.type){case"expression":n=ng(e,o);break;case"table":n=qf(e,o),n.columns&&n.columns.forEach(s=>{s.id=this.generateId()});break;case"image":n=jS(e,o);break;case"text":n=zS(e,o);break;default:return}let a=this.createItemModel(__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},n),{id:this.generateId()}));this._toplevelInsertItemAt(t,a,!1,i||e.folderId)}_toplevelInsertItemAt(e,t,i,o){let n=t;Dl(this.listModel,n,e),o&&sa(n,o),i&&yn(this,n.id)}_toplevelNewItemAtSelection(e,t){this.setGeoTool("selection");let i=this.getSelectedItem();if(i){let s=i.type==="expression"&&!i.latex;if(s&&!i.folderId&&(e.type!=="expression"||e.latex))return this._toplevelReplaceItemAt(i.index,e,t.shouldFocus);if(s&&i.folderId&&e.type!=="expression"&&e.type!=="folder")return this._toplevelReplaceItemAt(i.index,e,t.shouldFocus);if(i.type!=="folder"&&!i.folderId){let l;return this._toplevelInsertItemAt(i.index+1,e,t.shouldFocus,l)}if(i.type!=="folder"&&i.folderId&&e.type!=="folder")return this._toplevelInsertItemAt(i.index+1,e,t.shouldFocus,i.folderId);if(i.type==="folder"&&!i.collapsed&&e.type!=="folder")return this._toplevelInsertItemAt(i.index+1,e,t.shouldFocus,i.id)}let o=this.getFirstFullyVisibleItem();for(o&&o.type==="folder"&&(o=this.getItemModelByIndex(o.index+1));o&&o.type!=="folder"&&o.folderId;)o=this.getItemModelByIndex(o.index+1);let n=o?o.index:this.getItemCount(),a;return this._toplevelInsertItemAt(n,e,t.shouldFocus,a)}getFirstFullyVisibleItem(){let e=nL(this);if(e)return Fc(this.listModel,e)}findEl(e){if(this.rootElt)return this.rootElt.querySelector(e)||void 0}getExppanelSelector(){return Xw(this)}scrollItemIntoView(e){if(!this.rootElt||!this.isListVisible())return;let t=this.getItemNodeById(e.id),i=Qw(this);if(!(!t||!i)){if(e.type==="table"){let o=t.querySelector(".dcg-row .dcg-selected");if(o){kl(o,i,60);return}}kl(t,i,90)}}scrollSelectedItemIntoView(){let e=this.getSelectedItem();if(e){if(e&&e.type!=="folder"&&e.folderId){let t=this.getItemModel(e.folderId);t&&t.type==="folder"&&t.collapsedChildIsSelected&&(e=t)}this.scrollItemIntoView(e)}}_pasteTable(e){let t=this.getGrapher();if(!t)return;let i=ok(this.listModel),o=mM(i,e,this),n=this.createItemModel(o);this._toplevelNewItemAtSelection(n,{shouldFocus:!0}),this._closeAddExpression();let a=t.getProjection(),s=a.viewport,l=__dcg_shared_module_exports__['s'](e[0],function(u){return parseFloat(u)}),c=__dcg_shared_module_exports__['s'](e[1],function(u){return parseFloat(u)});if(this.is3dProduct())return;let p={xmin:__dcg_shared_module_exports__['z'](l),xmax:__dcg_shared_module_exports__['y'](l),ymin:__dcg_shared_module_exports__['z'](c),ymax:__dcg_shared_module_exports__['y'](c),type:"table"};if(isFinite(p.xmin)&&isFinite(p.xmax)&&isFinite(p.ymin)&&isFinite(p.ymax)&&(p.xmax>s.xmax||p.xmin<s.xmin||p.ymax>s.ymax||p.ymin<s.ymin)){let u=Jw([p],a);if(u&&!this.viewportIsLocked()){let m=new lo(u.xmin,u.xmax,u.ymin,u.ymax);t.viewportController.setViewport(m),this._showToast({message:this.s("graphing-calculator-text-toast-zoom-to-fit"),undoCallback:()=>{this.dispatch({type:"undo"})}}),this.markSquareAxesAfterUserEditedViewport()}}}_insertSeveralExpressions(e){for(var t=0;t<e.length;t++){let i;i=this.createItemModel(e[t]),this._toplevelNewItemAtSelection(i,{shouldFocus:!0})}}_appendNumberList(e){let t=this.getSelectedItem();if(t&&t.type==="expression"){let i=t.latex,o=this.createItemModel({type:"expression",id:this.generateId(),latex:i+e});return this._toplevelReplaceItemAt(t.index,o,!0)}}_openOnWeb(){this.runAfterDispatch(()=>{let e=this.getGrapher();if(!e)return;let t=JSON.stringify(this.getState()),i=e.screenshot({width:100,height:100}),a=(this.getGraphSettings().config.crossOriginSaveTest?"/":"https://www.desmos.com/")+"api/v1/calculator/cross_origin_save",s=document.createElement("div");l4.mountToNode(f0,s,{stateData:()=>t,thumbData:()=>i,saveURL:()=>a}),this.rootElt.append(s);let l=s.querySelector("form[name=open_graph_on_web]");H(l).trigger("submit"),s.remove()})}notifyBugsnagAboutMissingSelectedItem(e,t){let i=Ff(this.listModel);var o="";try{i?o=JSON.stringify(i.cachedUndoRedoFullState,null,2):o="undefined"}catch(s){o="[[could not stringify]]"}var n="";try{if(!i)n="undefined";else{let s={id:i.id,index:i.index,displayIndex:i.index,secretIndex:i.secretIndex,guid:i.guid,renderShell:i.renderShell,isHiddenFromUI:i.isHiddenFromUI,hasDCGView:!!i.dcgView,cachedRenderHeight:i.cachedRenderHeight};n=JSON.stringify(s,null,2)}}catch(s){n="[[could not stringify]]"}var a="";try{a=JSON.stringify(lM(this.listModel),null,2)}catch(s){a="[[could not stringify]]"}fn("ReplaceItemAtError: no item at index",{metaData:{index:e,shouldFocus:t,selectedModelJSON:n,selectedItemJSON:o,listStateJSON:a}})}_toplevelReplaceItemAt(e,t,i){let o=t,n=this.getItemModelByIndex(e);n||this.notifyBugsnagAboutMissingSelectedItem(e,i);let a=n.type!=="folder"&&n.folderId;Rf(this.listModel,e),Dl(this.listModel,o,e),a&&sa(o,a),i&&yn(this,o.id)}convertImageToDraggable(e){let t=this.getItemModel(e);if(!t||t.type!=="image")return;let i=t.folderId,o=t.index+1,n=t.center,a=ok(this.listModel),s=__dcg_shared_module_exports__['hb']("C_"+a),l=this.createItemModel({id:this.generateId(),type:"expression",latex:s+"="+n,dragMode:"XY",hidden:!0});Dl(this.listModel,l,o),i&&sa(l,i),$s(t,"center",s),Y1(t,!0),J1(t,!0),this.listModel.openItemMenu=void 0}createSlidersForItem(e,t){let i=this.getItemModel(e);if(!i)return;let o=i.type!=="folder"&&i.folderId;return this.createSliders({model:i,folderId:o,index:i.index+1},t)}createSlidersForTicker(e){return this.createSliders({model:this.listModel.ticker,folderId:!1,index:0,doNotChangeFocus:!0},e)}createSliders({model:e,folderId:t,index:i,doNotChangeFocus:o},n){var a=[];e.type==="ticker"?XS(e,(m,h)=>{a.push({latex:m,location:h})}):Tf(e,(m,h)=>{a.push({latex:m,location:h.location})});var s=OK(a,n,{degreeMode:this.graphSettings.degreeMode});let l=e.formula?e.formula.action_value:void 0;for(var c=n.map(m=>{var h=s[m],x="1";h&&h.value!==void 0&&(x=h.value);var C;m===""?C="":l&&l.hasOwnProperty(m)?C=l[m]:C=__dcg_shared_module_exports__['hb'](m)+"="+x;var D={type:"expression",id:this.generateId(),latex:C,color:this.getNextColor(),hidden:!!C};return h&&(h.min!==void 0&&(D.slider||(D.slider={}),D.slider.hardMin=!0,D.slider.min=h.min),h.max!==void 0&&(D.slider||(D.slider={}),D.slider.hardMax=!0,D.slider.max=h.max),h.step!==void 0&&(D.slider||(D.slider={}),D.slider.step=h.step)),D}),p=c.length-1;p>=0;p--){let m=this.createItemModel(c[p]);Dl(this.listModel,m,i),t&&sa(m,t)}if(o)return;let u=c[c.length-1];u.latex===""?yn(this,u.id):Fi(this,void 0)}_uploadImagesAndWaitForThemToLoad(e){let{files:t,id:i}=e;if(!t||t.length===0){this._showToast({message:this.s("graphing-calculator-text-toast-no-file-selected")});return}if(i&&t.length>1){this._showToast({message:this.s("graphing-calculator-text-toast-choose-one-file")});return}let o=c3({controller:this,files:t,id:i}),n=o.errors[0];n&&this._showToast({message:n});for(let a of o.tokens)this.__pendingImageUploads[a]=!0;this.isUploadingImages()&&this._showToast({message:this.s("graphing-calculator-text-toast-uploading-images"),onHide:()=>{this._clearPendingImageUploads()}})}getImageToRetry(){let e;for(let t of this.getAllItemModels())t.type==="image"&&t.loadStatus==="failed"&&(!e||e.failures>t.failures)&&(e=t);return e}retryLoadingFailedImage(e){let t=Date.now(),i=t-this.imageRetryState.lastAttemptTime,o=1e3*Math.pow(2,this.imageRetryState.attempts);this.imageRetryState.attempts>0&&i<o||(Q1(e),this.imageRetryState={lastAttemptTime:t,attempts:this.imageRetryState.attempts+1})}getSelectedItem(){return Ff(this.listModel)}getAllSelectedItems(){return ak(this.listModel)}getOpenItemMenu(){return this.listModel.openItemMenu}isItemSettingsMenuOpen(e){var t=this.listModel.openItemMenu;return t?t.guid===e:!1}closeItemSettingsMenu(){let e=this.getOpenItemMenu();e!==void 0&&(e.focusFirstOption&&(e.previousFocusLocation!==void 0?Fi(this,e.previousFocusLocation):this.focusOpenMenuIcon()),this.listModel.openItemMenu=void 0)}focusOpenMenuIcon(){let e=this.getOpenItemMenu();e&&(e.type==="slider"?this.dispatch({type:"set-focus-location",location:{type:"slider-animation-properties-icon",id:e.model.id}}):e.type==="image"?this.dispatch({type:"set-focus-location",location:{type:"image-icon",id:e.model.id}}):e.type==="table-column"?this.dispatch({type:"set-focus-location",location:{type:"table-icon",id:e.model.table.id,columnId:e.model.id}}):e.type==="geo-tool-dropdown"?this.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:e.tools[0]}}):e.type==="multi-select-more"?this.dispatch({type:"set-focus-location",location:{type:"multi-select-more-icon"}}):e.type==="multi-select-transformations"?this.dispatch({type:"set-focus-location",location:{type:"multi-select-transformations-icon"}}):this.dispatch({type:"set-focus-location",location:{type:"expression-icon",id:e.model.id}}))}getFocusedItem(){return _K(this)}getFocusLocation(){return this.focusLocation}isFocusLocationFocused(e){let t=this.focusLocation,i=e;return!t||!i?!1:__dcg_shared_module_exports__['P'](t,i)}isCurrentFocusLocationValid(){let e=this.focusLocation;if(!e)return!0;if(e.type==="settings")return e.location==="icon"||this.isGraphSettingsOpen();if(e.type==="add-item-btn"||e.type==="edit-list-toggle"||e.type==="hide-expression-list-btn"||e.type==="show-expression-list-btn")return this.isListEnabled();if(e.type==="add-expression-btn"||e.type==="add-table-btn")return this.layoutModel.addExpressionOpen;if(e.type==="add-note-btn")return this.layoutModel.addExpressionOpen&&this.areNotesEnabled();if(e.type==="add-folder-btn")return this.layoutModel.addExpressionOpen&&this.areFoldersEnabled();if(e.type==="add-ticker-btn")return this.layoutModel.addExpressionOpen&&this.areActionsEnabled();if(e.type==="add-image-btn")return this.layoutModel.addExpressionOpen&&this.areImagesEnabled();if(e.type==="zoom-in-btn"||e.type==="zoom-restore-btn")return!0;if(e.type==="search-expressions"||e.type==="replace-expressions")return this.expressionSearchOpen;if(e.type==="ticker")return this.listModel.ticker.open;if(e.type==="generic-menu")return!!this.getOpenItemMenu();if(e.type==="graph-paper"){let o=this.getGrapher();return!!(o&&o.getIsVisible()&&o.settings.config.graphpaper)}if(e.type==="geo-show-constructions-icon"||e.type==="geo-token"||e.type==="multi-select-more-icon"||e.type==="multi-select-transformations-icon"||e.type==="label-points-icon")return this.isGeoUIActive();if(e.type==="new-transformation-number"){let o=this.getGeoModel(),n=o.getCurrentTool(),a=o.getNonObjectsState().ui.currentTool.inputIndex,s=n.getSpec&&n.getSpec();return!!s&&!!s.inputs[a]&&!!s.inputs[a].numberInputInfo}if(e.type==="geo-header-back-link"||e.type==="multi-select-delete-icon"||e.type==="multi-select-show-hide-icon")return this.isGeoUIActive()&&this.hasAnyItemsSelected();if(e.type==="geo-basic-tool")return this.isGeoUIActive()&&e.tool!=="expression-edit";if(e.type==="regression-output")return!!this.getItemModel(e.id)&&e.parameter!=="";if(e.type==="quest")return this.getQuestIsActive();let t=this.getOpenItemMenu();if(e.type==="geo-basic-tool-menu-item")return this.isGeoUIActive()&&e.tool!==""&&t!==void 0&&t.type==="geo-tool-dropdown";let i;if(t&&t.type==="table-column"?i=t.model.table:i=this.getItemModel(e.id),!i)return!1;if(e.type==="change-image-btn")return this.listModel&&i.type==="image"&&this.areImagesEnabled();if(e.type==="expression-menu"){if(e.location==="start"||e.location==="end"||e.location==="updaterule"||e.location==="anywhere"||i.type==="table")return!0;if(i.type!=="expression")return!1;let{points:o,lines:n,fill:a}=i;Ld(i)&&(a=!0);let s=__dcg_shared_module_exports__['pc'](i.formula.expression_type,{points:o,lines:n,fill:a});return!(!s.fill&&!s.points&&!s.lines&&!i.showLabel)}if(!this.isItemSelected(e.id)&&e.type!=="editable-label")return!1;switch(e.type){case"domain-limit":return!(i.type!=="expression"||!ES(i)&&!GS(i));case"expression-icon":case"top-level-icon":return!0;case"image-icon":return i.type==="image"&&i.loadStatus!=="loading"&&i.loadStatus!=="failed"&&!i.error;case"action-icon":return!(i.type!=="expression"||!xf(i));case"slider-icon":case"slider-animation-properties-icon":case"slider-thumb":case"slider-limit":return!(i.type!=="expression"||!hN(i));case"table-icon":return i.type==="table"&&this.getGraphSettings().config.graphpaper;case"visualization-prop":return!(i.type!=="expression"||!LS(i));case"distribution-param":if(i.type!=="expression")return!1;let o=vl(i);return o?e.location in o.values:!1;case"cdf-limit":return i.type!=="expression"?!1:Pd(i);case"image":return i.type==="image";case"folder":return i.type==="folder";case"text":return i.type==="text";case"expression":return!(i.type!=="expression"||this.isInEditListMode()||e.isFakeGraphFocus&&!this.getValidCursorContext());case"readonly-expression":return this.isItemReadonly(i.id)||i.type==="expression"&&this.isInEditListMode();case"braille-output":return i.type==="expression"&&this.getBrailleMode()!=="none";case"table":return i.type!=="table"?!1:H5(i,e.location);case"table-container":return i.type==="table"&&this.isInEditListMode();case"editable-label":return i.type!=="expression"?!1:bf(i);default:return e}}shouldAllowMovingPointsWithKeyboard(){let e=this.getActiveTool();return e==="selection"||e==="box-selection"}isDragDropActive(){return!!this.listModel.dragState}isItemBeingDragged(e){let t=this.listModel.dragState;return!(!t||t.firstItemId!==e)}shouldRenderDraggedItemAsToken(){let e=this.listModel.dragState;return e?e.renderType==="token":!1}canDraggedItemBeMovedIntoTokenPane(){var n,a,s,l,c;let e=this.getDraggedItemId();if(!e)return!1;let t=this.getItemModel(e);if(!t||t.type!=="expression")return!1;let i=(n=t.formula.geometry)==null?void 0:n.valueType;if(i===void 0)return!1;let o=(s=(a=t.formula.geometry)==null?void 0:a.call)==null?void 0:s.parents;if(o){let p=(c=(l=t.formula.geometry)==null?void 0:l.call)==null?void 0:c.symbol;for(let u=0;u<o.length;u++){let m=o[u];if(!(p==="rotate"&&u===1||p==="dilate"&&u===1)){if(p==="glider"&&u===1){let h=T1(t),x=h&&h[1];return x&&x.type==="Decimal"}if(p==="translate"&&u===1){let h=T1(t),x=h&&h[0],C=h&&h[1];if(x&&__dcg_shared_module_exports__['fc'](x)&&(C==null?void 0:C.type)==="Dot"&&C.args[1].type==="Cmd"&&C.args[1].val==="start"&&__dcg_shared_module_exports__['fc'](C.args[0])&&__dcg_shared_module_exports__['$'](x.span)===__dcg_shared_module_exports__['$'](C.args[0].span))return!0}if(!m)return!1}}return!(__dcg_shared_module_exports__['Pa'](i,__dcg_shared_module_exports__['Ba'])&&!__dcg_shared_module_exports__['ac'](p))}if(__dcg_shared_module_exports__['Pa'](i,__dcg_shared_module_exports__['da'])){let p=t.latex.slice(t.latex.indexOf("=")+1);if(/^ *(\\left)*\([0-9. ,-]+(\\right)*\) *$/.test(p))return!0}return!1}getDraggedItemId(){let e=this.listModel.dragState;return e&&e.firstItemId}getDraggedIdentifier(){var i;let e=this.getRawDragState();if(!e)return;let t=this.getItemModel(e.dragTarget.calcId);if(!(!t||t.type!=="expression"))return(i=Fo(t))==null?void 0:i.identifier}getRawDragState(){return this.listModel.dragState}initStateStack(){this.stateStack=new tu,this.stateStack.addState({diffState:this.getUndoRedoDiffState(),fullState:this.getUndoRedoFullState()})}getUndoRedoDiffState(){var e;return{randomSeed:this.getRandomSeed(),layoutModel:this.layoutModel,settingsViewModel:this.settingsViewModel,graph:(e=this.getGrapher())==null?void 0:e.getUndoRedoDiffState(),expressions:r5(this.listModel),geometryToolbar:eM(this.geometryToolbarModel),wasCompleteSetState:this.isCurrentlyDoingSetState}}getUndoRedoFullState(){var e;return{randomSeed:this.getRandomSeed(),layoutModel:this.layoutModel,settingsViewModel:this.settingsViewModel,graph:(e=this.getGrapher())==null?void 0:e.getUndoRedoFullState(),expressions:lM(this.listModel),geometryToolbar:eM(this.geometryToolbarModel),wasCompleteSetState:this.isCurrentlyDoingSetState}}getState(e){var n,a;let t={stripDefaults:!0};e&&e.hasOwnProperty("stripDefaults")&&(t.stripDefaults=!!e.stripDefaults);let i=(a=(n=this.getGrapher())==null?void 0:n.getState(t))!=null?a:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.getBlankState().graph),{degreeMode:this.graphSettings.degreeMode});var o={version:$l,randomSeed:this.getRandomSeed(),graph:i,expressions:i5(this.listModel,t)};if(this.isGeometry()){let s=E3(this.geometryToolbarModel,t);s&&(o.geometryToolbar=s)}return e&&e.avoidBackMigration?__dcg_shared_module_exports__['j'](o):j_(__dcg_shared_module_exports__['j'](o))}isGeometry(){return this.graphSettings.config.product==="geometry-calculator"}is3dProduct(){return this.graphSettings.config.product==="graphing-3d"}isMultiSelectEnabled(){return this.isGeometry()}canLoadPastedLink(e){return this.graphSettings.config.pasteGraphLink?this.isGeometry()?m0(e)||cL(e)||pL(e):this.is3dProduct()?dL(e):m0(e):!1}getBlankState(e){if(this.isGeometry())return Zm;if(this.is3dProduct())return t4;let t;return(e==null?void 0:e.degreeMode)!==void 0?t=e.degreeMode:t=this.graphSettings.config.clearIntoDegreeMode,t?__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},lh),{graph:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},lh.graph),{degreeMode:!0})}):lh}externalSetState(e,t){this._clearPendingImageUploads(),this.rootElt&&document.activeElement&&this.rootElt.contains(document.activeElement)&&H(document.activeElement).trigger("blur"),t||(t={}),e||(e=this.getBlankState()),typeof e=="string"&&(e=JSON.parse(e)),e&&(e=Vc(e));let i=this.graphSettings.config.product,o;if(!e.graph||e.graph.product===void 0?o="graphing":o=e.graph.product,o!==i)throw new Error(`Data Error: state appears to have been saved in the '${o}' product and cannot be opened in the '${i}' product.`);i==="geometry-calculator"&&(this.showConstructionsOpen=!1),i==="graphing-3d"&&Fm&&e.graph.speed3D&&delete e.graph.speed3D;let n=this.layoutModel;this.setState(e,t),X3(this.listModel),nk(this.listModel),this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},iL(this.graphSettings.config)),{keypadMinimized:n.keypadMinimized,keypadLayout:n.keypadLayout,keypadFunctionsOpen:n.keypadFunctionsOpen,expressionsVisible:!!this.graphSettings.config.expressions&&(this.isListVisible()||!!t.forceExpressionsOpen)}),this.settingsViewModel=oL(),Fi(this,void 0),t.forceUnsavedChanges?this.enqueueEvent("change"):this.enqueueEvent("clearUnsavedChanges")}setState(e,t){if(this.isCurrentlyDoingSetState=!0,this.suggestedIdentifierRename=void 0,this.lastUserUpdatedExpressionItem=void 0,"graph"in e&&e.graph!==void 0){if("threeDMode"in e.graph&&e.graph.threeDMode&&this.grapher3d){if("showBox3D"in e.graph&&this.grapher3d.webglLayer.showBox(e.graph.showBox3D),"showAxis3D"in e.graph&&this.grapher3d.webglLayer.showAxes(!!e.graph.showAxis3D),"showAxisLabels3D"in e.graph&&this.grapher3d.webglLayer.updateAxes(),"showPlane3D"in e.graph||"showAxis3D"in e.graph){let n=("showPlane3D"in e.graph?!!e.graph.showPlane3D:this.graphSettings.showPlane3D)&&("showAxis3D"in e.graph?!!e.graph.showAxis3D:this.graphSettings.showAxis3D);this.grapher3d.webglLayer.showPlane(n)}let o=this.grapher3d.baseplaneWidth();this.grapher2d.setCanvasSizeFor3D(o,o),this.grapher3d.webglLayer.setBackgroundColor(e.graph.backgroundColor3d)}let i=this.getGrapher();i?i.setGrapherState(e.graph):Pg.copyGraphProperties(e.graph,this.graphSettings),"threeDMode"in e.graph&&e.graph.threeDMode&&this.grapher3d&&this.grapher3d.controls.copyWorldRotationToWorld()}if("expressions"in e){Zr(this.listModel,void 0);let i=o5(e.expressions);i>=this.__nextItemId&&(this.__nextItemId=i+1),n5(this.listModel,e.expressions,t||{})}if(e.layoutModel&&(this.layoutModel=e.layoutModel),e.settingsViewModel&&(this.settingsViewModel=e.settingsViewModel),(!t||!t.allowUndo)&&this.clearUndoRedoHistory(),this.setRandomSeed(e.randomSeed||Sd()),"geometryToolbar"in e){let i=e.geometryToolbar;this.geometryToolbarModel=ZS(i)}}updateToState(e){if(this.isCurrentlyDoingRestoreState=!0,this.suggestedIdentifierRename=void 0,this.lastUserUpdatedExpressionItem=void 0,"graph"in e&&(e.graph.threeDMode?this.grapher3d&&this.grapher3d.setGrapherState(e.graph):this.grapher2d&&this.grapher2d.setGrapherState(e.graph,{doNotClear:!0})),"expressions"in e&&a5(this.listModel,e.expressions),e.layoutModel&&(this.layoutModel=e.layoutModel),e.settingsViewModel&&(this.settingsViewModel=e.settingsViewModel),"geometryToolbar"in e){let t=e.geometryToolbar;this.geometryToolbarModel=ZS(t)}}commitUndoRedoSynchronously(e){let t=this.stateStack.getState(),i=t&&t.diffState,o=this.getUndoRedoDiffState();if(hZ(i,o))return;let n=this.apiMethodCallStackInfo.withHistoryReplacementDepth>0,a={diffState:o,fullState:this.getUndoRedoFullState()};!n&&a4(e)?(this.stateStack.addState(a),this.enqueueEvent("change",e)):this.stateStack.replaceInteriorState(a)}undo(){if(!this.canUndo())return;this.closeToast(),this.stateStack.undo();let e=this.stateStack.getState().fullState;e.wasCompleteSetState?this.setState(e,{allowUndo:!0}):this.updateToState(e),this.enqueueEvent("change",{type:"undo"})}redo(){if(!this.canRedo())return;this.stateStack.redo();let e=this.stateStack.getState().fullState;e.wasCompleteSetState?this.setState(e,{allowUndo:!0}):this.updateToState(e),this.enqueueEvent("change",{type:"undo"})}clearUndoRedoHistory(){this.stateStack.clear()}canUndo(){return this.stateStack.canUndo()}canRedo(){return this.stateStack.canRedo()}closeToast(){let e=this.toastData.onHide;e&&this.runAfterDispatch(e),this.toastData={}}_closeAddExpression(){this.layoutModel=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.layoutModel),{addExpressionOpen:!1})}doesDOMHaveSize(){return this.layoutMeasurements.width>0&&this.layoutMeasurements.height>0}_getExpListWidth(){var e;if(this.userSpecifiedExpListWidth!==void 0){let o=this.isGeometry()?320:200;e=Math.max(280,Math.min(this.layoutMeasurements.width-o,this.userSpecifiedExpListWidth))}else{if(e=this.layoutMeasurements.width,!e)return 356;var t=.2*e+160;e=Math.min(500,Math.max(280,t))}var i=this.layoutMeasurements.width-this.getGrapherHeight();return Math.abs(i-e)<=10?i:e}_setExpListWidth(e){this.userSpecifiedExpListWidth!==e&&(this.userSpecifiedExpListWidth=e)}getKeypadHeight(){return this.computeMajorLayout().keypad.height}isKeypadEnabled(){return!!this.graphSettings.config.keypad}isKeypadOpen(){if(!this.isKeypadEnabled())return!1;let e=this.layoutModel.keypadMinimized&&!this.isNarrow();return this.needsFakeKeypad()&&!e}isHideKeypadButtonVisible(){return this.getBrailleMode()==="none"&&this.isKeypadOpen()&&(!this.isNarrow()||this.inAudioTraceMode())}isKeypadFunctionsPopoverOpen(){return!!this.layoutModel.keypadFunctionsOpen}getKeypadLayout(){let e=this.layoutModel.keypadLayout;return this.isThreeDMode()?BK(e):e}isLetterKeypadOpen(){let e=this.getKeypadLayout();return this.isKeypadOpen()&&(e==="letters"||e==="noQwertyLetters"||e==="capitalLetters"||e==="noQwertyCapitalLetters")}isFileDraggedOver(){return this.layoutModel.isFileDraggedOver}getGeoToolbarHeight(){return this.shouldShowGeoToolbar()?48:0}isNarrowGeometryHeader(){return this.computeMajorLayout().grapher.width<450}shouldShowMultiSelectHeader(){return this.getSelectedGeoExpression()||this.hasMultipleItemsSelected()}getGrapherHeight(){return this.layoutMeasurements.height-this.getGeoToolbarHeight()}computeMajorLayout(){var e=this.layoutMeasurements.width,t=this.layoutMeasurements.height,i=this.isNarrow(),o=this.isListVisible(),n=this.isKeypadOpen(),a=!this.isGrapherEnabled(),s=!this.isListEnabled(),l=!!this.getGraphSettings().config.projectorMode,c={left:0,top:0,width:0,height:0},p={left:0,top:0,width:0,height:0,paddingTop:0},u={left:0,top:t,width:e,height:l?i?185:193:169};s?(p.width=e,p.height=t):a?(c.width=e,c.height=t):o?i?(c.width=e,c.height=Math.round(.58*t),c.top=t-c.height,p.width=e,p.height=t-c.height):(c.width=this.getExpListWidth(),c.height=t,p.left=c.width,p.width=e-p.left,p.height=t):o||(i?(c.width=e,c.height=Math.round(.58*t),c.top=t,p.width=e,p.height=t):(c.width=this.getExpListWidth(),c.height=t,c.left=-c.width,p.width=e,p.height=t)),n&&(u.top-=u.height,s||(c.height-=u.height));let m=this.getGeoToolbarHeight();return m&&(p.top+=m,p.height-=m),{list:c,grapher:p,keypad:u}}isNarrow(){return this.isGeometry()?this.layoutMeasurements.width<600:this.layoutMeasurements.width<450}getLayoutMeasurements(){return this.layoutMeasurements}getCapExpressionSize(){return!!this.getGraphSettings().config.capExpressionSize}handleAudioTraceCommand(e){let t=this.getAudioGraph();if(t===void 0)return;let i=t.agNavigator;switch(e){case"on":this.runAfterDispatch(()=>{t.enterAudioTrace({fromKeypad:!0})});break;case"off":this.runAfterDispatch(()=>{t.exitAudioTrace()});break;case"hear-graph":t.hearGraph();break;case"stop-graph":t.stopGraph();break;case"volume-down":t.adjustVolume("down");break;case"volume-up":t.adjustVolume("up");break;case"speed-down":t.speedDown();break;case"speed-up":t.speedUp();break;case"previous-point":this.runAfterDispatch(()=>{t.reportAndMoveToPrevPoint()});break;case"next-point":this.runAfterDispatch(()=>{t.reportAndMoveToNextPoint()});break;case"previous-poi":this.runAfterDispatch(()=>{t.reportAndMoveToPrevPOI()});break;case"next-poi":this.runAfterDispatch(()=>{t.reportAndMoveToNextPOI()});break;case"previous-curve":this.runAfterDispatch(()=>{i.prevCurve()});break;case"next-curve":this.runAfterDispatch(()=>{i.nextCurve()});break;case"describe-point":t.describePoint();break;case"describe-curve":t.describeCurve();break;case"describe-axes":t.describeAxes();break;case"keyboard-shortcuts":this.enqueueEvent("showHotkeysModal",{type:"keypad/audio-trace",command:e});break;default:return e}}setAudioTraceSpeed(e){let t=this.getAudioGraph();t&&t.adjustPlaybackSpeed(e)}setGraphPaperFocus(e){var t;Fi(this,e.isFocused?{type:"graph-paper"}:void 0),(t=this.get2dPOIController())==null||t.keyboardAttentionManager.setKeyboardAttention(void 0),this.requestRedrawGraph(),e.isFocused&&this.isGeoToolActive()&&this.runAfterDispatch(()=>{var i;(i=this.get2dPOIController())==null||i.keyboardAttentionManager.handleGrapherGainedFocus()})}isGraphPaperFocused(){let e=this.getFocusLocation();return e?!!(e.type==="graph-paper"||e.type==="expression"&&e.isFakeGraphFocus):!1}isVirtualMouseAllowed(){return!(!this.isGeometry()||!this.isGraphPaperFocused()||!this.geoModel.getCurrentTool().canNextInputBePoint())}isClickableId(e){return Bf(this.getItemModel(e))}setCanShowKeyboardShortcuts(e){this.canShowKeyboardShortcuts=e}getCanShowKeyboardShortcuts(){return this.canShowKeyboardShortcuts}apply3dProps(e){if(!this.isThreeDMode()||!this.grapher3d)return;let t=this.grapher3d.webglLayer;for(let i in e)switch(i){case"showPlane3D":t.showPlane(this.showPlane3D());break;case"showBox3D":t.showBox(!!e[i]);break;case"showAxis3D":t.showAxes(!!e[i]),t.showPlane(this.showPlane3D());break;case"showAxisLabels3D":t.updateAxes();break;default:break}}getGeometryTokenCount(){if(!this.cachedGeoTokenDepths)return 0;let e=0;return __dcg_shared_module_exports__['s'](__dcg_shared_module_exports__['N'](this.cachedGeoTokenDepths),t=>e+=t?t.length:0),e}getAllGeometryConstructionIds(){return R3(this.listModel,__dcg_shared_module_exports__['ad'])}makeGeoAPI(){this.geoModel=new $w(this)}getGeoTokenInfoFromIdentifier(e){if(e)return this.cachedGeoTokenInfo[e]}getGhostMode(){return this.getGraphSettings().config.getProperty("ghostMode")}isDispatching(){return this.dispatcher.isDispatching()}getSuggestedIdentifierRenameInfo(e){if(this.suggestedIdentifierRename&&this.suggestedIdentifierRename.id===e)return this.suggestedIdentifierRename}updateSuggestedIdentifierRenameInfo(){if(!this.shouldShowAuthorFeatures())return;let e=this.lastUserUpdatedExpressionItem;if(!e){this.suggestedIdentifierRename=void 0;return}this.suggestedIdentifierRename&&this.suggestedIdentifierRename.id!==e.id&&(this.suggestedIdentifierRename=void 0);var t=e.formula.assignment||"",i=t?__dcg_shared_module_exports__['hb'](t):"";if(!this.suggestedIdentifierRename){i&&(this.suggestedIdentifierRename={id:e.id,from:i,to:i,countOfChanges:0});return}if(i!==this.suggestedIdentifierRename.to){if(this.suggestedIdentifierRename.to=i,this.suggestedIdentifierRename.from===this.suggestedIdentifierRename.to||!this.suggestedIdentifierRename.from||!this.suggestedIdentifierRename.to){this.suggestedIdentifierRename.countOfChanges=0;return}if(this.countIdentifierAssignments(t)>1){this.suggestedIdentifierRename.countOfChanges=0;return}var o=this.countGlobalIdentifierOccurences(this.suggestedIdentifierRename.from);this.suggestedIdentifierRename.countOfChanges=o}}getMathquillConfig(e){let t=e.additionalOperators||[];return{autoOperatorNames:Ys({additionalOperators:t,includeGeometryFunctions:this.isGeometry(),include3DFunctions:this.is3dProduct()}),autoCommands:qd({additionalCommands:this.isGeometry()?[]:["int"],disallowAns:this.isGeometry()})}}constrainMultiSelect(){if(this.isMultiSelectEnabled())return;let e=ak(this.listModel);e.length>1&&Zr(this.listModel,e[0])}focusFirstExpression(){if(!this.getGraphSettings().config.expressions)return;let e=Af(this.listModel);e&&yn(this,e.id,"end")}};function s4(r){return r&&__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},r),{wasCompleteSetState:void 0,layoutModel:void 0,settingsViewModel:void 0})}function hZ(r,e){return __dcg_shared_module_exports__['P'](s4(r),s4(e))}var jb=__dcg_shared_module_exports__['h'](z());xt();var tv=class{constructor(e){this.previousPaneFocusLocations={main:void 0,quest:void 0};this.controller=e}handleKeydown(e){var i,o,n,a;let t=ki(e);if(Qh(e))e.stopPropagation(),e.preventDefault(),this.controller.hasVisibleAndUndoableToast()?this.controller.toastUndo():this.controller.dispatch({type:"undo"});else if(Zh(e))e.stopPropagation(),e.preventDefault(),this.controller.dispatch({type:"redo"});else if(e.altKey&&!e.ctrlKey&&!e.metaKey&&e.shiftKey&&t==="Z"){let s=this.controller.getSelectedItem();s&&s.id&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"expression-zoom-fit",id:s.id,focusAfterTap:!1}))}else if(e.altKey!==oi&&e.metaKey===oi&&!e.ctrlKey&&e.shiftKey&&t==="A"&&this.controller.isDecimalToFractionEnabled()){let s=this.controller.getSelectedItem();s&&s.type==="expression"&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"toggle-fraction-evaluation",id:s.id}),this.controller.runAfterDispatch(()=>{Uu(s)?be(this.controller.s("shared-calculator-narration-show-as-fraction")):be(this.controller.s("shared-calculator-narration-show-as-decimal"))}))}else if(!e.altKey&&e.ctrlKey!==oi&&e.metaKey===oi&&t==="F"){if(this.controller.isExpressionListFocused()){let s=_e.getFocusedMathquill(),l="";try{l=s.__controller.cursor.selection.join("latex")||""}catch(c){}this.controller.dispatch({type:"open-expression-search",rename:!!e.shiftKey,latex:l}),e.preventDefault(),e.stopPropagation()}}else if((e.altKey||e.metaKey)&&!e.ctrlKey&&!e.shiftKey&&t===void 0){if(Ee(e)===gn){let s=this.controller.getSelectedItem();s&&s.type==="folder"&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-folder-collapsed",id:s.id,isCollapsed:!0}),be(this.controller.s("graphing-calculator-narration-folder-collapsed")))}else if(Ee(e)===mn){let s=this.controller.getSelectedItem();s&&s.type==="folder"&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-folder-collapsed",id:s.id,isCollapsed:!1}),be(this.controller.s("graphing-calculator-narration-folder-expanded")))}}else if(e.shiftKey&&(e.altKey||e.metaKey)&&!e.ctrlKey){if(Ee(e)===gn)e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-all-folders-collapsed",isCollapsed:!0}),be(this.controller.s("graphing-calculator-narration-all-folders-collapsed"));else if(Ee(e)===mn)e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-all-folders-collapsed",isCollapsed:!1}),be(this.controller.s("graphing-calculator-narration-all-folders-expanded"));else if(t==="E"){if(!this.controller.isListEnabled())return;this.controller.isListVisible()?(this.controller.dispatch({type:"hide-expressions-list",focusShowIcon:!1}),be(this.controller.s("graphing-calculator-narration-hide-expression-list"))):(this.controller.dispatch({type:"show-expressions-list",focusHideIcon:!1}),this.focusExpressionList()),e.preventDefault(),e.stopPropagation()}}else if(e.ctrlKey&&(e.altKey||e.metaKey)&&!e.shiftKey){if(t==="E"){if(!this.controller.isListEnabled())return;e.preventDefault(),e.stopPropagation(),this.focusExpressionList()}else if(t==="X"){if(!this.controller.isListEnabled())return;e.preventDefault(),e.stopPropagation(),this.controller.canUserAddExpressions()?(be(this.controller.s("graphing-calculator-narration-add-expression")),this.controller.dispatch({type:"new-expression"})):be(this.controller.s("graphing-calculator-narration-unable-to-add-expression"))}else if(t==="O"){if(!this.controller.isListEnabled())return;e.preventDefault(),e.stopPropagation(),this.controller.canUserAddExpressions()&&this.controller.areNotesEnabled()?(be(this.controller.s("graphing-calculator-narration-add-note")),this.controller.dispatch({type:"new-text"})):be(this.controller.s("graphing-calculator-narration-unable-to-add-note"))}else if(t==="F"&&this.controller.canUserAddExpressions()&&this.controller.areFoldersEnabled())e.preventDefault(),e.stopPropagation(),be(this.controller.s("graphing-calculator-narration-add-folder")),this.controller.dispatch({type:"new-folder"});else if(t==="I"&&this.controller.canUserAddExpressions()&&this.controller.areImagesEnabled())e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"toggle-add-expression",focusOnOpen:!1}),this.controller.runAfterDispatch(()=>{let s=this.controller.findEl(".dcg-add-expression-container input[type=file]");s&&(H(s).trigger("click"),be(this.controller.s("graphing-calculator-narration-add-image")))});else if(t==="T")e.preventDefault(),e.stopPropagation(),this.controller.canUserAddExpressions()?(be(this.controller.s("graphing-calculator-narration-add-table")),this.controller.dispatch({type:"new-table"})):be(this.controller.s("graphing-calculator-narration-unable-to-add-table"));else if(t==="M"&&this.controller.isGeoUIActive())if(e.preventDefault(),e.stopPropagation(),this.controller.getGeoToolbarGroupKeys().length>0){let s=this.controller.getActiveTool();this.controller.shouldShowMultiSelectHeader()?this.controller.dispatch({type:"set-focus-location",location:{type:"geo-header-back-link"}}):(s==="expression-edit"&&(s="selection"),this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:s}}))}else be(this.controller.s("graphing-calculator-narration-no-geometry-tools-available"));else if(t==="C"&&this.controller.isGeoUIActive())e.preventDefault(),e.stopPropagation(),this.controller.getGeometryTokenCount()>0?this.controller.dispatch({type:"set-show-constructions-open",open:!0,setFocus:!0}):be(this.controller.raw("Object navigator has no items."));else if(t==="G")e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"toggle-graph-settings",focusOnOpen:!0});else if(t==="P"){if(e.preventDefault(),e.stopPropagation(),this.controller.isGeometry()){let s=this.controller.getFocusLocation(),l=this.controller.getValidCursorContext();if(s&&s.type==="expression"&&l&&l.type!=="empty"){this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:s.id,isFakeGraphFocus:!0}}),(o=(i=this.controller.getGrapher2d())==null?void 0:i.poiController)==null||o.keyboardAttentionManager.handleGrapherGainedFocus();return}}this.controller.dispatch({type:"set-focus-location",location:{type:"graph-paper"}})}else if(t==="Z"){let s=this.controller.getSelectedItem();s&&s.id&&this.controller.dispatch({type:"expression-zoom-fit",id:s.id,focusAfterTap:!1})}else if(t==="D"&&this.controller.canUserAddExpressions()){e.preventDefault(),e.stopPropagation();let s=!this.controller.isInEditListMode();this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:s,focusExpressionList:!0})}}else if(CV(e)&&this.controller.getQuestIsActive()){((n=this.controller.focusLocation)==null?void 0:n.type)==="quest"?(this.previousPaneFocusLocations.quest=this.controller.focusLocation,this.previousPaneFocusLocations.main?this.controller.dispatch({type:"set-focus-location",location:this.previousPaneFocusLocations.main}):this.focusExpressionList()):(this.previousPaneFocusLocations.main=this.controller.focusLocation,this.controller.dispatch({type:"set-focus-location",location:(a=this.previousPaneFocusLocations.quest)!=null?a:{type:"quest",location:"quest-pane"}})),e.preventDefault(),e.stopPropagation();return}else if(!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey){if(Ee(e)===Hl)(!document.activeElement||!tg(document.activeElement))&&e.preventDefault();else if(Ee(e)===hn&&!this.controller.getOpenItemMenu()&&!this.controller.isGraphSettingsOpen()){if(this.controller.isGeoUIActive()){let s=!1,l=this.controller.getGeoModel();if(this.controller.hasAnyItemsSelected()&&(this.controller.dispatch({type:"set-none-selected"}),s=!0),l.isToolplayActive()&&(this.controller.dispatch({type:"cancel-geo-toolplay"}),be(this.controller.s("graphing-calculator-narration-geometry-tool-cancelled")),s=!0),this.controller.isGraphPaperFocused()&&(this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:this.controller.getActiveTool()}}),s=!0),this.controller.getActiveTool()!=="selection"&&!s){this.controller.dispatch({type:"select-geo-tool",tool:"selection"});let c=this.controller.getFocusLocation();c&&c.type==="geo-basic-tool"&&this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:this.controller.getActiveTool()}}),s=!0}if(s){e.preventDefault(),e.stopPropagation();return}}this.controller.isInEditListMode()&&!this.controller.findEl(".dcg-options-menu")&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!1,focusExpressionList:!0}))}}else if(!e.metaKey&&!e.shiftKey&&e.ctrlKey===oi&&e.altKey===!oi){if(t==="N"){if(!this.controller.getBrailleControls())return;e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-braille-mode",mode:"nemeth"}),be(this.controller.s("shared-calculator-narration-hotkey-braille-mode-nemeth"))}else if(t==="U"){if(!this.controller.getBrailleControls())return;e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-braille-mode",mode:"ueb"}),be(this.controller.s("shared-calculator-narration-hotkey-braille-mode-ueb"))}else if(t==="Q"||t==="X"){if(!this.controller.getBrailleControls())return;e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-braille-mode",mode:"none"}),be(this.controller.s("shared-calculator-narration-hotkey-braille-mode-off"))}else if(t==="6"){if(!this.controller.getBrailleControls())return;e.preventDefault(),e.stopPropagation();let s=!this.controller.getSixKeyInput();this.controller.dispatch({type:"set-six-key-input",useSixKeyInput:s}),be(s?this.controller.s("shared-calculator-narration-six-key-mode-on"):this.controller.s("shared-calculator-narration-six-key-mode-off"))}else if(t==="D")e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-graph-settings",degreeMode:!this.controller.getGraphSettings().degreeMode}),be(this.controller.getGraphSettings().degreeMode?this.controller.s("graphing-calculator-button-settings-degrees"):this.controller.s("graphing-calculator-button-settings-radians"));else if(t==="K"){if(!this.controller.isKeypadEnabled()||this.controller.inAudioTraceMode())return;e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"keypad/set-minimized",minimized:this.controller.isHideKeypadButtonVisible()})}if(t==="+"||t==="="){this.zoom("in"),e.preventDefault(),e.stopPropagation();return}else if(t==="-"){this.zoom("out"),e.preventDefault(),e.stopPropagation();return}else if(t==="0"&&!e.shiftKey){this.setDefaultViewport(),e.preventDefault(),e.stopPropagation();return}}}focusExpressionList(){let e=this.controller.getSelectedItem();e?this.controller.dispatch({type:"move-focus-to-item",id:e.id}):this.controller.dispatch({type:"focus-first-expression"})}zoom(e){var t;(t=this.controller.getGrapher())==null||t.viewportController.zoom(e)}setDefaultViewport(){var e;(e=this.controller.getGrapher())==null||e.viewportController.setDefaultViewport()}};xt();var gZ=function(){{var r=0,e=1,t=2,i=!1,o=function(){n(document),i=!0},n=function(a){i||H(a).bind("touchstart",function(s){var l=H(s.target),c=r,p=null;if(!l[0].closest("[disablescroll]"))for(;c===r&&l.length&&l[0].tagName!==void 0;){var u=getComputedStyle(l[0]).overflow,m=getComputedStyle(l[0]).overflowY;if(u!=="hidden"&&u!=="visible"&&m!=="hidden"&&m!=="hidden"){var h=l.scrollTop();h!==0&&(c=t),l.scrollTop(h+1),l.scrollTop()!==h&&(c=e|c,l.scrollTop(h))}l=H(l[0].parentElement)}if(c!==r){p=[];for(var x=s.originalEvent.touches,C=0;C<x.length;C++){var D={};for(var k in x[C])x[C].hasOwnProperty(k)&&(D[k]=x[C][k]);p.push(D)}}H(document).on("touchmove.scrollfix",function(M){if(p){var I=p[0],S=M.originalEvent.touches[0],V=S.screenY-I.screenY;(V>0&&!(c&t)||V<0&&!(c&e))&&(c=r),V&&(p=null)}c===r&&M.preventDefault()}),H(document).on("touchend.scrollfix",function(){H(document).off(".scrollfix")})})};return{limitScrollOnElement:n,limitScrollOnDocument:o}}}();var{limitScrollOnElement:b0,limitScrollOnDocument:c4}=gZ;var Xt=__dcg_shared_module_exports__['h'](z());xt();var et=__dcg_shared_module_exports__['h'](z());xt();var d4=__dcg_shared_module_exports__['h'](z());function mZ(r){let e=r.target;return e.classList.contains("dcg-exp-action-button")||e.classList.contains("dcg-icon-duplicate")||e.classList.contains("dcg-icon-remove")||e.classList.contains("dcg-icon-lock")||e.classList.contains("dcg-icon-pencil")}var Ts=class extends d4.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,this._isFirstRender=!0,this._isDragCopy=this.props.isDragCopy()}onItemViewMounted(){this._isDragCopy||(this.model.dcgView=this),this._isFirstRender=!1}onItemViewUnmounted(){this._isDragCopy||(this.model.dcgView=void 0)}isFirstRender(){return this._isFirstRender}onMouseSelect(e){if(this.controller.isInEditListMode()&&!mZ(e)){this.exitEditListMode();return}this.controller.isItemReadonly(this.id)||e.type==="dcg-tap"&&e.device==="mouse"||e.type==="dcg-tapstart"&&e.device==="touch"||e.wasHandled()||(e.handle(),this.controller.dispatch({type:"set-selected-id",id:this.id}))}onDragPending(e){this.controller.isItemReadonly(this.model.id)||this.props.onDragPending(e)}exitEditListMode(){this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!1,focusExpressionList:!0})}};var Ka=__dcg_shared_module_exports__['h'](z());var ru=__dcg_shared_module_exports__['h'](z());var pa=class extends ru.Class{template(){return ru.createElement(Me,{tooltip:this.props.error,sticky:this.const(!0),gravity:this.props.gravity},ru.createElement("div",{class:()=>({"dcg-tooltipped-error":!0,"dcg-white":this.props.isWhite&&this.props.isWhite(),"dcg-small":this.props.size&&this.props.size()==="small"})},ru.createElement("i",{class:ru.const("dcg-icon-error"),"aria-hidden":ru.const("true")})))}};var ua=__dcg_shared_module_exports__['h'](z());var qa=__dcg_shared_module_exports__['h'](z());var{If:y0}=qa.Components,xn=class extends qa.Class{template(){return qa.createElement("span",{class:()=>({"dcg-do-not-blur":!0,"dcg-circular-icon":!0,"dcg-thick-outline":this.isThickOutline(),"dcg-white-icon":!!this.props.whiteIcon&&this.props.whiteIcon(),"dcg-hidden":this.isHidden(),"dcg-semi-transparent":this.props.semiTransparent&&this.props.semiTransparent(),"dcg-colored-icon":this.isColoredIcon(),"dcg-has-background-image":this.hasBackgroundImage(),[this.iconModifier()]:this.iconModifier().length>0}),style:this.bindFn(this.getIconStyle)},qa.createElement(y0,{predicate:this.bindFn(this.hasBackgroundImage)},()=>qa.createElement("span",{class:qa.const("dcg-background-image"),style:()=>({"background-image":this.props.backgroundImage&&this.props.backgroundImage(),opacity:this.props.backgroundOpacity&&this.props.backgroundOpacity()})})),qa.createElement(y0,{predicate:()=>!!this.backgroundIcon()},()=>qa.createElement("i",{class:()=>({[this.backgroundIcon()]:!0,"dcg-layered-icon":!0}),style:()=>({opacity:this.backgroundOpacity()})})),qa.createElement(y0,{predicate:()=>!!this.primaryIcon()},()=>qa.createElement("i",{class:()=>({[this.primaryIcon()]:!0,"dcg-layered-icon":!0}),style:()=>({color:this.props.foregroundColor&&this.props.foregroundColor()})})),qa.createElement(y0,{predicate:()=>this.props.iconType()==="loading"},()=>qa.createElement("span",{class:qa.const("dcg-spinner")})))}isColoredIcon(){return!this.isThickOutline()&&!this.isHidden()&&!this.hasBackgroundImage()&&this.props.iconType()!=="loading"}iconModifier(){if(!this.props.iconModifier)return"";switch(this.props.iconModifier()){case"medium":return"dcg-modifier-size-medium";case"large":return"dcg-modifier-size-large";case"small":return"dcg-modifier-size-small";case"rotated":return"dcg-modifier-rotated";case"none":return""}}getIconStyle(){let e=!this.isHidden()&&this.props.backgroundColor?Kf(this.props.backgroundColor()):void 0;return e?{background:e}:{}}isHidden(){return this.props.iconType()==="hidden"}isThickOutline(){let e=this.props.iconType();return e==="folder"||e==="pause"||e==="play"||e==="fraction"||e==="action"||e==="metronome"}hasBackgroundImage(){return!!this.props.backgroundImage&&!this.isHidden()&&!!this.props.backgroundImage()}primaryIcon(){let e=this.props.iconType();switch(e){case"folder":return"dcg-icon-folder";case"pause":return"dcg-icon-pause";case"play":return"dcg-icon-play";case"polygon-dashed":case"polygon-dashed-filled":return"dcg-icon-polygon-dashed";case"polygon-dotted":case"polygon-dotted-filled":return"dcg-icon-polygon-dotted";case"polygon-default":case"polygon-default-filled":return"dcg-icon-polygon-solid";case"graph-dashed":case"parametric-dashed-filled":return"dcg-icon-parametric-dashed";case"graph-dotted":case"parametric-dotted-filled":return"dcg-icon-parametric-dotted";case"graph-default":case"parametric-default-filled":return"dcg-icon-parametric-solid";case"movable-vertical":return"dcg-icon-move-vertical";case"movable-both":return"dcg-icon-move";case"movable-horizontal":return"dcg-icon-move-horizontal";case"point-open":return"dcg-icon-open";case"point-cross":return"dcg-icon-cross";case"point-default":return"dcg-icon-point";case"table-points":case"table-points-and-lines":return"dcg-icon-points";case"table-lines":return"dcg-icon-lines-solid";case"shaded-inequality":case"inequality":return"dcg-icon-shaded-inequality-dash";case"check":return"dcg-icon-check";case"none":case"background":case"hidden":case"polygon-none-filled":case"parametric-none-filled":case"loading":return"";case"fraction":return"dcg-icon-fraction";case"boxplot":return"dcg-icon-boxplot";case"dotplot-cross":return"dcg-icon-dotplot-cross";case"dotplot-default":return"dcg-icon-dotplot-default";case"dotplot-open":return"dcg-icon-dotplot-open";case"histogram":return"dcg-icon-histogram";case"unfilled-distribution":case"filled-distribution":return"dcg-icon-distribution";case"action":return"dcg-icon-chevron-right";case"metronome":return"dcg-icon-metronome-2";case"arrow-right":return"dcg-icon-arrow-right";default:return e}}backgroundOpacity(){let e=this.backgroundIcon();return e==="dcg-icon-polygon-filled"||e==="dcg-icon-parametric-filled"||e==="dcg-icon-shaded-inequality-shade2"||e==="dcg-icon-distribution-fill"||e==="dcg-icon-histogram-fill"?.5:1}backgroundIcon(){let e=this.props.iconType();return e==="filled-distribution"?"dcg-icon-distribution-fill":e==="histogram"?"dcg-icon-histogram-fill":e==="polygon-dashed-filled"||e==="polygon-dotted-filled"||e==="polygon-default-filled"||e==="polygon-none-filled"?"dcg-icon-polygon-filled":e==="parametric-dashed-filled"||e==="parametric-dotted-filled"||e==="parametric-default-filled"||e==="parametric-none-filled"?"dcg-icon-parametric-filled":e==="table-points-and-lines"?"dcg-icon-lines-solid":e==="shaded-inequality"?"dcg-icon-shaded-inequality-shade2":e==="action"?"dcg-icon-minus":""}};var x0=class extends ua.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return ua.createElement("div",{class:ua.const("dcg-play-pause-icon-view")},ua.createElement(Me,{gravity:this.const("s"),tooltip:()=>this.controller.s("graphing-calculator-label-slider-disabled-while-ticker-playing"),disabled:()=>!this.controller.getTickerPlaying(),sticky:this.const(!0)},ua.createElement("div",{class:()=>({"dcg-circular-icon-container":!0,"dcg-disabled":this.controller.getTickerPlaying()}),"aria-label":this.bindFn(this.getAriaLabel),role:ua.const("button"),tabindex:ua.const("0"),onTap:e=>{e.wasHandled("dragdrop")||this.toggleSliderIsPlaying()},manageFocus:this.const(Qe({controller:this.controller,location:{type:"slider-icon",id:this.model.id}}))},ua.createElement(xn,{iconType:()=>this.getIconType(),whiteIcon:()=>!this.controller.isInEditListMode()&&this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)}))),ua.createElement("div",{class:ua.const("dcg-slider-menu-container")},ua.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-animation-properties-tooltip"),gravity:this.const("e")},ua.createElement("div",{class:()=>({"dcg-slider-menu-opener":!0,"dcg-menu-open":this.myOptionsOpen()}),tabindex:ua.const(0),"dcg-open-menu-guid":()=>this.getMenuGUID(),role:ua.const("button"),"aria-label":()=>this.myOptionsOpen()?this.controller.s("graphing-calculator-narration-hide-animation-properties"):this.controller.s("graphing-calculator-narration-show-animation-properties"),onTap:e=>{e.wasHandled("dragdrop")||e.wasLongheld()||this.toggleOptions(e)},manageFocus:this.const(Qe({controller:this.controller,location:{type:"slider-animation-properties-icon",id:this.model.id}}))},ua.createElement("i",{class:this.bindFn(this.getIcon),"aria-hidden":ua.const("true")})))))}getIcon(){return __dcg_shared_module_exports__['Rc'](this.model.slider.loopMode)}getIconType(){return!this.model.slider.isPlaying||k1(this.model)?"play":"pause"}getMenuGUID(){return"slider-"+this.model.guid}myOptionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getMenuGUID())}toggleOptions(e){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"slider",model:this.model,guid:this.getMenuGUID(),focusFirstOption:e.device==="keyboard"}})}getAriaLabel(){if(!this.model.sliderExists)return"";var e=In(this.model);return e?this.model.slider.isPlaying?this.controller.s("graphing-calculator-narration-pause-variable-animation",{variable:e}):this.controller.s("graphing-calculator-narration-play-variable-animation",{variable:e}):""}toggleSliderIsPlaying(){if(this.model.sliderExists){var e="",t=In(this.model);k1(this.model)?(typeof t=="string"&&(e=this.controller.s("graphing-calculator-narration-slider-variable-restarted",{variable:t})),this.controller.dispatch({type:"play-slider-from-min",id:this.model.id})):this.model.slider.isPlaying?(typeof t=="string"&&(e=this.controller.s("graphing-calculator-narration-slider-variable-paused",{variable:t})),this.controller.dispatch({type:"set-slider-isplaying",id:this.model.id,isPlaying:!1})):(typeof t=="string"&&(e=this.controller.s("graphing-calculator-narration-slider-variable-playing",{variable:t})),this.controller.dispatch({type:"set-slider-isplaying",id:this.model.id,isPlaying:!0})),e!==""&&be(e)}}};var ep=__dcg_shared_module_exports__['h'](z());var w0=class extends ep.Class{constructor(){super(...arguments),this.isAnimating=!1,this.unmounted=!1}init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return ep.createElement("div",{class:()=>({"dcg-action-icon-view":!0,"dcg-action-icon-view-animating":this.isAnimating})},ep.createElement("div",{class:ep.const("dcg-circular-icon-container"),"aria-label":()=>this.controller.s("graphing-calculator-narration-run-action-icon"),role:ep.const("button"),tabindex:ep.const("0"),onTap:e=>{e.wasHandled("dragdrop")||this.runActionOnce()},manageFocus:this.const(Qe({controller:this.props.controller(),location:{type:"action-icon",id:this.model.id}}))},ep.createElement(xn,{iconType:this.const("action"),whiteIcon:()=>!this.controller.isInEditListMode()&&this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)})))}willUnmount(){this.unmounted=!0}runActionOnce(){this.isAnimating=!0,this.controller.dispatch({type:"action-single-step",id:this.model.id}),setTimeout(()=>{this.isAnimating=!1,this.unmounted||this.update()},150)}};var{SwitchUnion:fZ}=Ka.Components,bZ="#6A93D2",p4="#000",u4="#fff",rv=class extends Ka.Class{init(){this.model=this.props.model(),this.controller=this.props.controller()}template(){return Ka.createElement("div",{class:Ka.const("dcg-expression-icon-container")},fZ(this.bindFn(this.getIconMode),{error:()=>Ka.createElement(pa,{error:this.bindFn(this.getErrorMsg),isWhite:this.bindFn(this.isSelected),gravity:this.const("s")}),none:()=>Ka.createElement("span",null),slider:()=>Ka.createElement(x0,{controller:this.props.controller,model:this.props.model}),action:()=>Ka.createElement(w0,{controller:this.props.controller,model:this.props.model}),icon:()=>Ka.createElement("div",{class:Ka.const("dcg-circular-icon-container"),role:Ka.const("button"),tabindex:Ka.const("0"),"dcg-open-menu-guid":()=>this.getMenuGUID(),"aria-label":this.bindFn(this.getIconAriaLabel),onTap:e=>{if(!e.wasHandled("dragdrop")&&!e.wasLongheld()){if(this.myOptionsOpen())return this.toggleOptions(e);if((this.controller.isInEditListMode()||e.shiftKey)&&!this.isFraction())return this.toggleOptions(e);if(this.isFraction())return this.onToggleFractionDisplay();this.toggleGraphShown()}},onLongHold:e=>{e.handle("dcg-longhold"),e.handle("dcg-tap"),!this.isFraction()&&this.toggleOptions(e)},manageFocus:this.const(Qe({controller:this.controller,location:{type:"expression-icon",id:this.model.id}}))},Ka.createElement(xn,{iconType:this.bindFn(this.getIconType),backgroundColor:this.bindFn(this.getBackgroundColor),whiteIcon:this.bindFn(this.isSelected),foregroundColor:this.bindFn(this.getForegroundColor),iconModifier:this.bindFn(this.getIconModifier),backgroundImage:this.bindFn(this.backgroundImage),backgroundOpacity:this.const(1)}))}))}backgroundImage(){let e=this.getBackgroundColor();return e.type==="image"?`url("${e.value}")`:""}getErrorMsg(){return this.colorError()?this.controller.s("shared-calculator-error-color-not-assigned"):this.controller.unpack(this.model.error)}getMenuGUID(){return this.model.guid}myOptionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getMenuGUID())}toggleOptions(e){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"expression",model:this.model,guid:this.getMenuGUID(),focusFirstOption:e.device==="keyboard"}})}isSelected(){return this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)}isFraction(){return this.controller.canDisplayEvaluationForItemAsFraction(this.model.id)}getIconMode(){return this.hasError()?"error":this.controller.getGraphSettings().config.graphpaper?zu(this.model)?"icon":this.hasSlider()?"slider":this.isFraction()?"icon":this.isNonemptyAction()?"action":"none":"none"}toggleGraphShown(){this.controller.dispatch({type:"toggle-item-hidden",id:this.model.id})}colorError(){return!!this.model.formula.rgb_value&&!this.model.formula.assignment}hasError(){return this.colorError()?!0:!!this.model.error&&!Us(this.model)&&this.controller.getBrailleMode()==="none"}hasSlider(){return!!this.model.sliderExists}isNonemptyAction(){return xf(this.model)}getDisplayProps(){let{points:e,lines:t,fill:i}=this.model;return __dcg_shared_module_exports__['pc'](this.model.formula.expression_type,{points:e,lines:t,fill:i})}getBackgroundColor(){if(!this.isFraction())return Hx(this.model);let e=this.isSelected();return this.controller.shouldEvaluationForItemDisplayAsFraction(this.model.id)?{type:"single-color",value:e?u4:p4}:{type:"single-color",value:""}}getForegroundColor(){if(!this.isFraction())return"";let e=this.isSelected(),t=this.controller.shouldEvaluationForItemDisplayAsFraction(this.model.id);return e!==t?u4:e?bZ:p4}onToggleFractionDisplay(){this.controller.dispatch({type:"toggle-fraction-evaluation",id:this.model.id})}getIconModifier(){return $u(this.model)&&Fp(this.model,"alignedAxis")==="y"?"rotated":"none"}getIconType(){if(this.isFraction())return"fraction";if(!this.model.shouldGraph)return"hidden";if(this.controller.isInEditListMode())return"none";let e=this.model.pointStyle,t=this.model.lineStyle,i=this.getDisplayProps(),o=this.model.formula;if($u(this.model))return"boxplot";if(Bp(this.model)){if(this.model.pointStyle==="POINT")return"dotplot-default";if(this.model.pointStyle==="CROSS")return"dotplot-cross";if(this.model.pointStyle==="OPEN")return"dotplot-open"}if(lg(this.model))return"histogram";if(ju(this.model))return Pd(this.model)?"filled-distribution":"unfilled-distribution";if(Gi(this.model)==="X")return"movable-horizontal";if(Gi(this.model)==="Y")return"movable-vertical";if(Gi(this.model)==="XY")return"movable-both";if(es(this.model))return e==="OPEN"?"point-open":e==="CROSS"?"point-cross":"point-default";if(TS(this.model))return"point-default";if(Ox(this.model)||AS(this.model))return i.lines&&i.points?"table-points-and-lines":i.lines?"table-lines":"table-points";if(IS(this.model))return"polygon-default-filled";let n=this.getDisplayProps().fill;if(Ad(this.model))return n?i.lines?t==="DASHED"?"polygon-dashed-filled":t==="DOTTED"?"polygon-dotted-filled":"polygon-default-filled":"polygon-none-filled":i.lines?t==="DASHED"?"polygon-dashed":t==="DOTTED"?"polygon-dotted":"polygon-default":"none";if(Np(this.model))return n?i.lines?t==="DASHED"?"parametric-dashed-filled":t==="DOTTED"?"parametric-dotted-filled":"parametric-default-filled":"parametric-none-filled":i.lines?t==="DASHED"?"graph-dashed":t==="DOTTED"?"graph-dotted":"graph-default":"none";var a=o.operator,s=__dcg_shared_module_exports__['ob'][a].direction!==0,l=__dcg_shared_module_exports__['ob'][a].inclusive===!1;return o.is_shade_between||!l&&s?"shaded-inequality":l&&!s?"inequality":l&&s?"shaded-inequality":t==="DASHED"?"graph-dashed":t==="DOTTED"?"graph-dotted":"graph-default"}getIconAriaLabel(){return this.isFraction()?Uu(this.model)?this.controller.s("shared-calculator-narration-display-as-decimal"):this.controller.s("shared-calculator-narration-display-as-fraction"):this.myOptionsOpen()?_i(this.model,"hide-options"):this.controller.isInEditListMode()?_i(this.model,"show-options"):this.model.hidden?_i(this.model,"show"):_i(this.model,"hide")}};var zi=__dcg_shared_module_exports__['h'](z());var{If:yZ,SwitchUnion:xZ}=zi.Components;function wZ(r,e){return __dcg_shared_module_exports__['eb'](r,e)}var qg=class extends zi.Class{init(){this.controller=this.props.controller()}template(){return zi.createElement("div",{class:zi.const("dcg-evaluation-container")},zi.createElement("div",{didMount:e=>this.containerNode=e,class:()=>({"dcg-evaluation":!0,"dcg-do-blur":!0,"dcg-hidden":this.props.controller().isInEditListMode()}),handleEvent:zi.const("true"),tabindex:()=>this.props.focusable()&&this.controller.getBrailleMode()==="none"?"0":"-1",onFocus:()=>{this.controller.getBrailleMode()==="none"&&this.evaluationNode&&this.onSelectEvaluation()},onBlur:()=>{this.controller.getBrailleMode()==="none"&&this.evaluationNode&&this.onUnselectEvaluation()},onTap:()=>{var e;return(e=this.containerNode)==null?void 0:e.focus()}},zi.createElement(co,__dcg_shared_module_exports__['a']({latex:this.bindFn(this.getBrailleEvaluation),ariaLabel:this.const(""),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="braille-output"?!1:e.id===this.props.id()},onBrailleInput:()=>{},isStatic:this.const(!0),onBrailleFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"braille-output",id:this.props.id()}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"braille-output",id:this.props.id()}})}},rn(this.controller)),zi.createElement("div",{class:zi.const("dcg-evaluation-label-container")},zi.createElement(yZ,{predicate:()=>!!this.props.dependent()},()=>zi.createElement(ze,{latex:()=>__dcg_shared_module_exports__['hb'](this.props.dependent()),config:this.const({})})),zi.createElement("span",{class:zi.const("dcg-equals")},zi.createElement(ze,{latex:this.const("="),config:this.const({})}))),zi.createElement("span",{class:()=>({"dcg-text-selectable":this.getEvaluationType()!=="rgbcolor","dcg-evaluation-html":!0,"dcg-color-evaluation":this.getEvaluationType()==="rgbcolor"}),didMount:this.bindFn(this.didMountEvaluation)},xZ(()=>this.getEvaluationType(),{list:()=>zi.createElement("span",{class:zi.const("dcg-evaluation-list")},()=>this.controller.s("graphing-calculator-label-evaluation-list",{count:this.props.val().length})),fraction:()=>zi.createElement(ze,{latex:()=>__dcg_shared_module_exports__['gb'](this.props.val(),this.getLabelOptions()),config:this.const({})}),undefined:()=>zi.createElement("span",null,zi.const("undefined")),scientific:()=>zi.createElement(ze,{latex:()=>`${this.getNumberLabel().mantissa}\\times10^{${this.getNumberLabel().exponent}}`,config:this.const({})}),decimal:()=>zi.createElement(ze,{latex:()=>this.getNumberLabel().value,config:this.const({})}),rgbcolor:()=>zi.createElement(Dg,{color:()=>this.getColorValue(),isEvaluation:this.const(!0),invertSwatches:()=>this.controller.invertSwatches()})})))),zi.createElement("div",{class:zi.const("dcg-clear")}))}getColorValue(){let e=this.props.id(),t=this.controller.getColorById(e);return Array.isArray(t)?{type:"color-array",value:t}:{type:"single-color",value:t}}getNumberLabel(){return wZ(this.props.val(),this.getLabelOptions())}getEvaluationType(){let e=this.props.val();return typeof e=="string"?"rgbcolor":Array.isArray(e)?typeof e[0]=="string"?"rgbcolor":"list":this.getNumberLabel().type}getLabelOptions(){return this.props.controller().getEvaluationLabelOptionsForItem(this.props.id())}didMountEvaluation(e){this.evaluationNode=e}onSelectEvaluation(){let e=document.createRange();e.selectNodeContents(this.evaluationNode);let t=window.getSelection();t&&(t.removeAllRanges(),t=window.getSelection(),t&&t.addRange(e))}onUnselectEvaluation(){let e=window.getSelection();e&&e.removeAllRanges()}getBrailleEvaluation(){let e="";this.props.dependent()&&(e=__dcg_shared_module_exports__['hb'](this.props.dependent())),e+="=";let t=this.getEvaluationType();switch(t){case"list":e+=this.controller.s("graphing-calculator-label-evaluation-list",{count:this.props.val().length});break;case"fraction":e+=__dcg_shared_module_exports__['gb'](this.props.val(),this.getLabelOptions());break;case"undefined":e="undefined";break;case"scientific":e+=`${this.getNumberLabel().mantissa}\\times10^{${this.getNumberLabel().exponent}}`;break;case"decimal":e+=this.getNumberLabel().value;break;case"rgbcolor":e+=this.props.val();break;default:return t}return e}};var Ml=__dcg_shared_module_exports__['h'](z()),iv=class extends Ml.Class{template(){return this.controller=this.props.controller(),Ml.createElement("div",{class:Ml.const("dcg-unresolved")},Ml.createElement("i",{class:Ml.const("dcg-icon-error"),"aria-hidden":Ml.const("true")}),Ml.const("\xA0"),()=>this.controller.s("graphing-calculator-error-equation-contains-unresolved-details"),Ml.createElement("a",{href:Ml.const("https://help.desmos.com/hc/en-us/articles/202529079-Unresolved-Detail-In-Plotted-Functions"),target:Ml.const("_blank")},()=>this.controller.s("graphing-calculator-link-learn-more")))}};var ha=__dcg_shared_module_exports__['h'](z());yl();var Zs=__dcg_shared_module_exports__['h'](z());var{SwitchUnion:vZ}=Zs.Components,ir=class extends Zs.Class{init(){this.controller=this.props.controller()}template(){return Zs.createElement("div",{class:this.bindFn(this.getContainerClass)},vZ(()=>String(this.props.readonly()),{true:()=>Zs.createElement(co,__dcg_shared_module_exports__['a']({latex:this.bindFn(this.getStaticLatex),operatorNames:()=>this.getMQConfig().autoOperatorNames,brailleShouldFocus:this.props.isFocused,isStatic:this.const(!0),onBrailleFocusedChanged:this.props.handleFocusChanged,ariaLabel:this.bindFn(this.getBrailleLabel),dataLabelAttributeValue:this.props.dataLabelAttributeValue},rn(this.props.controller())),Zs.createElement(ze,{latex:this.bindFn(this.getStaticLatex),config:this.bindFn(this.getMQConfig),getAriaLabel:this.props.ariaLabel},Zs.createElement("span",{class:Zs.const("dcg-math-field"),"data-dcg-label":()=>this.props.dataLabelAttributeValue?this.props.dataLabelAttributeValue():void 0,manageFocus:this.const({shouldBeFocused:()=>this.props.isFocused(),onFocusedChanged:(e,t)=>this.props.handleFocusChanged(e,t)}),tabindex:Zs.const("0")}))),false:()=>Zs.createElement(co,__dcg_shared_module_exports__['a']({latex:this.props.latex,operatorNames:()=>this.getMQConfig().autoOperatorNames||"",brailleShouldFocus:this.props.isFocused,selectOnFocus:this.const(!0),onBrailleInput:this.props.handleLatexChanged,onBrailleFocusedChanged:this.props.handleFocusChanged,onBrailleKeydown:this.bindFn(this.onBrailleKeydown),hasError:this.props.hasError,placeholder:this.props.placeholder,ariaLabel:this.bindFn(this.getBrailleLabel),dataLabelAttributeValue:this.props.dataLabelAttributeValue},rn(this.props.controller())),Zs.createElement(_e,{latex:this.props.latex,getAriaPostLabel:()=>{var t,i;let e=((i=(t=this.props).ariaPostLabel)==null?void 0:i.call(t))||"";return this.props.hasError()&&e===""&&(e=this.controller.s("shared-calculator-narration-math-input-error-message")),e},isFocused:this.props.isFocused,placeholder:this.props.placeholder,capExpressionSize:()=>this.controller.getCapExpressionSize(),selectOnFocus:this.const(!0),config:this.bindFn(this.getMQConfig),getAriaLabel:this.props.ariaLabel,hasError:this.props.hasError,dataLabelAttributeValue:this.props.dataLabelAttributeValue,onUserPressedKey:this.props.handlePressedKey,onUserChangedLatex:this.props.handleLatexChanged,onSelectionChanged:this.props.handleSelectionChanged,onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:this.props.handleFocusChanged,needsSystemKeypad:()=>!this.controller.isKeypadEnabled()}))}))}getStaticLatex(){return this.props.latex()?this.props.latex():this.props.placeholder?this.props.placeholder():""}getContainerClass(){let e=this.props.containerClass?this.props.containerClass():{};return e["dcg-inline-math-input-view"]=!0,this.props.fullWidth&&this.props.fullWidth()&&(e["dcg-full-width-inline-math-input"]=!0),this.props.fontSize&&this.props.fontSize()==="large"&&(e["dcg-large-font-inline-math-input"]=!0),this.props.noBorder&&this.props.noBorder()&&(e["dcg-no-border-inline-math-input"]=!0),e}onBrailleKeydown(e){if(!this.props.handlePressedKey)return;let t=Ee(e);t&&this.props.handlePressedKey(t,e)}getMQConfig(){return this.controller.getMathquillConfig({})}getBrailleLabel(){return this.props.brailleLabel?this.props.brailleLabel():this.props.ariaLabel()}};var ed=__dcg_shared_module_exports__['h'](z());var xh=class extends ed.Class{template(){return ed.createElement(Me,{tooltip:()=>this.props.controller().s("shared-calculator-label-toast-learn-more")},ed.createElement("a",{"aria-label":()=>this.props.controller().s("shared-calculator-label-toast-learn-more"),class:ed.const("dcg-learn-more-link"),href:this.props.href,target:ed.const("_blank")},ed.createElement("i",{class:ed.const("dcg-icon-question-sign"),"aria-hidden":ed.const("true")})))}};var{If:CZ}=ha.Components,Kg=class extends ha.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,this.props.parameter!==void 0&&(this.parameter=this.props.parameter())}template(){return ha.createElement("div",{class:ha.const("dcg-domain dcg-do-blur"),handleEvent:ha.const("true")},ha.createElement("div",{class:ha.const("dcg-display-domain dcg-do-blur"),handleEvent:ha.const("true")},ha.createElement(ir,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.getMinLatex(),isFocused:()=>this.getFocusedInput()==="min"+this.getDomainVariable(),placeholder:()=>__dcg_shared_module_exports__['bb'](_R(this.model)).latex,ariaLabel:()=>this.controller.s("graphing-calculator-narration-domain3d-minimum",{term:this.getDomainVariable()}),brailleLabel:()=>this.controller.raw("dmin"),handleFocusChanged:e=>this.handleFocusedChanged("min"+this.getDomainVariable(),e),hasError:()=>!RR(this.model,this.getDomainVariable()),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("min"+this.getDomainVariable(),e,t),handleLatexChanged:e=>this.dispatchMinLatexIfChanged(e),dataLabelAttributeValue:this.const("domain-min")}),ha.createElement("span",{class:ha.const("dcg-interval-interior")},ha.createElement(ze,{latex:()=>this.getDomainVariableLatex(),config:this.const({})})),ha.createElement(ir,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.getMaxLatex(),isFocused:()=>this.getFocusedInput()==="max"+this.getDomainVariable(),placeholder:()=>__dcg_shared_module_exports__['bb'](FR(this.model,this.getDomainVariable())).latex,ariaLabel:()=>this.controller.s("graphing-calculator-narration-domain3d-maximum",{term:this.getDomainVariable()}),brailleLabel:()=>this.controller.raw("dmax"),handleFocusChanged:e=>this.handleFocusedChanged("max"+this.getDomainVariable(),e),hasError:()=>!NR(this.model,this.getDomainVariable()),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("max"+this.getDomainVariable(),e,t),handleLatexChanged:e=>this.dispatchMaxLatexIfChanged(e),dataLabelAttributeValue:this.const("domain-max")}),ha.createElement(CZ,{predicate:()=>this.getDomainVariable()==="\\phi"},()=>ha.createElement(xh,{href:this.const("https://help.desmos.com/hc/en-us/articles/15824510769805"),controller:this.props.controller}))))}handlePressedKey(e,t,i){if(!this.controller.isInEditListMode()){if(t==="Esc"){this.controller.dispatch({type:"set-focus-location",location:void 0});return}if(t==="Enter")return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"})}let o=_e.getFocusedMathquill(),n=Gs();if(t==="Left"||t==="Right"||t==="Down"||t==="Up"){var a;o?a=_e.applyArrowKeyAndReturnIfWasAtBounds(o,t,i):n&&(n.selectionStart===0&&t==="Left"||n.selectionStart===n.value.length&&t==="Right"||t==="Up"||t==="Down")?a=!0:a=!1,a&&(i&&i.preventDefault(),t==="Left"?e==="max"+this.getDomainVariable()&&this.controller.dispatch({type:"set-focus-location",location:{type:"domain-limit",id:this.model.id,location:"min"+this.getDomainVariable()}}):t==="Right"?e==="min"+this.getDomainVariable()&&this.controller.dispatch({type:"set-focus-location",location:{type:"domain-limit",id:this.model.id,location:"max"+this.getDomainVariable()}}):t==="Down"?this.controller.dispatch({type:"on-special-key-pressed",key:"Down"}):t==="Up"&&this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.model.id}}));return}o&&(o.keystroke(t,i),e==="min"+this.getDomainVariable()?this.dispatchMinLatexIfChanged(o.latex()):e==="max"+this.getDomainVariable()&&this.dispatchMaxLatexIfChanged(o.latex()))}handleFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"domain-limit",id:this.id,location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"domain-limit",id:this.id,location:e}})}dispatchMinLatexIfChanged(e){if(this.getMinLatex()!==e){if(this.getDomainType()==="unknown"){fn("DomainView is in use for a non-parametric, non-polar expression",{severity:"error",metaData:{expression:ng(this.model,{stripDefaults:!0})}});return}let i=this.setMinCommand();i!==void 0&&this.controller.dispatch({type:i,id:this.id,latex:e})}}setMinCommand(){switch(this.getDomainType()){case"polar":return"set-polar-domain-minlatex";case"parametric":return"set-parametric-domain-minlatex";case"parametric-uv":return this.getDomainVariable()==="u"||this.getDomainVariable()==="r"&&zs(this.model)||this.getDomainVariable()==="\\theta"&&wl(this.model)?"set-parametric-domain3Du-minlatex":"set-parametric-domain3Dv-minlatex"}}setMaxCommand(){switch(this.getDomainType()){case"polar":return"set-polar-domain-maxlatex";case"parametric":return"set-parametric-domain-maxlatex";case"parametric-uv":return this.getDomainVariable()==="u"||this.getDomainVariable()==="r"&&zs(this.model)||this.getDomainVariable()==="\\theta"&&wl(this.model)?"set-parametric-domain3Du-maxlatex":"set-parametric-domain3Dv-maxlatex"}}dispatchMaxLatexIfChanged(e){if(this.getMaxLatex()!==e){if(this.getDomainType()==="unknown"){fn("DomainView is in use for a non-parametric, non-polar expression",{severity:"error",metaData:{expression:ng(this.model,{stripDefaults:!0})}});return}let i=this.setMaxCommand();i!==void 0&&this.controller.dispatch({type:i,id:this.id,latex:e})}}getFocusedInput(){let e=this.controller.getFocusLocation();if(!(!e||e.type!=="domain-limit"||e.id!==this.id))return e.location}getMinLatex(){switch(this.getDomainType()){case"parametric":return sN(this.model);case"polar":return nN(this.model);case"parametric-uv":return this.getDomainVariable()==="u"||this.getDomainVariable()==="r"||this.getDomainVariable()==="\\theta"&&wl(this.model)?lN(this.model):cN(this.model);default:return""}}getMaxLatex(){switch(this.getDomainType()){case"parametric":return dN(this.model);case"polar":return aN(this.model);case"parametric-uv":return this.getDomainVariable()==="u"||this.getDomainVariable()==="r"||this.getDomainVariable()==="\\theta"&&wl(this.model)?pN(this.model):uN(this.model);default:return""}}getDomainVariable(){var e;switch(this.getDomainType()){case"parametric":return"t";case"polar":return"\\theta";default:return(e=this.parameter)!=null?e:""}}getDomainVariableForDisplay(){return this.getDomainType()==="parametric"&&"dependency"in this.model.formula?this.model.formula.dependency:this.getDomainVariable()}getDomainVariableLatex(){switch(this.getDomainType()){case"parametric":case"polar":case"parametric-uv":return"\\le "+this.getDomainVariableForDisplay()+" \\le";default:return""}}getDomainType(){return Hu(this.model)||vf(this.model)?"polar":Np(this.model)?"parametric":MS(this.model)||wl(this.model)||zs(this.model)?"parametric-uv":"unknown"}getMQConfig(){return{autoOperatorNames:Ys({})}}};var ve=__dcg_shared_module_exports__['h'](z());var{If:tc,For:DZ,IfElse:SZ}=ve.Components,ov=class extends ve.Class{template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,ve.createElement(tc,{predicate:this.bindFn(this.hasRegression)},()=>ve.createElement("div",{class:ve.const("dcg-regression-container")},ve.createElement("div",{class:ve.const("dcg-handle-event"),handleEvent:ve.const("true")},ve.createElement(tc,{predicate:this.bindFn(this.getShouldSuggestLogMode)},()=>ve.createElement("div",{class:ve.const("dcg-log-mode-toggle")},SZ(()=>this.areLogModeRegressionsForced(),{true:()=>ve.createElement("div",{class:ve.const("dcg-action-log-mode-toggle dcg-no-hover-styling")},()=>this.controller.s("graphing-calculator-button-regression-log-mode")),false:()=>ve.createElement("div",null,ve.createElement(st,{class:this.const("dcg-action-log-mode-toggle dcg-log-mode-checkbox"),onChange:this.bindFn(this.onTapLogMode),checked:()=>this.getIsLogModeRegression()},()=>this.controller.s("graphing-calculator-button-regression-log-mode")),ve.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-regression-log-mode-help-tooltip"),gravity:this.const("e")},ve.createElement("a",{"aria-label":()=>this.controller.s("graphing-calculator-label-regression-log-mode-help-tooltip"),class:ve.const("dcg-log-mode-toggle-help"),target:ve.const("_blank"),href:ve.const("https://help.desmos.com/hc/en-us/articles/204349605")},ve.createElement("i",{class:ve.const("dcg-icon-question-sign"),"aria-hidden":ve.const("true")}))))}))),ve.createElement("div",{class:ve.const("dcg-statistics"),role:ve.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-heading-regression-statistics")},ve.createElement("div",{class:ve.const("dcg-expression-footer-title")},()=>this.controller.s("graphing-calculator-heading-regression-statistics"),ve.createElement(tc,{predicate:()=>this.getRegression().statistics.hasOwnProperty("RMSE")},()=>ve.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-regression-what-is-rmse-tooltip"),gravity:this.const("s")},ve.createElement("a",{class:ve.const("dcg-expression-footer-title-help"),target:ve.const("_blank"),href:ve.const("https://help.desmos.com/hc/en-us/articles/202529129-What-is-RMSE-"),"aria-label":()=>this.controller.s("graphing-calculator-label-regression-what-is-rmse-tooltip")},ve.createElement("i",{class:ve.const("dcg-icon-question-sign"),"aria-hidden":ve.const("true")})))),ve.createElement(tc,{predicate:()=>this.getRegression().statistics.Rsquared<0},()=>ve.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-regression-why-is-negative-tooltip"),gravity:this.const("s")},ve.createElement("a",{"aria-label":()=>this.controller.s("graphing-calculator-label-regression-why-is-negative-tooltip"),class:ve.const("dcg-expression-footer-title-help"),target:ve.const("_blank"),href:ve.const("https://help.desmos.com/hc/en-us/articles/202529139-Why-am-I-seeing-a-negative-R-2-value-")},ve.createElement("i",{class:ve.const("dcg-icon-question-sign"),"aria-hidden":ve.const("true")}))))),ve.createElement("div",{class:ve.const("dcg-statistics-values")},ve.createElement(tc,{predicate:()=>this.getRegression().statistics.hasOwnProperty("Rsquared")},()=>ve.createElement("div",null,ve.createElement(co,__dcg_shared_module_exports__['a']({latex:()=>"R^2="+Al(this.getRegression(),"Rsquared"),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="regression-output"?!1:e.id===this.id&&e.parameter==="Rsquared"},onBrailleFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"regression-output",id:this.id,parameter:"Rsquared"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"regression-output",id:this.id,parameter:"Rsquared"}})},ariaLabel:this.const(""),isStatic:this.const(!0)},rn(this.controller)),ve.createElement(ze,{latex:()=>"R^2="+Al(this.getRegression(),"Rsquared"),config:this.const({})},ve.createElement("span",{tabindex:ve.const("0"),manageFocus:this.const(Qe({predicate:()=>this.controller.getBrailleMode()==="none",controller:this.controller,location:{type:"regression-output",id:this.id,parameter:"Rsquared"}}))}))))),ve.createElement(tc,{predicate:()=>this.getRegression().statistics.hasOwnProperty("rsquared")},()=>ve.createElement("div",null,ve.createElement(co,__dcg_shared_module_exports__['a']({latex:()=>"r^2="+Al(this.getRegression(),"rsquared"),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="regression-output"?!1:e.id===this.id&&e.parameter==="rsquared"},onBrailleFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"regression-output",id:this.id,parameter:"rsquared"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"regression-output",id:this.id,parameter:"rsquared"}})},ariaLabel:this.const(""),isStatic:this.const(!0)},rn(this.controller)),ve.createElement(ze,{latex:()=>"r^2="+Al(this.getRegression(),"rsquared"),config:this.const({})},ve.createElement("span",{tabindex:ve.const("0"),manageFocus:this.const(Qe({predicate:()=>this.controller.getBrailleMode()==="none",controller:this.controller,location:{type:"regression-output",id:this.id,parameter:"rsquared"}}))}))))),ve.createElement(tc,{predicate:()=>this.getRegression().statistics.hasOwnProperty("r")},()=>ve.createElement("div",null,ve.createElement(co,__dcg_shared_module_exports__['a']({latex:()=>"r="+Al(this.getRegression(),"r"),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="regression-output"?!1:e.id===this.id&&e.parameter==="r"},onBrailleFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"regression-output",id:this.id,parameter:"r"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"regression-output",id:this.id,parameter:"r"}})},ariaLabel:this.const(""),isStatic:this.const(!0)},rn(this.controller)),ve.createElement(ze,{latex:()=>"r="+Al(this.getRegression(),"r"),config:this.const({})},ve.createElement("span",{class:ve.const("dcg-r-value"),tabindex:ve.const("0"),manageFocus:this.const(Qe({predicate:()=>this.controller.getBrailleMode()==="none",controller:this.controller,location:{type:"regression-output",id:this.id,parameter:"r"}}))}))))),ve.createElement(tc,{predicate:()=>this.getRegression().statistics.hasOwnProperty("RMSE")},()=>ve.createElement("div",null,ve.createElement(co,__dcg_shared_module_exports__['a']({latex:()=>"\\operatorname{RMSE}="+Al(this.getRegression(),"RMSE"),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="regression-output"?!1:e.id===this.id&&e.parameter==="RMSE"},onBrailleFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"regression-output",id:this.id,parameter:"RMSE"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"regression-output",id:this.id,parameter:"RMSE"}})},ariaLabel:this.const(""),isStatic:this.const(!0)},rn(this.controller)),ve.createElement(ze,{latex:()=>"\\operatorname{RMSE}="+Al(this.getRegression(),"RMSE"),config:this.const({})},ve.createElement("span",{tabindex:ve.const("0"),manageFocus:this.const(Qe({predicate:()=>this.controller.getBrailleMode()==="none",controller:this.controller,location:{type:"regression-output",id:this.id,parameter:"RMSE"}}))}))))))),ve.createElement("div",{role:ve.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-heading-regression-residuals"),class:ve.const("dcg-residuals")},ve.createElement("div",{class:ve.const("dcg-expression-footer-title")},()=>this.controller.s("graphing-calculator-heading-regression-residuals")),ve.createElement(co,__dcg_shared_module_exports__['a']({latex:this.bindFn(this.getResidualVariable),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="regression-output"?!1:e.id===this.id&&e.parameter===this.getResidualVariable()},onBrailleFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"regression-output",id:this.id,parameter:this.getResidualVariable()}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"regression-output",id:this.id,parameter:this.getResidualVariable()}})},ariaLabel:this.const(""),isStatic:this.const(!0)},rn(this.controller)),ve.createElement(ze,{latex:this.bindFn(this.getResidualVariable),config:this.const({})},ve.createElement("span",{class:ve.const("dcg-residuals-variable"),tabindex:ve.const("0"),manageFocus:this.const(Qe({predicate:()=>this.controller.getBrailleMode()==="none",controller:this.controller,location:{type:"regression-output",id:this.id,parameter:this.getResidualVariable()}}))}))),ve.createElement(tc,{predicate:this.bindFn(this.getResidualSuggestionVisible)},()=>ve.createElement("div",{class:ve.const("dcg-residual-suggestion dcg-action-plot-residual dcg-btn dcg-btn-light-gray"),role:ve.const("button"),onTap:this.bindFn(this.onTapResidualsSuggestion)},()=>this.controller.s("graphing-calculator-button-regression-plot-residuals")))),ve.createElement(tc,{predicate:()=>Object.keys(this.getRegression().parameters).length>0},()=>ve.createElement("div",{class:ve.const("dcg-parameters-container")},ve.createElement("div",{class:ve.const("dcg-expression-footer-title")},()=>this.controller.s("graphing-calculator-heading-regression-parameters"),ve.createElement(tc,{predicate:()=>this.isNonLinearRegression()},()=>ve.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-regression-parameters-not-exact"),gravity:this.const("s")},ve.createElement("a",{class:ve.const("dcg-expression-footer-title-help"),target:ve.const("_blank"),href:ve.const("https://help.desmos.com/hc/en-us/articles/360042428612"),"aria-label":()=>this.controller.s("graphing-calculator-label-regression-parameters-not-exact")},ve.createElement("i",{class:ve.const("dcg-icon-question-sign"),"aria-hidden":ve.const("true")}))))),ve.createElement(DZ,{each:()=>Object.keys(this.getRegression().parameters)},ve.createElement("div",{role:ve.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-heading-regression-parameters"),class:ve.const("dcg-parameters")},e=>ve.createElement(co,__dcg_shared_module_exports__['a']({latex:()=>e+"="+v0(this.getRegression(),e),brailleShouldFocus:()=>{let t=this.controller.getFocusLocation();return!t||t.type!=="regression-output"?!1:t.id===this.id&&t.parameter===e},onBrailleFocusedChanged:t=>{t?this.controller.dispatch({type:"set-focus-location",location:{type:"regression-output",id:this.id,parameter:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"regression-output",id:this.id,parameter:e}})},ariaLabel:this.const(""),isStatic:this.const(!0)},rn(this.controller)),ve.createElement(ze,{latex:()=>e+"="+v0(this.getRegression(),e),config:this.const({})},ve.createElement("span",{class:ve.const("dcg-parameter"),tabindex:ve.const("0"),manageFocus:this.const(Qe({controller:this.controller,location:{type:"regression-output",id:this.id,parameter:e}}))}))))))),ve.createElement("div",{class:ve.const("dcg-clear")}),ve.createElement(tc,{predicate:()=>this.hasParameterWarning()},()=>ve.createElement("div",{class:ve.const("dcg-parameter-warning")},ve.createElement("i",{class:ve.const("dcg-icon-error"),"aria-hidden":ve.const("true")}),ve.const("\xA0"),()=>this.controller.s("graphing-calculator-text-regression-potentially-inaccurate-parameters"),ve.const("\xA0"),ve.createElement("a",{href:ve.const("https://help.desmos.com/hc/en-us/articles/360042942771"),target:ve.const("_blank")},()=>this.controller.s("graphing-calculator-link-learn-more")))))))}onTapResidualsSuggestion(){this.controller.dispatch({type:"plot-residuals",id:this.id})}onTapLogMode(){this.controller.dispatch({type:"toggle-logmode",id:this.id})}getRegression(){return this.model.formula.regression}hasRegression(){return!!this.model.formula.regression}isNonLinearRegression(){return!this.getRegression().isLinear}getResidualVariable(){return this.getRegression().residualVariable||""}getResidualSuggestionVisible(){return this.getRegression().residualSuggestionId!==void 0}areLogModeRegressionsForced(){return this.controller.areLogModeRegressionsForced()}getShouldSuggestLogMode(){return!!this.getRegression().shouldSuggestLogMode}hasParameterWarning(){return!!this.getRegression().parameterWarning}getIsLogModeRegression(){return!!this.model.isLogModeRegression}};function v0(r,e){return __dcg_shared_module_exports__['gb'](r.parameters[e],{digits:6,smallCutoff:1e-6,bigCutoff:1e9})}function Al(r,e){return __dcg_shared_module_exports__['gb'](r.statistics[e],{zeroCutoff:1e-15,digits:4,smallCutoff:1e-6,bigCutoff:1e9})}var Do=__dcg_shared_module_exports__['h'](z());var No=__dcg_shared_module_exports__['h'](z());xt();xt();var Sb=class extends kr{constructor(){super();this.dragging=!1,this.guid=__dcg_shared_module_exports__['V']("dragdrop-class")}_evt2pt(t){return{x:t.changedTouches[0].pageX-this._offsetPt.x,y:t.changedTouches[0].pageY-this._offsetPt.y}}_dispatch(t,i){if(this._destroyed)return;let o=this._evt2pt(i);this.triggerEvent(t,{x:o.x,y:o.y,dx:o.x-this._startPt.x,dy:o.y-this._startPt.y,evt:i})}destroy(){H(document).off(`.${this.guid}`),this._destroyed=!0}startDrag(t,i={}){if(!this.dragging)return H(document).on(`dcg-tapmove.${this.guid}`,o=>{(o.originalEvent||o).preventDefault(),cancelAnimationFrame(this.frameThrottle),this.frameThrottle=requestAnimationFrame(()=>this.doDrag(o))}),H(document).on(`dcg-tapend.${this.guid} dcg-tapcancel.${this.guid}`,o=>this.endDrag(o)),this._offsetPt={x:0,y:0},i.origin&&(this._offsetPt={x:this._evt2pt(t).x-i.origin.x,y:this._evt2pt(t).y-i.origin.y}),this._startPt=this._evt2pt(t),this.setProperty("dragging",!0),this._dispatch("onGrab",t)}doDrag(t){this.dragging&&this._dispatch("onDrag",t)}endDrag(t){this.dragging&&(H(document).off(`.${this.guid}`),this.doDrag(t),this.setProperty("dragging",!1),this._dispatch("onDrop",t))}};var{If:kZ}=No.Components,nv=class extends No.Class{template(){return No.createElement("div",{class:()=>({"dcg-slider-interior":!0,"dcg-disable-slider":this.shouldDisableSlider()}),didMount:this.bindFn(this.didMountRoot),onTapStart:this.bindFn(this.onStartDrag)},No.createElement("div",{class:No.const("dcg-track")},No.createElement("div",{class:No.const("dcg-ticks"),onMount:this.bindFn(this.didMountTickMarks)}),No.createElement("div",{class:No.const("dcg-graphic")})),No.createElement(kZ,{predicate:this.bindFn(this.shouldShowZeroMarker)},()=>No.createElement("div",{class:No.const("dcg-zeroMarker"),style:()=>({left:this.getZeroMarkerPercent()+"%"})})),No.createElement("div",{class:()=>({"dcg-thumb":!0,"dcg-down":this.isDragging}),role:No.const("slider"),tabindex:No.const("0"),disablescroll:No.const("true"),style:()=>({left:this.getThumbPercent()+"%"}),onKeyDown:this.bindFn(this.onKeyDown),"aria-label":this.props.ariaLabel,"aria-valuemin":this.props.min,"aria-valuemax":this.props.max,"aria-valuenow":this.props.value,manageFocus:this.buildFocusManager()},No.createElement("div",{class:No.const("dcg-graphic")}),No.createElement("div",{class:No.const("dcg-center")})))}willUnmount(){this.dragDrop.destroy()}didMountRoot(e){this.rootNode=e,this.dragDrop=new Sb,this.isMounted=!0,this.dragDrop.observeEvent("onDrop",()=>{this.isDragging=!1,this.update(),this.props.onDrop&&this.props.onDrop()}),this.dragDrop.observeEvent("onGrab",()=>{this.isDragging=!0,this.update(),this.props.onGrab&&this.props.onGrab()}),this.dragDrop.observeEvent("onDrag",(t,i)=>{this.props.onDragUpdate(this.valueFromPixels(i.x))})}didMountTickMarks(e){this.tickMarksNode=e,this.renderTickMarks()}didUpdate(){this.renderTickMarks()}shouldDisableSlider(){return this.props.min()===this.props.max()}renderTickMarks(){if(this.tickMarksNode){var e=this.props.step(),t=this.props.min(),i=this.props.max(),o;if(e===void 0?o=0:o=100*e/(i-t),o<3&&(o=0),o>100&&(o=0),isNaN(o)&&(o=0),this.lastTickMarksPercent!==o){this.lastTickMarksPercent=o;var n="";if(o>0&&o<100)for(var a=o;a<100;a+=o)n+='<div class="dcg-tick" style="left:'+a+'%"></div>';this.tickMarksNode.innerHTML=n}}}shouldShowZeroMarker(){return this.props.min()<=0&&this.props.max()>=0}getZeroMarkerPercent(){var e=this.props.min(),t=this.props.max();return 100*(0-e)/(t-e)}getThumbPercent(){return 100*this.percentFromValue(this.props.value())}valueFromPixels(e){if(!this.isMounted)return 0;let t=this.props.min(),i=this.props.max(),o=this.rootNode.getBoundingClientRect().width,n=__dcg_shared_module_exports__['Ab'](e/o,0,1),a=t+(i-t)*n,s=(i-t)/o;return Ei(a-s,a+s)}percentFromValue(e){let t=this.props.min(),i=this.props.max();return __dcg_shared_module_exports__['Ab']((e-t)/(i-t),0,1)}pixelsFromValue(e){if(!this.isMounted)return 0;let t=this.percentFromValue(e);return this.rootNode.getBoundingClientRect().width*t}onKeyDown(e){switch(Ee(e)){case gn:this.props.onUpPress&&(this.props.onUpPress(),e.preventDefault());break;case mn:this.props.onDownPress&&(this.props.onDownPress(),e.preventDefault());break;case fs:this.props.onEnterPress&&(this.props.onEnterPress(),e.preventDefault());break;case hn:document.activeElement&&H(document.activeElement).trigger("blur");break;case Cd:this.props.onKeyboardUpdate("down"),e.preventDefault();break;case Dd:this.props.onKeyboardUpdate("up"),e.preventDefault();break;case Nm:this.props.onKeyboardUpdate("bigdown"),e.preventDefault();break;case Rm:this.props.onKeyboardUpdate("bigup"),e.preventDefault();break;case Lu:this.props.onKeyboardUpdate("min"),e.preventDefault();break;case Au:this.props.onKeyboardUpdate("max"),e.preventDefault();break}}onStartDrag(e){if(e.device==="keyboard"||!e.target)return;e.preventDefault(),Kr();let t={x:0,y:0};e.target.closest(".dcg-thumb")?t.x=this.pixelsFromValue(this.props.value()):t.x=e.changedTouches[0].clientX-this.rootNode.getBoundingClientRect().left,this.dragDrop.startDrag(e,{origin:t})}buildFocusManager(){return!this.props.onFocusedChanged||!this.props.isFocused?this.const(void 0):this.const({shouldBeFocused:this.props.isFocused,onFocusedChanged:this.props.onFocusedChanged})}};var Bo=__dcg_shared_module_exports__['h'](z());var{If:EZ}=Bo.Components,av=class extends Bo.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return Bo.createElement("div",{class:Bo.const("dcg-slider_menu dcg-do-blur"),handleEvent:Bo.const("true"),didMount:e=>this.node=e},Bo.createElement("div",{class:Bo.const("dcg-editable-mathquill-container")},Bo.createElement(EZ,{predicate:()=>!this.shouldOnlyShowStep()},()=>Bo.createElement("span",null,Bo.createElement(ir,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.model.slider.hardMin?this.model.slider.min:"",isFocused:()=>this.getFocusedInput()==="min",ariaLabel:()=>this.controller.s("graphing-calculator-narration-slider-minimum"),brailleLabel:()=>this.controller.raw("sldrmin"),handleFocusChanged:(e,t)=>this.handleFocusedChanged("min",e,t),hasError:()=>!mS(this.model),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("min",e,t),handleLatexChanged:e=>this.handleLatexChanged("min",e),dataLabelAttributeValue:this.const("slidermin")}),Bo.createElement("span",{class:Bo.const("dcg-interval-interior")},Bo.createElement(ze,{latex:this.bindFn(this.getDependentLatex),config:this.const({})},Bo.createElement("span",null))),Bo.createElement(ir,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.model.slider.hardMax?this.model.slider.max:"",isFocused:()=>this.getFocusedInput()==="max",ariaLabel:()=>this.controller.s("graphing-calculator-narration-slider-maximum"),brailleLabel:()=>this.controller.raw("sldrmax"),handleFocusChanged:(e,t)=>this.handleFocusedChanged("max",e,t),hasError:()=>!fS(this.model),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("max",e,t),handleLatexChanged:e=>this.handleLatexChanged("max",e),dataLabelAttributeValue:this.const("slidermax")}))),Bo.createElement("span",{class:()=>({"dcg-slider-step-container":!this.shouldOnlyShowStep()})},Bo.createElement("span",{class:Bo.const("dcg-slider-step-label"),"aria-hidden":Bo.const("true")},()=>this.controller.s("graphing-calculator-label-slider-step")),Bo.createElement(ir,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.model.slider.step,isFocused:()=>this.getFocusedInput()==="step",ariaLabel:()=>this.controller.s("graphing-calculator-narration-slider-step"),brailleLabel:()=>this.controller.raw("sldrstep"),handleFocusChanged:(e,t)=>this.handleFocusedChanged("step",e,t),hasError:()=>!bS(this.model),controller:this.props.controller,handlePressedKey:(e,t)=>this.handlePressedKey("step",e,t),handleLatexChanged:e=>this.handleLatexChanged("step",e),dataLabelAttributeValue:this.const("sliderstep")}))))}handlePressedKey(e,t,i){if(!this.controller.isInEditListMode()&&!this.shouldOnlyShowStep()&&(t==="Esc"||t==="Enter")){this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.id}});return}let o=_e.getFocusedMathquill(),n=Gs();if(t==="Left"||t==="Right"||t==="Down"||t==="Up"){var a;o?a=_e.applyArrowKeyAndReturnIfWasAtBounds(o,t,i):n&&(n.selectionStart===0&&t==="Left"||n.selectionStart===n.value.length&&t==="Right"||t==="Up"||t==="Down")?a=!0:a=!1,a&&(i&&i.preventDefault(),t==="Left"&&!this.shouldOnlyShowStep()?e==="max"?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"min"}}):e==="step"&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"max"}}):t==="Right"&&!this.shouldOnlyShowStep()?e==="min"?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"max"}}):e==="max"&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"step"}}):t==="Down"?this.controller.dispatch({type:"on-special-key-pressed",key:"Down"}):t==="Up"&&this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}}));return}o&&(o.keystroke(t,i),this.handleLatexChanged(e,o.latex()))}shouldOnlyShowStep(){return this.model.slider.loopMode==="PLAY_INDEFINITELY"}handleLatexChanged(e,t){e==="min"?this.dispatchMinLatexIfChanged(t):e==="max"?this.dispatchMaxLatexIfChanged(t):e==="step"&&this.dispatchStepLatexIfChanged(t)}handleFocusedChanged(e,t,i){t&&this.getFocusedInput()!==e?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:e}}):this.getFocusedInput()===e&&this.controller.getBrailleMode()==="none"&&(!i.relatedTarget||!this.node.contains(i.relatedTarget))&&this.controller.dispatch({type:"blur-focus-location",location:{type:"slider-limit",id:this.id,location:e}})}dispatchMinLatexIfChanged(e){this.model.slider.min!==e&&this.controller.dispatch({type:"set-slider-minlatex",id:this.id,latex:e})}dispatchMaxLatexIfChanged(e){this.model.slider.max!==e&&this.controller.dispatch({type:"set-slider-maxlatex",id:this.id,latex:e})}dispatchStepLatexIfChanged(e){this.model.slider.step!==e&&this.controller.dispatch({type:"set-slider-steplatex",id:this.id,latex:e})}getDependentLatex(){var e=In(this.model)||"";return" \\le "+__dcg_shared_module_exports__['hb'](e)+" \\le "}getFocusedInput(){let e=this.controller.getFocusLocation();if(!(!e||e.type!=="slider-limit"||e.id!==this.id))return e.location}getMQConfig(){return{autoOperatorNames:Ys()}}};var{If:h4}=Do.Components,sv=class extends Do.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return Do.createElement("span",{class:Do.const("dcg-slider-container"),tapboundary:Do.const("true"),onKeydown:e=>{if(Ee(e)==="Tab"&&!e.altKey&&!e.metaKey&&!e.ctrlKey)if(e.shiftKey)if(this.isSliderMinFocused()&&this.controller.isInEditListMode()){if(e.target){let t=e.target.closest(".dcg-expressionitem");if(t){let i=Array.from(t.querySelectorAll('[tabindex="0"]')).filter(Vp)[0];i==null||i.focus()}}e.preventDefault(),e.stopPropagation()}else this.isSliderThumbFocused()&&(this.controller.isItemReadonly(this.model.id)||(this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"step"}}),e.preventDefault(),e.stopPropagation()));else!e.shiftKey&&this.isSliderStepFocused()&&(this.controller.isInEditListMode()?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-icon",id:this.id}}):this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.id}}),e.preventDefault(),e.stopPropagation())}},Do.createElement(h4,{predicate:this.bindFn(this.shouldShowSlider)},()=>Do.createElement("div",{class:Do.const("dcg-do-blur dcg-slider"),handleEvent:Do.const("true")},Do.createElement("div",{class:Do.const("dcg-minLabel dcg-template-minlabelhtml"),role:Do.const("button"),tabindex:Do.const("0"),"aria-label":this.bindFn(this.getMinAriaLabel),onTap:()=>this.onEditLimit("min")},Do.createElement(ze,{latex:()=>hS(this.model),config:this.const({})})),Do.createElement(nv,{min:()=>xl(this.model),max:()=>Pc(this.model),step:()=>Ql(this.model),value:()=>ws(this.model),ariaLabel:()=>this.controller.getBrailleMode()==="none"?'"'+In(this.model)+'"':""+In(this.model),onGrab:this.bindFn(this.onGrab),onDrop:this.bindFn(this.onDrop),onDragUpdate:this.bindFn(this.onDragUpdate),onKeyboardUpdate:this.bindFn(this.onKeyboardUpdate),onUpPress:()=>this.controller.dispatch({type:"on-special-key-pressed",key:"Up"}),onDownPress:()=>this.controller.dispatch({type:"on-special-key-pressed",key:"Down"}),onEnterPress:()=>this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"}),isFocused:this.bindFn(this.isSliderThumbFocused),onFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.id}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"slider-thumb",id:this.id}})}}),Do.createElement("div",{class:Do.const("dcg-maxLabel dcg-template-maxlabelhtml"),onTap:()=>this.onEditLimit("max"),role:Do.const("button"),tabindex:Do.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-narration-slider-maximum")+" "+ka(hS(this.model))},Do.createElement(ze,{latex:()=>VR(this.model),config:this.const({})})))),Do.createElement(h4,{predicate:this.bindFn(this.shouldShowLimitInputs)},()=>Do.createElement(av,{model:this.props.model,controller:this.props.controller})))}getMinAriaLabel(){return this.controller.isItemReadonly(this.model.id)?this.controller.s("graphing-calculator-narration-slider-minimum")+" "+ka(hS(this.model)):this.controller.s("graphing-calculator-narration-edit-slider-variable-limits",{variable:this.controller.getBrailleMode()==="none"?'"'+In(this.model)+'"':""+In(this.model)})}onGrab(){this.dispatchIsDraggingIfChanged(!0)}onDrop(){this.controller.dispatch({type:"set-none-selected"}),this.dispatchIsPlayingIfChanged(!1),this.dispatchIsDraggingIfChanged(!1)}onKeyboardUpdate(e){this.controller.dispatch({type:"adjust-slider-by-keyboard",id:this.id,adjustment:e})}onDragUpdate(e){this.controller.dispatch({type:"adjust-slider-by-dragging-thumb",id:this.model.id,target:e})}onEditLimit(e){this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:e}})}dispatchIsPlayingIfChanged(e){this.model.slider.isPlaying!==e&&this.controller.dispatch({type:"set-slider-isplaying",id:this.id,isPlaying:e})}dispatchIsDraggingIfChanged(e){this.model.sliderDragging!==e&&this.controller.dispatch({type:"set-slider-dragging",id:this.id,dragging:e})}shouldShowLimitInputs(){if(this.controller.isInEditListMode())return!0;if(this.controller.isItemReadonly(this.model.id))return!1;if(!mS(this.model)||!fS(this.model)||!bS(this.model)||this.model.slider.loopMode==="PLAY_INDEFINITELY")return!0;let e=this.controller.getFocusLocation();return!!(e&&(e.type==="slider-limit"||e.type==="expression"||e.type==="top-level-icon"||e.type==="readonly-expression")&&e.id===this.id)}shouldShowSlider(){return!this.shouldShowLimitInputs()}isSliderThumbFocused(){let e=this.controller.getFocusLocation();return!!(e&&e.type==="slider-thumb"&&e.id===this.id)}isSliderMinFocused(){let e=this.controller.getFocusLocation();return!!(e&&e.type==="slider-limit"&&e.id===this.id&&e.location==="min")}isSliderStepFocused(){let e=this.controller.getFocusLocation();return!!(e&&e.type==="slider-limit"&&e.id===this.id&&e.location==="step")}};xt();var po=__dcg_shared_module_exports__['h'](z());var{For:GZ,If:TZ}=po.Components,td=class extends po.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return po.createElement("div",{class:po.const("dcg-create-sliders dcg-action-createslider"),handleEvent:po.const("true"),onTap:this.bindFn(this.onCreateSlider)},po.createElement("span",{class:po.const("dcg-msg")},()=>this.controller.s("graphing-calculator-label-add-slider")),po.createElement("span",{class:po.const("btns")},po.createElement(GZ,{each:()=>this.getMissingVariables().slice(0,4)},po.createElement("span",null,e=>po.createElement("div",{class:po.const("dcg-slider-btn-container"),var_name:this.const(e)},po.createElement("div",{role:po.const("button"),tabindex:po.const("0"),class:()=>({"dcg-btn-slider":!0,"dcg-btn-blue":this.getMissingVariables().length===1,"dcg-btn-light-gray":this.getMissingVariables().length!==1}),didMount:t=>{t.innerHTML=__dcg_shared_module_exports__['ib'](e)}})))),po.createElement(TZ,{predicate:()=>this.getMissingVariables().length>1},()=>po.createElement("div",{class:po.const("dcg-slider-btn-container dcg-all")},po.createElement("div",{role:po.const("button"),tabindex:po.const("0"),class:po.const("dcg-btn-slider dcg-btn-blue")},()=>this.controller.s("graphing-calculator-button-slider-add-all-variables"))))))}onCreateSlider(e){if(this.controller.dispatch({type:"set-none-selected"}),!e.target)return;var t=e.target.closest(".dcg-slider-btn-container");if(!t)return;let i=t.classList.contains("dcg-all"),o=i?this.getMissingVariables():[t.getAttribute("var_name")];if(this.model.type==="ticker"?this.controller.dispatch({type:"create-sliders-for-ticker",variables:this.getMissingVariables()}):this.controller.dispatch({type:"create-sliders-for-item",id:this.model.id,variables:o}),e.device==="keyboard"){let n=this.model.id,a=this.props.controller().getItemNodeById(n);if(!a)return;i?this.controller.dispatch({type:"move-focus-to-item",id:n}):H(a.querySelector(".dcg-btn-blue")).trigger("focus")}}getMissingVariables(){return this.model.type==="ticker"?Bx(this.model):Ux(this.model)}didMount(){this.promptAlertTimeout&&clearTimeout(this.promptAlertTimeout),this.promptAlertTimeout=setTimeout(()=>{for(var e=[],t=this.getMissingVariables(),i=0;i<t.length;i++)e.push('"'+t[i]+'"');be(this.controller.s("graphing-calculator-narration-add-slider-prompt",{vars:e.join(",")})),this.promptAlertTimeout=0},2e3)}didUnmount(){this.promptAlertTimeout&&clearTimeout(this.promptAlertTimeout)}};var ss=__dcg_shared_module_exports__['h'](z());var lv=class extends ss.Class{template(){return ss.createElement("div",{class:ss.const("dcg-prompt-rename"),handleEvent:ss.const("true")},()=>wo("graphing-calculator-label-rename"),ss.createElement("span",{class:ss.const("dcg-btn-light-gray"),onTap:this.props.handleRename,tabindex:ss.const(0),role:ss.const("button")},ss.createElement(ze,{latex:()=>this.props.from()+" \\to "+this.props.to(),config:this.const({})},ss.createElement("span",{style:ss.const("pointer-events:none")}))),ss.createElement("span",{class:ss.const("dcg-reference-count")},()=>wo("graphing-calculator-label-reference-count",{count:new Vo(this.props.count())})))}};var Ll=__dcg_shared_module_exports__['h'](z());var on=__dcg_shared_module_exports__['h'](z());var{If:g4}=on.Components,cv=class extends on.Class{constructor(){super(...arguments),this.focusedValues={}}template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,on.createElement("div",{class:on.const("dcg-cdf-footer-container dcg-do-blur"),tapboundary:on.const("true"),handleEvent:on.const("true")},on.createElement(st,{checked:()=>Pd(this.model),disabled:()=>K1(this.model)||this.controller.isItemReadonly(this.model.id),onChange:e=>{this.controller.dispatch({type:"set-show-cdf",id:this.model.id,showCDF:e})}},()=>this.controller.s("graphing-calculator-button-find-cdf")),on.createElement(g4,{predicate:()=>Pd(this.model)},()=>on.createElement("div",null,on.createElement("span",{class:on.const("dcg-cdf-limit-name")},()=>this.controller.s("graphing-calculator-label-cdf-minimum")),on.createElement(ir,{handleFocusChanged:e=>this.handleFocusedChanged("min",e),latex:()=>_x(this.model),hasError:()=>!Rx(this.model),isFocused:()=>this.isInputFocused("min"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-cdf-minimum"),placeholder:()=>vN(this.model),handlePressedKey:(e,t)=>this.handlePressedKey(e,t,"min"),controller:this.props.controller,handleLatexChanged:this.bindFn(this.updateCDFMin),readonly:()=>this.controller.isItemReadonly(this.model.id)}),on.createElement("span",{class:on.const("dcg-cdf-limit-name")},()=>this.controller.s("graphing-calculator-label-cdf-maximum")),on.createElement(ir,{handleFocusChanged:e=>this.handleFocusedChanged("max",e),latex:()=>Fx(this.model),hasError:()=>!Nx(this.model),isFocused:()=>this.isInputFocused("max"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-cdf-maximum"),placeholder:()=>CN(this.model),handlePressedKey:(e,t)=>this.handlePressedKey(e,t,"max"),controller:this.props.controller,handleLatexChanged:this.bindFn(this.updateCDFMax),readonly:()=>this.controller.isItemReadonly(this.model.id)}),on.createElement(g4,{predicate:this.bindFn(this.showEvaluation)},()=>on.createElement("div",{class:on.const("dcg-cdf-evaluation-container")},on.createElement(qg,{val:()=>BS(this.model),controller:this.props.controller,dependent:this.const(""),id:()=>this.model.id,focusable:this.const(!0)}))))))}handlePressedKey(e,t,i){if(e==="Esc"){this.controller.dispatch({type:"set-focus-location",location:void 0});return}if(e==="Enter")return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});var o=_e.getFocusedMathquill();o&&(o.keystroke(e,t),i==="min"&&_x(this.model)!==o.latex()&&this.updateCDFMin(o.latex()),i==="max"&&Fx(this.model)!==o.latex()&&this.updateCDFMax(o.latex()))}updateCDFMax(e){this.controller.dispatch({type:"set-cdf-max",id:this.model.id,latex:e})}updateCDFMin(e){this.controller.dispatch({type:"set-cdf-min",id:this.model.id,latex:e})}showEvaluation(){return!(!Nx(this.model)||!Rx(this.model))}isInputFocused(e){let t=this.controller.getFocusLocation();return!t||t.type!=="cdf-limit"||t.id!==this.id?!1:t.location===e}handleFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"cdf-limit",id:this.id,location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"cdf-limit",id:this.id,location:e}})}};var ga=__dcg_shared_module_exports__['h'](z());var{If:IZ,For:m4,SwitchUnion:VZ}=ga.Components,kb=class extends ga.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return VZ(this.bindFn(this.getSuggestionType),{list:()=>ga.createElement(m4,{each:this.bindFn(this.getListOfParameters)},ga.createElement("div",{class:()=>({"dcg-parameter-suggestion-container":!0,"dcg-parameter-suggestion-braille":this.controller.getBrailleMode()!=="none"})},e=>ga.createElement("span",{class:ga.const("dcg-parameter-name")},()=>this.getParamName(e)))),listWithDefault:()=>ga.createElement(m4,{each:this.bindFn(this.getListOfParameters)},ga.createElement("div",{class:()=>({"dcg-parameter-suggestion-container":!0,"dcg-parameter-suggestion-braille":this.controller.getBrailleMode()!=="none"}),onTap:this.bindFn(this.fillInDefaults)},e=>ga.createElement("span",{class:ga.const("dcg-parameter-name")},()=>this.getParamName(e),ga.createElement(IZ,{predicate:()=>this.shouldShowDefaultValue(e)},()=>ga.createElement("span",{class:ga.const("dcg-default-marker")},ga.const("= "),()=>this.getDefaultValue(e)))))),individual:()=>ga.createElement("div",{class:()=>({"dcg-parameter-suggestion-container":!0,"dcg-parameter-suggestion-braille":this.controller.getBrailleMode()!=="none"})},this.bindFn(this.getMissingRequiredParamText)),none:()=>{}})}getExtractedAndDefaultArgString(e){let{params:t,values:i,defaults:o}=e;return t.map((a,s)=>{let l=i[a],c=o[s];return l||c||""}).join(",")}fillInDefaults(){let e=vl(this.model);if(!e)return;let{symbol:t,span:i}=e,{input:o,start:n,end:a}=i,s=this.getExtractedAndDefaultArgString(e),l=`\\operatorname{${t}}\\left(${s}\\right)`,c=`${o.slice(0,n)}${l}${o.slice(a)}`;this.controller.dispatch({type:"set-item-latex",id:this.id,latex:c}),this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}}),this.controller.dispatch({type:"keypad/press-key",key:"Left"})}isMissingDefault(){if(!Px(this.model))return!1;let e=vl(this.model);if(!e)return!1;for(var t=0;t<e.params.length;t++)if(this.shouldShowDefaultValue(e.params[t]))return!0;return!1}getSuggestionType(){return this.getListOfParameters().length>1?this.isMissingDefault()?"listWithDefault":"list":this.missingRequiredParam()?"individual":"none"}missingRequiredParam(){let e=vl(this.model);if(e&&e.params.length===1){var t=e.params[0];if(!this.getDefaultValue(t)&&!this.getParameterExtractedValue(t))return t}}getMissingRequiredParamText(){var e=this.missingRequiredParam();return e?this.controller.s("graphing-calculator-text-enter-pareneter",{param:this.getParamName(e)}):""}getDefaultValue(e){let t=vl(this.model);if(!t||!t.params)return"";for(let i=0;i<t.params.length;i++)if(t.params[i]===e)return t.defaults[i]||"";return""}getParameterExtractedValue(e){let t=vl(this.model);return t&&t.values[e]||""}shouldShowDefaultValue(e){return!this.getParameterExtractedValue(e)&&!!this.getDefaultValue(e)}getListOfParameters(){let e=vl(this.model);return e?e.params:[]}getParamName(e){switch(e){case"mean":return this.controller.s("graphing-calculator-text-parameter-name-mean");case"stdev":return this.controller.s("graphing-calculator-text-parameter-name-stddev");case"dof":return this.controller.s("graphing-calculator-text-parameter-name-dof");case"probsuccess":return this.controller.s("graphing-calculator-text-parameter-name-probsuccess");case"trials":return this.controller.s("graphing-calculator-text-parameter-name-trials");case"data":return this.controller.s("graphing-calculator-text-parameter-name-data");case"binwidth":return this.controller.s("graphing-calculator-text-parameter-name-binwidth");case"min":return this.controller.s("graphing-calculator-text-parameter-name-min");case"max":return this.controller.s("graphing-calculator-text-parameter-name-max");case"height":return this.controller.s("graphing-calculator-text-parameter-name-height");case"offset":return this.controller.s("graphing-calculator-text-parameter-name-offset");default:return e}}};var{If:MZ}=Ll.Components,dv=class extends Ll.Class{template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,Ll.createElement("div",{class:Ll.const("dcg-distribution-parameters-container dcg-do-blur"),tapboundary:Ll.const("true"),handleEvent:Ll.const("true")},Ll.createElement(kb,{model:this.props.model,controller:this.props.controller}),Ll.createElement(MZ,{predicate:()=>q1(this.model)},()=>Ll.createElement(cv,{model:this.props.model,controller:this.props.controller})))}};var Ht=__dcg_shared_module_exports__['h'](z());var{SwitchUnion:AZ,If:f4}=Ht.Components,Eb=class extends Ht.Class{template(){return Ht.createElement("div",{class:Ht.const("dcg-toggle-container")},Ht.createElement("div",{class:Ht.const("dcg-expression-footer-title")},this.props.title,Ht.createElement(f4,{predicate:()=>!!this.props.helpLink},()=>Ht.createElement("a",{"aria-label":()=>this.props.controller().s("account-shell-link-help"),class:Ht.const("dcg-expression-footer-title-help"),target:Ht.const("_blank"),href:this.props.helpLink},Ht.createElement("i",{class:Ht.const("dcg-icon-question-sign"),"aria-hidden":Ht.const("true")})))),Ht.createElement(_r,{staticConfig:this.bindFn(this.getSegmentedControlOptions),ariaGroupLabel:this.props.title,disabled:this.bindFn(this.isReadonly),theme:this.const("mini"),minButtonWidth:this.const(65)}))}isReadonly(){return this.props.controller().isItemReadonly(this.props.model().id)}getSegmentedControlOptions(){return this.props.options().map(e=>({key:e.name,label:()=>e.displayName,selected:()=>this.isSelected(e.name),onSelect:()=>{this.props.controller().dispatch({type:"set-visualization-prop",id:this.props.model().id,prop:this.props.vizProp(),value:e.name})}}))}isSelected(e){return Fp(this.props.model(),this.props.vizProp())===e}},pv=class extends Ht.Class{template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,Ht.createElement("div",{class:Ht.const("dcg-visualization-parameters-container dcg-do-blur"),tapboundary:Ht.const("true"),handleEvent:Ht.const("true")},Ht.createElement(kb,__dcg_shared_module_exports__['a']({},this.props)),Ht.createElement("div",{class:Ht.const("dcg-smaller-font")},AZ(()=>this.getVisualizationType(),{boxplot:()=>Ht.createElement("div",null,Ht.createElement("div",{class:Ht.const("dcg-expression-footer-title")},()=>this.controller.s("graphing-calculator-heading-visual-parameters-display-properties")),this.makeMQInput({prop:"axisOffset",siblingProps:["breadth"],default:"1",name:()=>this.controller.s("graphing-calculator-narration-visual-parameters-offset")}),this.makeMQInput({prop:"breadth",siblingProps:["axisOffset"],default:"1",name:()=>Fp(this.model,"alignedAxis")==="y"?this.controller.s("graphing-calculator-narration-visual-parameters-width"):this.controller.s("graphing-calculator-narration-visual-parameters-height")}),Ht.createElement(st,{checked:()=>!!Fp(this.model,"showBoxplotOutliers"),disabled:()=>this.controller.isItemReadonly(this.model.id),onChange:this.bindFn(this.onToggleOutliers)},Ht.createElement("span",{class:Ht.const("dcg-parameter-name")},()=>this.controller.s("graphing-calculator-button-visual-parameters-exclude-outliers")))),dotplot:()=>Ht.createElement(f4,{predicate:()=>PR(this.model)},()=>Ht.createElement("div",{class:Ht.const("dcg-toggles-container")},Ht.createElement(Eb,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{vizProp:()=>"dotplotXMode",options:()=>[{name:"exact",displayName:this.controller.s("graphing-calculator-button-visual-parameters-exact")},{name:"bin",displayName:this.controller.s("graphing-calculator-button-visual-parameters-binned")}],title:()=>this.controller.s("graphing-calculator-heading-visual-parameters-x-values")})),Ht.createElement(Eb,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{vizProp:()=>"binAlignment",options:()=>[{name:"center",displayName:this.controller.s("graphing-calculator-button-visual-parameters-center")},{name:"left",displayName:this.controller.s("graphing-calculator-button-visual-parameters-left")}],title:()=>this.controller.s("graphing-calculator-heading-visual-parameters-bin-alignment")})))),histogram:()=>Ht.createElement("div",{class:Ht.const("dcg-toggles-container")},Ht.createElement(Eb,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{vizProp:()=>"histogramMode",options:()=>[{name:"",displayName:this.controller.s("graphing-calculator-button-visual-parameters-count")},{name:"relative",displayName:this.controller.s("graphing-calculator-button-visual-parameters-relative")},{name:"density",displayName:this.controller.s("graphing-calculator-button-visual-parameters-density")}],title:()=>this.controller.s("graphing-calculator-heading-visual-parameters-bar-heights"),helpLink:this.const("https://help.desmos.com/hc/en-us/articles/360022405991")})),Ht.createElement(Eb,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{vizProp:()=>"binAlignment",options:()=>[{name:"center",displayName:this.controller.s("graphing-calculator-button-visual-parameters-center")},{name:"left",displayName:this.controller.s("graphing-calculator-button-visual-parameters-left")}],title:()=>this.controller.s("graphing-calculator-heading-visual-parameters-bin-alignment")}))),none:()=>Ht.createElement("span",null)})))}makeMQInput(e){return Ht.createElement("span",null,Ht.createElement("span",{class:Ht.const("dcg-parameter-name")},e.name,Ht.const(":")),Ht.createElement(ir,{latex:()=>this.getPropLatex(e),ariaLabel:e.name,placeholder:()=>e.default,isFocused:()=>this.isInputFocused(e.prop),hasError:()=>!AR(this.model,e.prop),handleFocusChanged:t=>this.handleFocusedChanged(e.prop,t),handlePressedKey:(t,i)=>this.handlePressedKey(t,i,e.prop),handleLatexChanged:t=>this.handleLatexChanged(e.prop,t),readonly:()=>this.controller.isItemReadonly(this.model.id),controller:this.props.controller}))}handlePressedKey(e,t,i){if(e==="Esc"){this.controller.dispatch({type:"set-focus-location",location:void 0});return}if(e==="Enter")return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});var o=_e.getFocusedMathquill();o&&(o.keystroke(e,t),this.handleLatexChanged(i,o.latex()))}isInputFocused(e){let t=this.controller.getFocusLocation();return!t||t.type!=="visualization-prop"||t.id!==this.id?!1:t.location===e}handleFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"visualization-prop",id:this.id,location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"visualization-prop",id:this.id,location:e}})}getPropLatex({prop:e}){let t=Fp(this.model,e);return typeof t=="string"?t:""}handleLatexChanged(e,t){Fp(this.model,e)!==t&&this.controller.dispatch({type:"set-visualization-prop",id:this.id,prop:e,value:t})}onToggleOutliers(){var e=Fp(this.model,"showBoxplotOutliers");this.controller.dispatch({type:"set-visualization-prop",id:this.id,prop:"showBoxplotOutliers",value:!e})}getVisualizationType(){return Px(this.model)?$u(this.model)?"boxplot":Bp(this.model)?"dotplot":lg(this.model)?"histogram":"none":"none"}};var Wt=__dcg_shared_module_exports__['h'](z());var uv=class extends Wt.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return Wt.createElement("div",{class:Wt.const("dcg-ttest-footer-container dcg-do-blur"),handleEvent:Wt.const("true")},Wt.createElement("table",null,Wt.createElement("tr",null,Wt.createElement("td",null,Wt.createElement("div",{class:Wt.const("dcg-value"),role:Wt.const("textbox"),"aria-readonly":Wt.const("true"),tabindex:Wt.const("0"),"aria-label":()=>"Less than: "+this.getLessThan()},Wt.createElement("span",{class:Wt.const("dcg-operator")},Wt.createElement(ze,{config:this.const({}),latex:this.const("<")})),Wt.createElement("span",{class:Wt.const("dcg-evaluation")},Wt.createElement(ze,{config:this.const({}),latex:()=>this.getLessThan()}))))),Wt.createElement("tr",null,Wt.createElement("td",null,Wt.createElement("div",{class:Wt.const("dcg-value"),role:Wt.const("textbox"),"aria-readonly":Wt.const("true"),tabindex:Wt.const("0"),"aria-label":()=>"Greater than: "+this.getGreaterThan()},Wt.createElement("span",{class:Wt.const("dcg-operator")},Wt.createElement(ze,{config:this.const({}),latex:this.const(">")})),Wt.createElement("span",{class:Wt.const("dcg-evaluation")},Wt.createElement(ze,{config:this.const({}),latex:()=>this.getGreaterThan()}))))),Wt.createElement("tr",null,Wt.createElement("td",null,Wt.createElement("div",{class:Wt.const("dcg-value"),role:Wt.const("textbox"),"aria-readonly":Wt.const("true"),tabindex:Wt.const("0"),"aria-label":()=>"Not equal: "+this.getNotEqual()},Wt.createElement("span",{class:Wt.const("dcg-operator")},Wt.createElement(ze,{config:this.const({}),latex:this.const("\u2260")})),Wt.createElement("span",{class:Wt.const("dcg-evaluation")},Wt.createElement(ze,{config:this.const({}),latex:()=>this.getNotEqual()})))))))}getLessThan(){var e=df(this.model);return e?__dcg_shared_module_exports__['tc'](e.lessThan,5):""}getGreaterThan(){var e=df(this.model);return e?__dcg_shared_module_exports__['tc'](e.greaterThan,5):""}getNotEqual(){var e=df(this.model);return e?__dcg_shared_module_exports__['tc'](e.notEqual,5):""}};var nt=__dcg_shared_module_exports__['h'](z());var hv=class extends nt.Class{template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,nt.createElement("div",{class:nt.const("dcg-stats-footer-container dcg-do-blur"),handleEvent:nt.const("true")},nt.createElement("table",null,nt.createElement("tr",null,nt.createElement("td",null,nt.createElement("div",{class:nt.const("dcg-value"),role:nt.const("textbox"),"aria-readonly":nt.const("true"),tabindex:nt.const("0"),"aria-label":()=>"Min: "+this.getMin()},nt.createElement("span",{class:nt.const("dcg-row-header")},nt.const("Min")),nt.createElement("span",{class:nt.const("dcg-evaluation")},nt.createElement(ze,{config:this.const({}),latex:this.bindFn(this.getMin)}))))),nt.createElement("tr",null,nt.createElement("td",null,nt.createElement("div",{class:nt.const("dcg-value"),role:nt.const("textbox"),"aria-readonly":nt.const("true"),tabindex:nt.const("0"),"aria-label":()=>"Q1: "+this.getQ1()},nt.createElement("span",{class:nt.const("dcg-row-header")},nt.const("Q1")),nt.createElement("span",{class:nt.const("dcg-evaluation")},nt.createElement(ze,{config:this.const({}),latex:this.bindFn(this.getQ1)}))))),nt.createElement("tr",null,nt.createElement("td",null,nt.createElement("div",{class:nt.const("dcg-value"),role:nt.const("textbox"),"aria-readonly":nt.const("true"),tabindex:nt.const("0"),"aria-label":()=>"Median: "+this.getMedian()},nt.createElement("span",{class:nt.const("dcg-row-header")},nt.const("Median")),nt.createElement("span",{class:nt.const("dcg-evaluation")},nt.createElement(ze,{config:this.const({}),latex:this.bindFn(this.getMedian)}))))),nt.createElement("tr",null,nt.createElement("td",null,nt.createElement("div",{class:nt.const("dcg-value"),role:nt.const("textbox"),"aria-readonly":nt.const("true"),tabindex:nt.const("0"),"aria-label":()=>"Q3: "+this.getQ3()},nt.createElement("span",{class:nt.const("dcg-row-header")},nt.const("Q3")),nt.createElement("span",{class:nt.const("dcg-evaluation")},nt.createElement(ze,{config:this.const({}),latex:this.bindFn(this.getQ3)}))))),nt.createElement("tr",null,nt.createElement("td",null,nt.createElement("div",{class:nt.const("dcg-value"),role:nt.const("textbox"),"aria-readonly":nt.const("true"),tabindex:nt.const("0"),"aria-label":()=>"Max: "+this.getMax()},nt.createElement("span",{class:nt.const("dcg-row-header")},nt.const("Max")),nt.createElement("span",{class:nt.const("dcg-evaluation")},nt.createElement(ze,{config:this.const({}),latex:this.bindFn(this.getMax)})))))))}getMin(){let e=pf(this.model);return e?__dcg_shared_module_exports__['sc'](e.min):""}getQ1(){let e=pf(this.model);return e?__dcg_shared_module_exports__['sc'](e.q1):""}getMedian(){let e=pf(this.model);return e?__dcg_shared_module_exports__['sc'](e.median):""}getQ3(){let e=pf(this.model);return e?__dcg_shared_module_exports__['sc'](e.q3):""}getMax(){let e=pf(this.model);return e?__dcg_shared_module_exports__['sc'](e.max):""}};var qo=__dcg_shared_module_exports__['h'](z());var{If:LZ}=qo.Components,zg=class extends qo.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return qo.createElement("div",{class:qo.const("dcg-action-info"),handleEvent:qo.const("true")},qo.createElement("span",{class:qo.const("dcg-action-label")},qo.const("Run ")),qo.createElement(ze,{latex:()=>this.model.clickableInfo.latex,config:this.bindFn(this.getMQConfig)}),qo.createElement("span",{class:qo.const("dcg-action-label")},qo.const(" on click")),qo.createElement(LZ,{predicate:()=>!this.controller.isItemReadonly(this.model.id)},()=>qo.createElement("span",{class:qo.const("dcg-click-edit"),role:qo.const("button"),tabindex:qo.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-action"),onTap:this.bindFn(this.editAction)},qo.createElement("i",{class:qo.const("dcg-icon-pencil"),"aria-hidden":qo.const("true")}))))}editAction(){this.model.type==="expression"?this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"expression",model:this.model,guid:this.getMenuGUID(),focusFirstOption:!1}}):this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"image",model:this.model,guid:this.getMenuGUID(),focusFirstOption:!1}}),this.controller.dispatch({type:"set-focus-location",location:{type:"expression-menu",id:this.model.id,location:"updaterule"}})}getMenuGUID(){return this.model.guid}getMQConfig(){return{autoOperatorNames:Ys({additionalOperators:["index"]}),autoCommands:qd()}}};var Nt=__dcg_shared_module_exports__['h'](z());var{If:C0}=Nt.Components,rc=class extends Nt.Class{init(){this.controller=this.props.controller()}template(){return Nt.createElement(C0,{predicate:this.bindFn(this.shouldShowOptions)},()=>Nt.createElement("span",{class:()=>({"dcg-expression-edit-actions":!0,"dcg-limited-height":this.limitedHeight()}),style:()=>({background:this.controller.getBackgroundColor()}),didMount:()=>{this.controller.isInEditListMode()&&be(this.controller.s("graphing-calculator-narration-edit-list-mode-on"))},didUnmount:()=>{this.controller.isInEditListMode()||be(this.controller.s("graphing-calculator-narration-edit-list-mode-off"))}},Nt.createElement(C0,{predicate:()=>!this.controller.hasBackgroundColor()},()=>Nt.createElement("span",{class:Nt.const("dcg-graphic"),handleEvent:Nt.const("true ")})),Nt.createElement(C0,{predicate:this.bindFn(this.canConvertToTable)},()=>Nt.createElement(Me,{tooltip:this.bindFn(this.getConvertTooltip),gravity:this.const("s")},Nt.createElement("span",{class:Nt.const("dcg-action-createtable dcg-exp-action-button"),handleEvent:Nt.const("true"),role:Nt.const("button"),tabindex:Nt.const("0"),"aria-label":()=>_i(this.model(),"create_table"),onTap:this.bindFn(this.onCreateTable)},Nt.createElement("i",{class:Nt.const("dcg-icon-table"),"aria-hidden":Nt.const("true")})))),Nt.createElement(C0,{predicate:()=>this.controller.shouldShowAuthorFeatures()},()=>Nt.createElement(Me,{tooltip:this.bindFn(this.getReadonlyToggleLabel),gravity:this.const("s")},Nt.createElement("span",{class:()=>({"dcg-action-lock":!0,"dcg-exp-action-button":!0,"dcg-selected":this.isReadonly()}),handleEvent:Nt.const("true"),role:Nt.const("button"),tabindex:Nt.const("0"),"aria-label":this.bindFn(this.getReadonlyToggleLabel),onTap:this.bindFn(this.onToggleReadonly)},Nt.createElement("i",{class:Nt.const("dcg-icon-lock"),"aria-hidden":Nt.const("true")})))),Nt.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-duplicate-expression-tooltip"),gravity:this.const("s")},Nt.createElement("span",{class:Nt.const("dcg-duplicate-btn dcg-exp-action-button"),handleEvent:Nt.const("true"),role:Nt.const("button"),tabindex:Nt.const("0"),"aria-label":()=>_i(this.model(),"duplicate"),onTap:this.bindFn(this.onDuplicateWithoutFocus)},Nt.createElement("i",{class:Nt.const("dcg-icon-duplicate"),"aria-hidden":Nt.const("true")}))),Nt.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-expression-delete-tooltip"),gravity:this.const("s")},Nt.createElement("span",{class:Nt.const("dcg-delete-btn dcg-exp-action-button"),handleEvent:Nt.const("true"),role:Nt.const("button"),tabindex:Nt.const("0"),"aria-label":()=>_i(this.model(),"delete"),onTap:this.bindFn(this.onDelete)},Nt.createElement("i",{class:Nt.const("dcg-icon-remove"),"aria-hidden":Nt.const("true")})))))}shouldShowOptions(){return this.controller.isInEditListMode()&&(this.controller.shouldShowAuthorFeatures()||!this.controller.isItemReadonly(this.props.id()))}model(){return this.controller.getItemModel(this.props.id())}getConvertTooltip(){return this.shouldInsertOnCreateTable()?this.controller.s("graphing-calculator-label-convert-to-table-tooltip"):this.controller.s("graphing-calculator-label-create-table")}canConvertToTable(){let e=this.model();return!!(e&&e.type==="expression"&&e.formula.is_tableable)}limitedHeight(){let e=this.model();return e&&(e.type==="image"||this.isSlider())}isSlider(){let e=this.model();return e&&e.type==="expression"&&e.sliderExists}generateSubscriptedTableColumns(e,t,i){var o={independent:t,dependent:i};if(t==="x")return o;var n=__dcg_shared_module_exports__['lc'](t);if(n.type!=="Identifier")return o;var a=__dcg_shared_module_exports__['lc'](i);if(a.type!=="FunctionCall"||a.args.length!==1)return o;var s=a.args[0];if(s.type!=="Identifier"||s._symbol!==t)return o;let l=a.getInputString(),c=s.getInputSpan(),p=l.substr(0,c.start),u=l.substr(c.end);return o.independent="x_{"+e+"}",o.dependent=p+o.independent+u,o}shouldInsertOnCreateTable(){let e=this.model();return!!e&&e.type==="expression"&&Od(e)}onCreateTable(){let e=this.model();if(!(!e||e.type!=="expression")){var t=e.formula;if(t.is_tableable&&t.table_info){var i=t.table_info,o=e.index,n=i.independent_variable,a=i.dependent_column;if(i.by_reference){let C=this.generateSubscriptedTableColumns(this.controller.generateTableXSubscript(),n,a);n=C.independent,a=C.dependent}var s,l=[],c=[];if(i.values)for(s=0;s<i.values.length;s++){var p=i.values[s][0];l.push(isNaN(p)?"":__dcg_shared_module_exports__['rc'](p));var u=i.values[s][1];c.push(isNaN(u)?"":__dcg_shared_module_exports__['rc'](u))}else for(s=-2;s<=2;s++)l.push(s+""),c.push("");var m={id:this.controller.generateId(),type:"table",readonly:!i.by_reference&&e.readonly,columns:[{id:this.controller.generateId(),latex:n,color:this.controller.getNextColor(),hidden:!1,values:l,points:!0,lines:!1,dragMode:"NONE",pointStyle:"POINT",lineStyle:"SOLID",colorLatex:"",lineOpacity:"",lineWidth:"",pointOpacity:"",pointSize:""},{id:this.controller.generateId(),latex:a,color:Nc(e),hidden:!1,values:c,points:!0,lines:this.shouldInsertOnCreateTable()&&!!e.lines,dragMode:"NONE",pointStyle:"POINT",lineStyle:"SOLID",colorLatex:"",lineOpacity:"",lineWidth:"",pointOpacity:"",pointSize:""}]},h=this.controller;this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!1,focusExpressionList:!1}),this.shouldInsertOnCreateTable()?this.controller.dispatch({type:"replace-item-at-index",index:o,state:m,focus:!0}):this.controller.dispatch({type:"insert-item-at-index",index:o+1,state:m,folderId:e.folderId,focus:!0});var x=function(){h.dispatch({type:"undo"}),h.dispatch({type:"set-edit-list-mode",isEditListMode:!0,focusExpressionList:!1})};this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-table-created"),undoCallback:x}})}}}onDelete(e){this.controller.dispatch({type:"delete-item-and-animate-out",id:this.props.id(),setFocusAfterDelete:e.device==="keyboard"})}onDuplicateWithoutFocus(){let e=this.model();e&&(e.type==="folder"?this.controller.dispatch({type:"duplicate-folder",id:this.props.id()}):this.controller.dispatch({type:"duplicate-expression",id:this.props.id()}))}isReadonly(){return this.controller.isItemReadonly(this.props.id())}onToggleReadonly(){let e=this.model();e&&this.controller.dispatch({type:"set-item-readonly",id:this.props.id(),readonly:!e.readonly})}getReadonlyIcon(){return this.isReadonly()?"dcg-icon-lock":"dcg-icon-pencil"}getReadonlyToggleLabel(){return this.isReadonly()?this.controller.s("graphing-calculator-label-unlock-expression-tooltip"):this.controller.s("graphing-calculator-label-lock-expression-tooltip")}};var Is=__dcg_shared_module_exports__['h'](z());var{If:OZ}=Is.Components,Gb=class extends Is.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return Is.createElement(OZ,{predicate:()=>this.controller.showExpressionZoomFitButton(this.model)},()=>Is.createElement("div",{class:Is.const("dcg-suggested-zoom-view dcg-do-blur"),handleEvent:Is.const(!0)},Is.createElement(Me,{tooltip:this.bindFn(this.getZoomText),gravity:()=>"e"},Is.createElement("i",{onTap:this.bindFn(this.onZoom),role:Is.const("button"),tabindex:Is.const("0"),"aria-label":this.bindFn(this.getZoomText),class:Is.const("dcg-icon-zoom-fit")}))))}getZoomText(){return this.controller.s("graphing-calculator-text-zoom-fit")}onZoom(e){this.controller.dispatch({type:"expression-zoom-fit",id:this.model.id,focusAfterTap:e.device==="keyboard"})}};var ut=__dcg_shared_module_exports__['h'](z());var Vn=__dcg_shared_module_exports__['h'](z());var{If:PZ}=Vn.Components,{Switch:_Z}=Vn.Components,ic=class extends Vn.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}iconType(){return this.controller.shouldShowReplaceIcon()?"rename":this.controller.isItemReadonly(this.model.id)?"lock":"delete"}getAriaLabel(){switch(this.iconType()){case"none":case"lock":return;case"rename":return _i(this.model,"rename");case"delete":return _i(this.model,"delete")}}onIconTap(){this.iconType()==="delete"?this.controller.dispatch({type:"delete-item-and-animate-out",id:this.model.id,setFocusAfterDelete:!this.controller.isInEditListMode()}):this.iconType()==="rename"&&this.controller.dispatch({type:"rename-identifier-in-item",search:this.controller.getExpressionSearchStr(),replace:this.controller.getExpressionReplaceStr(),id:this.model.id})}isIconTappable(){let e=this.iconType();return e!=="none"&&e!=="lock"}template(){return Vn.createElement(PZ,{predicate:()=>!this.controller.isInEditListMode()},()=>Vn.createElement("div",{class:()=>({"dcg-top-level-icon":!0,"dcg-tappable":this.isIconTappable()}),tabIndex:()=>this.isIconTappable()?0:-1,"aria-label":this.bindFn(this.getAriaLabel),handleEvent:this.bindFn(this.isIconTappable),onTap:this.bindFn(this.onIconTap),role:Vn.const("button"),manageFocus:this.const({shouldBeFocused:()=>vg({controller:this.controller,location:{type:"top-level-icon",id:this.model.id}}),onFocusedChanged:(e,t)=>{var i;e?this.controller.dispatch({type:"set-focus-location",location:{type:"top-level-icon",id:this.model.id}}):t.relatedTarget&&!((i=t.relatedTarget)!=null&&i.closest("[data-dcg-label]"))&&this.controller.dispatch({type:"blur-focus-location",location:{type:"top-level-icon",id:this.model.id}})}})},Vn.createElement(_Z,{key:()=>this.iconType()},e=>{switch(e){case"delete":return Vn.createElement("i",{class:Vn.const("dcg-icon-remove dcg-top-level-delete"),"aria-hidden":Vn.const("true")});case"lock":return Vn.createElement("i",{class:Vn.const("dcg-icon-lock dcg-lock-indicator"),"aria-hidden":Vn.const("true")});case"rename":return Vn.createElement("i",{class:Vn.const("dcg-icon-replace"),"aria-hidden":Vn.const("true")});case"none":return Vn.createElement("span",null)}})))}};var{If:tp,SwitchUnion:FZ}=ut.Components,Ug=class extends Ts{didMount(){this.onItemViewMounted(),this.lastBrailleMode=this.controller.getBrailleMode()}didMountRootNode(e){this.rootNode=e}willUnmount(){this.onItemViewUnmounted()}template(){return ut.createElement("div",{class:()=>({"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-mathitem":!0,"dcg-inFolder":!!this.model.folderId,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-selected":this.controller.isItemSelected(this.id)&&!this.controller.isInEditListMode(),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id),"dcg-hasSlider":this.hasSlider(),"dcg-hasEvaluation":this.controller.shouldShowEvaluationForItem(this.id),"dcg-hasRegression":this.hasRegression(),"dcg-hasDomain":this.hasDomain()||this.hasDomain3d()}),"expr-id":()=>this.model.id,didMount:this.bindFn(this.didMountRootNode)},ut.createElement("div",{class:ut.const("dcg-fade-container"),onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect)},ut.createElement("div",{class:ut.const("dcg-main")},ut.createElement(tp,{predicate:()=>!this.controller.isInEditListMode()&&!this.isReadonly()},()=>ut.createElement(co,__dcg_shared_module_exports__['a']({latex:()=>mx(this.model),operatorNames:()=>this.getMQConfig().autoOperatorNames,ariaLabel:()=>this.getAriaLabel("braille"),brailleShouldFocus:()=>this.isFocused(),onBrailleInput:e=>this.handleLatexChanged(e),onBrailleFocusedChanged:(e,t)=>this.handleMQFocusedChanged(e,t),onBrailleKeydown:this.bindFn(this.handleBraillePressedKey)},rn(this.controller)),ut.createElement(_e,{latex:()=>mx(this.model),getAriaLabel:()=>this.getAriaLabel("speech"),getAriaPostLabel:this.bindFn(this.getFormulaAria),isFocused:()=>this.isFocused(),tokenController:this.props.controller,capExpressionSize:()=>this.controller.getCapExpressionSize(),config:this.bindFn(this.getMQConfig),hasError:this.const(!1),onUserPressedKey:(e,t)=>this.handlePressedKey(e,t),onUserChangedLatex:e=>this.handleLatexChanged(e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:(e,t)=>this.handleMQFocusedChanged(e,t),onSelectionChanged:()=>{this.controller.runAfterDispatch(()=>{this.controller.dispatch({type:"render"})})},needsSystemKeypad:()=>!this.controller.isKeypadEnabled()}))),ut.createElement(tp,{predicate:()=>this.controller.isInEditListMode()||this.isReadonly()},()=>ut.createElement("div",{class:ut.const("dcg-edit-list-mathquill"),tabindex:()=>this.controller.getBrailleMode()==="none"?"0":"-1",onTap:()=>this.controller.isInEditListMode()?this.exitEditListMode():{},onKeydown:this.bindFn(this.handleReadonlyPressedKey),manageFocus:this.const({shouldBeFocused:()=>this.controller.getBrailleMode()!=="none"?!1:vg({controller:this.controller,location:{type:"readonly-expression",id:this.model.id}}),onFocusedChanged:(e,t)=>{this.controller.getBrailleMode()==="none"&&(e?this.controller.dispatch({type:"set-focus-location",location:{type:"readonly-expression",id:this.model.id}}):this.doesNodeBelongToSliderLimit(t.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"readonly-expression",id:this.model.id}}))}})},ut.createElement(co,__dcg_shared_module_exports__['a']({latex:()=>mx(this.model),operatorNames:()=>this.getMQConfig().autoOperatorNames,ariaLabel:()=>this.getAriaLabel("braille"),isStatic:this.const(!0),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="readonly-expression"?!1:e.id===this.id},onBrailleFocusedChanged:(e,t)=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"readonly-expression",id:this.model.id}}):this.doesNodeBelongToSliderLimit(t.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"readonly-expression",id:this.model.id}})}},rn(this.controller)),ut.createElement(ze,{latex:()=>mx(this.model),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel("speech"),tokenController:this.props.controller}))))),ut.createElement(ic,{controller:this.props.controller,model:this.props.model}),ut.createElement(tp,{predicate:this.bindFn(this.shouldShowFooter)},()=>ut.createElement("div",{class:this.getFooterClass()},FZ(()=>this.getFooterType(),{none:()=>{},regression:()=>ut.createElement(ov,{model:this.props.model,controller:this.props.controller}),label:()=>ut.createElement(Sg,{model:this.props.model,controller:this.props.controller}),slider:()=>ut.createElement(sv,{model:this.props.model,controller:this.props.controller}),domain:()=>ut.createElement(Kg,{model:this.props.model,controller:this.props.controller}),domain3d:()=>ut.createElement("div",null,ut.createElement(tp,{predicate:()=>!gN(this.model)},()=>ut.createElement(Kg,{model:this.props.model,controller:this.props.controller,parameter:()=>this.domainVariable1(this.props.model())})),ut.createElement(tp,{predicate:()=>!mN(this.model)},()=>ut.createElement(Kg,{model:this.props.model,controller:this.props.controller,parameter:()=>this.domainVariable2(this.props.model())}))),evaluation:()=>ut.createElement(qg,{id:()=>this.props.model().id,dependent:()=>In(this.model)||"",val:()=>this.controller.getEvaluationValueForItem(this.id),controller:this.props.controller,focusable:this.const(!0)}),distribution:()=>ut.createElement(dv,{model:this.props.model,controller:this.props.controller}),visualization:()=>ut.createElement(pv,{model:this.props.model,controller:this.props.controller}),ttest:()=>ut.createElement(uv,{model:this.props.model,controller:this.props.controller}),stats:()=>ut.createElement(hv,{model:this.props.model,controller:this.props.controller}),unresolved:()=>ut.createElement(iv,{controller:this.props.controller})}),ut.createElement(tp,{predicate:this.bindFn(this.shouldShowBrailleError)},()=>ut.createElement("div",{tabindex:ut.const(0),class:ut.const("dcg-expression-braille-error"),role:ut.const("button"),"aria-roledescription":ut.const("error"),"aria-label":()=>this.controller.unpack(this.model.error)},ut.createElement("i",{class:ut.const("dcg-icon-error"),"aria-hidden":ut.const("true")}),()=>this.controller.unpack(this.model.error))),ut.createElement(tp,{predicate:this.bindFn(this.shouldShowSliderPrompt)},()=>ut.createElement(td,{model:this.props.model,controller:this.props.controller})),ut.createElement(tp,{predicate:this.bindFn(this.shouldShowRenamePrompt)},()=>ut.createElement(lv,{from:this.bindFn(this.getRenameIdentifierFrom),to:this.bindFn(this.getRenameIdentifierTo),count:this.bindFn(this.getRenameCountOfChanges),handleRename:this.bindFn(this.handleRename)})))),ut.createElement(tp,{predicate:this.bindFn(this.shouldShowActionInfo)},()=>ut.createElement("div",{class:this.getFooterClass()},ut.createElement(zg,{model:this.props.model,controller:this.props.controller}))),ut.createElement(tp,{predicate:this.bindFn(this.shouldShowExtendTo3D)},()=>ut.createElement("div",{class:this.getFooterClass("dcg-extend-to-3d"),handleEvent:ut.const("true")},ut.createElement(st,{onChange:e=>{this.controller.dispatch({type:"set-item-extend-to-3D",id:this.model.id,extendTo3D:e})},checked:()=>this.model.extendTo3D,class:this.const("dcg-expression-footer-checkbox")},()=>this.controller.s("graphing-calculator-label-extend-to-3d"))))),ut.createElement("span",{class:ut.const("dcg-tab dcg-action-drag dcg-action-icon-touch"),handleevent:ut.const("true"),tapboundary:ut.const("true"),disablescroll:ut.const("true"),onTapStart:this.bindFn(this.onDragPending)},ut.createElement("span",{class:ut.const("dcg-num")},()=>this.model.displayIndex),ut.createElement("div",{class:ut.const("dcg-tab-interior dcg-action-icon-mouse")},ut.createElement(rv,{model:this.props.model,controller:this.props.controller})),ut.createElement(Gb,{model:this.props.model,controller:this.props.controller})),ut.createElement(rc,{controller:this.props.controller,id:()=>this.model.id}))}shouldShowExtendTo3D(){return this.controller.isThreeDMode()?VS(this.model):!1}domainVariable1(e){return wl(e)?"\\theta":zs(e)?"r":"u"}domainVariable2(e){return wl(e)?"\\phi":zs(e)?"\\theta":"v"}getRenameIdentifierFrom(){let e=this.controller.getSuggestedIdentifierRenameInfo(this.id);return e&&e.from||""}getRenameIdentifierTo(){let e=this.controller.getSuggestedIdentifierRenameInfo(this.id);return e&&e.to||""}getRenameCountOfChanges(){let e=this.controller.getSuggestedIdentifierRenameInfo(this.id);return e&&e.countOfChanges||0}handleRename(){this.controller.dispatch({type:"rename-identifier-global",search:this.getRenameIdentifierFrom(),replace:this.getRenameIdentifierTo()})}didUpdate(){this.lastBrailleMode=this.controller.getBrailleMode()}shouldShowFooter(){return this.shouldShowBrailleError()||this.shouldShowSliderPrompt()||this.shouldShowRenamePrompt()?!0:this.getFooterType()!=="none"}getFooterType(){return this.hasRegression()?"regression":this.shouldShowLabelView()?"label":this.hasSlider()?"slider":this.hasDomain()?"domain":this.hasDomain3d()?"domain3d":this.isTTest()?"ttest":this.isStats()?"stats":this.controller.shouldShowEvaluationForItem(this.id)?"evaluation":this.isToplevelDistribution()?"distribution":this.isVisualization()?"visualization":this.model.unresolved?"unresolved":"none"}getFooterClass(e){return this.const({"dcg-expression-bottom":!0,"dcg-indent-in-folder":!0,"dcg-fadein-bottom":!this.isFirstRender(),[e||""]:!!e})}onCreateSliders(e){this.controller.dispatch({type:"create-sliders-for-item",id:this.id,variables:e})}shouldShowLabelView(){return Pr("labels")&&yN(this.model)&&!this.controller.isThreeDMode()}shouldShowSliderPrompt(){return this.controller.areSlidersEnabled()?uS(this.model).length>0:!1}shouldShowRenamePrompt(){return this.getRenameCountOfChanges()>0}shouldShowActionInfo(){return!!(this.controller.areActionsEnabled()&&this.model.clickableInfo&&this.model.clickableInfo.enabled&&this.model.clickableInfo.latex)}shouldShowBrailleError(){return this.controller.getBrailleMode()!=="none"&&this.hasError()}hasRegression(){return!!(this.model.formula&&this.model.formula.is_regression)}hasDomain(){return ES(this.model)}hasDomain3d(){return GS(this.model)}isToplevelDistribution(){return ju(this.model)}isVisualization(){return LS(this.model)}isTTest(){return OS(this.model)}isStats(){return xN(this.model)}hasSlider(){return!!this.model.sliderExists}getLabelOptions(){return this.controller.getEvaluationLabelOptionsForItem(this.model.id)}getAriaLabel(e){if(this.shouldShowLabelView()){var t;this.model.label&&this.model.label!==""?t=this.model.label:e==="speech"?t=this.controller.s("graphing-calculator-narration-expression-label"):t=this.controller.raw("lbl");var i;return _c(this.model)?i=t:e==="speech"?i=this.controller.s("graphing-calculator-narration-expression-hidden-label",{label:t}):i=this.controller.raw("h __label__",{label:t}),i}return e==="speech"?this.controller.s("shared-calculator-narration-expression-index",{index:this.model.displayIndex}):this.controller.raw("eq__index__",{index:this.model.displayIndex})}getFormulaAria(){let e=this.model.formula,t="";if(!e||Us(this.model))return t;if(this.controller.shouldShowEvaluationForItem(this.id)){t="equals ";let i=e.zero_values&&e.zero_values.length?e.zero_values[0].val:e.constant_value;Array.isArray(i)?t+=i.length+" element list.":i!==void 0&&(t+=ca(__dcg_shared_module_exports__['gb'](+i,this.getLabelOptions())))}else e.error&&!this.shouldShowSliderPrompt()?t=this.controller.unpack(e.error):ju(this.model)?t=this.controller.s("graphing-calculator-narration-expression-evaluation-is-distribution"):this.isTTest()&&(t=this.controller.s("graphing-calculator-narration-expression-evaluation-is-t-test"));if(this.model.shouldGraph&&(e.is_graphable||e.is_regression)){e.is_graphable&&e.is_regression?t+=" "+this.controller.s("graphing-calculator-narration-expression-evaluation-has-graph-and-regression"):e.is_regression?t+=" "+this.controller.s("graphing-calculator-narration-expression-evaluation-has-regression"):t+=" "+this.controller.s("graphing-calculator-narration-expression-evaluation-has-graph");let i=this.controller.getAudioGraph();i&&i.agNavigator.canTrace(this.model)&&(oi?t+=" "+this.controller.s("graphing-calculator-narration-expression-audio-trace-mac"):t+=" "+this.controller.s("graphing-calculator-narration-expression-audio-trace-windows"))}return t}handleBraillePressedKey(e){let t=Ee(e);if(t){if(t==="Esc")Kr(),this.hasSlider()&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.model.id}});else if(t==="Up"||t==="Down"||t==="Enter")this.controller.dispatch({type:"on-special-key-pressed",key:t});else if(t==="Del"||t==="Backspace"){let i=Gs();Us(this.model)&&Db(i)&&(this.controller.dispatch({type:"on-special-key-pressed",key:t==="Del"?"Delete":t}),e.preventDefault(),e.stopPropagation())}}}handleReadonlyPressedKey(e){if(this.controller.isInEditListMode())return;let t=Ee(e);!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&(t==="Esc"?(e.preventDefault(),e.stopPropagation(),Kr(),this.hasSlider()&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.model.id}})):(t==="Up"||t==="Down"||t==="Enter")&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"on-special-key-pressed",key:t})))}handlePressedKey(e,t){var n;var i=_e.getFocusedMathquill();if(i){if(t&&this.controller.isGraphPaperFocused()){let a=(n=this.controller.getGrapher2d())==null?void 0:n.poiController;if(!a)return;let s=a.keyboardAttentionManager;if(e==="Tab"||e==="Shift-Tab"){t.stopPropagation(),t.preventDefault(),s.focusNextObjFromKeyboard({direction:t.shiftKey?"prev":"next"});return}else if(e==="Left"||e==="Right"||e==="Up"||e==="Down"||e==="Shift-Left"||e==="Shift-Right"||e==="Shift-Up"||e==="Shift-Down"){t.stopPropagation(),t.preventDefault(),t&&a.moveGeoPointFromKeyboard(t);return}else if(e==="Enter"){t.stopPropagation(),t.preventDefault();let l=s.getKeyboardAttention();a.tapGeoPointFromKeyboard(t),this.controller.getEvaluator().notifyWhenSynced(()=>{let c=this.controller.getValidCursorContext(),p=this.model.formula.cursor_context;if(c&&c===p){let u=this.controller.getFocusLocation();if(u&&u.type==="expression"&&u.id===this.model.id&&!u.isFakeGraphFocus&&this.controller.dispatch({type:"set-focus-location",location:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},u),{isFakeGraphFocus:!0})}),l){let m=s.findTabbableObjectsForCurrentTool(l);m.currentIsTabbable&&s.updateKeyboardAttention(m.targets[m.currentTabIndex],{describe:!1})}}});return}else if(e==="Esc"){t.stopPropagation(),t.preventDefault(),this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.model.id}});return}}if(e==="Esc"){Kr(),this.hasSlider()&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.model.id}});return}else if(e==="Up"||e==="Down"){var o=_e.applyArrowKeyAndReturnIfWasAtBounds(i,e,t);return o?this.controller.dispatch({type:"on-special-key-pressed",key:e}):void 0}else if(e==="Delete"||e==="Backspace"){if(Us(this.model))return this.controller.dispatch({type:"on-special-key-pressed",key:e})}else if(e==="Enter")return t&&(t.preventDefault(),t.stopPropagation()),this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});i.keystroke(e,t),this.handleLatexChanged(i.latex())}}handleLatexChanged(e){e!==this.model.latex&&this.controller.dispatch({type:"set-item-latex",id:this.id,latex:e})}doesNodeBelongToSliderLimit(e){return!e||!this.rootNode.contains(e)?!1:!!e.closest("[data-dcg-label]")}handleMQFocusedChanged(e,t){e?this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}}):!this.doesNodeBelongToSliderLimit(t.relatedTarget)&&this.lastBrailleMode===this.controller.getBrailleMode()&&this.controller.dispatch({type:"blur-focus-location",location:{type:"expression",id:this.id}})}onMouseSelect(e){this.isReadonly()||e.device!=="keyboard"&&(e.type==="dcg-tap"&&e.device==="mouse"||e.type==="dcg-tapstart"&&e.device==="touch"||e.wasHandled()||(e.handle(),this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}})))}isReadonly(){return this.controller.isItemReadonly(this.id)}isFocused(){let e=this.controller.getFocusLocation();return!e||e.type!=="expression"?!1:e.id===this.id}isSliderThumbFocused(){let e=this.controller.getFocusLocation();return!e||e.type!=="slider-thumb"?!1:e.id===this.id}hasError(){return!!this.model.error&&!Us(this.model)}getMQConfig(){return this.controller.getMathquillConfig({})}};function rn(r){return{sixKeyInput:()=>r.getSixKeyInput(),mode:()=>r.getBrailleMode(),capExpressionSize:()=>r.getCapExpressionSize()?{exceedsLimit:e=>e.length>rb,onExpressionSizeExceeded:()=>r.dispatch({type:"expression-size-exceeded"})}:void 0}}var rd=__dcg_shared_module_exports__['h'](z());xt();var{Textarea:RZ}=rd.Components,iu=class extends rd.Class{template(){return rd.createElement("div",{class:rd.const("dcg-smart-textarea-container")},rd.createElement("div",{class:rd.const("dcg-displayTextarea dcg-fixed-width-element"),didMount:this.bindFn(this.didMountDisplay)}),rd.createElement(RZ,{class:()=>({"dcg-do-blur":!0,"dcg-fixed-width-element":!0,"dcg-smart-textarea":!0,"dcg-empty":!this.props.text()}),"aria-label":()=>{var e,t;return(t=(e=this.props).ariaLabel)==null?void 0:t.call(e)},placeholder:this.bindFn(this.getPlaceholder),readonly:()=>this.props.readonly()?!0:void 0,value:this.props.text,onInput:this.props.onInput,didMount:this.bindFn(this.didMountTextarea),onKeydown:this.bindFn(this.onKeydownEvent)}))}getDisplayTextHTML(){let e=this.props.text()||"",t=(n,a)=>e.slice(n,a).replace(/</g,"&lt;").replace(/>/g,"&gt;"),i=0,o="";if(this.props.showLinks()){let n=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,a=null;for(;(a=n.exec(e))!==null;){let[s]=a;o+=t(i,a.index),o+=`<a rel='nofollow ugc' href='${s}' target ='_blank'>${s}</a>`,i=n.lastIndex}}return o+=t(i),o}willUnmount(){this.textareaNode=void 0}didMountDisplay(e){this.displayNode=e,H(e).on("touchend",function(t){t.preventDefault()}),H(e).on("dcg-tap dcg-tapstart",function(t){t.target.closest("a")&&t.handle()}),this.renderDisplayText()}didMountTextarea(e){this.textareaNode=e,H(e).on("dcg-tapstart",t=>{t.handle()}),H(e).on("focusin focusout",()=>this.onFocusEvent()),this.updateFocused()}didUpdate(){this.updateFocused(),this.renderDisplayText()}onFocusEvent(){if(this.textareaNode){var e=document.activeElement===this.textareaNode;this.shouldBeFocused()!==e&&this.props.onFocusChange(e)}}renderDisplayText(){if(!this.displayNode)return;let e=this.getDisplayTextHTML();this.lastDisplayTextHTML!==e&&(this.lastDisplayTextHTML=e,this.displayNode.innerHTML=e)}isFocused(){return document.activeElement===this.textareaNode}shouldBeFocused(){return this.props.shouldFocus()}updateFocused(){if(!this.textareaNode)return;let e=this.isFocused(),t=this.shouldBeFocused();if(e!==t)if(!t)this.textareaNode.blur();else{if(pl&&Ip)return;this.textareaNode.focus(),this.textareaNode.selectionStart=this.textareaNode.selectionEnd=this.textareaNode.value.length}}onKeydownEvent(e){var t=this.textareaNode;if(!t)return;var i=Ee(e);let o=this.props.readonly(),n=this.props.readonlyAction&&this.props.readonlyAction();if(o&&n!==void 0&&n.predicate()){!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&(i===fs||i===Mu)&&(e.preventDefault(),n.action());return}i===fs&&!e.metaKey?(e.preventDefault(),this.props.onSpecialKey("Enter")):i===hn?Kr():i===gn?(o||t.selectionStart===0&&t.selectionEnd===0)&&!(e.altKey||e.metaKey)&&(e.preventDefault(),this.props.onSpecialKey("Up")):i===mn?(o||t.selectionStart===t.value.length&&t.selectionEnd===t.value.length)&&!(e.altKey||e.metaKey)&&(e.preventDefault(),this.props.onSpecialKey("Down")):i===Hl&&!(o&&n!==void 0&&n.predicate())?t.value.length===0&&(e.preventDefault(),this.props.onSpecialKey("Backspace")):i===Bm&&!(o&&n!==void 0&&n.predicate())&&t.value.length===0&&(e.preventDefault(),this.props.onSpecialKey("Delete")),this.props.onKeydown&&this.props.onKeydown(e)}getPlaceholder(){var e,t;if(!this.props.text())return(t=(e=this.props).placeholder)==null?void 0:t.call(e)}};var wn=__dcg_shared_module_exports__['h'](z());var gv=class extends Ts{didMount(){this.onItemViewMounted()}willUnmount(){this.onItemViewUnmounted()}template(){return wn.createElement("div",{class:()=>({"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-expressiontext":!0,"dcg-inFolder":!!this.model.folderId,"dcg-selected":!!this.controller.isItemSelected(this.id),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id)}),"expr-id":()=>this.model.id,onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect)},wn.createElement("div",{class:wn.const("dcg-fade-container")},wn.createElement("div",{class:wn.const("dcg-main")},wn.createElement(iu,{shouldFocus:this.bindFn(this.isFocused),text:()=>this.model.text,showLinks:()=>this.controller.areLinksEnabled(),onInput:this.bindFn(this.onInput),onFocusChange:this.bindFn(this.onFocusChange),onSpecialKey:this.bindFn(this.onSpecialKey),readonly:()=>this.controller.isInEditListMode()||this.controller.isItemReadonly(this.id),readonlyAction:this.const({predicate:()=>this.controller.isInEditListMode(),action:()=>this.exitEditListMode()}),ariaLabel:()=>_i(this.model,"edit_title"),placeholder:()=>this.controller.s("graphing-calculator-text-note-placeholder")})),wn.createElement(ic,{controller:this.props.controller,model:this.props.model})),wn.createElement("span",{class:wn.const("dcg-tab dcg-action-drag"),handleevent:wn.const("true"),tapboundary:wn.const("true"),disablescroll:wn.const("true"),onTapStart:this.bindFn(this.onDragPending)},wn.createElement("span",{class:wn.const("dcg-num")},()=>this.model.displayIndex),wn.createElement("div",{class:wn.const("dcg-tab-interior")}),wn.createElement("i",{class:wn.const("dcg-icon-text"),"aria-hidden":wn.const("true")})),wn.createElement(rc,{controller:this.props.controller,id:()=>this.model.id}))}onInput(e){this.controller.dispatch({type:"set-note-text",id:this.id,text:e})}onFocusChange(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"text",id:this.id}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"text",id:this.id}})}onSpecialKey(e){return this.controller.dispatch({type:"on-special-key-pressed",key:e})}isFocused(){let e=this.controller.getFocusLocation();return!(!e||e.type!=="text"||e.id!==this.id)}};var Ft=__dcg_shared_module_exports__['h'](z());xt();var ai=__dcg_shared_module_exports__['h'](z());var ls=__dcg_shared_module_exports__['h'](z());var{SwitchUnion:NZ}=ls.Components,mv=class extends ls.Class{init(){this.model=this.props.model(),this.controller=this.props.controller()}template(){return ls.createElement("div",{class:ls.const("dcg-table-icon-container")},NZ(this.bindFn(this.typeOfIcon),{error:()=>ls.createElement(pa,{error:()=>this.controller.unpack(this.model.error),gravity:this.const("s")}),none:()=>ls.createElement("span",null),icon:()=>ls.createElement("div",{class:ls.const("dcg-circular-icon-container"),role:ls.const("button"),tabindex:ls.const("0"),"aria-label":this.bindFn(this.getIconAriaLabel),handleevent:ls.const("true"),"dcg-open-menu-guid":()=>this.getMenuGUID(),onTap:e=>{if(!e.wasHandled("dragdrop")&&!e.wasLongheld()){if(this.myOptionsOpen())return this.toggleOptions();if(this.controller.isInEditListMode()||e.shiftKey)return this.toggleOptions();this.toggleGraphShown()}},onLongHold:e=>{e.handle("dcg-longhold"),e.handle("dcg-tap"),this.toggleOptions()},manageFocus:this.const(Qe({controller:this.controller,location:{type:"table-icon",id:this.model.table.id,columnId:this.model.id}}))},ls.createElement(xn,{iconType:this.bindFn(this.getIcon),backgroundColor:this.bindFn(this.getModelColor)}))}))}getModelColor(){return Hx(this.model)}getMenuGUID(){return this.model.guid}myOptionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getMenuGUID())}toggleOptions(){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"table-column",model:this.model,guid:this.getMenuGUID(),focusFirstOption:!1}})}toggleGraphShown(){this.controller.dispatch({type:"toggle-tablecolumn-hidden",tableId:this.model.table.id,columnId:this.model.id})}hasError(){return!!this.model.error}getIcon(){return this.model.shouldGraph?this.controller.isInEditListMode()?"none":this.model.points&&this.model.lines?"table-points-and-lines":this.model.points&&!this.model.lines?"table-points":!this.model.points&&this.model.lines?"table-lines":"none":"hidden"}typeOfIcon(){return this.model.latex===""||!this.controller.getGraphSettings().config.graphpaper?"none":this.model.error?"error":this.model.index===0?"none":"icon"}getIconAriaLabel(){return this.myOptionsOpen()?this.controller.s("graphing-calculator-narration-hide-options"):this.controller.isInEditListMode()?this.controller.s("graphing-calculator-narration-show-options"):this.model.shouldGraph?this.controller.s("graphing-calculator-narration-hide-table-column"):this.controller.s("graphing-calculator-narration-show-table-column")}};var{If:fv}=ai.Components,bv=class extends ai.Class{init(){this.model=this.props.model(),this.controller=this.props.controller(),this.table=this.model.table}isRightSide(){return this.lookupCellPosition().column>=this.table.columnModels.length-1}template(){return ai.createElement("div",{class:()=>({"dcg-cell":!0,"dcg-table-header":!0,"dcg-do-not-blur":!0,"dcg-left":this.model.index===0,"dcg-right":this.isRightSide(),"dcg-selected":this.shouldFocus()&&!this.table.readonly,"dcg-error":!!this.model.error,"dcg-leave-space-for-icon":this.leaveSpaceForIcon()}),index:()=>this.model.index,onTapStart:this.bindFn(this.focusThisCell)},ai.createElement("div",{class:ai.const("dcg-inner-border")}),ai.createElement(fv,{predicate:()=>!this.isRightSide()&&(!this.controller.is3dProduct()||!!this.model.error)},()=>ai.createElement(mv,{model:this.props.model,controller:this.props.controller})),ai.createElement("div",{role:ai.const("columnheader")},ai.createElement(fv,{predicate:()=>!this.controller.isInEditListMode()&&!this.table.readonly},()=>ai.createElement(co,__dcg_shared_module_exports__['a']({latex:()=>this.model.latex||"",operatorNames:()=>this.getMQConfig().autoOperatorNames,brailleShouldFocus:this.bindFn(this.shouldFocus),ariaLabel:()=>this.getAriaLabel("braille"),onBrailleInput:e=>this.handleLatexChanged(e),onBrailleFocusedChanged:this.bindFn(this.handleMQFocusedChanged),selectOnFocus:this.const(!0),onBrailleKeydown:this.bindFn(this.handleKeydownOnBrailleInput)},rn(this.props.controller())),ai.createElement(_e,{latex:()=>this.model.latex||"",isFocused:this.bindFn(this.shouldFocus),capExpressionSize:()=>this.controller.getCapExpressionSize(),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel("speech"),getAriaPostLabel:this.bindFn(this.getAriaPostLabel),hasError:this.const(!1),onUserPressedKey:(e,t)=>this.handlePressedKey(e,t),onUserChangedLatex:e=>this.handleLatexChanged(e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:this.bindFn(this.handleMQFocusedChanged),selectOnFocus:this.const(!0),needsSystemKeypad:()=>!this.controller.isKeypadEnabled()}))),ai.createElement(fv,{predicate:()=>this.controller.isInEditListMode()||this.controller.isItemReadonly(this.table.id)},()=>ai.createElement(co,__dcg_shared_module_exports__['a']({latex:()=>this.model.latex||"",operatorNames:()=>this.getMQConfig().autoOperatorNames,ariaLabel:()=>this.getAriaLabel("braille"),onBrailleInput:e=>this.handleLatexChanged(e),tabindex:this.const(-1),isStatic:this.const(!0),brailleShouldFocus:this.bindFn(this.shouldFocusReadonlyCell),onBrailleFocusedChanged:this.bindFn(this.handleMQFocusedChanged)},rn(this.props.controller())),ai.createElement(ze,{latex:()=>this.model.latex||"",config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel("speech")},ai.createElement("span",{class:ai.const("dcg-math-field dcg-cell-math-content"),role:ai.const("textbox"),"aria-readonly":ai.const("true"),tabindex:()=>this.controller.isInEditListMode()?-1:0,onKeyDown:this.bindFn(this.handleKeydownOnReadonlyCell),manageFocus:this.const({shouldBeFocused:this.bindFn(this.shouldFocusReadonlyCell),onFocusedChanged:this.bindFn(this.handleFocusedChanged)})})))),ai.createElement(fv,{predicate:()=>this.model.dragMode!=="NONE"&&!this.model.error},()=>ai.createElement("span",{class:ai.const("dcg-drag-icon"),"dcg-drag-mode":()=>this.model.dragMode,style:()=>({color:this.model.color})},ai.createElement("i",{class:()=>({"dcg-icon-move":this.model.dragMode==="XY","dcg-icon-move-horizontal":this.model.dragMode==="X","dcg-icon-move-vertical":this.model.dragMode==="Y"}),"aria-hidden":ai.const("true")})))),ai.createElement("div",{class:ai.const("dcg-empty-line")}),ai.createElement(fv,{predicate:()=>this.isRightSide()},()=>ai.createElement("span",{class:ai.const("dcg-fade-right")})))}leaveSpaceForIcon(){if(this.model.error||this.controller.is3dProduct())return!1;let{column:e}=this.lookupCellPosition(),t=Uf(this.table);return e>0&&e<t-1}focusThisCell(e){e.wasHandled()||(e.handle(),!this.controller.isItemReadonly(this.table.id)&&(this.shouldFocus()||this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})))}handleFocusedChanged(e,t){e?this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}):this.isNodeWithinTableCell(t.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})}lookupCellPosition(){return{row:0,column:this.model.index}}getAriaLabel(e){var t=this.lookupCellPosition();return e==="speech"?this.controller.s("graphing-calculator-narration-table-column-header",{column:t.column+1}):this.controller.raw("h__column__",{column:t.column+1})}getAriaPostLabel(){let e="",t=this.model;return t.shouldGraph&&(t.points||t.lines)&&!W5(t)&&(e=this.controller.s("graphing-calculator-narration-expression-evaluation-has-graph"),oi?e+=" "+this.controller.s("graphing-calculator-narration-expression-audio-trace-mac"):e+=" "+this.controller.s("graphing-calculator-narration-expression-audio-trace-windows")),e}handlePressedKey(e,t){var i=_e.getFocusedMathquill();i&&(_e.handleKeystrokeAndDecideIfSpecialEvent(i,e,t)?this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:e}):this.handleLatexChanged(i.latex()))}handleKeydownOnBrailleInput(e){let t=Ee(e);if(!t)return;let i=t==="Enter"||t==="Up"||t==="Down",o=Gs(),n=o&&t==="Left"&&o.selectionStart===0||t==="Right"&&o.selectionStart===o.value.length,a=this.model.latex.length===0&&Db(o);(i||n||(t==="Del"||t==="Backspace")&&a)&&(this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:t==="Del"?"Delete":t}),e.preventDefault())}handleKeydownOnReadonlyCell(e){let t=Ee(e);t!=="Tab"&&(e.preventDefault(),t==="Esc"&&Kr(),t&&this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:t}))}handleLatexChanged(e){var t=this.model.latex;t!==e&&this.controller.dispatch({type:"set-tablecell-latex",tableId:this.table.id,cell:this.lookupCellPosition(),latex:e})}shouldFocus(){return!this.controller.isInEditListMode()&&__dcg_shared_module_exports__['P'](this.lookupCellPosition(),Sa(this.table))}shouldFocusReadonlyCell(){return __dcg_shared_module_exports__['P'](this.lookupCellPosition(),Sa(this.table))}isNodeWithinTableCell(e){if(!e||!e.closest(".dcg-cell"))return!1;var t=this.controller.getItemRootNodeById(this.table.id);return t?H.contains(t,e):!1}handleMQFocusedChanged(e,t){e?this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}):this.isNodeWithinTableCell(t.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})}getMQConfig(){return this.controller.getMathquillConfig({})}};var uo=__dcg_shared_module_exports__['h'](z());xt();var{If:fL}=uo.Components,yv=class extends uo.Class{init(){this.column=this.props.column(),this.controller=this.props.controller(),this.table=this.column.table}template(){return uo.createElement("div",{class:()=>({"dcg-cell":!0,"dcg-do-not-blur":!0,"dcg-empty":this.isEmpty(),"dcg-non-editable":!!this.column.disabled,"dcg-error":!!this.hasError(),"dcg-selected":this.shouldFocus()&&!this.controller.isItemReadonly(this.table.id)}),onTapStart:this.bindFn(this.focusThisCell)},uo.createElement("div",{class:uo.const("dcg-inner-border")}),uo.createElement("div",{role:uo.const("gridcell")},uo.createElement(fL,{predicate:this.bindFn(this.hasError)},()=>uo.createElement("span",{class:uo.const("dcg-table-icon-error-container")},uo.createElement(pa,{error:this.bindFn(this.getErrorMessage),gravity:this.const("s"),size:this.const("small")}))),uo.createElement(fL,{predicate:()=>!this.isColumnEditable()},()=>uo.createElement(co,__dcg_shared_module_exports__['a']({latex:()=>this.getValue(),operatorNames:()=>this.getMQConfig().autoOperatorNames,brailleShouldFocus:this.bindFn(this.shouldFocusReadonlyCell),ariaLabel:()=>this.getAriaLabel("braille"),tabindex:()=>this.controller.isInEditListMode()?-1:0,isStatic:this.const(!0),onBrailleFocusedChanged:this.bindFn(this.handleFocusedChanged),onBrailleKeydown:e=>(this.handleKeydownOnReadonlyCell(e),!0)},rn(this.props.controller())),uo.createElement(ze,{getAriaLabel:()=>this.getAriaLabel("speech"),latex:()=>this.getValue(),config:this.bindFn(this.getMQConfig)},uo.createElement("span",{class:uo.const("dcg-math-field dcg-cell-math-content dcg-mathquill-input-span"),role:uo.const("textbox"),"aria-roledescription":()=>this.column.disabled?this.controller.s("graphing-calculator-narration-computed-cell-role-description"):void 0,"aria-readonly":uo.const("true"),tabindex:()=>!this.controller.isInEditListMode()&&(!this.isEmpty()||!this.column.disabled)?0:-1,onKeyDown:this.bindFn(this.handleKeydownOnReadonlyCell),manageFocus:this.const({shouldBeFocused:this.bindFn(this.shouldFocusReadonlyCell),onFocusedChanged:this.bindFn(this.handleFocusedChanged)})})))),uo.createElement(fL,{predicate:this.bindFn(this.isColumnEditable)},()=>uo.createElement(co,__dcg_shared_module_exports__['a']({latex:()=>this.getValue(),operatorNames:()=>this.getMQConfig().autoOperatorNames,brailleShouldFocus:this.bindFn(this.shouldFocusEditableCell),ariaLabel:()=>this.getAriaLabel("braille"),onBrailleInput:e=>this.handleLatexChanged(e),onBrailleFocusedChanged:this.bindFn(this.handleFocusedChanged),onBrailleKeydown:this.bindFn(this.handleKeydownOnBrailleInput),selectOnFocus:this.const(!0)},rn(this.props.controller())),uo.createElement(_e,{latex:()=>this.getValue(),isFocused:this.bindFn(this.shouldFocusEditableCell),capExpressionSize:()=>this.controller.getCapExpressionSize(),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel("speech"),getAriaPostLabel:this.bindFn(this.getErrorMessage),hasError:this.const(!1),onUserPressedKey:(e,t)=>this.handlePressedKey(e,t),onUserChangedLatex:e=>this.handleLatexChanged(e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:this.bindFn(this.handleFocusedChanged),selectOnFocus:this.const(!0),needsSystemKeypad:()=>!this.controller.isKeypadEnabled()})))),uo.createElement("div",{class:uo.const("dcg-empty-line")}))}focusThisCell(e){e.wasHandled()||this.controller.isItemReadonly(this.table.id)||(e.handle(),!this.shouldFocus()&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}))}handlePressedKey(e,t){var i=_e.getFocusedMathquill();if(i){let o=_e.handleKeystrokeAndDecideIfSpecialEvent(i,e,t);e===hn&&Kr(),o?this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:e}):this.handleLatexChanged(i.latex())}}handleKeydownOnBrailleInput(e){let t=Ee(e);if(!t)return;t===hn&&Kr();let i=t==="Enter"||t==="Up"||t==="Down",o=Gs(),n=o&&t==="Left"&&o.selectionStart===0||t==="Right"&&o.selectionStart===o.value.length;(i||n||(t==="Del"||t==="Backspace")&&this.getValue().length===0)&&(this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:t==="Del"?"Delete":t}),e.preventDefault())}handleKeydownOnReadonlyCell(e){let t=Ee(e);t!=="Tab"&&(e.preventDefault(),t==="Esc"&&Kr(),t&&this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:t}))}handleLatexChanged(e){var t=this.getValue();t!==e&&this.controller.dispatch({type:"set-tablecell-latex",tableId:this.table.id,cell:this.lookupCellPosition(),latex:e})}shouldFocus(){return __dcg_shared_module_exports__['P'](this.lookupCellPosition(),Sa(this.table))}shouldFocusReadonlyCell(){return!this.controller.isInEditListMode()&&(this.controller.isItemReadonly(this.table.id)||!!this.column.disabled)&&this.shouldFocus()}shouldFocusEditableCell(){return!this.column.disabled&&this.shouldFocus()}isNodeWithinTableCell(e){if(!e||!e.closest(".dcg-cell"))return!1;var t=this.controller.getItemRootNodeById(this.table.id);return t?H.contains(t,e):!1}handleFocusedChanged(e,t){e?this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}):this.isNodeWithinTableCell(t.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})}lookupCellPosition(){return{row:this.props.rowIdx(),column:this.column.index}}getPackedError(){return this.column.packedErrors[this.props.rowIdx()-1]}hasError(){return!!this.getPackedError()}getErrorMessage(){let e=this.getPackedError();return e?this.controller.unpack(e):""}getValue(){let e=this.props.rowIdx()-1,t=this.column.index;return $x(this.table,e,t)}isEmpty(){let e=Gs();return this.getValue()===""&&Db(e)}getAriaLabel(e){var t=this.lookupCellPosition(),i=t.row,o=t.column+1;return e==="speech"?this.controller.s("graphing-calculator-narration-table-row-column",{row:i.toString(),column:o.toString()}):this.controller.raw("r__row__c__column__",{row:i.toString(),column:o.toString()})}isColumnEditable(){return!this.column.disabled&&!this.controller.isItemReadonly(this.table.id)&&!this.controller.isInEditListMode()}getMQConfig(){return this.controller.getMathquillConfig({})}};xt();var{For:bL}=Ft.Components,xv=class extends Ts{didMount(){this.onItemViewMounted()}willUnmount(){this.onItemViewUnmounted()}template(){return Ft.createElement("div",{class:()=>({"dcg-expressionitem":!0,"dcg-expressiontable":!0,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-inFolder":!!this.model.folderId,"dcg-selected":!!this.controller.isItemSelected(this.id),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id),"dcg-faded-h":this.shouldFadeLastColumn(),"dcg-faded-v":this.shouldFadeLastRow()}),"expr-id":()=>this.model.id,didMount:this.bindFn(this.didMountContainer),onKeydown:this.bindFn(this.onKeydown)},Ft.createElement("div",{class:Ft.const("dcg-fade-container dcg-disable-horizontal-scroll-to-cursor")},Ft.createElement("div",{class:Ft.const("dcg-main")},Ft.createElement("div",{class:Ft.const("dcg-table-container"),tabindex:()=>this.controller.isInEditListMode()?0:-1,"aria-label":()=>this.controller.getBrailleMode()==="none"?this.controller.s("graphing-calculator-narration-expression-index-table",{index:this.model.displayIndex}):this.controller.s("graphing-calculator-narration-expression-index-table",{index:this.model.displayIndex}),didMount:this.bindFn(this.didMountContainer),manageFocus:this.const({shouldBeFocused:this.shouldBeFocused.bind(this),onFocusedChanged:this.onFocusedChanged.bind(this)})},Ft.createElement("div",{class:Ft.const("dcg-table-sliding-container"),style:()=>({transform:`translateX(${this.computeScrolledX()}px)`})},Ft.createElement(bL,{each:()=>this.getVisibleRows(),key:e=>this.getRowGUID(e)},Ft.createElement("div",{role:Ft.const("grid"),class:Ft.const("dcg-tabledata")},e=>e.type==="show-more"?Ft.createElement("tr",{role:Ft.const("row"),class:Ft.const("dcg-show-more-row")},Ft.createElement("td",{colspan:this.bindFn(this.getColSpan)},this.bindFn(this.missingRowMessage),Ft.createElement("div",{tabindex:Ft.const(0),role:Ft.const("button"),class:Ft.const("dcg-show-more"),onTap:()=>this.controller.dispatch({type:"table-show-more-rows",id:this.id})},()=>this.controller.s("graphing-calculator-button-show-all-table-rows")))):e.type==="spacer-row"?Ft.createElement("tr",{role:Ft.const("row"),class:Ft.const("dcg-blank-row")},Ft.createElement("td",{colspan:this.bindFn(this.getColSpan),style:()=>({height:(e.endIdx-e.startIdx+1)*this.getRowHeight()+"px"})})):e.type==="header"?Ft.createElement(bL,{each:()=>this.model.columnModels,key:t=>t.guid},Ft.createElement("tr",{role:Ft.const("row"),"aria-rowindex":Ft.const(0),class:()=>({"dcg-row":e,"dcg-braille-row":this.controller.getBrailleMode()!=="none"})},t=>Ft.createElement(bv,{controller:this.props.controller,model:this.const(t)}))):Ft.createElement(bL,{each:()=>this.model.columnModels,key:t=>t.guid},Ft.createElement("tr",{role:Ft.const("row"),"aria-rowindex":()=>e.index,class:()=>({"dcg-row":e,"dcg-braille-row":this.controller.getBrailleMode()!=="none"})},t=>Ft.createElement(yv,{controller:this.props.controller,column:this.const(t),rowIdx:()=>e.index})))))))),Ft.createElement(ic,{controller:this.props.controller,model:this.props.model})),Ft.createElement("span",{class:Ft.const("dcg-tab dcg-action-drag"),handleevent:Ft.const("true"),tapboundary:Ft.const("true"),disablescroll:Ft.const("true"),onTapStart:this.bindFn(this.onDragPending)},Ft.createElement("span",{class:Ft.const("dcg-num")},()=>this.model.displayIndex),Ft.createElement("div",{class:Ft.const("dcg-tab-interior")}),Ft.createElement(Gb,{model:this.props.model,controller:this.props.controller})),Ft.createElement(rc,{controller:this.props.controller,id:()=>this.model.id}))}getRowGUID(e){switch(e.type){case"header":return"header";case"show-more":return"show-more";case"spacer-row":return`spacer-${e.startIdx}-${e.endIdx}`;case"standard-row":return`row-${e.index}`}}getColSpan(){return this.model.columnModels.length-1}getRowHeight(){return this.controller.getGraphSettings().config.projectorMode?38:33}getVisibleRows(){var h,x,C;let e=[{type:"header"}],t=Sl(this.model)+1;if(t<=25){for(let D=1;D<t;D++)e.push({type:"standard-row",index:D});return e}let i=fg(this.model);if(i!==void 0){for(let D=1;D<i.min;D++)e.push({type:"standard-row",index:D});e.push({type:"show-more"});for(let D=i.max;D<t;D++)e.push({type:"standard-row",index:D});return e}let o=Zw(this.controller),n=o?o.height:0,a=H(this.node).offset(),s=(a?a.top:0)-(o?o.top:0),l=(C=(x=(h=this.node)==null?void 0:h.querySelector(".dcg-row"))==null?void 0:x.getBoundingClientRect().height)!=null?C:0,c=this.getRowHeight();if(n/c>t){for(let D=1;D<t;D++)e.push({type:"standard-row",index:D});return e}let p=(-s-l)/c,u=(n-s)/c;for(var m=1;m<t;m++){let D=Sa(this.model);if(m===t-2||D&&D.row===m)e.push({type:"standard-row",index:m});else if(m>u||m<p){let k=e[e.length-1];k&&k.type==="spacer-row"?k.endIdx=m:e.push({type:"spacer-row",startIdx:m,endIdx:m})}else e.push({type:"standard-row",index:m})}return e}missingRowMessage(){let e=fg(this.model);return e===void 0?"":this.controller.s("graphing-calculator-text-table-more-rows",{rowCount:e.max-e.min})}didMountContainer(e){this.node=e,H(e).on("scroll",()=>e.scrollLeft=0)}getSelectedCell(){return Sa(this.model)}computeScrolledX(){if(!this.getSelectedCell()||!this.node)return 0;let e=this.node.children[0],t=this.node.querySelector(".dcg-selected");if(e===null||t===null)return 0;let i=this.node.getBoundingClientRect(),o=t.getBoundingClientRect(),n=o.left-e.getBoundingClientRect().left,a=i.width-n-o.width-80,s=Math.min(0,i.width-e.scrollWidth-30);return a=Math.max(a,s),Math.min(0,a)}shouldFadeLastRow(){return $5(this.model)&&!this.isBottomFocused()}shouldFadeLastColumn(){return!this.isRightFocused()}isBottomFocused(){let e=this.getSelectedCell();return!!e&&e.row===Sl(this.model)}isRightFocused(){let e=this.getSelectedCell();return!!e&&e.column===this.model.columnModels.length-1}isReadonly(){return this.controller.isItemReadonly(this.id)}isFocused(){return!!this.getSelectedCell()}onKeydown(e){this.controller.isInEditListMode()||e.ctrlKey&&!e.shiftKey&&!e.altKey&&!e.metaKey&&(Ee(e)==="Up"?(e.preventDefault(),e.stopPropagation(),this.moveToFirstCellInColumn()):Ee(e)==="Down"?(e.preventDefault(),e.stopPropagation(),this.moveToLastCellInColumn()):Ee(e)==="Left"?(e.preventDefault(),e.stopPropagation(),this.moveToFirstCellInRow()):Ee(e)==="Right"?(e.preventDefault(),e.stopPropagation(),this.moveToLastCellInRow()):ki(e)==="H"&&(e.preventDefault(),e.stopPropagation(),this.speakColumnHeader()))}moveToFirstCellInColumn(){let e=this.getSelectedCell();e&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.id,location:{row:0,column:e.column}}})}moveToLastCellInColumn(){let e=this.getSelectedCell();e&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.id,location:{row:Sl(this.model),column:e.column}}})}moveToFirstCellInRow(){let e=this.getSelectedCell();e&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.id,location:{row:e.row,column:0}}})}moveToLastCellInRow(){let e=this.getSelectedCell();e&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.id,location:{row:e.row,column:Sl(this.model)-1}}})}speakColumnHeader(){let e=this.controller.s("graphing-calculator-narration-table-no-column-header"),t=this.getSelectedCell();if(t){let i=this.model.columnModels[t.column].latex;i&&(e=Zl.StaticMath(document.createElement("span")).latex(i).mathspeak())}be(e)}focusHelperOptions(){return{controller:this.controller,location:{type:"table-container",id:this.model.id}}}shouldBeFocused(){return vg(this.focusHelperOptions())}onFocusedChanged(e){if(this.controller.isInEditListMode())return LM(this.focusHelperOptions(),e)}};var Jr=__dcg_shared_module_exports__['h'](z());var wv=class extends Ts{didMount(){this.onItemViewMounted()}willUnmount(){this.onItemViewUnmounted()}template(){return Jr.createElement("div",{class:()=>({"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-expressionfolder":!0,"dcg-inFolder":!1,"dcg-selected":this.renderAsSelected(),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id),"dcg-collapsed":!!this.model.collapsed,"dcg-hidden":!!this.model.hidden,"dcg-has-items":this.controller.getNumberOfItemsInFolder(this.id)>0,"dcg-secretFolder":this.model.secret&&!this.controller.shouldShowAuthorFeatures()}),"expr-id":()=>this.model.id,onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect)},Jr.createElement("div",{class:Jr.const("dcg-fade-container")},Jr.createElement("div",{class:Jr.const("dcg-main")},Jr.createElement("div",{role:Jr.const("button"),tabindex:Jr.const("0"),"aria-pressed":()=>this.model.collapsed,"aria-label":()=>this.model.collapsed?_i(this.model,"expand"):_i(this.model,"collapse"),class:Jr.const("dcg-caret-container dcg-action-toggle-folder-collapsed dcg-do-not-blur"),handleEvent:Jr.const("true"),onTap:this.bindFn(this.toggleCollapsed)},Jr.createElement("i",{class:Jr.const("dcg-icon-caret-down"),"aria-hidden":Jr.const("true")})),Jr.createElement(iu,{shouldFocus:this.bindFn(this.isFocused),text:()=>this.model.title,showLinks:()=>this.controller.areLinksEnabled(),onInput:this.bindFn(this.onInput),onFocusChange:this.bindFn(this.onFocusChange),onSpecialKey:this.bindFn(this.onSpecialKey),ariaLabel:this.bindFn(this.getAriaLabel),readonly:()=>this.controller.isInEditListMode()||this.controller.isItemReadonly(this.id),readonlyAction:this.const({predicate:()=>this.controller.isInEditListMode(),action:()=>this.exitEditListMode()}),placeholder:()=>this.controller.s("graphing-calculator-text-folder-placeholder")}),Jr.createElement(st,{checked:()=>this.model.secret,class:this.const("dcg-action-toggle-secret-folder dcg-do-not-blur"),style:()=>({display:this.controller.shouldShowAuthorFeatures()?void 0:"none"}),onChange:this.bindFn(this.toggleSecret)},Jr.createElement("span",{class:Jr.const("dcg-checkbox-label")},()=>this.controller.s("graphing-calculator-button-hide-folder-from-students-2")))),Jr.createElement(ic,{controller:this.props.controller,model:this.props.model})),Jr.createElement("span",{class:Jr.const("dcg-tab dcg-action-drag"),handleevent:Jr.const("true"),tapboundary:Jr.const("true"),disablescroll:Jr.const("true"),onTapStart:this.bindFn(this.onDragPending)},Jr.createElement("span",{class:Jr.const("dcg-num")},()=>this.model.displayIndex),Jr.createElement("div",{class:Jr.const("dcg-tab-interior")},Jr.createElement("span",{role:Jr.const("button"),tabindex:Jr.const("0"),"aria-pressed":()=>!!this.model.hidden,"aria-label":()=>this.model.hidden?_i(this.model,"show"):_i(this.model,"hide"),class:Jr.const("dcg-circular-icon-container dcg-expression-icon-container"),onTap:this.bindFn(this.toggleHidden)},Jr.createElement(xn,{iconType:()=>this.model.hidden?"hidden":"folder",whiteIcon:()=>this.renderAsSelected()||this.controller.isItemBeingDragged(this.model.id)})))),Jr.createElement(rc,{controller:this.props.controller,id:()=>this.model.id}))}renderAsSelected(){return this.controller.isItemSelected(this.model.id)||this.model.collapsedChildIsSelected}toggleHidden(){this.controller.dispatch({type:"toggle-item-hidden",id:this.id})}toggleSecret(){this.controller.dispatch({type:"set-item-secret",id:this.id,isSecret:!this.model.secret})}toggleCollapsed(){this.controller.dispatch({type:"set-folder-collapsed",id:this.id,isCollapsed:!this.model.collapsed})}onInput(e){this.controller.dispatch({type:"set-folder-title",id:this.id,title:e})}onFocusChange(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"folder",id:this.id}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"folder",id:this.id}})}onSpecialKey(e){return this.controller.dispatch({type:"on-special-key-pressed",key:e})}isFocused(){let e=this.controller.getFocusLocation();return!(!e||e.type!=="folder"||e.id!==this.id)}getAriaLabel(){let e="",t="";switch((this.model.hidden?1:0)+(this.model.collapsed?16:0)+(this.model.secret?256:0)+(this.model.readonly?4096:0)){case 0:t=this.controller.s("graphing-calculator-narration-description-folder");break;case 1:t=this.controller.s("graphing-calculator-narration-description-hidden-folder");break;case 16:t=this.controller.s("graphing-calculator-narration-description-collapsed-folder");break;case 256:t=this.controller.s("graphing-calculator-narration-description-secret-folder");break;case 4096:t=this.controller.s("graphing-calculator-narration-description-readonly-folder");break;case 1+16:t=this.controller.s("graphing-calculator-narration-description-hidden-collapsed-folder");break;case 1+256:t=this.controller.s("graphing-calculator-narration-description-hidden-secret-folder");break;case 1+4096:t=this.controller.s("graphing-calculator-narration-description-hidden-readonly-folder");break;case 256+16:t=this.controller.s("graphing-calculator-narration-description-collapsed-secret-folder");break;case 256+4096:t=this.controller.s("graphing-calculator-narration-description-secret-readonly-folder");break;case 16+4096:t=this.controller.s("graphing-calculator-narration-description-collapsed-readonly-folder");break;case 1+256+16:t=this.controller.s("graphing-calculator-narration-description-hidden-collapsed-secret-folder");break;case 1+16+4096:t=this.controller.s("graphing-calculator-narration-description-hidden-collapsed-readonly-folder");break;case 1+256+4096:t=this.controller.s("graphing-calculator-narration-description-hidden-secret-readonly-folder");break;case 16+256+4096:t=this.controller.s("graphing-calculator-narration-description-collapsed-secret-readonly-folder");break;case 1+16+256+4096:t=this.controller.s("graphing-calculator-narration-description-hidden-collapsed-secret-readonly-folder");break}let c=this.controller.getNumberOfItemsInFolder(this.id);return c>0?e=this.controller.s("graphing-calculator-narration-folder-has-items",{folder:t,count:c}):e=t,e}};var je=__dcg_shared_module_exports__['h'](z());function D0(r){let e=document.createElement("a");return e.href=r,e.href}var cs=__dcg_shared_module_exports__['h'](z());var{SwitchUnion:BZ}=cs.Components,Hg=class extends cs.Class{init(){this.model=this.props.model(),this.controller=this.props.controller()}template(){return cs.createElement("div",{class:cs.const("dcg-expression-icon-container dcg-image-icon-container")},BZ(this.bindFn(this.typeOfIcon),{error:()=>cs.createElement(pa,{error:()=>this.controller.unpack(this.model.error),isWhite:this.bindFn(this.isSelected),gravity:this.const("s")}),failed:()=>cs.createElement("span",null),loading:()=>cs.createElement(xn,{iconType:this.const("loading")}),hidden:()=>this.buildIconView(),image:()=>this.buildIconView()}))}buildIconView(){return cs.createElement("div",{class:cs.const("dcg-circular-icon-container"),role:cs.const("button"),tabindex:cs.const("0"),"dcg-open-menu-guid":()=>this.getMenuGUID(),"aria-label":this.bindFn(this.getIconAriaLabel),onTap:e=>{if(!e.wasHandled("dragdrop")&&!e.wasLongheld()){if(this.myOptionsOpen())return this.toggleOptions(e);if(this.controller.isInEditListMode()||e.shiftKey)return this.toggleOptions(e);this.toggleImageShown()}},onLongHold:e=>{e.handle("dcg-longhold"),e.handle("dcg-tap"),this.toggleOptions(e)},manageFocus:this.const(Qe({controller:this.controller,location:{type:"image-icon",id:this.model.id}}))},cs.createElement(xn,{iconType:()=>this.typeOfIcon()==="hidden"?"hidden":"background",backgroundImage:this.bindFn(this.getBackgroundImage),backgroundOpacity:this.const(1),whiteIcon:this.bindFn(this.isSelected)}))}isSelected(){return this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)}typeOfIcon(){return this.model.loadStatus==="loading"?"loading":this.model.loadStatus==="failed"?"failed":this.hasError()?"error":this.model.shouldGraph?"image":"hidden"}getMenuGUID(){return this.model.guid}myOptionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getMenuGUID())}toggleOptions(e){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"image",model:this.model,guid:this.getMenuGUID(),focusFirstOption:e.device==="keyboard"}})}hasError(){return!!this.model.error&&this.controller.getBrailleMode()==="none"}getBackgroundImage(){return this.model.image_url===this.lastURL?this.lastEncodedURL:(this.lastURL=this.model.image_url,this.lastEncodedURL='url("'+D0(this.model.image_url)+'")',this.lastEncodedURL)}toggleImageShown(){this.controller.dispatch({type:"toggle-item-hidden",id:this.model.id}),this.controller.dispatch({type:"set-focus-location",location:{type:"image-icon",id:this.model.id}})}getIconAriaLabel(){return this.myOptionsOpen()?_i(this.model,"hide-options"):this.controller.isInEditListMode()?_i(this.model,"show-options"):this.model.hidden?_i(this.model,"show"):_i(this.model,"hide")}};var oc=__dcg_shared_module_exports__['h'](z());xt();var ou=class extends oc.Class{init(){this.controller=this.props.controller()}template(){return oc.createElement("div",{class:oc.const("dcg-do-not-blur"),onTap:this.bindFn(this.newImage),handleEvent:oc.const("true"),role:oc.const("button"),tabindex:()=>this.props.readonly()?-1:0,"aria-label":this.props.ariaLabel,"aria-disabled":()=>this.props.readonly(),manageFocus:this.const(this.props.location?Qe({controller:this.controller,location:this.props.location()}):void 0)},this.children,oc.createElement("input",{type:oc.const("file"),accept:oc.const("image/*"),style:oc.const("display: none"),didMount:this.bindFn(this.didMountFileInput)}))}didMountFileInput(e){this.fileInputNode=e,H(e).on("change",()=>{this.props.onFileChange(e.files),e.value=""})}newImage(){this.props.readonly()||this.fileInputNode.click()}};var{If:vv,SwitchUnion:qZ}=je.Components,Wg=class extends je.Class{init(){this.model=this.props.model(),this.controller=this.props.controller()}template(){return je.createElement(ir,{containerClass:()=>({"dcg-image-input-mathquill":!0,"dcg-suffix-degree":this.props.name()==="angle"&&this.props.controller().getGraphSettings().degreeMode,"dcg-suffix-radian":this.props.name()==="angle"&&!this.props.controller().getGraphSettings().degreeMode}),fontSize:this.const("large"),fullWidth:this.const(!0),readonly:this.props.readonly,latex:()=>this.model[this.props.name()],isFocused:()=>this.props.focusedInput()===this.props.name(),ariaLabel:()=>this.controller.raw(this.props.name()),handleFocusChanged:this.bindFn(this.handleMQFocusedChanged),hasError:()=>a3(this.model,this.props.name()),controller:this.props.controller,handlePressedKey:this.bindFn(this.handlePressedKey),handleLatexChanged:this.bindFn(this.handleLatexChanged),noBorder:()=>!this.props.focusedInput()})}getInputs(){return["center","width","angle","height","opacity"]}handlePressedKey(e,t){let i=this.props.name();var o=_e.getFocusedMathquill();let n=this.getInputs(),a=n.indexOf(i);if(!this.controller.isInEditListMode()){if(e==="Enter")return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});if(e==="Esc"){Kr();return}}let s=-1;e==="Up"&&(s=a===1?4:a-2),e==="Down"&&(s=a===4?1:a+2),e==="Left"&&(s=a-1),e==="Right"&&(s=a+1);let l=e;if(s>=0&&s<n.length){let c=!1;if(o)c=_e.applyArrowKeyAndReturnIfWasAtBounds(o,l,t);else if(e==="Up"||e==="Down")c=!0;else{let p=Gs();c=p&&(e==="Left"&&p.selectionStart===0||e==="Right"&&p.selectionStart===p.value.length)}c&&(this.focusInput(n[s]),t&&t.preventDefault());return}o&&(o.keystroke(e,t),this.handleLatexChanged(o.latex()))}focusInput(e){this.controller.dispatch({type:"set-focus-location",location:{type:"image",id:this.model.id,location:e}})}handleLatexChanged(e){let t=this.props.name();this.model.draggingOnGraphpaper||QN(this.model,t)!==e&&this.controller.dispatch({type:"set-image-mq-attribute",id:this.model.id,attribute:t,latex:e})}handleMQFocusedChanged(e){let t=this.props.name();e?this.props.focusedInput()!==t&&this.controller.dispatch({type:"set-focus-location",location:{type:"image",id:this.model.id,location:t}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"image",id:this.model.id,location:t}})}},Cv=class extends Ts{didMount(){this.onItemViewMounted()}willUnmount(){this.onItemViewUnmounted()}template(){return je.createElement("div",{class:()=>({"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-expressionimage":!0,"dcg-inFolder":!!this.model.folderId,"dcg-selected":this.controller.isItemSelected(this.id),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id),"dcg-input-focused":this.getFocusedInput()&&this.getFocusedInput()!=="name"}),"expr-id":()=>this.model.id,onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect)},je.createElement("div",{class:je.const("dcg-fade-container")},je.createElement("div",{class:je.const("dcg-main")},qZ(()=>this.model.loadStatus,{failed:()=>je.createElement("div",null,je.createElement("div",{class:je.const("dcg-image-failed")},()=>this.controller.s("graphing-calculator-error-failed-to-load-image")),je.createElement("div",{role:je.const("button"),tabindex:je.const(0),class:je.const("dcg-retry-loading-image"),onTap:this.bindFn(this.onRetryLoad)},()=>this.controller.s("graphing-calculator-button-load-image-retry"))),loading:()=>je.createElement("div",null,je.createElement("div",{class:je.const("dcg-image-loading")},()=>this.controller.s("graphing-calculator-text-loading-image")),je.createElement("div",{role:je.const("button"),tabindex:je.const(0),class:je.const("dcg-retry-loading-image"),onTap:this.bindFn(this.onRetryLoad)},()=>this.controller.s("graphing-calculator-button-load-image-retry"))),loaded:()=>je.createElement("div",{class:je.const("dcg-image-loaded")},je.createElement("div",{class:je.const("dcg-image-title-row")},je.createElement(iu,{shouldFocus:()=>this.getFocusedInput()==="name",text:()=>this.model.name,ariaLabel:()=>_i(this.model,"edit_title"),placeholder:()=>this.controller.s("graphing-calculator-text-image-placeholder"),showLinks:()=>this.controller.areLinksEnabled(),onInput:this.bindFn(this.onNameInput),onFocusChange:this.bindFn(this.onNameFocusChange),onSpecialKey:this.bindFn(this.onNameSpecialKey),readonly:()=>this.controller.isInEditListMode()||this.isReadonly()}),je.createElement(vv,{predicate:()=>this.controller.areImagesEnabled()},()=>je.createElement(ou,{controller:()=>this.controller,ariaLabel:()=>this.controller.s("graphing-calculator-button-change-image"),onFileChange:e=>this.insertFiles(e),location:this.const({type:"change-image-btn",id:this.id}),readonly:this.bindFn(this.isReadonly)},je.createElement(vv,{predicate:()=>!this.isReadonly()},()=>je.createElement("div",{class:je.const("dcg-action-changeimage")},()=>this.controller.s("graphing-calculator-button-change-image")))))),je.createElement("div",{class:()=>({"dcg-do-blur":!0,"dcg-image-input-grid":!0}),handleEvent:je.const("true")},je.createElement("div",{class:je.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-center")),je.createElement(Wg,{name:this.const("center"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)}),je.createElement("div",{class:je.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-width")),je.createElement(Wg,{name:this.const("width"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)}),je.createElement("div",{class:je.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-angle")),je.createElement(Wg,{name:this.const("angle"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)}),je.createElement("div",{class:je.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-height")),je.createElement(Wg,{name:this.const("height"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)}),je.createElement("div",{class:je.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-opacity")),je.createElement(Wg,{name:this.const("opacity"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)})))})),je.createElement("span",{class:je.const("dcg-fadeout")}),je.createElement(ic,{controller:this.props.controller,model:this.props.model}),je.createElement(vv,{predicate:this.bindFn(this.shouldShowBrailleError)},()=>je.createElement("div",{class:this.getFooterClass()},je.createElement("div",{tabindex:je.const(0),class:je.const("dcg-expression-braille-error"),"aria-roledescription":je.const("error"),"aria-label":()=>this.controller.unpack(this.model.error)},je.createElement("i",{class:je.const("dcg-icon-error"),"aria-hidden":je.const("true")}),()=>this.controller.unpack(this.model.error)))),je.createElement(vv,{predicate:()=>$S(this.model).length>0&&this.controller.areSlidersEnabled()},()=>je.createElement("div",{class:this.getFooterClass()},je.createElement(td,{model:this.props.model,controller:this.props.controller}))),je.createElement(vv,{predicate:this.bindFn(this.shouldShowActionInfo)},()=>je.createElement("div",{class:this.getFooterClass()},je.createElement(zg,{model:this.props.model,controller:this.props.controller})))),je.createElement("span",{class:je.const("dcg-tab dcg-action-drag dcg-action-icon-touch"),handleevent:je.const("true"),tapboundary:je.const("true"),disablescroll:je.const("true"),onTapStart:this.bindFn(this.onDragPending)},je.createElement("span",{class:je.const("dcg-num")},()=>this.model.displayIndex),je.createElement("div",{class:je.const("dcg-tab-interior dcg-action-icon-mouse")},je.createElement(Hg,{model:this.props.model,controller:this.props.controller}))),je.createElement(rc,{controller:this.props.controller,id:()=>this.model.id}))}isReadonly(){return this.controller.isItemReadonly(this.id)}shouldShowActionInfo(){return!!(this.model.clickableInfo&&this.model.clickableInfo.enabled&&this.model.clickableInfo.latex)}getFooterClass(){return this.isFirstRender()?this.const("dcg-expression-bottom dcg-indent-in-folder"):this.const("dcg-expression-bottom dcg-fadein-bottom dcg-indent-in-folder")}onNameInput(e){this.controller.dispatch({type:"set-image-name",id:this.id,name:e})}onNameFocusChange(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"image",id:this.id,location:"name"}}):this.getFocusedInput()==="name"&&this.controller.dispatch({type:"blur-focus-location",location:{type:"image",id:this.id,location:"name"}})}onNameSpecialKey(e){return this.controller.dispatch({type:"on-special-key-pressed",key:e})}getFocusedInput(){let e=this.controller.getFocusLocation();if(e&&e.type==="image"&&e.id===this.model.id)return e.location}onRetryLoad(){this.controller.dispatch({type:"image-retry-loading",id:this.id})}shouldShowBrailleError(){return this.controller.getBrailleMode()!=="none"&&!!this.model.error}insertFiles(e){this.controller.dispatch({type:"change-image",files:e,id:this.id})}onMouseSelect(e){e.type==="dcg-tap"&&e.device==="mouse"||e.type==="dcg-tapstart"&&e.device==="touch"||e.wasHandled()||(e.handle(),this.controller.dispatch({type:"set-selected-id",id:this.id}))}};var Dv=__dcg_shared_module_exports__['h'](z());var Sv=class extends Ts{didMount(){this.onItemViewMounted()}willUnmount(){this.onItemViewUnmounted()}template(){let e="";return this.model.cachedRenderHeight&&(e="height:"+this.model.cachedRenderHeight+"px"),Dv.createElement("div",{class:Dv.const("dcg-do-not-blur dcg-expressionitem dcg-shell"),"expr-id":this.const(this.model.id),onTap:this.bindFn(this.onMouseSelect),style:Dv.const(e)})}};var Tb=__dcg_shared_module_exports__['h'](z()),kv=class extends Tb.Class{init(){this.controller=this.props.controller()}template(){return Tb.createElement("div",{class:Tb.const("dcg-drag-container"),style:()=>({top:this.getTopPx(),left:this.getLeftPx()})},this.children)}getTopPx(){let e=this.controller.getRawDragState();if(e)return e.itemTop+"px"}getLeftPx(){let e=this.controller.getRawDragState();if(e)return e.itemLeft+"px"}};var rp={delimiter:"",header:!1,dynamicTyping:!1,preview:0,step:void 0,encoding:"",comments:!1,complete:void 0,error:void 0,download:!1,chunk:void 0,keepEmptyRows:!1},ma={};ma.parse=KZ;ma.RECORD_SEP=String.fromCharCode(30);ma.UNIT_SEP=String.fromCharCode(31);ma.BYTE_ORDER_MARK="\uFEFF";ma.BAD_DELIMITERS=["\r",`
`,'"',ma.BYTE_ORDER_MARK];ma.LocalChunkSize=1024*1024*10;ma.RemoteChunkSize=1024*1024*5;ma.DefaultDelimiter=",";ma.Parser=S0;ma.ParserHandle=b4;function KZ(r,e){var t=zZ(e),i=new b4(t),o=i.parse(r);return o}function b4(r){var e=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,t=this,i,o,n=!1,a,s=[],l={data:[],errors:[],meta:{}};r=yL(r),this.parse=function(D){if(a=!1,!r.delimiter){var k=h(D);k.successful?r.delimiter=k.bestDelimiter:(a=!0,r.delimiter=ma.DefaultDelimiter),l.meta.delimiter=r.delimiter}if(Ib(r.step)){var M=r.step;r.step=function(I){l=I,p()?c():M(c(),t)}}return r.preview&&r.header&&r.preview++,i=D,o=new S0(r),l=o.parse(i),c(),Ib(r.complete)&&!n&&r.complete(l),n?{meta:{paused:!0}}:l},this.pause=function(){n=!0,o.abort(),i=i.substr(o.getCharIndex())},this.resume=function(){n=!1,o=new S0(r),o.parse(i),Ib(r.complete)&&!n&&r.complete(l)},this.abort=function(){o.abort(),Ib(r.complete)&&r.complete(l),i=""};function c(){return l&&a&&(C("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+ma.DefaultDelimiter+"'"),a=!1),p()&&u(),m()}function p(){return r.header&&s.length==0}function u(){if(l){for(var D=0;p()&&D<l.data.length;D++)for(var k=0;k<l.data[D].length;k++)s.push(l.data[D][k]);l.data.splice(0,1)}}function m(){if(!l||!r.header&&!r.dynamicTyping)return l;for(var D=0;D<l.data.length;D++){for(var k={},M=0;M<l.data[D].length;M++){if(r.dynamicTyping){var I=l.data[D][M];I=="true"?l.data[D][M]=!0:I=="false"?l.data[D][M]=!1:l.data[D][M]=x(I)}r.header&&(M>=s.length?(k.__parsed_extra||(k.__parsed_extra=[]),k.__parsed_extra.push(l.data[D][M])):k[s[M]]=l.data[D][M])}r.header&&(l.data[D]=k,M>s.length?C("FieldMismatch","TooManyFields","Too many fields: expected "+s.length+" fields but parsed "+M,D):M<s.length&&C("FieldMismatch","TooFewFields","Too few fields: expected "+s.length+" fields but parsed "+M,D))}return r.header&&l.meta&&(l.meta.fields=s),l}function h(D){for(var k=[",","	","|",";",ma.RECORD_SEP,ma.UNIT_SEP],M,I,S,V=0;V<k.length;V++){var P=k[V],L=0,B=0;S=void 0;for(var R=new S0({delimiter:P,preview:10}).parse(D),W=0;W<R.data.length;W++){var re=R.data[W].length;if(B+=re,typeof S=="undefined"){S=re;continue}else re>1&&(L+=Math.abs(re-S),S=re)}B/=R.data.length,(typeof I=="undefined"||L<I)&&B>1.99&&(I=L,M=P)}return r.delimiter=M,{successful:!!M,bestDelimiter:M}}function x(D){var k=e.test(D);return k?parseFloat(D):D}function C(D,k,M,I){l.errors.push({type:D,code:k,message:M,row:I})}}function S0(r){var e=/^\s*$/,t,i,o,n,a,s,l,c,p,u,m,h,x,C,D,k=!1;r=r||{},i=r.delimiter,o=r.comments,n=r.step,s=r.preview,(typeof i!="string"||i.length!=1||ma.BAD_DELIMITERS.indexOf(i)>-1)&&(i=","),o===!0?o="#":(typeof o!="string"||o.length!=1||ma.BAD_DELIMITERS.indexOf(o)>-1||o==i)&&(o=!1),this.parse=function(ie){if(typeof ie!="string")throw"Input must be a string";return pe(ie),M()},this.abort=function(){k=!0},this.getCharIndex=function(){return c};function M(){for(;c<t.length&&!(k||s>0&&D>=s);)l=='"'?V():p?P():L(),I();return S()}function I(){c++,l=t[c]}function S(){if(k&&te("Abort","ParseAbort","Parsing was aborted by the user's step function"),p&&te("Quotes","MissingQuotes","Unescaped or mismatched quotes"),X(),!Ib(n))return ae()}function V(){j()&&!J()?p=!p:(W(),p&&J()?c++:te("Quotes","UnexpectedQuotes","Unexpected quotes"))}function P(){(A(c)||E(c))&&u++,W()}function L(){l==i?re():A(c)?(ne(),I()):E(c)?ne():B()?R():W()}function B(){if(!o)return!1;var ie=c==0||E(c-1)||A(c-2);return ie&&t[c]===o}function R(){for(;!A(c)&&!E(c)&&c<t.length;)I()}function W(){m[x][C]+=l}function re(){m[x].push(""),C=m[x].length-1}function ne(){X(),u++,D++,m.push([]),x=m.length-1,re()}function X(){b(),Ib(n)&&(m[x]&&n(ae()),he())}function b(){m[x].length==1&&e.test(m[x][0])&&(r.keepEmptyRows?m[x].splice(0,1):m.splice(x,1),x=m.length-1)}function A(ie){return ie<t.length-1&&(t[ie]=="\r"&&t[ie+1]==`
`||t[ie]==`
`&&t[ie+1]=="\r")}function E(ie){return t[ie]=="\r"||t[ie]==`
`}function J(){return!j()&&c<t.length-1&&t[c+1]=='"'}function j(){return!p&&ce(c-1)||ce(c+1)}function ce(ie){typeof ie!="number"&&(ie=c);var de=t[ie];return ie<=-1||ie>=t.length||de==i||de=="\r"||de==`
`}function te(ie,de,Ie){h.push({type:ie,code:de,message:Ie,line:u,row:x,index:c})}function pe(ie){t=ie,p=!1,c=0,D=0,u=1,he(),m=[[""]],l=t[c]}function he(){m=[],h=[],x=0,C=0}function ae(){return{data:m,errors:h,meta:{lines:u,delimiter:i,aborted:k,truncated:s>0&&c<t.length}}}}function zZ(r){typeof r!="object"&&(r={});var e=yL(r);return(typeof e.delimiter!="string"||e.delimiter.length!=1||ma.BAD_DELIMITERS.indexOf(e.delimiter)>-1)&&(e.delimiter=rp.delimiter),typeof e.header!="boolean"&&(e.header=rp.header),typeof e.dynamicTyping!="boolean"&&(e.dynamicTyping=rp.dynamicTyping),typeof e.preview!="number"&&(e.preview=rp.preview),typeof e.step!="function"&&(e.step=rp.step),typeof e.complete!="function"&&(e.complete=rp.complete),typeof e.error!="function"&&(e.error=rp.error),typeof e.encoding!="string"&&(e.encoding=rp.encoding),typeof e.download!="boolean"&&(e.download=rp.download),typeof e.keepEmptyRows!="boolean"&&(e.keepEmptyRows=rp.keepEmptyRows),e}function yL(r){if(typeof r!="object")return r;var e=r instanceof Array?[]:{};for(var t in r)e[t]=yL(r[t]);return e}function Ib(r){return typeof r=="function"}var{parse:y4}=ma;yl();function xL(r){var e;if(typeof r=="number")e=r+"";else if(typeof r=="string")e=r;else return!1;return e.trim().match(/^-?[0-9]*\.?[0-9]*$/)}function x4(r){let e=r.split(/\r?\n/),t=[],i=!1;if(!(e.length<2)){for(let o=0;o<e.length;o++){let n=e[o];if(!n.trim())continue;o>0&&!xL(n.replace(/,(\d{3})/g,"$1"))&&(i=!0);let a={content:n};t.push(a)}if(!i){let o=__dcg_shared_module_exports__['x'](t,"content").map(n=>n.replace(/,(\d{3})/g,"$1"));return xL(o[0])||(o=o.slice(1)),[{content:"\\left["+o.join(",")+"\\right]",numberList:!0}]}return t}}function w4(r){if(/^\s*$/.test(r))return;let e=y4(r,{preview:1e4}),t=e.data,i=[];if(e.errors.length&&!e.data.length){fn("PapaParse.parse returned errors.",{metaData:{input:r,output:e.errors}});return}if(!(!e.data.length||e.data.length<2)){var o=t[0].length;for(let n=0;n<o;n++)i.push([]);for(let n=0;n<e.data.length;n++)if(!(n===0&&isNaN(parseFloat(t[n][0])))){if(t[n].length<2)return;if(!(!t[n][0]&&!t[n][1]))for(let a=0;a<o;a++){let s=(t[n][a]||"").replace(/,(\d{3})/g,"$1");if(s&&isNaN(parseFloat(s)))return;i[a].push(s)}}if(!(i[0].length<2))return i}}var ds=__dcg_shared_module_exports__['h'](z()),Ev=class extends ds.Class{template(){return this.controller=this.props.controller(),ds.createElement("div",{class:ds.const("dcg-expressionitem dcg-new-expression dcg-opened")},ds.createElement("div",{class:ds.const("dcg-new-math-div dcg-do-not-blur dcg-action-newmath"),onTap:this.bindFn(this.newMath)},ds.createElement("div",{class:ds.const("dcg-new-expression-fade")})),ds.createElement("span",{class:ds.const("dcg-tab")},ds.createElement("span",{class:ds.const("dcg-num dcg-variable-index")},this.bindFn(this.getIndex)),ds.createElement("div",{class:ds.const("dcg-tab-interior")})))}getIndex(){return this.controller.getNextDisplayIndex()}newMath(){this.controller.dispatch({type:"new-expression-at-end"})}};var it=__dcg_shared_module_exports__['h'](z());xt();var{If:Gv}=it.Components,Tv=class extends it.Class{init(){this.controller=this.props.controller()}template(){return it.createElement("div",{class:it.const("dcg-add-expression-container")},it.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-add-item-tooltip"),gravity:this.const("s")},it.createElement("span",{class:()=>({"dcg-icon-btn":!0,"dcg-add-expression-btn":!0,"dcg-action-add-expression":!0,"dcg-do-blur":!0,"dcg-active":this.controller.isAddExpressionOpen()}),handleEvent:it.const("true"),role:it.const("button"),tabindex:it.const("0"),"aria-haspopup":it.const("true"),"aria-expanded":()=>this.controller.isAddExpressionOpen(),"aria-label":()=>this.controller.s("graphing-calculator-label-add-item-tooltip"),didMount:e=>{this.toggleButtonNode=e},onTap:this.bindFn(this.toggleAddExpression),manageFocus:this.const(Qe({controller:this.controller,location:{type:"add-item-btn"}}))},it.createElement("i",{class:it.const("dcg-icon-plus"),"aria-hidden":it.const("true")}))),it.createElement(Gv,{predicate:()=>this.controller.isAddExpressionOpen()},()=>it.createElement("div",{class:()=>({"dcg-add-expression-dropdown":!0,"dcg-popover":!0,"dcg-bottom":!this.controller.isNarrow(),"dcg-right":this.controller.isNarrow()}),role:it.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-item-menu"),didMount:this.bindFn(this.didMountPopover),didUnmount:this.bindFn(this.didUnmountPopover)},it.createElement("div",{class:it.const("dcg-popover-interior")},it.createElement("div",{class:it.const("dcg-new-item dcg-do-not-blur dcg-action-newexpression"),role:it.const("button"),tabindex:it.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-expression"),onTap:this.bindFn(this.newExpression),handleEvent:it.const("true"),manageFocus:this.const(Qe({controller:this.controller,location:{type:"add-expression-btn"}}))},it.createElement("i",{class:it.const("dcg-icon-new-expression dcg-expression-icon"),"aria-hidden":it.const("true")}),()=>this.controller.s("graphing-calculator-label-expression-lowercase")),it.createElement(Gv,{predicate:()=>this.controller.areNotesEnabled()},()=>it.createElement("div",{class:it.const("dcg-new-item dcg-do-not-blur dcg-action-newtext"),role:it.const("button"),tabindex:it.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-note"),onTap:this.bindFn(this.newText),handleEvent:it.const("true"),manageFocus:this.const(Qe({controller:this.controller,location:{type:"add-note-btn"}}))},it.createElement("i",{class:it.const("dcg-icon-new-text dcg-expression-icon"),"aria-hidden":it.const("true")}),()=>this.controller.s("graphing-calculator-label-note-lowercase"))),it.createElement("div",{class:it.const("dcg-new-item dcg-do-not-blur dcg-action-newtable"),role:it.const("button"),tabindex:it.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-table"),onTap:this.bindFn(this.newTable),handleEvent:it.const("true"),manageFocus:this.const(Qe({controller:this.controller,location:{type:"add-table-btn"}}))},it.createElement("i",{class:it.const("dcg-icon-new-table dcg-expression-icon"),"aria-hidden":it.const("true")}),()=>this.controller.s("graphing-calculator-label-table-lowercase")),it.createElement(Gv,{predicate:()=>this.controller.areFoldersEnabled()},()=>it.createElement("div",{class:it.const("dcg-new-item dcg-do-not-blur dcg-action-newfolder"),role:it.const("button"),tabindex:it.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-folder"),onTap:this.bindFn(this.newFolder),handleEvent:it.const("true"),manageFocus:this.const(Qe({controller:this.controller,location:{type:"add-folder-btn"}}))},it.createElement("i",{class:it.const("dcg-icon-new-folder dcg-expression-icon"),"aria-hidden":it.const("true")}),()=>this.controller.s("graphing-calculator-label-folder-lowercase"))),it.createElement(Gv,{predicate:()=>this.controller.areImagesEnabled()},()=>it.createElement(ou,{controller:()=>this.controller,ariaLabel:()=>this.controller.s("graphing-calculator-narration-add-image"),onFileChange:e=>this.insertFiles(e),location:this.const({type:"add-image-btn"}),readonly:this.const(!1)},it.createElement("div",{class:it.const("dcg-new-item dcg-action-newimage")},it.createElement("i",{class:it.const("dcg-icon-new-image dcg-expression-icon"),"aria-hidden":it.const("true")}),()=>this.controller.s("graphing-calculator-label-image-lowercase")))),it.createElement(Gv,{predicate:this.bindFn(this.showAddTicker)},()=>it.createElement("div",{class:it.const("dcg-new-item dcg-do-not-blur dcg-action-ticker"),role:it.const("button"),tabindex:it.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-ticker"),onTap:this.bindFn(this.addTicker),handleEvent:it.const("true"),manageFocus:this.const(Qe({controller:this.controller,location:{type:"add-ticker-btn"}}))},it.createElement("i",{class:it.const("dcg-icon-metronome dcg-expression-icon"),"aria-hidden":it.const("true")}),()=>this.controller.s("graphing-calculator-label-ticker-lowercase")))),it.createElement("span",{class:it.const("dcg-arrow")}))))}showAddTicker(){return this.controller.areActionsEnabled()&&!this.controller.getTickerOpen()}didMountPopover(e){this.popoverNode=e,H(document).on("dcg-tapstart.add-expression-view wheel.add-expression-view",t=>{this.eventShouldClosePopover(t)&&this.controller.dispatch({type:"close-add-expression",focusIconAfterClose:t.device==="keyboard"})}),H(document).on("keydown.add-expression-view",t=>{if(Ee(t)==="Esc"&&this.controller.dispatch({type:"close-add-expression",focusIconAfterClose:!0}),Ee(t)==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let i=this.controller.getFocusLocation();if(!i)return;let o;this.showAddTicker()?o={type:"add-ticker-btn"}:this.controller.areImagesEnabled()?o={type:"add-image-btn"}:this.controller.areFoldersEnabled()?o={type:"add-folder-btn"}:o={type:"add-table-btn"},!t.shiftKey&&i.type===o.type?(this.controller.dispatch({type:"set-focus-location",location:{type:"add-item-btn"}}),t.preventDefault(),t.stopPropagation()):t.shiftKey&&i.type==="add-item-btn"&&(this.controller.dispatch({type:"set-focus-location",location:o}),t.preventDefault(),t.stopPropagation())}}),pl&&Ip&&H(e).on("dcg-tapstart",t=>t.preventDefault()),H(e.querySelector(".dcg-new-item")).on("touchstart",t=>t.preventDefault())}didUnmountPopover(){H(document).off(".add-expression-view")}toggleAddExpression(e){this.controller.dispatch({type:"toggle-add-expression",focusOnOpen:e.device==="keyboard"})}newExpression(){this.controller.dispatch({type:"new-expression"})}newText(){this.controller.dispatch({type:"new-text"})}newFolder(){this.controller.dispatch({type:"new-folder"})}addTicker(){this.controller.dispatch({type:"open-ticker"})}newTable(){this.controller.dispatch({type:"new-table"})}insertFiles(e){this.controller.dispatch({type:"new-images",files:e})}eventShouldClosePopover(e){let t=!!this.popoverNode.contains(e.target),i=!!this.toggleButtonNode.contains(e.target);return!(t||i)}};var dt=__dcg_shared_module_exports__['h'](z());var nc=__dcg_shared_module_exports__['h'](z());var k0=class extends nc.Class{init(){this.controller=this.props.controller()}template(){return nc.createElement("span",{role:nc.const("button"),class:()=>({"dcg-constructions-count-link":!0,"dcg-icon-btn":!0,"dcg-active":this.controller.getShowConstructionsOpen(),"dcg-do-not-blur":!0}),handleEvent:nc.const("true"),tabindex:nc.const("0"),"aria-expanded":()=>this.controller.getShowConstructionsOpen(),manageFocus:this.const(Qe({controller:this.controller,location:{type:"geo-show-constructions-icon"}})),onTap:this.bindFn(this.showAllConstructions)},nc.createElement("i",{class:nc.const("dcg-icon-geometry"),"aria-label":()=>this.controller.s("graphing-calculator-narration-geometry-construction-icon-label")}),nc.createElement("span",{class:nc.const("dcg-construction-count")},()=>this.controller.getGeometryTokenCount()))}showAllConstructions(){this.controller.dispatch({type:"set-show-constructions-open",open:!this.controller.getShowConstructionsOpen(),setFocus:!1})}};var za=__dcg_shared_module_exports__['h'](z());var Vb=class extends za.Class{init(){this.controller=this.props.controller()}template(){return za.createElement("div",{class:()=>({"dcg-btn-flat-gray":this.props.isPillbox(),"dcg-btn-flat-gray-group":this.props.isPillbox(),"dcg-group-horizontal":this.props.isPillbox()}),style:()=>({background:this.props.isPillbox()?this.controller.getPillboxBackgroundColor():void 0})},za.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-undo-tooltip"),gravity:this.const("s"),disabled:()=>!this.controller.canUndo(),displayBlock:this.props.isPillbox},za.createElement("div",{class:()=>({"dcg-action-undo":!0,"dcg-icon-btn":!0,"dcg-pillbox-btn-interior":this.props.isPillbox(),"dcg-disabled":!this.controller.canUndo()}),role:za.const("button"),tabindex:()=>this.controller.canUndo()?0:-1,"aria-label":()=>this.controller.s("graphing-calculator-narration-undo"),onTap:()=>this.controller.dispatch({type:"undo"}),"aria-disabled":()=>!this.controller.canUndo()},za.createElement("i",{class:za.const("dcg-icon-undo"),"aria-hidden":za.const("true")}))),za.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-redo-tooltip"),gravity:this.const("s"),disabled:()=>!this.controller.canRedo(),displayBlock:this.props.isPillbox},za.createElement("div",{class:()=>({"dcg-action-redo":!0,"dcg-icon-btn":!0,"dcg-pillbox-btn-interior":this.props.isPillbox(),"dcg-disabled":!this.controller.canRedo()}),role:za.const("button"),tabindex:()=>this.controller.canRedo()?0:-1,"aria-label":()=>this.controller.s("graphing-calculator-narration-redo"),onTap:()=>this.controller.dispatch({type:"redo"}),"aria-disabled":()=>!this.controller.canRedo()},za.createElement("i",{class:za.const("dcg-icon-redo"),"aria-hidden":za.const("true")}))))}};var{If:nu}=dt.Components,Iv=class extends dt.Class{init(){this.controller=this.props.controller()}template(){return dt.createElement("div",{class:()=>({"dcg-expression-top-bar":!0,"dcg-expressions-scrolled":this.showShadow()}),role:dt.const("toolbar"),"aria-label":()=>this.controller.s("graphing-calculator-narration-expression-bar"),didMount:e=>{this.node=e},onTapStart:this.bindFn(this.clearSelectionOnMobile),style:()=>({background:this.controller.hasBackgroundColor()?this.controller.getPillboxBackgroundColor():void 0})},dt.createElement(nu,{predicate:this.bindFn(this.showHamburger)},()=>dt.createElement("span",{class:dt.const("dcg-action-opendrawer dcg-tooltip dcg-icon-btn dcg-in-api-action-opendrawer"),handleEvent:dt.const("true"),tooltip:()=>this.controller.s("graphing-calculator-label-open-graph-tooltip"),role:dt.const("button"),tabindex:dt.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-narration-open-graph"),onTap:()=>this.controller.dispatch({type:"open-drawer"})},dt.createElement("i",{class:dt.const("dcg-icon-hamburger"),"aria-hidden":dt.const("true")}))),dt.createElement(nu,{predicate:()=>!this.controller.isInEditListMode()},()=>dt.createElement(Tv,{controller:()=>this.props.controller()})),dt.createElement(nu,{predicate:()=>this.controller.isGeoUIActive()&&!this.controller.isInEditListMode()},()=>dt.createElement(k0,{controller:this.props.controller})),dt.createElement(nu,{predicate:this.bindFn(this.showRerandomize)},()=>dt.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-randomize-tooltip"),gravity:this.const("s")},dt.createElement("span",{class:dt.const("dcg-icon-btn"),handleEvent:dt.const("true"),role:dt.const("button"),tabindex:dt.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-label-randomize-tooltip"),onTap:()=>this.controller.dispatch({type:"re-randomize"})},dt.createElement("i",{class:dt.const("dcg-icon-randomize"),"aria-hidden":dt.const("true")})))),dt.createElement(nu,{predicate:()=>this.controller.isInEditListMode()&&!this.controller.hasDefaultState()},()=>dt.createElement("span",{class:dt.const("dcg-btn-red dcg-action-clearall"),role:dt.const("button"),tabindex:dt.const("0"),onTap:()=>this.controller.dispatch({type:"clear-graph"})},()=>this.controller.s("graphing-calculator-button-clear-graph"))),dt.createElement(nu,{predicate:()=>this.controller.isInEditListMode()&&this.controller.hasDefaultState()},()=>dt.createElement("span",{class:dt.const("dcg-btn-red dcg-action-reset"),role:dt.const("button"),tabindex:dt.const("0"),onTap:()=>this.controller.dispatch({type:"reset-graph"})},()=>this.controller.s("graphing-calculator-button-reset-graph"))),dt.createElement("div",{class:dt.const("dcg-center-buttons")},dt.createElement(Vb,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{isPillbox:this.const(!1)}))),dt.createElement(nu,{predicate:()=>!this.controller.isInEditListMode()},()=>dt.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-edit-list-tooltip"),gravity:this.const("s")},dt.createElement("span",{class:dt.const("dcg-icon-btn dcg-action-toggle-edit"),handleEvent:dt.const("true"),role:dt.const("button"),tabindex:dt.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-expression-list"),onTap:this.bindFn(this.toggleEditListMode),manageFocus:this.const(Qe({controller:this.controller,location:{type:"edit-list-toggle"}}))},dt.createElement("i",{class:dt.const("dcg-icon-settings"),"aria-hidden":dt.const("true")})))),dt.createElement(nu,{predicate:()=>this.controller.isInEditListMode()},()=>dt.createElement("span",{class:dt.const("dcg-btn-primary dcg-action-toggle-edit dcg-do-not-blur"),handleEvent:dt.const("true"),role:dt.const("button"),tabindex:dt.const("0"),onTap:this.bindFn(this.toggleEditListMode),manageFocus:this.const(Qe({controller:this.controller,location:{type:"edit-list-toggle"}}))},()=>this.controller.s("graphing-calculator-button-done"))),dt.createElement(nu,{predicate:()=>!this.controller.isInEditListMode()&&this.controller.getGraphSettings().config.graphpaper},()=>dt.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-hide-expression-list-tooltip"),gravity:this.const("s")},dt.const(" "),dt.createElement("span",{class:()=>({"dcg-resize-list-btn":!0,"dcg-action-hideexpressions":!0,"dcg-icon-btn":!0,"dcg-rotated":this.controller.isNarrow()}),role:dt.const("button"),tabindex:dt.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-label-hide-expression-list-tooltip"),onTap:e=>{this.controller.dispatch({type:"hide-expressions-list",focusShowIcon:e.device==="keyboard"})},manageFocus:this.const(Qe({controller:this.controller,location:{type:"hide-expression-list-btn"}}))},dt.createElement("i",{class:dt.const("dcg-icon-hide"),"aria-hidden":dt.const("true")})))))}showShadow(){return this.controller.getTickerOpen()||this.controller.getExpressionSearchOpen()?!1:this.props.expsScrolled()}showRerandomize(){return this.controller.isInEditListMode()?!1:this.controller.anyItemDependsOnRandomSeed()}showHamburger(){return!this.controller.getGraphSettings().config.showHamburger||this.controller.isInEditListMode()?!1:!this.controller.isNarrow()}clearSelectionOnMobile(e){e.wasHandled()||this.controller.dispatch({type:"set-none-selected"})}toggleEditListMode(e){this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!this.controller.isInEditListMode(),focusExpressionList:!1}),e.device==="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"edit-list-toggle"}})}};function v4(r){let e=__dcg_shared_module_exports__['j'](Vc(r));return e.graph.product="geometry-calculator",e}async function E0(r,e,t){let i=!1;r.dispatch({type:"toast/show",toast:{message:r.s("graphing-calculator-text-toast-importing-graph"),hideAfter:0,toastStyle:"cover",onHide:()=>{i=!0}}});let o=()=>{i||r.dispatch({type:"toast/show",toast:{message:r.s("graphing-calculator-text-toast-error-importing-graph"),toastStyle:"error",hideAfter:12e3}})},n=()=>{r.dispatch({type:"toast/show",toast:{message:r.s("graphing-calculator-text-toast-error-no-folders"),toastStyle:"error",hideAfter:12e3}})},a=(l,c)=>{r.dispatch({type:"set-state",state:l}),r.dispatch({type:"toast/show",toast:{message:r.s("graphing-calculator-text-toast-imported-graph"),undoCallback:()=>{r.dispatch({type:"set-state",state:c})}}})},s=(l,c,p)=>{if(i)return;let u=r.getSelectedItem();if(!u)return;let m=u.type==="folder",h=u.type!=="folder"&&!!u.folderId,x=m||h,C={},D=r.getState(),k=D.expressions.list;if(k.length===1&&!m&&!r.isGeometry()){a(l,D);return}if(r.isGeometry()&&p!=="graphing"){a(l,D);return}let M=l.expressions.list;for(let L=0;L<M.length;L++){let B=r.generateId(),R=M[L];if(R.type==="folder")if(x){n();return}else{C[R.id]=B,R.id=B;continue}R.folderId?R.folderId=C[R.folderId]:m?R.folderId=u.id:h&&(R.folderId=u.folderId),R.id=B}let I=__dcg_shared_module_exports__['j'](D),S=0;for(;S<k.length;){if(k[S].id===u.id){m&&(k[S].title=c);break}S+=1}let V=m?S+1:S,P=m?0:1;k.splice(V,P,...M),a(D,I)};try{let l=await fetch(`${e}?${new URLSearchParams(Ed)}`,{headers:{Accept:"application/json"}});if(!l.ok)throw void 0;let c=await l.json(),p=c.state,u=r4(e);r.isGeometry()&&(u==="geometry"?p=Uc(p):u==="graphing"&&(p=v4(p))),p=Vc(p),t(p,(m,h)=>{m||!h||!u?o():s(h,c.title||"",u)})}catch(l){o()}}function C4(r){if(window.clipboardData&&window.clipboardData.getData)return window.clipboardData.getData("Text");if(r&&r.clipboardData&&r.clipboardData.getData)return r.clipboardData.getData("text/plain")}var au=__dcg_shared_module_exports__['h'](z());xt();var{If:HZ}=au.Components,G0=class extends au.Class{init(){this.guid=__dcg_shared_module_exports__['V']("dcg-exp-list-resize")}template(){return au.createElement(HZ,{predicate:this.bindFn(this.isVisible)},()=>au.createElement("div",{class:au.const("dcg-exp-list-resizer"),onTapStart:this.bindFn(this.onTapStart)}))}isVisible(){return this.props.controller().expressionsAreFullWidth()?!1:this.props.controller().isListVisible()}onTapStart(e){this.initialWidth=this.props.controller().getExpListWidth(),this.initialLeft=e.changedTouches[0].clientX,H(document).on(`dcg-tapmove.${this.guid}`,t=>{if(this.initialLeft===void 0||this.initialWidth===void 0)return;let i=t.changedTouches[0].clientX-this.initialLeft+this.initialWidth;this.props.controller().dispatch({type:"resize-exp-list",expListWidth:i})}),H(document).on(`dcg-tapend.${this.guid}`,this.bindFn(this.onTapEnd)),H(document).on(`dcg-tapcancel.${this.guid}`,this.bindFn(this.onTapEnd))}onTapEnd(){H(document).off(`.${this.guid}`),this.initialLeft=void 0,this.initialWidth=void 0}};var or=__dcg_shared_module_exports__['h'](z());var{If:Vv}=or.Components,T0=class extends or.Class{constructor(){super(...arguments),this.justGlobalReplaced=!1}init(){this.controller=this.props.controller()}template(){return or.createElement("div",{class:()=>({"dcg-expression-search-bar":!0,"dcg-expressions-scrolled":this.props.expsScrolled()&&!this.controller.getTickerOpen()}),role:or.const("search")},or.createElement("div",{class:or.const("dcg-search-row")},or.createElement("div",{class:or.const("dcg-search-mathquill-container")},or.createElement(_e,{hasError:this.const(!1),getAriaLabel:()=>this.controller.s("graphing-calculator-label-search-expressions"),getAriaPostLabel:()=>this.controller.getExpressionSearchStr().length===0?this.controller.raw(""):this.shouldShowReplaceError()?this.controller.s("graphing-calculator-error-expression-replacement"):this.shouldShowSearchError()?this.controller.s("graphing-calculator-error-expression-search"):this.controller.s("shared-calculator-text-search-results",{count:new Vo(this.controller.getExpressionSearchCount())}),capExpressionSize:this.const(!1),onUserChangedLatex:this.bindFn(this.onSearchChange),latex:()=>this.controller.getRawExpressionSearchStr(),isFocused:this.bindFn(this.isSearchFocused),config:this.bindFn(this.getMQConfig),onFocusedChanged:this.bindFn(this.onSearchFocusChanged),noFadeout:this.const(!0),onUserPressedKey:(e,t)=>{if(e==="Esc")t&&t.preventDefault(),this.closeSearch();else if(e==="Enter")t&&t.preventDefault(),this.onEnter();else{var i=_e.getFocusedMathquill();if(!i)return;i.keystroke(e,t),this.controller.getRawExpressionSearchStr()!==i.latex()&&(this.justGlobalReplaced=!1,this.onSearchChange(i.latex()))}}}),or.createElement("i",{class:or.const("dcg-icon-search"),"aria-hidden":or.const("true")}),or.createElement(Vv,{predicate:()=>this.controller.getRawExpressionSearchStr().length===0},()=>or.createElement("span",{class:or.const("dcg-search-placeholder")},()=>this.controller.s("graphing-calculator-label-search-expressions"))),or.createElement(Vv,{predicate:()=>this.shouldShowSearchError()},()=>or.createElement("span",{class:or.const("dcg-search-replace-icon-container")},or.createElement(pa,{error:()=>this.controller.s("graphing-calculator-error-expression-search"),gravity:this.const("s"),size:this.const("small")}))),or.createElement(Vv,{predicate:()=>this.controller.isSearchReplaceValid()&&!this.justGlobalReplaced},()=>or.createElement("span",{class:or.const("dcg-search-replace-icon-container")},or.createElement("i",{class:or.const("dcg-icon-replace"),role:or.const("button"),tabindex:or.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-button-replace"),onTap:this.bindFn(this.onGlobalReplace)}))),or.createElement(Vv,{predicate:()=>this.justGlobalReplaced},()=>or.createElement("span",{class:or.const("dcg-search-replace-icon-container")},or.createElement("i",{class:or.const("dcg-icon-check"),"aria-hidden":or.const("true")}))),or.createElement(Vv,{predicate:()=>this.shouldShowReplaceError()},()=>or.createElement("span",{class:or.const("dcg-search-replace-icon-container")},or.createElement(pa,{error:()=>this.controller.s("graphing-calculator-error-expression-replacement"),gravity:this.const("s"),size:this.const("small")})))),or.createElement("i",{onTap:()=>this.closeSearch(),tabindex:or.const("0"),"aria-label":()=>this.controller.s("account-shell-button-cancel"),role:or.const("button"),class:or.const("dcg-icon-remove dcg-do-not-blur")})))}onGlobalReplace(){this.justGlobalReplaced=!0,setTimeout(()=>{this.justGlobalReplaced=!1,this.update()},1500),this.controller.dispatch({type:"rename-identifier-global",search:this.controller.getExpressionSearchStr(),replace:this.controller.getExpressionReplaceStr()})}onEnter(){this.controller.isSearchReplaceValid()?this.onGlobalReplace():this.controller.dispatch({type:"update-expression-search-str",str:this.controller.getRawExpressionSearchStr()})}shouldShowSearchError(){return!this.controller.getIsExpressionSearchStrValidForReplace()&&this.controller.getExpressionReplaceStr().length>0}shouldShowReplaceError(){return!this.shouldShowSearchError()&&!this.controller.getIsExpressionReplaceStrValidForReplace()&&this.controller.getExpressionReplaceStr().length>0}closeSearch(){this.controller.dispatch({type:"close-expression-search"})}onSearchChange(e){this.controller.dispatch({type:"update-expression-search-str",str:e})}onSearchFocusChanged(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"search-expressions"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"search-expressions"}})}isSearchFocused(){let e=this.controller.getFocusLocation();return!!e&&e.type==="search-expressions"}onReplaceChange(e){this.controller.dispatch({type:"update-expression-replace-str",str:e})}onReplaceFocusChanged(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"replace-expressions"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"replace-expressions"}})}isReplaceFocused(){let e=this.controller.getFocusLocation();return!!e&&e.type==="replace-expressions"}getMQConfig(){return this.controller.getMathquillConfig({additionalOperators:["label","rename","image"]})}};var tr=__dcg_shared_module_exports__['h'](z());var{If:D4,IfDefined:WZ}=tr.Components,I0=class extends tr.Class{init(){this.controller=this.props.controller()}template(){return tr.createElement("div",{class:()=>({"dcg-ticker":!0,"dcg-expressions-scrolled":this.props.expsScrolled()})},tr.createElement("div",{class:tr.const("dcg-ticker-settings-container")},tr.createElement("div",{class:tr.const("dcg-ticker-settings-internal")},tr.createElement("div",{class:tr.const("dcg-editable-mathquill-container dcg-action-definition")},tr.createElement("span",{class:tr.const("dcg-ticker-label")},()=>this.controller.raw("Run")),tr.createElement(_e,{hasError:()=>!!this.getHandlerErrorString(),getAriaPostLabel:()=>{let e=this.getHandlerErrorString();return e?this.controller.unpack(e):""},capExpressionSize:this.const(!1),onUserChangedLatex:e=>this.dispatchHandlerLatexIfChanged(e),latex:()=>this.getHandlerLatex(),getAriaLabel:()=>this.controller.s("graphing-calculator-narration-tick-action"),isFocused:()=>this.getFocusedInput()==="handler",config:()=>this.getMQConfig(),onFocusedChanged:e=>this.handleFocusedChanged("handler",e),selectOnFocus:this.const(!0),noFadeout:this.const(!0),onUserPressedKey:(e,t)=>{this.handlePressedKey("handler",e,t)}}),WZ(()=>this.getHandlerErrorString(),e=>tr.createElement("span",{class:tr.const("dcg-clickable-info-error-container")},tr.createElement(pa,{error:()=>this.controller.unpack(e()),gravity:this.const("s"),size:this.const("small")})))),tr.createElement("div",{class:tr.const("dcg-editable-mathquill-container dcg-action-frequency")},tr.createElement("span",{class:tr.const("dcg-ticker-label")},()=>this.controller.raw("every")),tr.createElement(_e,{hasError:()=>!!this.getMinStepErrorString(),getAriaPostLabel:()=>{let e=this.getMinStepErrorString();return e?this.controller.unpack(e):""},capExpressionSize:this.const(!1),onUserChangedLatex:e=>this.dispatchMinStepLatexIfChanged(e),latex:()=>this.getMinStepLatex(),getAriaLabel:()=>this.controller.s("graphing-calculator-label-ticker-min-step"),isFocused:()=>this.getFocusedInput()==="minstep",config:this.bindFn(this.getMQConfig),onFocusedChanged:e=>this.handleFocusedChanged("minstep",e),selectOnFocus:this.const(!0),placeholder:this.const("0"),noFadeout:this.const(!0),onUserPressedKey:(e,t)=>{this.handlePressedKey("minstep",e,t)}}),()=>this.controller.raw("ms"),tr.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-ticker-help-tooltip"),gravity:this.const("s")},tr.createElement("a",{"aria-label":()=>this.controller.s("graphing-calculator-label-ticker-help-tooltip"),class:tr.const("dcg-ticker-toggle-help"),target:tr.const("_blank"),href:tr.const("https://help.desmos.com/hc/en-us/articles/4407725009165")},tr.createElement("i",{class:tr.const("dcg-icon-question-sign"),"aria-hidden":tr.const("true")})))),tr.createElement(D4,{predicate:this.bindFn(this.shouldShowSliderPrompt)},()=>tr.createElement(td,{model:()=>this.props.controller().getTicker(),controller:this.props.controller}))),tr.createElement("div",{class:()=>({"dcg-circular-icon-container":!0,"dcg-disabled":this.iconDisabled()}),"aria-label":this.bindFn(this.getIconAriaLabel),role:tr.const("button"),tabindex:()=>this.iconDisabled()?-1:0,"aria-disabled":this.bindFn(this.iconDisabled),"aria-pressed":()=>this.controller.getTickerPlaying()&&!this.iconDisabled(),onTap:this.bindFn(this.toggleTicker),onTapStart:()=>{Kr()}},tr.createElement(xn,{iconType:this.const("metronome")}),tr.createElement("div",{class:()=>({"dcg-metronome-bar":!0,"dcg-metronome-playing":this.controller.getTickerPlaying()&&!this.iconDisabled()})}),tr.createElement(D4,{predicate:()=>!this.iconDisabled()},()=>tr.createElement("div",{class:tr.const("dcg-mini-play-pause")},tr.createElement(xn,{iconType:this.bindFn(this.getPlayIcon)}))))),tr.createElement("i",{onTap:this.bindFn(this.closeTicker),tabindex:()=>this.controller.isInEditListMode()?0:-1,"aria-label":()=>this.controller.s("graphing-calculator-label-ticker-close"),role:tr.const("link"),class:tr.const("dcg-icon-remove dcg-do-not-blur")}))}iconDisabled(){return!!(this.getMinStepErrorString()||this.getHandlerErrorString()||!this.isHandlerMaybeValid())}isHandlerMaybeValid(){var t;return((t=this.controller.getTicker().formula)==null?void 0:t.handler.status)==="maybe-valid"}closeTicker(){this.controller.dispatch({type:"close-ticker"})}toggleTicker(){this.iconDisabled()||this.controller.dispatch({type:"toggle-ticker"})}getPlayIcon(){return this.controller.getTickerPlaying()?"pause":"play"}getIconAriaLabel(){return this.controller.getTickerPlaying()?this.controller.s("graphing-calculator-label-ticker-pause"):this.controller.s("graphing-calculator-label-ticker-play")}getFocusedInput(){let e=this.controller.getFocusLocation();if(!(!e||e.type!=="ticker"))return e.location}handlePressedKey(e,t,i){let o=_e.getFocusedMathquill();if(o){if(t==="Enter"&&this.shouldShowSliderPrompt()&&this.controller.dispatch({type:"create-sliders-for-ticker",variables:Bx(this.props.controller().getTicker())}),t==="Right"&&e==="handler"||t==="Left"&&e==="minstep"||t==="Down"){var n=_e.applyArrowKeyAndReturnIfWasAtBounds(o,t,i);if(!n)return;if(t==="Down")return this.controller.dispatch({type:"on-special-key-pressed",key:t});if(t==="Right"){this.handleFocusedChanged("minstep",!0);return}else if(t==="Left"){this.handleFocusedChanged("handler",!0);return}}o.keystroke(t,i),e==="handler"?this.dispatchHandlerLatexIfChanged(o.latex()):e==="minstep"&&this.dispatchMinStepLatexIfChanged(o.latex())}}handleFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"ticker",location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"ticker",location:e}})}dispatchHandlerLatexIfChanged(e){this.getHandlerLatex()!==e&&this.controller.dispatch({type:"update-ticker-handlerlatex",latex:e})}dispatchMinStepLatexIfChanged(e){this.getMinStepLatex()!==e&&this.controller.dispatch({type:"update-ticker-minsteplatex",latex:e})}getHandlerLatex(){return this.controller.getTickerHandlerLatex()}getMinStepLatex(){return this.controller.getTickerMinStepLatex()}getMQConfig(){return this.controller.getMathquillConfig({additionalOperators:["dt"]})}getHandlerErrorString(){return this.getHandlerLatex()?v3(this.controller.getTicker()):void 0}getMinStepErrorString(){return C3(this.controller.getTicker())}shouldShowSliderPrompt(){return this.controller.areSlidersEnabled()?Bx(this.controller.getTicker()).length>0:!1}};var Yn=__dcg_shared_module_exports__['h'](z());var{For:S4,If:$Z}=Yn.Components,V0=class extends Yn.Class{init(){this.controller=this.props.controller(),this.currentlyInspectedDepth=1/0,this.cachedTokenDepths={depths:{},isInvalid:!1},this.updateCachedTokenDepthInfo()}willUpdate(){this.updateCachedTokenDepthInfo()}updateCachedTokenDepthInfo(){let e="",t=!1,i=this.controller.getFocusLocation();if(i&&i.type==="expression"){let n=this.controller.getFocusedItem();(n==null?void 0:n.type)==="expression"&&(e=n.id,t=!!n.error&&n.latex!==""||!!n.formula.variables.length)}if(this.cachedTokenDepths.focusedExpressionBeforeError==e&&t){this.cachedTokenDepths.isInvalid=!0;return}this.cachedTokenDepths={depths:this.controller.cachedGeoTokenDepths,isInvalid:!1,focusedExpressionBeforeError:t?void 0:e}}template(){return Yn.createElement("div",{class:()=>({"dcg-geo-show-constructions-pane":!0,"dcg-transient-error":this.cachedTokenDepths.isInvalid,"dcg-cant-drag-item":!!this.controller.getDraggedItemId()&&!this.controller.canDraggedItemBeMovedIntoTokenPane()}),"aria-label":()=>this.controller.s("graphing-calculator-narration-geometry-token-navigator-label"),role:Yn.const("region"),didUnmount:()=>this.lastFocusedIdentifier=void 0,onKeydown:this.bindFn(this.handleKeydown)},Yn.createElement($Z,{predicate:()=>this.controller.getGeometryTokenCount()===0},()=>Yn.createElement("div",{class:Yn.const("dcg-empty-constructions")},()=>this.controller.s("graphing-calculator-text-geometry-no-constructed-objects"))),Yn.createElement(S4,{each:this.bindFn(this.getObjectDepths)},Yn.createElement("div",{class:Yn.const("dcg-displayed-sections-container")},e=>Yn.createElement("div",{class:()=>({"dcg-displayed-section-level":!0,"dcg-selected-level":parseInt(e)===this.getCurrentlyInspectedDepth(),"dcg-below-the-line":parseInt(e)>this.getCurrentlyInspectedDepth()})},Yn.createElement(S4,{each:()=>this.getTokensForDepth(e),key:(t,i)=>i},Yn.createElement("span",{role:Yn.const("listbox"),"aria-label":()=>this.controller.s("graphing-calculator-narration-geometry-token-navigator-depth",{depth:e})},(t,i)=>Yn.createElement("span",{class:()=>({"dcg-token-being-dragged-container":this.isTokenBeingDragged(e,i)}),onTapStart:o=>{let n=this.getCalcIdForDepth(e,i),a=this.controller.getItemModel(n);!a||a.type!=="expression"||this.controller.isItemInGeoFolder(a.id)&&this.props.onDragPending(o,{type:"token",calcId:n,originalIndex:a.index})}},Yn.createElement(Kd,{showParentChildrenHover:this.const(!0),controller:this.props.controller,identifier:()=>this.getIdentifierForDepth(e,i),insideMQ:this.const(!1),insideGroup:this.const(!0),focusLocation:()=>({type:"geo-token",identifier:this.getIdentifierForDepth(e,i)}),putInTabOrder:()=>{if(this.lastFocusedIdentifier===void 0){let o=this.getObjectDepths();this.lastFocusedIdentifier=this.getIdentifierForDepth(o[0],0)}return this.lastFocusedIdentifier===this.getIdentifierForDepth(e,i)}}))))))))}isTokenBeingDragged(e,t){let i=this.controller.getDraggedItemId();if(!i)return!1;if(this.controller.isItemInGeoFolder(i))return i==this.getCalcIdForDepth(e,t)}getCurrentlyInspectedDepth(){return Math.min(this.currentlyInspectedDepth,this.getObjectDepths().length-1)}getIdentifierForDepth(e,t){var i=this.getTokensForDepth(e)[t];return i?i.identifier:""}getCalcIdForDepth(e,t){var i=this.getTokensForDepth(e)[t];return i?i.calcId:""}getTokensForDepth(e){let{depths:t}=this.cachedTokenDepths;var i=t[e];return i||[]}getObjectDepths(){let e=Object.keys(this.cachedTokenDepths.depths);return e.sort((t,i)=>{let o=parseInt(t),n=parseInt(i);return isFinite(o)?isFinite(n)?o-n:1:-1}),e}selectItemIfNecessary(){if(this.controller.hasAnyItemsSelected())return;let e=this.controller.getFocusLocation();if((e==null?void 0:e.type)!=="geo-token")return;let{calcId:t}=this.controller.cachedGeoTokenInfo[e.identifier];!t||!this.controller.getItemModel(t)||this.controller.dispatch({type:"set-selected-id",id:t})}handleKeydown(e){let t=this.controller.getFocusLocation(),i=Ee(e),o=ki(e);if(e.ctrlKey&&e.shiftKey&&!e.altKey&&!e.metaKey&&o==="O"){e.preventDefault(),e.stopPropagation(),this.selectItemIfNecessary(),this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"multi-select-more",guid:Eg(),focusFirstOption:!0,previousFocusLocation:t}});return}if(e.altKey&&!e.ctrlKey&&!e.metaKey&&e.shiftKey&&o==="M"){if(e.preventDefault(),e.stopPropagation(),(t==null?void 0:t.type)!=="geo-token")return;let{calcId:m}=this.controller.cachedGeoTokenInfo[t.identifier];if(!m)return;let h=this.controller.getItemModel(m);if(!Md(h))return;this.controller.convertToNamedAssignment(h),sa(h,""),this.controller.dispatch({type:"set-none-selected"}),this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:h.id}});return}if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return;if(i==="Esc"){e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-show-constructions-open",open:!1,setFocus:!0});return}if(i!=="Up"&&i!=="Down"&&i!=="Left"&&i!=="Right")return;e.preventDefault(),e.stopPropagation();let n=this.getObjectDepths();if(n.length===0)return;let a="";if(t&&t.type==="geo-token")a=t.identifier;else{let m=this.getTokensForDepth(n[0])[0];if(!m)return;a=m.identifier}if(a==="")return;let s,l=-1,c=[];for(s=0;s<n.length;s++){let m=n[s];if(c=this.getTokensForDepth(m),!!c&&(l=__dcg_shared_module_exports__['H'](c,{identifier:a}),l!==-1))break}if(s===-1||l===-1)return;i==="Up"?s=Math.max(s-1,0):i==="Down"?s=Math.min(s+1,n.length-1):i==="Left"?l=Math.max(l-1,0):i==="Right"&&(l=Math.min(l+1,c.length-1));let p=this.getTokensForDepth(n[s]);if(!p)return;l=Math.min(l,p.length-1);let u=p[l].identifier;this.controller.dispatch({type:"set-focus-location",location:{type:"geo-token",identifier:u}}),this.lastFocusedIdentifier=u}};var mr=__dcg_shared_module_exports__['h'](z());var ac=__dcg_shared_module_exports__['h'](z()),M0=__dcg_shared_module_exports__['h'](P4());var vL=/\{\$([a-zA-Z0-9\-]+([a-zA-Z0-9\-]+_)*[a-zA-Z0-9\-]+)\}/;function _4(r,e){let t=0,i=0,o={},n={},a=s(r);if(!/^<0>/.test(a)||!/<\/0>$/.test(a))throw new Error("Expected template string to start and end with <0> and </0>, but found "+JSON.stringify(a));return a.slice(3,-4).trim();function s(c){if(e.isConst(c))return tee(e.getConstValue(c));if(e.isNamedBinding(c)){let p=l(o,e.getBindingName(c)),u=`{$${p}}`;if(!vL.test(u))throw new Error(`Invalid <Localize> variable: ${u}.`);return e.addBinding&&e.addBinding(p,c),o[p]=!0,u}else if(c!==r&&e.isView(c)){let p=l(n,e.getViewName(c));if(!/[a-zA-Z0-9\-_]/.test(p))throw new Error(`Invalid <Localize> subview identifier: ${p}.`);return e.addView&&e.addView(p,c),n[p]=!0,`<${p}/>`}else if(e.isBinding(c)){let p=l(o,`v${t++}`),u=`{$${p}}`;return e.addBinding&&e.addBinding(p,c),o[p]=!0,u}else{let p=`${i++}`;e.addElement&&e.addElement(p,c);let u=[];return e.forEachChild(c,m=>{u.push(s(m))}),n[p]=!0,u.length>0?`<${p}>${u.join("")}</${p}>`:`<${p}/>`}}function l(c,p){let u=0,m=p;for(;c[m];)m=`${p}-${++u}`;return m}}var eee=!0;function tee(r){return eee?r:r.replace(/\{|\}/g,e=>`{"${e}"}`).replace(/(^|[\s\n]+)(\[|\]|\.)/g,(e,t,i)=>`${t}{"${i}"}`)}function ree(r){return r.__DCGViewLocalizeBindingName}function iee(r){return typeof r=="function"&&r.__DCGViewLocalizeViewName}var si=class extends ac.Class{init(){this.viewMap={},this.elementMap={},this.bindingMap={},this.i18n=this.props.i18n(),this.templateString=this.serializeToTemplateString(ac.createElement("div",null,this.children))}template(){return ac.createElement(ac.Components.If,{predicate:()=>this.shouldShow()},()=>ac.createElement(ac.Components.Switch,{key:()=>CL(this.translatedString())},e=>this.renderDeserializedTemplateNode(this.parseAndValidate(e))))}shouldShow(){let e=this.props.options&&this.props.options();return e&&e.hideUntranslatedView&&this.i18n.hasTranslation?this.i18n.hasTranslation(this.props.key()):!0}translatedString(){let e={};for(let t in this.bindingMap)e[t]=Ks(`{$${t}}`);return this.i18n.s(this.props.key(),e)}static variable(e,t){let i=()=>t();return i.__DCGViewLocalizeBindingName=e,i}static subview(e,t){let i=()=>t();return i.__DCGViewLocalizeViewName=e,i}parseAndValidate(e){let t=(0,M0.parse)(e),i={},o={};n(t);for(let a in this.elementMap)if(!o[a])return(0,M0.parse)(CL(this.templateString));for(let a in this.bindingMap)if(!i[a])return(0,M0.parse)(CL(this.templateString));return t;function n(a){if(Array.isArray(a)){for(let s of a)n(s);return}a.name==="token"?i[a.attrs.id]=!0:a.type!=="text"&&(o[a.name]=!0,n(a.children))}}renderDeserializedTemplateNode(e){if(Array.isArray(e))return e.map(t=>this.renderDeserializedTemplateNode(t));if(e.type==="text")return ac.const(e.content||"");if(e.name==="token"){let t=this.bindingMap[e.attrs.id];return t||(()=>"")}else if(this.elementMap[e.name]){let t=this.elementMap[e.name],i=e.children.map(o=>this.renderDeserializedTemplateNode(o));return R4(t.type,t.attrs,i)}else return this.viewMap[e.name]?this.viewMap[e.name]():R4("span",{},[])}serializeToTemplateString(e){return _4(e,{isView:iee,isConst:F4,isBinding:t=>typeof t=="function",isNamedBinding:ree,getConstValue:t=>t(),getBindingName:t=>t.__DCGViewLocalizeBindingName,getViewName:t=>t.__DCGViewLocalizeViewName,addBinding:(t,i)=>{this.bindingMap[t]=i},addElement:(t,i)=>{this.elementMap[t]={type:i.tagName,attrs:i.attrs}},addView:(t,i)=>{if(this.viewMap[t])throw new Error(`Unexpected duplicate view ${t}.`);this.viewMap[t]=i},forEachChild:(t,i)=>{for(let o of t.children){if(!F4(o)&&typeof o!="function"&&o._isDCGView)throw new Error("Bare DCGViews are not allowed inside <Localize>. Use Localize.subview().");i(o)}}})}};function F4(r){return typeof r=="function"&&r.isDCGViewConst}function R4(r,e,t){return ac.createElement(r,e,t)}function CL(r){return`<0>${r}</0>`.replace(new RegExp(vL.source,"g"),(t,i)=>`<token id="${i}"/>`)}var{If:N4}=mr.Components,A0=class extends mr.Class{template(){return mr.createElement(N4,{predicate:()=>this.props.controller().has3DNotice()},()=>mr.createElement("div",{class:mr.const("dcg-explist-3d-getting-started-container")},mr.createElement("aside",{class:mr.const("dcg-3d-getting-started-container")},mr.createElement("div",{class:mr.const("dcg-3d-getting-started")},mr.createElement("div",{class:mr.const("dcg-3d-background-image-left")}),mr.createElement("div",{class:mr.const("dcg-3d-background-image-right")}),mr.createElement("i",{class:mr.const("dcg-icon-remove"),role:mr.const("button"),tabindex:mr.const("0"),"aria-label":()=>wo("shared-button-close-message"),onTap:e=>this.props.controller().dispatch({type:"dismiss-3d-notice",focusFirstExpression:e.device==="keyboard"})}),mr.createElement("h2",{class:mr.const("dcg-3d-getting-started-title")},()=>this.props.controller().s("account-shell-text-welcome-to-3d")),mr.createElement("div",{class:mr.const("dcg-3d-getting-started-message")},mr.createElement(si,{i18n:this.props.controller,key:this.const("account-shell-text-3d-expression-list-notice")},mr.const("Please share any bugs, questions, or suggestions at:"),mr.const(" "),mr.createElement("a",{href:mr.const("mailto:feedback@desmos.com")},mr.const("feedback@desmos.com")))),mr.createElement("div",{class:mr.const("dcg-getting-started-footer-links")},mr.createElement(N4,{predicate:()=>!this.props.controller().isNarrow()},()=>mr.createElement("button",{class:mr.const("dcg-unstyled-button dcg-getting-started-primary-btn"),onTap:()=>{var e,t;return(t=(e=this.props.controller()).showQuestModal)==null?void 0:t.call(e)}},()=>this.props.controller().s("account-shell-link-try-a-quest"))),mr.createElement("a",{href:()=>"https://blog.desmos.com/articles/beta-3d-release/",target:mr.const("_blank"),class:mr.const("dcg-getting-started-secondary-btn")},()=>this.props.controller().s("account-shell-link-read-blog"),mr.createElement("span",{class:mr.const("dcg-sr-only")},()=>this.props.controller().s("shared-label-opens-in-new-tab"))))))))}};var nn=__dcg_shared_module_exports__['h'](z());var B4=__dcg_shared_module_exports__['h'](z());var Ko=class extends B4.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}getFocusedInput(){let e=this.controller.getFocusLocation(),t=this.model.type==="table-column"?this.model.table.id:this.id;if(!(!e||e.type!=="expression-menu"||e.id!==t))return e.location}handleFocusedChanged(e,t){let i=this.model.type==="table-column"?this.model.table.id:this.id;e?this.controller.dispatch({type:"set-focus-location",location:{type:"expression-menu",id:i,location:t}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"expression-menu",id:i,location:t}})}onColorSelected(e){this.model.type!=="image"&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-color",id:this.id,color:e}):this.controller.dispatch({type:"set-tablecolumn-color",color:e,tableId:this.model.table.id,columnId:this.id}))}onCustomColorSelected(e){this.model.type!=="image"&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-colorlatex",id:this.id,colorLatex:e}):this.controller.dispatch({type:"set-tablecolumn-colorlatex",tableId:this.model.table.id,columnId:this.model.id,colorLatex:e}))}getModelColor(){return this.model.type==="image"?"":Nc(this.model)}};var Ur=__dcg_shared_module_exports__['h'](z());var su=__dcg_shared_module_exports__['h'](z()),Ui=class extends su.Class{template(){return su.createElement("div",{class:()=>({"dcg-toggle-view":!0,"dcg-toggled":this.props.toggled()}),"aria-label":()=>this.props.ariaLabel(),role:su.const("checkbox"),tabindex:su.const("0"),"aria-checked":()=>this.props.toggled(),toggled:()=>this.props.toggled(),onTap:this.bindFn(this.props.onChange)},su.createElement("div",{class:su.const("dcg-toggle-switch")}))}};var{If:DL}=Ur.Components,Mb=class extends Ko{template(){return Ur.createElement("div",{class:Ur.const("dcg-options-menu-section")},Ur.createElement("div",{class:Ur.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-lines"),Ur.createElement(Ui,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-lines-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleLinesVisible)})),Ur.createElement(DL,{predicate:()=>this.props.isOpen()},()=>Ur.createElement("div",{class:Ur.const("dcg-options-menu-content")},Ur.createElement("div",{class:Ur.const("dcg-options-flex-container")},Ur.createElement("div",{class:Ur.const("dcg-options-left-side")},Ur.createElement("div",{class:Ur.const("dcg-iconed-mathquill-row dcg-line-opacity-row")},Ur.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-opacity-tooltip"),sticky:this.const(!0),gravity:this.const("s")},Ur.createElement("i",{class:Ur.const("dcg-icon-opacity"),"aria-hidden":Ur.const("true")})),Ur.createElement(ir,{latex:()=>this.model.lineOpacity,placeholder:this.bindFn(this.getLineOpacity),isFocused:()=>this.getFocusedInput()==="lineopacity",ariaPostLabel:()=>this.isLineOpacityValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-line-opacity"),hasError:()=>!this.isLineOpacityValid(),handleLatexChanged:this.bindFn(this.dispatchLineOpacityLatexIfChanged),dataLabelAttributeValue:this.const("line-opacity"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"lineopacity")})),Ur.createElement("div",{class:Ur.const("dcg-iconed-mathquill-row dcg-line-thickness-row")},Ur.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-line-thickness-tooltip"),sticky:this.const(!0),gravity:this.const("s")},Ur.createElement("i",{class:Ur.const("dcg-icon-line-thickness"),"aria-hidden":Ur.const("true")})),Ur.createElement(ir,{latex:()=>this.model.lineWidth,placeholder:this.bindFn(this.getLineWidth),isFocused:()=>this.getFocusedInput()==="linewidth",ariaPostLabel:()=>this.isLineWidthValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-label-line-thickness-tooltip"),hasError:()=>!this.isLineWidthValid(),handleLatexChanged:this.bindFn(this.dispatchLineWidthLatexIfChanged),dataLabelAttributeValue:this.const("line-width"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"linewidth")}))),Ur.createElement("div",{class:Ur.const("dcg-options-right-side")},Ur.createElement(DL,{predicate:this.bindFn(this.shouldShowLineStyles)},()=>Ur.createElement(_r,{staticConfig:this.bindFn(this.getPointStyleOptions),ariaGroupLabel:()=>this.controller.s("graphing-calculator-heading-style"),theme:this.const("mini")})))),Ur.createElement(DL,{predicate:this.props.isFirstOpenSection},()=>Ur.createElement(Wn,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected)})))))}getLineWidth(){return this.isGeometryPolygon()?""+2:""+2.5}getLineOpacity(){return this.isGeometryPolygon()?""+.6:""+.9}isGeometryPolygon(){return this.controller.isGeometry()&&this.model.type==="expression"&&Ad(this.model)}getPointStyleOptions(){return["SOLID","DASHED","DOTTED"].map(t=>({key:t,icon:()=>this.getStyleIcon(t),ariaLabel:()=>this.getStyleAria(t),selected:()=>this.model.lineStyle===t,class:()=>"dcg-line-segmented-option",onSelect:()=>{this.onLineStyleSelected(t)}}))}getStyleIcon(e){switch(e){case"SOLID":return"dcg-icon-line-solid";case"DASHED":return"dcg-icon-line-dashed";case"DOTTED":return"dcg-icon-line-dotted"}}getStyleAria(e){let t=this.controller.s;switch(e){case"SOLID":return t("graphing-calculator-narration-line-style-solid");case"DASHED":return t("graphing-calculator-narration-line-style-dashed");case"DOTTED":return t("graphing-calculator-narration-line-style-dotted")}}isLineOpacityValid(){return this.model.type==="expression"?SN(this.model):this.model.type==="table-column"?E5(this.model):!1}isLineWidthValid(){return this.model.type==="expression"?RS(this.model):this.model.type==="table-column"?G5(this.model):!1}dispatchLineOpacityLatexIfChanged(e){this.model.lineOpacity!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-lineopacity",id:this.id,lineOpacity:e}):this.controller.dispatch({type:"set-tablecolumn-lineopacity",tableId:this.model.table.id,columnId:this.model.id,lineOpacity:e}))}shouldShowLineStyles(){return!(this.model.type==="expression"&&Ld(this.model))}onLineStyleSelected(e){this.model.lineStyle!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-linestyle",id:this.id,lineStyle:e}):this.controller.dispatch({type:"set-tablecolumn-linestyle",tableId:this.model.table.id,columnId:this.model.id,lineStyle:e}))}dispatchLineWidthLatexIfChanged(e){this.model.lineWidth!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-linewidth",id:this.id,lineWidth:e}):this.controller.dispatch({type:"set-tablecolumn-linewidth",tableId:this.model.table.id,columnId:this.model.id,lineWidth:e}))}toggleLinesVisible(){this.model.type==="expression"?this.controller.dispatch({type:"set-item-lines",id:this.id,lines:!this.props.isOpen()}):this.controller.dispatch({type:"set-tablecolumn-lines",tableId:this.model.table.id,columnId:this.model.id,bool:!this.props.isOpen()})}};var Mv=__dcg_shared_module_exports__['h'](z());var L0=class extends Ko{template(){return Mv.createElement("div",{class:Mv.const("dcg-options-menu-section")},Mv.createElement(Wn,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected),hideCustomColors:()=>this.model.type==="expression"&&wf(this.model)}))}};var vn=__dcg_shared_module_exports__['h'](z());var{If:SL}=vn.Components,O0=class extends Ko{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return vn.createElement("div",{class:vn.const("dcg-options-menu-section")},vn.createElement("div",{class:vn.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-fill"),vn.createElement(SL,{predicate:()=>!this.isInequality()},()=>vn.createElement(Ui,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-fill-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleFillVisible)}))),vn.createElement(SL,{predicate:this.props.isOpen},()=>vn.createElement("div",{class:vn.const("dcg-options-menu-content")},vn.createElement("div",{class:vn.const("dcg-iconed-mathquill-row dcg-fill-opacity-row")},vn.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-opacity-tooltip"),sticky:this.const(!0),gravity:this.const("s")},vn.createElement("i",{class:vn.const("dcg-icon-opacity"),"aria-hidden":vn.const("true")})),vn.createElement(ir,{latex:()=>this.model.fillOpacity,placeholder:this.bindFn(this.getFillOpacity),isFocused:()=>this.getFocusedInput()==="opacity",ariaPostLabel:()=>z1(this.model)?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-fill-opacity"),hasError:()=>!z1(this.model),handleLatexChanged:this.bindFn(this.dispatchOpacityLatexIfChanged),dataLabelAttributeValue:this.const("fill-opacity"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"opacity")})),vn.createElement(SL,{predicate:this.props.isFirstOpenSection},()=>vn.createElement(Wn,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected)})))))}getFillOpacity(){return this.controller.isGeometry()&&Ad(this.model)?""+.2:""+.4}isInequality(){return Ld(this.model)}toggleFillVisible(){this.controller.dispatch({type:"set-item-fill",id:this.id,fill:!this.props.isOpen()})}dispatchOpacityLatexIfChanged(e){this.model.fillOpacity!==e&&this.controller.dispatch({type:"set-item-fillopacity",id:this.id,fillOpacity:e})}};var Hr=__dcg_shared_module_exports__['h'](z());var $t=__dcg_shared_module_exports__['h'](z());var{If:q4,Switch:K4}=$t.Components,P0=class extends $t.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return $t.createElement("div",{class:$t.const("dcg-clickable-image-info-view"),role:$t.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-clickable-image-options")},$t.createElement("div",{class:$t.const("dcg-clickable-image-state-container")},$t.createElement(Me,{tooltip:()=>this.tooltip("hovered"),gravity:this.const("s")},$t.createElement(ou,{controller:()=>this.controller,ariaLabel:()=>this.tooltip("hovered"),onFileChange:e=>this.updateImage("hovered",e),readonly:()=>this.controller.isItemReadonly(this.id)},$t.createElement(K4,{key:this.bindFn(this.hoveredStatus)},()=>$t.createElement("div",{class:$t.const("dcg-clickable-image-state"),style:()=>this.getStyleForState("hovered")})))),$t.createElement(q4,{predicate:()=>!!this.model.clickableInfo.hoveredImage},()=>$t.createElement("div",{class:$t.const("dcg-clickable-image-state-close"),onTap:()=>this.removeImageState("hovered"),ariaLabel:()=>this.controller.s("graphing-calculator-label-remove-hovered-image"),role:$t.const("button"),tabIndex:$t.const(0)},$t.createElement("i",{class:$t.const("dcg-icon-remove"),"aria-hidden":$t.const("true")}))),$t.createElement("div",{role:$t.const("heading"),"aria-level":$t.const("2"),class:$t.const("dcg-clickable-image-label")},()=>this.controller.s("graphing-calculator-label-hovered"))),$t.createElement("div",{class:$t.const("dcg-clickable-image-state-container")},$t.createElement(Me,{tooltip:()=>this.tooltip("depressed"),gravity:this.const("s")},$t.createElement(ou,{controller:()=>this.controller,ariaLabel:()=>this.tooltip("depressed"),onFileChange:e=>this.updateImage("depressed",e),readonly:()=>this.controller.isItemReadonly(this.id)},$t.createElement(K4,{key:this.bindFn(this.depressedStatus)},()=>$t.createElement("div",{class:$t.const("dcg-clickable-image-state"),style:()=>this.getStyleForState("depressed")})))),$t.createElement(q4,{predicate:()=>!!this.model.clickableInfo.depressedImage},()=>$t.createElement("div",{class:$t.const("dcg-clickable-image-state-close"),onTap:()=>this.removeImageState("depressed"),ariaLabel:()=>this.controller.s("graphing-calculator-label-remove-depressed-image"),role:$t.const("button"),tabIndex:$t.const(0)},$t.createElement("i",{class:$t.const("dcg-icon-remove"),"aria-hidden":$t.const("true")}))),$t.createElement("div",{role:$t.const("heading"),"aria-level":$t.const("2"),class:$t.const("dcg-clickable-image-label")},()=>this.controller.s("graphing-calculator-label-depressed"))))}hoveredStatus(){return this.hoveredUploading?"loading":"background"}depressedStatus(){return this.depressedUploading?"loading":"background"}tooltip(e){return(e==="hovered"?this.model.clickableInfo.hoveredImage:this.model.clickableInfo.depressedImage)?e==="depressed"?this.controller.s("graphing-calculator-label-change-depressed-image-tooltip"):this.controller.s("graphing-calculator-label-change-hovered-image-tooltip"):e==="depressed"?this.controller.s("graphing-calculator-label-add-depressed-image-tooltip"):this.controller.s("graphing-calculator-label-add-hovered-image-tooltip")}getImageURLForState(e){let t;if(e==="hovered"){if(this.hoveredStatus()!=="background")return"";t="hoveredImage"}else{if(this.depressedStatus()!=="background")return"";t="depressedImage"}let i=this.model.clickableInfo[t];return i?`url(${i})`:`url(${this.model.image_url})`}getStyleForState(e){let t={"background-image":this.getImageURLForState(e),opacity:1};return e==="hovered"&&!this.model.clickableInfo.hoveredImage&&(t.opacity=.5),t}removeImageState(e){e==="hovered"?this.controller.dispatch({type:"set-hovered-image",id:this.model.id,url:""}):this.controller.dispatch({type:"set-depressed-image",id:this.model.id,url:""})}updateImage(e,t){if(!t||!t[0])return;let i=t[0];e==="hovered"&&(this.hoveredUploading=!0),e==="depressed"&&(this.depressedUploading=!0),this.controller.getGraphSettings().config.imageUploadCallback(i,(o,n)=>{e==="hovered"&&(this.hoveredUploading=!1),e==="depressed"&&(this.depressedUploading=!1),!o&&n&&(e==="hovered"?this.controller.dispatch({type:"set-hovered-image",id:this.model.id,url:n}):this.controller.dispatch({type:"set-depressed-image",id:this.model.id,url:n}))})}};var{If:_0,IfDefined:aee,Textarea:see}=Hr.Components,Ab=class extends Ko{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return Hr.createElement("div",{class:Hr.const("dcg-options-menu-section dcg-clickable-section")},Hr.createElement("div",{class:Hr.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-clickable"),Hr.createElement(Ui,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-make-clickable"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleClickable)})),Hr.createElement(_0,{predicate:this.props.isOpen},()=>Hr.createElement("div",{class:Hr.const("dcg-options-menu-content")},Hr.createElement("div",{class:Hr.const("dcg-clickable-menu-row")},Hr.createElement("span",{class:Hr.const("dcg-input-label")},()=>this.controller.s("graphing-calculator-label-update-on-click")),Hr.createElement(_e,{latex:()=>this.model.clickableInfo.latex,placeholder:this.const(""),isFocused:()=>this.getFocusedInput()==="updaterule",capExpressionSize:()=>!!this.controller.getGraphSettings().config.capExpressionSize,selectOnFocus:this.const(!0),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.controller.s("graphing-calculator-narration-click-action"),getAriaPostLabel:this.const(""),hasError:()=>this.hasError(),onUserChangedLatex:e=>this.dispatchUpdateRuleLatexIfChanged(e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:e=>this.handleFocusedChanged(e,"updaterule"),dataLabelAttributeValue:this.const("click-handler"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled()}),aee(()=>this.packedError(),e=>Hr.createElement("span",{class:Hr.const("dcg-clickable-info-error-container")},Hr.createElement(pa,{error:()=>this.controller.unpack(e()),gravity:this.const("s"),size:this.const("small")})))),Hr.createElement(_0,{predicate:this.bindFn(this.isList)},()=>Hr.createElement("div",{class:Hr.const("dcg-clickable-list-index-notice")},Hr.createElement(si,{i18n:this.const(this.controller),key:this.const("graphing-calculator-label-list-index")},Hr.const("Use"),Hr.const(" "),Hr.createElement("span",{class:()=>({"dcg-index-variable-marker":!0,"dcg-btn":!0,"dcg-btn-light-gray":!0,"dcg-mathquill-has-focus":this.getFocusedInput()==="updaterule","dcg-do-not-blur":!0}),onTap:this.bindFn(this.insertIndex)},Hr.const("index")),Hr.const(" "),Hr.const("to reference the clicked index in the list.")))),Hr.createElement(_0,{predicate:()=>this.model.type!=="image"},()=>Hr.createElement(see,{placeholder:()=>this.controller.s("graphing-calculator-text-add-screen-reader-label-placeholder"),value:()=>this.model.description,onInput:e=>this.controller.dispatch({type:"set-item-description",id:this.model.id,description:e})})),Hr.createElement(_0,{predicate:()=>this.model.type==="image"},()=>Hr.createElement("div",{class:Hr.const("dcg-clickable-menu-row")},Hr.createElement(P0,{controller:()=>this.controller,model:()=>this.model}))))))}insertIndex(){this.controller.dispatch({type:"keypad/type-text",text:"index"})}isList(){return this.model.formula?!!this.model.formula.is_concrete_list:!1}hasError(){return this.packedError()!==void 0}packedError(){if(this.model.formula.click_handler&&this.model.formula.click_handler.status==="error")return this.model.formula.click_handler.error}toggleClickable(){this.controller.dispatch({type:"set-clickableinfo-prop",id:this.model.id,prop:"enabled",value:!this.model.clickableInfo.enabled}),this.model.clickableInfo.enabled&&this.handleFocusedChanged(!0,"updaterule")}dispatchUpdateRuleLatexIfChanged(e){this.model.clickableInfo.latex!==e&&this.controller.dispatch({type:"set-clickableinfo-rule-latex",id:this.id,latex:e})}getMQConfig(){return this.controller.getMathquillConfig({additionalOperators:["index"]})}};var Ti=__dcg_shared_module_exports__['h'](z());var lu=__dcg_shared_module_exports__['h'](z());var Lb=class extends Ko{template(){return lu.createElement("div",{class:lu.const("dcg-iconed-mathquill-row dcg-point-opacity-row")},lu.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-opacity-tooltip"),sticky:this.const(!0),gravity:this.const("s")},lu.createElement("i",{class:lu.const("dcg-icon-opacity"),"aria-hidden":lu.const("true")})),lu.createElement(ir,{latex:()=>this.model.pointOpacity,placeholder:this.bindFn(this.getPointOpacityPlaceholder),isFocused:()=>this.getFocusedInput()==="pointopacity",ariaPostLabel:()=>this.isPointOpacityValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-line-opacity"),hasError:()=>!this.isPointOpacityValid(),handleLatexChanged:this.bindFn(this.dispatchPointOpacityLatexIfChanged),dataLabelAttributeValue:this.const("point-opacity"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"pointopacity")}))}isPointOpacityValid(){return this.model.type==="expression"?kN(this.model):this.model.type==="table-column"?I5(this.model):!1}dispatchPointOpacityLatexIfChanged(e){this.model.pointOpacity!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-pointopacity",id:this.id,pointOpacity:e}):this.controller.dispatch({type:"set-tablecolumn-pointopacity",columnId:this.model.id,tableId:this.model.table.id,pointOpacity:e}))}getPointOpacityPlaceholder(){return this.getDragMode()==="NONE"?`${.9}`:"1"}getDragMode(){return this.model.type==="expression"?Gi(this.model)||this.model.dragMode:this.model.dragMode}};var{If:F0}=Ti.Components,Ob=class extends Ko{template(){return Ti.createElement("div",{class:Ti.const("dcg-options-menu-section")},Ti.createElement("div",{class:Ti.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-points"),Ti.createElement(Ui,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-points-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.togglePointsVisible)})),Ti.createElement(F0,{predicate:this.props.isOpen},()=>Ti.createElement("div",{class:Ti.const("dcg-options-menu-content")},Ti.createElement("div",{class:Ti.const("dcg-options-flex-container")},Ti.createElement("div",{class:Ti.const("dcg-options-left-side")},Ti.createElement(Lb,__dcg_shared_module_exports__['a']({},this.props)),Ti.createElement(F0,{predicate:()=>!this.isDraggable()},()=>Ti.createElement("div",{class:Ti.const("dcg-iconed-mathquill-row")},Ti.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-point-size-tooltip"),gravity:this.const("s"),sticky:this.const(!0)},Ti.createElement("i",{class:Ti.const("dcg-icon-line-thickness"),"aria-hidden":Ti.const("true")})),Ti.createElement(ir,{latex:()=>this.model.pointSize,placeholder:this.bindFn(this.getDefaultPointSize),isFocused:()=>this.getFocusedInput()==="pointsize",ariaPostLabel:()=>this.isPointSizeValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-point-size"),hasError:()=>!this.isPointSizeValid(),handleLatexChanged:e=>this.dispatchPointSizeLatexIfChanged(e),dataLabelAttributeValue:this.const("point-size"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"pointsize")})))),Ti.createElement("div",{class:Ti.const("dcg-options-right-side")},Ti.createElement(F0,{predicate:()=>!this.isDraggable()},()=>Ti.createElement(_r,{staticConfig:this.bindFn(this.getPointStyleOptions),ariaGroupLabel:()=>this.controller.s("graphing-calculator-heading-style"),theme:this.const("mini")})))),Ti.createElement(F0,{predicate:this.props.isFirstOpenSection},()=>Ti.createElement(Wn,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected)})))))}getPointStyleOptions(){return["POINT","OPEN","CROSS"].map(t=>({key:t,icon:()=>this.getStyleIcon(t),ariaLabel:()=>this.getStyleAria(t),selected:()=>this.model.pointStyle===t,class:()=>"dcg-point-segmented-option",onSelect:()=>{this.onPointStyleSelected(t)}}))}getStyleIcon(e){switch(e){case"POINT":return"dcg-icon-point";case"OPEN":return"dcg-icon-open";case"CROSS":return"dcg-icon-cross"}}getStyleAria(e){let t=this.controller.s;switch(e){case"POINT":return t("graphing-calculator-narration-point-style-point");case"OPEN":return t("graphing-calculator-narration-point-style-open");case"CROSS":return t("graphing-calculator-narration-point-style-cross")}}isPointSizeValid(){return this.model.type==="expression"?FS(this.model):this.model.type==="table-column"?T5(this.model):!1}onPointStyleSelected(e){this.model.pointStyle!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-pointstyle",id:this.id,pointStyle:e}):this.controller.dispatch({type:"set-tablecolumn-pointstyle",columnId:this.model.id,tableId:this.model.table.id,pointStyle:e}))}dispatchPointSizeLatexIfChanged(e){this.model.pointSize!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-pointsize",id:this.id,pointSize:e}):this.controller.dispatch({type:"set-tablecolumn-pointsize",columnId:this.model.id,tableId:this.model.table.id,pointSize:e}))}isDraggable(){return this.getDragMode()!=="NONE"}togglePointsVisible(){this.model.type==="expression"&&es(this.model)?this.controller.dispatch({type:"toggle-item-hidden",id:this.model.id}):this.model.type==="expression"?this.controller.dispatch({type:"set-item-points",id:this.id,points:!this.props.isOpen()}):this.controller.dispatch({type:"set-tablecolumn-points",columnId:this.model.id,tableId:this.model.table.id,bool:!this.props.isOpen()})}getDragMode(){return this.model.type==="expression"?Gi(this.model)||this.model.dragMode:this.model.dragMode}getDefaultPointSize(){return this.model.type==="expression"&&Bp(this.model)?`${14}`:`${9}`}};var Jt=__dcg_shared_module_exports__['h'](z());var Ta=__dcg_shared_module_exports__['h'](z());var{For:cee}=Ta.Components,dee=[{orientation:"default",cssClass:"dcg-label-orientation-center",description:"graphing-calculator-text-label-orientation-default"},{orientation:"above",cssClass:"dcg-label-orientation-above",description:"graphing-calculator-text-label-orientation-above"},{orientation:"above_right",cssClass:"dcg-label-orientation-above-right",description:"graphing-calculator-text-label-orientation-above-right"},{orientation:"right",cssClass:"dcg-label-orientation-right",description:"graphing-calculator-text-label-orientation-right"},{orientation:"below_right",cssClass:"dcg-label-orientation-below-right",description:"graphing-calculator-text-label-orientation-below-right"},{orientation:"below",cssClass:"dcg-label-orientation-below",description:"graphing-calculator-text-label-orientation-below"},{orientation:"below_left",cssClass:"dcg-label-orientation-below-left",description:"graphing-calculator-text-label-orientation-below-left"},{orientation:"left",cssClass:"dcg-label-orientation-left",description:"graphing-calculator-text-label-orientation-left"},{orientation:"above_left",cssClass:"dcg-label-orientation-above-left",description:"graphing-calculator-text-label-orientation-above-left"}],R0=class extends Ta.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return Ta.createElement("div",{class:Ta.const("dcg-label-orientation-view"),style:()=>`transform: rotate(${this.getCSSRotationValue()});`},Ta.createElement("span",{class:Ta.const("dcg-vertical-orientation-indicator")}),Ta.createElement(cee,{each:()=>dee,key:e=>e.orientation},Ta.createElement("div",{class:Ta.const("dcg-label-orientations"),role:Ta.const("radiogroup"),"aria-label":()=>this.controller.s("graphing-calculator-heading-label-orientation")},e=>Ta.createElement("div",{class:()=>({[e.cssClass]:!0,"dcg-orientation-option":!0,"dcg-selected":this.isSelected(e.orientation),"dcg-orientation-disabled":this.isDisabled(e.orientation)}),role:Ta.const("radio"),tabindex:Ta.const("0"),"aria-label":()=>this.controller.s(e.description),"aria-checked":()=>this.getOrientation()===e.orientation,onTap:()=>this.onTapOrientation(e.orientation)},Ta.createElement("i",{class:()=>({"dcg-icon-chevron-left":e.orientation!=="default"})})))))}isDisabled(e){return e!=="default"?!1:this.isPointVisible()?!0:this.model.labelOrientation==="default"}isSelected(e){return e==="default"&&e===this.model.labelOrientation?!this.isPointVisible():e===this.model.labelOrientation}isPointVisible(){return this.model.hidden?!1:es(this.model)?!this.model.hidden:this.model.points}getCSSRotationValue(){let e=IN(this.model);return`${Array.isArray(e)?0:e}rad`}getOrientation(){return this.props.model().labelOrientation}onTapOrientation(e){e===this.getOrientation()&&(e="default"),this.controller.dispatch({type:"set-item-label-orientation",id:this.id,labelOrientation:e})}};var{If:Pb}=Jt.Components,N0=class extends Ko{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return Jt.createElement("div",{class:Jt.const("dcg-options-menu-section")},Jt.createElement("div",{class:Jt.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-label"),Jt.createElement(Ui,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-label-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleLabelVisible)})),Jt.createElement(Pb,{predicate:this.props.isOpen},()=>Jt.createElement("div",{class:Jt.const("dcg-options-menu-content")},Jt.createElement("div",{class:Jt.const("dcg-options-flex-container")},Jt.createElement("div",{class:Jt.const("dcg-options-left-side")},Jt.createElement(Pb,{predicate:this.props.isFirstOpenSection},()=>Jt.createElement(Lb,__dcg_shared_module_exports__['a']({},this.props))),Jt.createElement("div",{class:Jt.const("dcg-iconed-mathquill-row dcg-label-size-row")},Jt.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-label-size-tooltip"),sticky:this.const(!0),gravity:this.const("s")},Jt.createElement("span",{class:Jt.const("dcg-font-size")},Jt.const("A"))),Jt.createElement(ir,{latex:()=>this.model.labelSize,placeholder:()=>"1",isFocused:()=>this.getFocusedInput()==="labelsize",ariaPostLabel:()=>U1(this.model)?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-label-size"),hasError:()=>!U1(this.model),handleLatexChanged:this.bindFn(this.dispatchLabelSizeIfChanged),dataLabelAttributeValue:this.const("label-size"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"labelsize")})),Jt.createElement("div",{class:()=>({"dcg-iconed-mathquill-row":!0,"dcg-label-angle-row":!0,"dcg-suffix-degree":this.props.controller().getGraphSettings().degreeMode,"dcg-suffix-radian":!this.props.controller().getGraphSettings().degreeMode})},Jt.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-angle-tooltip"),sticky:this.const(!0)},Jt.createElement("i",{class:Jt.const("dcg-icon-angle"),"aria-hidden":Jt.const("true")})),Jt.createElement(ir,{latex:()=>this.model.labelAngle,placeholder:()=>"0",isFocused:()=>this.getFocusedInput()==="labelangle",ariaPostLabel:()=>H1(this.model)?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-label-angle"),hasError:()=>!H1(this.model),handleLatexChanged:this.bindFn(this.dispatchLabelAngleIfChanged),dataLabelAttributeValue:this.const("label-angle"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"labelangle")}))),Jt.createElement("div",{class:Jt.const("dcg-options-right-side")},Jt.createElement(R0,{controller:()=>this.controller,model:()=>this.model}))),Jt.createElement(Pb,{predicate:this.props.isFirstOpenSection},()=>Jt.createElement(Wn,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected)})),Jt.createElement(Pb,{predicate:()=>this.controller.canUseAdvancedStyling()},()=>Jt.createElement("div",{class:Jt.const("dcg-label-advanced")},Jt.createElement(st,{checked:this.bindFn(this.getWhiteTextOutline),onChange:this.bindFn(this.setWhiteTextOutline),disabled:()=>this.getEditable()},()=>this.controller.s("graphing-calculator-button-label-text-outline")),Jt.createElement("div",{role:Jt.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-heading-advanced")},Jt.createElement(Pb,{predicate:()=>this.shouldShowHoverLabelCheckbox()},()=>Jt.createElement(st,{checked:this.bindFn(this.getInteractiveLabel),onChange:this.bindFn(this.setInteractiveLabel)},()=>this.controller.s("graphing-calculator-button-label-show-on-hover"))),Jt.createElement(Pb,{predicate:this.bindFn(this.shouldShowEditableLabelToggle)},()=>Jt.createElement(st,{checked:this.bindFn(this.getEditable),onChange:this.bindFn(this.setEditable)},()=>this.controller.s("graphing-calculator-button-label-editable")))))))))}getWhiteTextOutline(){return this.getEditable()?!1:!this.model.suppressTextOutline}setWhiteTextOutline(e){this.controller.dispatch({type:"set-suppress-text-outline",id:this.id,suppressTextOutline:!e})}setInteractiveLabel(e){this.controller.dispatch({type:"set-item-interactive-label",id:this.id,interactiveLabel:e})}getInteractiveLabel(){return!!this.model.interactiveLabel}setEditable(e){if(e){let t=__dcg_shared_module_exports__['ud'](this.model.label)==="latex"?"MATH":"TEXT";this.controller.dispatch({type:"set-item-editable-label-mode",id:this.id,editableLabelMode:t})}else this.controller.dispatch({type:"set-item-editable-label-mode",id:this.id,editableLabelMode:"NONE"})}getEditable(){return this.model.editableLabelMode!=="NONE"}shouldShowEditableLabelToggle(){return es(this.model)}shouldShowHoverLabelCheckbox(){return Gi(this.model)==="NONE"}dispatchLabelAngleIfChanged(e){this.model.labelAngle!==e&&this.controller.dispatch({type:"set-item-labelangle",id:this.id,labelAngle:e})}dispatchLabelSizeIfChanged(e){this.model.labelSize!==e&&this.controller.dispatch({type:"set-item-labelSize",id:this.id,labelSize:e})}toggleLabelVisible(){this.controller.dispatch({type:"set-item-showlabel",id:this.id,showLabel:!this.props.isOpen()})}};var fa=__dcg_shared_module_exports__['h'](z());var{If:pee,For:uee}=fa.Components,_b=class extends Ko{template(){return fa.createElement("div",{class:fa.const("dcg-options-menu-section")},fa.createElement("div",{class:fa.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-drag"),fa.createElement(Ui,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-menu-drag-enabled"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleDragEnabled)})),fa.createElement(pee,{predicate:this.props.isOpen},()=>fa.createElement("div",{class:fa.const("dcg-options-menu-content")},fa.createElement(uee,{each:()=>["X","Y","XY"]},fa.createElement("div",{class:fa.const("dcg-style-icons"),role:fa.const("radiogroup")},e=>fa.createElement("div",{class:()=>({"dcg-style-icon-container":!0,"dcg-disabled":this.isDisabled(e)}),onTap:()=>this.onDragModeSelected(e),role:fa.const("radio"),tabindex:()=>this.isDisabled(e)?-1:0,"aria-label":()=>e==="X"?this.controller.s("graphing-calculator-narration-drag-mode-x"):e==="Y"?this.controller.s("graphing-calculator-narration-drag-mode-y"):e==="XY"?this.controller.s("graphing-calculator-narration-drag-mode-xy"):this.controller.raw(""),"aria-checked":()=>this.getDragMode()===e},fa.createElement(xn,{backgroundColor:()=>({type:"single-color",value:"#000"}),semiTransparent:()=>this.getDragMode()!==e,iconType:()=>e==="X"?"movable-horizontal":e==="Y"?"movable-vertical":"movable-both"})))))))}isDisabled(e){let t=this.controller.getEnabledDragModesForItem(this.id);return!__dcg_shared_module_exports__['w'](t,e)}onDragModeSelected(e){if(this.model.type==="expression"){if(this.isDisabled(e))return;this.controller.dispatch({type:"set-item-dragmode",id:this.id,dragMode:e})}else{let t=this.model.id,i=this.model.table.id;this.controller.dispatch({type:"set-tablecolumn-dragmode",tableId:i,columnId:t,dragMode:e})}}getDragMode(){return this.model.type==="expression"?Gi(this.model)||this.model.dragMode:this.model.dragMode}toggleDragEnabled(){let e=this.getDragMode()!=="NONE"?"NONE":"XY";this.model.type==="expression"?this.controller.dispatch({type:"set-item-dragmode",id:this.id,dragMode:e}):this.onDragModeSelected(e)}};var Jn=__dcg_shared_module_exports__['h'](z());var{If:gee}=Jn.Components,B0=class extends Ko{template(){return Jn.createElement("div",{class:Jn.const("dcg-options-menu-section")},Jn.createElement("div",{class:Jn.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-points"),Jn.createElement(Ui,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-points-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.togglePointsVisible)})),Jn.createElement(gee,{predicate:()=>this.props.isOpen()},()=>Jn.createElement("div",{class:Jn.const("dcg-options-menu-content")},Jn.createElement("div",{class:Jn.const("dcg-iconed-mathquill-row dcg-line-thickness-row-3d")},Jn.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-point-size-3d-tooltip"),gravity:this.const("s"),sticky:this.const(!0)},Jn.createElement("i",{class:Jn.const("dcg-icon-line-thickness"),"aria-hidden":Jn.const("true")})),Jn.createElement(ir,{latex:()=>this.model.pointSize,placeholder:this.bindFn(this.getDefaultPointSize),isFocused:()=>this.getFocusedInput()==="pointsize",ariaPostLabel:()=>this.isPointSizeValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-point-size"),hasError:()=>!this.isPointSizeValid(),handleLatexChanged:e=>this.dispatchPointSizeLatexIfChanged(e),dataLabelAttributeValue:this.const("point-size"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"pointsize")})),Jn.createElement(Wn,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected),hideCustomColors:()=>!1,hideColorFunctions:()=>!0}))))}togglePointsVisible(){this.controller.dispatch({type:"set-item-points",id:this.id,points:!this.props.isOpen()})}isPointSizeValid(){return this.model.type==="expression"?FS(this.model):!1}dispatchPointSizeLatexIfChanged(e){this.model.pointSize!==e&&this.model.type==="expression"&&this.controller.dispatch({type:"set-item-pointsize",id:this.id,pointSize:e})}getDefaultPointSize(){return`${3}`}};var So=__dcg_shared_module_exports__['h'](z());var{If:kL}=So.Components,q0=class extends Ko{template(){return So.createElement("div",{class:So.const("dcg-options-menu-section")},So.createElement("div",{class:So.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-lines"),So.createElement(Ui,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-lines-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleLinesVisible)})),So.createElement(kL,{predicate:()=>this.props.isOpen()},()=>So.createElement("div",{class:So.const("dcg-options-menu-content")},So.createElement("div",{class:So.const("dcg-iconed-mathquill-row dcg-line-thickness-row-3d")},So.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-line-thickness-3d-tooltip"),sticky:this.const(!0),gravity:this.const("s")},So.createElement("i",{class:So.const("dcg-icon-line-thickness"),"aria-hidden":So.const("true")})),So.createElement(ir,{latex:()=>this.model.lineWidth,placeholder:()=>`${1}`,isFocused:()=>this.getFocusedInput()==="linewidth",ariaPostLabel:()=>this.isLineWidthValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-label-line-thickness-3d-tooltip"),hasError:()=>!this.isLineWidthValid(),handleLatexChanged:this.bindFn(this.dispatchLineWidthLatexIfChanged),dataLabelAttributeValue:this.const("line-width"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"linewidth")})),So.createElement(kL,{predicate:()=>!Ax(this.model)&&!Lx(this.model)&&!!Pr("beta3d")},()=>So.createElement("div",{style:So.const("font-size:85%; margin-top:8px; margin-bottom: 8px")},So.const("Resolution:"),So.createElement(ir,{latex:()=>this.model.resolution,placeholder:()=>`${__dcg_shared_module_exports__['xc']}`,isFocused:()=>this.getFocusedInput()==="resolution",ariaPostLabel:()=>this.isResolutionValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-label-resolution-tooltip"),hasError:()=>!this.isResolutionValid(),handleLatexChanged:this.bindFn(this.dispatchResolutionLatexIfChanged),dataLabelAttributeValue:this.const("resolution"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"resolution")}))),So.createElement(kL,{predicate:this.props.isFirstOpenSection},()=>So.createElement(Wn,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected),hideCustomColors:()=>!1})))))}toggleLinesVisible(){this.controller.dispatch({type:"set-item-lines",id:this.id,lines:!this.props.isOpen()})}isLineWidthValid(){return this.model.type==="expression"?RS(this.model):!1}isResolutionValid(){return this.model.type==="expression"?NS(this.model):!1}dispatchLineWidthLatexIfChanged(e){this.model.lineWidth!==e&&this.model.type==="expression"&&this.controller.dispatch({type:"set-item-linewidth",id:this.id,lineWidth:e})}dispatchResolutionLatexIfChanged(e){this.model.resolution!==e&&this.model.type==="expression"&&this.controller.dispatch({type:"set-item-resolution",id:this.id,resolution:e})}};var Hi=__dcg_shared_module_exports__['h'](z());var{If:Av}=Hi.Components,K0=class extends Ko{template(){return Hi.createElement("div",{class:Hi.const("dcg-options-menu-section")},Hi.createElement("div",{class:Hi.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-surfaces"),Hi.createElement(Ui,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-surfaces-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleSurfacesVisible)})),Hi.createElement(Av,{predicate:()=>this.props.isOpen()},()=>Hi.createElement("div",{style:Hi.const("font-size:85%; margin-top:8px")},Hi.createElement(Av,{predicate:()=>!this.isTriangle3D()&&!!Pr("beta3d")},()=>Hi.createElement("div",null,Hi.const("Resolution:"),Hi.createElement(ir,{latex:()=>this.model.resolution,placeholder:()=>this.getDefaultResolution(),isFocused:()=>this.getFocusedInput()==="resolution",ariaPostLabel:()=>this.isResolutionValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-label-resolution-tooltip"),hasError:()=>!this.isResolutionValid(),handleLatexChanged:this.bindFn(this.dispatchResolutionLatexIfChanged),dataLabelAttributeValue:this.const("resolution"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"resolution")}))),Hi.createElement(Av,{predicate:()=>this.model.colorLatex==="checkers"},()=>Hi.createElement("div",null,Hi.const("Checkers:"),Hi.createElement(ir,{latex:()=>this.model.checkers,placeholder:()=>`${__dcg_shared_module_exports__['wc']}`,isFocused:()=>this.getFocusedInput()==="checkers",ariaPostLabel:()=>this.isCheckersValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-label-checkers"),hasError:()=>!this.isCheckersValid(),handleLatexChanged:this.bindFn(this.dispatchCheckersLatexIfChanged),dataLabelAttributeValue:this.const("checkers"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"checkers")}))),Hi.createElement(Av,{predicate:this.props.isFirstOpenSection},()=>Hi.createElement("div",{class:Hi.const("dcg-options-menu-content"),style:Hi.const("margin-top:8px")},Hi.createElement(Wn,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected),hideCustomColors:()=>!1,canUsePatterns:()=>!this.isTriangle3D()}))),Hi.createElement(Av,{predicate:()=>B1(this.model)&&!!Pr("beta3d")},()=>Hi.createElement("div",{style:Hi.const("margin-top:8px")},Hi.createElement(_r,{staticConfig:this.bindFn(this.get3dPolarOptions),ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-settings-dimension"),theme:this.const("mini")}))))))}toggleSurfacesVisible(){this.controller.dispatch({type:"set-item-lines",id:this.id,lines:!this.props.isOpen()})}isTriangle3D(){return IS(this.model)}dispatchResolutionLatexIfChanged(e){this.model.resolution!==e&&this.model.type==="expression"&&this.controller.dispatch({type:"set-item-resolution",id:this.id,resolution:e})}dispatchCheckersLatexIfChanged(e){this.model.checkers!==e&&this.model.type==="expression"&&this.controller.dispatch({type:"set-item-checkers",id:this.id,checkers:e})}isCheckersValid(){return this.model.type==="expression"?EN(this.model):!1}isResolutionValid(){return this.model.type==="expression"?NS(this.model):!1}getDefaultResolution(){if(this.model.type==="expression"){if(fN(this.model))return`${40}`;if(bN(this.model))return`${__dcg_shared_module_exports__['uc']}`}return`${__dcg_shared_module_exports__['vc']}`}get3dPolarOptions(){return["Cylindrical","Spherical"].map(t=>({key:t,label:()=>t,selected:()=>this.isPolarCoordinateSystemSelected(t),onSelect:()=>{this.on3dOptionSelected(t)}}))}isPolarCoordinateSystemSelected(e){return"polarCoordinateSystem"in this.model?this.model.polarCoordinateSystem==e:!1}on3dOptionSelected(e){if("polarCoordinateSystem"in this.model){if(this.model.polarCoordinateSystem===e)return;this.model.type==="expression"&&this.controller.dispatch({type:"set-item-polar-coordinate-system",id:this.id,polarCoordinateSystem:e})}}};xt();var{For:bee,If:yee}=nn.Components;function id(r,e){if(!r)return;let t=r.closest(".dcg-options-menu-container"),i=e.findEl(".dcg-container"),o=e.getOpenMenuIcon(),n=!!r.closest(".dcg-table-column-menu");if(!t||!i||!o)return;let a=e.computeMajorLayout(),s=a.list.top+a.list.height,l=a.keypad.top,c=Math.min(s,l),p=i.getBoundingClientRect(),u=o.getBoundingClientRect(),m=c+p.top-u.top,h=t.offsetHeight,x=0;h>m&&(x=+m-h);let C=n?!x:-x<h-38;t.style.marginTop=`${n&&x<0?x-34:x}px`,r.style.marginTop=`${-x}px`,r.style.display=C?"":"none"}function $g(r,e){requestAnimationFrame(()=>{let t=e.getExppanelSelector(),i=e.getOpenMenuIcon();r&&t&&i&&t.contains(i)&&H(t).on(`scroll.${r}`,()=>{H(t).off(`scroll.${r}`);let o=e.getFocusLocation(),n=e.getOpenItemMenu();o&&n&&o.type==="expression-menu"&&"model"in n&&o.id===n.model.id&&e.dispatch({type:"blur-focus-location",location:o}),e.dispatch({type:"close-item-settings-menu"})})})}function jg(r,e){let t=e.getExppanelSelector();t&&r&&H(t).off(`scroll.${r}`)}var Fb=class extends nn.Class{init(){var e;this.controller=this.props.controller(),this.guid=(e=this.controller.getOpenItemMenu())==null?void 0:e.guid}didMount(){$g(this.guid,this.controller)}willUnmount(){jg(this.guid,this.controller)}didUpdate(){id(this.arrowElt,this.controller)}template(){let e=this.props.model();return nn.createElement("div",{class:()=>({"dcg-expressions-options-menu":!0,"dcg-options-menu":!0}),role:nn.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-options-menu")},nn.createElement(bee,{each:this.bindFn(this.getSections)},nn.createElement("div",null,t=>{switch(t){case"points":return nn.createElement(Ob,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("points"),isFirstOpenSection:()=>this.isFirstOpenSection("points")});case"label":return nn.createElement(N0,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("label"),isFirstOpenSection:()=>this.isFirstOpenSection("label")});case"drag":return nn.createElement(_b,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("drag"),isFirstOpenSection:()=>this.isFirstOpenSection("drag")});case"lines":return nn.createElement(Mb,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("lines"),isFirstOpenSection:()=>this.isFirstOpenSection("lines")});case"fill":return nn.createElement(O0,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("fill"),isFirstOpenSection:()=>this.isFirstOpenSection("fill")});case"colors-only":return nn.createElement(L0,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:this.const(!0),isFirstOpenSection:this.const(!0)});case"points3d":return nn.createElement(B0,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("points3d"),isFirstOpenSection:()=>this.isFirstOpenSection("points3d")});case"lines3d":return nn.createElement(q0,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("lines3d"),isFirstOpenSection:()=>this.isFirstOpenSection("lines3d")});case"surfaces":return nn.createElement(K0,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>this.isSectionOpen("surfaces"),isFirstOpenSection:()=>this.isFirstOpenSection("surfaces")})}})),nn.createElement(yee,{predicate:this.bindFn(this.isClickable)},()=>nn.createElement(Ab,{model:()=>e,controller:this.bindFn(this.props.controller),isOpen:()=>!!e.clickableInfo.enabled,isFirstOpenSection:this.const(!1)})),nn.createElement("div",{class:nn.const("dcg-triangle"),didMount:this.bindFn(this.didMountArrow),didUnmount:()=>this.arrowElt=void 0}))}didMountArrow(e){this.arrowElt=e,id(this.arrowElt,this.controller)}isClickable(){let e=this.props.model();return this.controller.areActionsEnabled()&&W1(e)&&!this.controller.isItemReadonly(e.id)}getSections(){let e=this.props.model();if(this.controller.isThreeDMode()){if(VS(e))return e.extendTo3D?["surfaces"]:["lines3d"];if(N1(e))return["surfaces"];if(Np(e)||R1(e)||Ax(e)||Lx(e))return["lines3d"];if(es(e)||TS(e))return["points3d"];if(Ox(e)||AS(e))return["points3d","lines3d"]}return lg(e)||$u(e)||wf(e)||wN(e)||Wu(e)?["colors-only"]:ju(e)?["lines"]:Bp(e)?["points"]:Ox(e)?["points","label","lines"]:es(e)?e.formula.move_strategy?["points","label","drag"]:["points","label"]:Np(e)||Ad(e)?["lines","fill"]:Ld(e)?Hu(e)||vf(e)||zs(e)?["lines"]:["lines","fill"]:["lines"]}isFirstOpenSection(e){return this.getSections().find(t=>this.isSectionOpen(t))===e}isSectionOpen(e){let t=this.props.model(),{points:i,lines:o,fill:n}=t,a=__dcg_shared_module_exports__['pc'](t.formula.expression_type,{points:i,lines:o,fill:n});switch(e){case"lines":return t.hidden?!1:a.lines;case"label":return _c(t);case"fill":return t.hidden?!1:Ld(t)?!0:a.fill;case"points":return t.hidden?!1:es(t)?!t.hidden:a.points;case"drag":return Gi(t)!=="NONE";case"colors-only":return!0;case"points3d":return t.hidden?!1:a.points;case"lines3d":case"surfaces":return t.hidden?!1:a.lines}}};var lr=__dcg_shared_module_exports__['h'](z());var{For:xee,If:EL,Textarea:wee}=lr.Components,z0=class extends lr.Class{init(){var e;this.controller=this.props.controller(),this.model=this.props.model(),this.guid=(e=this.controller.getOpenItemMenu())==null?void 0:e.guid}didMountArrow(e){this.arrowElt=e,id(this.arrowElt,this.controller)}didMount(){$g(this.guid,this.controller)}willUnmount(){jg(this.guid,this.controller)}didUpdate(){id(this.arrowElt,this.controller)}template(){let e=this.model;return lr.createElement("div",{class:lr.const("dcg-image-options-menu dcg-options-menu")},lr.createElement("div",{class:lr.const("dcg-triangle"),didMount:this.bindFn(this.didMountArrow),didUnmount:()=>this.arrowElt=void 0}),lr.createElement("div",{class:lr.const("dcg-opacities-menu dcg-dividing-line-after")},lr.createElement("div",{role:lr.const("heading"),"aria-level":lr.const("2"),class:lr.const("dcg-title")},()=>this.controller.s("graphing-calculator-heading-image-opacity")),lr.createElement(xee,{each:()=>this.controller.getImageOpacities()},lr.createElement("div",{class:lr.const("dcg-opacities-menu-flex"),role:lr.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-heading-image-opacity")},t=>lr.createElement("span",{class:lr.const("dcg-opacity-option"),role:lr.const("button"),tabindex:lr.const(0),"aria-label":()=>`opacity: ${t}`,"aria-pressed":()=>this.isOpacitySelected(t),handleevent:lr.const("true"),onTap:()=>this.onSelectOpacity(t)},lr.createElement(xn,{backgroundImage:this.bindFn(this.getBackgroundImage),iconType:()=>this.isOpacitySelected(t)?"check":"none",backgroundOpacity:()=>parseFloat(t)}))))),lr.createElement("div",{class:lr.const("dcg-styles-div dcg-options-menu-section")},lr.createElement("div",{class:lr.const("dcg-styles-menu"),role:lr.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-narration-image-styles")},lr.createElement(st,{checked:()=>!e.foreground,onChange:this.bindFn(this.onToggleForeground)},()=>this.controller.s("graphing-calculator-button-place-image-behind-graphs"))),lr.createElement(EL,{predicate:()=>this.shouldShowDraggableCheckbox()},()=>lr.createElement("div",{class:lr.const("dcg-draggable-checkbox-container")},lr.createElement(st,{checked:()=>Nd(e),onChange:this.bindFn(this.onToggleDraggable)},()=>this.controller.s("graphing-calculator-button-draggable")))),lr.createElement(EL,{predicate:this.bindFn(this.shouldShowClickable)},()=>lr.createElement("div",{class:lr.const("dcg-clickable-image-controls")},lr.createElement(Ab,{controller:this.props.controller,model:()=>e,isOpen:()=>!!e.clickableInfo.enabled,isFirstOpenSection:this.const(!1)}))),lr.createElement(EL,{predicate:()=>Nd(e)||!!e.clickableInfo.enabled},()=>lr.createElement(wee,{placeholder:()=>this.controller.s("graphing-calculator-text-add-screen-reader-label-placeholder"),value:()=>e.description,onInput:t=>this.controller.dispatch({type:"set-item-description",id:e.id,description:t})}))))}onToggleDraggable(){Df(this.model)?this.controller.dispatch({type:"set-image-draggable",id:this.model.id,draggable:!this.model.draggable}):this.makeDraggable()}onToggleForeground(e){this.controller.dispatch({type:"set-image-in-foreground",id:this.model.id,foreground:!e})}onSelectOpacity(e){this.controller.dispatch({type:"set-image-opacity",id:this.model.id,opacity:e})}isOpacitySelected(e){return this.model.opacity===e}getBackgroundImage(){return this.model.image_url===this.lastURL?this.lastEncodedURL:(this.lastURL=this.model.image_url,this.lastEncodedURL='url("'+D0(this.model.image_url)+'")',this.lastEncodedURL)}shouldShowClickable(){return this.controller.areActionsEnabled()}makeDraggable(){this.controller.dispatch({type:"convert-image-to-draggable",id:this.model.id})}shouldShowDraggableCheckbox(){if(this.controller.isThreeDMode())return!1;let e=Df(this.model);return e?qS(e):t3(this.model)}};var ho=__dcg_shared_module_exports__['h'](z());var Xn=__dcg_shared_module_exports__['h'](z());var U0=[.05,.1,.15,.2,.35,.5,.75,1,1.5,2,3.5,5,7.5,10,15,20],vee=__dcg_shared_module_exports__['z'](U0),Cee=__dcg_shared_module_exports__['y'](U0),Lv=class extends Xn.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return Xn.createElement("div",{class:Xn.const("dcg-slider-speed-container dcg-do-not-blur"),handleEvent:Xn.const("true")},Xn.createElement("span",{class:()=>({"dcg-action-slower":!0,"dcg-disabled":this.isSlowerDisabled()}),onTap:()=>this.animateSlower(),role:Xn.const("button"),"aria-label":()=>this.getSlowerAriaLabel(),tabindex:()=>this.isSlowerDisabled()?-1:0,"aria-disabled":()=>this.isSlowerDisabled()},Xn.createElement("i",{class:Xn.const("dcg-icon-show"),"aria-hidden":Xn.const("true")})),Xn.createElement("span",{class:Xn.const("dcg-variable-speed")},this.bindFn(this.computeSpeed),Xn.const("x")),Xn.createElement("span",{class:()=>({"dcg-action-faster":!0,"dcg-disabled":this.isFasterDisabled()}),onTap:()=>this.animateFaster(),role:Xn.const("button"),"aria-label":()=>this.getFasterAriaLabel(),tabindex:()=>this.isFasterDisabled()?-1:0,"aria-disabled":()=>this.isFasterDisabled()},Xn.createElement("i",{class:Xn.const("dcg-icon-show"),"aria-hidden":Xn.const("true")})))}computeSpeed(){var e=__dcg_shared_module_exports__['bd']/this.model.slider.animationPeriod;return e=Number(e.toFixed(3)),e}isSlowerDisabled(){return vee>=this.computeSpeed()}isFasterDisabled(){return Cee<=this.computeSpeed()}animateSlower(){var e=this.computeSpeed(),t=__dcg_shared_module_exports__['t'](U0,function(i){return i<e});t.length!==0&&this.setPeriodFromSpeed(__dcg_shared_module_exports__['y'](t))}animateFaster(){var e=this.computeSpeed(),t=__dcg_shared_module_exports__['t'](U0,function(i){return i>e});t.length!==0&&this.setPeriodFromSpeed(__dcg_shared_module_exports__['z'](t))}setPeriodFromSpeed(e){var t=__dcg_shared_module_exports__['bd']/e;this.controller.dispatch({type:"set-slider-animationperiod",id:this.model.id,animationPeriod:t}),be(this.controller.s("graphing-calculator-narration-slider-animating-at-speed",{speed:e+""}))}getSlowerAriaLabel(){return this.controller.s("graphing-calculator-narration-slider-animate-slower")}getFasterAriaLabel(){return this.controller.s("graphing-calculator-narration-slider-animate-faster")}};var H0=class extends ho.Class{init(){var e;this.controller=this.props.controller(),this.model=this.props.model(),this.guid=(e=this.controller.getOpenItemMenu())==null?void 0:e.guid}didMount(){$g(this.guid,this.controller)}willUnmount(){jg(this.guid,this.controller)}didMountArrow(e){this.arrowElt=e,id(this.arrowElt,this.controller)}didUpdate(){id(this.arrowElt,this.controller)}template(){let e=this.model;return ho.createElement("div",{class:ho.const("dcg-slider-options-view dcg-options-menu")},ho.createElement("div",{class:ho.const("dcg-triangle"),didMount:this.bindFn(this.didMountArrow),didUnmount:()=>this.arrowElt=void 0}),ho.createElement("div",{class:ho.const("dcg-slider-menu")},ho.createElement("div",{role:ho.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-heading-slider-animation-mode")},ho.createElement("div",{role:ho.const("heading"),"aria-level":ho.const("2"),class:ho.const("dcg-title")},()=>this.controller.s("graphing-calculator-heading-slider-animation-mode")),ho.createElement(_r,{ariaGroupLabel:()=>this.controller.s("graphing-calculator-heading-slider-animation-mode"),staticConfig:this.bindFn(this.getAnimationOptions),theme:this.const("mini")}))),ho.createElement("div",{class:ho.const("dcg-slider-menu dcg-slider-speed-menu"),role:ho.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-heading-slider-speed")},ho.createElement("div",{role:ho.const("heading"),"aria-level":ho.const("2"),class:ho.const("dcg-title")},()=>this.controller.s("graphing-calculator-heading-slider-speed")),ho.createElement("div",{class:ho.const("dcg-slider-speed-container")},ho.createElement(Lv,{model:()=>e,controller:this.props.controller}))))}getAnimationOptions(){let e=this.model;return["LOOP_FORWARD_REVERSE","LOOP_FORWARD","PLAY_ONCE","PLAY_INDEFINITELY"].map(i=>({key:i,icon:()=>__dcg_shared_module_exports__['Rc'](i),tooltip:()=>this.getTooltip(i),tooltipGravity:this.const("s"),selected:()=>this.isSelected(i),onSelect:()=>{this.controller.dispatch({type:"set-slider-loopmode",id:e.id,loopMode:i})}}))}getTooltip(e){let t=this.controller.s;switch(e){case"LOOP_FORWARD_REVERSE":return t("graphing-calculator-narration-slider-loop-forwards-and-backwards");case"LOOP_FORWARD":return t("graphing-calculator-narration-slider-repeat-one-direction");case"PLAY_ONCE":return t("graphing-calculator-narration-slider-play-once");case"PLAY_INDEFINITELY":return t("graphing-calculator-narration-slider-play-indefinitely")}}isSelected(e){return this.model.slider.loopMode===e}};var Vs=__dcg_shared_module_exports__['h'](z());var{For:Dee}=Vs.Components,W0=class extends Vs.Class{init(){var e;this.controller=this.props.controller(),this.model=this.props.model(),this.guid=(e=this.controller.getOpenItemMenu())==null?void 0:e.guid}didMount(){$g(this.guid,this.controller)}willUnmount(){jg(this.guid,this.controller)}didMountArrow(e){this.arrowElt=e,id(this.arrowElt,this.controller)}didUpdate(){id(this.arrowElt,this.controller)}template(){let e=this.model;return Vs.createElement("div",{class:()=>({"dcg-table-column-menu":!0,"dcg-options-menu":!0}),role:Vs.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-narration-options-menu")},Vs.createElement(Dee,{each:this.bindFn(this.getSections)},Vs.createElement("div",null,t=>{switch(t){case"points":return Vs.createElement(Ob,{model:()=>e,controller:this.props.controller,isOpen:()=>this.isSectionOpen("points"),isFirstOpenSection:()=>this.isFirstOpenSection("points")});case"drag":return Vs.createElement(_b,{model:()=>e,controller:this.props.controller,isOpen:()=>this.isSectionOpen("drag"),isFirstOpenSection:()=>this.isFirstOpenSection("drag")});case"lines":return Vs.createElement(Mb,{model:()=>e,controller:this.props.controller,isOpen:()=>this.isSectionOpen("lines"),isFirstOpenSection:()=>this.isFirstOpenSection("lines")})}})),Vs.createElement("div",{class:Vs.const("dcg-triangle"),didMount:this.bindFn(this.didMountArrow),didUnmount:()=>this.arrowElt=void 0}))}getSections(){return this.model.draggable&&!this.controller.isThreeDMode()?["points","lines","drag"]:["points","lines"]}isFirstOpenSection(e){let t=this.getSections();for(let i of t){if(i===e)return this.isSectionOpen(e);if(this.isSectionOpen(i))return!1}return!1}isSectionOpen(e){switch(e){case"drag":return this.model.dragMode!=="NONE";case"lines":return!!this.model.lines;case"points":return!!this.model.points}}};var an=__dcg_shared_module_exports__['h'](z());var{If:See}=an.Components,$0=class extends an.Class{template(){return an.createElement(See,{predicate:()=>this.props.controller().hasTermsNotice()},()=>an.createElement("div",{class:an.const("dcg-explist-terms-notice-container")},an.createElement("div",{class:an.const("dcg-explist-terms-notice")},an.createElement("i",{class:an.const("dcg-icon-remove"),role:an.const("button"),tabindex:an.const("0"),"aria-label":()=>this.props.controller().s("shared-button-close-message"),onTap:e=>this.props.controller().dispatch({type:"dismiss-terms-notice",focusFirstExpression:e.device==="keyboard"})}),an.createElement("div",{role:an.const("banner"),class:an.const("dcg-top-banner")},()=>this.props.controller().s("frontpage-text-header-terms-update"),an.createElement("div",null,an.createElement("a",{class:an.const("dcg-btn-gray-outline"),target:an.const("_blank"),href:an.const("https://blog.desmos.com/articles/desmos-studio-terms-update/")},()=>this.props.controller().s("shared-button-read-more")))))))}};var{If:sc,IfDefined:j0,For:kee,Switch:z4,SwitchUnion:Eee}=et.Components,Ov=class extends et.Class{constructor(){super(...arguments),this.guid=__dcg_shared_module_exports__['V']("listView")}init(){this.controller=this.props.controller()}template(){return et.createElement("div",{didMount:this.bindFn(this.didMountContainer)},et.createElement("div",{class:et.const("dcg-exppanel-outer"),onDrop:this.bindFn(this.onDrop),style:()=>this.computeExppanelOuterStyle()},et.createElement(sc,{predicate:()=>this.controller.isFileDraggedOver()},()=>et.createElement("div",{class:et.const("dcg-drop-image")},et.createElement("span",null,()=>this.controller.s("graphing-calculator-label-drop-image-here")))),et.createElement("div",{class:()=>({"dcg-exppanel-container":!0,"dcg-add-shadow":this.controller.shouldRenderList()}),style:()=>({transform:this.controller.isListVisible()?void 0:this.controller.isNarrow()?"translate(0, 100%)":"translate(-100%, 0)"})},et.createElement(sc,{predicate:()=>this.controller.shouldRenderList()},()=>et.createElement(Iv,{controller:this.props.controller,expsScrolled:()=>!!this.exppanel&&this.exppanel.scrollTop>0})),et.createElement(sc,{predicate:()=>this.controller.getExpressionSearchOpen()},()=>et.createElement(T0,{controller:this.props.controller,expsScrolled:()=>!!this.exppanel&&this.exppanel.scrollTop>0})),et.createElement(sc,{predicate:()=>this.controller.getTickerOpen()&&!this.controller.getTicker().filteredBySearch},()=>et.createElement(I0,{controller:this.props.controller,expsScrolled:()=>!!this.exppanel&&this.exppanel.scrollTop>0})),et.createElement(sc,{predicate:()=>this.controller.shouldRenderList()},()=>et.createElement("div",{class:()=>({"dcg-exppanel":!0,"dcg-disable-horizontal-scroll-to-cursor":!0,"dcg-isDragging":this.controller.isDragDropActive(),"dcg-has-background-color":this.controller.hasBackgroundColor(),"dcg-edit-list-mode":this.controller.isInEditListMode()}),style:()=>({background:this.controller.getBackgroundColor()}),onPaste:this.bindFn(this.onPaste),onTapStart:this.bindFn(this.onExppanelTapstart),didMount:this.bindFn(this.didMountExppanel)},et.createElement("div",{class:()=>({"dcg-expressionlist":!0,"dcg-has-footer-notice":this.controller.has3DNotice()||!!this.controller.hasTermsNotice()}),role:et.const("region"),"aria-label":()=>this.controller.s("shared-calculator-narration-expression-list")},et.createElement(sc,{predicate:()=>this.controller.getShowConstructionsOpen()},()=>et.createElement(V0,{controller:this.props.controller,onDragPending:(e,t)=>this.onDragPending(e,t)})),et.createElement(kee,{each:()=>this.controller.getAllItemModels(),key:e=>e.guid},et.createElement("span",{class:et.const("dcg-template-expressioneach")},e=>Eee(()=>Dk(e),{shell:()=>this.makeShellViewForModel(e),render:()=>this.makeViewForModel(e),none:()=>{}}))),et.createElement(Ev,{controller:()=>this.props.controller()}),et.createElement(z4,{key:()=>this.controller.getDraggedItemId()},e=>{if(e){let t=this.controller.getItemModel(e);return et.createElement(kv,{controller:this.props.controller},this.makeDragCopyViewForModel(t))}else return}),et.createElement($0,{controller:this.props.controller}),et.createElement(A0,{controller:this.props.controller}),et.createElement("div",{class:et.const("dcg-expressions-branding"),style:()=>({opacity:this.controller.isKeypadOpen()?0:1})},et.createElement(sc,{predicate:()=>this.controller.canEditOnWeb()},()=>et.createElement("span",{role:et.const("link"),tabindex:et.const(0),class:et.const("dcg-edit-branding"),onTap:()=>this.controller.dispatch({type:"open-on-web"})},et.createElement("div",{class:et.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-graph-on-desmos")},()=>this.controller.s("graphing-calculator-button-edit-graph-on-desmos-logo")),et.createElement("i",{class:et.const("dcg-icon-desmos"),"aria-hidden":et.const("true")}))),et.createElement(sc,{predicate:()=>!this.controller.canEditOnWeb()},()=>et.createElement("span",{class:et.const("dcg-noedit-branding")},et.createElement("div",{class:et.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-powered-by-desmos")},()=>this.controller.s("graphing-calculator-label-powered-by")),et.createElement("i",{class:et.const("dcg-icon-desmos"),"aria-hidden":et.const("true")})))))))),et.createElement(G0,{controller:this.props.controller})),et.createElement(sc,{predicate:()=>this.isOptionsViewOpen("expression")},()=>et.createElement(ec,__dcg_shared_module_exports__['a']({menuType:this.const("expression"),menuButtonFocusLocation:()=>{let e=this.getActiveExpressionModelForOptionsView();return e?{type:"expression-icon",id:e.id}:void 0}},this.getSharedDropdownWrapperProps()),j0(this.bindFn(this.getActiveExpressionModelForOptionsView),e=>et.createElement(Fb,{controller:this.props.controller,model:e})))),et.createElement(sc,{predicate:()=>this.isOptionsViewOpen("image")},()=>et.createElement(ec,__dcg_shared_module_exports__['a']({menuType:this.const("image"),menuButtonFocusLocation:()=>{let e=this.getActiveImageModelForOptionsView();return e?{type:"image-icon",id:e.id}:void 0}},this.getSharedDropdownWrapperProps()),j0(this.bindFn(this.getActiveImageModelForOptionsView),e=>et.createElement(z0,{controller:this.props.controller,model:e})))),et.createElement(sc,{predicate:()=>this.isOptionsViewOpen("slider")},()=>et.createElement(ec,__dcg_shared_module_exports__['a']({menuType:this.const("slider"),menuButtonFocusLocation:()=>{let e=this.getActiveSliderModelForOptionsView();return e?{type:"slider-icon",id:e.id}:void 0}},this.getSharedDropdownWrapperProps()),j0(this.bindFn(this.getActiveSliderModelForOptionsView),e=>et.createElement(H0,{controller:this.props.controller,model:e})))),et.createElement(sc,{predicate:()=>this.isOptionsViewOpen("table-column")},()=>et.createElement(ec,__dcg_shared_module_exports__['a']({menuType:this.const("table-column"),menuButtonFocusLocation:()=>{let e=this.getActiveColumnModelForOptionsView();return e?{type:"table-icon",id:e.table.id,columnId:e.id}:void 0}},this.getSharedDropdownWrapperProps()),j0(this.bindFn(this.getActiveColumnModelForOptionsView),e=>et.createElement(W0,{controller:this.props.controller,model:e})))))}getSharedDropdownWrapperProps(){return{rootElSelector:this.const(".dcg-container"),openAriaAlert:this.const(this.controller.s("graphing-calculator-narration-options-menu-open")),closeAriaAlert:this.const(this.controller.s("graphing-calculator-narration-options-menu-closed")),focusOnOpen:this.bindFn(this.optionsViewFocusLocation),shouldHandleTabAndEscape:this.const(!0),controller:this.props.controller}}optionsViewFocusLocation(){let e=this.controller.getOpenItemMenu();if(!e||!("model"in e))return"none";let{model:t}=e;if(!t)return"none";let i=this.controller.getFocusLocation();if(!i||i.type!=="expression-menu"||i.id!==t.id)return"none";switch(i.location){case"start":return"first";case"end":return"last";default:return"none"}}getActiveSliderModelForOptionsView(){let e=this.controller.getOpenItemMenu();return e&&e.type==="slider"&&"model"in e?e.model:void 0}getActiveImageModelForOptionsView(){let e=this.controller.getOpenItemMenu();return e&&e.type==="image"&&"model"in e?e.model:void 0}getActiveExpressionModelForOptionsView(){let e=this.controller.getOpenItemMenu();return e&&e.type==="expression"&&"model"in e?e.model:void 0}getActiveColumnModelForOptionsView(){let e=this.controller.getOpenItemMenu();return e&&e.type==="table-column"&&"model"in e?e.model:void 0}isOptionsViewOpen(e){let t=this.controller.getOpenItemMenu();return!!t&&t.type===e}makeShellViewForModel(e){return et.createElement(Sv,{controller:this.props.controller,model:()=>e,onDragPending:()=>{},isDragCopy:()=>!1})}computeExppanelOuterStyle(){this.getListBottomAndUpdateLastExpressionPadding();let{list:e}=this.controller.computeMajorLayout(),t=0,i=e.top;return e.top>0&&!this.controller.isListVisible()&&(i-=e.height),{position:"absolute",left:t+"px",top:i+"px",width:e.width+"px",height:e.height+"px"}}makeDragCopyViewForModel(e){return this.makeViewForModel(e,!0)}makeViewForModel(e,t=!1){var i;if(e.type==="table")i=et.createElement(xv,{controller:this.props.controller,model:()=>e,onDragPending:o=>this.onDragPending(o,{type:"expression",calcId:e.id}),isDragCopy:()=>t});else if(e.type==="folder")i=et.createElement(wv,{controller:this.props.controller,model:()=>e,onDragPending:o=>this.onDragPending(o,{type:"expression",calcId:e.id}),isDragCopy:()=>t});else if(e.type==="text")i=et.createElement(gv,{controller:this.props.controller,model:()=>e,onDragPending:o=>this.onDragPending(o,{type:"expression",calcId:e.id}),isDragCopy:()=>t});else if(e.type==="image")i=et.createElement(Cv,{controller:this.props.controller,model:()=>e,onDragPending:o=>this.onDragPending(o,{type:"expression",calcId:e.id}),isDragCopy:()=>t});else if(e.type==="expression")i=et.createElement(z4,{key:()=>t&&this.controller.shouldRenderDraggedItemAsToken()},o=>o?et.createElement(Kd,{showParentChildrenHover:this.const(!1),controller:this.props.controller,identifier:()=>this.controller.getDraggedIdentifier(),insideMQ:this.const(!1),insideGroup:this.const(!1),putInTabOrder:()=>!1}):et.createElement(Ug,{controller:this.props.controller,model:()=>e,onDragPending:n=>this.onDragPending(n,{type:"expression",calcId:e.id}),isDragCopy:()=>t}));else return;return i}didUnmount(){H(document.documentElement).off("."+this.guid)}didMountContainer(e){this.node=e,H(document.documentElement).on("keydown."+this.guid,this.bindFn(this.handleKeyDown))}didMountExppanel(e){this.exppanel=e,e.onscroll=()=>this.controller.markTickRequiredNextFrame()}getListBottomAndUpdateLastExpressionPadding(){let e=this.controller.getKeypadHeight(),t=this.__listBottom||0;return this.__listBottom=e,e===0&&t!==0&&C_()&&this.padLastExpressionUntilTapEnd(t),e}padLastExpression(e){let t=this.node.querySelector(".dcg-expressionitem.dcg-new-expression");t.style.marginBottom=e+"px"}unpadLastExpression(){let e=this.node.querySelector(".dcg-expressionitem.dcg-new-expression");e.style.marginBottom="0"}padLastExpressionUntilTapEnd(e){this.padLastExpression(e),H(document).on("dcg-tap.animating-bottom",()=>{this.unpadLastExpression(),H(document).off("dcg-tap.animating-bottom")})}handleKeyDown(e){var a;if(this.controller.inAudioTraceMode())return;let t=Ee(e),i=ki(e),o=this.controller.getSelectedItem();if(!o){(t===Hl||t===Bm)&&!this.controller.needsFakeKeypad()&&this.controller.hasMultipleItemsSelected()&&this.controller.dispatch({type:"delete-all-selected-items"});return}if(e.altKey&&!e.ctrlKey&&!e.metaKey&&e.shiftKey&&i==="M"&&o){if(!this.controller.isGeometry()||!Md(o))return;e.preventDefault(),e.stopPropagation(),this.controller.convertToTokenAssignment(o);let s=this.controller.getGeometryFolder();if(s){let c=s.index+this.controller.getNumberOfItemsInFolder(s.id);sa(o,s.id),o.index!==c&&Xu(this.controller.getListModel(),o.index,c,1)}this.controller.ensureAtLeastOneVisibleItem();let l=(a=Fo(o))==null?void 0:a.identifier;l&&this.controller.getShowConstructionsOpen()&&this.controller.dispatch({type:"set-focus-location",location:{type:"geo-token",identifier:l}});return}let n=this.controller.getFocusLocation();if(e.ctrlKey&&e.shiftKey&&!e.metaKey&&!e.altKey&&n!==void 0){if(i==="O"){e.preventDefault(),e.stopPropagation();let s;if(o.type==="expression")!o.sliderExists&&!xf(o)?(s={type:"expression",model:o,guid:o.guid,focusFirstOption:!0,previousFocusLocation:n},this.controller.dispatch({type:"set-focus-location",location:{type:"expression-icon",id:o.id}})):o.sliderExists&&(s={type:"slider",model:o,guid:"slider-"+o.guid,focusFirstOption:!0,previousFocusLocation:n},this.controller.dispatch({type:"set-focus-location",location:{type:"slider-animation-properties-icon",id:o.id}}));else if(o.type==="image")s={type:"image",model:o,guid:o.guid,focusFirstOption:!0,previousFocusLocation:n},this.controller.dispatch({type:"set-focus-location",location:{type:"image-icon",id:o.id}});else if(o.type==="table"&&n.type==="table"){let l=n.location;if(!l)return;let c=o.columnModels[l.column];if(!c||c.latex===""||!this.controller.getGraphSettings().config.graphpaper||c.error||c.index===0)return;s={type:"table-column",model:c,guid:c.guid,focusFirstOption:!0,previousFocusLocation:n},this.controller.dispatch({type:"set-focus-location",location:{type:"table-icon",id:o.id,columnId:c.id}})}if(!s)return;this.controller.dispatch({type:"toggle-item-settings-menu",menu:s});return}else if(i==="D"){if(this.controller.isItemReadonly(o.id)&&!this.controller.isInEditListMode())return;e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"delete-item-and-animate-out",id:o.id,setFocusAfterDelete:!0});return}}if(this.controller.isInEditListMode()&&!e.altKey&&!e.ctrlKey&&!e.metaKey){if(t===hl&&n!==void 0){let s=this.controller.getItemModelByIndex(0);if(!s)return;let l=(n.type==="readonly-expression"&&s.type==="expression"||n.type==="table-container"&&s.type==="table"||n.type===s.type)&&n.id===s.id,c={type:"edit-list-toggle"},p=this.controller.isFocusLocationFocused(c);e.shiftKey&&l?(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-focus-location",location:c})):!e.shiftKey&&p&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"move-focus-to-item",id:s.id,where:s.type==="table"?"container":void 0}))}else if(t===gn||t===mn){let s=this.controller.getListModel(),l=t===gn?pg(s,o.index):ug(s,o.index);if(!l)return;this.controller.dispatch({type:"move-focus-to-item",id:l.id,where:l.type==="table"?"container":"start"})}return}if(!(document.activeElement&&H.contains(document.body,document.activeElement))&&!this.exppanel.contains(e.target)&&H.contains(document.documentElement,e.target))switch(t){case gn:e.preventDefault(),this.controller.dispatch({type:"select-previous-expression"});break;case mn:e.preventDefault(),this.controller.dispatch({type:"select-next-expression"});break;case hn:e.preventDefault(),this.controller.dispatch({type:"set-none-selected"});break;case Dd:e.preventDefault(),o&&(o.type==="expression"&&o.sliderExists?(this.controller.dispatch({type:"adjust-slider-by-keyboard",id:o.id,adjustment:"up"}),this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:o.id}})):this.controller.dispatch({type:"move-focus-to-item",id:o.id,where:"start"}));break;case hl:e.preventDefault(),o&&this.controller.dispatch({type:"move-focus-to-item",id:o.id,where:"start"});break;case Cd:e.preventDefault(),o&&(o.type==="expression"&&o.sliderExists?(this.controller.dispatch({type:"adjust-slider-by-keyboard",id:o.id,adjustment:"down"}),this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:o.id}})):this.controller.dispatch({type:"move-focus-to-item",id:o.id,where:"end"}));break;case Hl:e.preventDefault(),o&&!this.controller.isItemReadonly(o.id)&&this.controller.dispatch({type:"upward-delete-selected-expression"});break;case Bm:e.preventDefault(),o&&!this.controller.isItemReadonly(o.id)&&this.controller.dispatch({type:"downward-delete-selected-expression"});break;case fs:e.wasHandled("create-expression-with-keyboard")||(e.preventDefault(),e.handle("create-expression-with-keyboard"),o&&this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"}));break;default:if(e.metaKey||e.ctrlKey||t===Jy||t===Mu)return;o&&(o.type==="table"||this.controller.dispatch({type:"move-focus-to-item",id:o.id,where:"end"}))}}onDragPending(e,t){e.preventDefault(),Kr();var i={x:e.touches[0].clientX,y:e.touches[0].clientY},o={x:i.x,y:i.y},n=setTimeout(()=>{H(document).off(".dragpending"),this.onDragStart(e,t,i,o)},500);H(document).on("dcg-tapmove.dragpending",a=>{o={x:a.touches[0].clientX,y:a.touches[0].clientY},(Math.abs(o.y-i.y)>3||Math.abs(o.x-i.x)>3)&&(clearTimeout(n),H(document).off(".dragpending"),this.onDragStart(e,t,i,o))}),H(document).on("dcg-tapend.dragpending",function(){clearTimeout(n),H(document).off(".dragpending")})}onDragStart(e,t,i,o){e.touches.length===1&&(e.wasHandled("dcg-longhold")||this.controller.dispatch({type:"start-dragdrop",dragTarget:t,grabPt:i,mousePt:o}))}onExppanelTapstart(e){e.device!=="mouse"&&(e.target.closest(".dcg-expressionitem")||Kr())}onPaste(e){let t=this.controller.getGraphSettings().config;var i=C4(e);if(!i)return;var o=this.controller.getSelectedItem();if(this.controller.canLoadPastedLink(i)&&o&&o.type==="folder"&&o.title===""){e.stopPropagation(),e.preventDefault(),E0(this.controller,i,(a,s)=>s(null,a));return}if(o&&(o.type==="text"||o.type==="folder"))return;if(this.controller.canLoadPastedLink(i)){e.stopPropagation(),e.preventDefault();let a=t.pasteGraphLinkCallback?t.pasteGraphLinkCallback:(s,l)=>l(null,s);E0(this.controller,i,a);return}if(t.pasteTableData){let a=w4(i);if(a!==void 0)return e.stopPropagation(),e.preventDefault(),this.controller.dispatch({type:"paste-table",data:a})}let n=x4(i);if(n!==void 0){e.stopPropagation(),e.preventDefault();let a=[];n.length===1&&n[0].numberList?this.controller.dispatch({type:"append-number-list",latex:n[0].content}):(n.forEach(s=>{a.push({type:"expression",id:this.controller.generateId(),latex:s.content})}),this.controller.dispatch({type:"insert-several-expressions",expressions:a}));return}}onDrop(e){if(!this.controller.areImagesEnabled())return;let t=e.dataTransfer&&e.dataTransfer.files;t&&t.length&&this.controller.dispatch({type:"new-images",files:t})}};var Bt=__dcg_shared_module_exports__['h'](z());var U4=__dcg_shared_module_exports__['h'](z());var GL=class GL extends U4.Class{init(){this.controller=this.props.controller(),this.dispatch=this.controller.dispatch,this.s=this.controller.s}};GL.uuid=Ud();var Mo=GL;var qb=__dcg_shared_module_exports__['h'](z());var cu=__dcg_shared_module_exports__['h'](z()),nr=class extends cu.Class{template(){return cu.createElement("div",{class:()=>({"dcg-keypad-btn-container":!0,"dcg-disabled":this.isDisabled()}),style:()=>({"flex-grow":this.getColSpan()})},cu.createElement("span",{role:cu.const("button"),class:this.bindFn(this.getClasses),"dcg-command":this.props.command,"aria-label":this.bindFn(this.getAriaLabel),"aria-disabled":this.bindFn(this.isDisabled),"aria-controls":this.props.ariaControls?this.props.ariaControls:this.const(void 0),"aria-expanded":this.props.ariaExpanded?this.bindFn(this.getAriaExpanded):this.const(void 0),onTap:()=>{this.isDisabled()||this.props.onTap()}},cu.createElement("span",{class:cu.const("dcg-keypad-btn-content")},this.children)))}getClasses(){let e={"dcg-keypad-btn":!0,"dcg-keypad-btn-active":this.isActive()},t=this.props.style();switch(t){case"default":e["dcg-btn-light-on-gray"]=!0;break;case"highlight":e["dcg-btn-dark-on-gray"]=!0;break;case"popover":e["dcg-btn-light-gray"]=!0;break;case"blue":e["dcg-btn-short-blue"]=!0;break;case"tall-blue":e["dcg-btn-tall-blue"]=!0;break;default:return t}return e}isActive(){return this.props.active?this.props.active():!1}getAriaLabel(){return this.props.ariaLabel?this.props.ariaLabel():this.props.command()}getColSpan(){if(this.props.colspan)return this.props.colspan()}isDisabled(){return this.props.disabled&&this.props.disabled()}getAriaExpanded(){return this.props.ariaExpanded?this.props.ariaExpanded():void 0}};var Q=__dcg_shared_module_exports__['h'](z()),{IfElse:$4,If:H4,Switch:Gee}=Q.Components;function Er(r,e){return r===void 0?Q.const(e):typeof r=="function"?r:Q.const(r)}function Rb(r){return(e,t,i={},o)=>Q.createElement(nr,{command:Q.const(r.command||r.typedText||r.keys[0]),ariaLabel:()=>r.ariaLabelKey?o(r.ariaLabelKey):r.typedText||r.keys[0],colspan:Er(i.colspan,1),style:()=>i.style||"default",onTap:()=>t({type:"keypad/type-text",text:r.typedText||r.keys[0]})},$4(()=>r.keys[0]==="{"||r.keys[0]==="[",{true:()=>Q.createElement("span",{class:Q.const("dcg-mq-math-mode"),style:Q.const("font-size: 120%")},Q.const(r.keys[0]),Q.const("\xA0"),Q.createElement("span",{style:Q.const("color: #999")},Q.const(r.keys[1]))),false:()=>Q.createElement("span",{class:Q.const("dcg-either-or-btn")},Q.createElement(ze,{config:Q.const({}),latex:Q.const(r.keys[0])}),Q.createElement("span",{style:Q.const("color: #999")},Q.createElement(ze,{config:Q.const({}),latex:Q.const(r.keys[1])})))}))}function Nb(r){return(e,t,i={},o)=>Q.createElement(nr,{command:Q.const(r.command||r.typedText||r.keys[1]),ariaLabel:()=>r.ariaLabelKey?o(r.ariaLabelKey):r.typedText||r.keys[0],colspan:Er(i.colspan,1),style:Er(i.style,"default"),onTap:()=>t({type:"keypad/type-text",text:r.typedText||r.keys[1]})},$4(()=>r.keys[1]==="}"||r.keys[1]==="]",{true:()=>Q.createElement("span",{class:Q.const("dcg-mq-math-mode"),style:Q.const("font-size: 120%")},Q.createElement("span",{style:Q.const("color: #999")},Q.const(r.keys[0])),Q.const("\xA0"),Q.const(r.keys[1])),false:()=>Q.createElement("span",null,Q.createElement("span",{style:Q.const("color: #999")},Q.createElement(ze,{config:Q.const({}),latex:Q.const(r.keys[0])})),Q.createElement(ze,{config:Q.const({}),latex:Q.const(r.keys[1])}))}))}function Tee(r){return(e,t,i={},o)=>Q.createElement(nr,{command:Q.const(r.command),ariaLabel:()=>r.ariaLabelKey?o(r.ariaLabelKey):e,colspan:Er(i.colspan,1),style:()=>i.style||"default",onTap:()=>{t({type:"keypad/audio-trace",command:r.command})}},Q.createElement(H4,{predicate:Q.const(r.iconClass!==void 0)},()=>Q.createElement("span",{class:()=>({"dcg-button-icon":!0,"dcg-icon-only":r.contentKey===void 0})},Q.createElement("i",{class:Q.const(r.iconClass),"aria-hidden":Q.const("true")}))),Q.createElement(H4,{predicate:Q.const(r.contentKey!==void 0)},()=>Q.createElement("span",null,()=>o(r.contentKey)||e)))}function Ge(r){return(e,t,i={},o)=>Q.createElement(nr,{command:Q.const(r.command||e),ariaLabel:()=>r.ariaLabelKey?o(r.ariaLabelKey):e,colspan:Er(i.colspan,1),style:()=>i.style||"default",onTap:()=>t({type:"keypad/type-text",text:r.typedText||e})},Q.createElement(ze,{config:Q.const({}),latex:Q.const(r.content||e)}))}function W4(r){return(e,t,i={},o)=>Q.createElement(nr,{command:Q.const(r.command||e),ariaLabel:()=>r.ariaLabelKey?o(r.ariaLabelKey):e,colspan:Er(i.colspan,1),style:()=>i.style||"default",onTap:()=>t({type:"keypad/type-text",text:r.typedText||e})},Q.createElement("span",{class:Q.const("dcg-mq-math-mode")},Q.const(r.content||e)))}function Ae(r){return(e,t,i={},o)=>Q.createElement(nr,{command:Q.const(e),ariaLabel:()=>r.ariaLabelKey?o(r.ariaLabelKey):e,colspan:Er(i.colspan,1),style:()=>i.style||"default",onTap:()=>t({type:"keypad/type-text",text:e+"("})},Q.createElement(Gee,{key:()=>e.match(/^[a-z]{2,}$/)},n=>n?Q.createElement("span",{class:Q.const("dcg-mq-math-mode dcg-static-mathquill-view")},Q.createElement("span",{class:Q.const("dcg-mq-root-block")},Q.createElement("span",{class:Q.const("dcg-mq-operator-name")},()=>e))):Q.createElement(ze,{config:Q.const({}),latex:Q.const(e)})))}function ba(r){return(e,t,i={},o)=>Q.createElement(nr,{command:Q.const(r.command),ariaLabel:()=>r.ariaLabelKey?o(r.ariaLabelKey):r.command,colspan:Er(i.colspan,1),style:()=>i.style||"default",onTap:()=>{t({type:"keypad/custom-command",command:r.command})}},Q.createElement(ze,{config:Q.const({}),latex:Q.const(r.content)}))}var Iee={"{":W4({ariaLabelKey:"shared-calculator-narration-keypad-key-left-bracket"}),"}":W4({ariaLabelKey:"shared-calculator-narration-keypad-key-right-bracket"}),"(":Ge({ariaLabelKey:"shared-calculator-narration-keypad-key-left-paren"}),")":Ge({ariaLabelKey:"shared-calculator-narration-keypad-key-right-paren"}),sqrt:Ge({content:"\\sqrt{}",ariaLabelKey:"shared-calculator-narration-keypad-key-sqrt"}),"/":Ge({ariaLabelKey:"shared-calculator-narration-keypad-key-divide"}),division:Ge({content:"\xF7",typedText:"/",command:"/",ariaLabelKey:"shared-calculator-narration-keypad-key-divide"}),obelus:Ge({content:"\xF7",typedText:"\xF7",ariaLabelKey:"shared-calculator-narration-keypad-key-divide"}),"*":Ge({ariaLabelKey:"shared-calculator-narration-keypad-key-times"}),multiplication:Ge({content:"\xD7",typedText:"*",command:"*",ariaLabelKey:"shared-calculator-narration-keypad-key-times"}),"\xB1":Ge({ariaLabelKey:"shared-calculator-narration-keypad-plus-minus"}),"-":Ge({ariaLabelKey:"shared-calculator-narration-keypad-key-minus"}),"+":Ge({ariaLabelKey:"shared-calculator-narration-keypad-key-plus"}),".":Ge({ariaLabelKey:"shared-calculator-narration-keypad-key-decimal"}),ans:(r,e,t={},i)=>Q.createElement(nr,{command:Q.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-ans"),colspan:Er(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/type-text",text:r})},Q.const("ans")),enter:(r,e,t={},i)=>Q.createElement(nr,{command:Q.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-enter"),colspan:Er(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/press-key",key:"Enter"})},Q.createElement("i",{class:Q.const("dcg-icon-arrow-enter"),"aria-hidden":Q.const("true")})),shift:(r,e,t={},i)=>Q.createElement(nr,{command:Q.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-shift"),colspan:Er(t.colspan,1),style:()=>t.style||"default",active:Er(t.active,!1),onTap:()=>e({type:"keypad/shift"})},Q.createElement("i",{class:Q.const("dcg-icon-shift"),"aria-hidden":Q.const("true")})),left:(r,e,t={},i)=>Q.createElement(nr,{command:Q.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-left-arrow"),colspan:Er(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/press-key",key:"Left"})},Q.createElement("i",{class:Q.const("dcg-icon-arrow-left"),"aria-hidden":Q.const("true")})),right:(r,e,t={},i)=>Q.createElement(nr,{command:Q.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-right-arrow"),colspan:Er(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/press-key",key:"Right"})},Q.createElement("i",{class:Q.const("dcg-icon-arrow-right"),"aria-hidden":Q.const("true")})),123:(r,e,t={},i)=>Q.createElement(nr,{command:Q.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-toggle-numbers"),colspan:Er(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/123"})},Q.const("1 2 3")),ABC:(r,e,t={},i)=>Q.createElement(nr,{command:Q.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-toggle-letters"),colspan:Er(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/abc"})},Q.const("A B C")),Audio:(r,e,t={},i)=>Q.createElement(nr,{command:Q.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-toggle-audio-trace"),colspan:Er(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"on"})},Q.createElement("i",{class:Q.const("dcg-icon-volume"),"aria-hidden":Q.const("true")})),backspace:(r,e,t={},i)=>Q.createElement(nr,{command:Q.const(r),ariaLabel:()=>i("shared-calculator-narration-keypad-key-backspace"),colspan:Er(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/press-key",key:"Backspace"})},Q.createElement("i",{class:Q.const("dcg-icon-delete"),"aria-hidden":Q.const("true")})),pi:Ge({content:"\\pi",ariaLabelKey:"shared-calculator-narration-keypad-key-pi"}),alpha:Ge({content:"\\alpha",ariaLabelKey:"shared-calculator-narration-keypad-key-alpha"}),beta:Ge({content:"\\beta",ariaLabelKey:"shared-calculator-narration-keypad-key-beta"}),theta:Ge({content:"\\theta",ariaLabelKey:"shared-calculator-narration-keypad-key-theta"}),tau:Ge({content:"\\tau",ariaLabelKey:"shared-calculator-narration-keypad-key-tau"}),"a^2":ba({command:"a^2",content:"a^2",ariaLabelKey:"shared-calculator-narration-keypad-key-squared"}),"a^3":ba({command:"a^3",content:"a^3",ariaLabelKey:"shared-calculator-narration-keypad-key-cubed"}),"x^3":ba({command:"a^3",content:"x^3",ariaLabelKey:"shared-calculator-narration-keypad-key-cubed"}),"a^b":Ge({content:"a^b",typedText:"^",ariaLabelKey:"shared-calculator-narration-keypad-key-superscript"}),a_b:Ge({content:"a_b",typedText:"_",ariaLabelKey:"shared-calculator-narration-keypad-key-subscript"}),"a/b":ba({content:"\\frac{a}{b}",command:"a/b",ariaLabelKey:"shared-calculator-narration-keypad-key-fraction"}),"x^2":ba({command:"a^2",content:"x^2",ariaLabelKey:"shared-calculator-narration-keypad-key-squared"}),"x^y":Ge({content:"x^y",typedText:"^",ariaLabelKey:"shared-calculator-narration-keypad-key-superscript"}),"x/y":Ge({content:"\\frac{x}{y}",typedText:"/",ariaLabelKey:"shared-calculator-narration-keypad-key-fraction"}),nthroot:ba({command:"nthroot",content:"\\sqrt[n]{}",ariaLabelKey:"shared-calculator-narration-keypad-key-nthroot"}),ythroot:ba({command:"nthroot",content:"\\sqrt[y]{}",ariaLabelKey:"shared-calculator-narration-keypad-key-ythroot"}),sin:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-sin"}),cos:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-cos"}),tan:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-tan"}),sec:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-sec"}),csc:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-csc"}),cot:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-cot"}),sinh:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-sinh"}),cosh:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-cosh"}),tanh:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-tanh"}),sech:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-csch"}),csch:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-csch"}),coth:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-coth"}),arcsin:ba({command:"arcsin",content:"sin^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arcsin"}),arccos:ba({command:"arccos",content:"cos^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arccos"}),arctan:ba({command:"arctan",content:"tan^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arctan"}),arccsc:ba({command:"arccsc",content:"csc^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arccsc"}),arcsec:ba({command:"arcsec",content:"sec^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arcsec"}),arccot:ba({command:"arccot",content:"cot^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arccot"}),"|a|":Ge({typedText:"|",ariaLabelKey:"shared-calculator-narration-keypad-key-abs"}),"|x|":Ge({typedText:"|",ariaLabelKey:"shared-calculator-narration-keypad-key-abs"}),ln:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-ln"}),midpoint:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-midpoint"}),segment:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-segment"}),line:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-line"}),ray:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-ray"}),parallel:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-parallel"}),perpendicular:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-perpendicular"}),circle:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-circle"}),arc:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-arc"}),angle:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-angle"}),directedangle:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-directed-angle"}),glider:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-glider"}),coterminal:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-coterminal"}),supplement:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-supplement"}),dilate:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-dilate"}),rotate:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-rotate"}),translate:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-translate"}),reflect:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-reflect"}),vertices:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-vertices"}),angles:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-angles"}),directedangles:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-directed-angles"}),segments:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-segments"}),radius:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-radius"}),center:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-center"}),intersection:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-intersection"}),area:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-area"}),perimeter:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-perimeter"}),log:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-log"}),quantile:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-quantile"}),quartile:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-quartile"}),var:Ae({}),varp:Ae({}),nCr:Ae({}),loga:ba({command:"loga",content:"log_a",ariaLabelKey:"shared-calculator-narration-keypad-key-loga"}),stdev:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-stdev"}),mad:Ae({}),nPr:Ae({}),total:Ae({}),count:Ae({}),length:Ae({}),for:Ae({}),min:Ae({}),max:Ae({}),cov:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-cov"}),covp:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-covp"}),corr:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-corr"}),spearman:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-spearman"}),stats:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-stats"}),polygon:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-polygon"}),distance:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-distance"}),triangle:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-triangle"}),sphere:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-sphere"}),vector:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-vector"}),mean:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-mean"}),stdevp:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-stdevp"}),mod:Ae({}),"e^x":Ge({typedText:"e^",ariaLabelKey:"shared-calculator-narration-keypad-key-exp"}),"10^n":Ge({content:"\\times10^{n}",typedText:"*10^",ariaLabelKey:"shared-calculator-narration-keypad-key-10-n"}),"a^{-1}":Ge({typedText:"^-1",ariaLabelKey:"shared-calculator-narration-keypad-key-reciprocal"}),sum:Ge({content:"\\sum",ariaLabelKey:"shared-calculator-narration-keypad-key-sum"}),prod:Ge({content:"\\prod",ariaLabelKey:"shared-calculator-narration-keypad-key-product"}),floor:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-floor"}),ceil:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-ceil"}),round:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-round"}),abs:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-abs"}),"!":Ge({ariaLabelKey:"shared-calculator-narration-keypad-key-factorial"}),"n!":Ge({typedText:"!",ariaLabelKey:"shared-calculator-narration-keypad-key-factorial"}),median:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-median"}),lcm:Ae({}),gcd:Ae({}),gcf:Ae({}),ddx:ba({command:"ddx",content:"\\frac{d}{dx}"}),integral:ba({command:"integral",content:"\\int",ariaLabelKey:"shared-calculator-narration-keypad-key-int"}),"%":Ge({content:"\\%",ariaLabelKey:"shared-calculator-narration-keypad-key-percent-of"}),"->":Ge({content:"\\to",ariaLabelKey:"shared-calculator-narration-keypad-key-action-to"}),with:Ge({typedText:"with",content:"with",ariaLabelKey:"shared-calculator-narration-keypad-key-action-with"}),prime:Ge({typedText:"'",content:"f'",ariaLabelKey:"shared-calculator-narration-keypad-key-prime"}),exp:Ge({}),sign:Ae({}),normaldist:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-normaldist"}),poissondist:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-poissondist"}),binomialdist:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-binomialdist"}),uniformdist:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-uniformdist"}),erf:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-erf"}),histogram:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-histogram"}),boxplot:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-boxplot"}),dotplot:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-dotplot"}),tscore:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-tscore"}),ittest:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-ittest"}),ttest:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-ttest"}),tdist:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-tdist"}),pdf:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-pdf"}),cdf:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-pdf"}),random:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-random"}),inversecdf:Ae({ariaLabelKey:"shared-calculator-narration-keypad-key-inversecdf"}),hsv:Ae({}),rgb:Ae({}),sort:Ae({}),shuffle:Ae({}),unique:Ae({}),join:Ae({}),"A^-1":ba({command:"A^-1",content:"A^{-1}",ariaLabelKey:"matrix-calculator-narration-keypad-key-inverse"}),"A^T":ba({command:"A^T",content:"A^T",ariaLabelKey:"matrix-calculator-narration-keypad-key-transpose"}),"A^2":ba({command:"A^2",content:"A^2",ariaLabelKey:"shared-calculator-narration-keypad-key-squared"}),"A^n":Ge({content:"A^n",typedText:"^",ariaLabelKey:"shared-calculator-narration-keypad-key-exp"}),det:Ae({ariaLabelKey:"matrix-calculator-narration-keypad-key-det"}),trace:Ae({ariaLabelKey:"matrix-calculator-narration-keypad-key-trace"}),rref:Ae({ariaLabelKey:"matrix-calculator-narration-keypad-key-rref"}),a:Ge({}),b:Ge({}),c:Ge({}),d:Ge({}),e:Ge({}),f:Ge({}),g:Ge({}),h:Ge({}),i:Ge({}),j:Ge({}),k:Ge({}),l:Ge({}),m:Ge({}),n:Ge({}),o:Ge({}),p:Ge({}),q:Ge({}),r:Ge({}),s:Ge({}),t:Ge({}),u:Ge({}),v:Ge({}),w:Ge({}),x:Ge({}),boldX:Ge({content:"x",typedText:"x"}),y:Ge({}),boldY:Ge({content:"y",typedText:"y"}),z:Ge({}),boldZ:Ge({content:"z",typedText:"z"}),A:Ge({}),B:Ge({}),C:Ge({}),D:Ge({}),E:Ge({}),F:Ge({}),G:Ge({}),H:Ge({}),I:Ge({}),J:Ge({}),K:Ge({}),L:Ge({}),M:Ge({}),N:Ge({}),O:Ge({}),P:Ge({}),Q:Ge({}),R:Ge({}),S:Ge({}),T:Ge({}),U:Ge({}),V:Ge({}),W:Ge({}),X:Ge({}),Y:Ge({}),Z:Ge({}),0:Ge({}),1:Ge({}),2:Ge({}),3:Ge({}),4:Ge({}),5:Ge({}),6:Ge({}),7:Ge({}),8:Ge({}),9:Ge({}),",":Ge({}),"=":Ge({}),"[":Ge({}),"]":Ge({}),"{}_left":Rb({keys:["{","}"]}),"{}_right":Nb({keys:["{","}"]}),"()_left":Rb({keys:["(",")"]}),"()_right":Nb({keys:["(",")"]}),"[]_left":Rb({keys:["[","]"]}),"[]_right":Nb({keys:["[","]"]}),",'_left":Rb({keys:[",","\u2032"]}),",'_right":Nb({keys:[",","\u2032"],typedText:"'"}),'"':Ge({}),"'":Ge({}),"~":Ge({}),":":Ge({}),">":Ge({}),"<":Ge({}),">=":Ge({content:"\\ge"}),"<=":Ge({content:"\\le"}),"!%_left":Rb({keys:["!","{}^{%}"]}),"!%_right":Nb({keys:["!","{}^{%}"],typedText:"%"}),"~:_left":Rb({keys:["~","{}^{:}"]}),"~:_right":Nb({keys:["~","{}^{:}"],typedText:":"}),"audio-trace-off":Tee({contentKey:"graphing-calculator-button-keypad-audio-trace-off",command:"off"}),"hear-graph":(r,e,t={},i)=>Q.createElement(nr,{command:Q.const(r),disabled:Er(t.disabled,!1),colspan:Er(t.colspan,1),style:Er(t.style,"blue"),ariaLabel:Q.const(void 0),onTap:()=>{e({type:"keypad/audio-trace",command:"hear-graph"})}},Q.createElement("span",{class:Q.const("dcg-play-icon-container")},Q.createElement("i",{class:Q.const("dcg-icon-play"),"aria-hidden":Q.const("true")})),Q.createElement("span",null,()=>i("graphing-calculator-button-audio-trace-hear-graph"))),"stop-graph":(r,e,t={},i)=>Q.createElement(nr,{command:Q.const(r),disabled:Er(t.disabled,!1),colspan:Er(t.colspan,1),style:Er(t.style,"blue"),onTap:()=>{e({type:"keypad/audio-trace",command:"stop-graph"})}},Q.createElement("span",{class:Q.const("dcg-stop-icon-container")},Q.createElement("span",{class:Q.const("dcg-stop-icon")})),Q.createElement("span",null,()=>i("graphing-calculator-button-audio-trace-stop-graph"))),"volume-down":(r,e,t={},i)=>Q.createElement(nr,{command:Q.const(r),ariaLabel:()=>i("graphing-calculator-narration-keypad-key-volume-down"),disabled:Er(t.disabled,!1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"volume-down"})},Q.createElement("span",{class:Q.const("dcg-button-icon dcg-icon-only")},Q.createElement("i",{class:Q.const("dcg-icon-volume-down"),"aria-hidden":Q.const("true")}))),"volume-up":(r,e,t={},i)=>Q.createElement(nr,{command:Q.const(r),ariaLabel:()=>i("graphing-calculator-narration-keypad-key-volume-up"),disabled:Er(t.disabled,!1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"volume-up"})},Q.createElement("span",{class:Q.const("dcg-button-icon dcg-icon-only")},Q.createElement("i",{class:Q.const("dcg-icon-volume-up"),"aria-hidden":Q.const("true")}))),"speed-down":(r,e,t={},i)=>Q.createElement(nr,{command:Q.const(r),ariaLabel:()=>i("graphing-calculator-narration-keypad-key-speed-down"),disabled:Er(t.disabled,!1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"speed-down"})},Q.createElement("span",{class:Q.const("dcg-button-icon dcg-icon-only")},Q.createElement("i",{class:Q.const("dcg-icon-hide"),"aria-hidden":Q.const("true")}))),"speed-up":(r,e,t={},i)=>Q.createElement(nr,{command:Q.const(r),ariaLabel:()=>i("graphing-calculator-narration-keypad-key-speed-up"),disabled:Er(t.disabled,!1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"speed-up"})},Q.createElement("span",{class:Q.const("dcg-button-icon dcg-icon-only")},Q.createElement("i",{class:Q.const("dcg-icon-show"),"aria-hidden":Q.const("true")}))),"previous-point":(r,e,t={},i)=>Q.createElement(nr,{ariaLabel:()=>i("graphing-calculator-narration-keypad-key-previous-point"),command:Q.const(r),disabled:Er(t.disabled,!1),colspan:Er(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"previous-point"})},Q.createElement("span",{class:Q.const("dcg-button-icon dcg-icon-only")},Q.createElement("i",{class:Q.const("dcg-icon-thin-arrow-left"),"aria-hidden":Q.const("true")}))),"next-point":(r,e,t={},i)=>Q.createElement(nr,{ariaLabel:()=>i("graphing-calculator-narration-keypad-key-next-point"),command:Q.const(r),disabled:Er(t.disabled,!1),colspan:Er(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"next-point"})},Q.createElement("span",{class:Q.const("dcg-button-icon dcg-icon-only")},Q.createElement("i",{class:Q.const("dcg-icon-thin-arrow-right"),"aria-hidden":Q.const("true")}))),"previous-poi":(r,e,t={},i)=>Q.createElement(nr,{ariaLabel:()=>i("graphing-calculator-narration-keypad-key-previous-poi"),command:Q.const(r),disabled:Er(t.disabled,!1),colspan:Er(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"previous-poi"})},Q.createElement("span",{class:Q.const("dcg-button-icon dcg-icon-only")},Q.createElement("i",{class:Q.const("dcg-icon-hide"),"aria-hidden":Q.const("true")}))),"next-poi":(r,e,t={},i)=>Q.createElement(nr,{ariaLabel:()=>i("graphing-calculator-narration-keypad-key-next-poi"),command:Q.const(r),disabled:Er(t.disabled,!1),colspan:Er(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"next-poi"})},Q.createElement("span",{class:Q.const("dcg-button-icon dcg-icon-only")},Q.createElement("i",{class:Q.const("dcg-icon-show"),"aria-hidden":Q.const("true")}))),"previous-curve":(r,e,t={},i)=>Q.createElement(nr,{ariaLabel:()=>i("graphing-calculator-narration-keypad-key-previous-curve"),command:Q.const(r),disabled:Er(t.disabled,!1),colspan:Er(t.colspan,1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"previous-curve"})},Q.createElement("span",{class:Q.const("dcg-button-icon dcg-icon-only")},Q.createElement("i",{class:Q.const("dcg-icon-caret-up"),"aria-hidden":Q.const("true")}))),"next-curve":(r,e,t={},i)=>Q.createElement(nr,{ariaLabel:()=>i("graphing-calculator-narration-keypad-key-next-curve"),command:Q.const(r),disabled:Er(t.disabled,!1),style:()=>t.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"next-curve"})},Q.createElement("span",{class:Q.const("dcg-button-icon dcg-icon-only")},Q.createElement("i",{class:Q.const("dcg-icon-caret-down"),"aria-hidden":Q.const("true")})))};function w(r,e,t={}){let i=r.dispatch;return Iee[e](e,i,t,r.s)}function Gr(r=1){return Q.createElement("div",{style:Q.const(`flex-grow:${r}`)})}var Y0=__dcg_shared_module_exports__['h'](z());var j4=__dcg_shared_module_exports__['h'](z()),du=class extends j4.Class{init(){this.controller=this.props.controller()}};var rr=class extends du{template(){return Y0.createElement("div",{class:Y0.const("dcg-basic-keypad dcg-do-not-blur")},this.children)}};var Bb=__dcg_shared_module_exports__['h'](z()),Ve=class extends Bb.Class{template(){return Bb.createElement("div",{class:Bb.const("dcg-keypad-row")},this.children)}};var J0=class extends Mo{template(){return qb.createElement(rr,{controller:this.props.controller},qb.createElement(Ve,null,w(this,"q"),w(this,"w"),w(this,"e"),w(this,"r"),w(this,"t"),w(this,"y"),w(this,"u"),w(this,"i"),w(this,"o"),w(this,"p")),qb.createElement(Ve,null,w(this,"a"),w(this,"s"),w(this,"d"),w(this,"f"),w(this,"g"),w(this,"h"),w(this,"j"),w(this,"k"),w(this,"l"),w(this,"theta")),qb.createElement(Ve,null,w(this,"shift",{colspan:1.364,style:"highlight"}),Gr(.136),w(this,"z"),w(this,"x"),w(this,"c"),w(this,"v"),w(this,"b"),w(this,"n"),w(this,"m"),Gr(.136),w(this,"backspace",{colspan:1.364,style:"highlight"})),qb.createElement(Ve,null,w(this,"123",{colspan:1.818,style:"highlight"}),Gr(.182),w(this,"a_b"),w(this,"!%_left"),w(this,"[]_left"),w(this,"{}_left"),w(this,"~:_left"),w(this,",'_left"),Gr(.182),w(this,"enter",{colspan:1.818,style:"blue"})))}};var Kb=__dcg_shared_module_exports__['h'](z());var X0=class extends Mo{template(){return Kb.createElement(rr,{controller:this.props.controller},Kb.createElement(Ve,null,w(this,"Q"),w(this,"W"),w(this,"E"),w(this,"R"),w(this,"T"),w(this,"Y"),w(this,"U"),w(this,"I"),w(this,"O"),w(this,"P")),Kb.createElement(Ve,null,w(this,"A"),w(this,"S"),w(this,"D"),w(this,"F"),w(this,"G"),w(this,"H"),w(this,"J"),w(this,"K"),w(this,"L"),w(this,"tau")),Kb.createElement(Ve,null,w(this,"shift",{colspan:1.364,active:!0,style:"highlight"}),Gr(.136),w(this,"Z"),w(this,"X"),w(this,"C"),w(this,"V"),w(this,"B"),w(this,"N"),w(this,"M"),Gr(.136),w(this,"backspace",{colspan:1.364,style:"highlight"})),Kb.createElement(Ve,null,w(this,"123",{colspan:1.818,style:"highlight"}),Gr(.182),w(this,"a^b"),w(this,"!%_right"),w(this,"[]_right"),w(this,"{}_right"),w(this,"~:_right"),w(this,",'_right"),Gr(.182),w(this,"enter",{colspan:1.818,style:"blue"})))}};var Ua=__dcg_shared_module_exports__['h'](z());var Q0=class extends Mo{template(){return Ua.createElement(rr,{controller:this.props.controller},Ua.createElement(Ve,null,w(this,"boldX"),w(this,"boldY"),w(this,"a^2"),w(this,"a^b"),Gr(.5),w(this,"7",{style:"highlight"}),w(this,"8",{style:"highlight"}),w(this,"9",{style:"highlight"}),w(this,"division"),Gr(.5),Ua.createElement(nr,{command:this.const("functions"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-functions"),colspan:this.const(2),style:this.const("highlight"),active:()=>this.controller.isKeypadFunctionsPopoverOpen(),onTap:()=>this.dispatch({type:"keypad/functions"}),ariaControls:this.const(`dcg-functions-popover-${Mo.uuid}`),ariaExpanded:()=>this.controller.isKeypadFunctionsPopoverOpen()},this.bindFn(this.getFuncsBtnText))),Ua.createElement(Ve,null,w(this,"("),w(this,")"),w(this,"<"),w(this,">"),Gr(.5),w(this,"4",{style:"highlight"}),w(this,"5",{style:"highlight"}),w(this,"6",{style:"highlight"}),w(this,"multiplication"),Gr(.5),w(this,"left",{style:"highlight"}),w(this,"right",{style:"highlight"})),Ua.createElement(Ve,null,w(this,"|a|"),w(this,","),w(this,"<="),w(this,">="),Gr(.5),w(this,"1",{style:"highlight"}),w(this,"2",{style:"highlight"}),w(this,"3",{style:"highlight"}),w(this,"-"),Gr(1),w(this,"backspace",{colspan:1.5,style:"highlight"})),Ua.createElement(Ve,null,Ua.createElement("div",{class:Ua.const("dcg-abc-audio-container")},Ua.createElement(nr,{command:Ua.const("ABC"),colspan:this.const(1),ariaLabel:()=>this.controller.s("graphing-calculator-narration-toggle-letters"),style:this.const("highlight"),onTap:()=>{this.dispatch({type:"keypad/abc"})}},()=>this.controller.getLayoutMeasurements().width<=600?this.controller.raw("ABC"):this.controller.raw("A B C")),Ua.createElement(nr,{command:Ua.const("Audio"),disabled:()=>!this.controller.canAudioTrace(),ariaLabel:()=>this.controller.s("graphing-calculator-narration-toggle-audio-trace"),colspan:this.const(1),style:()=>"highlight",onTap:()=>this.dispatch({type:"keypad/audio-trace",command:"on"})},Ua.createElement("i",{class:Ua.const("dcg-icon-volume"),"aria-hidden":Ua.const("true")}))),w(this,"sqrt"),w(this,"pi"),Gr(.5),w(this,"0",{style:"highlight"}),w(this,".",{style:"highlight"}),w(this,"="),w(this,"+"),Gr(.5),w(this,"enter",{colspan:2,style:"blue"})))}getFuncsBtnText(){return this.controller.isNarrow()?this.controller.s("graphing-calculator-button-funcs"):this.controller.s("graphing-calculator-button-functions")}};var Ha=__dcg_shared_module_exports__['h'](z());var Z0=class extends Mo{template(){return Ha.createElement(rr,{controller:this.props.controller},Ha.createElement(Ve,null,w(this,"boldX"),w(this,"boldY"),w(this,"boldZ"),w(this,"a^b"),Gr(.5),w(this,"7",{style:"highlight"}),w(this,"8",{style:"highlight"}),w(this,"9",{style:"highlight"}),w(this,"division"),Gr(.5),Ha.createElement(nr,{command:this.const("functions"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-functions"),colspan:this.const(2),style:this.const("highlight"),active:()=>this.controller.isKeypadFunctionsPopoverOpen(),onTap:()=>this.dispatch({type:"keypad/functions"}),ariaControls:this.const(`dcg-functions-popover-${Mo.uuid}`),ariaExpanded:()=>this.controller.isKeypadFunctionsPopoverOpen()},this.bindFn(this.getFuncsBtnText))),Ha.createElement(Ve,null,w(this,"("),w(this,")"),w(this,"<"),w(this,">"),Gr(.5),w(this,"4",{style:"highlight"}),w(this,"5",{style:"highlight"}),w(this,"6",{style:"highlight"}),w(this,"multiplication"),Gr(.5),w(this,"left",{style:"highlight"}),w(this,"right",{style:"highlight"})),Ha.createElement(Ve,null,w(this,"|a|"),w(this,","),w(this,"<="),w(this,">="),Gr(.5),w(this,"1",{style:"highlight"}),w(this,"2",{style:"highlight"}),w(this,"3",{style:"highlight"}),w(this,"-"),Gr(1),w(this,"backspace",{colspan:1.5,style:"highlight"})),Ha.createElement(Ve,null,Ha.createElement("div",{class:Ha.const("dcg-abc-audio-container")},Ha.createElement(nr,{command:Ha.const("ABC"),colspan:this.const(1),ariaLabel:()=>this.controller.s("graphing-calculator-narration-toggle-letters"),style:this.const("highlight"),onTap:()=>{this.dispatch({type:"keypad/abc"})}},()=>this.controller.getLayoutMeasurements().width<=600?this.controller.raw("ABC"):this.controller.raw("A B C")),Ha.createElement(nr,{command:Ha.const("Audio"),disabled:()=>!this.controller.canAudioTrace(),ariaLabel:()=>this.controller.s("graphing-calculator-narration-toggle-audio-trace"),colspan:this.const(1),style:()=>"highlight",onTap:()=>this.dispatch({type:"keypad/audio-trace",command:"on"})},Ha.createElement("i",{class:Ha.const("dcg-icon-volume"),"aria-hidden":Ha.const("true")}))),w(this,"sqrt"),w(this,"pi"),Gr(.5),w(this,"0",{style:"highlight"}),w(this,".",{style:"highlight"}),w(this,"="),w(this,"+"),Gr(.5),w(this,"enter",{colspan:2,style:"blue"})))}getFuncsBtnText(){return this.controller.isNarrow()?this.controller.s("graphing-calculator-button-funcs"):this.controller.s("graphing-calculator-button-functions")}};var zb=__dcg_shared_module_exports__['h'](z());var eG=class extends Mo{template(){return zb.createElement(rr,{controller:this.props.controller},zb.createElement(Ve,null,w(this,"a"),w(this,"b"),w(this,"c"),w(this,"d"),w(this,"e"),w(this,"f"),w(this,"g"),w(this,"h"),w(this,"i"),w(this,"j")),zb.createElement(Ve,null,w(this,"k"),w(this,"l"),w(this,"m"),w(this,"n"),w(this,"o"),w(this,"p"),w(this,"q"),w(this,"r"),w(this,"s"),w(this,"t")),zb.createElement(Ve,null,w(this,"shift",{style:"highlight"}),w(this,"u"),w(this,"v"),w(this,"w"),w(this,"x"),w(this,"y"),w(this,"z"),w(this,"theta"),w(this,"backspace",{colspan:2,style:"highlight"})),zb.createElement(Ve,null,w(this,"123",{colspan:2,style:"highlight"}),w(this,"a_b"),w(this,"!%_left"),w(this,"[]_left"),w(this,"{}_left"),w(this,"~:_left"),w(this,",'_left"),w(this,"enter",{colspan:2,style:"blue"})))}};var Ub=__dcg_shared_module_exports__['h'](z());var tG=class extends Mo{template(){return Ub.createElement(rr,{controller:this.props.controller},Ub.createElement(Ve,null,w(this,"A"),w(this,"B"),w(this,"C"),w(this,"D"),w(this,"E"),w(this,"F"),w(this,"G"),w(this,"H"),w(this,"I"),w(this,"J")),Ub.createElement(Ve,null,w(this,"K"),w(this,"L"),w(this,"M"),w(this,"N"),w(this,"O"),w(this,"P"),w(this,"Q"),w(this,"R"),w(this,"S"),w(this,"T")),Ub.createElement(Ve,null,w(this,"shift",{style:"highlight"}),w(this,"U"),w(this,"V"),w(this,"W"),w(this,"X"),w(this,"Y"),w(this,"Z"),w(this,"tau"),w(this,"backspace",{colspan:2,style:"highlight"})),Ub.createElement(Ve,null,w(this,"123",{colspan:2,style:"highlight"}),w(this,"a^b"),w(this,"!%_right"),w(this,"[]_right"),w(this,"{}_right"),w(this,"~:_right"),w(this,",'_right"),w(this,"enter",{colspan:2,style:"blue"})))}};var Ke=__dcg_shared_module_exports__['h'](z());var{IfElse:Vee}=Ke.Components,rG=460,iG=class extends Mo{template(){return Ke.createElement(rr,{controller:this.props.controller},Ke.createElement("div",{class:Ke.const("dcg-audio-keypad-container")},Ke.createElement("div",{class:Ke.const("dcg-audio-keypad-column dcg-playback-column")},Ke.createElement(Me,{tooltip:this.bindFn(this.getDisabledTooltipText),gravity:this.const("s"),sticky:this.const(!1)},Ke.createElement("div",{class:Ke.const("dcg-btn-playback")},Vee(()=>this.controller.isAudioTracing(),{true:()=>w(this,"stop-graph",{disabled:this.bindFn(this.isAudioDisabled)}),false:()=>w(this,"hear-graph",{disabled:this.bindFn(this.isAudioDisabled)})}))),Ke.createElement("div",{class:Ke.const("dcg-key-nav-section-container")},Ke.createElement(Me,{tooltip:this.bindFn(this.getDisabledTooltipText),gravity:this.const("s"),sticky:this.const(!1)},Ke.createElement("div",{class:Ke.const("dcg-key-nav-section")},w(this,"volume-down",{disabled:this.bindFn(this.isVolumeDownDisabled)}),Ke.createElement("div",{role:Ke.const("heading"),"aria-level":Ke.const("2"),class:()=>({"dcg-key-nav-section-title-container":!0,"dcg-disabled":this.isAudioDisabled()})},Ke.createElement("span",{class:Ke.const("dcg-key-nav-section-title")},()=>this.controller.s("graphing-calculator-label-audio-trace-volume")),Ke.createElement("span",{class:Ke.const("dcg-keypad-volume-value dcg-key-nav-section-value")},()=>this.getAudioTraceVolume())),w(this,"volume-up",{disabled:this.bindFn(this.isVolumeUpDisabled)})))),Ke.createElement("div",{class:Ke.const("dcg-key-nav-section-container")},Ke.createElement(Me,{tooltip:this.bindFn(this.getDisabledTooltipText),gravity:this.const("s"),sticky:this.const(!1)},Ke.createElement("div",{class:Ke.const("dcg-key-nav-section")},w(this,"speed-down",{disabled:this.bindFn(this.isSpeedDownDisabled)}),Ke.createElement("div",{class:()=>({"dcg-key-nav-section-title-container":!0,"dcg-disabled":this.isAudioDisabled()}),role:Ke.const("heading"),"aria-level":Ke.const("2")},Ke.createElement("span",{class:Ke.const("dcg-key-nav-section-title")},()=>this.controller.s("graphing-calculator-label-audio-trace-speed")),Ke.createElement("span",{class:Ke.const("dcg-keypad-speed-value dcg-key-nav-section-value")},()=>this.getAudioTraceSpeed())),w(this,"speed-up",{disabled:this.bindFn(this.isSpeedUpDisabled)})))),w(this,"audio-trace-off",{style:"highlight"})),Ke.createElement("div",{class:Ke.const("dcg-audio-keypad-spacer")}),Ke.createElement("div",{class:Ke.const("dcg-audio-keypad-column dcg-navigation-column")},Ke.createElement("span",{class:Ke.const("dcg-key-section-title dcg-center-col"),role:Ke.const("heading"),"aria-level":Ke.const("2")},()=>this.controller.s("graphing-calculator-heading-audio-trace-navigation")),Ke.createElement("div",{class:Ke.const("dcg-key-nav-section dcg-center-col")},w(this,"previous-point",{disabled:this.bindFn(this.isPrevPointDisabled)}),Ke.createElement("div",{class:Ke.const("dcg-key-nav-section-title-container"),role:Ke.const("heading"),"aria-level":Ke.const("2")},()=>this.controller.s("graphing-calculator-label-audio-trace-point")),w(this,"next-point",{disabled:this.bindFn(this.isNextPointDisabled)})),Ke.createElement("div",{class:Ke.const("dcg-key-nav-section")},w(this,"previous-poi",{disabled:this.bindFn(this.isPrevPOIDisabled)}),Ke.createElement("div",{class:Ke.const("dcg-key-nav-section-title-container dcg-poi-section-container"),role:Ke.const("heading"),"aria-level":Ke.const("2")},Ke.createElement(si,{i18n:this.const(this.controller),key:this.const("graphing-calculator-heading-keypad-audio-trace-point-of-interest")},Ke.createElement("span",{class:Ke.const("dcg-key-nav-section-value")},Ke.const("Point")),Ke.createElement("span",{class:Ke.const("dcg-key-nav-section-title")},Ke.const("of Interest")))),w(this,"next-poi",{disabled:this.bindFn(this.isNextPOIDisabled)})),Ke.createElement("div",{class:Ke.const("dcg-key-nav-section dcg-center-col")},w(this,"previous-curve",{disabled:this.bindFn(this.isPrevCurveDisabled)}),Ke.createElement("div",{class:Ke.const("dcg-key-nav-section-title-container"),role:Ke.const("heading"),"aria-level":Ke.const("2")},()=>this.controller.s("graphing-calculator-label-audio-trace-curve")),w(this,"next-curve",{disabled:this.bindFn(this.isNextCurveDisabled)}))),Ke.createElement("div",{class:Ke.const("dcg-audio-keypad-spacer")}),Ke.createElement("div",{class:Ke.const("dcg-audio-keypad-column dcg-screenreader-options")},Ke.createElement("span",{class:Ke.const("dcg-key-section-title"),role:Ke.const("heading"),"aria-level":Ke.const("2")},()=>this.layoutWidth()<=rG?this.controller.s("graphing-calculator-heading-audio-trace-describe"):this.controller.s("graphing-calculator-heading-audio-trace-screen-reader"),Ke.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-audio-trace-need-screen-reader"),gravity:this.const("s"),sticky:this.const(!0)},Ke.createElement("i",{class:Ke.const("dcg-icon-question-sign"),"aria-hidden":Ke.const("true")}))),Ke.createElement(nr,{command:Ke.const("describe-point"),colspan:this.const(1),style:this.const("default"),onTap:()=>{this.dispatch({type:"keypad/audio-trace",command:"describe-point"})}},Ke.createElement("span",null,()=>this.layoutWidth()<=rG?this.controller.s("graphing-calculator-button-keypad-describe-point-short"):this.controller.s("graphing-calculator-button-keypad-describe-point"))),Ke.createElement(nr,{command:Ke.const("describe-curve"),colspan:this.const(1),style:this.const("default"),onTap:()=>{this.dispatch({type:"keypad/audio-trace",command:"describe-curve"})}},Ke.createElement("span",null,()=>this.layoutWidth()<=rG?this.controller.s("graphing-calculator-button-keypad-describe-curve-short"):this.controller.s("graphing-calculator-button-keypad-describe-curve"))),Ke.createElement(nr,{command:Ke.const("describe-axes"),colspan:this.const(1),style:this.const("default"),onTap:()=>{this.dispatch({type:"keypad/audio-trace",command:"describe-axes"})}},Ke.createElement("span",null,()=>this.layoutWidth()<=rG?this.controller.s("graphing-calculator-label-axes"):this.controller.s("graphing-calculator-button-keypad-describe-axes"))))))}layoutWidth(){return this.controller.getLayoutMeasurements().width}isPrevPointDisabled(){let r=this.controller.getAudioGraph();return r?!r.agNavigator.canMoveToPrevPoint():!0}isNextPointDisabled(){let r=this.controller.getAudioGraph();return r?!r.agNavigator.canMoveToNextPoint():!0}isPrevPOIDisabled(){let r=this.controller.getAudioGraph();return r?!r.agNavigator.canMoveToPrevPOI():!0}isNextPOIDisabled(){let r=this.controller.getAudioGraph();return r?!r.agNavigator.canMoveToNextPOI():!0}isPrevCurveDisabled(){let r=this.controller.getAudioGraph();return r?!r.agNavigator.canMoveToPrevCurve():!0}isNextCurveDisabled(){let r=this.controller.getAudioGraph();return r?!r.agNavigator.canMoveToNextCurve():!0}isAudioDisabled(){return!this.controller.getAudio()}getAudioTraceVolume(){let r=this.controller.getAudioGraph();return!r||this.isAudioDisabled()?"0%":`${r.getAudioVolume()*100}%`}isVolumeDownDisabled(){let r=this.controller.getAudioGraph();return!r||this.isAudioDisabled()?!0:r.getAudioVolume()<=0}isVolumeUpDisabled(){let r=this.controller.getAudioGraph();return!r||this.isAudioDisabled()?!0:r.getAudioVolume()>=1}getAudioTraceSpeed(){let r=this.controller.getAudioGraph();return!r||this.isAudioDisabled()?"0":bw[r.getAudioSpeedIndex()].displayedSpeed}isSpeedDownDisabled(){let r=this.controller.getAudioGraph();return!r||this.isAudioDisabled()?!0:r.getAudioSpeedIndex()<=0}isSpeedUpDisabled(){let r=this.controller.getAudioGraph();return!r||this.isAudioDisabled()?!0:r.getAudioSpeedIndex()===bw.length-1}getDisabledTooltipText(){return this.isAudioDisabled()?this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"):""}};var Xr=__dcg_shared_module_exports__['h'](z());var{If:TL,For:Y4}=Xr.Components,oG=class extends Mo{template(){return Xr.createElement("div",{class:()=>({"dcg-functions-popover":!0,"dcg-popover":!0,"dcg-top":!0,"dcg-two-column":this.shouldRenderWithTwoColumns()}),id:this.const(`dcg-functions-popover-${Mo.uuid}`),role:Xr.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-button-functions")},Xr.createElement("div",{class:Xr.const("dcg-popover-interior")},Xr.createElement("div",{class:Xr.const("dcg-interior-buttons")},Xr.createElement(Y4,{each:this.bindFn(this.getKeypadKeys),key:r=>r.id},Xr.createElement("div",{class:Xr.const("dcg-basic-keypad dcg-do-not-blur")},r=>Xr.createElement("div",{class:Xr.const("dcg-keypad-keys-section")},Xr.createElement(TL,{predicate:()=>r.title!==void 0},()=>Xr.createElement("div",{class:Xr.const("dcg-section-heading"),role:Xr.const("heading"),"aria-level":Xr.const("2")},()=>r.title,Xr.createElement(TL,{predicate:()=>!!r.helpLink},()=>Xr.createElement("a",{href:()=>r.helpLink.url,target:Xr.const("_blank"),"aria-label":()=>r.helpLink.tooltip},Xr.createElement("i",{class:Xr.const("dcg-icon-question-sign"),"aria-hidden":Xr.const("true")}))))),Xr.createElement(TL,{predicate:()=>r.title===void 0},()=>Xr.createElement("div",{class:Xr.const("dcg-popover-section-separator"),role:Xr.const("separator")})),Xr.createElement(Y4,{each:()=>r.keys},Xr.createElement("div",{class:Xr.const("dcg-keypad-keys-buttons")},e=>this.b(e)))))))),Xr.createElement("div",{class:Xr.const("dcg-arrow")}))}shouldRenderWithTwoColumns(){let r=this.controller.getGraphSettings().config.projectorMode?410:375;return this.controller.getLayoutMeasurements().width<r}getInverseTrigSection(){let r=this.controller.areFunctionsRestricted()?["arcsin","arccos","arctan"]:["arcsin","arccos","arctan","arccsc","arcsec","arccot"];return{id:"inversetrig",title:this.controller.s("graphing-calculator-heading-inverse-trig"),keys:r}}getGeometryTools(){let r=["midpoint","intersection","segment","line","ray","vector","parallel","perpendicular","circle","arc","angle","directedangle","polygon","glider"];return{id:"geometry-tools",title:this.controller.s("graphing-calculator-heading-geometry-tools"),keys:r}}getGeometryTransformations(){let r=["dilate","rotate","reflect","translate"];return{id:"geometry-transformations",title:this.controller.s("graphing-calculator-heading-geometry-transformations"),keys:r}}getGeometryMeasurements(){let r=["distance","length","area","perimeter","vertices","angles","directedangles","segments","radius","center","coterminal","supplement"];return{id:"geometry-measurements",title:this.controller.s("graphing-calculator-heading-geometry-measurements"),keys:r}}getCalculatorGeometryMethods(){let r=!this.controller.areFunctionsRestricted()||this.controller.areGeometryFunctionsForceEnabled(),e=this.controller.isThreeDMode()?["segment","triangle","sphere","vector"]:["polygon"],t=this.controller.isThreeDMode()?["length","distance","midpoint"]:["distance","midpoint"],i=r?t:[];return{id:"geometry",title:this.controller.s("graphing-calculator-heading-geometry"),keys:[...e,...i]}}getTrigSection(){let r=this.controller.areFunctionsRestricted()?["sin","cos","tan"]:["sin","cos","tan","csc","sec","cot"];return{id:"trig",title:this.controller.s("graphing-calculator-heading-trig"),keys:r}}getHyperbolicTrigSection(){let r=this.controller.areFunctionsRestricted()?["sinh","cosh","tanh"]:["sinh","cosh","tanh","csch","sech","coth"];return{id:"hyperbtrig",title:this.controller.s("graphing-calculator-heading-hyperbolic-trig"),keys:r}}getListFunctions(){return{id:"lists",title:this.controller.s("graphing-calculator-heading-lists"),keys:["join","sort","shuffle","unique","for"]}}getStatTests(){return{id:"stat-tests",title:this.controller.s("graphing-calculator-heading-stat-tests"),keys:["ttest","tscore","ittest"]}}getStatsSection(){let r=["mean","median","min","max","quartile","quantile","stdev","stdevp","var"];return this.controller.areFunctionsRestricted()||(r=r.concat(["mad","cov","covp"])),r=r.concat(["corr","spearman","stats","count","total"]),{id:"stats",title:this.controller.s("graphing-calculator-heading-stats"),keys:r}}getMiscSection(){return{title:this.controller.s("graphing-calculator-button-functions-menu-number-theory"),id:"misc",keys:["lcm","gcd","mod","ceil","floor","round","sign","nthroot","nPr","nCr"]}}getVisualizationsSection(){return{title:this.controller.s("graphing-calculator-heading-dist-tab-visualizations"),id:"visualizations",keys:["histogram","dotplot","boxplot"],helpLink:{url:"https://help.desmos.com/hc/en-us/articles/360022405991-Data-Visualizations",tooltip:this.controller.s("graphing-calculator-narration-dist-tab-visualizations")}}}getCalculusSection(){return{title:this.controller.s("graphing-calculator-heading-calculus"),id:"calculus",keys:["exp","ln","log","loga","ddx","prime","integral","sum","prod"]}}getDistributionsSection(){return{title:this.controller.s("graphing-calculator-heading-dist-tab-distributions"),id:"distributions",keys:["normaldist","tdist","poissondist","binomialdist","uniformdist","pdf","cdf","inversecdf","random"],helpLink:{url:"https://help.desmos.com/hc/en-us/articles/360022401451-Distributions",tooltip:this.controller.s("graphing-calculator-narration-dist-tab-distributions")}}}getColorsSection(){return{title:this.controller.s("graphing-calculator-button-functions-menu-custom-colors"),id:"colors",keys:["rgb","hsv"],helpLink:{url:"https://help.desmos.com/hc/en-us/articles/4406795899533-Custom-Colors",tooltip:this.controller.s("graphing-calculator-button-functions-menu-custom-colors")}}}getAdvancedSection(){return{title:this.controller.s("graphing-calculator-heading-functions-menu-advanced"),id:"advanced",keys:["->","with"],helpLink:{url:"https://help.desmos.com/hc/en-us/sections/4406370087053-Advanced-Features",tooltip:this.controller.s("graphing-calculator-heading-functions-menu-advanced")}}}getKeypadKeys(){let r=[this.getTrigSection(),this.getInverseTrigSection(),this.getStatsSection(),this.getListFunctions()];return this.controller.areDistributionsEnabled()&&(this.controller.isThreeDMode()||r.push(this.getVisualizationsSection()),r.push(this.getDistributionsSection()),r.push(this.getStatTests())),r.push(this.getCalculusSection()),r.push(this.getHyperbolicTrigSection()),this.controller.isGeometry()?(r.push(this.getGeometryTools()),r.push(this.getGeometryMeasurements()),r.push(this.getGeometryTransformations())):r.push(this.getCalculatorGeometryMethods()),r.push(this.getColorsSection()),r.push(this.getMiscSection()),this.controller.areActionsEnabled()&&r.push(this.getAdvancedSection()),r}b(r){return w(this,r,{style:"popover"})}};var{SwitchUnion:Mee,If:IL}=Bt.Components,nG=class extends Mo{template(){return Bt.createElement("div",{class:Bt.const("dcg-keypad"),role:Bt.const("region"),"aria-label":()=>this.controller.s("shared-calculator-narration-keypad")},Bt.createElement("div",{class:()=>({"dcg-keys-container":!0,"dcg-smaller-functions-text":this.controller.getLayoutMeasurements().width<650,"dcg-small-ABC":this.controller.getLayoutMeasurements().width<490,"dcg-smaller-ABC":this.controller.getLayoutMeasurements().width<420,"dcg-smallest-ABC":this.controller.getLayoutMeasurements().width<380}),style:this.bindFn(this.computeStyles),didMount:this.bindFn(this.didMountContainer),"aria-hidden":()=>!this.controller.isKeypadOpen()},Bt.createElement("div",{class:Bt.const("dcg-keys-background dcg-do-not-blur"),style:()=>({background:this.controller.getPillboxBackgroundColor()})},Bt.createElement("div",{class:Bt.const("dcg-keys")},Mee(()=>this.controller.getKeypadLayout(),{letters:()=>Bt.createElement(J0,{controller:this.props.controller}),capitalLetters:()=>Bt.createElement(X0,{controller:this.props.controller}),mainNumbers:()=>Bt.createElement(Q0,{controller:this.props.controller}),mainNumbers3D:()=>Bt.createElement(Z0,{controller:this.props.controller}),noQwertyLetters:()=>Bt.createElement(eG,{controller:this.props.controller}),noQwertyCapitalLetters:()=>Bt.createElement(tG,{controller:this.props.controller}),audio:()=>Bt.createElement(iG,{controller:this.props.controller})}),Bt.createElement(IL,{predicate:()=>this.controller.isKeypadFunctionsPopoverOpen()},()=>Bt.createElement(oG,{controller:this.props.controller}))),Bt.createElement(IL,{predicate:()=>this.controller.isHideKeypadButtonVisible()},()=>Bt.createElement("div",{class:Bt.const("dcg-minimize-keypad-container")},Bt.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-hide-keypad"),gravity:this.const("n"),offset:this.const({left:6})},Bt.createElement("div",{role:Bt.const("button"),"aria-expanded":Bt.const("true"),"aria-controls":this.const(Mo.uuid),"aria-label":()=>this.controller.s("graphing-calculator-label-hide-keypad"),class:Bt.const("dcg-minimize-keypad"),style:()=>({"border-bottom-color":this.controller.getPillboxBackgroundColor(),background:this.controller.getPillboxBackgroundColor()}),onTap:()=>{this.controller.dispatch({type:"keypad/set-minimized",minimized:!0})}},Bt.createElement("i",{class:Bt.const("dcg-icon-keyboard"),"aria-hidden":Bt.const("true")}),Bt.createElement("i",{class:Bt.const("dcg-icon-caret-down"),"aria-hidden":Bt.const("true")}))))))),Bt.createElement(IL,{predicate:this.bindFn(this.isShowKeypadButtonVisible)},()=>Bt.createElement("div",{class:Bt.const("dcg-show-keypad-container")},Bt.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-show-keypad"),gravity:this.const("n")},Bt.createElement("div",{role:Bt.const("button"),"aria-expanded":Bt.const("false"),"aria-controls":this.const(Mo.uuid),"aria-label":()=>this.controller.s("graphing-calculator-label-show-keypad"),class:Bt.const("dcg-btn-flat-gray dcg-show-keypad dcg-do-not-blur"),style:()=>({background:this.controller.getPillboxBackgroundColor()}),onTap:()=>{this.controller.dispatch({type:"keypad/set-minimized",minimized:!1})}},Bt.createElement("i",{class:Bt.const("dcg-icon-keyboard"),"aria-hidden":Bt.const("true")}),Bt.createElement("i",{class:Bt.const("dcg-icon-caret-up dcg-do-not-blur"),"aria-hidden":Bt.const("true")}))))))}didMountContainer(r){this.containerElt=r}isShowKeypadButtonVisible(){return this.controller.getBrailleMode()!=="none"?!1:!this.controller.isKeypadOpen()&&!this.controller.isNarrow()&&!this.controller.isInEditListMode()&&(this.controller.isListVisible()||this.controller.inAudioTraceMode())}didMount(){this.updatePopoverPosition()}didUpdate(){this.updatePopoverPosition()}computeStyles(){let r={};return this.controller.isNarrow()||(r.transition="transform .3s, opacity .3s"),this.controller.isKeypadOpen()||(r.opacity="0",r.transform="translate3d(0, 255px, 0)"),r}updatePopoverPosition(){if(!this.controller.isKeypadFunctionsPopoverOpen()){this.__popoverCache=void 0;return}let r=this.controller.computeMajorLayout(),e={keypadTop:r.keypad.top,keypadWidth:r.keypad.width,keypadHeight:r.keypad.height,showToLeft:r.grapher.height<525};if(__dcg_shared_module_exports__['P'](e,this.__popoverCache))return;this.__popoverCache=e;let t=this.containerElt,i=t.querySelector("[dcg-command=functions]"),o=t.querySelector(".dcg-functions-popover"),n=t.querySelector(".dcg-arrow");if(e.showToLeft){o.classList.remove("dcg-top"),o.classList.add("dcg-left");var a=e.keypadHeight-(ao(i).top-ao(t).top),s=a-i.offsetHeight/2-2-10;n.style.left="auto",n.style.bottom=`${s}px`}else o.classList.remove("dcg-left"),o.classList.add("dcg-top"),n.style.left=`${o.offsetWidth-i.offsetWidth/2}px`,n.style.bottom="auto"}};var Mi=__dcg_shared_module_exports__['h'](z());var Ii=__dcg_shared_module_exports__['h'](z()),{SwitchUnion:Aee}=Ii.Components,Pv=class extends Ii.Class{template(){return this.controller=this.props.controller(),Aee(()=>this.controller.getBrandingMode(),{"static-edit-link":()=>Ii.createElement("div",{class:Ii.const("dcg-graphpaper-branding")},Ii.createElement("a",{href:()=>this.controller.getEditLink(),target:Ii.const("_blank")},Ii.createElement("span",{class:Ii.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-on-desmos")},()=>this.controller.s("graphing-calculator-link-edit-on-desmos")),Ii.createElement("i",{class:Ii.const("dcg-icon-desmos"),"aria-hidden":Ii.const("true")}))),"edit-link":()=>Ii.createElement("div",{class:Ii.const("dcg-graphpaper-branding")},Ii.createElement("span",{class:Ii.const("dcg-edit-branding"),onTap:()=>this.controller.dispatch({type:"open-on-web"})},Ii.createElement("span",{class:Ii.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-on-desmos")},()=>this.controller.s("graphing-calculator-link-edit-on-desmos")),Ii.createElement("i",{class:Ii.const("dcg-icon-desmos"),"aria-hidden":Ii.const("true")}))),"powered-by":()=>Ii.createElement("div",{class:Ii.const("dcg-graphpaper-branding dcg-unclickable")},Ii.createElement("span",{class:Ii.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-powered-by-desmos")},()=>this.controller.s("graphing-calculator-label-powered-by")),Ii.createElement("i",{class:Ii.const("dcg-icon-desmos"),"aria-hidden":Ii.const("true")}))})}};var le=__dcg_shared_module_exports__['h'](z());xt();var Ia=__dcg_shared_module_exports__['h'](z());var{If:Lee}=Ia.Components,wh=class extends Ia.Class{init(){this.controller=this.props.controller()}template(){return Ia.createElement(Me,{tooltip:this.bindFn(this.getTooltip),gravity:this.const("w")},Ia.createElement("div",{class:()=>({"dcg-action-settings":!0,"dcg-pillbox-btn-interior":!0,"dcg-icon-btn":!0,"dcg-btn-flat-gray":this.isPillbox(),"dcg-settings-pillbox":this.isPillbox()}),style:()=>({background:this.isPillbox()?this.controller.getPillboxBackgroundColor():void 0}),role:Ia.const("button"),tabindex:Ia.const("0"),"aria-haspopup":Ia.const("true"),"aria-expanded":()=>this.controller.isGraphSettingsOpen(),"aria-label":this.bindFn(this.getTooltip),onTap:this.bindFn(this.onTapSettingsButton),manageFocus:this.const(Qe({controller:this.controller,location:{type:"settings",location:"icon"}}))},Ia.createElement("i",{class:Ia.const("dcg-icon-wrench"),"aria-hidden":Ia.const("true")}),Ia.createElement(Lee,{predicate:()=>this.controller.getLockViewportUserSetting()},()=>Ia.createElement("i",{class:Ia.const("dcg-icon-lock"),"aria-hidden":Ia.const("true")}))))}getTooltip(){return this.controller.isGeometry()?this.controller.s("graphing-calculator-label-tooltip-geometry-settings"):this.controller.s("graphing-calculator-label-tooltip-graph-settings")}isPillbox(){return this.props.isPillbox&&this.props.isPillbox()}onTapSettingsButton(e){this.controller.dispatch({type:"toggle-graph-settings",focusOnOpen:e.device==="keyboard"})}};var Vi=__dcg_shared_module_exports__['h'](z());var vh=__dcg_shared_module_exports__['h'](z());var Yg=class extends vh.Class{template(){return vh.createElement("div",{class:vh.const("dcg-checkbox-title dcg-lock-viewport-option")},vh.createElement(st,{ariaLabel:()=>this.props.controller().s("graphing-calculator-label-settings-lock-viewport"),onChange:()=>{this.props.controller().dispatch({type:"toggle-lock-viewport"})},checked:()=>this.props.controller().getLockViewportUserSetting()},()=>this.props.controller().s("graphing-calculator-label-settings-lock-viewport")),vh.createElement(xh,{href:this.const("https://help.desmos.com/hc/en-us/articles/4405296853517#h_01FZX4DBWKD83TZVMH615XF3QA"),controller:this.props.controller}))}};var{If:aG}=Vi.Components,sG=class extends Vi.Class{init(){this.controller=this.props.controller(),this.isOpen=this.getAxisScale("x")==="logarithmic"||this.getAxisScale("y")==="logarithmic"||this.props.controller().getLockViewportUserSetting()}template(){return Vi.createElement("div",{class:Vi.const("dcg-advanced-viewport-settings-view")},Vi.createElement(aG,{predicate:()=>this.shouldShowLogScalesOption()},()=>Vi.createElement("div",null,Vi.createElement("div",{class:()=>({"dcg-advanced-toggle":!0,"dcg-margin-top":!0,"dcg-opened":this.isOpen}),onTap:this.bindFn(this.toggleOpen),tabindex:Vi.const(0),role:Vi.const("button"),"aria-pressed":()=>this.isOpen},Vi.createElement("div",{class:Vi.const("dcg-caret-container")},Vi.createElement("i",{class:Vi.const("dcg-icon-caret-down"),"aria-hidden":Vi.const("true")})),()=>this.controller.s("graphing-calculator-label-more-viewport-options")),Vi.createElement(aG,{predicate:()=>this.isOpen},()=>Vi.createElement("div",{class:Vi.const("dcg-advanced-contents")},Vi.createElement("div",{class:Vi.const("dcg-log-axes-container")},Vi.createElement("div",null,()=>this.getAxisScaleLabel("x")),Vi.createElement(_r,{ariaGroupLabel:()=>this.getAxisScaleLabel("x"),theme:this.const("mini"),staticConfig:this.const(this.getStaticConfigForAxis("x"))}),Vi.createElement("div",null,()=>this.getAxisScaleLabel("y")),Vi.createElement(_r,{ariaGroupLabel:()=>this.getAxisScaleLabel("y"),theme:this.const("mini"),staticConfig:this.const(this.getStaticConfigForAxis("y"))})),Vi.createElement(aG,{predicate:()=>!this.controller.getLockViewportConfigSetting()},()=>Vi.createElement(Yg,__dcg_shared_module_exports__['a']({},this.props))))))),Vi.createElement(aG,{predicate:()=>!this.controller.getLockViewportConfigSetting()&&!this.shouldShowLogScalesOption()},()=>Vi.createElement(Yg,__dcg_shared_module_exports__['a']({},this.props))))}toggleOpen(){this.isOpen=!this.isOpen,this.update()}getAxisScaleLabel(e){return e==="x"?this.controller.s("graphing-calculator-label-settings-x-axis")+":":this.controller.s("graphing-calculator-label-settings-y-axis")+":"}getStaticConfigForAxis(e){return[{key:"linear",label:()=>"Linear",selected:()=>this.getAxisScale(e)==="linear",onSelect:()=>this.setAxisScale({axis:e,scale:"linear"})},{key:"logarithmic",label:()=>"Logarithmic",selected:()=>this.getAxisScale(e)==="logarithmic",onSelect:()=>this.setAxisScale({axis:e,scale:"logarithmic"})}]}shouldShowLogScalesOption(){return this.controller.getGraphSettings().config.logScales&&!this.controller.isThreeDMode()}getAxisScale(e){return this.controller.getGraphSettings()[e==="x"?"xAxisScale":"yAxisScale"]}setAxisScale({axis:e,scale:t}){return this.controller.dispatch({type:"set-graph-settings",[e==="x"?"xAxisScale":"yAxisScale"]:t})}};var Jg=__dcg_shared_module_exports__['h'](z());var Ch=class extends Jg.Class{init(){this.controller=this.props.controller()}template(){return Jg.createElement("div",{class:Jg.const("dcg-options-menu-section dcg-radiangroup")},Jg.createElement(_r,{ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-settings-angle"),staticConfig:this.bindFn(this.getAngleModeOptions)}))}getAngleModeOptions(){return[{key:"radians",label:()=>this.controller.s("graphing-calculator-button-settings-radians"),selected:()=>!this.getDegreeMode(),onSelect:()=>this.setDegreeMode(!1),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"radian-mode"}}},{key:"degrees",label:()=>this.controller.s("graphing-calculator-button-settings-degrees"),selected:()=>this.getDegreeMode(),onSelect:()=>this.setDegreeMode(!0),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"degree-mode"}}}]}getDegreeMode(){return!!this.controller.getGraphSettings().degreeMode}setDegreeMode(e){this.controller.dispatch({type:"set-graph-settings",degreeMode:e})}};var pu=__dcg_shared_module_exports__['h'](z());var Hb=class extends pu.Class{init(){this.controller=this.props.controller()}template(){return pu.createElement("div",null,pu.createElement("div",{class:pu.const("dcg-displaysizegroup")},pu.createElement(_r,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size"),staticConfig:this.bindFn(this.getProjectorModeOptions)})),pu.createElement(st,{onChange:this.bindFn(this.toggleInvertedColors),checked:()=>this.controller.getInvertedColors(),manageFocus:this.const(Qe({controller:this.controller,location:{type:"settings",location:"reverse-contrast"}}))},()=>this.controller.s("graphing-calculator-label-settings-reverse-contrast")))}getProjectorModeOptions(){return[{key:"default",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-default"),class:()=>"dcg-displaysize-default",selected:()=>!this.getProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!1),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"default-size"}}},{key:"large",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-large"),class:()=>"dcg-displaysize-large",selected:()=>this.getProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!0),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"large-size"}}}]}onSelectProjectorModeOption(e){this.controller.dispatch({type:"set-projector-mode",value:e})}getProjectorMode(){return!!this.controller.getGraphSettings().config.projectorMode}toggleInvertedColors(){this.controller.dispatch({type:"set-inverted-colors",value:!this.controller.getInvertedColors()})}};var{Input:J4,If:Ms,IfElse:X4}=le.Components,ip=class extends le.Class{template(){return le.createElement(ir,{isFocused:()=>this.props.parent().getFocusedLimit()===this.props.limit(),latex:()=>this.props.parent().getLimitLatex(this.props.limit()),ariaLabel:this.props.ariaLabel,handleLatexChanged:e=>this.props.parent().setLimitLatex(this.props.limit(),e),handleFocusChanged:e=>this.props.parent().onFocusedChanged(this.props.limit(),e),hasError:()=>this.props.parent().isLimitInvalid(this.props.limit()),dataLabelAttributeValue:this.props.limit,controller:this.props.controller,readonly:this.const(!1),containerClass:()=>({"dcg-log-scale":this.props.axisScale()==="logarithmic"})})}},lG=class extends le.Class{init(){this.controller=this.props.controller(),this.uuid=Ud()}template(){return le.createElement("div",{class:le.const("dcg-settings-view-container")},le.createElement(wh,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{isPillbox:this.const(!0)})),le.createElement(Ms,{predicate:()=>this.controller.isGraphSettingsOpen()},()=>le.createElement("div",{class:le.const("dcg-settings-container dcg-left dcg-popover dcg-constrained-height-popover"),style:this.bindFn(this.getContainerStyle),didMount:this.bindFn(this.didMountContainer),didUnmount:this.bindFn(this.didUnmountContainer)},le.createElement("div",{class:le.const("dcg-popover-interior"),role:le.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-graph-settings")},le.createElement("div",{class:le.const("dcg-visual-settings")},le.createElement(Hb,{controller:this.props.controller}),le.createElement(Ms,{predicate:()=>this.controller.getBrailleControls()},()=>le.createElement("div",{class:le.const("dcg-braille-container dcg-braille-mode")},le.createElement(st,{onChange:this.bindFn(this.toggleBrailleMode),checked:()=>this.controller.getBrailleMode()!=="none"},()=>this.controller.s("shared-calculator-narration-braille-mode")),le.createElement(Ms,{predicate:()=>this.controller.getBrailleMode()!=="none"},()=>le.createElement("div",{class:le.const("dcg-braille-options-container")},le.createElement("div",{class:le.const("dcg-braille-options-buttons")},le.createElement(_r,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-braille-mode"),staticConfig:this.bindFn(this.getBrailleOptions)})),le.createElement("div",{class:le.const("dcg-checkbox-title dcg-six-key-checkbox")},le.createElement(st,{onChange:e=>this.controller.dispatch({type:"set-six-key-input",useSixKeyInput:e}),checked:()=>this.controller.getSixKeyInput()},()=>this.controller.s("graphing-calculator-label-settings-six-key-braille")),le.createElement("a",{href:le.const("https://www.desmos.com/accessibility#braille"),"aria-label":()=>this.controller.s("graphing-calculator-link-learn-more"),class:le.const("dcg-six-key-info"),target:le.const("_blank")},le.createElement("i",{class:le.const("dcg-icon-question-sign"),"aria-hidden":le.const("true")}))),le.createElement("div",{class:le.const("dcg-refreshable-braille-note")},()=>this.controller.s("graphing-calculator-text-refreshable-braille-display-note")+" ",le.createElement("a",{href:()=>"https://www.desmos.com/braille-examples?"+this.controller.getBrailleMode(),target:le.const("_blank")},()=>this.controller.s("graphing-calculator-link-view-braille-examples")))))))),le.createElement("div",{class:le.const("dcg-top-section-flex dcg-grid-settings-container")},le.createElement("div",{class:le.const("dcg-grid-settings")},le.createElement(st,{class:this.const("dcg-settings-grid-toggle"),onChange:this.bindFn(this.toggleGrid),checked:this.bindFn(this.getShowGrid)},()=>this.controller.s("graphing-calculator-label-settings-grid")),le.createElement(Ms,{predicate:this.bindFn(this.getShowGrid)},()=>le.createElement("div",{class:le.const("dcg-circle-icon-group dcg-grid-group")},le.createElement("div",{class:()=>({"dcg-circle-icon":!0,"dcg-action-cartesian":!0,"dcg-selected":!this.getPolarMode()}),role:le.const("button"),tabindex:le.const("0"),"aria-pressed":()=>!this.getPolarMode(),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-cartesian-grid"),onTap:this.bindFn(this.setCartesianMode)},le.createElement("i",{class:le.const("dcg-icon-cartesian")})),le.const("\xA0"),le.createElement("div",{class:()=>({"dcg-circle-icon":!0,"dcg-action-polar":!0,"dcg-selected":this.getPolarMode()}),role:le.const("button"),tabindex:le.const("0"),"aria-pressed":()=>this.getPolarMode(),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-polar-grid"),onTap:this.bindFn(this.setPolarMode)},le.createElement("i",{class:le.const("dcg-icon-polar")})))),le.createElement(st,{onChange:this.bindFn(this.toggleArrows),checked:()=>this.getAxisArrowMode()!=="NONE"},()=>this.controller.s("graphing-calculator-label-settings-arrows")),le.createElement(Ms,{predicate:()=>this.getAxisArrowMode()!=="NONE"},()=>le.createElement("div",{class:le.const("dcg-circle-icon-group dcg-arrow-group")},le.createElement("div",{role:le.const("button"),tabindex:le.const("0"),class:()=>({"dcg-circle-icon":!0,"dcg-arrows":!0,"dcg-selected":this.getAxisArrowMode()==="BOTH"}),"dcg-arrows":le.const("BOTH"),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-show-both"),"aria-pressed":()=>this.getAxisArrowMode()==="BOTH",onTap:()=>this.setAxisArrowMode("BOTH")},le.createElement("i",{class:le.const("dcg-icon-arrows-two"),"aria-hidden":le.const("true")})),le.const("\xA0"),le.createElement("div",{role:le.const("button"),tabindex:le.const("0"),class:()=>({"dcg-circle-icon":!0,"dcg-arrows":!0,"dcg-selected":this.getAxisArrowMode()==="POSITIVE"}),"dcg-arrows":le.const("POSITIVE"),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-show-positive"),"aria-pressed":()=>this.getAxisArrowMode()==="POSITIVE",onTap:()=>this.setAxisArrowMode("POSITIVE")},le.createElement("i",{class:le.const("dcg-icon-arrows-one"),"aria-hidden":le.const("true")}))))),le.createElement("div",{class:le.const("dcg-top-checkboxes-container")},le.createElement(st,{onChange:this.bindFn(this.toggleAxisNumbers),checked:this.bindFn(this.getAxisNumbers),small:this.const(!0)},()=>this.controller.s("graphing-calculator-label-settings-axis-numbers")),le.createElement(Ms,{predicate:()=>this.getShowGrid()&&!this.getPolarMode()},()=>le.createElement(st,{onChange:this.bindFn(this.toggleMinorGridlines),checked:this.bindFn(this.getMinorGridlines),small:this.const(!0)},()=>this.controller.s("graphing-calculator-label-settings-minor-gridlines"))),le.createElement(Ms,{predicate:()=>this.controller.canUseAdvancedStyling()&&!this.getPolarMode()},()=>le.createElement(st,{checked:()=>this.controller.getGraphSettings().restrictGridToFirstQuadrant,onChange:e=>this.controller.dispatch({type:"set-graph-settings",restrictGridToFirstQuadrant:e}),small:this.const(!0)},()=>this.controller.s("graphing-calculator-label-settings-one-quadrant"))),le.createElement(Ms,{predicate:this.bindFn(this.showZoomSquareButton)},()=>le.createElement("div",{role:le.const("button"),tabindex:le.const("0"),class:le.const("dcg-action-zoom-square dcg-btn-light-gray"),onTap:this.bindFn(this.zoomSquare)},()=>this.controller.s("graphing-calculator-button-settings-zoom-square"))))),le.createElement("div",{class:le.const("dcg-axes-settings-container")},le.createElement(Ms,{predicate:()=>!this.controller.isThreeDMode()},()=>le.createElement("div",{class:le.const("dcg-checkbox-title dcg-x-axis-title")},le.createElement(st,{onChange:this.bindFn(this.toggleXAxis),checked:this.bindFn(this.getShowXAxis)},le.createElement("span",{id:this.const(`x-axis-description-${this.uuid}`)},()=>this.controller.s("graphing-calculator-label-settings-x-axis"))),le.createElement(Ms,{predicate:this.bindFn(this.getShowXAxis)},()=>le.createElement("div",{class:le.const("dcg-axis-label")},le.createElement("label",{for:this.const(`x-axis-label-${this.uuid}`)},()=>this.controller.s("graphing-calculator-button-label")),le.createElement(J4,{class:this.const("dcg-x-axis-label"),disabled:()=>this.getShowXAxis()?void 0:!0,onInput:this.bindFn(this.onXAxisLabelInput),value:this.bindFn(this.getXAxisLabel),"aria-describedby":this.const(`x-axis-description-${this.uuid}`),id:this.const(`x-axis-label-${this.uuid}`),placeholder:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-label-placeholder")}))))),le.createElement("div",{class:le.const("dcg-editable-mathquill-container dcg-x-axis-options")},le.createElement(ip,{limit:this.const("xmin"),axisScale:()=>this.getAxisScale("x"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),le.createElement(ze,{config:this.const({}),latex:this.const("\\le x\\le")},le.createElement("span",{class:le.const("dcg-interval-interior")})),le.createElement(ip,{limit:this.const("xmax"),axisScale:()=>this.getAxisScale("x"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),le.createElement(Ms,{predicate:()=>!this.getPolarMode()&&!this.controller.isThreeDMode()},()=>X4(()=>this.getAxisScale("x")==="linear",{true:()=>le.createElement("span",{class:le.const("dcg-step-container")},le.createElement("span",{class:le.const("dcg-step-label"),"aria-hidden":le.const("true")},()=>this.controller.s("graphing-calculator-label-settings-step")),le.createElement(ip,{limit:this.const("xstep"),axisScale:this.const("linear"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-step"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller})),false:()=>le.createElement("span",{style:le.const("display: none")})}))),le.createElement(Ms,{predicate:()=>!this.controller.isThreeDMode()},()=>le.createElement("div",{class:le.const("dcg-checkbox-title dcg-y-axis-title")},le.createElement(st,{onChange:this.bindFn(this.toggleYAxis),checked:this.bindFn(this.getShowYAxis)},le.createElement("span",{id:this.const(`y-axis-description-${this.uuid}`)},()=>this.controller.s("graphing-calculator-label-settings-y-axis"))),le.createElement(Ms,{predicate:this.bindFn(this.getShowYAxis)},()=>le.createElement("div",{class:le.const("dcg-axis-label")},le.createElement("label",{for:this.const(`y-axis-label-${this.uuid}`)},()=>this.controller.s("graphing-calculator-button-label")),le.createElement(J4,{class:this.const("dcg-y-axis-label"),onInput:this.bindFn(this.onYAxisLabelInput),value:this.bindFn(this.getYAxisLabel),"aria-describedby":this.const(`y-axis-description-${this.uuid}`),id:this.const(`y-axis-label-${this.uuid}`),placeholder:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-label-placeholder")}))))),le.createElement("div",{class:le.const("dcg-editable-mathquill-container dcg-y-axis-options")},le.createElement(ip,{limit:this.const("ymin"),axisScale:()=>this.getAxisScale("y"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),le.createElement(ze,{config:this.const({}),latex:this.const("\\le y\\le")},le.createElement("span",{class:le.const("dcg-interval-interior")})),le.createElement(ip,{limit:this.const("ymax"),axisScale:()=>this.getAxisScale("y"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),le.createElement(Ms,{predicate:()=>!this.getPolarMode()&&!this.controller.isThreeDMode()},()=>X4(()=>this.getAxisScale("y")==="linear",{true:()=>le.createElement("span",{class:le.const("dcg-step-container")},le.createElement("span",{class:le.const("dcg-step-label"),"aria-hidden":le.const("true")},()=>this.controller.s("graphing-calculator-label-settings-step")),le.createElement(ip,{limit:this.const("ystep"),axisScale:this.const("linear"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-step"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller})),false:()=>le.createElement("span",{style:le.const("display: none")})}))),le.createElement(Ms,{predicate:()=>this.controller.isThreeDMode()},()=>le.createElement("div",null,le.createElement("div",{class:le.const("dcg-editable-mathquill-container dcg-z-axis-options")},le.createElement(ip,{limit:this.const("zmin"),axisScale:this.const("linear"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-z-axis-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),le.createElement(ze,{config:this.const({}),latex:this.const("\\le z\\le")},le.createElement("span",{class:le.const("dcg-interval-interior")})),le.createElement(ip,{limit:this.const("zmax"),axisScale:this.const("linear"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-z-axis-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller})))),le.createElement(sG,{controller:this.props.controller})),le.createElement(Ch,{controller:this.props.controller}),le.createElement("div",{class:le.const("dcg-arrow")})))))}toggleBrailleMode(){this.controller.dispatch({type:"set-braille-mode",mode:this.controller.getBrailleMode()==="none"?"nemeth":"none"})}getBrailleOptions(){return[{key:"nemeth",label:()=>this.controller.s("shared-calculator-button-braille-mode-nemeth"),selected:()=>this.controller.getBrailleMode()==="nemeth",onSelect:()=>this.setBrailleMode("nemeth")},{key:"ueb",label:()=>this.controller.s("shared-calculator-button-braille-mode-ueb"),selected:()=>this.controller.getBrailleMode()==="ueb",onSelect:()=>this.setBrailleMode("ueb")}]}setBrailleMode(e){this.controller.dispatch({type:"set-braille-mode",mode:e})}didMountContainer(e){this.node=e,H(document.documentElement).on("dcg-tapstart.settings-view wheel.settings-view",t=>{this.eventShouldClosePopover(t)&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:t.device==="keyboard"})}),H(document.documentElement).on("keydown.settings-view",t=>{let i=Ee(t);if(i==="Esc"&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:!0}),this.controller.isGraphSettingsOpen()&&i==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let o=this.controller.getFocusLocation();if(!o||o.type!=="settings")return;t.shiftKey?t.shiftKey&&(o.location==="default-size"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation()):o.location==="icon"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"degree-mode"}}),t.preventDefault(),t.stopPropagation())):o.location==="icon"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"default-size"}}),t.preventDefault(),t.stopPropagation()):o.location==="degree-mode"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation())}})}didUnmountContainer(){H(document.documentElement).off(".settings-view")}didUpdate(){if(!this.controller.isGraphSettingsOpen())return;let e=this.controller.getKeypadHeight();e!==this.cachedKeypadHeight&&document.activeElement&&this.node.contains(document.activeElement)&&kl(document.activeElement,this.node.querySelector(".dcg-popover-interior"),50),this.cachedKeypadHeight=e}eventShouldClosePopover(e){let t=e.target,i=this.node.contains(t),o=!!t.closest(".dcg-action-settings"),n=this.isMathquillFocused()&&!!t.closest(".dcg-keypad"),a=!!t.closest(".dcg-action-undo")||!!t.closest(".dcg-action-redo");return!(i||o||n||a)}isMathquillFocused(){return this.getFocusedLimit()!==void 0}getLimitLatex(e){return this.controller.getSettingsViewModel().limitLatex[e]||""}setLimitLatex(e,t){t!==this.controller.getSettingsViewModel().limitLatex[e]&&this.controller.dispatch({type:"set-axis-limit-latex",limit:e,latex:t})}getFocusedLimit(){let e=this.controller.getFocusLocation();if(e&&e.type==="settings")return e.location}getInvalidLimits(){let e=!!this.controller.getGraphSettings().degreeMode,t=gi(this.getLimitLatex("xmin"),e),i=gi(this.getLimitLatex("xmax"),e),o=gi(this.getLimitLatex("ymin"),e),n=gi(this.getLimitLatex("ymax"),e),a=this.getLimitLatex("xstep")===""?0:gi(this.getLimitLatex("xstep"),e),s=this.getLimitLatex("ystep")===""?0:gi(this.getLimitLatex("ystep"),e),l={},c=new lo(t,i,o,n);return isFinite(t)&&isFinite(i)?(l.xmin=!c.isXValid(this.controller.getGraphSettings().xAxisScale),l.xmax=l.xmin):(l.xmin=!isFinite(t),l.xmax=!isFinite(i)),isFinite(o)&&isFinite(n)?(l.ymin=!c.isYValid(this.controller.getGraphSettings().yAxisScale),l.ymax=l.ymin):(l.ymin=!isFinite(o),l.ymax=!isFinite(n)),l.xstep=!ef(a),l.ystep=!ef(s),l}isLimitInvalid(e){return this.getInvalidLimits()[e]}onFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"settings",location:e}})}onXAxisLabelInput(e){this.controller.dispatch({type:"set-graph-settings",xAxisLabel:e})}onYAxisLabelInput(e){this.controller.dispatch({type:"set-graph-settings",yAxisLabel:e})}getXAxisLabel(){return this.controller.getGraphSettings().xAxisLabel}getYAxisLabel(){return this.controller.getGraphSettings().yAxisLabel}getShowXAxis(){return!!this.controller.getGraphSettings().showXAxis}toggleXAxis(){this.controller.dispatch({type:"set-graph-settings",showXAxis:!this.getShowXAxis()})}getShowYAxis(){return!!this.controller.getGraphSettings().showYAxis}toggleYAxis(){this.controller.dispatch({type:"set-graph-settings",showYAxis:!this.getShowYAxis()})}getAxisNumbers(){return!!this.controller.getGraphSettings().xAxisNumbers}toggleAxisNumbers(){let e=this.getAxisNumbers();this.controller.dispatch({type:"set-graph-settings",xAxisNumbers:!e,yAxisNumbers:!e,polarNumbers:!e})}getMinorGridlines(){return this.controller.getGraphSettings().xAxisMinorSubdivisions===0}toggleMinorGridlines(){let e=this.getMinorGridlines()?1:0;this.controller.dispatch({type:"set-graph-settings",yAxisMinorSubdivisions:e,xAxisMinorSubdivisions:e})}getPolarMode(){return!!this.controller.getGraphSettings().polarMode}setPolarMode(){this.controller.dispatch({type:"set-polar-mode",polarMode:!0})}setCartesianMode(){this.controller.dispatch({type:"set-polar-mode",polarMode:!1})}getAxisScale(e){return this.controller.getGraphSettings()[e==="x"?"xAxisScale":"yAxisScale"]}getAxisArrowMode(){return this.controller.getGraphSettings().xAxisArrowMode}setAxisArrowMode(e){this.controller.dispatch({type:"set-graph-settings",xAxisArrowMode:e,yAxisArrowMode:e})}getShowGrid(){return this.controller.getGraphSettings().showGrid}toggleGrid(){this.controller.dispatch({type:"set-graph-settings",showGrid:!this.getShowGrid()})}toggleArrows(){let e=this.getAxisArrowMode()==="NONE"?"BOTH":"NONE";this.controller.dispatch({type:"set-graph-settings",xAxisArrowMode:e,yAxisArrowMode:e})}showZoomSquareButton(){let e=this.controller.getAxisScaleSettings();return!this.controller.isThreeDMode()&&e.xAxisScale===e.yAxisScale&&!this.controller.getGraphSettings().squareAxes}getContainerStyle(){return this.controller.getKeypadHeight()?"bottom: 0":""}zoomSquare(){this.controller.dispatch({type:"zoom",direction:"square"})}};var Fr=__dcg_shared_module_exports__['h'](z());xt();var Ye=__dcg_shared_module_exports__['h'](z());var{abs:u2e,PI:h2e}=Math;var{sin:g2e,cos:m2e}=Math;var Fee=new URLSearchParams(window.location.search),Q4=(r,e)=>{let t=Fee.get(r);return t===null?e:Number(t)},Ree=Q4("scrollZoomRecenterAggressiveness",.2),S2e=Q4("buttonZoomRecenterAggressiveness",.1);xt();var{abs:W2e,min:$2e,acos:j2e,hypot:Y2e,PI:J2e}=Math;var X2e=5*Math.PI/180;function Z4(r,e=.01*(r.xmax-r.xmin)){return e*=2,Math.abs(r.xmin+r.xmax)<=e&&Math.abs(r.ymin+r.ymax)<=e&&Math.abs(r.zmin+r.zmax)<=e}var{If:Dh}=Ye.Components,Sh=class extends Ye.Class{template(){return Ye.createElement(ir,{isFocused:()=>this.props.parent().getFocusedLimit()===this.props.limit(),latex:()=>this.props.parent().getLimitLatex(this.props.limit()),ariaLabel:this.props.ariaLabel,handleLatexChanged:e=>this.props.parent().setLimitLatex(this.props.limit(),e),handleFocusChanged:e=>this.props.parent().onFocusedChanged(this.props.limit(),e),hasError:()=>this.props.parent().isLimitInvalid(this.props.limit()),dataLabelAttributeValue:this.props.limit,controller:this.props.controller,readonly:this.const(!1)})}},cG=class extends Ye.Class{init(){this.controller=this.props.controller(),this.isOpen=this.mustBeOpen()}willUpdate(){this.mustBeOpen()&&(this.isOpen=!0)}mustBeOpen(){var t;let e=(t=this.controller.getGrapher3d())==null?void 0:t.viewportController.getViewport();return e?e.xmin!==e.ymin||e.xmin!==e.zmin||e.xmax!==e.ymax||e.xmax!==e.zmax:!1}template(){return Ye.createElement("div",{class:Ye.const("dcg-three-d-domain dcg-advanced-viewport-settings-view dcg-options-menu-section")},Ye.createElement("div",{class:Ye.const("dcg-options-menu-section-title dcg-flex-container")},Ye.createElement("div",null,()=>this.controller.s("graphing-calculator-label-edit-graph-bounds")),Ye.createElement("div",null,Ye.createElement(Dh,{predicate:this.bindFn(this.showRecenterButton)},()=>Ye.createElement("div",{role:Ye.const("button"),tabindex:Ye.const("0"),class:Ye.const("dcg-action-zoom-recenter dcg-btn-light-gray"),onTap:this.bindFn(this.zoomRecenter)},()=>this.controller.s("graphing-calculator-label-recenter"))))),Ye.createElement("div",{class:Ye.const("dcg-three-d-domain-toggle-container")},Ye.createElement("div",{class:()=>({"dcg-advanced-toggle":!0,"dcg-opened":this.isOpen,"dcg-disabled":this.mustBeOpen()}),onTap:this.bindFn(this.toggleOpen),tabindex:()=>this.mustBeOpen()?-1:0,"aria-disabled":()=>this.mustBeOpen(),role:Ye.const("button"),"aria-pressed":()=>this.isOpen,"aria-expanded":()=>this.isOpen,"aria-label":()=>this.controller.s("graphing-calculator-label-edit-graph-bounds")},Ye.createElement("div",{class:Ye.const("dcg-caret-container")},Ye.createElement("i",{class:Ye.const("dcg-icon-caret-down"),"aria-hidden":Ye.const("true")})),Ye.createElement(Dh,{predicate:()=>this.isOpen},()=>Ye.createElement("span",{class:Ye.const("dcg-axis-label")},Ye.createElement(ze,{config:this.const({}),latex:this.const("x")}),Ye.const("-axis:"))),Ye.createElement(Dh,{predicate:()=>!this.isOpen},()=>Ye.createElement("span",{class:Ye.const("dcg-axis-label")},()=>this.controller.s("graphing-calculator-label-settings-all-axes")))),Ye.createElement("div",{class:Ye.const("dcg-editable-mathquill-container dcg-x-axis-options")},Ye.createElement(Sh,{limit:this.const("xmin"),ariaLabel:()=>this.isOpen?this.controller.s("graphing-calculator-narration-settings-x-axis-min"):this.controller.s("graphing-calculator-narration-settings-all-axes-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),Ye.createElement(Dh,{predicate:()=>this.isOpen},()=>Ye.createElement(ze,{config:this.const({}),latex:this.const("\\le x\\le")},Ye.createElement("span",{class:Ye.const("dcg-interval-interior")}))),Ye.createElement(Dh,{predicate:()=>!this.isOpen},()=>Ye.createElement("span",{class:Ye.const("dcg-axis-label-to")},()=>this.controller.s("shared-label-to"))),Ye.createElement(Sh,{limit:this.const("xmax"),ariaLabel:()=>this.isOpen?this.controller.s("graphing-calculator-narration-settings-x-axis-max"):this.controller.s("graphing-calculator-narration-settings-all-axes-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}))),Ye.createElement(Dh,{predicate:()=>this.isOpen},()=>Ye.createElement("div",{class:Ye.const("dcg-advanced-contents")},Ye.createElement("div",{class:Ye.const("dcg-editable-mathquill-container dcg-y-axis-options")},Ye.createElement("span",{class:Ye.const("dcg-axis-label")},Ye.createElement(ze,{config:this.const({}),latex:this.const("y")}),Ye.const("-axis:")),Ye.createElement(Sh,{limit:this.const("ymin"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),Ye.createElement(ze,{config:this.const({}),latex:this.const("\\le y\\le")},Ye.createElement("span",{class:Ye.const("dcg-interval-interior")})),Ye.createElement(Sh,{limit:this.const("ymax"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller})),Ye.createElement("div",null,Ye.createElement("div",{class:Ye.const("dcg-editable-mathquill-container dcg-z-axis-options")},Ye.createElement("span",{class:Ye.const("dcg-axis-label")},Ye.createElement(ze,{config:this.const({}),latex:this.const("z")}),Ye.const("-axis:")),Ye.createElement(Sh,{limit:this.const("zmin"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-z-axis-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),Ye.createElement(ze,{config:this.const({}),latex:this.const("\\le z\\le")},Ye.createElement("span",{class:Ye.const("dcg-interval-interior")})),Ye.createElement(Sh,{limit:this.const("zmax"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-z-axis-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}))),Ye.createElement(Dh,{predicate:this.bindFn(this.showZoomSquareButton)},()=>Ye.createElement("div",null,Ye.createElement("div",{role:Ye.const("button"),tabindex:Ye.const("0"),class:Ye.const("dcg-action-zoom-square-3d dcg-btn-primary"),onTap:this.bindFn(this.zoomSquare)},()=>this.controller.s("graphing-calculator-button-settings-zoom-square")))))),Ye.createElement(Dh,{predicate:()=>!this.controller.getLockViewportConfigSetting()},()=>Ye.createElement(st,{ariaLabel:()=>this.props.controller().s("graphing-calculator-label-disable-zoom"),onChange:()=>{this.props.controller().dispatch({type:"toggle-lock-viewport"})},checked:()=>this.props.controller().getLockViewportUserSetting()},()=>this.props.controller().s("graphing-calculator-label-disable-zoom"))))}showRecenterButton(){var t;let e=(t=this.controller.getGrapher3d())==null?void 0:t.webglLayer.domain();return!!e&&!Z4(e,0)}zoomRecenter(e){this.controller.dispatch({type:"zoom",direction:"recenter"}),e.device==="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"xmin"}})}getFocusedLimit(){let e=this.controller.getFocusLocation();if(e&&e.type==="settings")return e.location}getLimitLatex(e){return this.controller.getSettingsViewModel().limitLatex[e]||""}setLimitLatex(e,t){t!==this.controller.getSettingsViewModel().limitLatex[e]&&this.controller.dispatch({type:"set-axis-limit-latex",limit:e,latex:t,updateYZAlso:!this.isOpen&&(e==="xmin"||e==="xmax")})}getInvalidLimits(){let e=!!this.controller.getGraphSettings().degreeMode,t=gi(this.getLimitLatex("xmin"),e),i=gi(this.getLimitLatex("xmax"),e),o=gi(this.getLimitLatex("ymin"),e),n=gi(this.getLimitLatex("ymax"),e),a=gi(this.getLimitLatex("zmin"),e),s=gi(this.getLimitLatex("zmax"),e),l={},c=new lo(t,i,o,n,a,s);return isFinite(t)&&isFinite(i)?(l.xmin=!c.isXValid(this.controller.getGraphSettings().xAxisScale),l.xmax=l.xmin):(l.xmin=!isFinite(t),l.xmax=!isFinite(i)),isFinite(o)&&isFinite(n)?(l.ymin=!c.isYValid(this.controller.getGraphSettings().yAxisScale),l.ymax=l.ymin):(l.ymin=!isFinite(o),l.ymax=!isFinite(n)),isFinite(a)&&isFinite(s)?(l.zmin=!c.isZValid(),l.zmax=l.zmin):(l.zmin=!isFinite(a),l.zmax=!isFinite(s)),l}isLimitInvalid(e){return this.getInvalidLimits()[e]}onFocusedChanged(e,t){t?this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"settings",location:e}})}toggleOpen(){this.mustBeOpen()||(this.isOpen=!this.isOpen,this.update())}showZoomSquareButton(){return!this.controller.getGraphSettings().squareAxes}zoomSquare(e){this.controller.dispatch({type:"zoom",direction:"square"}),e.device==="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"zmax"}})}};var go=__dcg_shared_module_exports__['h'](z());var{If:ez}=go.Components,Wb=class extends go.Class{init(){this.controller=this.props.controller()}template(){return go.createElement(ez,{predicate:this.bindFn(this.shouldShowBrailleSection)},()=>go.createElement("div",{class:go.const("dcg-options-menu-section")},go.createElement("div",{class:go.const("dcg-options-menu-section-title")},()=>this.controller.s("shared-calculator-narration-braille-mode"),go.createElement(Ui,{ariaLabel:()=>this.controller.s("shared-calculator-narration-braille-mode"),onChange:this.bindFn(this.toggleBrailleMode),toggled:()=>this.controller.getBrailleMode()!=="none"})),go.createElement(ez,{predicate:()=>this.controller.getBrailleMode()!=="none"},()=>go.createElement("div",{class:go.const("dcg-braille-options-container")},go.createElement("div",{class:go.const("dcg-braille-options-buttons")},go.createElement(_r,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-braille-mode"),staticConfig:this.bindFn(this.getBrailleOptions)})),go.createElement("div",{class:go.const("dcg-checkbox-title dcg-six-key-checkbox")},go.createElement(st,{onChange:e=>this.controller.dispatch({type:"set-six-key-input",useSixKeyInput:e}),checked:()=>this.controller.getSixKeyInput()},()=>this.controller.s("graphing-calculator-label-settings-six-key-braille")),go.createElement(xh,{href:this.const("https://www.desmos.com/accessibility#braille"),controller:this.props.controller})),go.createElement("div",{class:go.const("dcg-refreshable-braille-note")},()=>this.controller.s("graphing-calculator-text-refreshable-braille-display-note")+" ",go.createElement("a",{href:()=>"https://www.desmos.com/braille-examples?"+this.controller.getBrailleMode(),class:go.const("dcg-blue-link"),target:go.const("_blank")},()=>this.controller.s("graphing-calculator-link-view-braille-examples")))))))}shouldShowBrailleSection(){return this.controller.getBrailleControls()&&this.controller.getGraphSettings().config.expressions}toggleBrailleMode(){this.controller.dispatch({type:"set-braille-mode",mode:this.controller.getBrailleMode()==="none"?"nemeth":"none"})}getBrailleOptions(){return[{key:"nemeth",label:()=>this.controller.s("shared-calculator-button-braille-mode-nemeth"),selected:()=>this.controller.getBrailleMode()==="nemeth",onSelect:()=>this.setBrailleMode("nemeth")},{key:"ueb",label:()=>this.controller.s("shared-calculator-button-braille-mode-ueb"),selected:()=>this.controller.getBrailleMode()==="ueb",onSelect:()=>this.setBrailleMode("ueb")}]}setBrailleMode(e){this.controller.dispatch({type:"set-braille-mode",mode:e})}};var el=__dcg_shared_module_exports__['h'](z());var{If:Nee}=el.Components,dG=class extends el.Class{init(){this.controller=this.props.controller()}template(){return el.createElement("div",{class:el.const("dcg-options-menu-section")},el.createElement("div",{class:el.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-label-display-properties")),el.createElement(st,{onChange:this.bindFn(this.toggleInvertedColors),checked:()=>this.controller.getInvertedColors(),manageFocus:this.const(Qe({controller:this.controller,location:{type:"settings",location:"reverse-contrast"}}))},()=>this.controller.s("graphing-calculator-label-settings-reverse-contrast")),el.createElement(Nee,{predicate:()=>!!Pr("beta3d")},()=>el.createElement(st,{onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showBox3D:!this.controller.getGraphSettings().showBox3D})},checked:()=>!!this.controller.getGraphSettings().showBox3D},()=>this.controller.raw("Clip to box"))),el.createElement(st,{class:()=>"dcg-translucent-surfaces-checkbox",onChange:this.bindFn(this.toggleTranslucentSurfaces),checked:()=>this.controller.getTranslucentSurfaces(),ariaLabel:()=>this.controller.s("graphing-calculator-label-settings-translucent-surfaces"),manageFocus:this.const(Qe({controller:this.controller,location:{type:"settings",location:"translucent-surfaces"}}))},()=>this.controller.s("graphing-calculator-label-settings-translucent-surfaces")))}toggleTranslucentSurfaces(){this.controller.dispatch({type:"set-translucent-surfaces",value:!this.controller.getTranslucentSurfaces()})}toggleInvertedColors(){this.controller.dispatch({type:"set-inverted-colors",value:!this.controller.getInvertedColors()})}};var{If:tz}=Fr.Components,pG=class extends Fr.Class{init(){this.controller=this.props.controller()}template(){return Fr.createElement("div",{class:Fr.const("dcg-settings-view-container dcg-settings-view-3d-container")},Fr.createElement("div",{class:Fr.const("dcg-3d-settings-flex-container")},Fr.createElement(wh,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{isPillbox:this.const(!0)}))),Fr.createElement(tz,{predicate:()=>this.controller.isGraphSettingsOpen()},()=>Fr.createElement("div",{class:Fr.const("dcg-settings-container dcg-left dcg-popover dcg-constrained-height-popover"),style:this.bindFn(this.getContainerStyle),didMount:this.bindFn(this.didMountContainer),didUnmount:this.bindFn(this.didUnmountContainer)},Fr.createElement("div",{class:Fr.const("dcg-popover-interior dcg-generic-options-menu"),role:Fr.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-graph-settings")},Fr.createElement(dG,{controller:this.props.controller}),Fr.createElement(cG,{controller:this.props.controller}),Fr.createElement("div",{class:Fr.const("dcg-options-menu-section")},Fr.createElement("div",{class:Fr.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-label-axes"),Fr.createElement(Ui,{ariaLabel:()=>this.controller.s("graphing-calculator-label-axes"),onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showAxis3D:!this.controller.getGraphSettings().showAxis3D})},toggled:()=>!!this.controller.getGraphSettings().showAxis3D})),Fr.createElement(tz,{predicate:()=>this.controller.getGraphSettings().showAxis3D},()=>Fr.createElement("div",{class:Fr.const("dcg-show-axis-labels-section")},Fr.createElement("div",null,Fr.createElement(st,{onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showPlane3D:!this.controller.getGraphSettings().showPlane3D})},checked:()=>!!this.controller.getGraphSettings().showPlane3D},()=>this.controller.s("graphing-calculator-label-settings-domain-plane"))),Fr.createElement("div",null,Fr.createElement(st,{onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showNumbers3D:!this.controller.getGraphSettings().showNumbers3D})},checked:()=>!!this.controller.getGraphSettings().showNumbers3D},()=>this.controller.s("graphing-calculator-label-settings-numbers-3d"))),Fr.createElement("div",null,Fr.createElement(st,{onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showAxisLabels3D:!this.controller.getGraphSettings().showAxisLabels3D})},checked:()=>!!this.controller.getGraphSettings().showAxisLabels3D},()=>this.controller.s("graphing-calculator-label-settings-axis-labels-3d")))))),Fr.createElement(Wb,{controller:this.props.controller}),Fr.createElement(Ch,{controller:this.props.controller}),Fr.createElement("div",{class:Fr.const("dcg-arrow")})))))}didMountContainer(e){this.node=e,H(document.documentElement).on("dcg-tapstart.settings-view wheel.settings-view",t=>{this.eventShouldClosePopover(t)&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:t.device==="keyboard"})}),H(document.documentElement).on("keydown.settings-view",t=>{let i=Ee(t);if(i==="Esc"&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:!0}),this.controller.isGraphSettingsOpen()&&i==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let o=this.controller.getFocusLocation();if(!o||o.type!=="settings")return;t.shiftKey?t.shiftKey&&(o.location==="reverse-contrast"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation()):o.location==="icon"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"degree-mode"}}),t.preventDefault(),t.stopPropagation())):o.location==="icon"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"reverse-contrast"}}),t.preventDefault(),t.stopPropagation()):o.location==="degree-mode"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation())}})}didUnmountContainer(){H(document.documentElement).off(".settings-view")}didUpdate(){if(!this.controller.isGraphSettingsOpen())return;let e=this.controller.getKeypadHeight();e!==this.cachedKeypadHeight&&document.activeElement&&this.node.contains(document.activeElement)&&kl(document.activeElement,this.node.querySelector(".dcg-popover-interior"),50),this.cachedKeypadHeight=e}eventShouldClosePopover(e){let t=e.target,i=this.node.contains(t),o=!!t.closest(".dcg-action-settings"),n=this.isMathquillFocused()&&t.closest(".dcg-keypad"),a=!!t.closest(".dcg-action-undo")||!!t.closest(".dcg-action-redo");return!(i||o||n||a)}isMathquillFocused(){let e=this.controller.getFocusLocation();return(e==null?void 0:e.type)==="settings"}getContainerStyle(){return this.controller.getKeypadHeight()?"bottom: 0":""}};var Ao=__dcg_shared_module_exports__['h'](z());var uG=class extends Ao.Class{init(){this.controller=this.props.controller()}template(){return Ao.createElement("div",{class:Ao.const("dcg-zoom-container")},Ao.createElement("div",{class:Ao.const("dcg-zoominout-pillbox dcg-btn-flat-gray dcg-btn-flat-gray-group dcg-group-vertical"),style:()=>({background:this.controller.getPillboxBackgroundColor()}),role:Ao.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-narration-zoom-options-label")},Ao.createElement(Me,{tooltip:this.bindFn(this.getZoomInLabel),displayBlock:this.const(!0),gravity:this.const("w")},Ao.createElement("div",{class:Ao.const("dcg-action-zoomin dcg-pillbox-btn-interior"),role:Ao.const("button"),tabindex:Ao.const("0"),"aria-label":this.bindFn(this.getZoomInLabel),onTap:this.bindFn(this.zoomIn),manageFocus:this.const(Qe({controller:this.controller,location:{type:"zoom-in-btn"}}))},Ao.createElement("i",{class:Ao.const("dcg-icon-plus"),"aria-hidden":Ao.const("true")}))),Ao.createElement(Me,{tooltip:this.bindFn(this.getZoomOutLabel),displayBlock:this.const(!0),gravity:this.const("w")},Ao.createElement("div",{class:Ao.const("dcg-action-zoomout dcg-pillbox-btn-interior"),role:Ao.const("button"),tabindex:Ao.const("0"),"aria-label":this.bindFn(this.getZoomOutLabel),onTap:this.bindFn(this.zoomOut)},Ao.createElement("i",{class:Ao.const("dcg-icon-minus"),"aria-hidden":Ao.const("true")})))))}zoomIn(){this.controller.dispatch({type:"zoom",direction:"in"})}zoomOut(){this.controller.dispatch({type:"zoom",direction:"out"})}getZoomInLabel(){return this.controller.s("graphing-calculator-label-tooltip-zoom-in")}getZoomOutLabel(){return this.controller.s("graphing-calculator-label-tooltip-zoom-out")}};var tl=__dcg_shared_module_exports__['h'](z());var _v=class extends tl.Class{init(){this.controller=this.props.controller()}template(){return tl.createElement("div",{class:tl.const("dcg-reset-container")},tl.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-reset"),gravity:this.props.tooltipGravity},tl.createElement("div",{class:tl.const("dcg-reset-pillbox dcg-action-reset dcg-btn-flat-gray dcg-pillbox-btn-interior"),role:tl.const("button"),tabindex:tl.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-reset"),onTap:this.bindFn(this.reset),style:()=>({background:this.controller.getPillboxBackgroundColor()})},tl.createElement("i",{class:tl.const("dcg-icon-reset"),"aria-hidden":tl.const("true")}))))}reset(){this.controller.dispatch({type:"reset-graph"})}};var od=__dcg_shared_module_exports__['h'](z());var hG=class extends od.Class{init(){this.controller=this.props.controller()}template(){return od.createElement(Me,{tooltip:this.bindFn(this.getZoomRestoreLabel),gravity:this.const("w")},od.createElement("div",{class:()=>({"dcg-btn-flat-gray":!0,"dcg-pillbox-btn-interior":!0,"dcg-action-zoomrestore":!0}),role:od.const("button"),tabindex:od.const("0"),"aria-label":this.bindFn(this.getZoomRestoreLabel),onTap:this.bindFn(this.setDefaultViewport),style:()=>({background:this.controller.getPillboxBackgroundColor()}),manageFocus:this.const(Qe({controller:this.controller,location:{type:"zoom-restore-btn"}}))},od.createElement("i",{class:od.const("dcg-icon-home"),"aria-hidden":od.const("true")})))}setDefaultViewport(){this.controller.dispatch({type:"zoom",direction:"default"}),this.controller.dispatch({type:"set-focus-location",location:{type:"zoom-in-btn"}})}getZoomRestoreLabel(){return this.controller.s("graphing-calculator-label-tooltip-viewport-default")}};var Va=__dcg_shared_module_exports__['h'](z());var Fv=class extends Va.Class{init(){this.controller=this.props.controller()}template(){return Va.createElement("div",{class:()=>({"dcg-3d-orientation-pillbox":!0,"dcg-btn-flat-gray":!0,"dcg-btn-flat-gray-group":!0,"dcg-group-horizontal":this.props.layout()==="horizontal","dcg-group-vertical":this.props.layout()==="vertical"}),style:()=>({background:this.controller.getPillboxBackgroundColor()}),role:Va.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-narration-3d-orientation-options-label")},Va.createElement(Me,{disabled:this.bindFn(this.isDefaultOrientation),tooltip:this.bindFn(this.getDefaultOrientationLabel),gravity:this.bindFn(this.getTooltipGravity),displayBlock:this.const(!0)},Va.createElement("div",{class:()=>({"dcg-action-defaultorientation":!0,"dcg-pillbox-btn-interior":!0,"dcg-disabled":this.isDefaultOrientation()}),role:Va.const("button"),"aria-disabled":this.bindFn(this.isDefaultOrientation),tabindex:()=>this.isDefaultOrientation()?-1:0,"aria-label":this.bindFn(this.getDefaultOrientationLabel),onTap:this.bindFn(this.rotateToDefaultOrientation)},Va.createElement("i",{class:Va.const("dcg-icon-3d-cube"),"aria-hidden":Va.const("true")}))),Va.createElement(Me,{tooltip:this.bindFn(this.getXYOrientationLabel),gravity:this.bindFn(this.getTooltipGravity),disabled:this.bindFn(this.isXYPlaneOrientation),displayBlock:this.const(!0)},Va.createElement("div",{class:()=>({"dcg-action-xyorientation":!0,"dcg-pillbox-btn-interior":!0,"dcg-disabled":this.isXYPlaneOrientation()}),role:Va.const("button"),"aria-disabled":this.bindFn(this.isXYPlaneOrientation),tabindex:()=>this.isXYPlaneOrientation()?-1:0,"aria-label":this.bindFn(this.getXYOrientationLabel),onTap:this.bindFn(this.rotateToXyOrientation)},Va.createElement("i",{class:Va.const("dcg-icon-xy-plane"),"aria-hidden":Va.const("true")}))))}getTooltipGravity(){return this.props.layout()==="horizontal"?"s":"w"}rotateToDefaultOrientation(){this.controller.dispatch({type:"zoom",direction:"default3dOrientation"})}rotateToXyOrientation(){this.controller.dispatch({type:"zoom",direction:"xy3dOrientation"})}isDefaultOrientation(){var t;let e=(t=this.controller.getGrapher3d())==null?void 0:t.controls;return!!(e!=null&&e.isDefaultOrientation())}isXYPlaneOrientation(){var t;let e=(t=this.controller.getGrapher3d())==null?void 0:t.controls;return!!(e!=null&&e.isXYPlaneOrientation())}getDefaultOrientationLabel(){return this.controller.s("graphing-calculator-label-tooltip-zoom-default-orientation")}getXYOrientationLabel(){return this.controller.s("graphing-calculator-label-tooltip-zoom-xy-orientation")}};var{Each:Bee,If:Rv}=Mi.Components,gG=class extends Mi.Class{init(){this.controller=this.props.controller()}template(){return Mi.createElement("div",null,Mi.createElement(Rv,{predicate:this.bindFn(this.shouldShowLeftPillboxes)},()=>Mi.createElement("div",{class:()=>({"dcg-left-pillboxes":!0,"dcg-geometry-toolbar-present":this.controller.shouldShowGeoToolbar()})},Mi.createElement(Rv,{predicate:this.bindFn(this.shouldShowUndoRedo)},()=>Mi.createElement(Vb,{controller:this.props.controller,isPillbox:this.const(!0)})),Mi.createElement(Rv,{predicate:this.bindFn(this.shouldShowGeoReset)},()=>Mi.createElement(_v,{controller:this.props.controller,tooltipGravity:this.const("s")})))),Mi.createElement("div",{class:()=>({"dcg-pillbox-container":!0,"dcg-geometry-toolbar-present":this.controller.shouldShowGeoToolbar()}),role:()=>this.controller.isGeoUIActive()?void 0:"region","aria-label":()=>this.controller.isGeoUIActive()?void 0:this.controller.s("graphing-calculator-narration-graph-settings-controls")},Mi.createElement("div",{class:Mi.const("dcg-overgraph-pillbox-elements"),style:this.bindFn(this.getContainerStyle)},Mi.createElement(Rv,{predicate:()=>this.shouldShowOrientationPillbox()&&!this.onSmallScreen()},()=>Mi.createElement("div",{class:Mi.const("dcg-left-pillbox-elements")},Mi.createElement(Fv,{controller:this.props.controller,layout:this.const("horizontal")}))),Mi.createElement(Rv,{predicate:()=>this.getRightPillboxElements().length>0},()=>Mi.createElement("div",{class:Mi.const("dcg-right-pillbox-elements")},Bee(()=>this.getRightPillboxElements(),{item:e=>{switch(e){case"settings2d":return Mi.createElement(lG,{controller:this.props.controller});case"settings3d":return Mi.createElement(pG,{controller:this.props.controller});case"settings-geo":return Mi.createElement(wh,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.props),{isPillbox:this.const(!0)}));case"reset":return Mi.createElement(_v,{controller:this.props.controller,tooltipGravity:this.const("w")});case"zoom-in-out":return Mi.createElement(uG,{controller:this.props.controller});case"orientation":return Mi.createElement(Fv,{layout:this.const("vertical"),controller:this.props.controller});case"zoom-home":return Mi.createElement(hG,{controller:this.props.controller})}}}))))),Mi.createElement(Pv,{controller:()=>this.props.controller()}))}shouldShowLeftPillboxes(){return this.shouldShowGeoReset()||this.shouldShowUndoRedo()}shouldShowGeoReset(){return this.controller.isGeometry()&&this.shouldShowResetButton()&&!this.controller.isListEnabled()}shouldShowUndoRedo(){return this.controller.isGeometry()&&!this.controller.isListEnabled()&&!this.controller.getGeoToolbarSuppressedByAuthor()}getRightPillboxElements(){let e=[];return this.shouldShowGraphSettings()&&e.push("settings2d"),this.shouldShow3DGraphSettings()&&e.push("settings3d"),this.shouldShowGeometrySettings()&&e.push("settings-geo"),this.shouldShowResetButton()&&!this.shouldShowGeoReset()&&e.push("reset"),this.shouldShowZoomInOutButtons()&&e.push("zoom-in-out"),this.shouldShowOrientationPillbox()&&this.onSmallScreen()&&e.push("orientation"),this.shouldShowZoomHomeButton()&&e.push("zoom-home"),e}shouldShowOrientationPillbox(){return this.controller.is3dProduct()}getContainerStyle(){let e=this.controller.isKeypadOpen()?this.controller.getKeypadHeight():0;return this.controller.isGraphSettingsOpen()?`bottom: ${e}px;`:"bottom: auto"}shouldShow3DGraphSettings(){return this.controller.getGraphSettings().config.settingsMenu&&this.controller.is3dProduct()}shouldShowGraphSettings(){return this.controller.getGraphSettings().config.settingsMenu&&!this.controller.isGeometry()&&!this.controller.is3dProduct()}shouldShowGeometrySettings(){return this.controller.getGraphSettings().config.settingsMenu?this.controller.isGeometry():!1}zoomEnabled(){return this.controller.getGraphSettings().config.zoomButtons&&!this.isViewportLocked()}onSmallScreen(){let e=this.controller.getLayoutMeasurements();return e.width<450||e.height<450}shouldShowZoomInOutButtons(){return this.onSmallScreen()?!1:this.zoomEnabled()}shouldShowZoomHomeButton(){return this.zoomEnabled()&&!this.controller.isDefaultViewportRestored()}isViewportLocked(){return this.controller.getGraphSettings().config.lockViewport||this.controller.getGraphSettings().userLockedViewport}shouldShowResetButton(){return this.controller.getGraphSettings().config.showResetButtonOnGraphpaper&&this.controller.hasDefaultState()}};var Lr=__dcg_shared_module_exports__['h'](z());var Tr=__dcg_shared_module_exports__['h'](z());var mG=__dcg_shared_module_exports__['h'](z());function iz(r,e,t){r.save();for(let i of t)switch(i.type){case"point":{let o;!i.color||i.color==="dark"?o=_k({isPoint:!0,color:e.point,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1}):i.color==="light"?o=__dcg_shared_module_exports__['m'](e.point,.7):o=i.color;let n;switch(i.size){case"small":n=5;break;case"large":n=10;break;case"medium":default:n=5;break}i.hollow?(r.lineWidth=2,r.strokeStyle=o,r.beginPath(),r.arc(i.x,i.y,n-1,0,2*Math.PI),r.stroke()):(r.fillStyle=o,r.beginPath(),r.arc(i.x,i.y,n,0,2*Math.PI),r.fill())}break;case"circle":{let o;!i.color||i.color==="dark"?o=Qx({isPoint:!1,color:e.circle,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1}):i.color==="light"?o=__dcg_shared_module_exports__['m'](e.circle,.7):o=i.color;let n;switch(i.lineWidth){case"small":n=2;break;case"large":n=7;break;case"medium":default:n=4;break}r.lineWidth=n,r.strokeStyle=o,r.beginPath(),r.arc(i.x,i.y,i.radius,0,2*Math.PI),r.stroke()}break;case"arc":{let o;!i.color||i.color==="dark"?o=Qx({isPoint:!1,color:e.circle,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1}):i.color==="light"?o=__dcg_shared_module_exports__['m'](e.circle,.7):o=i.color;let n;switch(i.lineWidth){case"small":n=2;break;case"large":n=7;break;case"medium":default:n=4;break}r.lineWidth=n,r.strokeStyle=o,r.beginPath(),r.arc(i.x,i.y,i.radius,i.startAngle,i.endAngle),r.stroke()}break;case"stroked-path":{let o;!i.color||i.color==="dark"?o=Qx({isPoint:!1,color:e.line,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1}):i.color==="light"?o=__dcg_shared_module_exports__['m'](e.line,.7):o=i.color;let n=i.path,a;switch(i.lineWidth){case"small":a=1;break;case"large":a=5;break;case"medium":default:a=3;break}r.lineCap="round",r.lineJoin="round",r.strokeStyle=o,r.lineWidth=a,r.beginPath(),r.moveTo(n[0],n[1]);for(let s=2;s<n.length;s+=2)r.lineTo(n[s],n[s+1]);if(i.arrow){let s=[],l=n.length-1;Kee(s,n[l-3],n[l-2],n[l-1],n[l],a/2+9.5);for(let c=0;c<s.length;c+=2)r.lineTo(s[c],s[c+1])}r.stroke()}break;case"filled-polygon":{let o;i.color?o=i.color:o=_k({isPoint:!1,color:e.polygon,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1,isTransparentObject:!0});let n=i.path;r.fillStyle=o,r.beginPath(),r.moveTo(n[0],n[1]);for(let a=2;a<n.length;a+=2)r.lineTo(n[a],n[a+1]);r.fill()}break;case"angle":{let o=Qx({isPoint:!1,color:e.angle,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1,isTransparentObject:!0}),n=_k({isPoint:!1,color:e.angle,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1,isTransparentObject:!0});qee(r,{type:"angle-indicator",lineWidth:4,strokeStyle:o,fillStyle:n,isRightAngle:!1,x:i.x,y:i.y,isDirected:i.isDirected,radius:i.radius,startAngle:i.startAngle,deltaAngle:i.deltaAngle})}break;default:return i}r.restore()}function qee(r,e){r.beginPath(),rz(r,e),r.lineTo(e.x,e.y),r.lineTo(e.x+e.radius*Math.cos(e.startAngle),e.y+e.radius*Math.sin(e.startAngle)),e.isDirected||(r.fillStyle=e.fillStyle,r.fill()),r.strokeStyle=e.strokeStyle,r.lineWidth=e.lineWidth,r.beginPath(),rz(r,e),r.stroke()}function rz(r,e){let t=e.startAngle+e.deltaAngle;if(e.isRightAngle){let i=e.radius*Math.cos(e.startAngle),o=e.radius*Math.cos(t),n=e.radius*Math.sin(e.startAngle),a=e.radius*Math.sin(t);r.moveTo(e.x+i,e.y+n),r.lineTo(e.x+i+o,e.y+n+a),r.lineTo(e.x+o,e.y+a)}else r.arc(e.x,e.y,e.radius,e.startAngle,t)}function Kee(r,e,t,i,o,n=12){let a=Math.atan2(o-t,i-e),s=i-n*Math.cos(a-Math.PI/9),l=o-n*Math.sin(a-Math.PI/9),c=i-n*Math.cos(a+Math.PI/9),p=o-n*Math.sin(a+Math.PI/9),u=i-(n-2)*Math.cos(a-Math.PI/18),m=o-(n-2)*Math.sin(a-Math.PI/18),h=i-(n-2)*Math.cos(a+Math.PI/18),x=o-(n-2)*Math.sin(a+Math.PI/18);r.push(s,l,c,p,i,o,u,m,h,x,i,o)}var Xg=class extends mG.Class{template(){return mG.createElement("canvas",{didMount:this.bindFn(this.didMountCanvas),width:()=>this.props.width(),height:()=>this.props.height(),style:()=>({width:this.props.width()/2+"px",height:this.props.height()/2+"px"})})}didMountCanvas(e){this.canvas=e,this.redraw()}didUpdate(){this.redraw()}redraw(){let e=this.props.instructions()||[],t=this.props.model().getNonObjectsState().ui.colors;if(__dcg_shared_module_exports__['P'](e,this.lastInstructions)&&__dcg_shared_module_exports__['P'](t,this.lastColors))return;this.lastInstructions=e,this.lastColors=t;let i=this.canvas.getContext("2d");i.clearRect(0,0,i.canvas.width,i.canvas.height),iz(i,t,e)}};var As=__dcg_shared_module_exports__['h'](z());var{For:zee}=As.Components;function VL(r,e){switch(e){case"selection":return r.s("graphing-calculator-label-geometry-tools-dropdown-menu-selection");case"point":return r.s("graphing-calculator-label-geometry-tools-dropdown-menu-point");case"line":return r.s("graphing-calculator-label-geometry-tools-dropdown-menu-line");case"circle":return r.s("graphing-calculator-label-geometry-tools-dropdown-menu-circle");case"angle":return r.s("graphing-calculator-label-geometry-tools-dropdown-menu-angle");case"polygon":return r.s("graphing-calculator-label-geometry-tools-dropdown-menu-polygon");case"transformation":return r.s("graphing-calculator-label-geometry-tools-dropdown-menu-transformation")}}var fG=class extends As.Class{init(){this.controller=this.props.controller(),this.geoModel=this.controller.getGeoModel()}getTools(){let e=this.controller.getOpenItemMenu();return!e||e.type!=="geo-tool-dropdown"||e.group!==this.props.group()?[]:e.tools}getAriaLabel(){let e=this.props.group();return VL(this.controller,e)}template(){return As.createElement("div",{class:()=>({"dcg-options-menu":!0,"dcg-select-tools-dropdown":!0,"dcg-shift-menu-left":this.getTools()[0]==="angle"}),role:As.const("menu"),"aria-label":this.bindFn(this.getAriaLabel),onKeyDown:this.bindFn(this.handleKeyPress),"dcg-geo-tool-group":this.bindFn(this.props.group)},As.createElement(zee,{each:()=>this.getTools()},As.createElement("div",{class:As.const("dcg-options-menu-section")},e=>As.createElement("button",{role:As.const("menuitemradio"),"aria-disabled":()=>!this.isToolEnabled(e),"aria-description":()=>this.isToolEnabled(e)?void 0:this.controller.s("graphing-calculator-narration-geometry-tool-disabled",{tool:e}),"aria-checked":()=>this.controller.getActiveTool()===e,onTap:t=>{this.isToolEnabled(e)&&this.chooseTool({tool:e,fromKeyboard:t.device==="keyboard"})},"dcg-geo-tool":this.const(e),class:()=>({"dcg-dropdown-tool":!0,"dcg-selected-tool":this.controller.getActiveTool()===e,"dcg-disabled":!this.isToolEnabled(e),"dcg-will-be-hidden-or-disabled":this.controller.toolWillBeHiddenOrDisabled(e)}),manageFocus:this.const(Qe({controller:this.controller,location:{type:"geo-basic-tool-menu-item",tool:e}}))},As.createElement(Xg,{model:()=>this.geoModel,width:this.const(100),height:this.const(100),instructions:()=>this.geoModel.getIconInstructionsForTool(e)}),As.createElement("span",null,()=>this.geoModel.getDisplayNameForTool(e))))))}isToolEnabled(e){return this.controller.isGeoToolEnabled(e)}chooseTool(e){this.props.controller().dispatch({type:"select-geo-tool",tool:e.tool,focusGraphPaper:!!e.fromKeyboard})}handleKeyPress(e){let t=this.props.guid();if(!t)return;let i=Ee(e);if(i!=="Up"&&i!=="Down"&&i!=="Esc")return;let o=this.getTools(),n=this.controller.getFocusLocation();if(i==="Esc"){let c=this.props.group();(n==null?void 0:n.type)==="geo-basic-tool-menu-item"&&this.focusMenuIcon(),c&&this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"geo-tool-dropdown",guid:t,tools:o,group:c,focusFirstOption:!1}}),e.stopPropagation(),e.preventDefault();return}if((n==null?void 0:n.type)!=="geo-basic-tool-menu-item")return;let a=i==="Down"?1:-1,l=(o.indexOf(n.tool)+a)%o.length;l<0&&(l=o.length+l),l>=0&&(this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool-menu-item",tool:o[l]}}),e.preventDefault(),e.stopPropagation())}focusMenuIcon(){let e=this.props.group();if(!e)return;let t=this.controller.getGeoToolbarItemsForGroup(e),i=t==null?void 0:t.current;if(i)return this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:i}})}};var{If:oz,For:Uee,Switch:Hee}=Tr.Components,ML=class extends Tr.Class{getAriaLabel(){let e=this.props.controller(),t=VL(e,this.props.group());if(t)return e.s("graphing-calculator-label-geometry-tools-open-dropdown-menu-transformation",{item:t})}template(){return Tr.createElement("span",{style:Tr.const("position:relative;"),class:Tr.const("dcg-tool-dropdown"),role:Tr.const("button"),tabindex:Tr.const("-1"),"aria-label":this.bindFn(this.getAriaLabel),"aria-expanded":this.props.ariaExpanded,onTap:this.bindFn(this.handleOnTap)},Tr.createElement("span",{class:Tr.const("dcg-dropdown-icon")},Tr.createElement("i",{class:Tr.const("dcg-icon-caret-down")})))}handleOnTap(e){e.handle(),this.props.openDropDown()}},bG=class extends Tr.Class{init(){this.controller=this.props.controller(),this.geoModel=this.controller.getGeoModel()}getGroups(){return this.controller.getGeoToolbarGroupKeys()}template(){return Tr.createElement("div",{role:Tr.const("toolbar"),"aria-label":()=>this.controller.s("graphing-calculator-label-geometry-tools"),class:Tr.const("dcg-geo-basic-tools dcg-animate-in-after-initial-load"),onKeydown:e=>this.handleToolbarKeydown(e)},Tr.createElement(Uee,{each:()=>this.getGroups()},Tr.createElement("div",{class:Tr.const("dcg-geo-basic-tools-row")},e=>Tr.createElement("div",{class:Tr.const("dcg-tool-button-container")},Tr.createElement("button",{class:()=>({"dcg-split-btn":!!this.getGroup(e).dropdown,"dcg-selected":this.isGroupSelected(this.getGroup(e)),"dcg-disabled":!this.isGroupEnabled(this.getGroup(e)),"dcg-will-be-hidden-or-disabled":this.controller.toolWillBeHiddenOrDisabled(this.getGroup(e).current)}),"dcg-geo-tool":()=>this.getGroup(e).current,"dcg-geo-tool-group":()=>e,tabindex:()=>this.isGroupSelected(this.getGroup(e))?0:-1,"aria-label":()=>this.geoModel.getDisplayNameForTool(this.getGroup(e).current),"aria-disabled":()=>!this.isGroupEnabled(this.getGroup(e)),"aria-haspopup":()=>!!this.getGroup(e).dropdown,"aria-pressed":()=>this.isGroupSelected(this.getGroup(e)),onTap:t=>this.handleTap(t,this.getGroup(e)),onLongHold:()=>this.openMenuFromLongHold(this.getGroup(e)),"dcg-open-menu-guid":()=>this.getGuid(this.getGroup(e)),manageFocus:()=>Qe({controller:this.controller,location:{type:"geo-basic-tool",tool:this.getGroup(e).current}}),"aria-controls":()=>this.getGuid(this.getGroup(e)),"aria-expanded":()=>this.getGroup(e).dropdown?this.isGroupDropdownOpen(this.getGroup(e)):void 0},Tr.createElement("span",{class:()=>({"dcg-basic-tool-btn":!0,"dcg-icon":!0})},Tr.createElement(Xg,{model:()=>this.geoModel,width:this.const(100),height:this.const(100),instructions:()=>this.geoModel.getIconInstructionsForTool(this.getGroup(e).current)})),Tr.createElement(oz,{predicate:()=>!!this.getGroup(e).dropdown},()=>Tr.createElement(ML,{group:()=>e,controller:this.props.controller,ariaExpanded:()=>this.isGroupDropdownOpen(this.getGroup(e)),openDropDown:()=>this.openDropdownMenu(this.getGroup(e))}))),Tr.createElement(oz,{predicate:()=>this.isGroupDropdownOpen(this.getGroup(e))},()=>Tr.createElement(ec,{controller:this.props.controller,shouldHandleTabAndEscape:this.const(!1),menuType:this.const("geo-tool-dropdown"),menuButtonFocusLocation:this.const({type:"geo-basic-tool",tool:this.getGroup(e).current}),rootElSelector:this.const(".dcg-geometry-toolbar-view")},Tr.createElement(fG,{controller:this.props.controller,group:()=>e,guid:()=>this.getGuid(this.getGroup(e))})))))),Tr.createElement(Hee,{key:()=>this.controller.getGeometryGettingStartedMessageState()},e=>{switch(e){case"hidden":return Tr.createElement("span",null);case"construct":case"pick-a-tool":return Tr.createElement("div",{class:()=>({"dcg-3d-getting-started-pointer":!0,"dcg-3d-getting-started-has-tool":this.controller.getGeometryGettingStartedMessageState()!=="pick-a-tool"})},this.bindFn(this.getPointerMessage),Tr.createElement("span",{class:Tr.const("dcg-curved-icon-container")},Tr.createElement("i",{class:Tr.const("dcg-icon-curved-arrow")})))}}))}isGroupSelected(e){return this.selectedTool()===e.current}isGroupEnabled(e){return this.controller.isGeoToolEnabled(e.current)}getGroup(e){let t=this.controller.getGeoToolbarItemsForGroup(e);if(!t)throw new Error("Programing error: "+e+" not found");return t}getPointerMessage(){return this.controller.getGeometryGettingStartedMessageState()==="pick-a-tool"?this.controller.s("geometry-label-pick-tool-instruction"):this.controller.s("geometry-label-construct-instruction")}getFocusedOrActiveTool(){let e=this.controller.getAllVisibleGeoToolbarItems(),t=this.controller.getFocusLocation();if(!t)return;let i;return t.type==="geo-basic-tool"||t.type==="geo-basic-tool-menu-item"?i=t.tool:i=this.controller.getActiveTool(),e.find(o=>{var n,a;return o.current===i||o.dropdown&&((a=(n=o.dropdown)==null?void 0:n.indexOf)==null?void 0:a.call(n,i))>-1})}handleToolbarKeydown(e){var l,c,p,u,m;let t=Ee(e);if(t!=="Up"&&t!=="Down"&&t!=="Left"&&t!=="Right"&&t!=="Home"&&t!=="End"||(e.preventDefault(),e.stopPropagation(),!this.controller.getFocusLocation()))return;let o=this.controller.getAllVisibleGeoToolbarItems(),n=this.getFocusedOrActiveTool();if(!n)return;let a=o.findIndex(h=>h.group===n.group),s;if(t==="Home")s=(l=o[0])==null?void 0:l.current;else if(t==="End")s=(c=o[o.length-1])==null?void 0:c.current;else if(t==="Left"||t==="Right"){let h=t==="Left"?-1:1,x=Math.max(0,Math.min(o.length-1,a+h));s=(p=o[x])==null?void 0:p.current;let C=((u=o[x].dropdown)!=null?u:[]).length>1;if(((m=this.controller.getOpenItemMenu())==null?void 0:m.type)==="geo-tool-dropdown"){if(C)return this.openDropdownMenu(o[x],!0);if(s)this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"geo-tool-dropdown",guid:this.getGuid(n),tools:[],group:n.group}});else return}}else(t==="Up"||t==="Down")&&this.openDropdownMenu(n);s&&this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:s}})}selectedTool(){let e=this.controller.getActiveTool();return e==="expression-edit"?"selection":e}openDropdownMenu(e,t){e.dropdown&&(this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"geo-tool-dropdown",guid:this.getGuid(e),tools:e.dropdown,group:e.group,focusFirstOption:t}}),this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool-menu-item",tool:e.current}}))}getGuid(e){return e.dropdown?"geo-dropdown-"+e.dropdown[0]:""}openMenuFromLongHold(e){this.controller.dispatch({type:"select-geo-tool",tool:e.current}),this.openDropdownMenu(e)}handleTap(e,t){e.wasLongheld()||e.wasHandled()||(this.controller.dispatch({type:"select-geo-tool",tool:t.current,focusGraphPaper:e.device==="keyboard"}),e.shiftKey?this.openDropdownMenu(t):e.device!=="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:t.current}}))}isGroupDropdownOpen(e){let t=this.controller.getOpenItemMenu();return(t==null?void 0:t.type)==="geo-tool-dropdown"&&t.group===e.group}};var Ai=__dcg_shared_module_exports__['h'](z());var{Each:Wee,SwitchUnion:$ee,If:jee}=Ai.Components,yG=class extends Ai.Class{init(){this.controller=this.props.controller()}template(){return Ai.createElement("div",{role:Ai.const("toolbar"),"aria-label":()=>this.controller.s("graphing-calculator-label-geometry-tools"),class:Ai.const("dcg-geo-basic-tools dcg-animate-in-after-initial-load dcg-complex-tool-instruction-view")},Ai.createElement(nb,{ariaLabel:()=>this.controller.s("account-shell-button-mygraphs-cancel"),controller:this.props.controller,message:()=>this.getTransformationName(this.controller.getActiveTool()),onBack:this.bindFn(this.onCancel)}),Wee(()=>this.getInputIndexes(),{item:e=>Ai.createElement(AL,{activeStep:this.bindFn(this.getInputIndex),controller:this.props.controller,toolSpec:()=>this.getToolSpec(),stepIdx:()=>e})}))}onCancel(){this.controller.dispatch({type:"select-geo-tool",tool:"selection"}),this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:"selection"}})}getTransformationName(e){switch(e){case"dilate":return this.controller.s("graphing-calculator-text-geometry-tool-dilate-display-name");case"reflect":return this.controller.s("graphing-calculator-text-geometry-tool-reflect-display-name");case"rotate":return this.controller.s("graphing-calculator-text-geometry-tool-rotate-display-name");case"translate":return this.controller.s("graphing-calculator-text-geometry-tool-translate-display-name");case"parallel":return this.controller.s("graphing-calculator-text-geometry-tool-parallel-display-name");case"perpendicular":return this.controller.s("graphing-calculator-text-geometry-tool-perpendicular-display-name");case"compass":return this.controller.s("graphing-calculator-text-geometry-tool-compass-display-name");default:return this.controller.s("shared-calculator-narration-item-unknown")}}getInputIndex(){return this.controller.getGeoModel().getNonObjectsState().ui.currentTool.inputIndex}getInputIndexes(){return this.getToolSpec().inputs.map((e,t)=>t)}getToolSpec(){return this.controller.getGeoModel().getCurrentTool().getSpec()}},AL=class extends Ai.Class{init(){this.controller=this.props.controller()}template(){return $ee(()=>this.getInputType(),{completed:()=>Ai.createElement("span",{class:Ai.const("dcg-step-completed")},Ai.createElement("i",{class:Ai.const("dcg-icon-check"),"aria-hidden":Ai.const("true")})),upcoming:()=>Ai.createElement("span",{class:Ai.const("dcg-step-upcoming")},Ai.createElement("span",null)),active:()=>Ai.createElement("span",{class:Ai.const("dcg-active-step")},Ai.createElement("span",{class:Ai.const("dcg-step-active-icon")},Ai.createElement("span",null,()=>this.props.stepIdx()+1)),this.bindFn(this.getActiveString),Ai.createElement(jee,{predicate:this.bindFn(this.isNumberInputStep)},()=>Ai.createElement("span",{class:Ai.const("dcg-input-flex-container"),didMount:this.bindFn(this.didMountNumberInput)},Ai.createElement(ir,{containerClass:()=>({"dcg-suffix-degree":this.getNumberUnits()==="\xB0","dcg-suffix-radian":this.getNumberUnits()==="rad"}),readonly:()=>!1,latex:()=>this.getNumberInputLatex(),ariaLabel:this.bindFn(this.getActiveString),isFocused:()=>this.isNumberInputFocused(),handleFocusChanged:(e,t)=>this.handleFocusedChanged(e,t),hasError:this.bindFn(this.doesNumberInputHaveError),controller:this.props.controller,handlePressedKey:(e,t)=>{this.handlePressedKey(e,t)},handleLatexChanged:e=>{this.handleLatexChanged(e)},handleSelectionChanged:e=>{this.handleLatexChanged(e.latex,!0)},dataLabelAttributeValue:this.const("transformation-number")}),Ai.createElement("span",{class:()=>({"dcg-action-submit":!0,"dcg-disabled":this.isSubmitNumberDisabled(),"dcg-btn-blue":!0}),role:Ai.const("button"),tabindex:()=>this.isSubmitNumberDisabled()?-1:0,"aria-disabled":this.bindFn(this.isSubmitNumberDisabled),onTap:e=>this.submitNumberInput({device:e.device})},()=>this.controller.s("shared-calculator-button-go")))))})}getNumberUnits(){return this.controller.getActiveTool()==="rotate"?this.controller.isDegreeMode()?"\xB0":"rad":""}didMountNumberInput(){this.controller.dispatch({type:"set-focus-location",location:{type:"new-transformation-number"}})}isNumberInputFocused(){let e=this.controller.getFocusLocation();return!!(e&&e.type==="new-transformation-number")}doesNumberInputHaveError(){var l;if(!this.getNumberInputLatex()||this.getNumberInputLatex()===((l=this.getStep().numberInputInfo)==null?void 0:l.defaultLatex))return!1;let t=this.props.toolSpec().outputs[0].id,{idMap:i}=this.controller.getGeoModel().getNonObjectsState().ui.currentTool,o=i[t];if(!o)return!0;let n=Of(this.controller.getListModel()).filter(c=>{var p;if(c.type==="expression")return o===((p=Fo(c))==null?void 0:p.latex)}),a=n[0];if(!a||n.length===0||n.length>1||a.error)return!0;let s=a.formula.typed_constant_value;if(!s)return!0;if(__dcg_shared_module_exports__['Pa'](s.valueType,__dcg_shared_module_exports__['Ba'])){let c=__dcg_shared_module_exports__['Ka'](s.valueType)?s.value:[s.value];for(let p of c){let[[u,m],[h,x]]=p;if(isNaN(u)||isNaN(m)||isNaN(h)||isNaN(x))return!0}return!1}return!0}handlePressedKey(e,t){let i=_e.getFocusedMathquill();if(e==="Enter"){this.submitNumberInput({device:"keyboard"});return}i&&(i.keystroke(e,t),this.handleLatexChanged(i.latex()))}getNumberInputLatex(){return this.controller.getGeoModel().getCurrentTool().getNumberInputLatex()}isSubmitNumberDisabled(){return!!(this.doesNumberInputHaveError()||!this.getNumberInputLatex())}submitNumberInput(e){var s,l;if(this.isSubmitNumberDisabled())return;let t=this.controller.getGeoModel(),i=this.controller.getActiveTool(),o=t.getCurrentTool(),n=(s=o.getSpec)==null?void 0:s.call(o),a=o.tryCommitResults();a.committed&&(this.controller.dispatch(__dcg_shared_module_exports__['a']({type:"commit-geo-objects"},a)),(l=this.controller.get2dPOIController())==null||l.speakGeoReleaseAction(i,n,a.committed),e.device==="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"graph-paper"}}))}handleLatexChanged(e,t){(this.getNumberInputLatex()!==e||t)&&(this.controller.getGeoModel().getCurrentTool().onNumberInput(e),this.controller.getGeoModel().onPreviewChange())}handleFocusedChanged(e,t){e&&!this.isNumberInputFocused()?this.controller.dispatch({type:"set-focus-location",location:{type:"new-transformation-number"}}):this.isNumberInputFocused()&&this.controller.dispatch({type:"blur-focus-location",location:{type:"new-transformation-number"}})}getActiveString(){let e=this.props.controller(),t=this.getStep().hint;return t?e.s(t):e.s("shared-calculator-narration-item-unknown")}isNumberInputStep(){return!!this.getStep().numberInputInfo}getStep(){return this.props.toolSpec().inputs[this.props.stepIdx()]}getInputType(){let e=this.props.activeStep(),t=this.props.stepIdx();return t<e?"completed":t>e?"upcoming":"active"}};var{SwitchUnion:Yee,If:nz}=Lr.Components,xG=class extends Lr.Class{constructor(){super(...arguments),this.afterInitialLoad=!1}init(){this.controller=this.props.controller()}template(){return Lr.createElement("div",{class:()=>({"dcg-geometry-toolbar-view":!0,"dcg-after-initial-load":this.afterInitialLoad}),style:()=>({left:`${this.controller.computeMajorLayout().grapher.left}px`}),onTapStart:this.bindFn(this.onTapStart)},Lr.createElement("div",{class:Lr.const("dcg-header-left dcg-do-blur")},Lr.createElement(nz,{predicate:this.bindFn(this.showHamburger)},()=>Lr.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-open-graph"),gravity:this.const("s")},Lr.createElement("div",{role:Lr.const("button"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-open-graph"),tabindex:Lr.const("0"),class:Lr.const("dcg-action-opendrawer dcg-icon-btn dcg-in-api-action-opendrawer"),onTap:()=>this.controller.dispatch({type:"open-drawer"})},Lr.createElement("i",{class:Lr.const("dcg-icon-hamburger"),"aria-hidden":Lr.const("true")})))),Lr.createElement(nz,{predicate:this.bindFn(this.showOpenExpressionsButton)},()=>Lr.createElement("div",{class:Lr.const("dcg-show-expressions-tab dcg-icon-btn"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-show-list"),role:Lr.const("button"),tabindex:Lr.const("0"),onTap:e=>{this.controller.dispatch({type:"show-expressions-list",focusHideIcon:e.device==="keyboard"})},manageFocus:this.const(Qe({controller:this.controller,location:{type:"show-expression-list-btn"}}))},Lr.createElement("i",{class:Lr.const("dcg-icon-show"),"aria-hidden":Lr.const("true")})))),Lr.createElement("div",{class:Lr.const("dcg-flex-spacer")}),Yee(this.bindFn(this.getViewToShow),{tools:()=>Lr.createElement(bG,{controller:this.props.controller}),selectedItems:()=>Lr.createElement(EE,{controller:this.props.controller}),recentlyUsedComplexTool:()=>Lr.createElement("div",{class:Lr.const("dcg-complex-tool-success dcg-animate-in-after-initial-load"),role:Lr.const("toolbar")},Lr.createElement("i",{class:Lr.const("dcg-icon-check")}),()=>this.controller.s("account-shell-label-success")),complexToolInstructions:()=>Lr.createElement(yG,{controller:this.props.controller})}),Lr.createElement("div",{class:Lr.const("dcg-flex-spacer")}))}showHamburger(){return this.controller.getGraphSettings().config.showHamburger?!this.controller.isListEnabled()||!this.controller.isListVisible()||this.controller.isNarrow():!1}showOpenExpressionsButton(){return this.controller.isListEnabled()&&!this.controller.isListVisible()&&!this.controller.isNarrow()}willUpdate(){this.afterInitialLoad||this.getViewToShow()==="selectedItems"&&(this.afterInitialLoad=!0)}onTapStart(e){e.target.classList.contains("dcg-do-blur")&&this.controller.dispatch({type:"set-none-selected"})}getViewToShow(){let e=this.controller.getActiveTool();return __dcg_shared_module_exports__['ac'](e)||gL(e)?this.controller.getComplexToolWasRecentlyUsed()?"recentlyUsedComplexTool":"complexToolInstructions":this.controller.shouldShowMultiSelectHeader()?"selectedItems":"tools"}};var cr=__dcg_shared_module_exports__['h'](z());var{If:Nv}=cr.Components,LL=class extends cr.Class{init(){this.controller=this.props.controller()}template(){return cr.createElement("span",{class:cr.const("dcg-toast")},cr.createElement("i",{class:cr.const("dcg-icon-error"),"aria-hidden":cr.const("true")}),cr.createElement(Nv,{predicate:()=>!this.showUndo()},()=>cr.createElement("i",{class:cr.const("dcg-icon-remove"),onTap:()=>this.controller.dispatch({type:"toast/close"}),role:cr.const("link"),tabindex:cr.const(0),"aria-label":cr.const("Dismiss Notice")})),cr.createElement("span",{class:cr.const("dcg-msg"),"aria-atomic":()=>this.shouldLiveUpdateAria(),"aria-live":()=>this.shouldLiveUpdateAria()?"assertive":""},()=>this.controller.toastData.message),cr.createElement(Nv,{predicate:this.bindFn(this.showUndo)},()=>cr.createElement("a",{role:cr.const("link"),tabindex:cr.const(0),class:cr.const("dcg-undo"),onTap:()=>this.controller.dispatch({type:"toast/undo"})},()=>this.controller.s("shared-calculator-label-toast-undo"))),cr.createElement(Nv,{predicate:this.bindFn(this.showLearnMore)},()=>cr.createElement("a",{role:cr.const("link"),tabindex:cr.const(0),target:cr.const("_blank"),onTap:()=>this.controller.dispatch({type:"toast/learn-more"})},()=>this.controller.s("shared-calculator-label-toast-learn-more"))),cr.createElement(Nv,{predicate:()=>!!this.controller.toastData.link},()=>cr.createElement("a",{role:cr.const("link"),tabindex:cr.const(0),target:cr.const("_blank"),href:()=>{var e;return((e=this.controller.toastData.link)==null?void 0:e.url)||""}},()=>{var e;return((e=this.controller.toastData.link)==null?void 0:e.text)||""})))}showUndo(){return!!this.controller.toastData.undoCallback}showLearnMore(){return!!this.controller.toastData.learnMoreCallback}shouldUpdate(){return!!this.controller.toastData.message}shouldLiveUpdateAria(){return!this.controller.toastData.noAria}},wG=class extends cr.Class{template(){return cr.createElement("div",{class:()=>({"dcg-toast-view":!0,"dcg-visible":!!this.props.controller().toastData.message,"dcg-below-geo-toolbar":this.isGeometryInCalculator()}),"toast-style":()=>this.props.controller().toastData.toastStyle},cr.createElement(Nv,{predicate:()=>!!this.props.controller().toastData.message},()=>cr.createElement("div",{class:cr.const("dcg-toast-wrapper")},cr.createElement("div",{class:cr.const("dcg-toast-cover")}),cr.createElement(LL,__dcg_shared_module_exports__['a']({},this.props)))))}isGeometryInCalculator(){var t;let e=this.props.controller();return(t=e.isGeometry)==null?void 0:t.call(e)}};xt();function Bv(r){let e="drag dragend dragenter dragover dragleave drop";H(r).on(e,t=>{t.preventDefault(),t.stopPropagation()})}var Ir=__dcg_shared_module_exports__['h'](z());xt();var Mn=__dcg_shared_module_exports__['h'](z());var fr=__dcg_shared_module_exports__['h'](z());var li=__dcg_shared_module_exports__['h'](z());xt();var OL=class{constructor(){this.handlers=[],H(document).on("keydown.delegator",e=>this.handleEvent(e))}push(e){let t=__dcg_shared_module_exports__['V']("delegator_");return this.handlers.push({token:t,handler:e}),()=>this.handlers=__dcg_shared_module_exports__['t'](this.handlers,i=>i.token!=t)}handleEvent(e){if(!e.isDefaultPrevented()&&this.handlers.length){let t=!1,i=()=>t=!0;for(let{handler:o}of this.handlers.slice().reverse())if(o(e,i),t)return}}},vG=new OL;var{If:az}=li.Components,ko=class extends li.Class{init(){this.i18n=this.props.i18n(),this.isMounted=!1}template(){return li.createElement("div",{class:()=>({"dcg-shared-modal-container":!0,[this.props.class?this.props.class():""]:!!this.props.class}),didMount:this.bindFn(this.didMount),didUnmount:this.bindFn(this.didUnmount)},li.createElement("div",{class:()=>({"dcg-shared-modal-cover":!0,"dcg-shared-has-close-button":this.showX(),"dcg-shared-modal-fullscreen":this.props.size()==="fullscreen","dcg-shared-modal-wide":this.props.size()==="wide","dcg-shared-modal-medium":this.props.size()==="medium","dcg-shared-modal-narrow":this.props.size()==="narrow"})},li.createElement("div",{class:li.const("dcg-shared-modal-background"),onTap:this.props.onClose}),li.createElement("div",{class:li.const("dcg-shared-modal-transition-container")},li.createElement("div",{class:li.const("dcg-shared-modal"),role:li.const("dialog"),"aria-modal":li.const("true"),"aria-label":()=>{let e="";return this.props.ariaLabel?e=this.props.ariaLabel():this.props.title&&(e=this.props.title()),e}},li.createElement(az,{predicate:()=>this.showX()},()=>li.createElement("div",{class:li.const("dcg-shared-close-cross-container")},li.createElement(Me,{tooltip:()=>this.i18n.s("shared-button-close-dialog")},li.createElement("div",{role:li.const("button"),tabindex:li.const("0"),"aria-label":()=>this.i18n.s("shared-button-close-dialog"),class:li.const("dcg-shared-close-cross"),onTap:this.props.onClose},li.createElement("i",{class:li.const("dcg-icon-remove"),"aria-hidden":li.const("true")}))))),li.createElement("div",{class:li.const("dcg-shared-modal-contents-wrapper")},li.createElement(az,{predicate:()=>!!this.props.title&&!!this.props.title()},()=>li.createElement("h1",{class:()=>({"dcg-shared-modal-title":!0,"dcg-shared-left-align-title":this.leftAlignTitle()})},()=>this.props.title())),li.createElement("div",{class:li.const("dcg-shared-modal-scrollable-content")},this.children))))))}showX(){return!!this.props.showX&&this.props.showX()}leftAlignTitle(){return!!this.props.leftAlignTitle&&this.props.leftAlignTitle()}didMount(){var s,l;if(this.isMounted)return;this.isMounted=!0;let e=this.findRootNode();function t(){let c=e.querySelector(".dcg-shared-close-cross");c&&c.focus()}function i(){let c=e.querySelector(".dcg-shared-modal-scrollable-content");c&&(c.tabIndex>=0||(c.tabIndex=0),c.focus())}let o=e.querySelector(".dcg-shared-modal-scrollable-content"),n=(l=(s=this.props).setFocus)==null?void 0:l.call(s);n==="close"?this.showX()?t():o&&i():n==="content"&&i();let a=tq(e);this.unsub=vG.push((c,p)=>{Ee(c)==hn&&(this.onClose(),p());let u=c.altKey||c.shiftKey||c.metaKey||c.ctrlKey;this.props.onArrowKey&&Ee(c)===Cd&&!u&&this.props.onArrowKey("Left"),this.props.onArrowKey&&Ee(c)===Dd&&!u&&this.props.onArrowKey("Right"),a(c)})}onClose(){this.props.onClose&&this.props.onClose()}didUnmount(){this.isMounted&&(this.isMounted=!1,this.unsub())}};var{If:CG,Each:sz}=fr.Components,DG=class extends fr.Class{init(){this.controller=this.props.controller()}template(){return fr.createElement(CG,{predicate:this.props.visible},()=>fr.createElement(ko,{size:this.const("medium"),onClose:this.props.onClose,i18n:this.const(this.controller),class:this.const("dcg-custom-toolbar-settings-modal")},fr.createElement("div",{class:fr.const("dcg-btn-blue dcg-done-btn"),"aria-role":fr.const("button"),tabindex:fr.const(0),didMount:e=>e.focus(),onTap:this.props.onClose},()=>this.controller.s("graphing-calculator-button-done")),fr.createElement("h1",{class:fr.const("dcg-shared-left-align-title")},()=>this.controller.s("shared-calculator-text-customize-toolbar")),sz(this.bindFn(this.getToolGroups),{key:e=>e.group,item:e=>fr.createElement("div",null,fr.createElement("div",{class:fr.const("dcg-configuration-heading-row dcg-configuration-grid-row")},fr.createElement("div",{class:fr.const("dcg-first-column")},()=>e.group,fr.const(" Tools")),fr.createElement("div",{class:fr.const("dcg-second-column")},fr.const("Disabled when:"))),sz(()=>e.dropdown||[e.current],{item:t=>fr.createElement("div",{class:fr.const("dcg-configuration-grid-row"),"dcg-geo-tool":this.const(t)},fr.createElement("div",{class:fr.const("dcg-first-column")},fr.createElement(st,{disabled:()=>!this.isToolCustomizable(t),checked:()=>this.getToolInfo(t).visible,onChange:i=>{this.controller.dispatch({type:"set-geometry-custom-toolbar-setting",tool:t,value:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.getToolInfo(t)),{visible:i})})}},()=>t)),fr.createElement("div",{class:()=>({"dcg-disabled":!this.getToolInfo(t).visible||!this.isToolCustomizable(t),"dcg-mathquill-condition-container":!0,"dcg-second-column":!0})},fr.createElement(CG,{predicate:()=>!!this.getToolLatexError(t)&&this.getToolInfo(t).visible},()=>fr.createElement("div",{class:fr.const("dcg-latex-error-container")},fr.createElement(pa,{error:()=>this.getToolLatexError(t)||"",gravity:this.const("s")}))),fr.createElement(CG,{predicate:()=>this.isToolCustomizable(t)&&this.getToolInfo(t).visible},()=>fr.createElement(co,__dcg_shared_module_exports__['a']({latex:()=>this.getToolLatex(t),operatorNames:this.bindFn(this.autoOperatorNames),ariaLabel:()=>this.getToolAria(t),brailleShouldFocus:()=>this.focusedLatexTool===t,onBrailleInput:i=>{this.controller.dispatch({type:"set-geometry-custom-toolbar-setting",tool:t,value:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.getToolInfo(t)),{disabledLatex:i})})},onBrailleFocusedChanged:i=>{this.focusedLatexTool===t&&!i?this.focusedLatexTool=void 0:i&&(this.focusedLatexTool=t)},onBrailleKeydown:()=>{}},rn(this.controller)),fr.createElement(_e,{latex:()=>this.getToolLatex(t),getAriaLabel:()=>this.getToolAria(t),noFadeout:this.const(!0),getAriaPostLabel:()=>this.getToolLatexError(t)||"",isFocused:()=>this.focusedLatexTool===t,tokenController:this.props.controller,capExpressionSize:()=>this.controller.getCapExpressionSize(),config:()=>this.controller.getMathquillConfig({}),hasError:()=>!!this.getToolLatexError(t),onUserChangedLatex:i=>{this.controller.dispatch({type:"set-geometry-custom-toolbar-setting",tool:t,value:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},this.getToolInfo(t)),{disabledLatex:i})})},onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:i=>{this.focusedLatexTool===t&&!i?this.focusedLatexTool=void 0:i&&(this.focusedLatexTool=t)},onSelectionChanged:()=>{this.controller.runAfterDispatch(()=>{this.controller.dispatch({type:"render"})})},needsSystemKeypad:()=>!this.controller.isKeypadEnabled()}))),fr.createElement(CG,{predicate:()=>!this.getToolInfo(t).visible},()=>fr.createElement("div",{class:fr.const("dcg-disabled-condition-wrapper")},fr.createElement(co,__dcg_shared_module_exports__['a']({latex:()=>this.getToolLatex(t),operatorNames:this.bindFn(this.autoOperatorNames),ariaLabel:()=>this.getToolAria(t),isStatic:this.const(!0),brailleShouldFocus:this.const(!1),onBrailleFocusedChanged:()=>{}},rn(this.controller)),fr.createElement(ze,{latex:()=>this.getToolLatex(t),config:()=>this.controller.getMathquillConfig({}),getAriaLabel:()=>this.getToolAria(t)}))))))}))})))}getToolAria(e){return this.controller.s("shared-calculator-narration-disable-tool",{tool:e})}autoOperatorNames(){return this.props.controller().getMathquillConfig({}).autoOperatorNames}getToolLatex(e){return this.getToolInfo(e).disabledLatex||""}isToolCustomizable(e){return e!=="selection"&&e!=="box-selection"}getToolGroups(){let e={group:"transformation",current:"translate",dropdown:lb};return[...tM(),e]}getToolLatexError(e){let t=this.controller.getGeometryToolbarModel(),i=I3(t,e);if(i)return this.controller.unpack(i)}getToolInfo(e){let t=this.controller.getGeometryToolbarModel();return __dcg_shared_module_exports__['a']({tool:e},t.toolbarState[e])}};var{If:lz}=Mn.Components,SG=class extends Mn.Class{init(){this.controller=this.props.controller()}template(){return Mn.createElement(lz,{predicate:()=>this.shouldShowAuthorFeaturesSection()},()=>Mn.createElement("div",{class:Mn.const("dcg-options-menu-section dcg-author-mode-section")},Mn.createElement("div",{class:Mn.const("dcg-options-menu-section-title")},()=>this.controller.s("shared-calculator-narration-author-mode"),Mn.createElement(Ui,{ariaLabel:()=>this.controller.s("shared-calculator-narration-author-mode"),toggled:this.bindFn(this.isAuthorMode),onChange:()=>{this.controller.dispatch({type:"set-author-mode",enabled:!this.isAuthorMode()})}})),Mn.createElement(lz,{predicate:()=>this.isAuthorMode()},()=>Mn.createElement("div",{class:Mn.const("dcg-author-features-container")},Mn.createElement("div",{class:Mn.const("dcg-toolbar-customization")},Mn.createElement("span",null,Mn.const("Geometry Tools:")),Mn.createElement(_r,{theme:this.const("mini"),ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-configure-toolbar"),staticConfig:this.bindFn(this.getConfigurationOptions)})),Mn.createElement(DG,{controller:this.props.controller,onClose:()=>{this.customGeometryToolsSettingsModal=!1,this.controller.dispatch({type:"render"})},visible:()=>this.customGeometryToolsSettingsModal})))))}getToolbar(){return this.controller.getGeometryToolbarModel().toolbar}setToolbar(e){e==="custom"&&(this.customGeometryToolsSettingsModal=!0),this.controller.dispatch({type:"set-geometry-toolbar",toolbar:e})}getConfigurationOptions(){return[{key:"all",label:()=>this.controller.raw("All"),selected:()=>this.getToolbar()==="all",onSelect:()=>this.setToolbar("all")},{key:"none",label:()=>this.controller.raw("None"),selected:()=>this.getToolbar()==="none",onSelect:()=>this.setToolbar("none")},{key:"custom",label:()=>this.controller.raw("Custom"),selected:()=>this.getToolbar()==="custom",onSelect:()=>this.setToolbar("custom")}]}shouldShowAuthorFeaturesSection(){return this.controller.authorFeaturesAvailable()}isAuthorMode(){return this.controller.shouldShowAuthorFeatures()}};var{If:kG}=Ir.Components,qv=class extends Ir.Class{init(){this.controller=this.props.controller()}template(){return Ir.createElement("div",{class:()=>({"dcg-geometry-settings-container":!0,"dcg-popover":!0,"dcg-left":!0,"dcg-constrained-height-popover":!0,"dcg-generic-options-menu":!0,"dcg-no-geometry-header":!this.controller.shouldShowGeoToolbar()}),style:this.bindFn(this.getContainerStyle),didMount:this.bindFn(this.didMountContainer),didUnmount:this.bindFn(this.didUnmountContainer)},Ir.createElement("div",{class:Ir.const("dcg-popover-interior"),role:Ir.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-geometry-settings")},Ir.createElement("div",{class:Ir.const("dcg-options-menu-section")},Ir.createElement(Hb,{controller:this.props.controller}),Ir.createElement(kG,{predicate:()=>!this.controller.getLockViewportConfigSetting()},()=>Ir.createElement(Yg,{controller:this.props.controller})),Ir.createElement(kG,{predicate:()=>this.controller.getHiddenGeoItemCount()>0},()=>Ir.createElement(st,{onChange:this.bindFn(this.toggleGhostMode),checked:()=>this.controller.getGhostMode(),manageFocus:this.const(Qe({controller:this.controller,location:{type:"settings",location:"hidden-objects"}}))},()=>this.controller.s("graphing-calculator-label-settings-hidden-objects",{count:this.controller.getHiddenGeoItemCount()})))),Ir.createElement("div",{class:Ir.const("dcg-options-menu-section")},Ir.createElement("div",{class:Ir.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-label-settings-grid"),Ir.createElement(Ui,{ariaLabel:()=>this.controller.s("graphing-calculator-label-settings-grid"),toggled:this.bindFn(this.getShowGrid),onChange:this.bindFn(this.toggleGrid)})),Ir.createElement(kG,{predicate:this.bindFn(this.getShowGrid)},()=>Ir.createElement(st,{onChange:this.bindFn(this.toggleMinorGridlines),checked:this.bindFn(this.getMinorGridlines)},()=>this.controller.s("graphing-calculator-label-settings-minor-gridlines")))),Ir.createElement("div",{class:Ir.const("dcg-options-menu-section")},Ir.createElement("div",{class:Ir.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-label-axes"),Ir.createElement(Ui,{ariaLabel:()=>this.controller.s("graphing-calculator-label-axes"),toggled:this.bindFn(this.getShowAxes),onChange:this.bindFn(this.toggleAxes)})),Ir.createElement(kG,{predicate:this.bindFn(this.getShowAxes)},()=>Ir.createElement("div",null,Ir.createElement(st,{onChange:this.bindFn(this.toggleAxisNumbers),checked:this.bindFn(this.getAxisNumbers)},()=>this.controller.s("graphing-calculator-label-settings-axis-numbers")),Ir.createElement("div",null,Ir.createElement(st,{onChange:this.bindFn(this.toggleArrows),checked:()=>this.getAxisArrowMode()!=="NONE"},()=>this.controller.s("graphing-calculator-label-settings-arrows")))))),Ir.createElement(Wb,{controller:this.props.controller}),Ir.createElement(SG,{controller:this.props.controller}),Ir.createElement(Ch,{controller:this.props.controller}),Ir.createElement("div",{class:Ir.const("dcg-arrow")})))}toggleGhostMode(){this.controller.dispatch({type:"set-ghost-mode",value:!this.controller.getGhostMode()})}didMountContainer(e){this.node=e,H(document.documentElement).on("dcg-tapstart.geometry-settings-view wheel.geometry-settings-view",t=>{this.eventShouldClosePopover(t)&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:t.device==="keyboard"})}),this.unsub=vG.push(t=>{let i=Ee(t);if(i==="Esc"&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:!0}),this.controller.isGraphSettingsOpen()&&i==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let o=this.controller.getFocusLocation();if(!o||o.type!=="settings")return;t.shiftKey?t.shiftKey&&(o.location==="default-size"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation()):o.location==="icon"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"degree-mode"}}),t.preventDefault(),t.stopPropagation())):o.location==="icon"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"default-size"}}),t.preventDefault(),t.stopPropagation()):o.location==="degree-mode"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),t.preventDefault(),t.stopPropagation())}})}didUnmountContainer(){H(document.documentElement).off(".geometry-settings-view"),this.unsub()}didUpdate(){if(!this.controller.isGraphSettingsOpen())return;let e=this.controller.getKeypadHeight();e!==this.cachedKeypadHeight&&document.activeElement&&this.node.contains(document.activeElement)&&kl(document.activeElement,this.node.querySelector(".dcg-popover-interior"),50),this.cachedKeypadHeight=e}eventShouldClosePopover(e){let t=e.target,i=this.node.contains(t),o=!!t.closest(".dcg-action-settings"),n=this.isMathquillFocused()&&!!t.closest(".dcg-keypad"),a=!!t.closest(".dcg-action-undo")||!!t.closest(".dcg-action-redo");return!(i||o||n||a)}isMathquillFocused(){return this.getFocusedLimit()!==void 0}getFocusedLimit(){let e=this.controller.getFocusLocation();if(e&&e.type==="settings")return e.location}getShowXAxis(){return!!this.controller.getGraphSettings().showXAxis}toggleAxes(){this.controller.dispatch({type:"set-graph-settings",showXAxis:!this.getShowXAxis(),showYAxis:!this.getShowXAxis()})}getShowAxes(){return!!this.controller.getGraphSettings().showXAxis}getAxisNumbers(){return!!this.controller.getGraphSettings().xAxisNumbers}toggleAxisNumbers(){let e=this.getAxisNumbers();this.controller.dispatch({type:"set-graph-settings",xAxisNumbers:!e,yAxisNumbers:!e,polarNumbers:!e})}getMinorGridlines(){return this.controller.getGraphSettings().xAxisMinorSubdivisions===0}toggleMinorGridlines(){let e=this.getMinorGridlines()?1:0;this.controller.dispatch({type:"set-graph-settings",yAxisMinorSubdivisions:e,xAxisMinorSubdivisions:e})}getAxisArrowMode(){return this.controller.getGraphSettings().xAxisArrowMode}getShowGrid(){return this.controller.getGraphSettings().showGrid}toggleGrid(){this.controller.dispatch({type:"set-graph-settings",showGrid:!this.getShowGrid()})}toggleArrows(){let e=this.getAxisArrowMode()==="NONE"?"BOTH":"NONE";this.controller.dispatch({type:"set-graph-settings",xAxisArrowMode:e,yAxisArrowMode:e})}getContainerStyle(){return this.controller.getKeypadHeight()?"bottom: 0":""}};var{If:Qg}=Xt.Components,Kv=class extends Xt.Class{init(){this.controller=this.props.controller()}settings(){return this.controller.getGraphSettings()}template(){return Xt.createElement("div",{class:Xt.const("dcg-calculator-api-container"),style:Xt.const("width: 100%; height: 100%; position: relative;")},Xt.createElement("div",{class:()=>({"dcg-container":!0,"dcg-fullscreen":!this.controller.isListVisible(),"dcg-narrow":this.controller.isNarrow(),"dcg-PROJECTOR-MODE":this.settings().config.projectorMode,"dcg-inverted-colors":!!this.settings().config.invertedColors,"dcg-inverted-swatches":this.controller.invertSwatches(),"dcg-EDIT-LIST-MODE":this.controller.isInEditListMode(),"dcg-no-graphpaper":!this.settings().config.graphpaper,"dcg-no-branding":!this.settings().config.branding,"dcg-no-expression-topbar":!this.settings().config.expressionsTopbar,"dcg-default-border":!!this.settings().config.border,"dcg-no-hyperlinks":!this.settings().config.links,"dcg-has-background-color":this.controller.hasBackgroundColor(),"dcg-is-interactive":this.settings().config.expressions||!(this.settings().config.lockViewport||this.settings().userLockedViewport)}),style:()=>({"font-size":this.settings().config.fontSize+"px",background:this.getContainerBackgroundColor(),color:this.controller.getTextColor()}),role:Xt.const("application"),"aria-label":()=>this.controller.isGeometry()?this.controller.s("graphing-calculator-narration-main-desmos-geometry"):this.controller.s("graphing-calculator-narration-main-desmos-graphing-calculator"),"x-ms-format-detection":Xt.const("none"),didMount:this.bindFn(this.didMountRoot)},Xt.createElement(Qg,{predicate:()=>this.controller.getGraphSettings().config.expressions},()=>Xt.createElement(Ov,{controller:this.props.controller})),Xt.createElement(Qg,{predicate:()=>this.controller.isListEnabled()&&!this.controller.isListVisible()&&(!this.controller.isGeometry()||this.controller.isNarrow())},()=>Xt.createElement("div",{class:()=>({"dcg-overgraph-icon-container":!0,"dcg-bottom-right":this.controller.isNarrow()})},Xt.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-show-list"),gravity:()=>this.controller.isNarrow()?"n":"s"},Xt.createElement("div",{class:()=>({"dcg-show-expressions-tab":!0,"dcg-overgraph-icon":!0,"dcg-rotated":this.controller.isNarrow()}),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-show-list"),role:Xt.const("button"),tabindex:Xt.const("0"),onTap:e=>{this.controller.dispatch({type:"show-expressions-list",focusHideIcon:e.device==="keyboard"})},manageFocus:this.const(Qe({controller:this.controller,location:{type:"show-expression-list-btn"}}))},Xt.createElement("i",{class:Xt.const("dcg-icon-show"),"aria-hidden":Xt.const("true")}))))),Xt.createElement(Qg,{predicate:this.bindFn(this.showHamburger)},()=>Xt.createElement("div",{class:Xt.const("dcg-overgraph-icon-container")},Xt.createElement(Me,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-open-graph"),gravity:this.const("s")},Xt.createElement("div",{role:Xt.const("button"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-open-graph"),class:Xt.const("dcg-action-opendrawer dcg-in-api-action-opendrawer dcg-overgraph-icon"),onTap:()=>this.controller.dispatch({type:"open-drawer"})},Xt.createElement("i",{class:Xt.const("dcg-icon-hamburger"),"aria-hidden":Xt.const("true")}))))),Xt.createElement(gG,{controller:this.props.controller}),Xt.createElement(Qg,{predicate:()=>this.controller.isGeoUIActive()&&this.controller.getGraphSettings().config.settingsMenu&&this.controller.isGraphSettingsOpen()},()=>Xt.createElement(qv,{controller:this.props.controller})),Xt.createElement(Qg,{predicate:()=>this.controller.shouldShowGeoToolbar()},()=>Xt.createElement(xG,{controller:this.props.controller})),Xt.createElement(wG,{controller:this.props.controller}),Xt.createElement("div",{class:Xt.const("dcg-grapher dcg-grapher-2d"),style:()=>({visibility:this.controller.isThreeDMode()?"hidden":"visible","pointer-events":this.controller.isThreeDMode()?"none":"auto"})}),Xt.createElement(Qg,{predicate:()=>this.controller.is3dProduct()},()=>Xt.createElement("div",{class:Xt.const("dcg-grapher dcg-grapher-3d"),style:()=>({visibility:this.controller.isThreeDMode()?"visible":"hidden","pointer-events":this.controller.isThreeDMode()?"auto":"none"})})),Xt.createElement(Qg,{predicate:()=>this.controller.getGraphSettings().config.keypad},()=>Xt.createElement(nG,{controller:this.props.controller}))))}showHamburger(){return!this.controller.getGraphSettings().config.showHamburger||this.controller.isGeometry()?!1:this.controller.isNarrow()}getContainerBackgroundColor(){return this.controller.hasTransparentBackground()?"none":this.controller.getBackgroundColor()}didMountRoot(e){Pu(e),this.controller.getGraphSettings().config.disableScrollFix||b0(e),this.setupFileDragDrop(e)}setupFileDragDrop(e){Bv(e);let t=new Set,i=this;function o(){t=new Set,H(e).off(".filedraggedover"),i.controller.dispatch({type:"file-is-not-dragged-over"})}H(e).on("dragenter",n=>{this.controller.areImagesEnabled()&&(n.target.closest(".dcg-3d-getting-started-container")||(t.size===0&&H(e).on("dcg-tapstart.filedraggedover",o),t=t.add(n.target),this.controller.dispatch({type:"file-is-dragged-over"})))}).on("dragleave",n=>{t.delete(n.target),t.size===0&&o()}).on("drop",o)}};var EG=class extends kr{constructor(t){super();this.workerPool=t,this.guid=__dcg_shared_module_exports__['V']("worker-pool-connection"),this.worker=t.allocateWorker(),this.worker.__connections[this.guid]=this}destroy(){this.sendMessage({type:"destroy"}),delete this.worker.__connections[this.guid]}killWorker(){this.worker.__isFake||this.workerPool.killWorker(this.worker)}onWorkerKilled(){}onResponse(t){}sendMessage(t){this.worker.__isFake?this.worker.postMessage(t):this.worker.postMessage({connectionId:this.guid,originalMessage:t})}};function cz(r){var e={},t=new __dcg_shared_module_exports__['zd'](i);function i(o,n){r({type:o,payload:n})}return e.postMessage=function(o){setTimeout(function(){t.processChangeSet(o)},0)},e}ig();var zv="";try{zv=_p(window.location.search,"workerThrottle"),zv==null&&(zv=_p(window.top.location.search,"workerThrottle"))}catch(r){}var dz=parseInt(zv,10),PL=0;function pz(r){return dz?function(e){PL=Math.max(Date.now(),PL)+dz,setTimeout(r,PL-Date.now(),e)}:r}var $b=class extends kr{constructor(t=1/0){super();this.workers=[],this.maxWorkers=t}allowedToSpawnWorker(){return!!__dcg_worker_source_exports__['createWorker']&&this.workers.length<this.maxWorkers}killWorker(t){var i=__dcg_shared_module_exports__['I'](this.workers,t);i!==-1&&(t.terminate(),this.workers=__dcg_shared_module_exports__['F'](this.workers,t),__dcg_shared_module_exports__['A'](__dcg_shared_module_exports__['N'](t.__connections)).forEach(function(o){o&&o.onWorkerKilled&&o.onWorkerKilled()}))}spawnWorker(){if(!__dcg_worker_source_exports__['createWorker'])return null;try{var t=__dcg_worker_source_exports__['createWorker']();return t.__connections={},t.__isFake=!1,t.onerror=function(i){__dcg_shared_module_exports__['rd'].log(i)},t.addEventListener("message",pz(function(i){var o=i.data;if(!(o&&o.log)&&o&&o.connectionId){var n=t.__connections[o.connectionId];n&&n.onResponse(o.originalMessage)}})),this.workers.push(t),t}catch(i){return null}}spawnFakeWorker(){var t=cz(pz(function(i){var o=__dcg_shared_module_exports__['N'](t.__connections)[0];o&&o.onResponse(i)}));return t.__isFake=!0,t.__connections={},t}findLeastUsedWorker(){var t=function(o){return __dcg_shared_module_exports__['D'](o.__connections)},i=__dcg_shared_module_exports__['B'](this.workers,t)[0];return i}allocateWorker(){var t=null;return this.allowedToSpawnWorker()&&(t=this.spawnWorker()),t||(t=this.findLeastUsedWorker()),t||(t=this.spawnFakeWorker()),t}};var Jee=4e3,kh=class{constructor(e){this.__ticksEnabled=!0;this.listeners={processChangeSet(e){var t={},i={};for(var o in e.graphChanges){var n=e.graphChanges[o];n===void 0?i[o]=!0:(__dcg_shared_module_exports__['_b'](n),t[o]=n)}var a={};for(var o in e.intersectionChanges)i[o]||(a[o]=e.intersectionChanges[o]);var s=!!this.changeSet;this.onEvaluatorResults({evaluationStates:e.statusChanges,graphData:{addedGraphs:t,removedGraphs:i,intersections:a},renderSlowly:!!e.isCompleteState,timingData:e.timingData,eventUpdates:e.eventUpdates});let l=e.syncId;for(;this.syncRequests.length&&l!==void 0&&this.syncRequests[0].id<=l;)this.syncRequests.shift().callback();this.markJobFinished(),s&&this._processChangeSet()}};this.__state={},this.changeSet=null,this.cumulativeChangeSet={},this.syncId=1,this.syncRequests=[],e||(e=new $b),this.workerPool=e,this.createWorkerPoolConnection()}privateGetWorkerPool(){return this.workerPool}privateGetWorkerPoolConnection(){return this.workerPoolConnection}createWorkerPoolConnection(){this.workerPoolConnection&&(this.workerPoolConnection.onResponse=function(){},this.workerPoolConnection.onWorkerKilled=function(){}),this.workerPoolConnection=new EG(this.workerPool),this.markJobFinished(),this.workerPoolConnection.onResponse=e=>{this.shouldIgnoreWorkerMessage(e)?e.type==="processChangeSet"&&(this.markJobFinished(),this._processChangeSet()):this.listeners[e.type].call(this,e.payload)},this.workerPoolConnection.onWorkerKilled=()=>{var e=this.hasJobInWorker();this.createWorkerPoolConnection(),e?(this.changeSet=__dcg_shared_module_exports__['j'](this.cumulativeChangeSet),this.__state.changed=!0,this.__state.droppedMessage=!0):(this.changeSet=__dcg_shared_module_exports__['j'](this.cumulativeChangeSet),this.__state.changed=!1),this.processChangeSet()}}destroy(){this.workerPoolConnection&&(this.workerPoolConnection.onResponse=function(){},this.workerPoolConnection.onWorkerKilled=function(){},this.workerPoolConnection.destroy())}shouldIgnoreWorkerMessage(e){return this.__suspendUntilSyncId?!e||!e.payload?!0:!(e.payload.syncId>=this.__suspendUntilSyncId):!1}suspend(){(!this.changeSet||!this.changeSet.syncId)&&(this.syncId++,this.applyToChangeSets(e=>{e.syncId=this.syncId})),this.__suspendUntilSyncId=this.changeSet.syncId}markJobFinished(){this.__state.droppedMessage=!1,this.__jobStartTime=-1,this.__suspendUntilSyncId=void 0}startJobTimer(){this.__jobStartTime=new Date().getTime()}hasJobInWorker(){return this.__jobStartTime!==-1}getJobElapsedTime(){return this.hasJobInWorker()?new Date().getTime()-this.__jobStartTime:NaN}setTicksEnabled(e){this.__ticksEnabled=e}tick(){this.__ticksEnabled&&this._processChangeSet()}processChangeSet(){this.__processChangeSetRequested=!0}_processChangeSet(){if(this._syncEvaluatorConfig(),!this.__processChangeSetRequested)return;let e=this.getJobElapsedTime()>=Jee;if(this.__state.droppedMessage&&e){this.workerPoolConnection.killWorker();return}if(this.__state.changed&&this.changeSet)if(this.changeSet.syncId||(this.syncId++,this.changeSet.syncId=this.syncId),this.hasJobInWorker())this.changeSet.isCompleteState&&e&&this.workerPoolConnection.killWorker();else{let t=this.changeSet;this.changeSet=null,this.__state.changed=!1,this.startJobTimer(),this.workerPoolConnection.sendMessage(t),this.__processChangeSetRequested=!1}}notifyWhenSynced(e){if(this._syncEvaluatorConfig(),!this.hasJobInWorker()&&!this.changeSet){setTimeout(e,0);return}this.syncId++,this.syncRequests.push({id:this.syncId,callback:e}),this.applyToChangeSets(t=>{t.syncId=this.syncId})}applyToChangeSets(e){this.__state.changed=!0,this.changeSet||(this.changeSet={}),this.cumulativeChangeSet||(this.cumulativeChangeSet={}),e(this.changeSet),e(this.cumulativeChangeSet),this.processChangeSet()}clearStatementsAndStartCompleteState(){this.hasJobInWorker()&&this.suspend(),this.applyToChangeSets(function(e){e.isCompleteState=!0,delete e.statements})}markUndoRedoState(){this.applyToChangeSets(function(e){e.isUndoRedoState=!0})}addStatement(e){this.applyToChangeSets(function(t){t.statements||(t.statements={}),t.statements[e.id]=__dcg_shared_module_exports__['j'](e)})}removeStatement(e){this.applyToChangeSets(function(t){t.statements||(t.statements={}),t.removes||(t.removes={}),delete t.statements[e],t.removes[e]=!0})}addActionStepEvent(e){this.applyToChangeSets(function(t){t.events||(t.events=[]),t.events.push({type:"step",expressionId:e})})}addClockTickEvent(e,t){this.applyToChangeSets(function(i){i.events||(i.events=[]),i.events.push({type:"clock-tick",id:e,isFirstTick:t})})}addClickEvent(e,t){this.applyToChangeSets(function(i){i.events||(i.events=[]),t===void 0&&(t=0),i.events.push({type:"click",expressionId:e,indexVar:t})})}_syncEvaluatorConfig(){if(this.readEvaluatorConfig){var e=this.readEvaluatorConfig();for(let t in e)this._applyIfChanged(e,t)}}_applyIfChanged(e,t){let i=this.cumulativeChangeSet&&this.cumulativeChangeSet[t],o=e[t];__dcg_shared_module_exports__['P'](i,o)||this.applyToChangeSets(function(n){n[t]=o})}};function op(r){return r==="es-ES"?(__dcg_shared_module_exports__['rd'].warn("{language: 'es-ES'} has been deprecated. Proceeding with {language: 'es'}"),"es"):r}var TG=class{constructor(){this.seen=new Set;this.samples=[];this.button=document.createElement("button");this.isRecording=!1;this.reset(),this.button.addEventListener("click",()=>{if(this.isRecording){this.isRecording=!1;let e=this.reportAsCalcState();console.log("Profiler result (also set on window.profilerResult):"),console.log(e),window.profilerResult=e;let t=JSON.stringify(e);Zee(t)}else this.reset(),this.isRecording=!0;this.updateButtonText()})}updateButtonText(){this.button.innerText=this.isRecording?"\u25FC\uFE0F":"\u{1F534}"}add(e,t){this.seen.has(e)||this.samples.push(t)}reset(){this.seen=new Set,this.samples=[],this.isRecording=!1,this.updateButtonText()}reportAsCalcState(){let e={};for(let i of this.samples)for(let o in i)e[o]||(e[o]=[]),e[o].push(i[o]);return Xee(window.location.href,e)}},uz=[__dcg_shared_module_exports__['o'].RED,__dcg_shared_module_exports__['o'].BLUE,__dcg_shared_module_exports__['o'].GREEN,__dcg_shared_module_exports__['o'].PURPLE,__dcg_shared_module_exports__['o'].ORANGE,__dcg_shared_module_exports__['o'].BLACK];function Xee(r,e){let t=[];for(let o in e){let n=e[o].map(__dcg_shared_module_exports__['sc']);t.push({latex:Qee(o),values:n,color:uz[t.length%uz.length]})}return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},lh),{expressions:{list:[{id:"1",type:"text",text:r},{id:"2",type:"table",columns:t}]}})}function Qee(r){if(r.length===1)return r;let e=r.replace(/[^a-zA-Z0-9_]/g,"").replace(/^[0-9]/,"").replace(/__+/g,"_");return`${e[0]}_{${e.slice(1)}}`}async function Zee(r){if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(r);else{let e=document.createElement("textarea");e.value=r,e.style.position="absolute",e.style.left="-999999px",document.body.prepend(e),e.select();try{document.execCommand("copy")}catch(t){console.error(t)}finally{e.remove()}}}Lp();var ete=0,Uv=class{constructor(e,t,i,o){e||(e=document.createElement("div"));let n=document.createElement("div");n.className="dcg-dom-change-wrapper",n.style.width="100%",n.style.height="100%",e.appendChild(n),this.__id=ete++;let a=new Pp;this.graphSettings=a;for(let h in i)a.config.setProperty(h,i[h]);let s=new Bg(a);this.controller=s,o&&s.dispatch({type:"ui/container-resized",size:o}),this.rootElt=n,this.view=jb.mountToNode(Kv,this.rootElt,{controller:jb.const(s)});let l=new kh(t);this.controller.setEvaluator(l),this.controller.setRootElt(this.rootElt);let c=this.controller.findEl(".dcg-grapher-2d"),p=new Pg(c,a,this.controller,l);this.controller.setGrapher2d(p),this.grapher=p,this.controller.initStateStack(),l.readEvaluatorConfig=()=>({product:a.config.product,beta3d:!!Pr("beta3d"),evaluationMode:s.isGeometry()?"geometry":this.controller.isThreeDMode()?"graphing_3d":"graphing",globalRandomSeed:a.randomSeed,degreeMode:a.degreeMode,viewState:s.getViewState(),selectedIds:s.getPropagatedSelectedIds(),restrictedFunctions:a.config.restrictedFunctions,forceEnableGeometryFunctions:a.config.forceEnableGeometryFunctions,distributions:a.config.distributions,pointsOfInterest:a.config.pointsOfInterest,plotSingleVariableImplicitEquations:a.config.plotSingleVariableImplicitEquations,plotImplicits:a.config.plotImplicits,plotInequalities:a.config.plotInequalities,sliders:a.config.sliders,actions:!!a.config.actions,substitutions:!!a.config.substitutions,dimensions:s.getGrapherDimensions(),logInternalErrors:!!Da().logInternalErrors}),l.onEvaluatorResults=h=>{this.controller.dispatch({type:"on-evaluator-changes",changes:h.evaluationStates,timingData:h.timingData,graphData:h.graphData,eventUpdates:h.eventUpdates}),this.controller.requestRedrawGraph()},this.unsubFunc=this.controller.subscribeToChanges(()=>{this.controller.doesDOMHaveSize()&&(this.view.update(),this.grapher=this.controller.isThreeDMode()?this.controller.getGrapher3d()||this.controller.getGrapher2d():this.controller.getGrapher2d(),this.grapher.update());var h=!1;m()&&(h=!0),h&&this.controller.doesDOMHaveSize()&&(this.view.update(),this.grapher.update())});let u=new kr;u.setProperties({pixelCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0},mathCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0}}),this.graphpaperBounds=u;let m=()=>{var h=!1,x=s.computeMajorLayout(),C={left:x.grapher.left,right:x.grapher.left+x.grapher.width,width:x.grapher.width,top:x.grapher.top,bottom:x.grapher.top+x.grapher.height,height:x.grapher.height},D=this.grapher.getCurrentViewport(),k={top:D.ymax,bottom:D.ymin,left:D.xmin,right:D.xmax,width:D.xmax-D.xmin,height:D.ymax-D.ymin};__dcg_shared_module_exports__['P'](k,u.mathCoordinates)||(u.setProperty("mathCoordinates",k),h=!0);var M=C.height>0&&C.width>0;return M&&!__dcg_shared_module_exports__['P'](C,u.pixelCoordinates)&&(u.setProperty("pixelCoordinates",C),h=!0),h};H(this.rootElt).on("keydown.calculator-"+this.__id,h=>{this.grapher instanceof Pg&&this.grapher.audioGraph.handleKeydown(h),this.instanceHotkeys.handleKeydown(h)}),H(document.documentElement).on("dcg-tapstart.calculator-"+this.__id,h=>{var S;let x=h.target,C=!!this.rootElt.contains(x),D=h.wasHandled("create-expression-with-keyboard"),k=!!x.closest(".dcg-api-shared-keypad-root"),M=!!x.classList.contains("dcg-shell");!C&&!k&&!M&&!D&&s.dispatch({type:"set-none-selected"});let I=(S=this.controller.getGrapher2d())==null?void 0:S.traceLayer;if(!h.wasHandled("do-not-clear-poi-labels")&&I&&(I.clearOpenedPOI(),this.controller.requestRedrawGraph()),s.isInEditListMode()){let V=!x.closest(".dcg-exppanel")&&!x.closest(".dcg-options-menu")&&!x.closest(".dcg-expression-top-bar")&&!x.closest(".dcg-keypad");(!C||V)&&s.dispatch({type:"set-edit-list-mode",isEditListMode:!1,focusExpressionList:!1})}}),this.evaluator=l,this.controller.dispatch({type:"set-blank",degreeMode:!!i.degreeMode}),a.config.expressionsCollapsed&&this.setOptions({expressionsCollapsed:!0}),a.config.capExpressionSize&&this.setOptions({capExpressionSize:!0}),a.config.hasOwnProperty("pointsOfInterest")&&this.setOptions({pointsOfInterest:a.config.pointsOfInterest}),a.config.hasOwnProperty("backgroundColor")&&this.setOptions({backgroundColor:a.config.backgroundColor}),a.config.hasOwnProperty("textColor")&&this.setOptions({textColor:a.config.textColor}),a.config.observe("language",()=>{let h=this.controller.getState();this.controller.dispatch({type:"set-state",state:h})}),a.config.observe("forceLogModeRegressions",()=>{a.config.forceLogModeRegressions&&this.controller.setAllRegressionsToLogMode()}),this.instanceHotkeys=new tv(s)}initializeGrapher3d(e){let t=this.controller.findEl(".dcg-grapher-3d"),i=new e(t,this.controller.getGraphSettings(),this.controller,this.controller.getEvaluator());this.controller.setGrapher3d(i),this.grapher=i,this.controller.dispatch({type:"set-blank"}),this.controller.clearUndoRedoHistory()}setOption(e,t){this.controller.getGraphSettings().config.setProperty(e,t)}setOptions(e){let t,i=this.controller.getGraphSettings().config,o=__dcg_shared_module_exports__['a']({},e);e.hasOwnProperty("backgroundColor")&&(__dcg_shared_module_exports__['l'](e.backgroundColor)||(__dcg_shared_module_exports__['rd'].warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)"),delete o.backgroundColor)),e.hasOwnProperty("textColor")&&(__dcg_shared_module_exports__['l'](e.textColor)||(__dcg_shared_module_exports__['rd'].warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)"),delete o.textColor)),e.hasOwnProperty("menus")&&(__dcg_shared_module_exports__['rd'].warn("Deprecated option: menus. Setting settingsMenu and expressionsTopbar instead."),e.hasOwnProperty("settingsMenu")||(o.settingsMenu=!!e.menus),e.hasOwnProperty("expressionsTopbar")||(o.expressionsTopbar=!!e.menus),delete o.menus),e.hasOwnProperty("solutions")&&(__dcg_shared_module_exports__['rd'].warn("Deprecated option: solutions. Setting pointsOfInterest instead."),e.hasOwnProperty("pointsOfInterest")||(o.pointsOfInterest=!!e.solutions),delete o.solutions),e.hasOwnProperty("administerSecretFolders")&&(__dcg_shared_module_exports__['rd'].warn("Deprecated option: administerSecretFolders. Setting authorFeatures instead."),e.hasOwnProperty("authorFeatures")||(o.authorFeatures=!!e.administerSecretFolders),delete o.administerSecretFolders),e.hasOwnProperty("singleVariableSolutions")&&(__dcg_shared_module_exports__['rd'].warn("Deprecated option: singleVariableSolutions has been removed."),delete o.singleVariableSolutions),e.graphpaper===!1&&(e.expressionsCollapsed&&(o.expressionsCollapsed=!1,__dcg_shared_module_exports__['rd'].warn("Cannot set graphpaper: false with expressionsCollapsed: true. Proceeding with expressionsCollapsed: false.")),i.expressionsCollapsed&&(o.expressionsCollapsed=!1,__dcg_shared_module_exports__['rd'].warn("Disabling the graphpaper with the expressions list collapsed is not supported.Setting expressionsCollapsed: false.")),e.zoomButtons&&(o.zoomButtons=!1,__dcg_shared_module_exports__['rd'].warn("Cannot set graphpaper: false with zoomButtons: true. Proceeding with zoomButtons: false.")),e.showResetButtonOnGraphpaper&&(o.showResetButtonOnGraphpaper=!1,__dcg_shared_module_exports__['rd'].warn("Cannot set graphpaper: false with showResetButtonOnGraphpaper: true. Proceeding with showResetButtonOnGraphpaper: false.")),i.zoomButtons&&(o.zoomButtons=!1,__dcg_shared_module_exports__['rd'].warn("Disabling the graphpaper with the zoomButtons visible is not supported. Setting zoomButtons: false.")),i.showResetButtonOnGraphpaper&&(o.showResetButtonOnGraphpaper=!1,__dcg_shared_module_exports__['rd'].warn("Disabling the graphpaper with the reset button visible is not supported. Setting showResetButtonOnGraphpaper: false."))),i.graphpaper===!1&&(e.expressionsCollapsed||e.zoomButtons||e.showResetButtonOnGraphpaper)&&(o.graphpaper=!0,__dcg_shared_module_exports__['rd'].warn("Must have visible graphpaper to proceed. Setting graphpaper: true.")),e.lockViewport&&e.zoomButtons&&(o.zoomButtons=!1,__dcg_shared_module_exports__['rd'].warn("Cannot set zoomButtons: true and lockViewport: true. Proceeding with zoomButtons: false.")),i.lockViewport&&e.zoomButtons&&(o.lockViewport=!1,__dcg_shared_module_exports__['rd'].warn("Cannot set zoomButtons: true while the viewport is locked. Setting lockViewport: false.")),i.zoomButtons&&e.lockViewport&&(o.zoomButtons=!1,__dcg_shared_module_exports__['rd'].warn("Cannot lock the viewport without hiding the zoom buttons. Setting zoomButtons: false."));function n(p){let{notes:u,folders:m,images:h}=p;return u===!1||m===!1||h===!1}let a=n(e),s=n(__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},i),e)),l=i.pasteGraphLink,c=e.pasteGraphLink;a?(c||l)&&(o.pasteGraphLink=!1,__dcg_shared_module_exports__['rd'].warn("Cannot disable creating note, folder, or image expressions without disabling graph link pasting. Setting pasteGraphLink: false.")):c&&s&&(o.notes=!0,o.folders=!0,o.images=!0,__dcg_shared_module_exports__['rd'].warn("Cannot enable graph link pasting while the creation of notes, folders, or images is disable. Setting notes: true, folders: true, images: true.")),e.language&&(o.language=op(e.language)),e.logScales&&this.controller.isGeometry()&&(__dcg_shared_module_exports__['rd'].warn("Cannot set logScales: true in the geometry calculator"),delete o.logScales);for(t in o)if(o.hasOwnProperty(t))switch(t){case"expressionsCollapsed":this.setOption("expressionsCollapsed",!!o.expressionsCollapsed),o.expressionsCollapsed?this.controller.dispatch({type:"hide-expressions-list",focusShowIcon:!1}):this.controller.dispatch({type:"show-expressions-list",focusHideIcon:!1});break;case"qwertyKeyboard":this.setOption("qwertyKeyboard",!!o.qwertyKeyboard),this.controller.isLetterKeypadOpen()&&this.controller.dispatch({type:"keypad/abc"});break;case"degreeMode":this.setOption("degreeMode",!!o.degreeMode),this.controller.dispatch({type:"set-graph-settings",degreeMode:!!o.degreeMode});break;case"actions":{let u=o[t];if(u===void 0||u===this.controller.getGraphSettings().config.actions)break;this.setOption(t,u),this.setState(this.getState(),{allowUndo:!0});break}case"substitutions":{let u=o[t];if(u===void 0||u===this.controller.getGraphSettings().config.substitutions)break;this.setOption(t,u),this.setState(this.getState(),{allowUndo:!0});break}case"product":case"beta3d":{__dcg_shared_module_exports__['rd'].warn(`Cannot update '${t}' setting.`);break}case"logScales":{let u=o[t];u!==void 0&&(u===!1&&this.controller.dispatch({type:"set-graph-settings",xAxisScale:"linear",yAxisScale:"linear"}),this.setOption(t,u));break}case"graphDescription":{let u=o[t];typeof u=="string"||typeof u=="undefined"?this.setOption(t,u):__dcg_shared_module_exports__['rd'].warn("Invalid graphDescription. graphDescription must be of type string or undefined.");break}case"keypad":case"graphpaper":case"expressions":case"settingsMenu":case"zoomButtons":case"showResetButtonOnGraphpaper":case"expressionsTopbar":case"pointsOfInterest":case"trace":case"border":case"lockViewport":case"authorFeatures":case"authorMode":case"advancedStyling":case"images":case"imageUploadCallback":case"folders":case"notes":case"sliders":case"links":case"restrictedFunctions":case"forceEnableGeometryFunctions":case"distributions":case"pasteGraphLink":case"pasteTableData":case"clearIntoDegreeMode":case"autosize":case"plotSingleVariableImplicitEquations":case"plotImplicits":case"plotInequalities":case"colors":case"branding":case"disableScrollFix":case"invertedColors":case"fontSize":case"projectorMode":case"ghostMode":case"language":case"onlyTraceSelected":case"disableMouseInteractions":case"nativeOnscreenKeypad":case"functionDefinition":case"plaidMode":case"wireframe":case"pasteGraphLinkCallback":case"editOnWeb":case"crossOriginSaveTest":case"backgroundColor":case"textColor":case"enableTabindex":case"audioTraceReverseExpressions":case"showHamburger":case"decimalToFraction":case"capExpressionSize":case"transparentBackground":case"pauseWhenOffscreen":case"hideGeoUI":case"brailleMode":case"sixKeyInput":case"brailleControls":case"zoomFit":case"forceLogModeRegressions":case"cacheRenderedSvgs":case"audio":case"translucentSurfaces":{let u=o[t];u!==void 0&&this.setOption(t,u);break}default:return t}}setViewport(e){let t=new lo(e[0],e[1],e[2],e[3]);this.grapher.viewportController.setViewport(t),this.controller.dispatch({type:"commit-user-requested-viewport",viewport:t})}resize(e){e&&this.controller.dispatch({type:"ui/container-resized",size:e})}destroy(){H(document.documentElement).off(".calculator-"+this.__id),H(this.rootElt).off(".calculator-"+this.__id),this.unsubFunc(),this.graphSettings.unobserveAll(),this.evaluator&&this.evaluator.destroy(),this.grapher&&this.grapher.remove(),jb.unmountFromNode(this.rootElt),this.rootElt.remove()}tick(e,t){t||(this.controller.handleTick(e),this.controller.updateRenderShellsAfterDispatch()),this.evaluator.tick(),this.grapher&&this.grapher.tick(e)}getState(e){return this.controller.getState(e)}setBlank(e){this.controller.dispatch({type:"set-blank",opts:e||{}})}setState(e,t){this.controller.dispatch({type:"set-state",state:e,opts:t||{}})}};function tte(){let r=document.createElement("div");oa(r,{zIndex:"99999",position:"absolute",left:"0px",top:"0px",background:"#FFF"}),document.body.append(r);let e=document.createElement("div");e.innerText="waiting...",e.style.display="inline-block";let t=new TG;r.appendChild(t.button),r.appendChild(e);var i=window,o=[],n=[];i.Calc.controller.onEvaluatorChangesSpy=function(){o.push(Date.now())};let a=new WeakSet;i.__dcgKnownPrograms=a;let s=0;if(i.Calc.controller.isThreeDMode()){let l=i.Calc.controller.grapher3d.webglLayer;l.debugOnlyMeasureGPUTiming=!0,l.onRenderSpy=function(){let c=l.debugGetPrograms(),p=c.reduce((m,h)=>m+h.usedTimes,0),u=0;for(let m of c)a.has(m)||(u+=1,s+=1,a.add(m));n.push({ts:Date.now(),programCount:c.length,programUses:p,newProgramCount:u,frame:l.lastRenderInfo})},l.debugOnlyTrackBufferUploads()}setInterval(function(){for(var l=Date.now();l-o[0]>1e3;)o.shift();for(;n.length&&l-n[0].ts>1e3;)n.shift();let c=n.length,p=n.slice(-100);if(t.isRecording)for(let L of p){let{startTimeCPU:B,durationCPU:R,endTimeGPU:W}=L.frame;W&&t.add(B,{t0:B,tcpu:R,tgpu0:W[0]-B,tgpu1:W[1]-B})}let u=uu(p.map(L=>L.frame.durationCPU),2),m=[],h=[];for(let{frame:L}of p)L.endTimeGPU&&(m.push((L.endTimeGPU[0]+L.endTimeGPU[1])/2-L.startTimeCPU),h.push((L.endTimeGPU[0]-L.startTimeCPU)/2));let x=uu(m,2),C=uu(h,0),D=uu(p.map(L=>L.programUses)),k=uu(p.map(L=>L.programCount)),M=uu(p.map(L=>L.newProgramCount)),I=uu(p.map(L=>L.frame.triangles/1e3)),S=uu(p.map(L=>L.frame.bufferUploads,0)),V=uu(p.map(L=>L.frame.bufferUploadItems/1e3,1)),P=i.Calc.controller.isThreeDMode()?[`compute: <span dcg-fps-metric="computeFPS">${o.length}</span> fps`,`3d render: <span dcg-fps-metric="fps">${c}</span> fps`,`Redraw (CPU): <span dcg-fps-metric="redraw">${u}</span> ms`,`Redraw (CPU+GPU): <span dcg-fps-metric="cpu-gpu-redraw">${x}</span> \xB1<span dcg-fps-metric="cpu-gpu-redraw-error">${C}</span>ms`,`triangles: <span dcg-fps-metric="triangles">${I}</span>K/fr`,`buffers: <span dcg-fps-metric="uploadsPerFrame">${S}</span> uploads/fr, <span dcg-fps-metric="itemsPerFrame">${V}</span>K items/fr`,`programs: <span dcg-fps-metric="programsPerFrame">${D} uses/fr, <span dcg-fps-metric="programsCurrentPerFrame">${k} current/fr, <span dcg-fps-metric="programsNewPerFrame">${M}</span> new/fr, <span dcg-fps-metric="programsTotal">${s}</span> total`].join(" | "):`${o.length} fps`;e.innerHTML=P},100)}function uu(r,e=1){let t=0;for(let o of r)t+=o;return(t/r.length).toFixed(e)}function rte(){let r=document.createElement("div");oa(r,{zIndex:"99999",position:"absolute",left:"0px",top:"0px",background:"#FFF"}),r.innerText="waiting...",document.body.append(r);var e=window,t=[],i=0;e.Calc.controller.onEvaluatorChangesSpy=function(s,l){let{timeInWorker:c}=l;t[i%100]=c,i+=1};function o(){let s=0;for(let c of t)s+=c;let l=s/t.length;r.innerText=l.toFixed(1)+" ms"}let n;function a(){cancelAnimationFrame(n),n=requestAnimationFrame(a),o()}a()}var ite=!!Da().simulationFPS;ite&&(Hv=setInterval(function(){var r=window.Calc;r&&(clearInterval(Hv),tte())},1));var Hv,ote=!!Da().timeInWorker;ote&&(Hv=setInterval(function(){var e=window.Calc;e&&(clearInterval(Hv),setTimeout(rte,1e3))},1));var Hv;function nte(r){PD?setTimeout(r,25):requestAnimationFrame(r)}var hz=1,Yb={},Wv=!1;function mz(){Wv=!0,nte(ate)}var gz={};function ate(){gz.rafSPY&&gz.rafSPY(),Wv=!1;for(let r in Yb)Yb[r].detectAndEnqueueEvent(),Wv=!0;if(Wv){mz();for(let r in Yb)Yb[r].dispatchQueuedEvent()}}var Zg=class{constructor(e,t){this.elt=e;this.cb=t;this.destroyed=!1;this.lastOffscreen=!1;this.id=hz.toString(),this.appliedScale={x:1,y:1},hz++}stopWatching(){delete Yb[this.id]}startWatching(){this.checkForChanges(),Yb[this.id]=this,Wv||mz()}resetAppliedScalingAndGetBoundingClientRect(){var e=this.elt.getBoundingClientRect(),t={x:e.width/this.elt.offsetWidth,y:e.height/this.elt.offsetHeight};if(t.x===this.appliedScale.x&&t.y===this.appliedScale.y)return e;let i=this.elt.querySelector(".dcg-dom-change-wrapper");return i&&(this.appliedScale=t,oa(i,{transform:"scale("+1/this.appliedScale.x+","+1/this.appliedScale.y+")",width:100*this.appliedScale.x+"%",height:100*this.appliedScale.y+"%",transformOrigin:"0 0"})),e}detectAndEnqueueEvent(){if(this.destroyed)return;let e=!0;if(!(document.body&&document.body.contains(this.elt)))this.lastSize&&(this.lastSize=void 0,this.queuedEvent={type:"removed",target:this.elt,isOffscreen:!0});else{let i=this.resetAppliedScalingAndGetBoundingClientRect();e=i.top>window.innerHeight||i.bottom<0||i.left>window.innerWidth||i.right<0,this.lastSize?(i.width!==this.lastSize.width||i.height!==this.lastSize.height||window.devicePixelRatio!==this.lastSize.pixelRatio)&&(this.lastSize.width=i.width,this.lastSize.height=i.height,this.lastSize.pixelRatio=window.devicePixelRatio,this.queuedEvent={type:"resized",target:this.elt,size:__dcg_shared_module_exports__['a']({},this.lastSize),isOffscreen:e}):(this.lastSize={width:i.width,height:i.height,pixelRatio:window.devicePixelRatio},this.queuedEvent={type:"added",target:this.elt,size:__dcg_shared_module_exports__['a']({},this.lastSize),isOffscreen:e})}e!==this.lastOffscreen&&(this.lastOffscreen=e,this.queuedEvent||(this.queuedEvent={type:"offscreen-noop",target:this.elt,isOffscreen:e}))}dispatchQueuedEvent(){let e=this.queuedEvent;e&&(this.queuedEvent=void 0,this.cb(e))}checkForChanges(){this.detectAndEnqueueEvent(),this.dispatchQueuedEvent()}destroy(){this.stopWatching();for(var e in this)this.hasOwnProperty(e)&&delete this[e];this.destroyed=!0}};function fz(r){var e=r.mode,t=r.width,i=r.height,o=r.currentBounds,n=r.graphpaperAspectRatio,a=r.mathAspectRatio,s=r.mathBounds,l=t/i,c={x:o.left+o.width/2,y:o.bottom+o.height/2};if(s.left===void 0!=(s.right===void 0)||s.bottom===void 0!=(s.top===void 0))return __dcg_shared_module_exports__['rd'].warn('asyncScreenshot: cannot specify "left" bound without "right" or "bottom" bound without "top". Got: '+s),o;var p=s.left!==void 0&&s.right!==void 0,u=s.bottom!==void 0&&s.top!==void 0,m=p&&u,h,x,C,D,k,M,I,S,V,P;switch(e){case"stretch":return m?s:p?{left:s.left,right:s.right,bottom:o.bottom,top:o.top}:u?{left:o.left,right:o.right,bottom:s.bottom,top:s.top}:o;case"contain":return m?(D=s.right-s.left,k=s.top-s.bottom,M={x:s.left+D/2,y:s.bottom+k/2},C=D/k,l>C?(x=k/i,h=x*a,{left:M.x-h*t/2,right:M.x+h*t/2,bottom:s.bottom,top:s.top}):(h=D/t,x=h/a,{left:s.left,right:s.right,bottom:M.y-x*i/2,top:M.y+x*i/2})):p?(I=s.right-s.left,S=s.left+I/2,C=I/o.height,l>C?(x=o.height/i,h=x*a,{left:S-h*t/2,right:S+h*t/2,bottom:o.bottom,top:o.top}):(h=I/t,x=h/a,{left:s.left,right:s.right,bottom:c.y-x*i/2,top:c.y+x*i/2})):u?(V=s.top-s.bottom,P=s.bottom+V/2,C=o.width/V,l>C?(x=V/i,h=x*a,{left:c.x-h*t/2,right:c.x+h*t/2,bottom:s.bottom,top:s.top}):(h=o.width/t,x=h/a,{left:o.left,right:o.right,bottom:P-x*i/2,top:P+x*i/2})):l>n?(x=o.height/i,h=x*a,{left:c.x-h*t/2,right:c.x+h*t/2,bottom:o.bottom,top:o.top}):(h=o.width/t,x=h/a,{left:o.left,right:o.right,bottom:c.y-x*i/2,top:c.y+x*i/2});case"preserveX":return m?(D=s.right-s.left,k=s.top-s.bottom,M={x:s.left+D/2,y:s.bottom+k/2},C=D/k,h=D/t,x=h/a,{left:s.left,right:s.right,bottom:M.y-x*i/2,top:M.y+x*i/2}):u?(V=s.top-s.bottom,P=s.bottom+V/2,C=o.width/V,h=o.width/t,x=h/a,{left:o.left,right:o.right,bottom:P-x*i/2,top:P+x*i/2}):p?(I=s.right-s.left,h=I/t,x=h/a,{left:s.left,right:s.right,bottom:c.y-x*i/2,top:c.y+x*i/2}):(I=o.right-o.left,h=I/t,x=h/a,{left:o.left,right:o.right,bottom:c.y-x*i/2,top:c.y+x*i/2});case"preserveY":return m?(D=s.right-s.left,k=s.top-s.bottom,M={x:s.left+D/2,y:s.bottom+k/2},C=D/k,x=k/i,h=x*a,{left:M.x-h*t/2,right:M.x+h*t/2,bottom:s.bottom,top:s.top}):p?(I=s.right-s.left,S=s.left+I/2,C=I/o.height,x=o.height/i,h=x*a,{left:S-h*t/2,right:S+h*t/2,bottom:o.bottom,top:o.top}):u?(V=s.top-s.bottom,x=V/i,h=x*a,{left:c.x-h*t/2,right:c.x+h*t/2,bottom:s.bottom,top:s.top}):(V=o.top-o.bottom,x=V/i,h=x*a,{left:c.x-h*t/2,right:c.x+h*t/2,bottom:o.bottom,top:o.top});default:return o}}function jv(r,e){for(var t in e)if(e.hasOwnProperty(t)&&e[t]===r)return!0;return!1}function _L(r){return jv(r,RL)}function FL(r){return jv(r,NL)}function bz(r){return jv(r,BL)}function ste(r){return jv(r,$v)}function lte(r){return jv(r,qL)}var RL={OPEN:"OPEN",CROSS:"CROSS",POINT:"POINT"},NL={SOLID:"SOLID",DASHED:"DASHED",DOTTED:"DOTTED"},BL={NONE:"NONE",AUTO:"AUTO",X:"X",Y:"Y",XY:"XY"},$v={POINTS:"POINTS",LINES:"LINES",POINTS_AND_LINES:"POINTS_AND_LINES"},qL={DEFAULT:"default",CENTER:"center",CENTER_AUTO:"center_auto",AUTO_CENTER:"auto_center",ABOVE:"above",ABOVE_LEFT:"above_left",ABOVE_RIGHT:"above_right",ABOVE_AUTO:"above_auto",BELOW:"below",BELOW_LEFT:"below_left",BELOW_RIGHT:"below_right",BELOW_AUTO:"below_auto",LEFT:"left",AUTO_LEFT:"auto_left",RIGHT:"right",AUTO_RIGHT:"auto_right"};function cte(r){return{id:r.id,type:r.type,columns:r.columns.map(dte)}}function dte(r){return{id:r.id,latex:r.latex,color:r.color,hidden:r.hidden,pointStyle:r.pointStyle,pointSize:r.pointSize,pointOpacity:r.pointOpacity,lineStyle:r.lineStyle,lineWidth:r.lineWidth,lineOpacity:r.lineOpacity,points:r.points,lines:r.lines,dragMode:r.dragMode,values:r.values.slice()}}function pte(r){var e=["latex","color","lineStyle","lineWidth","lineOpacity","pointStyle","pointSize","pointOpacity","points","lines","fill","fillOpacity","hidden","secret","dragMode","label","showLabel","labelSize","labelOrientation","interactiveLabel","readonly"],t={id:r.id,type:r.type};return e.forEach(function(i){r.hasOwnProperty(i)&&(t[i]=r[i])}),r.hasOwnProperty("parametricDomain")&&(t.parametricDomain={min:r.parametricDomain.min,max:r.parametricDomain.max}),r.hasOwnProperty("parametricDomain3Du")&&(t.parametricDomain3Du={min:r.parametricDomain3Du.min,max:r.parametricDomain3Du.max}),r.hasOwnProperty("parametricDomain3Dv")&&(t.parametricDomain3Dv={min:r.parametricDomain3Dv.min,max:r.parametricDomain3Dv.max}),r.hasOwnProperty("polarDomain")&&(t.polarDomain={min:r.polarDomain.min,max:r.polarDomain.max}),r.hasOwnProperty("domain")&&(t.domain={min:r.domain.min,max:r.domain.max}),r.slider&&(r.slider.hardMin&&(t.sliderBounds=t.sliderBounds||{},t.sliderBounds.min=r.slider.min),r.slider.hardMax&&(t.sliderBounds=t.sliderBounds||{},t.sliderBounds.max=r.slider.max),r.slider.step&&(t.sliderBounds=t.sliderBounds||{},t.sliderBounds.step=r.slider.step),t.playing=!!r.slider.isPlaying),t}function ute(r){return{id:r.id,type:r.type,hidden:r.hidden,secret:r.secret}}function hte(r){return{id:r.id,type:r.type,hidden:r.hidden,secret:r.secret}}function gte(r){return{id:r.id,type:r.type,secret:r.secret}}function IG(r){switch(r.type){case"expression":return pte(r);case"table":return cte(r);case"folder":return hte(r);case"image":return ute(r);case"text":return gte(r);default:return r}}function Jb(r,e){return r.hasOwnProperty("id")?r.id+"":e.generateId()}function mte(r,e){var t={type:"expression",id:Jb(r,e)};if(t.type="expression",t.id=Jb(r,e),r.hasOwnProperty("latex")&&(t.latex=r.latex+""),r.hasOwnProperty("color")&&(t.color=r.color+""),r.hasOwnProperty("points")&&(t.points=!!r.points),r.hasOwnProperty("lines")&&(t.lines=!!r.lines),r.hasOwnProperty("style")&&(__dcg_shared_module_exports__['rd'].warn("As of API v1.1 the 'style' property is deprecated and has been split into 'pointStyle' and 'lineStyle'."),_L(r.style)?t.pointStyle=r.style:FL(r.style)?t.lineStyle=r.style:__dcg_shared_module_exports__['rd'].warn("Invalid style: '"+r.style+"'.")),r.hasOwnProperty("pointStyle")&&(_L(r.pointStyle)?t.pointStyle=r.pointStyle:__dcg_shared_module_exports__['rd'].warn("Invalid pointStyle: '"+r.pointStyle+"'.")),r.hasOwnProperty("pointSize")&&(t.pointSize=""+r.pointSize),r.hasOwnProperty("pointOpacity")&&(t.pointOpacity=""+r.pointOpacity),r.hasOwnProperty("lineStyle")&&(FL(r.lineStyle)?t.lineStyle=r.lineStyle:__dcg_shared_module_exports__['rd'].warn("Invalid lineStyle: '"+r.lineStyle+"'.")),r.hasOwnProperty("lineWidth")&&(t.lineWidth=""+r.lineWidth),r.hasOwnProperty("lineOpacity")&&(t.lineOpacity=""+r.lineOpacity),r.hasOwnProperty("hidden")&&(t.hidden=!!r.hidden),r.hasOwnProperty("readonly")&&(t.readonly=!!r.readonly),r.hasOwnProperty("secret")&&(t.secret=!!r.secret),r.hasOwnProperty("sliderBounds")&&r.sliderBounds&&(t.slider={min:__dcg_shared_module_exports__['rc'](r.sliderBounds.min),max:__dcg_shared_module_exports__['rc'](r.sliderBounds.max),step:__dcg_shared_module_exports__['rc'](r.sliderBounds.step)},t.slider.min&&(t.slider.hardMin=!0),t.slider.max&&(t.slider.hardMax=!0)),r.hasOwnProperty("playing")){let{playing:i}=r;typeof i!="boolean"?__dcg_shared_module_exports__['rd'].warn(`Invalid value for 'playing'. Expected a boolean but got '${i}'.`):(t.slider||(t.slider={}),t.slider.isPlaying=i)}return r.hasOwnProperty("parametricDomain3Du")&&r.parametricDomain3Du&&(t.parametricDomain3Du={min:__dcg_shared_module_exports__['rc'](r.parametricDomain3Du.min),max:__dcg_shared_module_exports__['rc'](r.parametricDomain3Du.max)}),r.hasOwnProperty("parametricDomain3Dv")&&r.parametricDomain3Dv&&(t.parametricDomain3Dv={min:__dcg_shared_module_exports__['rc'](r.parametricDomain3Dv.min),max:__dcg_shared_module_exports__['rc'](r.parametricDomain3Dv.max)}),r.hasOwnProperty("parametricDomain")&&r.parametricDomain?(t.parametricDomain={min:__dcg_shared_module_exports__['rc'](r.parametricDomain.min),max:__dcg_shared_module_exports__['rc'](r.parametricDomain.max)},r.hasOwnProperty("domain")&&__dcg_shared_module_exports__['rd'].warn("Both 'parametricDomain' and the deprecated 'domain' property were specified. Using 'parametricDomain'.")):r.hasOwnProperty("domain")&&(__dcg_shared_module_exports__['rd'].warn("The 'domain' property is deprecated.Use 'parametricDomain' to specify the domain for parametric functions"),t.parametricDomain={min:__dcg_shared_module_exports__['rc'](r.domain.min),max:__dcg_shared_module_exports__['rc'](r.domain.max)}),r.hasOwnProperty("polarDomain")&&r.polarDomain&&(t.polarDomain={min:__dcg_shared_module_exports__['rc'](r.polarDomain.min),max:__dcg_shared_module_exports__['rc'](r.polarDomain.max)}),r.hasOwnProperty("dragMode")&&(bz(r.dragMode)?t.dragMode=r.dragMode:__dcg_shared_module_exports__['rd'].warn("Invalid dragMode: '"+r.dragMode+"'.")),r.hasOwnProperty("label")&&(t.label=r.label+""),r.hasOwnProperty("showLabel")&&(t.showLabel=!!r.showLabel),r.hasOwnProperty("showAngleLabel")&&(t.showAngleLabel=!!r.showAngleLabel),r.hasOwnProperty("labelSize")&&(typeof r.labelSize=="string"?t.labelSize=r.labelSize:__dcg_shared_module_exports__['rd'].warn("Invalid labelSize: "+r.labelSize)),r.hasOwnProperty("labelOrientation")&&(lte(r.labelOrientation)?t.labelOrientation=r.labelOrientation:__dcg_shared_module_exports__['rd'].warn("Invalid labelOrientation: "+r.labelOrientation)),r.hasOwnProperty("fill")&&(t.fill=!!r.fill),r.hasOwnProperty("fillOpacity")&&(t.fillOpacity=""+r.fillOpacity),t}function fte(r,e){var t={id:Jb(r,e)};return r.hasOwnProperty("latex")&&(t.latex=r.latex+""),r.hasOwnProperty("color")&&(t.color=r.color+""),r.hasOwnProperty("hidden")&&(t.hidden=!!r.hidden),r.hasOwnProperty("points")&&(t.points=!!r.points),r.hasOwnProperty("lines")&&(t.lines=!!r.lines),r.hasOwnProperty("values")&&r.values&&(t.values=r.values.map(function(i){return i+""})),r.hasOwnProperty("pointStyle")&&(_L(r.pointStyle)?t.pointStyle=r.pointStyle:__dcg_shared_module_exports__['rd'].warn("Invalid pointStyle: '"+r.pointStyle+"'.")),r.hasOwnProperty("pointSize")&&(t.pointSize=""+r.pointSize),r.hasOwnProperty("pointOpacity")&&(t.pointOpacity=""+r.pointOpacity),r.hasOwnProperty("lineStyle")&&(FL(r.lineStyle)?t.lineStyle=r.lineStyle:__dcg_shared_module_exports__['rd'].warn("Invalid lineStyle: '"+r.lineStyle+"'.")),r.hasOwnProperty("lineWidth")&&(t.lineWidth=""+r.lineWidth),r.hasOwnProperty("lineOpacity")&&(t.lineOpacity=""+r.lineOpacity),r.hasOwnProperty("columnMode")&&(__dcg_shared_module_exports__['rd'].warn("As of API v1.1 the 'columnMode' property is deprecated and has been split into individual 'points' and 'lines' properties."),r.columnMode===$v.POINTS_AND_LINES?(t.points=!0,t.lines=!0):r.columnMode===$v.LINES?(t.points=!1,t.lines=!0):(t.points=!0,t.lines=!1),t.lines&&!t.points&&r.hasOwnProperty("dragMode")&&r.dragMode!=="NONE"&&(__dcg_shared_module_exports__['rd'].warn("A 'lines' value of true and 'points' value of false is only compatible with a dragMode of 'NONE'. Proceeding by setting 'points' to true."),t.points=!0),ste(r.columnMode)&&__dcg_shared_module_exports__['rd'].warn("Invalid columnMode: '"+r.columnMode+"'.")),r.hasOwnProperty("dragMode")&&(bz(r.dragMode)?t.dragMode=r.dragMode==="AUTO"?"NONE":r.dragMode:__dcg_shared_module_exports__['rd'].warn("Invalid dragMode: '"+r.dragMode+"'.")),t}function bte(r,e){var t={type:"table",id:Jb(r,e)};return r.hasOwnProperty("columns")&&r.columns&&(t.columns=r.columns.map(function(i){return fte(i,e)})),t}function yte(r,e){var t={type:"folder",id:Jb(r,e)};return r.hasOwnProperty("hidden")&&(t.hidden=!!r.hidden),t}function xte(r,e){var t={type:"image",id:Jb(r,e)};return r.hasOwnProperty("hidden")&&(t.hidden=!!r.hidden),t}function VG(r,e,t){var i=r.type;if(e&&i&&i!==e){__dcg_shared_module_exports__['rd'].warn("Cannot change type of expression from '"+e+"' to '"+i+"'.");return}switch(i){case void 0:case"expression":return mte(r,t);case"image":return xte(r,t);case"table":return bte(r,t);case"folder":return yte(r,t);default:if(e){__dcg_shared_module_exports__['rd'].warn("Cannot modify expressions of type: '"+e+"' through the API.");return}else{__dcg_shared_module_exports__['rd'].warn("Invalid expression type: '"+i+"'.");return}}}var MG=class{constructor(e){this.mq=e,this.id=e.id,this.data=e.data}simulateUserChangedLatex(){_e.simulateUserChangedLatex(this.mq)}simulateKeypress(e){_e.simulateKeypress(this.mq,e)}config(e){return this.mq.config(e),this}latex(e){return e===void 0?this.mq.latex():(this.mq.latex(e),this.simulateUserChangedLatex(),this)}reflow(){this.mq.reflow()}el(){return this.mq.el()}getAriaLabel(){return this.mq.getAriaLabel()}setAriaLabel(e){return this.mq.setAriaLabel(e)}html(){return this.mq.html()}mathspeak(){return this.mq.mathspeak()}text(){return this.mq.text()}selection(){return this.mq.selection()}select(){return this.mq.select(),this}moveToRightEnd(){return this.mq.moveToRightEnd(),this}moveToLeftEnd(){return this.mq.moveToLeftEnd(),this}cmd(e){return this.mq.cmd(e),this.simulateUserChangedLatex(),this}write(e){return this.mq.write(e),this.simulateUserChangedLatex(),this}keystroke(e){return this.simulateKeypress(e),this}typedText(e){return this.mq.typedText(e),this.simulateUserChangedLatex(),this}clearSelection(){return this.mq.clearSelection(),this}getAriaPostLabel(){return this.mq.getAriaPostLabel()}setAriaPostLabel(e,t){return this.mq.setAriaPostLabel(e,t),this}blur(){return this.mq.blur(),this}focus(){return this.mq.focus(),this}revert(){return this.mq.revert()}ignoreNextMousedown(e){return this.mq.ignoreNextMousedown(e),this}clickAt(e,t,i){return this.mq.clickAt(e,t,i),this}};Lp();function wte(r){function e(t){requestAnimationFrame(e),r(t)}requestAnimationFrame(e)}function vte(r){function e(){setTimeout(e,Xb),r(Date.now())}setTimeout(e,Xb)}var yz=Da().timeoutLoop,Xb=0;typeof yz=="string"&&(Xb=parseFloat(yz),isNaN(Xb)&&(Xb=1e3/60));var xz=Xb>0?vte:wte;var zL=new kr;xz(function(r){zL.triggerEvent("tick",r)});var KL=0;function Ls(r){return KL+=1,zL.observeEvent("tick."+KL,function(e,t){r(t)}),KL}function Os(r){zL.unobserveEvent("tick."+r)}ig();var wz=_p(location.search,"nworkers"),vz=4;wz&&(vz=parseInt(wz,10));var Qb=new $b(vz);var AG={};__dcg_shared_module_exports__['g'](AG,{LARGE:()=>Ste,MEDIUM:()=>UL,SMALL:()=>Dte,VERY_LARGE:()=>kte,VERY_SMALL:()=>Cte});var Cte=9,Dte=12,UL=16,Ste=20,kte=24;var mt=function(r,e,t){var i=document.createElement("img"),o,n;if(i.onerror=e,i.onload=function(){n&&!(t&&t.noRevoke)&&mt.revokeObjectURL(n),e&&e(mt.scale(i,t))},mt.isInstanceOf("Blob",r)||mt.isInstanceOf("File",r))o=n=mt.createObjectURL(r),i._type=r.type;else if(typeof r=="string")o=r,t&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin);else return!1;return o?(i.src=o,i):mt.readFile(r,function(a){var s=a.target;s&&s.result?i.src=s.result:e&&e(a)})},LG=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;mt.isInstanceOf=function(r,e){return Object.prototype.toString.call(e)==="[object "+r+"]"};mt.transformCoordinates=function(){};mt.getTransformedOptions=function(r){return r};mt.renderImageToCanvas=function(r,e,t,i,o,n,a,s,l,c){return r.getContext("2d").drawImage(e,t,i,o,n,a,s,l,c),r};mt.hasCanvasOption=function(r){return r.canvas||r.crop};mt.scale=function(r,e){e=e||{};var t=document.createElement("canvas"),i=r.getContext||mt.hasCanvasOption(e)&&t.getContext,o=r.naturalWidth||r.width,n=r.naturalHeight||r.height,a=o,s=n,l,c,p,u,m,h,x,C,D,k=function(){var I=Math.max((p||a)/a,(u||s)/s);I>1&&(a=Math.ceil(a*I),s=Math.ceil(s*I))},M=function(){var I=Math.min((l||a)/a,(c||s)/s);I<1&&(a=Math.ceil(a*I),s=Math.ceil(s*I))};return i&&(e=mt.getTransformedOptions(e),x=e.left||0,C=e.top||0,e.sourceWidth?(m=e.sourceWidth,e.right!==void 0&&e.left===void 0&&(x=o-m-e.right)):m=o-x-(e.right||0),e.sourceHeight?(h=e.sourceHeight,e.bottom!==void 0&&e.top===void 0&&(C=n-h-e.bottom)):h=n-C-(e.bottom||0),a=m,s=h),l=e.maxWidth,c=e.maxHeight,p=e.minWidth,u=e.minHeight,i&&l&&c&&e.crop?(a=l,s=c,D=m/h-l/c,D<0?(h=c*m/l,e.top===void 0&&e.bottom===void 0&&(C=(n-h)/2)):D>0&&(m=l*h/c,e.left===void 0&&e.right===void 0&&(x=(o-m)/2))):((e.contain||e.cover)&&(p=l=l||p,u=c=c||u),e.cover?(M(),k()):(k(),M())),i?(t.width=a,t.height=s,mt.transformCoordinates(t,e),mt.renderImageToCanvas(t,r,x,C,m,h,0,0,a,s)):(r.width=a,r.height=s,r)};mt.createObjectURL=function(r){return LG?LG.createObjectURL(r):!1};mt.revokeObjectURL=function(r){return LG?LG.revokeObjectURL(r):!1};mt.readFile=function(r,e,t){if(window.FileReader){var i=new FileReader;if(i.onload=i.onerror=e,t=t||"readAsDataURL",i[t])return i[t](r),i}return!1};(!window.navigator||!window.navigator.platform||!/iP(hone|od|ad)/.test(window.navigator.platform))&&(Cz=mt.renderImageToCanvas,mt.detectSubsampling=function(r){var e,t;return r.width*r.height>1024*1024?(e=document.createElement("canvas"),e.width=e.height=1,t=e.getContext("2d"),t.drawImage(r,-r.width+1,0),t.getImageData(0,0,1,1).data[3]===0):!1},mt.detectVerticalSquash=function(r,e){var t=r.naturalHeight||r.height,i=document.createElement("canvas"),o=i.getContext("2d"),n,a,s,l,c;for(e&&(t/=2),i.width=1,i.height=t,o.drawImage(r,0,0),n=o.getImageData(0,0,1,t).data,a=0,s=t,l=t;l>a;)c=n[(l-1)*4+3],c===0?s=l:a=l,l=s+a>>1;return l/t||1},mt.renderImageToCanvas=function(r,e,t,i,o,n,a,s,l,c){if(e._type==="image/jpeg"){var p=r.getContext("2d"),u=document.createElement("canvas"),m=1024,h=u.getContext("2d"),x,C,D,k;if(u.width=m,u.height=m,p.save(),x=mt.detectSubsampling(e),x&&(t/=2,i/=2,o/=2,n/=2),C=mt.detectVerticalSquash(e,x),x||C!==1){for(i*=C,l=Math.ceil(m*l/o),c=Math.ceil(m*c/n/C),s=0,k=0;k<n;){for(a=0,D=0;D<o;)h.clearRect(0,0,m,m),h.drawImage(e,t,i,o,n,-D,-k,o,n),p.drawImage(u,0,0,m,m,a,s,l,c),D+=m,a+=l;k+=m,s+=c}return p.restore(),r}}return Cz(r,e,t,i,o,n,a,s,l,c)});var Cz,Ete=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);mt.blobSlice=Ete&&function(){var r=this.slice||this.webkitSlice||this.mozSlice;return r.apply(this,arguments)};mt.metaDataParsers={jpeg:{65505:[]}};mt.parseMetaData=function(r,e,t){t=t||{};var i=this,o=t.maxMetaDataSize||262144,n={},a=!(window.DataView&&r&&r.size>=12&&r.type==="image/jpeg"&&mt.blobSlice);(a||!mt.readFile(mt.blobSlice.call(r,0,o),function(s){var l=s.target.result,c=new DataView(l),p=2,u=c.byteLength-4,m=p,h,x,C,D;if(c.getUint16(0)===65496){for(;p<u&&(h=c.getUint16(p),h>=65504&&h<=65519||h===65534);){if(x=c.getUint16(p+2)+2,p+x>c.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(C=mt.metaDataParsers.jpeg[h],C)for(D=0;D<C.length;D+=1)C[D].call(i,c,p,x,n,t);p+=x,m=p}!t.disableImageHead&&m>6&&(l.slice?n.imageHead=l.slice(0,m):n.imageHead=new Uint8Array(l).subarray(0,m))}else console.log("Invalid JPEG file: Missing JPEG marker.");e(n)},"readAsArrayBuffer"))&&e(n)};var Gte=mt.hasCanvasOption;mt.hasCanvasOption=function(r){return Gte(r)||r.orientation};mt.transformCoordinates=function(r,e){var t=r.getContext("2d"),i=r.width,o=r.height,n=e.orientation;if(n)switch(n>4&&(r.width=o,r.height=i),n){case 2:t.translate(i,0),t.scale(-1,1);break;case 3:t.translate(i,o),t.rotate(Math.PI);break;case 4:t.translate(0,o),t.scale(1,-1);break;case 5:t.rotate(.5*Math.PI),t.scale(1,-1);break;case 6:t.rotate(.5*Math.PI),t.translate(0,-o);break;case 7:t.rotate(.5*Math.PI),t.translate(i,-o),t.scale(-1,1);break;case 8:t.rotate(-.5*Math.PI),t.translate(-i,0);break}};mt.getTransformedOptions=function(r){if(!r.orientation||r.orientation===1)return r;var e={},t;for(t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);switch(r.orientation){case 2:e.left=r.right,e.right=r.left;break;case 3:e.left=r.right,e.top=r.bottom,e.right=r.left,e.bottom=r.top;break;case 4:e.top=r.bottom,e.bottom=r.top;break;case 5:e.left=r.top,e.top=r.left,e.right=r.bottom,e.bottom=r.right;break;case 6:e.left=r.top,e.top=r.right,e.right=r.bottom,e.bottom=r.left;break;case 7:e.left=r.bottom,e.top=r.right,e.right=r.top,e.bottom=r.left;break;case 8:e.left=r.bottom,e.top=r.left,e.right=r.top,e.bottom=r.right;break}return r.orientation>4&&(e.maxWidth=r.maxHeight,e.maxHeight=r.maxWidth,e.minWidth=r.minHeight,e.minHeight=r.minWidth,e.sourceWidth=r.sourceHeight,e.sourceHeight=r.sourceWidth),e};mt.ExifMap=function(){return this};mt.ExifMap.prototype.map={Orientation:274};mt.ExifMap.prototype.get=function(r){return this[r]||this[this.map[r]]};mt.getExifThumbnail=function(r,e,t){var i,o,n;if(!t||e+t>r.byteLength){console.log("Invalid Exif data: Invalid thumbnail data.");return}for(i=[],o=0;o<t;o+=1)n=r.getUint8(e+o),i.push((n<16?"0":"")+n.toString(16));return"data:image/jpeg,%"+i.join("%")};mt.exifTagTypes={1:{getValue:function(r,e){return r.getUint8(e)},size:1},2:{getValue:function(r,e){return String.fromCharCode(r.getUint8(e))},size:1,ascii:!0},3:{getValue:function(r,e,t){return r.getUint16(e,t)},size:2},4:{getValue:function(r,e,t){return r.getUint32(e,t)},size:4},5:{getValue:function(r,e,t){return r.getUint32(e,t)/r.getUint32(e+4,t)},size:8},9:{getValue:function(r,e,t){return r.getInt32(e,t)},size:4},10:{getValue:function(r,e,t){return r.getInt32(e,t)/r.getInt32(e+4,t)},size:8}};mt.exifTagTypes[7]=mt.exifTagTypes[1];mt.getExifValue=function(r,e,t,i,o,n){var a=mt.exifTagTypes[i],s,l,c,p,u,m;if(!a){console.log("Invalid Exif data: Invalid tag type.");return}if(s=a.size*o,l=s>4?e+r.getUint32(t+8,n):t+8,l+s>r.byteLength){console.log("Invalid Exif data: Invalid data offset.");return}if(o===1)return a.getValue(r,l,n);for(c=[],p=0;p<o;p+=1)c[p]=a.getValue(r,l+p*a.size,n);if(a.ascii){for(u="",p=0;p<c.length&&(m=c[p],m!=="\0");p+=1)u+=m;return u}return c};mt.parseExifTag=function(r,e,t,i,o){var n=r.getUint16(t,i);o.exif[n]=mt.getExifValue(r,e,t,r.getUint16(t+2,i),r.getUint32(t+4,i),i)};mt.parseExifTags=function(r,e,t,i,o){var n,a,s;if(t+6>r.byteLength){console.log("Invalid Exif data: Invalid directory offset.");return}if(n=r.getUint16(t,i),a=t+2+12*n,a+4>r.byteLength){console.log("Invalid Exif data: Invalid directory size.");return}for(s=0;s<n;s+=1)this.parseExifTag(r,e,t+2+12*s,i,o);return r.getUint32(a,i)};mt.parseExifData=function(r,e,t,i,o){if(!o.disableExif){var n=e+10,a,s,l;if(r.getUint32(e+4)===1165519206){if(n+8>r.byteLength){console.log("Invalid Exif data: Invalid segment size.");return}if(r.getUint16(e+8)!==0){console.log("Invalid Exif data: Missing byte alignment offset.");return}switch(r.getUint16(n)){case 18761:a=!0;break;case 19789:a=!1;break;default:console.log("Invalid Exif data: Invalid byte alignment marker.");return}if(r.getUint16(n+2,a)!==42){console.log("Invalid Exif data: Missing TIFF marker.");return}s=r.getUint32(n+4,a),i.exif=new mt.ExifMap,s=mt.parseExifTags(r,n,n+s,a,i),s&&!o.disableExifThumbnail&&(l={exif:{}},s=mt.parseExifTags(r,n,n+s,a,l),l.exif[513]&&(i.exif.Thumbnail=mt.getExifThumbnail(r,n+l.exif[513],l.exif[514]))),i.exif[34665]&&!o.disableExifSub&&mt.parseExifTags(r,n,n+i.exif[34665],a,i),i.exif[34853]&&!o.disableExifGps&&mt.parseExifTags(r,n,n+i.exif[34853],a,i)}}};mt.metaDataParsers.jpeg[65505].push(mt.parseExifData);mt.ExifMap.prototype.tags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"};mt.ExifMap.prototype.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"top-left",2:"top-right",3:"bottom-right",4:"bottom-left",5:"left-top",6:"right-top",7:"right-bottom",8:"left-bottom"}};mt.ExifMap.prototype.getText=function(r){var e=this.get(r);switch(r){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[r][e];case"ExifVersion":case"FlashpixVersion":return String.fromCharCode(e[0],e[1],e[2],e[3]);case"ComponentsConfiguration":return this.stringValues[r][e[0]]+this.stringValues[r][e[1]]+this.stringValues[r][e[2]]+this.stringValues[r][e[3]];case"GPSVersionID":return e[0]+"."+e[1]+"."+e[2]+"."+e[3]}return String(e)};(function(r){var e=r.tags,t=r.map,i;for(i in e)e.hasOwnProperty(i)&&(t[e[i]]=i)})(mt.ExifMap.prototype);mt.ExifMap.prototype.getAll=function(){var r={},e,t;for(e in this)this.hasOwnProperty(e)&&(t=this.tags[e],t&&(r[t]=this.getText(t)));return r};function Dz(r,e){for(var t=[.92,.86,.8,.7,.6,.5,.4,.3,.2,.1],i,o=0;o<t.length;o++)if(i=r.toDataURL("image/jpeg",t[o]),i.length<e)return i;return i}function Tte(r,e){for(var t=r.toDataURL().length,i=r.width,o=r.height,n=document.createElement("canvas"),a,s=0;s<2;s++){var l=Math.sqrt(e/t);i=Math.round(l*i),o=Math.round(l*o),n.height=o,n.width=i;var c=n.getContext("2d");if(c.drawImage(r,0,0,i,o),a=n.toDataURL(),t=a.length,t<e)return a}return a}function Ite(r){for(var e=r.getContext("2d"),t=e.getImageData(0,0,r.width,r.height).data,i=3;i<t.length;i+=4)if(t[i]!==255)return!0;return!1}function OG(r,e){var t={orientation:!0,canvas:!0,maxWidth:1600,maxHeight:1600};mt(r,function(i){if(!i.toDataURL){e(!0);return}var o=2e5,n;if(r.type==="image/jpeg")n=Dz(i,o);else if(n=i.toDataURL(),n.length>o){var a=n.length>.75*i.width*i.height,s=a&&!Ite(i);n=s?Dz(i,o):Tte(i,o)}e(null,n)},t)}var HL={keypad:!0,graphpaper:!0,expressions:!0,settingsMenu:!0,zoomButtons:!0,showResetButtonOnGraphpaper:!1,expressionsTopbar:!0,capExpressionSize:!1,pointsOfInterest:!0,trace:!0,border:!0,lockViewport:!1,expressionsCollapsed:!1,authorFeatures:!1,authorMode:!0,advancedStyling:!1,images:!0,imageUploadCallback:OG,folders:!0,notes:!0,sliders:!0,links:!0,qwertyKeyboard:!0,restrictedFunctions:!1,forceEnableGeometryFunctions:!1,pasteGraphLink:!1,pasteTableData:!0,degreeMode:!1,clearIntoDegreeMode:!1,autosize:!0,plotSingleVariableImplicitEquations:!0,plotImplicits:!0,plotInequalities:!0,colors:{RED:mk,BLUE:fk,GREEN:bk,ORANGE:xk,PURPLE:yk,BLACK:wk},invertedColors:!1,functionDefinition:!0,projectorMode:!1,decimalToFraction:!0,fontSize:16,language:"en",backgroundColor:"#fff",textColor:"#000",distributions:!0,brailleMode:"none",sixKeyInput:!1,brailleControls:!0,graphDescription:void 0,zoomFit:!0,forceLogModeRegressions:!1,actions:"auto",audio:!0,logScales:!0,translucentSurfaces:!1},Sz=Object.keys(HL),kz={product:"graphing",showHamburger:!1,disableScrollFix:!1,branding:!0,onlyTraceSelected:!1,disableMouseInteractions:!1,nativeOnscreenKeypad:!1,plaidMode:!1,wireframe:!1,pasteGraphLinkCallback:void 0,editOnWeb:!1,crossOriginSaveTest:!1,enableTabindex:!0,audioTraceReverseExpressions:!1,transparentBackground:!1,pauseWhenOffscreen:!1,hideGeoUI:!1,substitutions:!0,beta3d:!1,cacheRenderedSvgs:!1,ghostMode:!1},Vte={solutions:!0,menus:!0,singleVariableSolutions:!0,clickableObjects:!1,administerSecretFolders:!1},PG=__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},HL),kz);function Ez(r){return!!(HL.hasOwnProperty(r)||kz.hasOwnProperty(r)||Vte.hasOwnProperty(r))}function _G(r){var e=__dcg_shared_module_exports__['j'](PG);for(var t in r)e.hasOwnProperty(t)&&(e[t]=r[t]);return __dcg_shared_module_exports__['l'](e.backgroundColor)||(e.backgroundColor=PG.backgroundColor,__dcg_shared_module_exports__['rd'].warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)")),__dcg_shared_module_exports__['l'](e.textColor)||(e.textColor=PG.textColor,__dcg_shared_module_exports__['rd'].warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)")),e.actions!==!0&&e.actions!==!1&&e.actions!=="auto"&&(e.actions=PG.actions,__dcg_shared_module_exports__['rd'].warn("Invalid actions setting. Must be true, false, or 'auto'.")),r.zoomButtons===void 0&&(!e.graphpaper||e.lockViewport)&&(e.zoomButtons=!1),r.images===void 0&&(e.graphpaper||(e.images=!1)),r.hasOwnProperty("menus")&&(__dcg_shared_module_exports__['rd'].warn("As of API version 0.4, the 'menus' option is deprecated and has been split into 'settingsMenu' (boolean) and 'expressionsTopbar' (boolean)."),r.hasOwnProperty("settingsMenu")||(e.settingsMenu=!!r.menus),r.hasOwnProperty("expressionsTopbar")||(e.expressionsTopbar=!!r.menus)),r.hasOwnProperty("solutions")&&(__dcg_shared_module_exports__['rd'].warn("As of API v1.0, the 'solutions' option is deprecated and has been replaced with 'pointsOfInterest' (boolean)."),r.hasOwnProperty("pointsOfInterest")||(e.pointsOfInterest=!!r.solutions)),r.hasOwnProperty("singleVariableSolutions")&&__dcg_shared_module_exports__['rd'].warn("As of API v1.0, the 'singleVariableSolutions' has been removed. The calculator no longer displays solutions to single variable equations."),r.hasOwnProperty("clickableObjects")&&(__dcg_shared_module_exports__['rd'].warn("As of API v1.7, the 'clickableObjects' option is deprecated and has been replaced with 'actions'."),r.clickableObjects===!0&&!r.hasOwnProperty("actions")&&(e.actions=!0)),r.hasOwnProperty("administerSecretFolders")&&(__dcg_shared_module_exports__['rd'].warn("As of API v1.8, the 'administerSecretFolders' option is deprecated and has been subsumed under 'authorFeatures'."),r.administerSecretFolders===!0&&!r.hasOwnProperty("authorFeatures")&&(e.authorFeatures=!0)),e.graphpaper||(e.expressionsCollapsed&&(e.expressionsCollapsed=!1,__dcg_shared_module_exports__['rd'].warn("Desmos API initialized with bad options. graphpaper: false and expressionsCollapsed: true are incompatible. Proceeding with expressionsCollapsed: false.")),e.zoomButtons&&(e.zoomButtons=!1,__dcg_shared_module_exports__['rd'].warn("Desmos API initialized with bad options. graphpaper: false and zoomButtons: true are incompatible. Proceeding with zoomButtons: false.")),e.showResetButtonOnGraphpaper&&(e.showResetButtonOnGraphpaper=!1,__dcg_shared_module_exports__['rd'].warn("Desmos API initialized with bad options. graphpaper: false and showResetButtonOnGraphpaper: true are incompatible. Proceeding with showResetButtonOnGraphpaper: false."))),e.lockViewport&&e.zoomButtons&&(e.zoomButtons=!1,__dcg_shared_module_exports__['rd'].warn("Desmos API initialized with bad options. lockViewport: true and zoomButtons: true are incompatible. Proceeding with zoomButtons: false.")),(e.notes===!1||e.folders===!1||e.images===!1)&&e.pasteGraphLink===!0&&(e.pasteGraphLink=!1,__dcg_shared_module_exports__['rd'].warn("Desmos API initialized with bad options. pasteGraphLink: true is incompatible with disabling the creation of note, folder, or image expressions. Proceeding with pasteGraphLink: false.")),e.language&&(e.language=op(e.language)),e}function Gz(r,e){var t={},i={};for(var o in r)Ez(o)?t[o]=r[o]:Q_(o)?i[o]=r[o]:e||__dcg_shared_module_exports__['rd'].warn("Unrecognized setting: "+o+". Ignoring.");return{configOptions:t,settingsOptions:i}}function Tz(r,e){var t={};return e.hasOwnProperty("x")&&(t.x=r.mapX(e.x)),e.hasOwnProperty("y")&&(t.y=r.mapY(e.y)),t}var Vz=[],WL=!1,Iz=new Map;function Mte(r){let e=Iz.get(r);return e||(e=new r,Iz.set(r,e)),e}function Mz(r){if(!r||WL)return;let e;for(;(e=Vz.shift())&&e.api._destroyed;);if(!e)return;let t=e;WL=!0;let{options:i,mathBounds:o,state:n,callback:a}=t;var s=Mte(r);s.setState(n),s.setMathBounds(o),["majorAxisOpacity","minorAxisOpacity","axisLineOffset","axisLineWidth","labelSize","graphLineWidth","pointLineWidth"].forEach(h=>{h==="axisLineWidth"?s._calc.grapher.settings.setProperty(h,t.api._calc.grapher.settings[h]):s._calc.grapher.settings[h]=t.api._calc.grapher.settings[h]});var c=s._calc.evaluator,p=()=>{s._calc.grapher.asyncScreenshot(i,h=>{WL=!1,Mz(r),a(h)})},u=t.api._calc.controller,m=Ls(function(){u.areAnyImagesLoading()||(Os(m),c.notifyWhenSynced(p))})}var tm=class extends kr{constructor(t,i,o){super();this._destroyed=!1;this.isOffscreen=!1;var n=Gz(i||{},!0),a=_G(n.configOptions),s=n.settingsOptions;this._calc=new Uv(t,Qb,a),this.controller=this._calc.controller,this.controller.onEventsEmitted=l=>{let c=this.controller.getSelectedItem();this.setProperty("isAnyExpressionSelected",!!c),this.setProperty("selectedExpressionId",c?c.id:void 0),this.setProperty("expressionAnalysis",this.controller.getExpressionAnalysis());var p=_e.getFocusedMathquill();this.setProperty("focusedMathQuill",p?new MG(p):void 0);for(var u in l){if(!l.hasOwnProperty(u))continue;let m=l[u];m&&this.triggerEvent(u,m)}},this._calc.graphpaperBounds.observeAndSync("mathCoordinates",this._syncGraphpaperBounds.bind(this)),this._calc.graphpaperBounds.observeAndSync("pixelCoordinates",this._syncGraphpaperBounds.bind(this)),this.colors=this.controller.getColors(),this._initGraphSettings(),this.updateSettings(s),this._sharedClockBusToken=Ls(l=>this.withControllerInAPIMode(()=>{var c=this._calc.grapher.settings.config.pauseWhenOffscreen&&this.isOffscreen;this._calc.tick(l,c)})),this.domChangeDetector=new Zg(t,l=>this.withControllerInAPIMode(()=>{switch(this.isOffscreen=l.isOffscreen,l.type){case"offscreen-noop":break;case"added":this._calc.resize(l.size);break;case"removed":break;case"resized":this._calc.resize(l.size);break}})),a.autosize?this.domChangeDetector.startWatching():this.domChangeDetector.checkForChanges(),typeof o=="function"&&o(this)}destroy(){this.controller.onEventsEmitted=function(){},this._calc.destroy(),Os(this._sharedClockBusToken),this.domChangeDetector.destroy();function t(a){__dcg_shared_module_exports__['rd'].warn("You've destroyed this API instance. You can no longer call ."+a+"()")}for(var i={},o=this;o;)Object.getOwnPropertyNames(o).forEach(s=>i[s]=!0),o=Object.getPrototypeOf(o);for(var n in i)typeof this[n]=="function"?this[n]=t.bind(this,n):this.hasOwnProperty(n)&&delete this[n];this.destroy=function(){},this._destroyed=!0}withHistoryReplacement(t){try{this.controller.pushWithHistoryReplacement(),t()}finally{this.controller.popWithHistoryReplacement()}}withControllerInAPIMode(t){try{return this.controller.pushAPIMethodCall(),t()}finally{this.controller.popAPIMethodCall()}}_syncGraphpaperBounds(){return this.withControllerInAPIMode(()=>{this.controller.runAfterDispatch(()=>{this.setProperty("graphpaperBounds",{mathCoordinates:this._calc.graphpaperBounds.mathCoordinates,pixelCoordinates:this._calc.graphpaperBounds.pixelCoordinates})})})}_initGraphSettings(){return this.withControllerInAPIMode(()=>{var t=new kr;this.settings=this.graphSettings=t,X_.forEach(i=>{this._calc.grapher.settings.observeAndSync(i,()=>{this.controller.runAfterDispatch(()=>{t.setProperty(i,this._calc.grapher.settings[i])})})}),Sz.forEach(i=>{this._calc.grapher.settings.config.observeAndSync(i,()=>{this.controller.runAfterDispatch(()=>{t.setProperty(i,this._calc.grapher.settings.config[i])})})})})}updateSettings(t){return this.withControllerInAPIMode(()=>{var i=Gz(t,!1),o=i.configOptions,n=i.settingsOptions;__dcg_shared_module_exports__['Q'](o)||this._calc.setOptions(o),__dcg_shared_module_exports__['Q'](n)||this.controller.dispatch(__dcg_shared_module_exports__['a']({type:"set-graph-settings"},this.controller.getGraphSettings().validateSettings(n))),this.notifyControllerOfAPICall()})}setGraphSettings(t){return this.withControllerInAPIMode(()=>{__dcg_shared_module_exports__['rd'].warn("As of API v0.8 the 'setGraphSettings' method is deprecated and has been renamed 'updateSettings.'"),this.updateSettings(t),this.setGraphSettings=this.updateSettings,this.notifyControllerOfAPICall()})}setDefaultState(t){return this.withControllerInAPIMode(()=>{this._calc.grapher.settings.setProperty("defaultState",t),this.notifyControllerOfAPICall()})}mathToPixels(t){return this.withControllerInAPIMode(()=>{var i=__dcg_shared_module_exports__['Dc'].fromRects(this.graphpaperBounds.mathCoordinates,this.graphpaperBounds.pixelCoordinates,{xAxisScale:this._calc.grapher.settings.xAxisScale,yAxisScale:this._calc.grapher.settings.yAxisScale});return Tz(i,t)})}pixelsToMath(t){return this.withControllerInAPIMode(()=>{var i=__dcg_shared_module_exports__['Dc'].fromRects(this.graphpaperBounds.mathCoordinates,this.graphpaperBounds.pixelCoordinates,{xAxisScale:this._calc.grapher.settings.xAxisScale,yAxisScale:this._calc.grapher.settings.yAxisScale}).inverse();return Tz(i,t)})}notifyControllerOfAPICall(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"render"})})}setExpression(t){return this.withControllerInAPIMode(()=>{var i=this.controller,o=i.getItemModel(t.id),n=o&&o.type,a=VG(t,n,this.controller);if(a)if(n)this.controller.dispatch({type:"set-expression-properties-from-api",id:a.id,properties:a});else{if(a.type==="image")return;this.controller.dispatch({type:"add-item-to-end-from-api",state:a})}})}setExpressions(t){return this.withControllerInAPIMode(()=>{t.forEach(this.setExpression.bind(this))})}removeExpression(t){return this.withControllerInAPIMode(()=>{var i=t.id.toString();this.controller.dispatch({type:"remove-item-by-id",id:i})})}removeExpressions(t){return this.withControllerInAPIMode(()=>{t.forEach(this.removeExpression.bind(this))})}removeSelected(){return this.withControllerInAPIMode(()=>{var t=this.controller.getSelectedItem();if(!t)return;let{id:i}=t;return this.controller.dispatch({type:"remove-item-by-id",id:i}),i})}setMathBounds(t){return this.withControllerInAPIMode(()=>{t&&t.left<t.right&&t.bottom<t.top?(this._calc.setViewport([t.left,t.right,t.bottom,t.top]),this._calc.controller.unmarkLastChangedAxis(),this._calc.controller.markSquareAxesAfterUserEditedViewport()):__dcg_shared_module_exports__['rd'].warn("Invalid bounds argument. Expected a bounds object with bounds.bottom < bounds.top, and bounds.left < bounds.right. Got "+JSON.stringify(t)),this.notifyControllerOfAPICall()})}setViewport(t){return this.withControllerInAPIMode(()=>{t.length==4&&t[1]>t[0]&&t[3]>t[2]?(this._calc.setViewport(t),this._calc.controller.markSquareAxesAfterUserEditedViewport()):__dcg_shared_module_exports__['rd'].warn("Invalid viewport.  Expected [xmin, xmax, ymin, ymax].  Got "+t),this.notifyControllerOfAPICall()})}resize(){return this.withControllerInAPIMode(()=>{this.domChangeDetector.checkForChanges()})}getState(t){return this.withControllerInAPIMode(()=>this.controller.getState(t))}getExpressions(){return this.withControllerInAPIMode(()=>{var t=this.getState({stripDefaults:!1}).expressions.list;return t.map(IG)})}setBlank(t){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"set-blank",opts:t||{}})})}setState(t,i){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"set-state",state:t,opts:i||{}})})}undo(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"undo"})})}redo(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"redo"})})}clearHistory(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"clear-undoredo-history"})})}newRandomSeed(){return this.withControllerInAPIMode(()=>{this.updateSettings({randomSeed:Sd()})})}screenshot(t){return this.withControllerInAPIMode(()=>(t||(t={}),t=this._validateBrailleScreenshotOptions(t),this._calc.grapher.screenshot(t)))}_getMathAspectRatio(){return this.withControllerInAPIMode(()=>{var t=this.graphpaperBounds.mathCoordinates,i=this._calc.grapher.getProjection().pixelCoordinates,o=i.right-i.left,n=i.bottom-i.top,a=t.width/o,s=t.height/n;return a/s})}isProjectionUniform(){return this.withControllerInAPIMode(()=>!!this._calc.grapher.getProjection().settings.squareAxes)}_validateBrailleScreenshotOptions(t){return this.withControllerInAPIMode(()=>{t=__dcg_shared_module_exports__['j'](t);var i=t.braille;if(i){let o=i.embosserModel;if(!o)return __dcg_shared_module_exports__['rd'].warn("Screenshot braille options requires an embosser model to be specified. "),__dcg_shared_module_exports__['rd'].warn("Continuing with non-braille screenshot."),delete t.braille,t;if(o==="etc"&&(i.embosserModel="etc11"),o==="vpmax"&&(i.embosserModel="vpmax11"),i.embosserModel!=="etc8"&&i.embosserModel!=="etc11"&&i.embosserModel!=="vpmax8"&&i.embosserModel!=="vpmax11")return __dcg_shared_module_exports__['rd'].warn('Unknown screenshot braille embosser model. Valid models are "etc" and "vpmax".'),__dcg_shared_module_exports__['rd'].warn("Continuing with non-braille screenshot."),delete t.braille,t;i.brailleMode!=="nemeth"&&i.brailleMode!=="ueb"&&(__dcg_shared_module_exports__['rd'].warn("Screenshot options braille.brailleMode must be nemeth or ueb. Proceeding with nemeth."),i.brailleMode="nemeth"),t.width&&(__dcg_shared_module_exports__['rd'].warn("Screenshot width option is ignored when exporting Braille."),delete t.width),t.height&&(__dcg_shared_module_exports__['rd'].warn("Screenshot height option is ignored when exporting Braille."),delete t.height),t.targetPixelRatio&&(__dcg_shared_module_exports__['rd'].warn("Screenshot targetPixelRatio option is ignored when exporting Braille."),delete t.targetPixelRatio),t.preserveAxisNumbers&&(__dcg_shared_module_exports__['rd'].warn("Screenshot preserveAxisNumbers option is ignored when exporting Braille."),delete t.preserveAxisNumbers)}return t})}_validateAsyncScreenshotOpts(t){return this.withControllerInAPIMode(()=>{t=__dcg_shared_module_exports__['j'](t);let i=t.mode||"contain",o=t.width||t.height||this.graphpaperBounds.pixelCoordinates.width,n=t.height||t.width||this.graphpaperBounds.pixelCoordinates.height,a=t.targetPixelRatio||1;a<1&&(a=1);let s=t.preserveAxisNumbers;t.hasOwnProperty("format")||(t.svg?(t.format="svg",delete t.svg):t.format="png");let l=t.mathBounds||{},c=this._getMathAspectRatio(),p=this.graphpaperBounds.pixelCoordinates.width/this.graphpaperBounds.pixelCoordinates.height,u=fz({mode:i,width:o,height:n,currentBounds:this.graphpaperBounds.mathCoordinates,graphpaperAspectRatio:p,mathAspectRatio:c,mathBounds:l});return{opts:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{width:o,height:n,targetPixelRatio:a,preserveAxisNumbers:s}),mathBounds:u}})}asyncScreenshot(t,i){if(!arguments.length){__dcg_shared_module_exports__['rd'].warn("asyncScreenshot expects a callback");return}if(arguments.length===1)if(typeof t!="function"){__dcg_shared_module_exports__['rd'].warn("asyncScreenshot expects a callback");return}else i=t,t={};return this.withControllerInAPIMode(()=>{t||(t={}),t=this._validateBrailleScreenshotOptions(t);let{opts:o,mathBounds:n}=this._validateAsyncScreenshotOpts(t);Vz.push({api:this,options:o,mathBounds:n,state:this.getState(),callback:i}),Mz(this.constructor)})}setOptions(t){return this.withControllerInAPIMode(()=>{var i=this._calc.setOptions(t);return this.notifyControllerOfAPICall(),i})}focusFirstExpression(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"focus-first-expression"})})}openKeypad(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"keypad/set-minimized",minimized:!1})})}HelperExpression(t){return this.withControllerInAPIMode(()=>{var i=t&&t.latex||"",o=new kr;return o.latex=i,this.controller.dispatch({type:"add-helper-expression",state:{type:"helper-expression",id:this.controller.generateId(),latex:i,proxy:o}}),o})}};var Eh=class extends tm{constructor(e,t,i){super(e,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{product:"geometry-calculator"}),i),this.setState(Zm),this.clearHistory()}};xt();var hu=H(document.body).data("load-data");xt();function Az(r){let e={};return H.extend(!0,e,r),H.param(e)}var FG="";function Gh(){return FG}var Lz=[];function Oz(r){Lz.push(r)}function Ate(r){if(r.status===401)for(let e of Lz)e()}async function Lte(r){if(r&&r.routeDeprecated)throw r.js&&new Function(r.js)(),r}function Ote(){throw{status:0,responseJSON:{errors:[{message:"Connection failed. Check your internet connection?"}]}}}async function $L(r){let e=await r.catch(Ote);if(Ate(e),!e.ok){let i;try{i=await e.json()}catch(o){}throw{status:e.status,responseJSON:i}}let t=await e.json();return await Lte(t),t}async function sn(r,e){let t={method:"POST",credentials:"include",headers:{Accept:"application/json, text/javascript, */*; q=0.01"}};return e!==void 0&&(t.body=Az(e),t.headers["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8"),await $L(fetch(FG+r,t))}async function Pz(r,e){let t={method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Accept:"application/json, text/javascript, */*; q=0.01"},body:JSON.stringify(e||null)};return await $L(fetch(FG+r,t))}async function lc(r,e){e===void 0&&(e={}),e=__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},e),Ed);let t={method:"GET",credentials:"include",headers:{Accept:"application/json, text/javascript, */*; q=0.01"}},i=/\?/.test(r)?"&":"?";return await $L(fetch(`${FG}${r}${i}${new URLSearchParams(e)}`,t))}var _z=["i18nKey","title","thumbURL","stateURL","hash","parentHash","recovery","recoveryParentHash","graphData","access","created","example","draft","easterEgg","isMigratedFromLegacyGeometry","questHash"],Dn=class r extends kr{constructor(t){super();this.isMigratedFromLegacyGeometry=!1;t&&_z.forEach(i=>{t.hasOwnProperty(i)&&this.setProperty(i,t[i])}),this.access&&this.setProperty("access","all"),this.example||this.setProperty("example",!1),this.draft||this.setProperty("draft",!1),this.now=new Date}copy(){return new r(this)}getCollectionKey(){var t="";return this.example?t="example-":this.draft&&(t="draft-"),t+this.hash}displayDate(){var t=Date.now(),i=(t-this.created.getTime())/1e3,o=i/60,n=o/60,a=n/24,s=a/7,l=[__dcg_shared_module_exports__['aa']("account-shell-label-month-jan"),__dcg_shared_module_exports__['aa']("account-shell-label-month-feb"),__dcg_shared_module_exports__['aa']("account-shell-label-month-mar"),__dcg_shared_module_exports__['aa']("account-shell-label-month-apr"),__dcg_shared_module_exports__['aa']("account-shell-label-month-may"),__dcg_shared_module_exports__['aa']("account-shell-label-month-jun"),__dcg_shared_module_exports__['aa']("account-shell-label-month-jul"),__dcg_shared_module_exports__['aa']("account-shell-label-month-aug"),__dcg_shared_module_exports__['aa']("account-shell-label-month-sep"),__dcg_shared_module_exports__['aa']("account-shell-label-month-oct"),__dcg_shared_module_exports__['aa']("account-shell-label-month-nov"),__dcg_shared_module_exports__['aa']("account-shell-label-month-dec")];return s>=5?__dcg_shared_module_exports__['aa']("account-shell-label-created-on-date",{month:l[this.created.getMonth()],day:this.created.getDate(),year:this.created.getFullYear()}):s>=2?__dcg_shared_module_exports__['aa']("account-shell-label-created-weeks-ago",{number:String(Math.floor(s))}):a>=7?__dcg_shared_module_exports__['aa']("account-shell-label-created-last-week"):a>=2?__dcg_shared_module_exports__['aa']("account-shell-label-created-days-ago",{number:String(Math.floor(a))}):n>=24?__dcg_shared_module_exports__['aa']("account-shell-label-created-yesterday"):n>=2?__dcg_shared_module_exports__['aa']("account-shell-label-created-hours-ago",{number:String(Math.floor(n))}):o>=60?__dcg_shared_module_exports__['aa']("account-shell-label-created-one-hour-ago"):o>=2?__dcg_shared_module_exports__['aa']("account-shell-label-created-minutes-ago",{number:String(Math.floor(o))}):o>=1?__dcg_shared_module_exports__['aa']("account-shell-label-created-one-minute-ago"):__dcg_shared_module_exports__['aa']("account-shell-label-created-seconds-ago")}plainObject(){var t={};return _z.forEach(i=>{t[i]=this[i]}),t}getURL(){var t;if(window.location.protocol==="file:"){var i="/calculator";if(!Gh())return i;t=Gh()+i}else{var o="/"+document.location.pathname.split("/")[1];t=window.location.href.split(o)[0]+o}return t+(this.hash&&!this.recovery?"/"+this.hash:"")}static fromAjax(t){return new r({i18nKey:t.i18nKey,title:t.title,thumbURL:t.thumbUrl,stateURL:t.stateUrl,graphData:t.state,hash:t.hash,parentHash:t.parent_hash,recoveryParentHash:t.recovery_parent_hash,access:t.access,created:new Date(t.created),example:!!t.example,draft:!!t.draft,easterEgg:t.easterEgg,isMigratedFromLegacyGeometry:!!t.isMigratedFromLegacyGeometry})}static toAjax(t){return{title:t.title,thumbUrl:t.thumbURL,stateUrl:t.stateURL,state:t.graphData,hash:t.hash,parent_hash:t.parentHash,recovery_parent_hash:t.recoveryParentHash,access:t.access,created:t.created.toString(),isMigratedFromLegacyGeometry:t.isMigratedFromLegacyGeometry}}static updateFromSync(t,i){t.setProperty("title",i.title),t.setProperty("hash",i.hash),t.setProperty("parentHash",i.parent_hash),t.setProperty("recoveryParentHash",i.recovery_parent_hash),t.setProperty("graphData",t.graphData),t.setProperty("thumbURL",i.thumbUrl),t.setProperty("stateURL",i.stateUrl),t.setProperty("created",new Date(i.created)),t.setProperty("questHash",i.questHash)}};xt();function jL(){return sn("/account/logout_xhr")}function Fz(r){let e=function(){return sn("/account/login_xhr",r)};return jL().then(e,e).then(()=>rm({lang:r.lang}))}function rm(r){return lc("/account/user_info",r)}async function Rz(){let r=await lc("/account/user_info?no401");if(r.loggedIn===!1)throw r;return r}function Nz(r){return sn("/account/check_account_status",r)}function Bz(r){return sn("/account/register_xhr",r).then(()=>rm({lang:r.lang}))}function qz(r){r===void 0&&(r={});let e="?source="+(r.fromUI||"");return r.teacher&&(e+="&teacher=true"),Gh()+"/drive_api/calculator/login"+e}function Kz(r){r===void 0&&(r={});let e="?source="+(r.fromUI||"");return r.teacher&&(e+="&teacher=true"),Gh()+"/apple_api/calculator/login"+e}function zz(r){return sn("/account/change_name",r).then(()=>rm({lang:r.lang}))}function Uz(r){return sn("/account/change_name_detail",{lang:r.lang,userProvidedName:{given:r.given,family:r.family}}).then(()=>rm({lang:r.lang}))}function Hz(r){return sn("/account/recover_xhr",r)}function Wz(r){return lc("/account/initiate_delete_account",r)}function $z(r){return lc("/account/initiate_email_change",r)}function jz(r){return sn("/account/set_email",r).then(()=>rm({lang:r.lang}))}function Yz(r){return Pz("/account/update_feature_flags",r).then(()=>rm({lang:r.lang}))}function Jz(r){return sn("/account/set_privacy_consent",r).then(()=>rm({lang:r.lang}))}function Xz(r){return sn("/account/submit_art_contest_entry",r)}function Qz(){return sn("/account/check_art_contest_entry",{})}function eU(r,e){r.closed?e.askServerIfLoggedIn():setTimeout(()=>{eU(r,e)},1e3)}function Zz(r){var e=window.open(r.url,"login_window","width=650,height=530,resizable,scrollbars");e?eU(e,r.userController):alert(r.blockedMessage)}function tU(r,e){window.userController=r,r.observeEvent("googleLogin",function(t,i){Zz({url:qz(i),userController:r,blockedMessage:e("account-shell-text-login-window-blocked-google")})}),r.observeEvent("appleLogin",function(t,i){Zz({url:Kz(i),userController:r,blockedMessage:e("account-shell-text-login-window-blocked-apple")})})}var _te=50,ey=class{constructor(e,t){this.throttledFlushBatchedLogs=__dcg_shared_module_exports__['K'](async()=>{if(this.requestInFlight||this.batchedLogs.length==0)return;let e=this.batchedLogs.splice(0,_te);this.requestInFlight=!0;try{await fetch(this.apiUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({events:e})})}catch(t){}this.requestInFlight=!1,this.throttledFlushBatchedLogs()},1e3,{leading:!1});this.batchedLogs=[],this.requestInFlight=!1,this.getSessionData=t,this.apiUrl=e}log(e){this.batchedLogs.push(__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},this.getSessionData()),e)),this.throttledFlushBatchedLogs()}};var rU,Fte={page_load_id:window.pageLoadId||Ud(),source:"browser",app:"knox",user_agent:navigator.userAgent};var Rte=new ey("./data-events",()=>Fte);function Nte(r){Rte.log(__dcg_shared_module_exports__['a']({url:document.location.href},r))}function Qt(r,e){Nte({event_type:r,payload:JSON.stringify(__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},e),{userId:rU}))})}var JL;function RG(r){let e=document.location.href,t=navigator.userLanguage||navigator.language,i=document.referrer,o=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({browserLang:t,referrer:i},r),{isFirstPageLoad:JL===void 0});rU=r.userId,JL!==e&&(JL=e,Qt("page-load",o))}var Bte={event_type:"eventType",page_load_id:window.pageLoadId||Ud(),source:"browser",app:"knox",user_agent:navigator.userAgent},qte=new ey("/usage-stats",()=>Bte);function iU(r,e){qte.log({event_type:r,url:document.location.href,payload:JSON.stringify(e)})}var XL={};__dcg_shared_module_exports__['g'](XL,{isDegreeMode:()=>zte,isProjectorMode:()=>Kte});function Kte(r){return r.isProjectorMode()}function zte(r){return r.model.getDegreeMode()}var QL={};__dcg_shared_module_exports__['g'](QL,{isLoggedIn:()=>Ute});function Ute(r){return r.userController.isLoggedIn()}var ZL={};__dcg_shared_module_exports__['g'](ZL,{expressionCount:()=>Jte,expressionErrors:()=>tre,folderCount:()=>Xte,hasAction:()=>$te,hasCustomColors:()=>Yte,hasMovablePoints:()=>jte,hasRegression:()=>Wte,hasSlider:()=>Hte,imageCount:()=>Qte,tableCount:()=>Zte,textCount:()=>ere});function Hte(r){return r.getAllModelsWithSliders().length>0}function Wte(r){for(let e of r.getAllItemModels())if(e.type==="expression"&&wf(e))return!0;return!1}function $te(r){if(r.getListModel().ticker.open)return!0;for(let e of r.getAllItemModels())if(e&&"formula"in e&&e.formula){if(e.type!=="expression"&&e.type!=="image")continue;let{formula:t}=e;if(t.hasOwnProperty("action_value")||t.hasOwnProperty("click_handler"))return!0}return!1}function jte(r){return r.getAllItemModels().some(e=>e.type==="expression"&&Gi(e)!=="NONE")}function Yte(r){for(let e of r.getAllItemModels()){if(e.type!=="expression"||!In(e))continue;let i=r.getEvaluationValueForItem(e.id);if(typeof i=="string"||Array.isArray(i)&&typeof i[0]=="string")return!0}return!1}function Jte(r){return r.getAllItemModels().filter(e=>e.type==="expression").length}function Xte(r){return r.getAllItemModels().filter(e=>e.type==="folder").length}function Qte(r){return r.getAllItemModels().filter(e=>e.type==="image").length}function Zte(r){return r.getAllItemModels().filter(e=>e.type==="table").length}function ere(r){return r.getAllItemModels().filter(e=>e.type==="text").length}function tre(r){let e=[];for(let t of r.getAllItemModels())if(t.type==="expression"&&t.error){let{key:i}=t.error;i!=="shared-calculator-error-blank-expression"&&e.push(i)}return e}var rre="usage-ping",oU=60*1e3,nU=1/60,ire=60*1e3,Yv=class{constructor(e={}){this.minutesOfMathData={lastCheckedMinutesOfMath:Date.now(),lastChangeEventTime:void 0,minutesOfMath:0};this.minutesOfMathCheckInterval=ire;if(this.samplingInterval=oU,this.shouldSample=Math.random()<nU,this.lastConsideredTime=Date.now(),this.pageLoadTime=Date.now(),this.graphLoadTime=Date.now(),this.basicController=e.basicController,this.frontendController=e.frontendController,this.calcController=e.calcController,this.graphsController=e.graphsController,this.featureQueryMap={"basic-controller-feature":[],"frontend-controller-feature":[],"graph-feature":[]},this.focused=document.hasFocus(),this.focused&&(this.focusIntervalStart=Date.now()),this.totalTimeFocused=0,window.addEventListener("focus",()=>{this.focused=!0,this.focusIntervalStart=Date.now()}),window.addEventListener("blur",()=>{this.focused=!1,this.addTimeFocused(),this.focusIntervalStart=void 0}),document.visibilityState==="visible"&&(this.visibleIntervalStart=Date.now()),this.totalTimeVisible=0,document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?(this.addTimeVisible(),this.visibleIntervalStart=void 0):this.visibleIntervalStart=Date.now()}),this.graphsController&&this.graphsController.observeEvent("onLoadGraph",()=>{this.graphLoadTime=Date.now()}),this.calcController){let t=this.calcController.onEventsEmitted;this.calcController.onEventsEmitted=i=>{var o;t==null||t(i),(o=i.change)!=null&&o.isUserInitiated&&(this.minutesOfMathData.lastChangeEventTime=Date.now(),this.getTotalMinutesOfMath())}}}getUsageData(){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},this.getBasicUsageData()),this.getBasicControllerUsageData()),this.getFrontendControllerUsageData()),this.getGraphFeatureUsageData()),{version:2})}getBasicUsageData(){let e=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({timeSincePageload:this.getTimeSincePageload(),totalTimeFocused:this.getTotalTimeFocused(),totalTimeVisible:this.getTotalTimeVisible()},this.getTotalMinutesOfMath()),{samplingInterval:oU,samplingProbability:nU});return this.graphsController&&(e.timeSinceGraphLoaded=Date.now()-this.graphLoadTime),e}getDataFromController(e,t,i){let o={};for(let n of this.featureQueryMap[e]){let a=t[n];if(!a)throw new Error(`'${n}' is not a valid feature name.`);let s=a(i);(Array.isArray(s)&&s.length>0||typeof s=="boolean"&&s||typeof s=="number")&&(o[n]=s)}return o}getBasicControllerUsageData(){return this.getDataFromController("basic-controller-feature",XL,this.basicController)}getFrontendControllerUsageData(){return this.getDataFromController("frontend-controller-feature",QL,this.frontendController)}getGraphFeatureUsageData(){return this.getDataFromController("graph-feature",ZL,this.calcController)}callLogger(){if(!this.shouldSample)return;let e=Date.now();e-this.lastConsideredTime>this.samplingInterval&&(this.lastConsideredTime=e,iU(rre,this.getUsageData()))}addTimeFocused(){if(this.focusIntervalStart===void 0)return;let e=Date.now(),t=e-this.focusIntervalStart;this.totalTimeFocused+=t,this.focusIntervalStart=e}addTimeVisible(){if(this.visibleIntervalStart===void 0)return;let e=Date.now(),t=e-this.visibleIntervalStart;this.totalTimeVisible+=t,this.visibleIntervalStart=e}getTotalTimeFocused(){return this.focused?(this.addTimeFocused(),this.totalTimeFocused):this.totalTimeFocused}getTotalTimeVisible(){return document.visibilityState==="hidden"?this.totalTimeVisible:(this.addTimeVisible(),this.totalTimeVisible)}start(){this.shouldSample&&setInterval(this.callLogger.bind(this))}trackFeatureUsage(e,t){if(!this.calcController)throw new Error("Monitoring graph feature usage requires a calculator controller.");this.featureQueryMap[e].push(t)}getTimeSincePageload(){return Date.now()-this.pageLoadTime}setMinutesOfMathCheckInterval(e){this.minutesOfMathCheckInterval=e}getTotalMinutesOfMath(){var t;let e=Date.now();return(!this.minutesOfMathData.lastCheckedMinutesOfMath||e-this.minutesOfMathData.lastCheckedMinutesOfMath>=this.minutesOfMathCheckInterval)&&(((t=this.minutesOfMathData.lastChangeEventTime)!=null?t:0)>e-this.minutesOfMathCheckInterval&&(this.minutesOfMathData.minutesOfMath+=this.minutesOfMathCheckInterval*1/(60*1e3)),this.minutesOfMathData.lastCheckedMinutesOfMath=e),{minutesOfMath:this.minutesOfMathData.minutesOfMath}}};var Sy=__dcg_shared_module_exports__['h'](z());var Ma=__dcg_shared_module_exports__['h'](z());var ht=__dcg_shared_module_exports__['h'](z());var cc=__dcg_shared_module_exports__['h'](z());var NG=class extends cc.Class{template(){return cc.createElement("span",{role:cc.const("button"),tabindex:cc.const(0),"aria-label":()=>this.openGraphText(),class:cc.const("dcg-header-btn dcg-action-opendrawer dcg-tooltip"),tooltip:()=>this.openGraphText(),onTap:e=>this.props.controller().dispatch({type:"open-mygraphs",device:e.device})},cc.createElement(Me,{tooltip:()=>this.openGraphText(),disabled:()=>!this.props.tooltip(),gravity:this.const("s"),offset:()=>({top:12})},cc.createElement("i",{class:cc.const("dcg-icon-hamburger"),"aria-hidden":cc.const("true")})))}openGraphText(){let e=this.props.controller().getOpenText();return oi?this.props.controller().s("account-shell-label-open-graph-mac",{open_graph:e}):this.props.controller().s("account-shell-label-open-graph-pc",{open_graph:e})}};var br=__dcg_shared_module_exports__['h'](z()),{If:BG}=br.Components,qG=class extends br.Class{template(){let e=this.props.controller().userController;return br.createElement("span",null,br.createElement(BG,{predicate:()=>e.isLoggedIn()&&!this.props.disableAccounts()},()=>br.createElement("span",null,br.createElement(BG,{predicate:()=>e.isLoggingOut()},()=>br.createElement("span",{class:br.const("logout-progress-notice")},br.createElement("span",{class:br.const("dcg-spinner-dark")}))),br.createElement(BG,{predicate:()=>!e.isLoggingOut()&&!this.props.disableAccounts()},()=>br.createElement("span",{class:br.const("dcg-account-link"),"dcg-menu-button":br.const("account"),role:br.const("button"),tabindex:br.const(0),"aria-haspopup":br.const("true"),"aria-expanded":br.const("false"),"aria-label":br.const("Account Information"),onTap:t=>{var i;if(this.props.controller().dispatch({type:"toggle-menu",payload:"account"}),t.device=="keyboard"){let n=this.props.controller().getOpenMenu()==="account"?".dcg-action-accountsettings":".dcg-account-link";(i=document.querySelector(n))==null||i.focus()}}},br.createElement("span",{class:br.const("email")},br.createElement("div",{class:br.const("header-account-name dcg-variable-name")},()=>e.getFirstName()),br.createElement("i",{class:br.const("dcg-icon-caret-down"),"aria-hidden":br.const("true")})))))),br.createElement(BG,{predicate:()=>!e.isLoggedIn()&&!this.props.disableAccounts()},()=>br.createElement("span",{class:br.const("dcg-login")},br.createElement("a",{role:br.const("link"),tabindex:br.const(0),class:br.const("dcg-sign-in dcg-action-login dcg-btn-white-outline"),onTap:t=>{this.props.controller().dispatch({type:"show-modal",modal:"login",device:t.device})}},()=>this.props.controller().s("account-shell-button-log-in")),()=>this.props.controller().s("account-shell-text-or"),br.createElement("a",{role:br.const("link"),tabindex:br.const(0),class:br.const("dcg-create-account dcg-btn dcg-btn-primary dcg-action-createaccount"),onTap:t=>{this.props.controller().dispatch({type:"show-modal",modal:"signup",device:t.device})}},()=>this.props.controller().s("account-shell-button-sign-up")))))}};var nd=__dcg_shared_module_exports__['h'](z());var ty=class extends nd.Class{init(){this.controller=this.props.controller()}template(){return this.controller=this.props.controller(),nd.createElement(Me,{tooltip:this.props.tooltip,gravity:this.bindFn(this.getGravity),offset:()=>({top:12})},nd.createElement("span",{role:nd.const("button"),tabindex:nd.const("0"),"aria-haspopup":nd.const("true"),"aria-label":()=>this.props.label(),"aria-expanded":()=>this.isMenuOpen(),class:()=>({"dcg-header-btn":!0,[this.getBtnClass()]:!0,"dcg-tooltip":!0,"dcg-active":this.isMenuOpen()}),"dcg-menu-button":this.props.name,onTap:this.props.onTap},nd.createElement("i",{class:this.props.icon,"aria-hidden":nd.const("true")})))}getBtnClass(){switch(this.props.name()){case"help":return"dcg-action-help";case"language":return"dcg-action-language";case"share":return"dcg-action-share"}}getGravity(){return this.props.gravity?this.props.gravity():"s"}isMenuOpen(){return this.controller.getOpenMenu()===this.props.label().toLowerCase()}};var Ln=__dcg_shared_module_exports__['h'](z());var An=__dcg_shared_module_exports__['h'](z());var{SwitchUnion:ore}=An.Components,KG=class extends An.Class{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController}getSaveStatus(){return this.graphsController.isSaving()?"saving":this.graphsController.didSaveSucceed()?"save-success":"default"}getSaveMessage(){return this.graphsController.willSaveCopy()?this.controller.s("account-shell-button-save-copy"):this.controller.s("account-shell-button-save")}template(){return An.createElement("span",null,ore(()=>this.getSaveStatus(),{saving:()=>An.createElement("span",{class:An.const("dcg-if-user save-btn-container")},An.createElement("span",{class:An.const("saving-notice")},An.createElement("span",{class:An.const("dcg-spinner-dark")}))),"save-success":()=>An.createElement("span",{class:An.const("dcg-save-success")},An.createElement("i",{class:An.const("dcg-icon-check")}),()=>this.controller.s("shared-calculator-label-saved")),default:()=>An.createElement("span",{class:()=>({"dcg-if-user save-btn-container":!0})},An.createElement(Me,{tooltip:()=>this.controller.isSaveEnabled()?this.saveChangesText():this.controller.s("account-shell-label-no-unsaved-changes"),offset:()=>({top:7})},An.createElement("span",{role:An.const("button"),class:()=>({"dcg-action-save":!0,"tooltip-offset":!0,"dcg-btn-primary":this.controller.isSaveEnabled(),"dcg-disabled":!this.controller.isSaveEnabled()}),onTap:e=>{this.controller.isSaveEnabled()&&this.controller.simpleSave(e.device)}},()=>this.getSaveMessage())))}))}saveChangesText(){return oi?this.controller.s("account-shell-label-save-changes-mac"):this.controller.s("account-shell-label-save-changes-pc")}};var{If:aU}=Ln.Components,zG=class extends Ln.Class{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController}getTitle(){return this.graphsController.getCurrentGraphTitle()||this.graphsController.getUntitledString()}template(){return Ln.createElement("span",{class:Ln.const("title-div")},Ln.createElement("span",{role:Ln.const("button"),class:Ln.const("dcg-variable-title-container"),"dcg-menu-button":()=>this.shouldShowDropdown()?"graph-actions":void 0,tabindex:Ln.const(0),onTap:e=>{this.shouldShowDropdown()?this.openGraphActionsDropdown(e):this.shouldOpenSaveDialog()&&this.controller.dispatch({type:"edit-title"})},"aria-haspopup":()=>this.shouldShowDropdown(),"aria-expanded":()=>this.props.controller().getOpenMenu()=="graph-actions","aria-label":()=>this.shouldShowDropdown()?this.controller.s("account-shell-label-graph-actions"):void 0},Ln.createElement("h1",{class:()=>({"dcg-variable-title dcg-tooltip":!0,"dcg-action-savedialog":this.shouldOpenSaveDialog()})},()=>this.getTitle()),Ln.createElement(aU,{predicate:this.bindFn(this.shouldShowDropdown)},()=>Ln.createElement("span",{class:Ln.const("dcg-graph-actions-dropdown-anchor")},Ln.createElement("i",{class:Ln.const("dcg-icon-caret-down"),"aria-hidden":Ln.const("true")})))),Ln.createElement(aU,{predicate:()=>!this.controller.getPreviewParams()&&!this.controller.isInMaintenanceMode()},()=>Ln.createElement(KG,{controller:this.props.controller})))}shouldOpenSaveDialog(){return this.controller.product==="geometry"}shouldShowDropdown(){return this.controller.product!=="geometry"&&this.graphsController.wasCurrentGraphEverSaved()}openGraphActionsDropdown(e){this.props.controller().dispatch({type:"toggle-menu",payload:"graph-actions"}),e&&e.device==="keyboard"&&this.controller.getOpenMenu()!=="share"&&document.querySelectorAll(".dcg-graph-actions-container .dropdown-choice:not(.dropdown-choice-disabled)")[0].focus()}};var HG=__dcg_shared_module_exports__['h'](z());var UG=class extends HG.Class{template(){return HG.createElement("span",{onMount:this.bindFn(this.addSVGLogo)})}addSVGLogo(e){e.innerHTML=`
    <svg version="1.1" class="dcg-desmos-svg-logo" id="svg-desmos" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
    viewBox="0 0 909.3 188.4" xml:space="preserve">
    <title>${wo("frontpage-narration-shared-desmos-logo")}</title>
    <g>
      <path d="M129.6,0c-6.8,0-12.4,5.5-12.4,12.4v48c-27.7-25.4-70.6-24-96.7,3.1c-27.4,28.4-27.4,73.4,0,101.8
        c26.1,27.1,69.1,28.4,96.8,3v8.8c2,6.5,9,10.2,15.5,8.2c3.9-1.2,7-4.3,8.2-8.2V12.4C141.1,5.9,136.1,0.5,129.6,0z M103.9,148.7
        c-17.3,18.2-46.1,18.9-64.3,1.6c-0.6-0.5-1.1-1.1-1.6-1.6c-18.4-19.2-18.4-49.5,0-68.7c17.3-18.2,46.1-18.9,64.3-1.6
        c0.6,0.5,1.1,1.1,1.6,1.6C122.3,99.3,122.3,129.6,103.9,148.7z"/>
      <path d="M298.3,124c2.2-2.3,3.4-5.3,3.5-8.4c-0.1-19-7.6-37.2-20.9-50.7c-26.6-27.6-70.6-28.4-98.2-1.8c-0.6,0.6-1.2,1.2-1.8,1.8
        c-27.4,28.4-27.4,73.4,0,101.8c21.8,22.6,56.2,27.7,83.7,12.4c10-5.6,18.5-13.5,24.8-23.1c3.4-5.5,1.9-12.7-3.3-16.5
        c-5.5-3.3-12.6-1.7-16.4,3.5c-4.2,6.4-9.9,11.6-16.6,15.4c-6.8,3.8-14.4,5.8-22.2,5.8c-12.5,0-24.4-5.1-33.1-14.1
        c-6-6.3-10.3-14-12.4-22.4h104C292.7,127.6,296,126.3,298.3,124z M231.3,67.2c12.4,0.1,24.3,5.2,33,14.1
        c6.1,6.3,10.4,14.1,12.4,22.6h-90.7c2.1-8.5,6.3-16.3,12.4-22.6C207,72.4,218.8,67.3,231.3,67.2z"/>
      <path d="M763.5,63c-26.7-28.1-71.1-29.2-99.2-2.5c-0.8,0.8-1.7,1.6-2.5,2.5c-13.7,13.9-21.3,32.7-20.9,52.2
        c-0.2,19.3,7.2,37.8,20.7,51.6c27.7,28.2,73.1,28.7,101.3,0.9c0.3-0.3,0.6-0.6,0.9-0.9c13.4-13.8,20.9-32.4,20.7-51.7
        c0.2-19.4-7.3-38.2-21.1-51.9 M712.8,66.7c12.4,0,24.2,5.2,32.5,14.4c8.9,9.2,13.8,21.5,13.6,34.3c0.2,12.7-4.6,25-13.5,34.1
        c-8.5,9.2-20.5,14.2-33,13.9c-12.3,0.3-24.2-4.7-32.5-13.8c-8.8-9.1-13.6-21.4-13.3-34.1c-0.3-12.9,4.7-25.4,13.8-34.6
        c8.2-9.3,20-14.6,32.4-14.4"/>
      <path d="M623.8,92.6v81.9c0.3,6.8-4.9,12.7-11.8,13c-6.8,0.3-12.7-4.9-13-11.8V93.1c0-7.5-3-14.6-8.3-19.8
        c-4.3-4.7-10.2-7.6-16.5-8.1h-1.9c-7-0.1-13.6,2.9-18.2,8.2c-4.8,4.9-7.5,11.5-7.7,18.3v2l0,0v81.1c0,6.8-5.5,12.4-12.4,12.4
        c-6.5,0-11.9-4.9-12.4-11.4V91.5c-0.6-4.3-1.8-8.4-3.5-12.4c-1.2-2.3-2.6-4.5-4.3-6.4c-4.7-5.2-11.3-8.3-18.3-8.3
        c-7,0-13.6,3-18.1,8.3c-5.1,5.2-8,12.3-7.9,19.6V176c-0.8,6.3-6.1,11-12.4,10.9c-6.8,0-12.4-5.5-12.4-12.4V52.9
        c-0.7-6.8,4.2-12.9,11-13.6c5.9-0.6,11.4,3,13.1,8.7l2.9-1.9c7.4-3.9,15.6-6,23.9-5.9c12.3-0.1,24.1,4.3,33.3,12.4
        c1.1,0.9,2.1,2,3,3.1c0.9,0.7,1.7,1.5,2.5,2.4l2.2-2.4c0.9-1.1,1.9-2.2,3-3.1c9.2-8.1,21-12.5,33.2-12.4h4.3
        c10.8,0.8,21,5.1,29,12.4c0.9,1,2,1.9,3,2.9C618.9,65.3,624,78.7,623.8,92.6"/>
      <path d="M427.2,145.4c0.1,23.4-18.6,42.5-42,43h-50.8c-6.8,0-12.4-5.5-12.4-12.4s5.5-12.4,12.4-12.4H384c10-0.2,17.9-8.4,17.8-18.3
        c0.1-9.9-7.9-18-17.8-18.1c0,0-0.1,0-0.1,0h-24.8c-23.8-1.3-42-21.6-40.8-45.4c1.2-22,18.8-39.6,40.8-40.8h50.2
        c6.8,0,12.4,5.5,12.4,12.4s-5.5,12.4-12.4,12.4h-49.1c-10,0.8-17.5,9.6-16.7,19.7c0.7,8.9,7.8,15.9,16.7,16.7H385
        c5.9,0,11.8,1.2,17.2,3.7C417.7,112.8,427.2,128.4,427.2,145.4"/>
      <path d="M908.9,145.2c0,23.4-18.3,42.7-41.6,43.3h-50.8c-6.8,0-12.4-5.5-12.4-12.4s5.5-12.4,12.4-12.4h50.2
        c10-0.2,17.9-8.4,17.8-18.3c0.1-9.9-7.9-18-17.8-18.1c0,0-0.1,0-0.1,0h-24.8c-23.8-1.3-42-21.6-40.8-45.4
        c1.2-22,18.8-39.6,40.8-40.8h49.6c6.8,0,12.4,5.5,12.4,12.4s-5.5,12.4-12.4,12.4h-49.6c-10.1,0-18.2,8.2-18.2,18.2c0,0,0,0,0,0
        c0,9.9,8,18,17.8,18.1h24.8c5.9,0,11.8,1.3,17.2,3.7C898.9,112.8,908.9,128.2,908.9,145.2"/>
    </g>
    </svg>
    `}};var{If:im}=ht.Components,WG=class extends ht.Class{init(){this.controller=this.props.controller(),this.userController=this.controller.userController}template(){let e=this.controller.isInMaintenanceMode(),t=this.controller.getPreviewParams();return ht.createElement("div",{class:ht.const("dcg-header")},ht.createElement("div",{class:ht.const("dcg-header-desktop")},ht.createElement("div",{class:ht.const("align-left-container")},ht.createElement(NG,{controller:this.props.controller,tooltip:ht.const(!0)}),ht.createElement(zG,{controller:this.props.controller})),ht.createElement("div",{class:ht.const("align-center-container")},ht.createElement("a",{href:ht.const("/"),target:ht.const("_blank"),class:ht.const("dcg-home-link")},ht.createElement(UG,null))),ht.createElement(im,{predicate:()=>this.userController.didLogoutFail()},()=>ht.createElement("div",{class:ht.const("dcg-toast-container")},ht.createElement("div",{class:ht.const("dcg-toast")},()=>this.controller.s("account-shell-error-logging-out")))),ht.createElement("div",{class:ht.const("align-right-container")},ht.createElement(qG,{controller:this.props.controller,disableAccounts:()=>t!=null||e}),ht.createElement(im,{predicate:()=>this.controller.isArtContestEnabled()},()=>ht.createElement(Me,{tooltip:()=>wo("account-shell-label-math-art-contest"),gravity:this.const("s"),offset:()=>({top:12})},ht.createElement("span",{role:ht.const("button"),tabindex:ht.const(0),"aria-haspopup":ht.const("true"),"aria-label":()=>wo("account-shell-label-math-art-contest"),class:ht.const("dcg-header-btn dcg-action-contest dcg-tooltip"),onTap:i=>this.controller.dispatch({type:"show-modal",modal:"contest-submission",device:i.device})},ht.const("\u{1F3C6}")))),ht.createElement(ty,{controller:this.props.controller,label:()=>wo("account-shell-label-share"),tooltip:()=>this.controller.s("account-shell-label-share-graph"),icon:ht.const("dcg-icon-share"),name:()=>"share",onTap:i=>{if(this.controller.dispatch({type:"toggle-menu",payload:"share"}),i&&i.device==="keyboard"&&this.controller.getOpenMenu()!=="share")return this.focusElement(".dcg-action-share")}}),ht.createElement(ty,{controller:this.props.controller,label:()=>wo("account-shell-label-help"),tooltip:()=>this.controller.s("account-shell-label-help"),icon:ht.const("dcg-icon-question-sign"),name:ht.const("help"),onTap:i=>{if(this.controller.dispatch({type:"toggle-menu",payload:"help"}),i.device==="keyboard"){let n=this.controller.getOpenMenu()==="help"?'.dcg-feature[href="/calculator?tour=sliders"]':".dcg-action-help";return this.focusElement(n)}}}),ht.createElement(ty,{controller:this.props.controller,gravity:this.const("s"),label:()=>wo("account-shell-label-language"),tooltip:()=>this.controller.s("account-shell-label-language"),icon:ht.const("dcg-icon-world"),name:ht.const("language"),onTap:i=>{if(this.controller.dispatch({type:"toggle-menu",payload:"language"}),i.device==="keyboard"){let n=this.controller.getOpenMenu()==="language"?".dcg-language-option.dcg-selected":".dcg-action-language";return this.focusElement(n)}}}))),ht.createElement(im,{predicate:()=>t!=null||e},()=>ht.createElement("div",{class:ht.const("dcg-toast-container")},ht.createElement("span",{class:ht.const("dcg-toast dcg-maintenance-toast")},ht.createElement("span",{class:ht.const("dcg-msg")},ht.createElement(im,{predicate:()=>e},()=>ht.createElement("span",null,()=>this.controller.s("account-shell-text-maintenance-mode"))),ht.createElement(im,{predicate:()=>t!=null},()=>ht.createElement("span",null,()=>t!=null?t.message:void 0))),ht.createElement(im,{predicate:()=>e},()=>ht.createElement("a",{class:ht.const("undo"),target:ht.const("_blank"),href:ht.const("http://desmos.zendesk.com/entries/25429616-What-is-Maintenance-Mode-/")},()=>this.controller.s("account-shell-link-learn-more"))),ht.createElement(im,{predicate:()=>t!=null},()=>ht.createElement("a",{class:ht.const("undo"),target:ht.const("_blank"),href:()=>t!=null?t.url:void 0},()=>this.controller.s("account-shell-link-share-thoughts")))))))}focusElement(e){var t;(t=document.querySelector(e))==null||t.focus()}};var Th=__dcg_shared_module_exports__['h'](z());var Ps=__dcg_shared_module_exports__['h'](z());xt();var{If:nre}=Ps.Components,ps=class extends Ps.Class{init(){this.controller=this.props.controller()}getTypeClass(){switch(this.props.type()){case"account":return"dcg-account-container";case"graph-actions":return"dcg-graph-actions-container";case"help":return"dcg-help-container";case"language":return"dcg-language-container";case"share":return"dcg-share-container"}}getProductClass(){switch(this.props.controller().getProduct()){case"geometry":return"dcg-product-geometry";case"geometry-calculator":return"dcg-product-geometry-calculator";case"graphing":return"dcg-product-graphing";case"graphing-3d":return"dcg-product-graphing-3d"}}template(){return Ps.createElement("div",{class:()=>({"dcg-popover":!0,"dcg-bottom":!0,"dcg-constrained-height-popover":!0,[this.getTypeClass()]:!0,[this.getProductClass()]:!0}),style:()=>this.props.left?{display:"block",left:this.props.left(),right:"auto"}:{display:"block"},role:Ps.const("region")},Ps.createElement("div",{class:Ps.const("dcg-popover-interior")},Ps.createElement(nre,{predicate:()=>!!(typeof this.props.title=="function"&&this.props.title())},()=>Ps.createElement("h2",{class:Ps.const("dcg-unstyled-heading dcg-popover-title")},()=>this.props.title())),this.children),Ps.createElement("div",{class:Ps.const("dcg-arrow"),style:()=>this.props.arrowLeft?{left:this.props.arrowLeft(),right:"auto"}:{}}))}didMount(){let e=this.props.type();this.guid=`menu-${e}`,H(document.body).on(`dcg-tapstart.${this.guid}`,t=>{let i=t.target,o=!!i.closest(".dcg-popover"),n=!!i.closest(`[dcg-menu-button=${e}]`);!o&&!n&&this.controller.dispatch({type:"toggle-menu",payload:"none"})})}didUnmount(){H(document.body).off(`dcg-tapstart.${this.guid}`)}};var On=__dcg_shared_module_exports__['h'](z());var{For:are,If:sre}=On.Components,$G=class extends On.Class{init(){this.i18n=this.props.i18n()}template(){return On.createElement("div",{class:()=>({"dcg-language-picker":!0,"dcg-two-columns":this.getLanguages().length>7})},On.createElement("div",{class:On.const("dcg-language-header"),role:On.const("heading"),"aria-level":On.const("2")},()=>this.i18n.s("shared-title-language-menu")),On.createElement(are,{each:()=>this.getLanguages()},On.createElement("ul",{class:On.const("dcg-unstyled-list dcg-languages-list"),role:On.const("menu")},e=>On.createElement("li",{class:()=>({"dcg-listitem":!0,"dcg-language-option":!0,"dcg-selected":this.isLanguageSelected(e)}),lang:this.const(this.getLangCode(e)),role:On.const("menuitem"),tabindex:On.const("0"),"aria-current":()=>this.isLanguageSelected(e),onTap:()=>this.updateLang(e)},()=>this.i18n.raw(this.getLanguageDisplayName(e))))),On.createElement(sre,{predicate:()=>this.shouldShowFooterLink()},()=>On.createElement("a",{class:On.const("dcg-language-footer-link dcg-blue-link"),href:()=>this.getFooterLinkURL()},()=>this.getFooterLinkText())))}shouldShowFooterLink(){return!!(this.props.footerLink&&this.props.footerLink())}getFooterLinkURL(){let e=this.props.footerLink&&this.props.footerLink();if(e)return e.url}getFooterLinkText(){let e=this.props.footerLink&&this.props.footerLink();return e?e.text:this.i18n.raw("")}getCurrentLang(){return this.props.currentLang()}getLanguages(){return Object.keys(this.props.getAllLangs())}getLanguageDisplayName(e){return this.props.getAllLangs()[e].display_name}updateLang(e){let t=this.props.getAllLangs()[e].code;return this.props.onLangChosen(t)}getLangCode(e){return this.props.getAllLangs()[e].code}isLanguageSelected(e){return this.getLangCode(e)===this.getCurrentLang()}};var lre=Z_(),jG=class extends Th.Class{init(){this.controller=this.props.controller(),this.languageController=this.controller.languageController}template(){return Th.createElement(ps,{type:()=>"language",label:()=>this.controller.s("account-shell-narration-language-menu"),controller:this.props.controller},Th.createElement("div",{class:Th.const("dcg-popover-content")},Th.createElement($G,{getAllLangs:()=>lre,currentLang:()=>this.languageController.getLanguage(),onLangChosen:e=>{this.languageController.fetchAndSetLanguage(e),this.controller.dispatch({type:"toggle-menu",payload:"none"})},i18n:this.props.controller})))}};var pc=__dcg_shared_module_exports__['h'](z());var Wa=__dcg_shared_module_exports__['h'](z());var{For:cre,If:dre}=Wa.Components,eO=class extends Wa.Class{init(){this.controller=this.props.controller(),this.tourController=this.controller.tourController}getBaseUrl(){switch(this.controller.getProduct()){case"graphing-3d":return"3d";case"geometry-calculator":return"geometry";default:return"calculator"}}template(){return Wa.createElement("a",{class:Wa.const("dcg-feature"),href:()=>`/${this.getBaseUrl()}?tour=${this.props.name()}`,target:Wa.const("_blank"),ignoreRealClick:()=>!this.tourController.shouldPopupTour(this.props.name()),onTap:e=>{if(!this.tourController.shouldPopupTour(this.props.name()))return e.originalEvent.preventDefault(),this.controller.dispatch({type:"toggle-menu",payload:"none"}),this.tourController.startTour(this.props.name())}},Wa.createElement("span",{class:()=>({"dcg-thumb":!0,[this.getTourClassName()]:!0})}),()=>this.controller.s(this.props.titleKey()))}getTourClassName(){switch(this.props.name()){case"regressions":return"dcg-regressions-thumb";case"restrictions":return"dcg-restrictions-thumb";case"sliders":return"dcg-sliders-thumb";case"tables":return"dcg-tables-thumb";default:return"dcg-unknown-thumb"}}},YG=class extends Wa.Class{init(){this.controller=this.props.controller()}template(){return Wa.createElement(cre,{each:()=>Object.keys(this.props.tours())},Wa.createElement("div",{class:Wa.const("dcg-popover-content dcg-tours-content"),role:Wa.const("region"),"aria-label":()=>this.controller.s("account-shell-heading-tours")},e=>Wa.createElement(dre,{predicate:()=>!this.props.tours()[e].hideInHelp},()=>Wa.createElement(eO,{name:()=>e,titleKey:()=>this.props.tours()[e]?this.props.tours()[e].titleKey:"",controller:this.props.controller}))))}};var ei=__dcg_shared_module_exports__['h'](z());var dc=class extends ei.Class{template(){return ei.createElement("a",{href:()=>this.props.href(),target:ei.const("_blank"),class:ei.const("dcg-resource-link")},ei.createElement("i",{class:()=>this.props.icon(),"aria-hidden":ei.const("true")}),ei.createElement("span",null,()=>this.props.title(),ei.const(" ")))}},JG=class extends ei.Class{init(){this.controller=this.props.controller()}template(){return ei.createElement("div",{class:ei.const("dcg-popover-content dcg-resources-content"),role:ei.const("region"),"aria-label":()=>this.controller.s("account-shell-heading-resources")},ei.createElement(dc,{href:ei.const("https://help.desmos.com/hc/en-us/articles/4406040715149-Getting-Started-Desmos-Graphing-Calculator"),icon:ei.const("dcg-icon-rocket"),title:()=>this.controller.s("account-shell-link-getting-started")}),ei.createElement(dc,{href:ei.const("https://www.youtube.com/playlist?list=PLfM6zMGnbgOGLZc-_Yj3QVK3Vz_L4Cw59"),icon:ei.const("dcg-icon-film"),title:()=>this.controller.s("account-shell-link-video-tutorials")}),ei.createElement(dc,{href:()=>{let e=this.controller.languageController.getLanguage();return fl[e]?fl[e].userGuideURL:fl.en.userGuideURL},icon:ei.const("dcg-icon-book"),title:()=>this.controller.s("account-shell-link-user-guide")}),ei.createElement(dc,{href:ei.const("https://help.desmos.com/"),icon:ei.const("dcg-icon-comments"),title:()=>this.controller.s("account-shell-link-help-center")}),ei.createElement("div",{class:ei.const("dcg-resource-link dcg-action-show-hotkeys"),role:ei.const("link"),tabindex:ei.const(0),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"hotkeys",device:e.device})},ei.createElement("i",{class:ei.const("dcg-icon-keyboard"),"aria-hidden":ei.const("true")}),ei.createElement("span",null,()=>this.controller.s("account-shell-link-keyboard-shortcuts"))))}};var yi=__dcg_shared_module_exports__['h'](z());function XG(r,e){if(!e.hasOwnProperty("myGraphs"))throw new Error("Argument Error: saveGraph options must specify myGraphs");if(!e.hasOwnProperty("isUpdate"))throw new Error("Argument Error: saveGraph options must specify isUpdate");let t={parent_hash:r.parentHash,recovery_parent_hash:r.recoveryParentHash,thumb_data:r.thumbURL,graph_hash:r.hash,my_graphs:e.myGraphs,is_update:e.isUpdate,recovery:e.recovery,title:r.title||void 0,calc_state:r.graphData,lang:e.lang,product:e.product};return sn("/api/v1/calculator/save",t).then(i=>(Dn.updateFromSync(r,i),r))}function sU(r){return sn("/api/v1/calculator/email_feedback",r)}function tO(r){return lc("/api/v1/calculator/my_graphs",r)}function lU(r){return lc("/api/v1/calculator/recovery_graphs",r)}function cU(r){return sn("/api/v1/calculator/my_graphs/remove",r)}function dU(){return sn("/api/v1/calculator/recovery_graphs/clear")}var It=__dcg_shared_module_exports__['h'](z());xt();function rO(r){var t;let e=(t=r==null?void 0:r.responseJSON)==null?void 0:t.errors;return Array.isArray(e)?e:[{message:"Unexpected server error. Try again, or e-mail calculator@desmos.com."}]}function QG(r){return rO(r).map(e=>e.message)}var{If:Jv,For:pre,Input:ure,Textarea:hre}=It.Components,ZG=class extends It.Class{init(){this.controller=this.props.controller(),this.userController=this.controller.userController,this.formErrors=[],this.feedbackInProgress=!1,this.feedbackFromName=this.userController.getEmail(),this.didSendFeedbackEmail=!1}template(){return It.createElement("div",{class:It.const("dcg-suggestions")},It.createElement("div",{class:It.const("template-errors")},It.createElement(Jv,{predicate:()=>!!this.formErrors.length},()=>It.createElement(pre,{each:()=>this.formErrors},It.createElement("span",null,e=>It.createElement("div",{class:It.const("errors")},It.createElement("span",null,()=>e)))))),It.createElement("form",{didMount:this.bindFn(this.didMountContactForm),class:It.const("dcg-action-submit"),id:It.const("support-contact-us-form")},It.createElement("div",{class:It.const("dcg-feedback-message-label")},()=>this.controller.s("account-shell-label-feedback-message")),It.createElement(hre,{placeholder:()=>this.controller.s("account-shell-label-feedback-placeholder"),didMount:this.bindFn(this.didMountTextArea),disabled:()=>!this.shouldAllowSubmission(),class:It.const("dcg-shared-input-blue-outline"),name:It.const("message"),value:()=>this.controller.getFeedbackMessage(),onInput:e=>{if(this.controller.setFeedbackMessage(e),!this.unmounted)return this.update()}}),It.createElement("div",{class:It.const("dcg-suggestions-expansion")},It.createElement("div",{class:It.const("dcg-feedback-email-label")},()=>this.controller.s("account-shell-label-feedback-email")),It.createElement(ure,{name:It.const("anonymous-email"),class:It.const("dcg-anonymous-email dcg-shared-input-blue-outline"),placeholder:()=>this.controller.s("account-shell-label-email-placeholder"),disabled:()=>!this.shouldAllowSubmission(),type:It.const("email"),value:()=>this.feedbackFromName,onInput:e=>{if(this.feedbackFromName=e,!this.unmounted)return this.update()}}),It.createElement("div",{class:It.const("dcg-feedback-action-container")},It.createElement(Jv,{predicate:()=>this.feedbackInProgress},()=>It.createElement("div",{class:It.const("dcg-template-processing")},It.createElement("span",{class:It.const("dcg-spinner")}),()=>this.controller.s("account-shell-label-feedback-sending"))),It.createElement(Jv,{predicate:()=>this.didSendFeedbackEmail},()=>It.createElement("div",{class:It.const("dcg-template-sent")},It.createElement("i",{class:It.const("dcg-icon-check"),"aria-hidden":It.const("true")}),()=>this.controller.s("account-shell-text-feedback-sent"))),It.createElement(Jv,{predicate:this.bindFn(this.shouldAllowSubmission)},()=>It.createElement("span",{class:It.const("dcg-feedback-btns")},It.createElement(Jv,{predicate:()=>this.controller.product!=="geometry-calculator"},()=>It.createElement("button",{class:It.const("dcg-unstyled-button dcg-action-closesuggestion"),onTap:this.bindFn(this.onCancel)},()=>this.controller.s("account-shell-button-cancel"))),It.createElement("button",{class:()=>({"dcg-btn-blue":!0,"dcg-disabled":this.submitDisabled()}),name:It.const("submit"),type:It.const("submit")},()=>this.controller.s("account-shell-button-contact-us"))))))))}submitDisabled(){let e=document.querySelector('textarea[name="message"]');return!e||e.value.trim().length===0}didMountContactForm(e){return H(e).on("submit",t=>(t.preventDefault(),this.submitForm()))}didMountTextArea(e){this.unmounted||e.focus()}didUnmount(){this.unmounted=!0}shouldAllowSubmission(){return!this.feedbackInProgress&&!this.didSendFeedbackEmail}onCancel(){this.controller.setFeedbackMessage(""),this.controller.dispatch({type:"show-contact-form",showForm:!1})}async submitForm(){if(this.submitDisabled())return;this.didSendFeedbackEmail=!1,this.feedbackInProgress=!0,this.formErrors=[];let e=document.querySelector('textarea[name="message"]').value.trim(),t=this.controller.product;if(t!=="graphing"&&t!=="graphing-3d"&&t!=="geometry-calculator")throw new Error(`Unexpected product: ${t}`);let i=document.querySelector('input[name="anonymous-email"]'),o={message:e,state:JSON.stringify(this.controller.api.getState()),userAgent:navigator.userAgent,"anonymous-email":i?i.value:"",product:t,lang:this.controller.getLanguage()};this.unmounted||this.update();try{await sU(o),this.didSendFeedbackEmail=!0,this.controller.setFeedbackMessage(""),this.feedbackFromName=this.userController.getEmail(),setTimeout(()=>{this.didSendFeedbackEmail=!1,this.unmounted||this.update()},2e3)}catch(n){this.formErrors=QG(n).map(a=>this.controller.raw(a))}finally{this.feedbackInProgress=!1,this.unmounted||this.update()}}};var{IfElse:uU,If:hU}=yi.Components,Ih=class extends yi.Class{handleClick(){this.props.controller().dispatch({type:"show-contact-form",showForm:!0})}template(){return yi.createElement("div",{class:yi.const("dcg-popover-content dcg-hide-on-mobile"),"aria-label":()=>this.props.controller().s("account-shell-label-feedback")},yi.createElement(hU,{predicate:()=>this.props.controller().product==="geometry-calculator"},()=>yi.createElement("div",{class:yi.const("dcg-contact-warning")},yi.createElement(si,{i18n:this.props.controller,key:this.const("account-shell-text-geometry-beta-notice")},yi.const("Thank you for visiting our new Geometry Tool! Please share any bugs, questions, or suggestions with us below.")))),yi.createElement(hU,{predicate:()=>this.props.controller().product==="graphing-3d"},()=>yi.createElement("div",{class:yi.const("dcg-contact-warning")},yi.createElement(si,{i18n:this.props.controller,key:this.const("account-shell-text-3d-beta-notice")},yi.const("Thank you for visiting our Beta 3D Calculator! Please share any bugs, questions, or suggestions with us below.")))),uU(()=>this.props.controller().requestedContactForm(),{true:()=>yi.createElement("div",{class:yi.const("dcg-resources-content dcg-feedback-content")},yi.createElement(ZG,{controller:this.props.controller})),false:()=>yi.createElement("div",{class:yi.const("dcg-contact-us")},yi.createElement("button",{class:yi.const("dcg-unstyled-button dcg-contact-link"),"aria-expanded":yi.const("false"),"aria-controls":yi.const("support-contact-us-form"),onTap:this.bindFn(this.handleClick)},yi.createElement("i",{class:yi.const("dcg-icon-mail"),"aria-hidden":yi.const("true")}),uU(()=>this.props.controller().product==="graphing-3d",{true:()=>yi.createElement("span",null,()=>this.props.controller().s("account-shell-link-send-feedback")),false:()=>yi.createElement("span",null,()=>this.props.controller().s("account-shell-link-email-support"))})))}))}};function eT(r,e){return __dcg_shared_module_exports__['_a'](1/__dcg_shared_module_exports__['pd'](__dcg_shared_module_exports__['od'](r)),0,e)}function gre(r,e,t,i,o,n){return eT([[r,e,1],[t,i,1],[o,n,1]])}function mre(r,e,t,i,o,n,a,s){return eT([[r*r+e*e,r,e,1],[t*t+i*i,t,i,1],[o*o+n*n,o,n,1],[a*a+s*s,a,s,1]])}function fre(r,e,t,i,o,n,a,s,l,c,p,u){return eT([[r*r,e*e,2*r*e,r,e,1],[t*t,i*i,2*t*i,t,i,1],[o*o,n*n,2*o*n,o,n,1],[a*a,s*s,2*a*s,a,s,1],[l*l,c*c,2*l*c,l,c,1],[p*p,u*u,2*p*u,p,u,1]])}function bre(r,e,t,i,o,n,a,s,l,c){return{a:__dcg_shared_module_exports__['nd'].det([[e*e,2*r*e,r,e,1],[i*i,2*t*i,t,i,1],[n*n,2*o*n,o,n,1],[s*s,2*a*s,a,s,1],[c*c,2*l*c,l,c,1]]),b:__dcg_shared_module_exports__['nd'].det([[r*r,e*e,r,e,1],[t*t,i*i,t,i,1],[o*o,n*n,o,n,1],[a*a,s*s,a,s,1],[l*l,c*c,l,c,1]]),c:-__dcg_shared_module_exports__['nd'].det([[r*r,2*r*e,r,e,1],[t*t,2*t*i,t,i,1],[o*o,2*o*n,o,n,1],[a*a,2*a*s,a,s,1],[l*l,2*l*c,l,c,1]])}}function yre(r,e,t,i,o,n,a,s,l,c,p,u){if(gre(r,e,o,n,p,u))return"line";if(mre(r,e,t,i,l,c,p,u))return"circle";if(!fre(r,e,t,i,o,n,a,s,l,c,p,u))return"none";var m=bre(r,e,t,i,o,n,a,s,l,c);return eT([[m.a,m.b],[m.b,m.c]],20)?"parabola":m.b*m.b>m.a*m.c?"hyperbola":"ellipse"}function gU(r){let e,t;if(r.length===1&&r[0].length===4)return"line";for(let i of r){let o=i.length;if(o<12)return"unknown";if(t=yre(i[0],i[1],i[2*Math.floor(1*o/12)],i[2*Math.floor(1*o/12)+1],i[2*Math.floor(2*o/12)],i[2*Math.floor(2*o/12)+1],i[2*Math.floor(3*o/12)],i[2*Math.floor(3*o/12)+1],i[2*Math.floor(4*o/12)],i[2*Math.floor(4*o/12)+1],i[o-2],i[o-1]),t==="none"||e&&t!==e)return"none";e=t}return e}function tT(r){return aa(r)&&r.type==="expression"}function ry(r,e){return aa(r)&&r.type==="expression"?!0:r.type==="expression"&&Us(r)}function mU(r){return gU(r)}function Xv(r,e){return r.type==="expression"}function fU(r,e){return r.type==="expression"&&zu(r)}function iO(r,e){return r.type==="expression"&&!!r.error&&!Us(r)}function oO(r){return function(e,t){return e.type==="expression"&&e.formula&&e.formula.variables&&e.formula.variables.length>=r}}function wre(r){if(r.type!=="expression"||!r.formula||!r.formula.constant_value)return!1;let e=r.formula.constant_value;return typeof e=="number"&&isFinite(e)}function nO(r,e){return!!e&&mU(e.branches[0].segments)==="line"&&!wre(r)}function aO(r,e){return nO(r,e)&&lO(r,e)}function sO(r,e){return Xv(r,e)&&!aO(r,e)}function Qv(r,e){return!!e&&e.branches&&e.branches.some(function(t){return mU(t.segments)==="parabola"})}function lO(r,e){return!r||r.type!=="expression"||!r.latex?!1:!!r.latex.match(/\\left\\{(.+)\\right\\}/)}function bU(r,e){return!r||r.type!=="expression"||!r.latex?!1:!!r.latex.match(/\\left\\{x(.+)\\right\\}/)}function yU(r,e){return!r||r.type!=="expression"||!r.latex?!1:!!r.latex.match(/\\left\\{y(.+)\\right\\}/)}function xU(r,e){if(!Qv(r,e)||!e)return!1;let t=e.branches[0].compiled.fn;return t(0)!==0||t(1)!==1}function wU(r,e){return r.type==="expression"&&r.formula.assignment==="y"}function Zv(r){return(e,t)=>e.type==="expression"&&Xm(e.latex,r).length>0}var kBe=Zv("x");function ad(r,e){return r.type==="expression"&&!!r.sliderExists&&!zu(r)}function vU(r,e){return r.type==="expression"&&!!r.sliderExists&&r.slider.isPlaying}function eC(r,e){return r.type==="expression"&&!!r.sliderExists&&!zu(r)&&ws(r)!==1}function rT(r,e){return r.type==="table"}function iy(r,e){return r.type==="expression"&&!!r.formula&&!!r.formula.regression}function om(r,e){if(r.type!=="table")return!1;for(let t=1;t<r.columnModels.length;t++)if(r.columnModels[t].discrete)return!0;return!1}var Zi=__dcg_shared_module_exports__['h'](z());var{IfDefined:Cre,For:Dre,Switch:Sre}=Zi.Components;function dO(r,e){if(!r||!e||r.innerHTML!==e.innerHTML)return!1;let t=Array.isArray(r.content);return t!==Array.isArray(e.content)||t&&__dcg_shared_module_exports__['G'](r.content,e.content).length>0?!1:!(!t&&r.content!==e.content)}var cO=class extends Zi.Class{setInnerHtml(){var t;let e=this.props.innerHTML();if(e){let i=document.getElementById("dcg-trip-content--inner");i&&(i.innerHTML=e),(t=this.findRootNode())==null||t.querySelectorAll(".dcg-trip-math:not(.dcg-mq-math-mode)").forEach(o=>{Zl.StaticMath(o)})}}didMount(){this.setInnerHtml()}didUpdate(){this.setInnerHtml()}template(){return Zi.createElement("div",{id:Zi.const("dcg-trip-content--inner")})}},oy=class extends Zi.Class{init(){this.controller=this.props.controller()}getTargetElement(){var t;let e=this.props.target();if("element"in e)return e.element!==null&&e.element?e.element:void 0;if("selector"in e){let i=(t=this.controller.getRootElt())==null?void 0:t.querySelector(e.selector);return i!==null&&i?i:void 0}else return}getTargetPosition(){let e=this.props.target(),t=this.getTargetElement(),i="getCanvasPos"in e&&e.getCanvasPos();if(t){let o=ao(t);return t.closest("#graph-container")&&(o.top-=ao(this.controller.getRootElt()).top),{top:o.top,left:o.left,width:t.clientWidth,height:t.clientHeight}}else return i?(i.top-=ao(this.controller.getRootElt()).top,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},i),{width:0,height:0})):this.cachedTargetPos}getFallbackPosition(){var i;let e=(i=this.controller.getRootElt())==null?void 0:i.querySelector(".dcg-exppanel-outer");if(!e)return;let t=ao(e);return e.closest("#graph-container")&&(t.top-=ao(this.controller.getRootElt()).top),{top:t.top,left:t.left,width:e.clientWidth,height:e.clientHeight}}withinTolerance(e,t){return Math.abs(e.height-t.height)<=30&&Math.abs(e.width-t.width)<=30&&Math.abs(e.top-t.top)<=30&&Math.abs(e.left-t.left)<=30}updatePosition(){var m,h,x;if(this.isSameStep()&&((m=this.props.target())==null?void 0:m.updatePosition)==="never")return;let e=this.findRootNode(),t=this.getTargetPosition();if(!e||!this.props.position||!t||!("getCanvasPos"in this.props.target())&&t.width===0&&t.height===0||this.isSameStep()&&((h=this.props.target())==null?void 0:h.updatePosition)!=="always"&&this.cachedTargetPos&&this.withinTolerance(t,this.cachedTargetPos))return;let i=e.offsetWidth||0,o=e.offsetHeight||0,n=10,a=10,s=window.innerWidth||0,l=0,c=t.left+(t.width-i)/2,p=t.top-n-o;switch(this.props.position()){case"e":c=t.left+t.width+a,p=t.top-(o-t.height)/2;break;case"s":c=t.left+(t.width-i)/2,p=t.top+t.height+n,c+i>s-1&&(l=s-1-c-i),c<1&&(l=1-c);break;case"n":c=t.left+(t.width-i)/2,p=t.top-t.height-n-o,c+i>s-1&&(l=s-1-c-i),c<1&&(l=1-c);break;case"w":c=t.left-(a+i),p=t.top-(o-t.height)/2;break}oa(e,{left:`${c}px`,top:`${p}px`});let u=e.querySelector(".dcg-trip-interior");u&&(u.style.transform="translate("+l+"px, 0)"),this.cachedBlock={target:this.props.target(),innerHTML:this.props.innerHTML(),header:this.props.header(),content:this.props.content()},this.cachedRootEltTop=(x=ao(this.controller.getRootElt()))==null?void 0:x.top,this.cachedTargetPos=t}onMount(){this.clockBusId=Ls(()=>this.updatePosition()),this.updatePosition()}willUnmount(){this.clockBusId&&Os(this.clockBusId)}didUpdate(){this.updatePosition()}getClasses(){var e,t;return{"dcg-tour-step":!0,[`dcg-tour-step-${this.props.position()}`]:!0,"dcg-tour-step--update-always":((t=(e=this.props).target)==null?void 0:t.call(e).updatePosition)==="always"}}getContent(){let e=this.props.content();return Array.isArray(e)?e:e?[e]:[]}isSameStep(){var i,o;let e=this.props.target(),t=(i=this.cachedBlock)==null?void 0:i.target;return!t||!e||((o=ao(this.controller.getRootElt()))==null?void 0:o.top)!==this.cachedRootEltTop||"selector"in e&&"selector"in t&&(t==null?void 0:t.selector)!==e.selector||"element"in e&&"element"in t&&(t==null?void 0:t.element)!==e.element||"selector"in e&&"element"in t||"element"in e&&"selector"in t?!1:dO(this.cachedBlock,{target:e,innerHTML:this.props.innerHTML(),header:this.props.header(),content:this.props.content()})}template(){return Zi.createElement("div",{class:()=>this.getClasses()},Zi.createElement("div",{class:Zi.const("dcg-trip-interior")},Zi.createElement("a",{class:Zi.const("dcg-trip-close"),onTap:()=>this.props.tourController().stopTour("exit"),"aria-label":()=>this.controller.s("graphing-tours-label-close-tour")},Zi.const("\xD7")),Zi.createElement("div",{class:Zi.const("dcg-trip-content"),"aria-live":Zi.const("polite")},Cre(()=>this.props.header(),e=>Zi.createElement("h2",null,e)),Zi.createElement(Dre,{each:this.bindFn(this.getContent)},Zi.createElement("div",null,e=>Zi.createElement("div",{class:Zi.const("dcg-trip-content-sentence")},()=>e))),Zi.createElement(Sre,{key:()=>this.props.innerHTML()},e=>e?Zi.createElement(cO,{innerHTML:()=>e}):Zi.createElement("div",null)))),Zi.createElement("div",{class:Zi.const("dcg-trip-arrow")}))}};var nm=__dcg_shared_module_exports__['h'](z());var{IfDefined:kre}=nm.Components,Ere=5e3,Gre=500,tC=class{constructor(e){this.controller=e}getState(){return this.controller.getState()}expressionCount(){return this.controller.getItemCount()}getExpSketch(e){return this.getExpSketchById(e.id)}getExpSketchById(e){var t;if(e)return(t=this.controller.getGrapher())==null?void 0:t.graphSketches[e]}getAvailableExp(e){let t=this.getMatchingExpNode(ry,e);return t||document.querySelector(".dcg-new-math-div")}getExpressionNodeById(e){if(e)return this.controller.getItemNodeById(e)}getModelById(e){if(e)return this.controller.getItemModel(e)}expMatches(e,t){return e?typeof t=="function"?this.safeCall(t,e,this.getExpSketch(e)):t.every(i=>this.safeCall(i,e,this.getExpSketch(e))):!1}safeCall(e,t,i){return"is3d"in e&&e.is3d?i instanceof _E?e.call(null,t,i):e.call(null,t,void 0):i instanceof db?e.call(null,t,i):e.call(null,t,void 0)}getMatchingExpIds(e,t=[]){return this.controller.getAllItemModels().filter(i=>t.indexOf(i.id)===-1&&Dk(i)!=="none"&&this.expMatches(i,e)).map(i=>i.id)}getMatchingExpId(e,t=[]){let i=this.getMatchingExpIds(e,t);if(i.length===0)return;let o=this.controller.getSelectedItem();return o&&i.indexOf(o.id)>=0?o.id:i[0]}hasMatchingExpression(e,t=[]){return this.getMatchingExpIds(e,t).length>0}getMatchingExpNode(e,t){let i=this.getMatchingExpId(e,t);return this.getExpressionNodeById(i)}getMatchingExpModel(e,t){let i=this.getMatchingExpId(e,t);return i?this.getModelById(i):void 0}getMatchingExpModels(e,t){return this.getMatchingExpIds(e,t).map(o=>this.getModelById(o)).filter(o=>o&&o.type==="expression")}getUniqueSliceValues(e){let t=e==="x"?0:e==="y"?1:2,i=this.getMatchingExpIds([]),o=[];for(let n of i){let a=this.getExpSketchById(n);a==null||a.branches.forEach(s=>{if(s.graphMode!==100&&s.graphMode!==128)return;let l=s.points[t];o.indexOf(l)===-1&&s.points.every((c,p)=>p%3!==t||Math.abs(c-l)<=1e-4||isNaN(c))&&o.push(l)})}return o}},rC=class extends nm.Class{constructor(){super(...arguments),this.expressionCount=()=>this.validator.expressionCount(),this.getAvailableExp=e=>this.validator.getAvailableExp(e),this.getExpressionNodeById=e=>this.validator.getExpressionNodeById(e),this.getModelById=e=>this.validator.getModelById(e),this.expMatches=(e,t)=>this.validator.expMatches(e,t),this.getMatchingExpIds=(e,t)=>this.validator.getMatchingExpIds(e,t),this.getMatchingExpId=(e,t)=>this.validator.getMatchingExpId(e,t),this.hasMatchingExpression=(e,t)=>this.validator.hasMatchingExpression(e,t),this.getMatchingExpNode=(e,t)=>this.validator.getMatchingExpNode(e,t),this.getMatchingExpModel=(e,t)=>this.validator.getMatchingExpModel(e,t)}init(){this.controller=this.props.controller(),this.tourController=this.props.tourController(),this.s=this.controller.s,this.raw=this.controller.raw,this.validator=new tC(this.controller)}},Vh=class extends rC{constructor(){super(...arguments),this.currentStepIndex=0,this.currentSubStepIndex=0,this.steps=[]}editListMode(){return this.controller.isInEditListMode()}requireNotEditListMode(){return{type:"guardrail-only",shouldAdvance:()=>!this.controller.isInEditListMode(),getBlock:()=>({position:"s",content:this.controller.s("graphing-tours-label-require-not-edit-list-mode"),target:{element:document.querySelector(".dcg-action-toggle-edit")}})}}expressionsVisible(){return this.controller.isListVisible()}requireExpressionsVisible(){return{type:"guardrail-only",shouldAdvance:()=>this.expressionsVisible(),getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-require-expressions-visible"),target:{element:document.querySelector(".dcg-show-expressions-tab")}})}}resourcesOpen(){var e;return!!((e=document.querySelector("body"))!=null&&e.classList.contains("resources-open"))}requireResourcesNotOpen(){return{type:"guardrail-only",shouldAdvance:()=>!this.resourcesOpen(),getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-require-resources-not-open"),target:{element:document.querySelector(".dcg-action-opendrawer")}})}}addCountdown(e,t,i){if(!e)return;if(!t)return e;let o=Math.round(t/1e3),n=e.content;return n?Array.isArray(n)||(n=[n]):n=[],i==="final"?__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},e),{content:[...n,this.controller.s("graphing-tours-label-self-destruct",{seconds:o})]}):__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},e),{content:[...n,this.controller.s("graphing-tours-label-next-step-countdown",{seconds:o})]})}advanceTour(){let e=!1;do this.currentSubStepIndex===this.steps[this.currentStepIndex].length-1?(this.currentStepIndex++,this.currentSubStepIndex=0,e=!0):this.currentSubStepIndex++;while(this.steps[this.currentStepIndex][this.currentSubStepIndex].shouldAdvance()&&this.steps[this.currentStepIndex][this.currentSubStepIndex].type!=="final");e&&Qt("tour::step",{tourId:this.props.id(),step:this.currentStepIndex+1})}checkGuardrails(){let{currentStepIndex:e,currentSubStepIndex:t}=this,i,o;for(i=0;i<=e;i++)if(o=this.steps[i].find((n,a)=>((n.type==="guardrail"||n.type==="guardrail-only")&&(i<e||a<t)||(n.type==="guardrail-only--this-step"||n.type==="guardrail--this-step")&&i===e&&a<t)&&!n.shouldAdvance()),o)return o}getCurrentStep(){if(!(!this.steps||this.steps.length===0||this.currentStepIndex>=this.steps.length||this.currentSubStepIndex>=this.steps[this.currentStepIndex].length))return this.steps[this.currentStepIndex][this.currentSubStepIndex]}handleDelayOrCountdown(e){var i;let t;if(e)return e.delayBeforeExit?typeof e.delayBeforeExit=="function"?t=e.delayBeforeExit():t=e.delayBeforeExit:t=Ere,this.nextUpdateTime=Date.now()+t-1,e.type==="countdown"||e.type==="final"?(this.tourController.addInterval(Gre),this.addCountdown(e.getBlock(),t,(i=e.type)!=null?i:"countdown")):(this.tourController.addUpdateTimeout(t),e.getBlock())}getTourStep(){var n;let e=Date.now(),t=this.getCurrentStep();if(!t)return;if(this.nextUpdateTime&&e<this.nextUpdateTime)return t.type==="countdown"||t.type==="final"?this.addCountdown(t.getBlock(),this.nextUpdateTime-Date.now(),t.type):this.curTripBlock;if(t.type==="final"&&this.nextUpdateTime&&e>=this.nextUpdateTime){setTimeout(()=>this.tourController.stopTour());return}let i=!1;if(t.shouldAdvance()){if(this.nextUpdateTime===void 0&&t.delayBeforeExit)return this.handleDelayOrCountdown(t);this.nextUpdateTime=void 0,i=!0,this.advanceTour()}let o=(n=this.checkGuardrails())!=null?n:this.getCurrentStep();return o?(i&&o.beforeStep&&o.beforeStep(),o.updateEveryTick?i&&this.clockBusId===void 0&&(this.clockBusId=Ls(()=>this.update())):this.clockBusId!==void 0&&(Os(this.clockBusId),this.clockBusId=void 0),o.type==="final"||o.type==="countdown"?this.handleDelayOrCountdown(o):o.getBlock()):this.curTripBlock}willUpdate(){let e=this.getTourStep();e&&(this.curTripBlock=e)}onMount(){this.updateListener||(this.updateListener=this.controller.subscribeToChanges(()=>this.update()))}willUnmount(){this.updateListener!==void 0&&(this.updateListener(),this.updateListener=void 0),this.clockBusId!==void 0&&Os(this.clockBusId),this.tourController.clearTimeouts()}template(){return nm.createElement("div",null,kre(()=>this.curTripBlock,e=>nm.createElement(oy,{tourController:this.props.tourController,controller:this.props.controller,content:()=>e().content,header:()=>e().header,innerHTML:()=>e().innerHTML,position:()=>e().position,target:()=>e().target})))}shouldPopup(){return!1}};var Mh=class extends Vh{checkGuardrails(){}advanceTour(){}getCurrentStep(){let t=this.getCurrentStepBase();if(t){let i=t.getBlock();return this.cachedLastBlock&&(dO(i,this.cachedLastBlock)||(this.nextUpdateTime=void 0)),this.cachedLastBlock=i,t.type==="final"&&(this.nextUpdateTime||(this.nextUpdateTime=Date.now()+5e3-1,this.tourController.addInterval(500))),t}}};var nT=class extends Mh{shouldPopup(){return!!this.getMatchingExpNode(ad)}getCurrentStepBase(){var a;if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();if(this.editListMode())return this.requireNotEditListMode();let e=this.getMatchingExpModel(fU),t=this.getMatchingExpNode(ad),i=this.getMatchingExpNode(vU),o=this.getMatchingExpNode(eC);if(e&&i)return{type:"final",shouldAdvance:()=>!0,getBlock:()=>({position:"s",header:this.controller.s("graphing-tours-label-sliders-pro"),content:[],target:{element:i==null?void 0:i.querySelector(".dcg-circular-icon-container")}})};if(e&&o&&!((a=o.querySelector(".dcg-thumb"))!=null&&a.classList.contains("dcg-depressed")))return{shouldAdvance:()=>!0,getBlock:()=>({position:"s",header:this.controller.s("graphing-tours-label-sliders-hands-free"),content:this.controller.s("graphing-tours-label-sliders-press-play"),target:{element:o==null?void 0:o.querySelector(".dcg-circular-icon-container")}})};if(e&&t){let s=t==null?void 0:t.querySelector(".dcg-thumb .dcg-graphic");return{shouldAdvance:()=>!0,getBlock:()=>s?{position:"s",content:this.controller.s("graphing-tours-label-sliders-drag-handle"),target:{element:s,updatePosition:"never"}}:{position:"e",content:this.controller.s("graphing-tours-label-sliders-change-value"),target:{element:t}},updateEveryTick:!0}}let n;return this.expressionCount()>1?n=this.getMatchingExpNode(oO(1)):n=this.getMatchingExpNode(oO(2)),n&&(n!=null&&n.querySelector(".dcg-slider-btn-container:last-child .dcg-btn-blue"))?{shouldAdvance:()=>!0,getBlock:()=>({position:"s",header:this.controller.s("graphing-tours-label-awesome"),content:this.controller.s("graphing-tours-label-sliders-add"),target:{element:n==null?void 0:n.querySelector(".dcg-slider-btn-container:last-child .dcg-btn-blue")}})}:(n=this.getMatchingExpNode(ry),n?{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-sliders-make-sliders"),content:[],innerHTML:this.controller.s("graphing-tours-label-sliders-try-typing",{sample_expression:'<span class="dcg-trip-math">y=mx+b</span>'}),target:{element:n}}),delayBeforeExit:600}:{shouldAdvance:()=>!0,getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-sliders-blank-expression"),target:{selector:".dcg-action-newmath"}})})}};var aT=class extends Vh{constructor(){super(...arguments);this.steps=[[this.requireExpressionsVisible(),this.requireResourcesNotOpen(),this.requireNotEditListMode(),{shouldAdvance:()=>!!this.hasMatchingExpression(om),getBlock:()=>{let t=document.querySelector(".dcg-action-newtable");return t?{position:"e",content:this.controller.s("graphing-tours-label-tables-select-table"),target:{element:t}}:{position:"e",header:this.controller.s("graphing-tours-label-tables-start"),content:this.controller.s("graphing-tours-label-new-item"),target:{selector:".dcg-add-expression-btn"}}},type:"guardrail"}],[{shouldAdvance:()=>{let t=this.getTableEl(),i=0;return t==null||t.querySelectorAll(".dcg-row").forEach(o=>{o.querySelectorAll(".dcg-cell:not(.dcg-empty):not(.dcg-error):not(.dcg-table-header)").length>=2&&i++}),i>=3},getBlock:()=>{var c,p;let t=this.getTableEl();if(!t)return;let i=t.querySelector(".dcg-row .dcg-cell.dcg-error");if(i)return{position:"e",content:this.controller.s("graphing-tours-label-tables-valid-number"),target:{element:i}};let o=Sa(this.getTable());if(!o)return t.getBoundingClientRect().y<0?{position:"e",content:this.controller.s("graphing-tours-label-tables-scroll"),target:{selector:".dcg-expressionlist"}}:{position:"e",content:this.controller.s("graphing-tours-label-tables-back"),target:{element:(p=(c=t==null?void 0:t.querySelector(".dcg-row .dcg-cell.dcg-empty:first-of-type"))==null?void 0:c.parentElement)==null?void 0:p.querySelector(".dcg-cell:nth-of-type(2)")}};let n=-1,a=0;if(t==null||t.querySelectorAll(".dcg-row").forEach(u=>{n++,u.querySelectorAll(".dcg-cell:not(.dcg-empty):not(.dcg-error):not(.dcg-table-header)").length>=2&&a++}),n===2&&a===1&&o&&o.row===1)return{position:"e",content:this.controller.s("graphing-tours-label-tables-next-row"),target:{element:t.querySelector(`.dcg-row:nth-of-type(${o.row+1}) .dcg-cell:nth-of-type(2)`)}};if(a===0&&(t==null?void 0:t.querySelectorAll(".dcg-row:nth-of-type(2) .dcg-cell:not(.dcg-empty):not(.dcg-error)").length)===1)return{position:"e",header:this.controller.s("graphing-tours-label-tables-fill-cell"),content:this.controller.s("graphing-tours-label-tables-type-number"),target:{element:t==null?void 0:t.querySelector(".dcg-row:nth-of-type(2) .dcg-cell:nth-of-type(2)")}};let s=this.controller.s("graphing-tours-label-tables-fill-row"),l;return a===2&&o.row===2?(l=this.controller.s("graphing-tours-label-awesome"),s=this.controller.s("graphing-tours-label-tables-enter")):a===2&&(s=this.controller.s("graphing-tours-label-tables-fill-another")),{position:"e",content:s,header:l,target:{element:t==null?void 0:t.querySelector(`.dcg-row:nth-of-type(${o.row+1}) .dcg-cell:nth-of-type(2)`)}}}}],[{shouldAdvance:()=>!!document.querySelector(".dcg-table-column-menu"),getBlock:()=>{var t;return{header:this.controller.s("graphing-tours-label-tables-last-trick"),content:this.controller.s("graphing-tours-label-tables-open-options"),position:"e",target:{element:(t=this.getTableEl())==null?void 0:t.querySelector(".dcg-row:nth-of-type(1) .dcg-cell:nth-of-type(2) .dcg-circular-icon")}}},type:"guardrail--this-step"},{shouldAdvance:()=>{let t=this.getTable();return!!t&&t.columnModels[1].points&&t.columnModels[1].lines},getBlock:()=>({content:this.controller.s("graphing-tours-label-tables-dots"),position:"e",target:{selector:".dcg-table-column-menu .dcg-options-menu-section:nth-of-type(2)"}})}],[{shouldAdvance:()=>!document.querySelector(".dcg-table-column-menu"),getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-tables-close-options"),target:{element:this.getTableEl()}})},{shouldAdvance:()=>!1,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-tables-whiz"),content:[],target:{element:this.getTableEl()}}),type:"final"}]]}shouldPopup(){return!!this.getMatchingExpNode(rT)}getTableEl(){let t=this.getMatchingExpId(om);if(t)return this.getExpressionNodeById(t)}getTable(){let t=this.getMatchingExpId(om);if(!t)return;let i=this.getModelById(t);if((i==null?void 0:i.type)==="table")return i}};var sT=class extends Mh{shouldPopup(){return!!this.getMatchingExpNode(lO)}restrictedLineTour(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();let t=this.getMatchingExpNode([aO,bU]),i=this.getMatchingExpNode(sO);if(t)return i?(this.completedPhase1=!0,this.getCurrentStepBase()):{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-brilliant"),content:this.controller.s("graphing-tours-label-restrictions-new-expression"),target:{selector:".dcg-new-math-div"}})};let o=this.getMatchingExpId(ry),n=this.getExpressionNodeById(o),a=this.getModelById(o);if(n&&a){let s=this.expMatches(a,nO);return this.expMatches(a,iO)?void 0:s?{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-awesome"),content:[],innerHTML:[this.controller.s("graphing-tours-label-restrictions-domain",{sample_expression:'<span class="dcg-trip-math">\\left\\{x<0\\right\\}</span>'}),"<br><i>"+this.controller.s("graphing-tours-label-restrictions-abc",{buttons:"{ }"})+"</i>"].join(""),target:{element:n}})}:{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-restrictions-start"),content:[],innerHTML:this.controller.s("graphing-tours-label-restrictions-straight-line",{sample_expression:'<span class="dcg-trip-math">y=2x</span>'}),target:{element:n}}),delayBeforeExit:500}}return{shouldAdvance:()=>!0,getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-restrictions-blank-expression"),target:{selector:".dcg-new-math-div"}})}}restrictedParabolaTour(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();if(this.getMatchingExpNode([yU,Qv]))return{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-restrictions-star"),content:[],target:{selector:".dcg-exppanel-container"}}),type:"final"};let i=this.getMatchingExpId([sO,tT]),o=this.getExpressionNodeById(i),n=this.getModelById(i);if(o&&n){let a=this.expMatches(n,[Qv,wU]),s=this.expMatches(n,xU),l=this.expMatches(n,Qv);return this.expMatches(n,iO)?void 0:l?a?s?{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-nice"),content:[],innerHTML:this.controller.s("graphing-tours-label-restrictions-range",{sample_expression:'<span class="dcg-trip-math">\\left\\{y<4\\right\\}</span>'}),target:{element:o}})}:{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-restrictions-move-parabola"),content:[],innerHTML:this.controller.s("graphing-tours-label-restrictions-change-equation",{sample_expression:'<span class="dcg-trip-math">y=x^2-2</span>'}),target:{element:o,updatePosition:"always"}})}:{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-restrictions-dont-forget"),content:[],innerHTML:this.controller.s("graphing-tours-label-restrictions-type-all",{sample_expression:'<span class="dcg-trip-math">y=x^2</span>'}),target:{element:o}})}:{shouldAdvance:()=>!0,getBlock:()=>({position:"e",content:[],innerHTML:[this.controller.s("graphing-tours-label-restrictions-graph-parabola",{sample_expression:'<span class="dcg-trip-math">y=x^2</span>'})+"<br><i>"+this.controller.s("graphing-tours-label-restrictions-typing-hint",{suggestion1:"y=x^2",suggestion2:'<span class="dcg-trip-math">a^2</span>'})+"</i>"].join(""),target:{element:o,updatePosition:"always"}})}}return{shouldAdvance:()=>!0,getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-restrictions-blank-expression"),target:{selector:".dcg-new-math-div"}})}}getCurrentStepBase(){return this.completedPhase1?this.restrictedParabolaTour():this.restrictedLineTour()}};var lT=class extends Mh{constructor(){super(...arguments);this.hasCreatedLinearRegression=!1;this.hasInitiallyRenderedSampleDataLink=!1}shouldPopup(){return this.hasMatchingExpression(rT)}getRegressionExpId(){return this.getMatchingExpId(iy)||this.getMatchingExpId(Xv)}getRegressionExp(){return this.getMatchingExpModel(iy)||this.getMatchingExpModel(Xv)}hasRegression(){var n;let t=this.getRegressionExp(),i=(n=t==null?void 0:t.formula)==null?void 0:n.regression,o=i==null?void 0:i.statistics;return!!o&&o.r}hasFilledTable(){let t=this.getMatchingExpNode(om);return!!t&&t.querySelectorAll(".dcg-row .dcg-cell:nth-of-type(2):not(.dcg-table-header):not(.dcg-empty)").length>=5}getCurrentStepBase(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();if(this.editListMode())return this.requireNotEditListMode();let t=this.getMatchingExpId(iy)||this.getMatchingExpId(Xv),i=this.getExpressionNodeById(t),o=this.getModelById(t),n=this.getMatchingExpId(om),a=this.getExpressionNodeById(n),s=this.getModelById(n);if(!s||s.type!=="table"||!s.columnModels[1]){let k=document.querySelector(".dcg-action-newtable");return!k&&(!pl&&!ul)?{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-regressions-data"),content:[],innerHTML:this.controller.s("graphing-tours-label-regressions-docs",{sample_data_link:'<a class="dcg-trip-link" target="_blank" href="https://docs.google.com/spreadsheets/d/1h4kYwWka_1PvI5G-hPYz_QBe1FrYLo9Gb1XvxJz-QYE/edit#gid=0">'+this.controller.s("graphing-tours-label-regressions-sample-data")+"</a>"})+' <div class="dcg-trip-hint"><br>'+this.controller.s("graphing-tours-label-regressions-own-data",{plus_icon:'<i class="dcg-icon-plus" aria-hidden="true"></i>'}),target:{element:i||document.querySelector(".dcg-exppanel")}})}:k?{shouldAdvance:()=>!0,getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-regressions-new-table"),target:{element:k}}),delayBeforeExit:250}:{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-regressions-data-2"),content:this.controller.s("graphing-tours-label-new-item"),target:{selector:".dcg-add-expression-btn"}}),delayBeforeExit:150}}let l=s.columnModels[0].values.length;if(a&&l<5)return{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-regressions-fill-sample-data"),content:[],innerHTML:"<table class='dcg-regression-tour-table'><tr><td><span class='dcg-trip-math'>x_1</span></td><td><span class='dcg-trip-math'>y_1</span></td></tr><tr><td>1</td><td>0.8</td></tr><tr><td>2</td><td>2.7</td></tr><tr><td>3</td><td>3.9</td></tr><tr><td>4</td><td>4.6</td></tr><tr><td>5</td><td>5</td></tr></table>",target:{element:a.querySelector(".dcg-row:nth-of-type(2) .dcg-cell:nth-of-type(2)")}})};let c=this.getMatchingExpModel(iy)||this.getMatchingExpModel(tT)||this.controller.getItemModelByIndex(0);if(!c||c.type!=="expression"){let k=document.querySelector(".dcg-action-newexpression");return k?{shouldAdvance:()=>!0,getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-regressions-expression-option"),target:{element:k}}),delayBeforeExit:150}:{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-awesome"),content:this.controller.s("graphing-tours-label-new-item"),target:{selector:".dcg-add-expression-btn"}}),delayBeforeExit:150}}let p=o&&o.type==="expression"&&o.formula,u=p?p.regression:void 0,m=u?u.statistics:void 0,h=u?u.parameters:void 0;if(m&&m.r&&(this.hasCreatedLinearRegression=!0),!this.hasCreatedLinearRegression&&i)return{shouldAdvance:()=>!0,getBlock:()=>({position:"e",content:[],innerHTML:this.controller.s("graphing-tours-label-regressions-equation",{equation:"<span class='dcg-trip-math'>y_1\\sim mx_1+b</span>"})+"<div class='trip-hint'>"+this.controller.s("graphing-tours-label-regressions-hint-1",{y_1:"<span class='dcg-trip-math'>y_1</span>",y1:"<span class='dcg-trip-math'>y1</span>"})+"</div><div class='dcg-trip-hint'>"+this.controller.s("graphing-tours-label-regressions-hint-2",{twiddle:"<span class='dcg-trip-math'>~</span>"})+"</div>",target:{element:i,updatePosition:"never"}}),delayBeforeExit:250};if(document.querySelector(".dcg-residual-suggestion"))return{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-regressions-check-model"),content:this.controller.s("graphing-tours-label-regressions-residuals"),target:{selector:".dcg-residual-suggestion"}}),delayBeforeExit:250};if(m&&(m.Rsquared>=.99||m.r>=.99||h&&h.a&&h.k&&h.h))return{shouldAdvance:()=>!0,type:"final",getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-regressions-keep-exploring"),content:[],target:{selector:".dcg-exppanel"}})};if(!i)return;let C,D=this.getMatchingExpIds(iy);return D.length>1?C=this.getExpressionNodeById(D.pop()):C=this.getExpressionNodeById(D[0]),{shouldAdvance:()=>!0,getBlock:()=>({position:"e",header:this.controller.s("graphing-tours-label-regressions-new-model"),content:[],innerHTML:this.controller.s("graphing-tours-label-regressions-better-fit",{equation:"<span class='dcg-trip-math'>y_1~a(x_1-h)^2+b</span>"}),target:{element:C,updatePosition:"never"}}),delayBeforeExit:300}}};var iC={sliders:{tour:nT,titleKey:"graphing-tours-heading-sliders",thumb:""},tables:{tour:aT,titleKey:"graphing-tours-heading-tables",thumb:""},restrictions:{tour:sT,titleKey:"graphing-tours-heading-restrictions",thumb:""},regressions:{tour:lT,titleKey:"graphing-tours-heading-regressions",thumb:""}};var cT=class extends pc.Class{init(){this.controller=this.props.controller()}template(){return pc.createElement(ps,{title:()=>this.controller.s("account-shell-heading-tours"),type:()=>"help",label:()=>this.controller.s("account-shell-label-help-menu"),controller:this.props.controller},pc.createElement(YG,{controller:this.props.controller,tours:this.const(iC)}),pc.createElement("h2",{class:pc.const("dcg-unstyled-heading dcg-popover-title")},()=>this.controller.s("account-shell-heading-resources")),pc.createElement(JG,{controller:this.props.controller}),pc.createElement("h2",{class:pc.const("dcg-unstyled-heading dcg-popover-title dcg-interior-title dcg-hide-on-mobile")},()=>this.controller.s("account-shell-heading-contact-us")),pc.createElement(Ih,{controller:this.props.controller}))}};var zo=__dcg_shared_module_exports__['h'](z());var dT=class extends zo.Class{init(){this.controller=this.props.controller()}template(){return zo.createElement(ps,{title:()=>this.controller.s("account-shell-heading-resources"),type:()=>"help",label:()=>this.controller.s("account-shell-label-help-menu"),controller:this.props.controller},zo.createElement("div",{class:zo.const("dcg-popover-content dcg-resources-content"),role:zo.const("region"),"aria-label":()=>this.controller.s("account-shell-heading-resources")},zo.createElement(dc,{href:()=>"https://docs.google.com/document/d/1u4fhQsXWzdCWRGfTdJSuAg9xtyiDk-wmkIAsUkb2L20/preview",icon:zo.const("dcg-icon-book"),title:()=>this.controller.s("account-shell-link-geometry-user-guide")}),zo.createElement(dc,{href:zo.const("https://help.desmos.com/"),icon:zo.const("dcg-icon-comments"),title:()=>this.controller.s("account-shell-link-help-center")}),zo.createElement("div",{class:zo.const("dcg-resource-link dcg-action-show-hotkeys"),role:zo.const("link"),tabindex:zo.const(0),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"hotkeys",device:e.device})},zo.createElement("i",{class:zo.const("dcg-icon-keyboard"),"aria-hidden":zo.const("true")}),zo.createElement("span",null,()=>this.controller.s("account-shell-link-keyboard-shortcuts")))),zo.createElement("h2",{class:zo.const("dcg-unstyled-heading dcg-popover-title dcg-interior-title dcg-hide-on-mobile")},()=>this.controller.s("account-shell-heading-contact-us")),zo.createElement(Ih,{controller:this.props.controller}))}};var dr=__dcg_shared_module_exports__['h'](z());function ay(r,e){return CU(r)||DU(r)}ay.is3d=!0;function CU(r,e){return r.type!=="expression"?!1:!!r.formula&&r.formula.expression_type==="POINT3D_LIST"}CU.is3d=!0;function DU(r,e){return r.type!=="expression"?!1:!!r.formula&&r.formula.expression_type==="POINT3D"}DU.is3d=!0;function Tre(r,e){return r.type!=="expression"?!1:(!r.formula||!!r.formula.error)&&!!r.latex&&r.latex.startsWith("\\left(")||r.formula.expression_type==="POINT3D"}Tre.is3d=!0;function pO(r,e){return!e||!ay(r)?!1:e.branches.some(t=>t.position[2]>0)}pO.is3d=!0;function uO(r,e){return!e||!ay(r)?!1:e.branches.some(t=>t.position[2]<0)}uO.is3d=!0;function hO(r,e){return!e||!ay(r)?!1:e.branches.some(t=>"position"in t&&t.position[0]===0&&t.position[1]===0)}hO.is3d=!0;function pT(r,e){return r.type!=="expression"?!1:!!r.extendTo3D}pT.is3d=!0;function gO(r,e){return e?e.branches.every(t=>{if(t.graphMode!==100&&t.graphMode!==128)return!1;let i=t.points[1];return t.points.every((o,n)=>n%3!==1||Math.abs(o-i)<=1e-4||isNaN(o))}):!1}gO.is3d=!0;function uT(r,e){return e?e.branches.every(t=>{if(t.graphMode!==100&&t.graphMode!==128)return!1;let i=t.points[0],o=t.points[1],n=t.points[2];return t.points.every((a,s)=>s%3!==0||Math.abs(a-i)<=1e-4||isNaN(a))||t.points.every((a,s)=>s%3!==1||Math.abs(a-o)<=1e-4||isNaN(a))||t.points.every((a,s)=>s%3!==2||Math.abs(a-n)<=1e-4||isNaN(a))}):!1}uT.is3d=!0;function hT(r,e){return e?e.branches.every(t=>t.graphMode===118):!1}hT.is3d=!0;function Ire(r,e){return e?e.branches[0].graphMode===118&&e.branches[0].position[2]<=1:!1}Ire.is3d=!0;var gT=r=>e=>e.getMatchingExpModels(ad).filter(o=>o.type==="expression").map(o=>o.formula.assignment&&__dcg_shared_module_exports__['hb'](o.formula.assignment)).some(o=>!!o&&e.hasMatchingExpression([r,Zv(o)]));var Vre={version:10,randomSeed:"c13e89605fe04a21e53d878aa0a7202d",graph:{viewport:{xmin:-5,ymin:-5,zmin:-5,xmax:5,ymax:5,zmax:5},threeDMode:!0,worldRotation3D:[-.5132799671593364,-.8314696123025455,-.212607523691814,.7681777567114166,-.555570233019602,.3181896451432085,-.3826834323650897,0,.9238795325112867],axis3D:[-.9389975190442629,-.3439239154086105,-26438544160422738e-28],product:"graphing-3d"},expressions:{list:[{type:"text",id:"3",text:"3-dimensional points have three coordinates. For example, the point below is at x=1, y=2, and z=0.",readonly:!0},{type:"expression",id:"1",color:"#6042a6",latex:"\\left(1,2,0\\right)",readonly:!0}]}},SU={title:"Plot Points in 3D",thumb:"points-2x.png",prompt:"Update the graph so that it has a point that is...",startingState:Vre,goals:[{text:"above the XY plane",expressionCriteria:[pO]},{text:"below the XY plane",expressionCriteria:[uO]},{text:"on the z-axis",expressionCriteria:[hO]},{text:"connected to a slider",complexCriterion:gT(ay)}],hintMiniTours:["add_slider"]};var mO=r=>{if(!r.is3dProduct())return!1;let t=r.getGrapher3d();if(!t)return!1;let i=t.getCurrentViewport().zmax,o=t.mathCoordinatesToScreenCoordinates({x:0,y:0,z:0}),n=t.mathCoordinatesToScreenCoordinates({x:0,y:0,z:i!=null?i:1});return Math.abs(n.x-o.x)+Math.abs(n.y-o.y)<20},kU=r=>{if(!r.is3dProduct())return!1;let e=r.getGrapher3d();return e?e.settings.speed3D!==0:!1},fO=r=>e=>!r(e);var Mre={version:10,randomSeed:"dc76b01fd3183b4066c467ba113fbef9",graph:{viewport:{xmin:-5,ymin:-5,zmin:-5,xmax:5,ymax:5,zmax:5},threeDMode:!0,worldRotation3D:[3749399456654644e-48,-1,6123233995736766e-32,6123233995736766e-32,6123233995736766e-32,1,-1,0,6123233995736766e-32],axis3D:[.9999999996978197,-6123233993886446e-32,59328897079605555e-46],product:"graphing-3d"},expressions:{list:[{type:"expression",id:"1",color:"#388c46",latex:"y=a\\left(x\\right)^{2}+k",readonly:!0,lines:!0,surfaces:!1},{type:"expression",id:"5",color:"#388c46",latex:"y=\\sin x",readonly:!0,lines:!0,surfaces:!1},{type:"expression",id:"6",color:"#c74440",latex:"a=0.5",hidden:!0,readonly:!0,slider:{hardMin:!0,hardMax:!0}},{type:"expression",id:"4",color:"#6042a6",latex:"k=-1.5",hidden:!0,readonly:!0,slider:{hardMin:!0,hardMax:!0}}]}},EU={title:"Make a 3D Surface",thumb:"surfaces-2x.png",prompt:"Update this graph so that...",startingState:Mre,goals:[{text:"it's tilted so you can see the z-axis",controllerCriteria:fO(mO)},{text:"you see the 3d surfaces for both equations",complexCriterion:r=>{let e=r.getModelById("1"),t=r.getModelById("5");return!!(e&&e.type==="expression"&&e.extendTo3D&&t&&t.type==="expression"&&t.extendTo3D)}},{text:"the colors of the two surfaces are different",complexCriterion:r=>{let e=r.getModelById("1"),t=r.getModelById("5");return!!(e&&e.type==="expression"&&t&&t.type==="expression"&&e.color!==t.color)}},{text:"it has momentum, rotating around the z-axis",controllerCriteria:[kU,fO(mO)]}],hintMiniTours:["change_line_to_surface","change_color_3d"]};var Are={version:10,randomSeed:"4fd2b19fe0ef32598432e66d6dea4a8d",graph:{viewport:{xmin:-5,ymin:-5,zmin:-5,xmax:5,ymax:5,zmax:5},threeDMode:!0,worldRotation3D:[-.4034467850661228,-.9130294825148988,-.0600654283128971,.9030757945548551,-.4078935695234748,.13445053079307687,-.14725760051335893,-4673193812242393e-29,.9890981746475297],axis3D:[0,0,-1.0000000000030735],product:"graphing-3d"},expressions:{list:[{type:"text",id:"6",text:'The "sphere" function requires a center point and a radius. For example: sphere((0,0,0), 3) will draw a sphere of radius 3 at the origin.',readonly:!0},{type:"expression",id:"1",color:"#c74440",latex:"\\operatorname{sphere}\\left(\\left(0,0,-2\\right),\\ 2\\right)",readonly:!0},{type:"expression",id:"2",color:"#2d70b3",latex:"\\operatorname{sphere}\\left(\\left(0,0,H\\right),R\\right)",readonly:!0},{type:"expression",id:"4",color:"#6042a6",latex:"H=2",hidden:!0,readonly:!0,slider:{hardMin:!0,min:"-2"}},{type:"expression",id:"3",color:"#388c46",latex:"R=2",hidden:!0,readonly:!0,slider:{hardMin:!0,min:"0"}}]}},GU={title:"Build a Snowman",thumb:"snowman-2x.png",prompt:"Update this graph so that...",startingState:Are,goals:[{text:"the top sphere is smaller than the bottom one, but still touching",complexCriterion:r=>{let e=r.getExpSketchById("2");if(!e||e.branches.length!==1||e.branches[0].graphMode!==118)return!1;let t=e.branches[0],i=Math.abs(t.radius);return i<2&&t.position[2]<=i&&t.position[2]>=-i}},{text:"it has a third sphere that's even smaller and on top of the other two",complexCriterion:r=>{var i;let e=(i=r.getExpSketchById("2"))==null?void 0:i.branches[0];return(e==null?void 0:e.graphMode)!==118?!1:r.getMatchingExpIds(hT).some(o=>{var s;let n=(s=r.getExpSketchById(o))==null?void 0:s.branches[0];return(n==null?void 0:n.graphMode)!==118?!1:Math.sqrt(Math.pow(n.position[0]-e.position[0],2)+Math.pow(n.position[1]-e.position[1],2)+Math.pow(n.position[2]-e.position[2],2))<=Math.abs(e.radius)+Math.abs(n.radius)+1e-4&&n.position[2]>e.position[2]&&n.radius<e.radius})}},{text:"the spheres are all the same color",complexCriterion:r=>{let t=r.getMatchingExpIds(hT).map(o=>r.getModelById(o)),{color:i}=t[0];return t.every(o=>o.color===i)}},{text:"the axes and grid are hidden",complexCriterion:r=>r.getState().graph.showAxis3D===!1}],hintMiniTours:["change_color_3d","turn_off_axes"]};var Lre={version:10,randomSeed:"c60138920fbda2e34d39e64024c81e8f",graph:{viewport:{xmin:-5,ymin:-5,zmin:-5,xmax:5,ymax:5,zmax:5},threeDMode:!0,worldRotation3D:[-.7911610162161196,.5672186659200341,-.22875146218502837,-.5448994070006874,-.8235672316404455,-.15754888517028243,-.27775687690890294,1234910249295711e-28,.960651402606498],axis3D:[0,0,-.9999999999834579],product:"graphing-3d"},expressions:{list:[{type:"text",id:"6",text:'If you restrict a surface to a single x, y, or z value it graphs a "slice" of that surface. Here we can use that to show conic sections.',readonly:!0},{type:"expression",id:"1",color:"#c74440",latex:"z^{2}=x^{2}+y^{2}",readonly:!0},{type:"expression",id:"4",color:"#6042a6",latex:"z^{2}=x^{2}+y^{2}\\left\\{x=1\\right\\}",readonly:!0}]}},TU={title:"Slice a Surface",thumb:"slices-2x.png",prompt:"Update this graph so that...",startingState:Lre,goals:[{text:"there is a slice with a constant y value (y-slice)",expressionCriteria:gO},{text:"there are at least 3 z-slices",complexCriterion:r=>r.getUniqueSliceValues("z").length>=3},{text:"at least 1 slice is connected to a slider",complexCriterion:gT(uT)},{text:"all of the slices are the same color",complexCriterion:r=>{let e=r.getMatchingExpModels(uT);if(e.length===0)return!1;let t=e[0].color;return e.every(i=>i.color===t)}}],hintMiniTours:["change_color_3d","add_slider"]};var Ore={version:10,randomSeed:"303b2b2529c124fd179bcf0928c52bf1",graph:{viewport:{xmin:-5,ymin:-5,zmin:-5,xmax:5,ymax:5,zmax:5},threeDMode:!0,worldRotation3D:[-.4566162267528601,-.8805869756969109,-.126760402725266,.848498419860239,-.47388456213838426,.23555010775147064,-.2674921549518761,-53011017512727e-26,.9635600381083326],axis3D:[-.8805869757112816,-.4738845621467119,17425479990120072e-28],product:"graphing-3d"},expressions:{list:[{type:"text",id:"3",text:"You can use lists to slice a surface in several places at once. Lists are are defined by [start ... end]. You can also set a step size with the second number. For example [0, 2, ... 20] will just be the evens from 0 to 20.",readonly:!0},{type:"expression",id:"1",color:"#aaaaaa",latex:"f\\left(x,y\\right)=\\frac{x^{2}-y^{2}}{6}",readonly:!0},{type:"expression",id:"4",color:"#2d70b3",latex:"z=f\\left(x,y\\right)\\left\\{x=a\\right\\}",readonly:!0},{type:"expression",id:"5",color:"#6042a6",latex:"a=\\left[-5...5\\right]",hidden:!0}]}},IU={title:"Make a Mesh",thumb:"mesh-2x.png",prompt:"Update this graph so that...",startingState:Ore,goals:[{text:"it also has a list of y-slices",complexCriterion:r=>r.getUniqueSliceValues("y").length>1},{text:"the slices are denser, so there are at least 20 x-slices and 20 y-slices",complexCriterion:r=>{let e=r.getUniqueSliceValues("x"),t=r.getUniqueSliceValues("y");return e.length>=20&&t.length>=20}},{text:"the surface is hidden so that you only see the mesh",complexCriterion:r=>{let e=r.getModelById("1");return!!e&&e.type==="expression"&&e.hidden===!0}},{text:"the axes and grid are hidden",complexCriterion:r=>r.getState().graph.showAxis3D===!1}],hintMiniTours:["turn_off_axes"]};var rl={"0aab81de":SU,"46fc0484":EU,ecd99f28:GU,"3a96cffc":TU,be0997b4:IU};var{For:Pre,If:_re}=dr.Components,VU=6,mT=class extends dr.Class{init(){this.controller=this.props.controller()}template(){return dr.createElement(ps,{title:()=>this.controller.s("graphing-calculator-heading-quests"),type:()=>"help",label:()=>this.controller.s("account-shell-label-help-menu"),controller:this.props.controller},dr.createElement("div",{class:dr.const("dcg-popover-content dcg-resources-content dcg-3d-help-resources"),role:dr.const("region"),"aria-label":()=>this.controller.s("graphing-calculator-heading-quests")},dr.createElement(Pre,{each:()=>Object.keys(rl).slice(0,VU)},dr.createElement("ul",{class:dr.const("dcg-unstyled-list")},e=>dr.createElement("li",null,dr.createElement("a",{class:dr.const("dcg=unstyled-link dcg-resource-link"),tabindex:dr.const("0"),role:dr.const("link"),onTap:()=>this.launchQuest(e)},dr.createElement("span",null,()=>this.controller.raw(rl[e].title)))))),dr.createElement(_re,{predicate:()=>Object.keys(rl).length>VU},()=>dr.createElement("button",{class:dr.const("dcg-unstyled-button dcg-resource-link dcg-resources-view-all-quests"),onTap:()=>this.showQuestsModal()},dr.createElement("span",null,()=>this.controller.s("account-shell-link-view-all-quests"))))),dr.createElement("h2",{class:dr.const("dcg-unstyled-heading dcg-popover-title")},()=>this.controller.s("account-shell-heading-resources")),dr.createElement("div",{class:dr.const("dcg-popover-content dcg-resources-content"),role:dr.const("region")},dr.createElement(dc,{href:()=>"https://docs.google.com/document/d/1jDJC0Zw7cB82SNEc04m5HGQHaXYaJK62iZM88ojNYwI/preview",icon:dr.const("dcg-icon-book"),title:()=>this.controller.s("account-shell-link-3d-user-guide")}),dr.createElement(dc,{href:dr.const("https://help.desmos.com/"),icon:dr.const("dcg-icon-comments"),title:()=>this.controller.s("account-shell-link-help-center")}),dr.createElement("button",{class:dr.const("dcg-unstyled-button dcg-resource-link dcg-action-show-hotkeys"),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"hotkeys",device:e.device})},dr.createElement("i",{class:dr.const("dcg-icon-keyboard"),"aria-hidden":dr.const("true")}),dr.createElement("span",null,()=>this.controller.s("account-shell-link-keyboard-shortcuts")))),dr.createElement("h2",{class:dr.const("dcg-unstyled-heading dcg-popover-title dcg-interior-title dcg-hide-on-mobile")},()=>this.controller.s("account-shell-heading-contact-us")),dr.createElement(Ih,{controller:this.props.controller}))}launchQuest(e){this.controller.tourController.startQuest(e),this.controller.dispatch({type:"toggle-menu",payload:"none"})}showQuestsModal(){this.controller.tourController.setQuestsListModalVisibility(!0),this.controller.dispatch({type:"toggle-menu",payload:"none"})}};var We=__dcg_shared_module_exports__['h'](z());xt();var Uo=__dcg_shared_module_exports__['h'](z());xt();var{Input:Fre,Switch:Rre}=Uo.Components,fT=class extends Uo.Class{constructor(){super(...arguments),this.unmounted=!1}didUnmount(){this.unmounted=!0}template(){return Uo.createElement("div",{class:Uo.const("dcg-selectable-input-container")},Uo.createElement(Fre,{class:this.const("dcg-permalink select-all dcg-variable-permalink"),"aria-label":()=>this.props.controller().s("graphing-calculator-narration-share-graph-link"),name:()=>this.props.controller().s("graphing-calculator-text-share-graph-link"),value:this.props.link,didMount:e=>{this.inputEl=e,ul||this.inputEl.focus()},onTap:()=>this.inputEl.select(),onInput:()=>{}}),Uo.createElement("div",{role:Uo.const("button"),tabindex:Uo.const(0),class:Uo.const("dcg-copy-button"),onTap:this.bindFn(this.copyLink)},Uo.createElement(Rre,{key:()=>this.copyStatus},e=>e=="success"?Uo.createElement("span",{"aria-label":()=>this.props.controller().s("graphing-calculator-narration-share-graph-link-copied")},Uo.createElement("i",{class:Uo.const("dcg-icon-check"),"aria-hidden":Uo.const("true")})):e=="error"?Uo.createElement("span",{"aria-label":()=>this.props.controller().s("graphing-calculator-narration-share-graph-link-unable-to-copy")},Uo.createElement("i",{class:Uo.const("dcg-icon-error"),"aria-hidden":Uo.const("true")})):Uo.createElement("span",{class:Uo.const("dcg-copy-text")},()=>this.props.controller().s("graphing-calculator-button-share-graph-link-copy")))))}copyLink(){if(this.inputEl){H(this.inputEl).trigger("focus").trigger("select"),this.copyStatus="success";try{document.execCommand("copy")}catch(e){this.copyStatus="error"}this.unmounted||(this.update(),clearTimeout(this.copyStatusTimeout),this.copyStatusTimeout=setTimeout(()=>{this.copyStatus=null,!this.unmounted&&this.update()},2500))}}};var{If:gu,Textarea:Nre}=We.Components,bT=class extends We.Class{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController,this.graph=null,this.shareInProgress=!0,this.didSharingFail=!1,Qt("user-action::open-share-dropdown",{})}template(){return We.createElement(ps,{title:()=>this.controller.s("account-shell-heading-share-graph"),type:We.const("share"),label:()=>this.controller.s("account-shell-narration-share-options"),controller:this.props.controller},We.createElement("div",{class:We.const("dcg-popover-content")},We.createElement(gu,{predicate:()=>this.shareInProgress},()=>We.createElement("div",{class:We.const("dcg-loading")},We.createElement("span",{class:We.const("dcg-spinner")}),()=>this.controller.s("account-shell-label-loading"))),We.createElement(gu,{predicate:()=>this.didSharingFail},()=>We.createElement("div",{class:We.const("dcg-failed")},We.createElement("span",{"aria-live":We.const("assertive"),"aria-atomic":We.const(!0)},()=>this.controller.s("account-shell-error-sharing-link")+" "),We.createElement("span",{role:We.const("button"),tabindex:We.const("0"),class:We.const("dcg-action-retry"),onTap:()=>(this.controller.dispatch({type:"toggle-menu",payload:"none"}),this.controller.dispatch({type:"toggle-menu",payload:"share"}))},()=>this.controller.s("account-shell-button-retry-now")),()=>` ${this.controller.s("account-shell-text-or")} `,We.createElement("span",{role:We.const("button"),tabindex:We.const("0"),class:We.const("dcg-action-close"),onTap:()=>this.controller.dispatch({type:"toggle-menu",payload:"share"})},()=>this.controller.s("account-shell-button-cancel")),We.const("."))),We.createElement(gu,{predicate:()=>!this.shareInProgress&&!this.didSharingFail},()=>We.createElement("div",{class:We.const("dcg-loaded"),didMount:this.bindFn(this.didMountLoaded)},()=>this.controller.s("account-shell-label-share-link"),We.createElement(fT,{controller:this.props.controller,link:()=>this.getGraphPath()}),We.createElement(gu,{predicate:()=>!this.controller.shouldDisablePrintAndExport()},()=>We.createElement("div",{class:We.const("dcg-share-actions")},We.createElement(gu,{predicate:()=>this.controller.product!=="geometry-calculator"},()=>We.createElement("span",{class:We.const("dcg-print-link"),onTap:this.bindFn(this.print),tabindex:We.const("0"),role:We.const("link")},We.createElement("i",{class:We.const("dcg-icon-print"),"aria-hidden":We.const("true")}),We.createElement("span",null,()=>this.controller.s("account-shell-button-print")))),We.createElement(gu,{predicate:()=>this.controller.product!=="graphing-3d"},()=>We.createElement("span",{class:We.const("dcg-export-image-link"),onTap:this.bindFn(this.exportImage),tabindex:We.const("0"),role:We.const("link")},We.createElement("i",{class:We.const("dcg-icon-export"),"aria-hidden":We.const("true")}),We.createElement("span",null,()=>this.controller.s("account-shell-button-export-image")))),We.createElement(gu,{predicate:()=>this.controller.product!=="geometry-calculator"},()=>We.createElement("span",{class:()=>({"dcg-embed-link":!0,"dcg-selected":this.embedVisible}),onTap:this.bindFn(this.toggleEmbedVisible),tabindex:We.const("0"),role:We.const("button"),"aria-pressed":()=>this.embedVisible},We.createElement("i",{class:We.const("dcg-icon-embed"),"aria-hidden":We.const("true")}),We.createElement("span",null,()=>this.controller.s("account-shell-button-embed")))))),We.createElement(gu,{predicate:()=>this.embedVisible},()=>We.createElement("div",{class:We.const("dcg-embed-div share-div"),didMount:this.bindFn(this.didMountTextarea)},We.createElement(Nre,{rows:We.const("6"),class:We.const("select-all first-input dcg-variable-htmlembedcode"),value:()=>this.getGraphEmbedCode(),onInput:()=>{}}))),We.createElement(gu,{predicate:()=>this.controller.shouldShowArtContestNudge()},()=>We.createElement("div",{class:We.const("dcg-art-contest-container")},We.createElement("span",{class:We.const("dcg-trophy-icon")},We.const("\u{1F3C6}")),We.createElement(si,{i18n:this.const(this.controller),key:this.const("account-shell-text-share-submit-to-contest")},We.createElement("span",{class:We.const("dcg-contest-submit-message")},We.const("Submit this graph to the"),We.const(" "),We.createElement("span",{class:We.const("dcg-bold-text")},We.const("Global Math Art Contest!")))),We.createElement("div",{class:We.const("dcg-enter-btn"),role:We.const("button"),tabindex:We.const("0"),onTap:e=>(this.controller.state.artContestURLFromShareMenu=this.getGraphPath(),this.controller.dispatch({type:"show-modal",modal:"contest-submission",device:e.device}))},()=>this.controller.s("account-shell-button-submit"))))))))}didMountTextarea(e){let t=e.querySelector("textarea");H(t).trigger("focus").trigger("select")}toggleEmbedVisible(){this.embedVisible=!this.embedVisible,this.unmounted||this.update()}didMountLoaded(){this.embedVisible=!1}print(){window.print()}exportImage(e){this.controller.dispatch({type:"show-modal",modal:"export-image",device:e.device})}getGraphPath(){return this.graph!=null?this.graph.getURL():void 0}getGraphEmbedCode(){return this.graph?`<iframe src="${`${this.getGraphPath()}?embed`}" width="500" height="500" style="border: 1px solid #ccc" frameborder=0></iframe>`:""}didUnmount(){this.unmounted=!0}async didMount(){try{let e=await this.graphsController.shareGraph();this.graph=e}catch(e){this.didSharingFail=!0}finally{this.shareInProgress=!1,this.unmounted||this.update()}}};var Sn=__dcg_shared_module_exports__['h'](z());var{If:Bre}=Sn.Components,sy=class extends Sn.Class{init(){this.controller=this.props.controller(),this.userController=this.controller.userController}template(){return Sn.createElement(Bre,{predicate:()=>this.userController.isLoggedIn()},()=>Sn.createElement(ps,{type:()=>"account",label:()=>this.controller.s("account-shell-label-account-information"),left:this.props.left,arrowLeft:this.props.arrowLeft,controller:this.props.controller},Sn.createElement("div",{class:Sn.const("user-info")},Sn.createElement("span",{class:Sn.const("account-name")},()=>this.userController.getFullName()),Sn.createElement("span",{class:Sn.const("account-email")},()=>this.userController.getEmail()),Sn.createElement("a",{class:Sn.const("dcg-action-accountsettings"),role:Sn.const("link"),tabindex:Sn.const(0),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"account-settings",device:e.device})},()=>this.controller.s("account-shell-link-account-settings"))),Sn.createElement("a",{class:Sn.const("dcg-action-logout"),role:Sn.const("link"),tabindex:Sn.const(0),onTap:()=>this.logout()},()=>this.controller.s("account-shell-link-sign-out"))))}logout(){this.controller.dispatch({type:"toggle-menu",payload:"none"}),this.userController.logout()}};var nC=__dcg_shared_module_exports__['h'](z());var pr=__dcg_shared_module_exports__['h'](z());var oC=__dcg_shared_module_exports__['h'](z());xt();var{If:k8e}=oC.Components;var{For:MU,If:yT,IfDefined:qre,Switch:Kre}=pr.Components,xT=class extends pr.Class{template(){return pr.createElement(MU,{each:this.props.options,key:e=>`${e.key?e.key:e.title()}${e.disabled?"-disabled":""}`},pr.createElement("div",{role:pr.const("list"),class:()=>{var e,t;return{"dcg-shared-options-dropdown":!0,[((t=(e=this.props).class)==null?void 0:t.call(e))||""]:!!this.props.class}}},e=>pr.createElement("div",{role:pr.const("listitem"),class:pr.const("dropdown-option-container")},pr.createElement(Kre,{key:()=>e},t=>"href"in t?pr.createElement("a",{"aria-disabled":()=>t.disabled,class:()=>({[t.class||""]:!!t.class,"dcg-standard-link-styling":!t.class,"dropdown-choice":!0,"dropdown-choice-disabled":t.disabled}),onTap:()=>!t.disabled&&this.props.onTap(t),href:()=>t.href,target:()=>t.target!==void 0?t.target:"",rel:()=>t.noreferrer?"noreferrer noopener":""},pr.createElement(yT,{predicate:()=>t.icon!=null},()=>pr.createElement("div",{class:pr.const("option-icon-container")},pr.createElement("i",{"aria-hidden":pr.const("true"),class:()=>`${t.icon} option-icon`}))),t.title):pr.createElement("div",{role:pr.const("link"),tabindex:pr.const(0),"aria-disabled":()=>t.disabled,class:()=>({[t.class||""]:!!t.class,"dcg-standard-link-styling":!t.class,"dropdown-choice":!0,"dropdown-choice-disabled":t.disabled}),onTap:()=>!t.disabled&&this.props.onTap(t)},pr.createElement(yT,{predicate:()=>t.icon!=null},()=>pr.createElement("div",{class:pr.const("option-icon-container")},pr.createElement("i",{"aria-hidden":pr.const("true"),class:()=>`${t.icon} option-icon`}))),pr.createElement("span",{class:pr.const("option-title")},t.title),qre(()=>t.subtitle&&t.subtitle(),i=>pr.createElement("span",{class:pr.const("option-subtitle")},i)))),pr.createElement(yT,{predicate:()=>!!e.explanations},()=>pr.createElement(MU,{each:()=>e.explanations||[],key:t=>t.flag},pr.createElement("div",{class:pr.const("dropdown-explanations")},t=>pr.createElement("div",{class:pr.const("explanation")},()=>t.explanation,pr.const(" "),pr.createElement(yT,{predicate:()=>!!t.link},()=>pr.createElement("a",{class:pr.const("learn-more"),href:()=>t.link!==void 0?t.link:"",target:pr.const("_blank")},()=>t.linkText?t.linkText:wo("shared-button-learn-more-capitalized"))))))))))}};var zre=28,Ure=10,bO=4,wT=class extends nC.Class{template(){return nC.createElement(ps,{type:this.const("graph-actions"),label:()=>this.props.controller().s("account-shell-label-graph-actions"),controller:this.props.controller,left:()=>this.left,arrowLeft:()=>this.arrowLeft},nC.createElement(xT,{class:this.const("dcg-graph-actions-list"),options:this.bindFn(this.getOptions),onTap:this.bindFn(this.tapOption)}))}didMount(){var n,a,s,l;let e=document.querySelector(".dcg-graph-actions-dropdown-anchor"),t=((a=(n=ao(e))==null?void 0:n.left)!=null?a:0)+((s=e.getBoundingClientRect().width)!=null?s:0)/2,o=((l=document.querySelector(".dcg-graph-actions-container").getBoundingClientRect().width)!=null?l:0)-zre/2-Ure;t<=o+bO?(this.left=`${bO}px`,this.arrowLeft=`${t-bO}px`):(this.left=`${t-o}px`,this.arrowLeft=`${o}px`),this.update()}getOptions(){let e=[];return e.push({title:()=>this.props.controller().s("account-shell-button-rename"),icon:"dcg-icon-pencil",class:"dcg-blue-link",action:()=>{this.props.controller().dispatch({type:"show-modal",modal:"rename",device:"mouse"})}}),this.props.controller().graphsController.wasCurrentGraphEverSaved()&&e.push({title:()=>this.props.controller().s("account-shell-button-duplicate"),icon:"dcg-icon-duplicate",action:()=>this.props.controller().dispatch({type:"show-modal",modal:"duplicate",device:"mouse"})},{title:()=>this.props.controller().s("account-shell-button-delete"),icon:"dcg-icon-remove",class:"dcg-red-link",action:()=>{this.props.controller().dispatch({type:"show-modal",modal:"delete",device:"mouse"})}}),e}tapOption(e){e.action!==void 0&&e.action(),!e.preventClose&&("href"in e?e.isDeepLink&&setTimeout(()=>this.closeMenu()):this.closeMenu())}closeMenu(){this.props.controller().dispatch({type:"toggle-menu",payload:"graph-actions"})}};var hc=__dcg_shared_module_exports__['h'](z());var zt=__dcg_shared_module_exports__['h'](z());var yO={};(function r(e,t,i,o){var n=!!(e.Worker&&e.Blob&&e.Promise&&e.OffscreenCanvas&&e.OffscreenCanvasRenderingContext2D&&e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype.transferControlToOffscreen&&e.URL&&e.URL.createObjectURL);function a(){}function s(b){var A=t.exports.Promise,E=A!==void 0?A:e.Promise;return typeof E=="function"?new E(b):(b(a,a),null)}var l=function(){var b=Math.floor(16.666666666666668),A,E,J={},j=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(A=function(ce){var te=Math.random();return J[te]=requestAnimationFrame(function pe(he){j===he||j+b-1<he?(j=he,delete J[te],ce()):J[te]=requestAnimationFrame(pe)}),te},E=function(ce){J[ce]&&cancelAnimationFrame(J[ce])}):(A=function(ce){return setTimeout(ce,b)},E=function(ce){return clearTimeout(ce)}),{frame:A,cancel:E}}(),c=function(){var b,A,E={};function J(j){function ce(te,pe){j.postMessage({options:te||{},callback:pe})}j.init=function(pe){var he=pe.transferControlToOffscreen();j.postMessage({canvas:he},[he])},j.fire=function(pe,he,ae){if(A)return ce(pe,null),A;var ie=Math.random().toString(36).slice(2);return A=s(function(de){function Ie(Se){Se.data.callback===ie&&(delete E[ie],j.removeEventListener("message",Ie),A=null,ae(),de())}j.addEventListener("message",Ie),ce(pe,ie),E[ie]=Ie.bind(null,{data:{callback:ie}})}),A},j.reset=function(){j.postMessage({reset:!0});for(var pe in E)E[pe](),delete E[pe]}}return function(){if(b)return b;if(!i&&n){var j=["var CONFETTI, SIZE = {}, module = {};","("+r.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{b=new Worker(URL.createObjectURL(new Blob([j])))}catch(ce){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("\u{1F38A} Could not load worker",ce),null}J(b)}return b}}(),p={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function u(b,A){return A?A(b):b}function m(b){return b!=null}function h(b,A,E){return u(b&&m(b[A])?b[A]:p[A],E)}function x(b){return b<0?0:Math.floor(b)}function C(b,A){return Math.floor(Math.random()*(A-b))+b}function D(b){return parseInt(b,16)}function k(b){return b.map(M)}function M(b){var A=String(b).replace(/[^0-9a-f]/gi,"");return A.length<6&&(A=A[0]+A[0]+A[1]+A[1]+A[2]+A[2]),{r:D(A.substring(0,2)),g:D(A.substring(2,4)),b:D(A.substring(4,6))}}function I(b){var A=h(b,"origin",Object);return A.x=h(A,"x",Number),A.y=h(A,"y",Number),A}function S(b){b.width=document.documentElement.clientWidth,b.height=document.documentElement.clientHeight}function V(b){var A=b.getBoundingClientRect();b.width=A.width,b.height=A.height}function P(b){var A=document.createElement("canvas");return A.style.position="fixed",A.style.top="0px",A.style.left="0px",A.style.pointerEvents="none",A.style.zIndex=b,A}function L(b,A,E,J,j,ce,te,pe,he){b.save(),b.translate(A,E),b.rotate(ce),b.scale(J,j),b.arc(0,0,1,te,pe,he),b.restore()}function B(b){var A=b.angle*(Math.PI/180),E=b.spread*(Math.PI/180);return{x:b.x,y:b.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:b.startVelocity*.5+Math.random()*b.startVelocity,angle2D:-A+(.5*E-Math.random()*E),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:b.color,shape:b.shape,tick:0,totalTicks:b.ticks,decay:b.decay,drift:b.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:b.gravity*3,ovalScalar:.6,scalar:b.scalar}}function R(b,A){A.x+=Math.cos(A.angle2D)*A.velocity+A.drift,A.y+=Math.sin(A.angle2D)*A.velocity+A.gravity,A.wobble+=A.wobbleSpeed,A.velocity*=A.decay,A.tiltAngle+=.1,A.tiltSin=Math.sin(A.tiltAngle),A.tiltCos=Math.cos(A.tiltAngle),A.random=Math.random()+2,A.wobbleX=A.x+10*A.scalar*Math.cos(A.wobble),A.wobbleY=A.y+10*A.scalar*Math.sin(A.wobble);var E=A.tick++/A.totalTicks,J=A.x+A.random*A.tiltCos,j=A.y+A.random*A.tiltSin,ce=A.wobbleX+A.random*A.tiltCos,te=A.wobbleY+A.random*A.tiltSin;if(b.fillStyle="rgba("+A.color.r+", "+A.color.g+", "+A.color.b+", "+(1-E)+")",b.beginPath(),A.shape==="circle")b.ellipse?b.ellipse(A.x,A.y,Math.abs(ce-J)*A.ovalScalar,Math.abs(te-j)*A.ovalScalar,Math.PI/10*A.wobble,0,2*Math.PI):L(b,A.x,A.y,Math.abs(ce-J)*A.ovalScalar,Math.abs(te-j)*A.ovalScalar,Math.PI/10*A.wobble,0,2*Math.PI);else if(A.shape==="star")for(var pe=Math.PI/2*3,he=4*A.scalar,ae=8*A.scalar,ie=A.x,de=A.y,Ie=5,Se=Math.PI/Ie;Ie--;)ie=A.x+Math.cos(pe)*ae,de=A.y+Math.sin(pe)*ae,b.lineTo(ie,de),pe+=Se,ie=A.x+Math.cos(pe)*he,de=A.y+Math.sin(pe)*he,b.lineTo(ie,de),pe+=Se;else b.moveTo(Math.floor(A.x),Math.floor(A.y)),b.lineTo(Math.floor(A.wobbleX),Math.floor(j)),b.lineTo(Math.floor(ce),Math.floor(te)),b.lineTo(Math.floor(J),Math.floor(A.wobbleY));return b.closePath(),b.fill(),A.tick<A.totalTicks}function W(b,A,E,J,j){var ce=A.slice(),te=b.getContext("2d"),pe,he,ae=s(function(ie){function de(){pe=he=null,te.clearRect(0,0,J.width,J.height),j(),ie()}function Ie(){i&&!(J.width===o.width&&J.height===o.height)&&(J.width=b.width=o.width,J.height=b.height=o.height),!J.width&&!J.height&&(E(b),J.width=b.width,J.height=b.height),te.clearRect(0,0,J.width,J.height),ce=ce.filter(function(Se){return R(te,Se)}),ce.length?pe=l.frame(Ie):de()}pe=l.frame(Ie),he=de});return{addFettis:function(ie){return ce=ce.concat(ie),ae},canvas:b,promise:ae,reset:function(){pe&&l.cancel(pe),he&&he()}}}function re(b,A){var E=!b,J=!!h(A||{},"resize"),j=h(A,"disableForReducedMotion",Boolean),ce=n&&!!h(A||{},"useWorker"),te=ce?c():null,pe=E?S:V,he=b&&te?!!b.__confetti_initialized:!1,ae=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,ie;function de(Se,ot,Ze){for(var at=h(Se,"particleCount",x),Vt=h(Se,"angle",Number),Dt=h(Se,"spread",Number),Mr=h(Se,"startVelocity",Number),Ot=h(Se,"decay",Number),Le=h(Se,"gravity",Number),fo=h(Se,"drift",Number),Wi=h(Se,"colors",k),fe=h(Se,"ticks",Number),Yo=h(Se,"shapes"),tt=h(Se,"scalar"),ft=I(Se),gt=at,xe=[],Pt=b.width*ft.x,Fe=b.height*ft.y;gt--;)xe.push(B({x:Pt,y:Fe,angle:Vt,spread:Dt,startVelocity:Mr,color:Wi[gt%Wi.length],shape:Yo[C(0,Yo.length)],ticks:fe,decay:Ot,gravity:Le,drift:fo,scalar:tt}));return ie?ie.addFettis(xe):(ie=W(b,xe,pe,ot,Ze),ie.promise)}function Ie(Se){var ot=j||h(Se,"disableForReducedMotion",Boolean),Ze=h(Se,"zIndex",Number);if(ot&&ae)return s(function(Mr){Mr()});E&&ie?b=ie.canvas:E&&!b&&(b=P(Ze),document.body.appendChild(b)),J&&!he&&pe(b);var at={width:b.width,height:b.height};te&&!he&&te.init(b),he=!0,te&&(b.__confetti_initialized=!0);function Vt(){if(te){var Mr={getBoundingClientRect:function(){if(!E)return b.getBoundingClientRect()}};pe(Mr),te.postMessage({resize:{width:Mr.width,height:Mr.height}});return}at.width=at.height=null}function Dt(){ie=null,J&&e.removeEventListener("resize",Vt),E&&b&&(document.body.removeChild(b),b=null,he=!1)}return J&&e.addEventListener("resize",Vt,!1),te?te.fire(Se,at,Dt):de(Se,at,Dt)}return Ie.reset=function(){te&&te.reset(),ie&&ie.reset()},Ie}var ne;function X(){return ne||(ne=re(null,{useWorker:!0,resize:!0})),ne}t.exports=function(){return X().apply(this,arguments)},t.exports.reset=function(){X().reset()},t.exports.create=re})(function(){return typeof window!="undefined"?window:typeof self!="undefined"?self:this||{}}(),yO,!1);var K8e=yO.exports,AU=yO.exports.create;var Qr=__dcg_shared_module_exports__['h'](z());var vT=class extends Qr.Class{init(){this.tourController=this.props.tourController(),this.controller=this.tourController.controller}launchConfetti(){var e;if(this.props.showAnimation()){let t=document.createElement("canvas");t.id="dcg-quest-success-canvas",t.width=window.innerWidth,t.height=window.innerHeight,(e=document.querySelector("#dcg-quest-success-container .dcg-shared-modal-transition-container"))==null||e.before(t),AU(t,{resize:!0,useWorker:!0})({particleCount:150,spread:60,colors:["#d53b90","#af2067","#ff8856"]})}}template(){return Qr.createElement("div",{id:Qr.const("dcg-quest-success-container")},Qr.createElement(ko,{title:this.const(""),size:this.const("narrow"),class:this.const("dcg-quest__success"),showX:this.const(!0),onClose:()=>this.tourController.closeSuccessModal(),i18n:()=>this.controller,ariaLabel:()=>this.controller.s("account-shell-label-success")},Qr.createElement("div",{class:Qr.const("dcg-quest-success-interior"),didMount:()=>this.launchConfetti()},Qr.createElement("div",{class:Qr.const("dcg-quest-success-image")},Qr.createElement("img",{src:()=>{var e;return`/assets/img/quests/${(e=this.tourController.getCurrentQuest())==null?void 0:e.thumb}`},width:Qr.const("120"),height:Qr.const("120"),alt:()=>{var e;return this.controller.s("graphing-tours-narration-quest-thumbnail",{title:this.controller.raw(((e=this.tourController.getCurrentQuest())==null?void 0:e.title)||"")})}})),Qr.createElement("div",{class:Qr.const("dcg-quest-success-content")},Qr.createElement("h1",{class:Qr.const("dcg-unstyled-heading")},()=>this.controller.s("account-shell-label-success")),Qr.createElement("div",{class:Qr.const("quest-title")},()=>{var e;return this.controller.s("graphing-tours-heading-quest-success",{title:this.controller.raw(((e=this.tourController.getCurrentQuest())==null?void 0:e.title)||"")})}),Qr.createElement("div",{class:Qr.const("dcg-modal-actions")},Qr.createElement("button",{class:Qr.const("dcg-btn-gray-outline"),onTap:()=>this.tourController.stopQuest()},()=>this.controller.s("graphing-tours-label-close-quests")),Qr.createElement("button",{class:Qr.const("dcg-btn-pink"),onTap:()=>this.tourController.startNextQuest()},()=>this.controller.s("account-shell-link-try-next-quest"))),Qr.createElement("div",{class:Qr.const("dcg-footer-option")},Qr.createElement(si,{i18n:this.const(this.controller),key:this.const("account-shell-text-continue-with-quest")},Qr.const("...or"),Qr.const(" "),Qr.createElement("button",{class:Qr.const("dcg-unstyled-button dcg-blue-link"),onTap:()=>this.tourController.closeSuccessModal()},Qr.const("keep playing with this quest")),Qr.const(".")))))))}};var uc=__dcg_shared_module_exports__['h'](z());var CT=class extends uc.Class{init(){this.controller=this.props.controller()}template(){return uc.createElement("li",{class:()=>({"dcg-list-item":!0,"dcg-active":this.props.validationStatus()==="validating"})},uc.createElement("div",{class:uc.const("dcg-quest__step-status-container")},uc.createElement("div",{class:()=>({"dcg-quest__step-status":!0,"dcg-unvalidated":this.props.validationStatus()==="unvalidated","dcg-validating":this.props.validationStatus()==="validating","dcg-satisfied":this.props.validationStatus()==="satisfied","dcg-unsatisfied":this.props.validationStatus()==="unsatisfied"})},uc.createElement("div",{class:uc.const("dcg-validation-checkmark")}))),uc.createElement("div",{class:uc.const("dcg-quest__step-text")},this.props.title))}};var Pn=__dcg_shared_module_exports__['h'](z());var aC=__dcg_shared_module_exports__['h'](z());var{IfDefined:Wre}=aC.Components,np=class extends rC{constructor(){super(...arguments),this.currentStepIndex=0,this.currentSubStepIndex=0,this.steps=[]}editListMode(){return this.controller.isInEditListMode()}requireNotEditListMode(){return{type:"guardrail-only",shouldAdvance:()=>!this.controller.isInEditListMode(),getBlock:()=>({position:"s",content:this.controller.s("graphing-tours-label-require-not-edit-list-mode"),target:{element:document.querySelector(".dcg-action-toggle-edit")}})}}expressionsVisible(){return this.controller.isListVisible()}requireExpressionsVisible(){return{type:"guardrail-only",shouldAdvance:()=>this.expressionsVisible(),getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-require-expressions-visible"),target:{element:document.querySelector(".dcg-show-expressions-tab")}})}}resourcesOpen(){var e;return!!((e=document.querySelector("body"))!=null&&e.classList.contains("resources-open"))}requireResourcesNotOpen(){return{type:"guardrail-only",shouldAdvance:()=>!this.resourcesOpen(),getBlock:()=>({position:"e",content:this.controller.s("graphing-tours-label-require-resources-not-open"),target:{element:document.querySelector(".dcg-action-opendrawer")}})}}advanceTour(){if(this.isLastStep())return;let e=!1;do this.currentSubStepIndex===this.steps[this.currentStepIndex].length-1?(this.currentStepIndex++,this.currentSubStepIndex=0,e=!0):this.currentSubStepIndex++;while(this.steps[this.currentStepIndex][this.currentSubStepIndex].shouldAdvance()&&!this.isLastStep());e&&Qt("tour::step",{tourId:this.props.id(),step:this.currentStepIndex+1})}checkGuardrails(){let{currentStepIndex:e,currentSubStepIndex:t}=this,i,o;for(i=0;i<=e;i++)if(o=this.steps[i].find((n,a)=>((n.type==="guardrail"||n.type==="guardrail-only")&&(i<e||a<t)||(n.type==="guardrail-only--this-step"||n.type==="guardrail--this-step")&&i===e&&a<t)&&!n.shouldAdvance()),o)return o}getCurrentStep(){if(!(!this.steps||this.steps.length===0||this.currentStepIndex>=this.steps.length||this.currentSubStepIndex>=this.steps[this.currentStepIndex].length))return this.steps[this.currentStepIndex][this.currentSubStepIndex]}isLastStep(){return this.currentStepIndex===this.steps.length-1&&this.currentSubStepIndex===this.steps[this.currentStepIndex].length-1}getTourStep(){var o;let e=this.getCurrentStep();if(!e)return;let t=!1;e.shouldAdvance()&&(t=!0,this.advanceTour());let i=(o=this.checkGuardrails())!=null?o:this.getCurrentStep();return i?(i.updateEveryTick?t&&this.clockBusId===void 0&&(this.clockBusId=Ls(()=>this.update())):this.clockBusId!==void 0&&(Os(this.clockBusId),this.clockBusId=void 0),i.getBlock()):this.curTripBlock}willUpdate(){var t;let e=this.getTourStep();e&&(this.curTripBlock=e),this.isLastStep()&&((t=this.getCurrentStep())!=null&&t.shouldAdvance())&&setTimeout(()=>this.tourController.stopTour())}onMount(){this.updateListener||(this.updateListener=this.controller.subscribeToChanges(__dcg_shared_module_exports__['K'](()=>{this._isMounted&&this.update()},600)))}willUnmount(){this.updateListener!==void 0&&(this.updateListener(),this.updateListener=void 0),this.clockBusId!==void 0&&Os(this.clockBusId),this.tourController.clearTimeouts()}template(){return aC.createElement("div",null,Wre(()=>this.curTripBlock,e=>aC.createElement(oy,{tourController:this.props.tourController,controller:this.props.controller,content:()=>e().content,header:()=>e().header,innerHTML:()=>e().innerHTML,position:()=>e().position,target:()=>e().target})))}};var DT=class extends np{constructor(){super(...arguments);this.steps=[[this.requireExpressionsVisible(),this.requireNotEditListMode(),{shouldAdvance:()=>!!document.querySelector(".dcg-extend-to-3d"),getBlock:()=>({position:"e",content:"Start by graphing a 2-dimensional equation, like y=2x+3",target:{element:this.getAvailableExp()}}),type:"guardrail"},{shouldAdvance:()=>!document.querySelector(".dcg-extend-to-3d .dcg-component-checkbox.dcg-checked"),getBlock:()=>({position:"e",content:"This graph was extended to 3D, so it shows every (x,y,z) value that satisfies the equation, not just the ones in the plane where z=0.",target:{element:this.getMatchingExpNode(pT)}})},{shouldAdvance:()=>this.hasMatchingExpression(pT),getBlock:()=>({position:"s",content:this.raw("Check this box to see the surface."),target:{selector:".dcg-extend-to-3d .dcg-component-checkbox:not(.dcg-checked) .dcg-checkbox"}})}]]}};var ST=class extends np{constructor(){super(...arguments);this.steps=[[this.requireExpressionsVisible(),{shouldAdvance:()=>document.getElementsByClassName("dcg-colored-icon").length>0,getBlock:()=>({position:"e",content:"Start by graphing something. For example, type (1,2,0) to plot a point",target:{element:this.getAvailableExp()}}),type:"guardrail"},{shouldAdvance:()=>{var t;return((t=this.controller.getOpenItemMenu())==null?void 0:t.type)==="expression"},getBlock:()=>({position:"e",content:this.raw("To open display properties, click and hold on the icon."),target:{element:document.getElementsByClassName("dcg-colored-icon")[0]}}),type:"guardrail"},{shouldAdvance:()=>{let t=this.controller.getOpenItemMenu();return(t==null?void 0:t.type)!=="expression"?!1:this.currentlySelectedColor?t.model.color!==this.currentlySelectedColor:(this.currentlySelectedColor=t.model.color,!1)},getBlock:()=>({position:"e",content:this.raw("Click on a new tile to change the color."),target:{selector:".dcg-color-picker-container"}})}]]}};var kT=class extends np{constructor(){super(...arguments);this.steps=[[this.requireExpressionsVisible(),this.requireNotEditListMode(),{shouldAdvance:()=>this.hasMatchingExpression(ad),getBlock:()=>({position:"e",content:"To create a slider, type something like a=1",target:{element:this.getAvailableExp()}}),type:"guardrail"},{shouldAdvance:()=>{let t=this.getMatchingExpModel(ad);if(!t||t.type!=="expression")return!1;let i=t.latex.match(/(\w+)\=/);if(!i)return!1;let o=i[1];return this.hasMatchingExpression([Zv(o)],[t.id])},getBlock:()=>{let t=this.getMatchingExpIds(ad);return{position:"e",content:"Now use that new parameter somewhere else in this graph.",target:{element:this.getAvailableExp(t)}}},type:"guardrail"},{shouldAdvance:()=>!this.hasMatchingExpression(eC),getBlock:()=>({position:"e",content:'This graph already has a slider! Drag it to change the value, or press "play" to animate.',target:{updatePosition:"never",element:this.getMatchingExpNode(ad)}})},{shouldAdvance:()=>this.hasMatchingExpression(eC),getBlock:()=>{var t;return{position:"s",content:"Drag the handle to watch your graph update.",target:{updatePosition:"never",element:(t=this.getMatchingExpNode(ad))==null?void 0:t.querySelector(".dcg-slider-container .dcg-thumb .dcg-graphic")}}}}]]}};var ET=class extends np{constructor(){super(...arguments);this.steps=[[{shouldAdvance:()=>this.controller.getState().graph.showAxis3D!==!1||document.getElementsByClassName("dcg-settings-container").length>0,getBlock:()=>({position:"w",content:"The axes are already off. To turn them on, or adjust other settings, click on this wrench.",target:{selector:".dcg-action-settings"}})},{shouldAdvance:()=>document.getElementsByClassName("dcg-settings-container").length>0||this.controller.getState().graph.showAxis3D===!1,getBlock:()=>({position:"w",content:this.raw("To change graph settings, click on this wrench."),target:{selector:".dcg-action-settings"}}),type:"guardrail"},{shouldAdvance:()=>this.controller.getState().graph.showAxis3D===!1,getBlock:()=>({position:"s",content:this.raw("Click here to turn off the axes, plane, and labels all at once."),target:{selector:".dcg-toggle-switch"}})}]]}};var ly={change_color_3d:{tour:ST,titleKey:"graphing-tours-label-change-color",thumb:"change-color-2x.png"},change_line_to_surface:{tour:DT,titleKey:"graphing-tours-label-show-surface",thumb:"show-3D-surface-2x.png"},add_slider:{tour:kT,titleKey:"graphing-tours-label-add-slider",thumb:"add-slider-2x.png"},turn_off_axes:{tour:ET,titleKey:"graphing-tours-label-turn-off-axes",thumb:"turn-off-axes-2x.png"}};var{Each:$re}=Pn.Components,GT=class extends Pn.Class{init(){this.tourController=this.props.tourController(),this.controller=this.tourController.controller}template(){return Pn.createElement("div",{class:Pn.const("dcg-mini-tours-container")},Pn.createElement("h2",{class:Pn.const("dcg-unstyled-heading"),id:Pn.const("dcg-quest-mini-tours-heading")},()=>this.controller.s("graphing-tours-label-quest-tours")),Pn.createElement("ul",{class:Pn.const("dcg-quest-mini-tours dcg-unstyled-list"),"aria-labelledby":Pn.const("#dcg-quest-mini-tours-heading")},$re(()=>this.getMiniTours(),{item:e=>Pn.createElement("li",null,Pn.createElement("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-tour-tile":!0,"dcg-active":this.tourController.getActiveMinitour()===e}),"aria-current":()=>this.tourController.getActiveMinitour()===e,onTap:()=>this.onTapMinitour(e),manageFocus:this.const(Qe({controller:this.controller,location:{type:"quest",location:"mini-tour-button",tour:e}}))},Pn.createElement("img",{src:()=>`/assets/img/quests/${ly[e].thumb}`,width:Pn.const("90"),height:Pn.const("90"),alt:()=>this.controller.s("graphing-tours-narration-tour-thumbnail",{title:this.getTourTitle(e)})}),Pn.createElement("div",{class:Pn.const("dcg-tour-title")},()=>this.getTourTitle(e))))})))}getTourTitle(e){return this.controller.s(ly[e].titleKey)}onTapMinitour(e){this.tourController.getActiveMinitour()===e?this.tourController.stopTour():this.tourController.startMiniTour(e)}getMiniTours(){var e;return((e=this.tourController.getCurrentQuest())==null?void 0:e.hintMiniTours)||[]}};var{For:jre,If:sC}=zt.Components,TT=class extends zt.Class{constructor(){super(...arguments),this.resizeListener=()=>{this.clampPosition()}}init(){this.tourController=this.props.tourController(),this.controller=this.tourController.controller}startDrag(e){e.device!=="keyboard"&&e.target&&(e.preventDefault(),Kr(),this.previousCursor=document.body.style.cursor,document.body.style.setProperty("cursor","move","important"),this.dragDrop.startDrag(e))}onMountRoot(e){this.dragDrop=new Sb;let t=this.tourController.getQuestWindowPos();t&&(this.setPosition(t.left,t.top),this.cachePosition()),this.dragDrop.observeEvent("onDrop",()=>{this.isDragging=!1,document.body.style.cursor=this.previousCursor,this.cachedPos&&this.tourController.setQuestWindowPos(this.cachedPos.left,this.cachedPos.top),this.update()}),this.dragDrop.observeEvent("onGrab",()=>{this.cachePosition(),this.isDragging=!0}),this.dragDrop.observeEvent("onDrag",(i,o)=>{this.updatePosition(o.dx,o.dy)}),window.addEventListener("resize",this.resizeListener),this.resizeObserver=new ResizeObserver(()=>this.resizeListener()),this.resizeObserver.observe(e)}willUnmount(){this.resizeObserver.disconnect(),window.removeEventListener("resize",this.resizeListener)}getQuestNode(){var e;return(e=this.findRootNode())==null?void 0:e.querySelector(".dcg-quest")}cachePosition(){var t;let e=(t=this.getQuestNode())==null?void 0:t.getBoundingClientRect();e&&(this.cachedPos={left:e.left,top:e.top,width:e.width,height:e.height})}setPosition(e,t){let i=this.getQuestNode();i&&(i.style.bottom="unset",i.style.right="unset",i.style.top=`${t}px`,i.style.left=`${e}px`)}clampPosition(){var n;let e=this.getQuestNode(),t=e==null?void 0:e.getBoundingClientRect();if(!t)return;let i=(n=document.getElementById("dcg-header-container"))==null?void 0:n.getBoundingClientRect(),o=i?i.height:0;e.style.top&&e.style.top!=="unset"&&t.top>window.innerHeight-t.height-5&&(e.style.top=`${Math.max(o+5,window.innerHeight-t.height-5)}px`),e.style.left&&e.style.left!=="unset"&&t.left>window.innerWidth-t.width-5&&(e.style.left=`${Math.max(5,window.innerWidth-t.width-5)}px`)}updatePosition(e,t){var n;if(this.cachedPos||this.cachePosition(),!this.cachedPos)return;let i=(n=document.getElementById("dcg-header-container"))==null?void 0:n.getBoundingClientRect(),o=i?i.height:0;this.setPosition(__dcg_shared_module_exports__['Ab'](this.cachedPos.left+e,5,window.innerWidth-this.cachedPos.width-5),__dcg_shared_module_exports__['Ab'](this.cachedPos.top+t,o+5,window.innerHeight-this.cachedPos.height-5))}getPaneTabIndex(){let e=this.controller.getFocusLocation();if(e&&e.type==="quest"&&e.location==="quest-pane")return 0}template(){return zt.createElement("div",null,zt.createElement(sC,{predicate:()=>this.tourController.getSuccessModalIsOpen()},()=>zt.createElement(vT,{tourController:this.props.tourController,showAnimation:()=>!Fm})),zt.createElement("aside",{class:()=>({"dcg-quest":!0,"dcg-closing":!!this.tourController.getCurrentQuestIsClosing()}),id:zt.const("dcg-quest"),"aria-labelledby":zt.const("dcg-quest__title"),"aria-describedby":zt.const("dcg-quest__instructions"),onMount:this.bindFn(this.onMountRoot),tabIndex:this.bindFn(this.getPaneTabIndex),manageFocus:this.const(Qe({controller:this.controller,location:{type:"quest",location:"quest-pane"}}))},zt.createElement("div",{class:zt.const("dcg-quest__header"),onTapStart:this.bindFn(this.startDrag)},zt.createElement("h1",{class:zt.const("dcg-title"),id:zt.const("dcg-quest__title")},()=>{var e;return(e=this.tourController.getCurrentQuest())==null?void 0:e.title}),zt.createElement("div",{class:zt.const("dcg-sr-only"),id:zt.const("dcg-quest__instructions")},()=>this.controller.raw("Press F6 to switch keyboard focus back and forth between this quest and the calculator.")),zt.createElement("button",{class:zt.const("dcg-tours-btn dcg-btn-gray-outline"),manageFocus:this.const(Qe({controller:this.controller,location:{type:"quest",location:"close-button"}})),"aria-label":()=>this.controller.s("graphing-tours-label-close-quest"),onTap:()=>{this.tourController.stopQuest()}},()=>this.controller.s("graphing-tours-label-close-quest"))),zt.createElement("div",{class:zt.const("dcg-quest__body")},zt.createElement(sC,{predicate:()=>!this.tourController.getHintsVisible()},()=>zt.createElement("div",null,zt.createElement("div",{class:zt.const("dcg-quest__prompt")},()=>{var e;return(e=this.tourController.getCurrentQuest())==null?void 0:e.prompt}),zt.createElement(jre,{each:()=>this.tourController.getQuestGoals(),key:e=>e.text},zt.createElement("ul",{class:zt.const("dcg-unstyled-list dcg-quest__steps")},e=>zt.createElement(CT,{validationStatus:()=>this.tourController.getGoalValidationStatus(e),title:()=>e.text,controller:()=>this.controller}))))),zt.createElement(sC,{predicate:()=>this.tourController.getHintsVisible()},()=>zt.createElement(GT,{tourController:this.props.tourController}))),zt.createElement("div",{class:zt.const("dcg-footer")},zt.createElement("button",{class:()=>({"dcg-main-quest-btn":!0,"dcg-btn-gray-outline":this.tourController.getHintsVisible(),"dcg-btn-pink":!this.tourController.getHintsVisible(),"dcg-disabled":this.validationButtonDisabled()}),disabled:()=>this.validationButtonDisabled()?!0:void 0,onTap:()=>this.tourController.getHintsVisible()?this.tourController.setHintsVisible(!1):!this.validationButtonDisabled()&&this.tourController.checkQuestGoals(),manageFocus:this.const(Qe({controller:this.controller,location:{type:"quest",location:"check-button"}}))},zt.createElement(sC,{predicate:()=>this.tourController.getHintsVisible()},()=>zt.createElement("i",{class:zt.const("dcg-icon-chevron-left"),"aria-hidden":zt.const("true")})),()=>this.tourController.getHintsVisible()?this.controller.s("graphing-tours-label-quest-back-to-quest"):this.controller.s("graphing-tours-label-check-progress")),zt.createElement(sC,{predicate:()=>{var e;return(((e=this.tourController.getCurrentQuest())==null?void 0:e.hintMiniTours)||[]).length>0}},()=>zt.createElement(Me,{gravity:this.const("n"),tooltip:()=>this.tourController.getHintsVisible()?this.controller.s("graphing-tours-label-quest-back-to-quest"):this.controller.s("graphing-tours-label-quest-take-a-tour")},zt.createElement("button",{class:()=>({"dcg-unstyled-button":!0,"dcg-gray-outline-icon":!0,"dcg-active":this.tourController.getHintsVisible()}),"aria-label":()=>this.tourController.getHintsVisible()?this.controller.s("graphing-tours-label-quest-back-to-quest"):this.controller.s("graphing-tours-label-quest-tours-aria"),onTap:()=>{this.tourController.setHintsVisible(!this.tourController.getHintsVisible())},manageFocus:this.const(Qe({controller:this.controller,location:{type:"quest",location:"hints-button"}}))},zt.createElement("i",{class:zt.const("dcg-icon-map"),"aria-hidden":zt.const("true")})))))))}validationButtonDisabled(){let e=this.tourController.getQuestValidationStatus();return e==="validating"||e==="complete"&&this.tourController.getSuccessModalIsOpen()}};var eo=__dcg_shared_module_exports__['h'](z());var{For:Yre}=eo.Components,IT=class extends eo.Class{init(){this.tourController=this.props.tourController(),this.controller=this.tourController.controller}template(){return eo.createElement(ko,{title:()=>this.controller.s("account-shell-label-try-a-quest-title"),size:this.const("narrow"),class:this.const("dcg-quests-modal"),showX:this.const(!0),onClose:this.bindFn(this.closeModal),i18n:()=>this.controller},eo.createElement(Yre,{each:()=>Object.keys(rl)},eo.createElement("ul",{class:eo.const("dcg-all-quest-buttons dcg-unstyled-list")},e=>eo.createElement("li",null,eo.createElement("a",{class:eo.const("dcg-quest-button"),tabindex:eo.const("0"),role:eo.const("link"),onTap:()=>this.launchQuest(e)},eo.createElement("img",{width:eo.const("180"),height:eo.const("180"),alt:()=>this.controller.s("graphing-tours-narration-quest-thumbnail",{title:this.controller.raw(rl[e].title)}),src:()=>`/assets/img/quests/${rl[e].thumb}`}),eo.createElement("div",null,()=>this.controller.raw(rl[e].title)))))),eo.createElement("div",{class:eo.const("dcg-quests-disclaimer")},eo.const("Quests are an experimental new feature. Please share your thoughts with us at"),eo.const(" "),eo.createElement("a",{class:eo.const("dcg-blue-link"),href:eo.const("mailto:feedback@desmos.com")},eo.const("feedback@desmos.com")),eo.const(".")))}closeModal(){this.tourController.setQuestsListModalVisibility(!1)}launchQuest(e){this.tourController.startQuest(e),this.closeModal()}};var{If:LU}=hc.Components,VT=class extends hc.Class{init(){this.tourController=this.props.tourController(),window.addEventListener("hashchange",this.bindFn(this.update))}isQuestsModalOpen(){return this.tourController.getQuestsListModalIsOpen()}isQuestOpen(){return!!this.tourController.getQuestActive()}onMount(){this.tourController.setRootView(this)}template(){return hc.createElement("div",{id:hc.const("dcg-quest-container")},hc.createElement(LU,{predicate:this.bindFn(this.isQuestsModalOpen)},()=>hc.createElement(IT,{tourController:()=>this.tourController})),hc.createElement(LU,{predicate:this.bindFn(this.isQuestOpen)},()=>hc.createElement(TT,{tourController:()=>this.tourController})))}};var{SwitchUnion:OU}=Ma.Components,MT=class extends Ma.Class{init(){this.controller=this.props.controller()}template(){return Ma.createElement("div",null,Ma.createElement(WG,{controller:this.props.controller}),Ma.createElement(VT,{tourController:()=>this.controller.tourController}),OU(()=>this.getMenu(),{language:()=>Ma.createElement(jG,{controller:this.props.controller}),help:()=>Ma.createElement("div",null,OU(()=>this.props.controller().product,{"geometry-calculator":()=>Ma.createElement(dT,{controller:this.props.controller}),"graphing-3d":()=>Ma.createElement(mT,{controller:this.props.controller}),graphing:()=>Ma.createElement(cT,{controller:this.props.controller}),geometry:()=>Ma.createElement("span",null)})),share:()=>Ma.createElement(bT,{controller:this.props.controller}),account:()=>Ma.createElement(sy,{controller:this.props.controller}),"graph-actions":()=>Ma.createElement(wT,{controller:this.props.controller}),none:()=>Ma.createElement("span",null)}))}getMenu(){return this.controller.mygraphsController.isMygraphsOpen()?"none":this.controller.getOpenMenu()}};var Et=__dcg_shared_module_exports__['h'](z());var xi=__dcg_shared_module_exports__['h'](z());var AT=__dcg_shared_module_exports__['h'](z()),gc=class extends AT.Class{template(){return AT.createElement("div",{class:()=>({modal_section:!0,"dcg-hotkeys-dialog":this.props.controller().getOpenModal()==="hotkeys"})},this.children)}};xt();var{Input:Jre,Checkbox:Xre,If:Qre}=xi.Components,cy=class extends xi.Class{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController,this.lastSavedTitle=this.graphsController.getCurrentGraphTitle(),this.controller.getOpenModal()==="duplicate"?this.newSaveTitle=this.controller.s("account-shell-text-copy-of-title",{originalTitle:this.lastSavedTitle}):this.newSaveTitle=this.lastSavedTitle||this.graphsController.getUntitledString(),this.controller.state.saveDialog==null&&(this.controller.state.saveDialog={copyOnSave:!0})}template(){return xi.createElement(gc,{controller:this.props.controller},xi.createElement("div",{id:xi.const("save-dialog")},xi.createElement("h1",null,()=>this.getTitle()),xi.createElement("div",{class:xi.const("dcg-clear")}),xi.createElement("form",{didMount:this.bindFn(this.didMountForm)},xi.createElement("label",{class:xi.const("input-label")},xi.createElement("div",{class:xi.const("graph-title-title")},()=>this.controller.s("account-shell-label-graph-title"),xi.const("\xA0")),xi.createElement(Jre,{class:xi.const("title-input dcg-input-blue-outline"),name:xi.const("title"),placeholder:()=>this.graphsController.getUntitledString(),value:()=>this.newSaveTitle,maxlength:xi.const("140"),onInput:e=>this.newSaveTitle=e,didMount:e=>H(e).trigger("focus").trigger("select")})),xi.createElement("div",null,xi.createElement("button",{type:xi.const("submit"),class:xi.const("dcg-btn dcg-btn-primary pull-right dcg-action-save")},()=>this.controller.s("account-shell-button-save")),xi.createElement(Qre,{predicate:()=>this.shouldShowDuplicateOption()&&this.graphsController.wasCurrentGraphEverSaved()},()=>xi.createElement("label",{class:xi.const("dcg-new-copy pull-right")},xi.createElement(Xre,{checked:()=>this.controller.state.saveDialog.copyOnSave,onChange:e=>{if(this.controller.state.saveDialog.copyOnSave=e,!this.unmounted)return this.update()}}),xi.createElement("span",{class:xi.const("duplicate-label")},()=>this.getDuplicateLabel())))))))}didUnmount(){this.unmounted=!0}didMountForm(e){H(e).on("submit",t=>{t.preventDefault(),this.newSaveTitle===""&&(this.newSaveTitle="Untitled Graph");let i;this.shouldShowDuplicateOption()?i=this.controller.state.saveDialog.copyOnSave:i=this.controller.getOpenModal()!=="rename",this.controller.dispatch({type:"save-graph",payload:{title:this.newSaveTitle,saveAs:i},device:"mouse"})})}getTitle(){if(this.controller.product==="geometry")return this.controller.s("account-shell-heading-save-construction");switch(this.controller.getOpenModal()){case"rename":return this.controller.s("account-shell-heading-rename-graph");case"save":return this.controller.s("account-shell-heading-save-graph");case"duplicate":return this.controller.s("account-shell-heading-duplicate-graph");default:return""}}getDuplicateLabel(){return this.controller.product==="geometry"?this.controller.s("account-shell-heading-duplicate-construction"):this.controller.s("account-shell-heading-duplicate-graph")}shouldShowDuplicateOption(){if(this.controller.product==="geometry")return!0;let e=this.controller.getModalState();return!!(e.modal==="save"&&e.fromSaveInProgress)}};var ye=__dcg_shared_module_exports__['h'](z());xt();var _n=__dcg_shared_module_exports__['h'](z());var am=class extends _n.Class{template(){return _n.createElement("div",{class:_n.const("dcg-shared-cookie-notice")},_n.createElement(si,{key:this.const("shared-message-cookie-notice"),i18n:this.props.i18n},_n.createElement("b",null,_n.const("Note:")),_n.const(" "),_n.const("Desmos uses cookies to enable persistence when you are signed"),_n.const(" "),_n.const("in. If you do not wish to use cookies, please use Desmos without"),_n.const(" "),_n.const("logging in."),_n.const(" "),_n.createElement("a",{class:_n.const("dcg-shared-cookie-notice-learn-more dcg-gray-link"),href:_n.const("/privacy"),target:_n.const("_blank")},_n.const("Learn More."))))}};var Ol=__dcg_shared_module_exports__['h'](z());var{If:Zre,For:eie}=Ol.Components,Qn=class extends Ol.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller}template(){return Ol.createElement(Zre,{predicate:()=>!!this.props.errors().length},()=>Ol.createElement(eie,{each:this.props.errors},Ol.createElement("span",null,e=>Ol.createElement("div",{class:Ol.const("dcg-shared-account-modal-errors"),role:Ol.const("alert")},Ol.createElement("span",null,()=>this.i18n.raw(e))))))}};var{If:lC,Input:LT,Switch:tie}=ye.Components,OT=0,xO=1,PT=class extends ye.Class{template(){return ye.createElement("span",{class:ye.const("dcg-shared-terms-notice")},ye.createElement(si,{key:this.const("shared-message-privacy-notice"),i18n:this.props.i18n},ye.const("I have read, understand, and accept the"),ye.const(" "),ye.createElement("a",{href:ye.const("/terms"),target:ye.const("_blank"),class:ye.const("dcg-blue-link")},ye.const("Terms of Service")),ye.const(" "),ye.const("and"),ye.const(" "),ye.createElement("a",{href:ye.const("/privacy"),target:ye.const("_blank"),class:ye.const("dcg-blue-link")},ye.const("Privacy Policy")),ye.const(".")))}},_T=class extends ye.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.selectedView=OT,this.givenName="",this.familyName="",this.email="",this.password="",this.consentChecked=!1,this.isSubmittingForm=!1,this.formErrors=[],this.breakPoint=660,this.measureWindow(),this.controller.getModalStartingError()&&this.formErrors.push(this.controller.getModalStartingError())}template(){return ye.createElement(ko,{title:()=>this.i18n.s("shared-title-signup"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},ye.createElement("div",{class:()=>({"dcg-shared-signup-dialog":!0,"dcg-shared-account-dialog":!0})},ye.createElement("div",{class:ye.const("dcg-shared-switch-account-message")},()=>this.i18n.s("shared-prompt-already-have-account"),this.const(this.i18n.raw(" ")),ye.createElement("a",{role:ye.const("link"),tabindex:ye.const("0"),class:ye.const("dcg-gray-link"),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"login",device:e.device})},()=>this.i18n.s("shared-button-login")),ye.const(".")),ye.createElement("div",{class:ye.const("dcg-shared-navigation-tabs"),role:ye.const("tablist")},ye.createElement("div",{role:ye.const("tab"),tabindex:ye.const("0"),"aria-selected":this.bindFn(this.isGoogleSelected),class:()=>({"dcg-shared-tab-gray-underline":!0,"dcg-shared-tab-always-underline":!0,"dcg-shared-profile-view-button":!0,"dcg-selected":this.isGoogleSelected()}),onTap:()=>this.updateView(OT)},this.bindFn(this.externalTitle)),ye.createElement("div",{role:ye.const("tab"),tabindex:ye.const("0"),"aria-selected":this.bindFn(this.isDesmosSelected),class:()=>({"dcg-shared-tab-gray-underline":!0,"dcg-shared-tab-always-underline":!0,"dcg-shared-password-view-button":!0,"dcg-selected":this.isDesmosSelected()}),onTap:()=>this.updateView(xO)},this.bindFn(this.desmosTitle))),ye.createElement("div",{class:ye.const("dcg-shared-account-content-container")},ye.createElement(tie,{key:()=>this.selectedView},e=>e===OT?ye.createElement("div",{class:ye.const("dcg-shared-notice-checkbox-google")},ye.createElement(st,{checked:()=>this.consentChecked,disabled:this.const(!1),onChange:()=>{if(this.consentChecked=!this.consentChecked,!this.unmounted)return this.update()}},this.bindFn(this.consentText)),ye.createElement(st,{checked:()=>this.privacyChecked,disabled:this.const(!1),onChange:()=>{if(this.privacyChecked=!this.privacyChecked,!this.unmounted)return this.update()}},ye.createElement(PT,{i18n:this.const(this.i18n)})),ye.createElement(lC,{predicate:()=>window.googleAuthConnectionFailed},()=>ye.createElement("div",{class:ye.const("dcg-shared-google-auth-unavailable")},()=>this.i18n.s("shared-message-google-login-not-available"))),ye.createElement(lC,{predicate:()=>!window.googleAuthConnectionFailed},()=>ye.createElement("div",{class:()=>({"dcg-btn-gray-outline":!0,"dcg-shared-google-login":!0,"dcg-disabled":this.hasNotConsented()}),role:ye.const("button"),tabindex:()=>this.hasNotConsented()?"-1":"0","aria-disabled":this.bindFn(this.hasNotConsented),onTap:()=>this.googleLogin()},ye.createElement("div",{class:ye.const("dcg-shared-google-icon dcg-shared-external-login-logo")}),ye.createElement("span",null,this.bindFn(this.getGoogleLoginText)))),ye.createElement(lC,{predicate:()=>this.controller.allowSignInWithApple()},()=>ye.createElement("div",{class:()=>({"dcg-btn-gray-outline":!0,"dcg-shared-apple-login":!0,"dcg-disabled":this.hasNotConsented()}),role:ye.const("button"),tabindex:()=>this.hasNotConsented()?"-1":"0","aria-disabled":this.bindFn(this.hasNotConsented),onTap:()=>this.appleLogin()},ye.createElement("div",{class:ye.const("dcg-shared-apple-icon dcg-shared-external-login-logo")}),ye.createElement("span",null,this.bindFn(this.getAppleLoginText))))):e===xO?ye.createElement("div",null,ye.createElement(Qn,{controller:this.props.controller,errors:()=>this.formErrors}),ye.createElement("form",{class:ye.const("dcg-shared-action-submit"),onSubmit:this.bindFn(this.onSubmit),didMount:this.bindFn(this.didMountForm)},ye.createElement("div",{class:ye.const("dcg-shared-email-form-container")},ye.createElement("label",null,ye.createElement("span",{class:ye.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-email")),ye.createElement(LT,{type:ye.const("email"),name:ye.const("email"),class:ye.const("dcg-shared-input-blue-outline"),required:ye.const("true"),"aria-describedby":ye.const("email-description"),didMount:t=>{Gc||t.focus()},value:()=>this.email,onInput:t=>{if(this.email=t,!this.unmounted)return this.update()}})),ye.createElement("div",{class:ye.const("dcg-shared-name-container")},ye.createElement("div",{class:ye.const("dcg-shared-name-input")},ye.createElement("label",null,ye.createElement("span",{class:ye.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-given-name-or-nickname")),ye.createElement(LT,{type:ye.const("text"),name:ye.const("given-name"),class:ye.const("dcg-shared-input-blue-outline"),required:ye.const("true"),"aria-describedby":ye.const("given-name-description"),value:()=>this.givenName,onInput:t=>{if(this.givenName=t,!this.unmounted)return this.update()}}))),ye.createElement("div",{class:ye.const("dcg-shared-name-input")},ye.createElement("label",null,ye.createElement("span",{class:ye.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-family-name")),ye.createElement(LT,{type:ye.const("text"),name:ye.const("family-name"),class:ye.const("dcg-shared-input-blue-outline"),"aria-describedby":ye.const("family-name-description"),value:()=>this.familyName,onInput:t=>{if(this.familyName=t,!this.unmounted)return this.update()}})))),ye.createElement("label",null,ye.createElement("span",null,()=>this.i18n.s("shared-label-password")),ye.createElement(LT,{type:ye.const("password"),class:ye.const("dcg-shared-input-blue-outline"),name:ye.const("password"),required:ye.const("true"),value:()=>this.password,onInput:t=>{if(this.password=t,!this.unmounted)return this.update()}})),ye.createElement("div",{class:ye.const("dcg-shared-notice-checkbox-email")},ye.createElement(st,{checked:()=>this.consentChecked,disabled:this.const(!1),onChange:()=>{if(this.consentChecked=!this.consentChecked,!this.unmounted)return this.update()}},this.bindFn(this.consentText))),ye.createElement(st,{checked:()=>this.privacyChecked,disabled:this.const(!1),onChange:()=>{if(this.privacyChecked=!this.privacyChecked,!this.unmounted)return this.update()}},ye.createElement(PT,{i18n:this.const(this.i18n)})),ye.createElement("div",{class:ye.const("dcg-shared-sign-in-options")},ye.createElement(lC,{predicate:()=>this.isSubmittingForm},()=>ye.createElement("div",{class:ye.const("dcg-shared-progress-indicator dcg-shared-create-account-progress")},ye.createElement("div",{class:ye.const("dcg-shared-spinner")}))),ye.createElement(lC,{predicate:()=>!this.isSubmittingForm},()=>ye.createElement("div",{class:ye.const("dcg-shared-submit-container")},ye.createElement("button",{type:ye.const("submit"),class:()=>({"dcg-btn-blue":!0,"dcg-disabled":!this.submitEnabled()}),"aria-disabled":()=>!this.submitEnabled(),tabindex:()=>this.submitEnabled()?"0":"-1"},()=>this.i18n.s("shared-button-create-account")))))))):ye.createElement("span",null)),ye.createElement(am,{i18n:this.const(this.i18n)}))))}canSwitchRoles(){return!this.controller.getLimitedSignupRole()}didMountForm(e){this.form=e}submitEnabled(){var o,n,a;if(!this.consentChecked||!this.privacyChecked||!this.form)return!1;let e=(o=this.form.querySelector('[name="password"]'))==null?void 0:o.value,t=(n=this.form.querySelector('[name="email"]'))==null?void 0:n.value,i=(a=this.form.querySelector('[name="given-name"]'))==null?void 0:a.value;return!!(e&&t&&i)}onSubmit(e){e.preventDefault(),this.submitEnabled()&&this.submitForm()}googleLogin(){this.controller.dispatch({type:"close-modal"}),this.controller.userController.googleLogin({fromUI:"create"})}appleLogin(){this.controller.dispatch({type:"close-modal"}),this.controller.userController.appleLogin({fromUI:"create"})}getGoogleLoginText(){return this.consentChecked&&this.privacyChecked?this.i18n.s("shared-prompt-sign-up-with-google"):this.i18n.s("shared-prompt-please-consent-to-sign-up-with-google")}getAppleLoginText(){return this.consentChecked&&this.privacyChecked?this.i18n.s("shared-prompt-sign-up-with-apple"):this.i18n.s("shared-prompt-please-consent-to-sign-up-with-apple")}async submitForm(){this.formErrors=[],this.isSubmittingForm=!0,this.unmounted||this.update();try{if(await this.controller.userController.createAccount({userProvidedName:{given:this.givenName,family:this.familyName.length?this.familyName:void 0},email:this.email,password:this.password,teacher:!1,lang:this.controller.getLanguage()}),!this.unmounted)return this.controller.dispatch({type:"close-modal"})}catch(e){this.formErrors=this.controller.parseJSONErrors(e)}finally{this.isSubmittingForm=!1,this.unmounted||this.update()}}updateView(e){this.selectedView=e,this.unmounted||this.update()}externalTitle(){return this.controller.allowSignInWithApple()?this.windowWidth>this.breakPoint?this.i18n.s("shared-button-external-account-wide"):this.i18n.s("shared-button-external-account-narrow"):this.windowWidth>this.breakPoint?this.i18n.s("shared-button-google-account-wide"):this.i18n.s("shared-button-google-account-narrow")}desmosTitle(){return this.windowWidth>this.breakPoint?this.i18n.s("shared-button-email-address-wide"):this.i18n.s("shared-button-email-address-narrow")}measureWindow(){return this.windowWidth=H(window).width()}didMount(){H(window).on("resize.create-account",__dcg_shared_module_exports__['K'](()=>{this.measureWindow(),this.update()},200))}didUnmount(){H(window).off("resize.create-account"),this.unmounted=!0}consentText(){return this.i18n.s("shared-message-consent-text")}isGoogleSelected(){return this.selectedView===OT}isDesmosSelected(){return this.selectedView===xO}hasNotConsented(){return!this.consentChecked||!this.privacyChecked}};var Re=__dcg_shared_module_exports__['h'](z());var{If:cC,Input:PU,IfElse:rie}=Re.Components,FT=class extends Re.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.email="",this.password="",this.isSubmittingForm=!1,this.formErrors=[],this.controller.getModalStartingError()&&this.formErrors.push(this.controller.getModalStartingError())}template(){return Re.createElement(ko,{title:()=>this.i18n.s("shared-title-login"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},Re.createElement("div",{class:Re.const("dcg-shared-login-dialog dcg-shared-account-dialog")},rie(()=>this.canChooseRole(),{true:()=>Re.createElement("div",{class:Re.const("dcg-shared-switch-account-message")},Re.createElement(si,{key:this.const("shared-prompt-new-to-desmos-teacher-or-student"),i18n:this.props.controller},Re.const("New to Desmos?"),Re.const(" "),Re.createElement("a",{role:Re.const("link"),tabindex:Re.const("0"),class:Re.const("dcg-gray-link"),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"signup",device:e.device})},Re.const("Sign up!")))),false:()=>Re.createElement("div",{class:Re.const("dcg-shared-switch-account-message")},Re.createElement(si,{key:this.const("shared-prompt-new-to-desmos-sign-up-here"),i18n:this.props.controller},Re.const("New to Desmos?"),Re.const(" "),Re.createElement("a",{role:Re.const("link"),tabindex:Re.const("0"),class:Re.const("dcg-gray-link"),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"signup",device:e.device})},Re.const("Sign up")),Re.const(".")))}),Re.createElement("div",{class:Re.const("dcg-shared-account-content-container")},Re.createElement(cC,{predicate:()=>window.googleAuthConnectionFailed},()=>Re.createElement("div",{class:Re.const("dcg-shared-google-auth-unavailable")},()=>this.i18n.s("shared-message-google-login-not-available"))),Re.createElement(cC,{predicate:()=>!window.googleAuthConnectionFailed},()=>Re.createElement("div",{class:Re.const("dcg-btn-gray-outline dcg-shared-google-login"),role:Re.const("button"),tabindex:Re.const("0"),onTap:()=>this.googleLogin()},Re.createElement("div",{class:Re.const("dcg-shared-google-icon dcg-shared-external-login-logo")}),Re.createElement("span",null,()=>this.i18n.s("shared-button-sign-in-with-google")))),Re.createElement(cC,{predicate:()=>this.controller.allowSignInWithApple()},()=>Re.createElement("div",{class:Re.const("dcg-btn-gray-outline dcg-shared-apple-login"),role:Re.const("button"),tabindex:Re.const("0"),onTap:()=>this.appleLogin()},Re.createElement("div",{class:Re.const("dcg-shared-apple-icon dcg-shared-external-login-logo")}),Re.createElement("span",null,()=>this.i18n.s("shared-button-sign-in-with-apple"))))),Re.createElement("div",{class:Re.const("dcg-shared-bg-line")},Re.createElement("span",null,()=>this.i18n.s("shared-message-or-login-with-desmos"))),Re.createElement(Qn,{controller:this.props.controller,errors:()=>this.formErrors}),Re.createElement("form",{class:Re.const("dcg-shared-action-submit"),onSubmit:this.bindFn(this.onSubmit)},Re.createElement("div",{class:Re.const("dcg-shared-email-form-container")},Re.createElement("label",null,Re.createElement("span",{class:Re.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-email")),Re.createElement(PU,{type:Re.const("email"),name:Re.const("email"),class:Re.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-email"),required:Re.const("required"),didMount:e=>{Gc||e.focus()},value:()=>this.email,onInput:e=>{this.email=e,this.unmounted||this.update()}})),Re.createElement("div",{class:Re.const("dcg-shared-password-container")},Re.createElement("label",{for:Re.const("password")},Re.createElement("span",null,()=>this.i18n.s("shared-label-password")),Re.createElement(PU,{type:Re.const("password"),class:Re.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-password"),required:Re.const("true"),value:()=>this.password,name:this.const("password"),onInput:e=>{if(this.password=e,!this.unmounted)return this.update()}}),Re.createElement("span",{class:Re.const("dcg-shared-password-recovery-link")},Re.createElement("a",{role:Re.const("link"),tabindex:Re.const(0),class:Re.const("dcg-shared-action-password"),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"recover-password",device:e.device})},()=>this.i18n.s("shared-prompt-forgot-your-password"))))),Re.createElement("div",{class:Re.const("dcg-shared-sign-in-options")},Re.createElement(cC,{predicate:()=>this.isSubmittingForm},()=>Re.createElement("div",{class:Re.const("dcg-shared-progress-indicator dcg-shared-create-account-progress")},Re.createElement("div",{class:Re.const("dcg-shared-spinner")}))),Re.createElement(cC,{predicate:()=>!this.isSubmittingForm},()=>Re.createElement("div",{class:Re.const("dcg-shared-submit-container")},Re.createElement("button",{type:Re.const("submit"),class:()=>({"dcg-btn-blue":!0,"dcg-disabled":!this.submitEnabled()}),"aria-disabled":()=>!this.submitEnabled(),tabindex:()=>this.submitEnabled()?"0":"-1"},()=>this.i18n.s("shared-button-login-capitalized"))))),Re.createElement(am,{i18n:this.const(this.i18n)})))))}canChooseRole(){return!this.controller.getLimitedSignupRole()}didUnmount(){this.unmounted=!0}onSubmit(e){e.preventDefault(),this.submitForm()}googleLogin(){this.controller.dispatch({type:"close-modal"}),this.controller.userController.googleLogin({fromUI:"login"})}appleLogin(){this.controller.dispatch({type:"close-modal"}),this.controller.userController.appleLogin({fromUI:"login"})}submitEnabled(){return!!(this.email&&this.password)}async submitForm(){if(this.submitEnabled()){this.isSubmittingForm=!0,this.formErrors=[];try{let e=await this.controller.userController.checkPendingDeletion({email:this.email,lang:this.controller.getLanguage()});this._pendingDeletion=e.pendingDeletion}catch(e){this._pendingDeletion=!1}if(!this.unmounted){this.unmounted||this.update();try{if(await this.controller.userController.desmosLogin({email:this.email,password:this.password,lang:this.controller.getLanguage()}),this.unmounted)return;this._pendingDeletion?this.controller.dispatch({type:"show-modal",modal:"account-reenabled",device:"mouse"}):this.controller.dispatch({type:"close-modal"})}catch(e){this.formErrors=this.controller.parseJSONErrors(e)}this.unmounted||(this.isSubmittingForm=!1,this.controller.dispatch({type:"render"}))}}}};var yr=__dcg_shared_module_exports__['h'](z());var{If:RT,Input:iie}=yr.Components,NT=class extends yr.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.email=this.controller.userController.getEmail(),this.formErrors=[],this.isSubmittingForm=!1,this.didSendRecoveryEmail=!1}template(){return yr.createElement(ko,{title:()=>this.i18n.s("shared-title-recover-password"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},yr.createElement("div",{class:yr.const("dcg-shared-recover-password-dialog dcg-shared-account-dialog")},yr.createElement(Qn,{controller:this.props.controller,errors:()=>this.formErrors}),yr.createElement(RT,{predicate:()=>this.didSendRecoveryEmail},()=>yr.createElement("div",{role:yr.const("alert"),class:yr.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-check-email-for-password-recovery-link"),yr.const(" "),yr.createElement("a",{href:yr.const("#"),class:yr.const("dcg-blue-link"),onTap:e=>(this.didSendRecoveryEmail=!1,this.controller.dispatch({type:"show-modal",modal:"recover-password",device:e.device}))},()=>this.i18n.s("shared-button-try-again")))),yr.createElement(RT,{predicate:()=>!this.didSendRecoveryEmail},()=>yr.createElement("form",{class:yr.const("dcg-shared-email-form-container"),onSubmit:this.bindFn(this.onSubmit)},yr.createElement("div",{class:yr.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-prompt-enter-email-for-password-recovery-link")),yr.createElement("label",null,yr.createElement("span",{class:yr.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-email")),yr.createElement(iie,{type:yr.const("email"),name:yr.const("email"),class:yr.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-email"),required:yr.const("true"),didMount:e=>{Gc&&e.focus()},value:()=>this.email,onInput:e=>{this.email=e,this.unmounted||this.update()}})),yr.createElement("div",{class:yr.const("dcg-shared-sign-in-options")},yr.createElement(RT,{predicate:()=>this.isSubmittingForm},()=>yr.createElement("div",{class:yr.const("dcg-shared-progress-indicator dcg-shared-create-account-progress")},yr.createElement("div",{class:yr.const("dcg-shared-spinner")}))),yr.createElement(RT,{predicate:()=>!this.isSubmittingForm},()=>yr.createElement("button",{class:()=>({"dcg-shared-btn-blue":!0}),type:yr.const("submit")},()=>this.i18n.s("shared-button-recover-password"))))))))}didUnmount(){this.unmounted=!0}onSubmit(e){e.preventDefault(),this.submitForm()}async submitForm(){this.formErrors=[],this.isSubmittingForm=!0;try{await this.controller.userController.recoverPassword({email:this.email,lang:this.controller.getLanguage()}),this.didSendRecoveryEmail=!0}catch(e){this.formErrors=this.controller.parseJSONErrors(e)}finally{this.isSubmittingForm=!1,this.unmounted||this.update()}}};var Je=__dcg_shared_module_exports__['h'](z());var _U={i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-braille",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-nemeth-mode",standard:"<key>ALT</key> + <key>N</key>",apple:"<key>CTRL</key> + <key>N</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-ueb-mode",standard:"<key>ALT</key> + <key>U</key>",apple:"<key>CTRL</key> + <key>U</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-print-mode",standard:"<key>ALT</key> + <key>Q</key>",apple:"<key>CTRL</key> + <key>Q</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-braille-typing",standard:"<key>ALT</key> + <key>6</key>",apple:"<key>CTRL</key> + <key>6</key>"}]};var BT=function(r){let e={i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-expression-entry-and-navigation",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-expression",standard:"<key>UP ARROW</key>, <key>SHIFT</key> + <key>Tab</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-expression",standard:"<key>DOWN ARROW</key>, <key>Tab</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-remove-empty-expression",standard:"<key>Backspace</key>",apple:"<key>Delete</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-character",standard:"<key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-character",standard:"<key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-move-to-numerator",standard:"<key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-move-to-denominator",standard:"<key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-exit-block",standard:"<key>Tab</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-beginning-of-block",standard:"<key>Home</key>",apple:"<key>Fn</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-end-of-block",standard:"<key>End</key>",apple:"<key>Fn</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-beginning-of-expression",standard:"<key>CTRL</key> + <key>Home</key>",apple:"<key>CTRL</key> + <key>Fn</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-end-of-expression",standard:"<key>CTRL</key> + <key>End</key>",apple:"<key>CTRL</key> + <key>Fn</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-selection-left",standard:"<key>SHIFT</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-selection-right",standard:"<key>SHIFT</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-delete-selection",standard:"<key>Backspace</key>",apple:"<key>Delete</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-select-all",standard:"<key>CTRL</key> + <key>A</key>",apple:"<key>COMMAND</key> + <key>A</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-parent-block",standard:"<key>CTRL</key> + <key>ALT</key> + <key>UP ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-focused-block",standard:"<key>CTRL</key> + <key>ALT</key> + <key>DOWN ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-left-adjacent-block",standard:"<key>CTRL</key> + <key>ALT</key> + <key>LEFT ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-right-adjacent-block",standard:"<key>CTRL</key> + <key>ALT</key> + <key>RIGHT ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-selection",standard:"<key>CTRL</key> + <key>ALT</key> + <key>SHIFT</key> + <key>DOWN ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>SHIFT</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-answer",standard:"<key>CTRL</key> + <key>ALT</key> + <key>=</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>SHIFT</key> + <key>RIGHT ARROW</key>"}]};return r.decimalToFraction&&e.shortcuts.push({i18nKey:"shared-calculator-text-keyboard-shortcut-show-answer-as-decimal-or-fraction",standard:"<key>ALT</key> + <key>SHIFT</key> + <key>A</key>",apple:"<key>COMMAND</key> + <key>SHIFT</key> + <key>A</key>"}),e};var il={common:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-common-symbols",shortcuts:[{latex:"a^b",standard:"<key>^</key> (<key>SHIFT</key> + <key>6</key>)"},{latex:"a_b",standard:"<key>_</key> (<key>SHIFT</key> + <key>-</key>)"},{latex:"\\le",standard:"<key><</key><key>=</key>"},{latex:"\\ge",standard:"<key>></key><key>=</key>"},{latex:"a'",standard:"<key>'</key>"},{latex:"\\frac{a}{b}",standard:"<key>f</key><key>r</key><key>a</key><key>c</key>"},{latex:"\\sqrt{a}",standard:"<key>s</key><key>q</key><key>r</key><key>t</key>"},{latex:"\\sqrt[3]{a}",standard:"<key>c</key><key>b</key><key>r</key><key>t</key>"},{latex:"\\sqrt[n]{a}",standard:"<key>n</key><key>t</key><key>h</key><key>r</key><key>o</key><key>o</key><key>t</key>"},{latex:"\\sum_{n=a}^b",standard:"<key>s</key><key>u</key><key>m</key>"},{latex:"\\int_a^b",standard:"<key>i</key><key>n</key><key>t</key>"},{latex:"\\prod_{n=a}^b",standard:"<key>p</key><key>r</key><key>o</key><key>d</key>"},{latex:"\\pi",standard:"<key>p</key><key>i</key>"},{latex:"\\theta",standard:"<key>t</key><key>h</key><key>e</key><key>t</key><key>a</key>"},{latex:"\\to",standard:"<key>-</key><key>></key>"}]},tables:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-tables",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-table-previous-cell",standard:"<key>SHIFT</key> + <key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-next-cell",standard:"<key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-previous-row",standard:"<key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-next-row",standard:"<key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-previous-column",standard:"<key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-next-column",standard:"<key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-first-row",standard:"<key>CTRL</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-last-row",standard:"<key>CTRL</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-first-column",standard:"<key>CTRL</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-last-column",standard:"<key>CTRL</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-speak-column-header",standard:"<key>CTRL</key> + <key>H</key>"}]},sliders:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-sliders",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-decrease",standard:"<key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-decrease-larger",standard:"<key>PAGE DOWN</key>",apple:"<key>FN</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-increase",standard:"<key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-increase-larger",standard:"<key>PAGE UP</key>",apple:"<key>FN</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-minimum",standard:"<key>HOME</key>",apple:"<key>FN</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-maximum",standard:"<key>END</key>",apple:"<key>FN</key> + <key>RIGHT ARROW</key>"}]},audiotrace:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-audio-tracing",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-audio-trace",standard:"<key>ALT</key> + <key>T</key>",apple:"<key>OPTION</key> + <key>T</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-summarize-graph",standard:"<key>ALT</key> + <key>S</key>",apple:"<key>OPTION</key> + <key>S</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-describe-axes",standard:"<key>ALT</key> + <key>G</key>",apple:"<key>OPTION</key> + <key>G</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-point",standard:"<key>LEFT ARROW</key>, <key>UP ARROW</key>, <key>J</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-point",standard:"<key>RIGHT ARROW</key>, <key>DOWN ARROW</key>, <key>L</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-poi",standard:"<key>PAGE UP</key>, <key>SHIFT</key> + <key>TAB</key>, <key>K</key>",apple:"<key>FN</key> + <key>UP ARROW</key>, <key>SHIFT</key> + <key>TAB</key>, <key>K</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-poi",standard:"<key>PAGE DOWN</key>, <key>TAB</key>, <key>I</key>",apple:"<key>FN</key> + <key>DOWN ARROW</key>, <key>TAB</key>, <key>I</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-first-point",standard:"<key>HOME</key>, <key>U</key>",apple:"<key>FN</key> + <key>LEFT ARROW</key>, <key>U</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-last-point",standard:"<key>END</key> <key>N</key>",apple:"<key>FN</key> + <key>RIGHT ARROW</key> <key>N</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-poi-count",standard:"<key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-x",standard:"<key>X</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-y",standard:"<key>Y</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-color",standard:"<key>C</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-branch",standard:"<key>B</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-point-type",standard:"<key>T</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-move-to-origin",standard:"<key>O</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-curve",standard:"<key>ALT</key> + <key>UP ARROW</key>",apple:"<key>OPTION</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-curve",standard:"<key>ALT</key> + <key>DOWN ARROW</key>",apple:"<key>OPTION</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-hear-graph",standard:"<key>H</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-hear-specific-branch",standard:"<key>1</key> - <key>0</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-adjust-playback-speed",standard:"<key>ALT</key> + <key>1</key> - <key>5</key>",apple:"<key>OPTION</key> + <key>1</key> - <key>5</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-volume",standard:"<key>V</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-volume",standard:"<key>SHIFT</key> + <key>V</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-announce-slider-animations",standard:"<key>A</key>"}]},slidertrace:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-slider-trace",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-slider-trace",standard:"<key>S</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-decrease",standard:"<key>LEFT ARROW</key> <key>J</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-decrease-larger",standard:"<key>PAGE DOWN</key>",apple:"<key>FN</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-increase",standard:"<key>RIGHT ARROW</key> <key>L</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-increase-larger",standard:"<key>PAGE UP</key>",apple:"<key>FN</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-minimum",standard:"<key>HOME</key> <key>U</key>",apple:"<key>FN</key> + <key>LEFT ARROW</key> <key>U</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-maximum",standard:"<key>END</key> <key>N</key>",apple:"<key>FN</key> + <key>RIGHT ARROW</key> <key>N</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-next-slider",standard:"<key>DOWN ARROW</key>, <key>TAB</key>, <key>K</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-previous-slider",standard:"<key>UP ARROW</key>, <key>SHIFT</key> + <key>TAB</key>, <key>I</key>"}]},interactivepoints:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-interactive-points",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-focus-first-interactive-point",standard:"<key>CTRL</key> + <key>ALT</key> + <key>P</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-interactive-point",standard:"<key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-interactive-point",standard:"<key>SHIFT</key> + <key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-x",standard:"<key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-x",standard:"<key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-y",standard:"<key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-y",standard:"<key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-x-larger",standard:"<key>SHIFT</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-x-larger",standard:"<key>SHIFT</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-y-larger",standard:"<key>SHIFT</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-y-larger",standard:"<key>SHIFT</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-x",standard:"<key>X</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-y",standard:"<key>Y</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-label",standard:"<key>L</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-color",standard:"<key>C</key>"}]},commonactions:oie({folders:!0,notes:!0,images:!0}),desmoscomonly:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-desmos-com-only",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-open-shortcuts-dialog",standard:"<key>CTRL</key> + <key>/</key>",apple:"<key>COMMAND</key> + <key>/</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-open-a-graph",standard:"<key>CTRL</key> + <key>O</key>",apple:"<key>COMMAND</key> + <key>O</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-save-a-graph",standard:"<key>CTRL</key> + <key>S</key>",apple:"<key>COMMAND</key> + <key>S</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-print-a-graph",standard:"<key>CTRL</key> + <key>P</key>",apple:"<key>COMMAND</key> + <key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-account-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>A</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>A</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-help-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>H</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>H</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-language-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>L</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>L</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-share-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>S</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>S</key>"}]},braille:_U,mathquill:BT({decimalToFraction:!0})};function oie(r){let e={i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-common-actions",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-close-a-dialog",standard:"<key>ESC</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-show-or-hide-expression-list",standard:"<key>SHIFT</key> + <key>ALT</key> + <key>E</key>",apple:"<key>SHIFT</key> + <key>COMMAND</key> + <key>E</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-focus-expression-list",standard:"<key>CTRL</key> + <key>ALT</key> + <key>E</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>E</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-open-expression-options",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>O</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-delete-expression",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>D</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-degrees-toggle",standard:"<key>ALT</key> + <key>D</key>",apple:"<key>CTRL</key> + <key>D</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-keypad-toggle",standard:"<key>ALT</key> + <key>K</key>",apple:"<key>CTRL</key> + <key>K</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-add-expression",standard:"<key>CTRL</key> + <key>ALT</key> + <key>X</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>X</key>"}]};return r.notes&&e.shortcuts.push({i18nKey:"shared-calculator-text-keyboard-shortcut-add-note",standard:"<key>CTRL</key> + <key>ALT</key> + <key>O</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>O</key>"}),r.folders&&(e.shortcuts=e.shortcuts.concat([{i18nKey:"shared-calculator-text-keyboard-shortcut-add-folder",standard:"<key>CTRL</key> + <key>ALT</key> + <key>F</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>F</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-collapse-folder",standard:"<key>ALT</key> + <key>UP ARROW</key>",apple:"<key>COMMAND</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-expand-folder",standard:"<key>ALT</key> + <key>DOWN ARROW</key>",apple:"<key>COMMAND</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-collapse-all-folders",standard:"<key>ALT</key> + <key>SHIFT</key> + <key>UP ARROW</key>",apple:"<key>COMMAND</key> + <key>SHIFT</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-expand-all-folders",standard:"<key>ALT</key> + <key>SHIFT</key> + <key>DOWN ARROW</key>",apple:"<key>COMMAND</key> + <key>SHIFT</key> + <key>DOWN ARROW</key>"}])),r.images&&e.shortcuts.push({i18nKey:"shared-calculator-text-keyboard-shortcut-add-image",standard:"<key>CTRL</key> + <key>ALT</key> + <key>I</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>I</key>"}),e.shortcuts=e.shortcuts.concat([{i18nKey:"shared-calculator-text-keyboard-shortcut-add-table",standard:"<key>CTRL</key> + <key>ALT</key> + <key>T</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>T</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-undo",standard:"<key>CTRL</key> + <key>Z</key>",apple:"<key>COMMAND</key> + <key>Z</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-redo",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>Z</key>",apple:"<key>COMMAND</key> + <key>SHIFT</key> + <key>Z</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-zoom-in",standard:"<key>ALT</key> + <key>+</key>",apple:"<key>CTRL</key> + <key>+</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-zoom-out",standard:"<key>ALT</key> + <key>-</key>",apple:"<key>CTRL</key> + <key>-</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-zoom-restore-default",standard:"<key>ALT</key> + <key>0</key>",apple:"<key>CTRL</key> + <key>0</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-zoom-fit",standard:"<key>SHIFT</key> + <key>ALT</key> + <key>Z</key>",apple:"<key>SHIFT</key> + <key>OPTION</key> + <key>Z</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-edit-list-mode",standard:"<key>CTRL</key> + <key>ALT</key> + <key>D</key>",apple:"<key>CTRL</key> + <key>OPTION</key> + <key>D</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-graph-settings-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>G</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>G</key>"}]),e}var dC=__dcg_shared_module_exports__['a']({toolSelection:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-geometry-tool-selection",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-focus-toolbar",standard:"<key>CTRL</key> + <key>ALT</key> + <key>M</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>M</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-between-toolbar-categories",standard:"<key>LEFT ARROW</key>, <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-between-toolbar-dropdown-items",standard:"<key>UP ARROW</key>, <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-choose-toolbar-item-and-focus-graph",standard:"<key>ENTER</key>",apple:"<key>RETURN</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-cancel-active-tool",standard:"<key>ESC</key>"}]},graphNavigation:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-geometry-graph-navigation-during-construction",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-focus-graph-paper",standard:"<key>CTRL</key> + <key>ALT</key> + <key>P</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-navigate-graph",standard:"<key>UP ARROW</key>, <key>DOWN ARROW</key>, <key>LEFT ARROW</key>, <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-to-top-of-graph",standard:"<key>CTRL</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-to-bottom-of-graph",standard:"<key>CTRL</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-to-left-of-graph",standard:"<key>CTRL</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-to-right-of-graph",standard:"<key>CTRL</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-next-object",standard:"<key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-previous-object",standard:"<key>SHIFT</key> + <key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-describe-object",standard:"<key>D</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-repeat-active-tool-prompt",standard:"<key>?</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-select-tool-by-number",standard:"<key>1</key>, <key>2</key>, <key>3</key>, ..., <key>6</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-select-next-category",standard:"<key>=</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-select-previous-category",standard:"<key>-</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-select-next-tool-within-category",standard:"<key>]</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-select-previous-tool-within-category",standard:"<key>[</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-add-object-to-selection",standard:"<key>ENTER</key>",apple:"<key>RETURN</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-drag-movable-objects",standard:"<key>UP ARROW</key>, <key>DOWN ARROW</key>, <key>LEFT ARROW</key>, <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-delete-selected-objects",standard:"<key>DELETE</key>, <key>BACKSPACE</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-focus-selected-objects-toolbar",standard:"<key>CTRL</key> + <key>ALT</key> + <key>M</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>M</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-open-options",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>O</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-open-transformation-options",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>A</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-deselect-all-objects",standard:"<key>ESC</key>"}]},expressionEdit:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-geometry-expression-edit",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-focus-graph-paper",standard:"<key>CTRL</key> + <key>ALT</key> + <key>P</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-navigate-graph",standard:"<key>UP ARROW</key>, <key>DOWN ARROW</key>, <key>LEFT ARROW</key>, <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-to-top-of-graph",standard:"<key>CTRL</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-expression-edit-next-object",standard:"<key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-expression-edit-previous-object",standard:"<key>SHIFT</key> + <key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-expression-edit-add-object",standard:"<key>ENTER</key>",apple:"<key>RETURN</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-expression-edit-complete",standard:"<key>ENTER</key>",apple:"<key>RETURN</key>"}]},tokenNavigator:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-geometry-token-navigator",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-open-token-navigator",standard:"<key>CTRL</key> + <key>ALT</key> + <key>C</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>C</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-close-token-navigator",standard:"<key>ESC</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-navigate-tokens-at-current-level",standard:"<key>LEFT ARROW</key>, <key>RIGHT ARROW</key"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-navigate-object-levels",standard:"<key>UP ARROW</key>, <key>DOWN ARROW</key"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-move-token-between-expression-list-and-navigator",standard:"<key>ALT</key> + <key>SHIFT</key> + <key>M</key>",apple:"<key>OPTION</key> + <key>SHIFT</key> + <key>M</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-select-single-object-token",standard:"<key>ENTER</key>",apple:"<key>RETURN</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-add-object-token-to-selection",standard:"<key>SHIFT</key> + <key>ENTER</key>",apple:"<key>SHIFT</key> + <key>RETURN</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-delete-selected-objects",standard:"<key>DELETE</key>, <key>BACKSPACE</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-focus-selected-objects-toolbar",standard:"<key>CTRL</key> + <key>ALT</key> + <key>M</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>M</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-geometry-open-options",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>O</key>"}]}},il);var FU=JSON.parse(JSON.stringify(il)),{audiotrace:W4e,slidertrace:$4e,interactivepoints:j4e}=FU,RU=__dcg_shared_module_exports__['d'](FU,["audiotrace","slidertrace","interactivepoints"]);RU.commonactions.shortcuts.unshift({i18nKey:"shared-calculator-text-keyboard-shortcut-focus-graph-paper",standard:"<key>CTRL</key> + <key>ALT</key> + <key>P</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-switch-pane-in-3d-quest",standard:"<key>F6</key>"});var NU=RU;var Aa=__dcg_shared_module_exports__['h'](z());var{For:wO,If:nie}=Aa.Components,La=class extends Aa.Class{template(){return Aa.createElement("table",{class:Aa.const("dcg-shortcuts-table")},Aa.createElement(wO,{each:this.bindFn(this.getCols)},Aa.createElement("tr",null,e=>Aa.createElement("th",null,()=>this.getHeader(e)))),Aa.createElement(wO,{each:()=>__dcg_shared_module_exports__['M'](this.props.section().shortcuts)},Aa.createElement("tbody",null,e=>Aa.createElement(wO,{each:this.bindFn(this.getCols)},Aa.createElement("tr",null,t=>Aa.createElement("td",{didMount:i=>this.populateContent(i,e,t)},Aa.createElement(nie,{predicate:()=>!!this.getLatex(e)},()=>Aa.createElement(ze,{latex:()=>this.getLatex(e),config:this.const({})}))))))))}getLatex(e){return this.props.section().shortcuts[e].latex||""}populateContent(e,t,i){let o=this.props.section().shortcuts[t];switch(i){case"heading":if(o.latex)return;o.i18nKey&&(e.innerHTML=this.props.controller().s(o.i18nKey));return;case"windows":e.innerHTML=this.replaceKey(o.standard);return;case"mac":e.innerHTML=this.replaceKey(o.apple||o.standard);return}}getHeader(e){let t=this.props.controller().s;switch(e){case"heading":return t("shared-calculator-heading-function-table-column-header");case"windows":return t("shared-calculator-heading-windows-chrome-table-column-header");case"mac":return t("shared-calculator-heading-mac-table-column-header")}}getCols(){return this.props.os?this.props.os()==="windows"?["heading","windows"]:["heading","mac"]:["heading","windows","mac"]}replaceKey(e){return e.replace(/\<key\>/g,"<span class='dcg-key-command'>").replace(/\<\/key\>/g,"</span>")}};var{If:us}=Je.Components,qT=class extends Je.Class{init(){this.controller=this.props.controller(),this.controller.state.hotkeysDialog==null&&(this.controller.state.hotkeysDialog={shortcutOS:oi?"mac":"windows"})}showGeoShortcuts(){return this.controller.product==="geometry-calculator"}show3dShortcuts(){return this.controller.product==="graphing-3d"}template(){return Je.createElement(gc,{controller:this.props.controller},Je.createElement("div",{id:Je.const("dcg-hotkeys-dialog")},Je.createElement("h1",null,()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts")),Je.createElement("div",{class:Je.const("dcg-hotkeys-toggle-container")},Je.createElement(_r,{staticConfig:this.bindFn(this.getOSOptions),ariaGroupLabel:()=>this.controller.s("shared-calculator-label-os")})),Je.createElement("div",{class:Je.const("dcg-hotkey-container")},Je.createElement("div",{class:Je.const("dcg-hotkey-section")},Je.createElement(us,{predicate:this.bindFn(this.showGeoShortcuts)},()=>Je.createElement("h2",{class:Je.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-geometry-tool-selection"))),Je.createElement(us,{predicate:this.bindFn(this.showGeoShortcuts)},()=>Je.createElement(La,{controller:this.props.controller,section:this.const(dC.toolSelection),os:this.bindFn(this.getShortcutOS)})),Je.createElement(us,{predicate:this.bindFn(this.showGeoShortcuts)},()=>Je.createElement("h2",{class:Je.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-geometry-expression-edit"))),Je.createElement(us,{predicate:this.bindFn(this.showGeoShortcuts)},()=>Je.createElement(La,{controller:this.props.controller,section:this.const(dC.expressionEdit),os:this.bindFn(this.getShortcutOS)})),Je.createElement(us,{predicate:this.bindFn(this.showGeoShortcuts)},()=>Je.createElement("h2",{class:Je.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-geometry-token-navigator"))),Je.createElement(us,{predicate:this.bindFn(this.showGeoShortcuts)},()=>Je.createElement(La,{controller:this.props.controller,section:this.const(dC.tokenNavigator),os:this.bindFn(this.getShortcutOS)})),Je.createElement("h2",{class:Je.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-common-actions")),Je.createElement(us,{predicate:this.bindFn(this.show3dShortcuts)},()=>Je.createElement(La,{controller:this.props.controller,section:this.const(NU.commonactions),os:this.bindFn(this.getShortcutOS)})),Je.createElement(us,{predicate:()=>!this.show3dShortcuts()},()=>Je.createElement(La,{controller:this.props.controller,section:this.const(il.commonactions),os:this.bindFn(this.getShortcutOS)})),Je.createElement("h2",{class:Je.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-desmos-com-only")),Je.createElement(La,{controller:this.props.controller,section:this.const(il.desmoscomonly),os:this.bindFn(this.getShortcutOS)}),Je.createElement("h2",{class:Je.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-expression-entry-and-navigation")),Je.createElement(La,{controller:this.props.controller,section:()=>BT({decimalToFraction:this.controller.isDecimalToFractionEnabled()}),os:this.bindFn(this.getShortcutOS)}),Je.createElement(us,{predicate:()=>!this.show3dShortcuts()},()=>Je.createElement("h2",{class:Je.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-interactive-points"))),Je.createElement(us,{predicate:()=>!this.show3dShortcuts()},()=>Je.createElement(La,{controller:this.props.controller,section:this.const(il.interactivepoints),os:this.bindFn(this.getShortcutOS)}))),Je.createElement("div",{class:Je.const("dcg-hotkey-section")},Je.createElement(us,{predicate:this.bindFn(this.showGeoShortcuts)},()=>Je.createElement("h2",{class:Je.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-text-keyboard-shortcut-geometry-navigate-graph"))),Je.createElement(us,{predicate:this.bindFn(this.showGeoShortcuts)},()=>Je.createElement(La,{controller:this.props.controller,section:this.const(dC.graphNavigation),os:this.bindFn(this.getShortcutOS)})),Je.createElement("h2",{class:Je.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-symbols")),Je.createElement(La,{controller:this.props.controller,section:this.const(il.common),os:this.bindFn(this.getShortcutOS)}),Je.createElement(us,{predicate:()=>!this.show3dShortcuts()},()=>Je.createElement("h2",{class:Je.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-audio-tracing"))),Je.createElement(us,{predicate:()=>!this.show3dShortcuts()},()=>Je.createElement(La,{controller:this.props.controller,section:this.const(il.audiotrace),os:this.bindFn(this.getShortcutOS)})),Je.createElement(us,{predicate:()=>!this.show3dShortcuts()},()=>Je.createElement("h2",{class:Je.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-slider-trace"))),Je.createElement(us,{predicate:()=>!this.show3dShortcuts()},()=>Je.createElement(La,{controller:this.props.controller,section:this.const(il.slidertrace),os:this.bindFn(this.getShortcutOS)})),Je.createElement("h2",{class:Je.const("dcg-hotkey-section-header tables-section")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-sliders")),Je.createElement(La,{controller:this.props.controller,section:this.const(il.sliders),os:this.bindFn(this.getShortcutOS)}),Je.createElement("h2",{class:Je.const("dcg-hotkey-section-header tables-section")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-tables")),Je.createElement(La,{controller:this.props.controller,section:this.const(il.tables),os:this.bindFn(this.getShortcutOS)}),Je.createElement("h2",{class:Je.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-braille")),Je.createElement(La,{controller:this.props.controller,section:this.const(il.braille),os:this.bindFn(this.getShortcutOS)})))))}getOSOptions(){return[{key:"windows",label:()=>this.controller.s("shared-calculator-button-windows-chrome"),selected:()=>this.getShortcutOS()==="windows",onSelect:()=>this.setShortcutOS("windows")},{key:"mac",label:()=>this.controller.s("shared-calculator-button-mac"),selected:()=>this.getShortcutOS()==="mac",onSelect:()=>this.setShortcutOS("mac")}]}getShortcutOS(){return this.controller.state.hotkeysDialog.shortcutOS}setShortcutOS(e){this.controller.state.hotkeysDialog.shortcutOS=e,this.unmounted||this.update()}didMount(){this.updateVisibleShortcuts()}didUnmount(){this.unmounted=!0}didUpdate(){this.updateVisibleShortcuts()}updateVisibleShortcuts(){let e=this.getShortcutOS(),t=document.querySelector(".dcg-os-mac"),i=document.querySelector(".dcg-os-windows");!t||!i||(e==="mac"?(t.style.display="block",i.style.display="none"):e==="windows"&&(t.style.display="none",i.style.display="block"))}};var Ho=__dcg_shared_module_exports__['h'](z());var KT=class extends Ho.Class{init(){this.controller=this.props.controller()}template(){return Ho.createElement(gc,{controller:this.props.controller},Ho.createElement("div",{id:Ho.const("unsupported-browser")},Ho.createElement("div",{id:Ho.const("unsupported-browser-title"),style:Ho.const("color:black; font-size:150%;")},()=>this.controller.s("account-shell-heading-unsupported-browser")),Ho.createElement("div",{style:Ho.const("padding:20px 0px; color:#666")},()=>this.controller.s("account-shell-text-unsupported-browser-android"),Ho.createElement("br",null),Ho.createElement("br",null),Ho.createElement("a",{href:Ho.const("https://play.google.com/store/apps/details?id=com.android.chrome")},()=>this.controller.s("account-shell-link-download-chrome"),Ho.createElement("br",null),Ho.createElement("br",null)),Ho.createElement("div",{style:Ho.const("text-align: center; margin-top: 25px; margin-bottom:-16px")},Ho.createElement("a",{role:Ho.const("link"),tabindex:Ho.const("0"),class:Ho.const("dcg-btn dcg-action-hide dcg-do-not-blur"),onTap:()=>this.controller.dispatch({type:"close-modal"})},()=>this.controller.s("account-shell-button-hide-browser-warning"))))))}};var Wo=__dcg_shared_module_exports__['h'](z());var Be=__dcg_shared_module_exports__['h'](z());var Wr=__dcg_shared_module_exports__['h'](z());var zT=class extends Wr.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.formErrors=[]}template(){return Wr.createElement("div",{class:Wr.const("dcg-shared-delete-account dcg-shared-account-settings-section")},Wr.createElement("h1",{class:Wr.const("dcg-shared-left-align-title")},()=>this.i18n.s("shared-title-delete-account")),Wr.createElement("div",{class:Wr.const("dcg-shared-account-paragraph")},Wr.createElement(si,{key:this.const("shared-message-delete-account-notice"),i18n:this.props.controller},Wr.const("When you delete your account,"),Wr.const(" "),Wr.createElement("b",null,Wr.const("we will retain your data for 30 days.")),Wr.const(" "),Wr.const("You can reactivate your account at any time during those 30 days by logging back in."),Wr.const(" "),Wr.const("If there's something about Desmos we can improve, please"),Wr.const(" "),Wr.createElement("a",{href:Wr.const("mailto:support@desmos.com"),class:Wr.const("dcg-blue-link")},Wr.const("let us know.")))),Wr.createElement("div",{class:Wr.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-delete-account-will-send-email",{email:this.i18n.raw(this.controller.userController.getEmail())})),Wr.createElement("form",{onSubmit:this.bindFn(this.onSubmit)},Wr.createElement(Qn,{controller:this.props.controller,errors:()=>this.formErrors}),Wr.createElement("div",{class:Wr.const("dcg-shared-modal-actions-container")},Wr.createElement("div",{role:Wr.const("link"),tabindex:Wr.const(0),class:Wr.const("dcg-gray-link"),onTap:()=>(this.controller.logJSON("shared-delete-account",{action:"cancel-delete-account"}),this.props.hideForm())},()=>this.i18n.s("shared-button-cancel")),Wr.createElement("button",{class:()=>({"dcg-btn-red":!0,"dcg-disabled":this.disabled}),"aria-disabled":()=>this.disabled,tabindex:()=>this.disabled?"-1":"0",type:Wr.const("submit")},()=>this.i18n.s("shared-button-send-delete-account-email")))))}onAccountDeleted(){return this.props.submitForm()}onAccountDeletionFailed(){if(this.formErrors=[this.controller.getSomethingWentWrongText()],!this.unmounted)return this.update()}doDeleteAccount(){this.disabled||(this.controller.logJSON("shared-delete-account",{action:"send-delete-account-email"}),this.controller.userController.initiateAccountDeletion({lang:this.controller.getLanguage()}).then(this.bindFn(this.onAccountDeleted),this.bindFn(this.onAccountDeletionFailed)))}didUnmount(){return this.unmounted=!0}onSubmit(e){e.preventDefault(),this.doDeleteAccount()}};var qt=__dcg_shared_module_exports__['h'](z());var{If:vO}=qt.Components,dy=0,BU=1,aie=2,qU=3,UT=class extends qt.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.formStatus=dy,this.emailDisabled=null}template(){return qt.createElement("div",{class:qt.const("dcg-shared-email-field-container")},qt.createElement(vO,{predicate:()=>this.formStatus===dy},()=>qt.createElement("div",{class:qt.const("dcg-shared-email-field")},qt.createElement("div",{class:qt.const("dcg-shared-profile-info-container")},qt.createElement("span",{class:qt.const("dcg-shared-profile-info-title"),role:qt.const("heading"),"aria-level":qt.const("1")},()=>this.i18n.s("shared-title-email-settings")),qt.createElement("div",{class:qt.const("dcg-shared-profile-info-content")},()=>this.i18n.raw(this.controller.userController.getEmail()),qt.createElement("div",{class:qt.const("dcg-shared-message-container")},qt.createElement("div",{role:qt.const("link"),tabindex:qt.const(0),class:qt.const("dcg-blue-link"),onTap:()=>this.setFormStatus(BU)},()=>this.i18n.s("shared-button-change-email-address"))))))),qt.createElement(vO,{predicate:()=>this.formStatus===BU},()=>qt.createElement("div",{class:qt.const("dcg-shared-change-email-container")},qt.createElement("div",{class:qt.const("dcg-shared-change-email-description")},()=>this.i18n.s("shared-message-email-settings-will-send-email",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})),qt.createElement(Qn,{controller:this.props.controller,errors:()=>this.formErrors}),qt.createElement("div",{class:qt.const("dcg-shared-modal-actions-container")},qt.createElement("span",{role:qt.const("link"),tabindex:qt.const(0),class:qt.const("dcg-gray-link"),onTap:()=>this.setFormStatus(dy)},()=>this.i18n.s("shared-button-cancel")),qt.createElement("button",{class:()=>({"dcg-btn-blue":!0,"dcg-disabled":this.emailDisabled}),"aria-disabled":()=>this.disabled,tabindex:()=>this.disabled?"-1":"0",type:qt.const("submit"),onTap:()=>this.emailDisabled||this.sendChangeEmail()},()=>this.i18n.s("shared-button-send-email"))))),qt.createElement(vO,{predicate:()=>this.formStatus===qU},()=>qt.createElement("div",{"aria-live":qt.const("assertive"),"aria-atomic":qt.const("true"),class:qt.const("dcg-shared-confirmation-message-container")},qt.createElement("div",{class:qt.const("dcg-shared-confirmation-message")},qt.createElement("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0}),"aria-hidden":qt.const("true")}),()=>this.i18n.s("shared-message-email-sent")),qt.createElement("div",null,()=>this.i18n.s("shared-message-check-email-for-link",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})))))}didUnmount(){this.unmounted=!0}setToast(e){this.toastMessage||(this.toastMessage=e,this.unmounted||this.update(),setTimeout(()=>{this.toastMessage=null,this.unmounted||this.update()},5e3),this.formStatus===aie&&setTimeout(()=>{this.setFormStatus(dy),this.unmounted||this.update()},5200))}setFormStatus(e){this.formStatus=e,this.toastMessage=null,this.formErrors=[],this.update()}onEmailSent(){this.formStatus=qU,this.emailDisabled=null,this.unmounted||this.update(),setTimeout(()=>{this.formStatus=dy,this.unmounted||this.update()},5e3),setTimeout(()=>{this.formStatus=dy,this.unmounted||this.update()},5200)}onEmailSendingFailed(){this.formErrors=[this.controller.getSomethingWentWrongText()],this.emailDisabled=null,this.unmounted||this.update()}sendChangeEmail(){this.emailDisabled=!0,this.unmounted||this.update(),this.controller.userController.initiateEmailChange({lang:this.controller.getLanguage()}).then(this.bindFn(this.onEmailSent),this.bindFn(this.onEmailSendingFailed))}};var{If:zU,Input:SO,Switch:sie,SwitchUnion:lie}=Be.Components,CO=0,KU=1,DO=2,HT=class extends Be.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.deleteAccount=CO}template(){return Be.createElement("div",{class:Be.const("dcg-shared-profile-info dcg-shared-account-settings-section")},Be.createElement(sie,{key:()=>this.deleteAccount},e=>{switch(e){case CO:return Be.createElement("div",null,Be.createElement("div",{class:Be.const("dcg-shared-email-form-container")},Be.createElement(kO,{controller:this.props.controller})),Be.createElement(UT,{controller:this.props.controller}),Be.createElement("div",{role:Be.const("link"),tabindex:Be.const(0),class:Be.const("dcg-gray-link dcg-shared-delete-link"),onTap:()=>this.confirmDeletion()},()=>this.i18n.s("shared-button-delete-account-question")));case KU:return Be.createElement(zT,{hideForm:()=>this.setDeleteAccount(CO),submitForm:()=>this.setDeleteAccount(DO),controller:this.props.controller});case DO:return Be.createElement("div",{"aria-live":Be.const("assertive"),"aria-atomic":Be.const("true"),class:Be.const("dcg-shared-confirmation-message-container")},Be.createElement("div",{class:Be.const("dcg-shared-confirmation-message")},Be.createElement("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0}),"aria-hidden":Be.const("true")}),()=>this.i18n.s("shared-message-email-sent")),Be.createElement("div",null,()=>this.i18n.s("shared-message-check-email-for-delete-link",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})))}}))}didUnmount(){this.unmounted=!0}setDeleteAccount(e){this.deleteAccount=e,e===DO&&setTimeout(()=>{this.controller.userController.logout().then(()=>this.controller.dispatch({type:"close-modal"}))},5e3),this.unmounted||this.update()}confirmDeletion(){this.controller.logJSON("shared-profile-info",{action:"delete-account"}),this.setDeleteAccount(KU),this.unmounted||this.update()}},kO=class extends Be.Class{init(){this.controller=this.props.controller();let e=this.controller.userController.getNameDetail();e.source=="legacy"?this.state={state:"legacy",name:e.given,previousName:e.given}:e.source=="parsed"?this.state={state:"name-detail",confirm:!0,given:e.given,family:e.family||"",previousGiven:"",previousFamily:""}:this.state={state:"name-detail",confirm:!1,given:e.given,family:e.family||"",previousGiven:e.given,previousFamily:e.family||""}}template(){return lie("state",()=>this.state)({legacy:e=>Be.createElement(EO,{state:e,controller:this.props.controller,onSaveName:this.bindFn(this.onSaveName),showSavedNotice:()=>this.showSavedNotice,updateState:t=>{this.state.state=="legacy"&&(this.state=__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},this.state),t),this.unmounted||this.update())}}),"name-detail":e=>Be.createElement(GO,{state:e,controller:this.props.controller,showSavedNotice:()=>this.showSavedNotice,onSaveName:this.bindFn(this.onSaveName),updateState:t=>{this.state.state=="name-detail"&&(this.state=__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},this.state),t),this.unmounted||this.update())}})})}onSaveName(){switch(this.state.state){case"legacy":this.controller.userController.setNameLegacy({name:this.state.name,lang:this.controller.getLanguage()}).then(this.bindFn(this.onSaved));break;case"name-detail":this.controller.userController.setNameDetail({given:this.state.given,family:this.state.family,lang:this.controller.getLanguage()}).then(this.bindFn(this.onSaved));break}}maybeUpdate(){this.unmounted||this.update()}onSaved(){switch(this.state.state){case"legacy":this.state.previousName=this.state.name;break;case"name-detail":this.state.previousGiven=this.state.given,this.state.previousFamily=this.state.family,this.state.confirm=!1;break}this.showSavedNotice=!0,this.maybeUpdate(),setTimeout(()=>{this.showSavedNotice=!1,this.maybeUpdate()},3e3)}willUnmount(){this.unmounted=!0}didMount(){this.unmounted=!1}},EO=class extends Be.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller}template(){return Be.createElement("div",{class:Be.const("dcg-shared-name-field")},Be.createElement("div",{class:Be.const("dcg-shared-profile-info-container")},Be.createElement("span",{class:Be.const("dcg-shared-profile-info-title"),role:Be.const("heading"),"aria-level":Be.const("1")},()=>this.i18n.s("shared-label-name")),Be.createElement(SO,{type:Be.const("text"),name:Be.const("name"),class:Be.const("dcg-shared-input-blue-outline dcg-shared-profile-info-content"),didMount:this.bindFn(this.didMountName),onInput:this.bindFn(this.onNameInput),"aria-label":()=>this.i18n.s("shared-label-name"),value:()=>this.props.state().name,autocomplete:Be.const("off")})),Be.createElement("div",{class:Be.const("dcg-shared-modal-actions-container")},Be.createElement(WT,{showSavedNotice:this.props.showSavedNotice,i18n:this.props.controller}),Be.createElement("div",{role:Be.const("button"),"aria-disabled":this.bindFn(this.nameFieldDisabled),tabindex:()=>this.nameFieldDisabled()?"-1":"0",class:()=>({"dcg-btn-blue":!0,"dcg-disabled":this.nameFieldDisabled()}),onTap:this.bindFn(this.onSaveName)},()=>this.i18n.s("shared-button-save"))))}onNameInput(e){this.props.updateState({name:e})}didMountName(e){Gc||e.focus()}onSaveName(){this.nameFieldDisabled()||this.props.onSaveName()}nameFieldDisabled(){let e=this.props.state();return!e.name||e.name===e.previousName}},GO=class extends Be.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller}template(){return Be.createElement("div",{class:Be.const("dcg-shared-name-field")},Be.createElement("div",{class:()=>({"dcg-shared-confirm-name":this.props.state().confirm})},Be.createElement(zU,{predicate:()=>this.props.state().confirm},()=>Be.createElement("span",null,()=>this.i18n.s("shared-message-please-review-name"))),Be.createElement("div",{class:Be.const("dcg-shared-profile-info-container")},Be.createElement("div",{class:Be.const("dcg-shared-name-input")},Be.createElement("span",{class:Be.const("dcg-shared-profile-info-title"),role:Be.const("heading"),"aria-level":Be.const("1")},()=>this.i18n.s("shared-label-given-name-or-nickname")),Be.createElement(SO,{type:Be.const("text"),name:Be.const("given-name"),class:Be.const("dcg-shared-input-blue-outline dcg-shared-profile-info-content"),didMount:this.bindFn(this.didMountName),onInput:e=>this.props.updateState({given:e}),"aria-label":()=>this.i18n.s("shared-label-given-name-or-nickname"),value:()=>this.props.state().given,autocomplete:Be.const("off")})),Be.createElement("div",{class:Be.const("dcg-shared-name-input")},Be.createElement("span",{class:Be.const("dcg-shared-profile-info-title"),role:Be.const("heading"),"aria-level":Be.const("1")},()=>this.i18n.s("shared-label-family-name")),Be.createElement(SO,{type:Be.const("text"),name:Be.const("family-name"),class:Be.const("dcg-shared-input-blue-outline dcg-shared-profile-info-content"),onInput:e=>this.props.updateState({family:e}),"aria-label":()=>this.i18n.s("shared-label-family-name"),value:()=>this.props.state().family,autocomplete:Be.const("off")}))),Be.createElement("div",{class:Be.const("dcg-shared-modal-actions-container")},Be.createElement(WT,{i18n:this.props.controller,showSavedNotice:this.props.showSavedNotice}),Be.createElement("div",{role:Be.const("button"),"aria-disabled":()=>!this.canSubmit(),tabindex:()=>this.canSubmit()?"0":"-1",class:()=>({"dcg-btn-blue":!0,"dcg-disabled":!this.canSubmit()}),onTap:this.bindFn(this.onSaveName)},()=>this.props.state().confirm?this.i18n.s("shared-button-confirm-name"):this.i18n.s("shared-button-save")))))}didMountName(e){Gc||e.focus()}onSaveName(){this.canSubmit()&&this.props.onSaveName()}canSubmit(){let e=this.props.state();return e.given?e.confirm?!0:!(e.given===e.previousGiven&&e.family===e.previousFamily):!1}},WT=class extends Be.Class{template(){return Be.createElement(zU,{predicate:()=>this.props.showSavedNotice()},()=>Be.createElement("span",{"aria-live":Be.const("assertive"),"aria-atomic":Be.const("true"),class:Be.const("dcg-shared-confirmation-message")},Be.createElement("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0}),"aria-hidden":Be.const("true")}),()=>this.props.i18n().s("shared-message-information-saved")))}};var to=__dcg_shared_module_exports__['h'](z());var{If:UU}=to.Components,cie=0,TO=1,HU=2,$T=class extends to.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.mode=TO,this.formErrors=[]}template(){return to.createElement("div",{class:to.const("dcg-shared-change-password dcg-shared-account-settings-section")},to.createElement(UU,{predicate:()=>this.mode===TO},()=>to.createElement("div",{class:to.const("dcg-shared-reset-by-email")},to.createElement("div",{class:to.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-change-password-email-sent",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})),to.createElement(Qn,{controller:this.props.controller,errors:()=>this.formErrors}),to.createElement("div",{class:to.const("dcg-shared-modal-actions-container")},to.createElement("div",{role:to.const("button"),"aria-disabled":()=>this.emailDisabled,tabindex:()=>this.emailDisabled?"-1":"0",class:()=>({"dcg-btn-blue":!0,"dcg-disabled":this.emailDisabled}),onTap:()=>this.sendResetPasswordEmail()},()=>this.i18n.s("shared-button-send-email"))))),to.createElement(UU,{predicate:()=>this.mode===HU},()=>to.createElement("div",{"aria-live":to.const("assertive"),"aria-atomic":to.const("true"),class:to.const("dcg-shared-confirmation-message-container")},to.createElement("div",{class:to.const("dcg-shared-confirmation-message")},to.createElement("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0}),"aria-hidden":to.const("true")}),()=>this.i18n.s("shared-message-email-sent")),to.createElement("div",null,()=>this.i18n.s("shared-message-check-email-for-password-link",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})))))}didUnmount(){this.unmounted=!0}onEmailSent(){this.mode=HU,this.unmounted||this.update(),setTimeout(()=>{this.mode=cie,this.unmounted||this.update()},5e3),setTimeout(()=>{this.mode=TO,this.unmounted||this.update()},5200)}onEmailSendingFailed(){this.formErrors=[this.controller.getSomethingWentWrongText()],this.unmounted||this.update()}sendResetPasswordEmail(){this.controller.userController.recoverPassword({email:this.controller.userController.getEmail(),lang:this.controller.getLanguage()}).then(this.bindFn(this.onEmailSent),this.bindFn(this.onEmailSendingFailed))}};xt();var{For:die,Switch:pie}=Wo.Components,jT="profile-info",IO="change-password",YT=class extends Wo.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.settingsView=this.props.initialTab&&this.props.initialTab()||jT,this.breakPoint=660,this.measureWindow()}template(){return Wo.createElement(ko,{title:()=>this.i18n.s("shared-title-account-settings"),size:this.const("wide"),showX:this.const(!0),leftAlignTitle:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},Wo.createElement("div",{class:Wo.const("dcg-shared-account-settings-dialog dcg-shared-account-dialog")},Wo.createElement(die,{each:()=>this.getTabs(),key:e=>""+e.key},Wo.createElement("div",{class:Wo.const("dcg-shared-navigation-tabs"),role:Wo.const("tablist")},e=>Wo.createElement("div",{role:Wo.const("tab"),tabindex:Wo.const("0"),"aria-selected":()=>this.settingsView===e.key,class:()=>({"dcg-shared-tab-gray-underline":!0,[e.class]:!0,"dcg-selected":this.settingsView===e.key}),onTap:()=>this.updateSettingsView(e.key)},e.label))),Wo.createElement("div",{class:Wo.const("dcg-shared-content-container")},Wo.createElement(pie,{key:()=>this.settingsView},e=>e===jT?Wo.createElement(HT,{controller:this.props.controller}):e===IO?Wo.createElement($T,{controller:this.props.controller}):this.props.extraTabs?Wo.createElement("div",{class:Wo.const("dcg-shared-profile-info dcg-shared-account-settings-section")},this.props.extraTabs().createView(e)):Wo.createElement("span",null)))))}getTabs(){let e=[{key:jT,label:this.bindFn(this.profileTitle),class:"profile-view-button"},{key:IO,label:this.bindFn(this.passwordTitle),class:"change-password-view-button"}];return this.props.extraTabs?[...e,...this.props.extraTabs().tabs.map(({key:t,narrowLabel:i,wideLabel:o,class:n})=>({key:t,label:()=>this.windowWidth>this.breakPoint?i():o(),class:`${n}-button`}))]:e}updateSettingsView(e){this.settingsView=e,this.unmounted||this.update()}profileTitle(){return this.windowWidth>this.breakPoint?this.i18n.s("shared-title-profile-information-wide"):this.i18n.s("shared-title-profile-information-narrow")}passwordTitle(){return this.windowWidth>this.breakPoint?this.i18n.s("shared-title-change-password-wide"):this.i18n.s("shared-title-change-password-narrow")}measureWindow(){return this.windowWidth=H(window).width()}didMount(){H(window).on("resize.account-dialog",__dcg_shared_module_exports__['K'](()=>{this.measureWindow(),this.unmounted||this.update()},200))}didUnmount(){H(window).off("resize.account-dialog"),this.unmounted=!0}isProfileSelected(){return this.settingsView===jT}isChangePasswordSelected(){return this.settingsView===IO}};var ti=__dcg_shared_module_exports__['h'](z());var{Input:WU}=ti.Components,JT=class extends ti.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.formErrors=[]}template(){return ti.createElement(ko,{title:()=>this.i18n.s("shared-title-change-email-address"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},ti.createElement("div",{class:ti.const("dcg-shared-change-email dcg-shared-account-dialog")},ti.createElement("div",{class:ti.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-set-new-email-address")),ti.createElement("form",{onSubmit:this.bindFn(this.onSubmit),method:ti.const("post"),class:ti.const("dcg-shared-email-form-container")},ti.createElement("label",null,ti.createElement("span",{class:ti.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-new-email-address")),ti.createElement(WU,{type:ti.const("email"),name:ti.const("newEmail"),class:ti.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-new-email-address"),required:ti.const("true"),didMount:e=>{Gc||e.focus()},value:()=>this.newEmail,onInput:e=>{this.newEmail=e,this.unmounted||this.update()}})),ti.createElement("label",{for:ti.const("password")},ti.createElement("span",null,()=>this.i18n.s("shared-label-password")),ti.createElement(WU,{type:ti.const("password"),class:ti.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-password"),required:ti.const("true"),value:()=>this.password,name:this.const("password"),onInput:e=>{if(this.password=e,!this.unmounted)return this.update()}})),ti.createElement(Qn,{controller:this.props.controller,errors:()=>this.formErrors}),ti.createElement("div",{class:ti.const("dcg-shared-sign-in-options")},ti.createElement("button",{class:()=>({"dcg-btn-blue":!0,"dcg-disabled":!this.submitEnabled()}),"aria-disabled":()=>!this.submitEnabled(),tabindex:()=>this.submitEnabled()?"0":"-1",type:ti.const("submit")},()=>this.i18n.s("shared-button-change-email-and-password"))))))}submitEnabled(){return!!(this.password&&this.newEmail)}didUnmount(){this.unmounted=!0}async onSubmit(e){if(e.preventDefault(),this.submitEnabled())try{await this.controller.userController.setEmail({changeToken:this.getChangeToken(),password:this.password,newEmail:this.newEmail,lang:this.controller.getLanguage()}),this.controller.dispatch({type:"close-modal"}),history.replaceState(null,null,document.location.pathname)}catch(t){t.status===409?this.formErrors=["Sorry, someone has already registered with this email address."]:this.formErrors=[this.controller.getSomethingWentWrongText()],this.unmounted||this.update()}}getChangeToken(){return this.controller.userController.getEmailChangeToken()||""}};var $U="v1.9";var Ah=class extends tm{constructor(e,t,i){super(e,__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{product:"graphing"}),i)}};var XT=class{constructor(e,t){var i=new Pp;for(var o in t)i.config.setProperty(o,t[o]);this.controller=new Bg(i);var n=new kh(e);this.controller.setEvaluator(n),n.readEvaluatorConfig=()=>({product:this.controller.getGraphSettings().config.product,beta3d:t.beta3d,evaluationMode:this.controller.isGeometry()?"geometry":"graphing",globalRandomSeed:i.randomSeed,degreeMode:i.degreeMode,restrictedFunctions:i.config.restrictedFunctions,distributions:i.config.distributions,pointsOfInterest:i.config.pointsOfInterest,plotSingleVariableImplicitEquations:i.config.plotSingleVariableImplicitEquations,plotImplicits:i.config.plotImplicits,plotInequalities:i.config.plotInequalities,sliders:i.config.sliders,actions:i.config.actions}),n.onEvaluatorResults=s=>{this.controller.dispatch({type:"on-evaluator-changes",changes:s.evaluationStates,timingData:s.timingData,eventUpdates:s.eventUpdates})};var a=new kr;a.setProperties({pixelCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0},mathCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0}}),this.graphpaperBounds=a,this.evaluator=n,this.setBlank()}setBlank(e){this.controller.dispatch({type:"set-blank",opts:e})}tick(){this.evaluator.tick()}destroy(){this.evaluator.destroy()}};var py=class{constructor(e){this._calc=new XT(Qb,_G(__dcg_shared_module_exports__['a']({},e))),this.controller=this._calc.controller,this._sharedClockBusToken=Ls(()=>{this._calc.tick()})}destroy(){this._calc.destroy(),Os(this._sharedClockBusToken);function e(n){__dcg_shared_module_exports__['rd'].warn("You've destroyed this API instance. You can no longer call ."+n+"()")}for(var t={},i=this;i;)Object.getOwnPropertyNames(i).forEach(a=>t[a]=!0),i=Object.getPrototypeOf(i);for(var o in t)typeof this[o]=="function"?this[o]=e.bind(this,o):this.hasOwnProperty(o)&&delete this[o];this.destroy=function(){}}setExpression(e){var t=this.controller,i=t.getItemModel(e.id),o=i&&i.type,n=VG(e,o,this.controller);if(n)if(o)this.controller.dispatch({type:"set-expression-properties-from-api",id:n.id,properties:n});else{if(n.type==="image")return;this.controller.dispatch({type:"add-item-to-end-from-api",state:n})}}setExpressions(e){e.forEach(this.setExpression.bind(this))}removeExpression(e){var t=e.id.toString();this.controller.dispatch({type:"remove-item-by-id",id:t})}removeExpressions(e){e.forEach(this.removeExpression.bind(this))}getState(e){return this.controller.getState(e)}getExpressions(){var e=this.getState({stripDefaults:!1}).expressions.list;return e.map(IG)}setBlank(e){this.controller.dispatch({type:"set-blank",opts:e||{}})}setState(e,t){this.controller.dispatch({type:"set-state",state:e,opts:t||{}})}HelperExpression(e){var t=e&&e.latex||"",i=new kr;return i.latex=t,this.controller.dispatch({type:"add-helper-expression",state:{type:"helper-expression",id:this.controller.generateId(),latex:t,proxy:i}}),i}resize(){}};var yy=__dcg_shared_module_exports__['h'](z());var sm=class{constructor(e){if(this.rootElt=e,this.eventModel=new kr,!e)throw new Error("must pass an HTMLElement to the API")}setupDomChangeDetector(e){this.autoSize=e,b0(this.rootElt),this.domChangeDetector=new Zg(this.rootElt,t=>{switch(t.type){case"added":this.view=this.onCreateView(),this.onResizeView(t.size);break;case"removed":this.onDestroyView(),this.view=void 0;break;case"resized":this.onResizeView(t.size);break}}),this.autoSize!==!1?this.domChangeDetector.startWatching():this.domChangeDetector.checkForChanges()}detach(){__dcg_shared_module_exports__['rd'].warn(".detach() is deprecated. It should no longer be necessary")}destroy(){this.view&&this.onDestroyView(),this.domChangeDetector.destroy();function e(n){__dcg_shared_module_exports__['rd'].warn("You've destroyed this API instance. You can no longer call ."+n+"()")}for(var t={},i=this;i;)Object.getOwnPropertyNames(i).forEach(a=>t[a]=!0),i=Object.getPrototypeOf(i);for(var o in t)typeof this[o]=="function"?this[o]=e.bind(this,o):this.hasOwnProperty(o)&&delete this[o];this.destroy=function(){}}resize(){this.domChangeDetector.checkForChanges()}updateView(){this.view&&document.body&&document.body.contains(this.rootElt)&&this.view.update()}triggerEvent(e,t){this.eventModel.triggerEvent(e,t)}observeEvent(e,t){this.eventModel.observeEvent(e,t)}unobserveEvent(e){this.eventModel.unobserveEvent(e)}};var pC=class{constructor({evaluationMode:e,additionalFunctions:t,functionDefinition:i,replaceRoundWithReciprocal:o,workerPool:n}){this._evaluations={};this._nextObjectId=0;this.store=new Zc({expressions:{1:{id:"1",latex:"",braille:"",type:"latex",displayAsFraction:!1}},order:["1"],settings:{degreeMode:!1},ui:{focus:void 0}});this.evaluationMode=e,this.additionalFunctions=t,this.functionDefinition=i,this.replaceRoundWithReciprocal=o,this.workerPool=n,this._setupEvaluator(),this.clear(),this._sharedClockBusToken=Ls(()=>{this._evaluator.tick()})}isSingleExpression(){return this.evaluationMode==="singleExpressionScientific"||this.evaluationMode==="singleExpressionFourFunction"}destroy(){Os(this._sharedClockBusToken)}generateObjectId(){return(this._nextObjectId++).toString()}updateNextObjectId(){let e=this.store.getState().order;this._nextObjectId=0;let t=/^[0-9]+$/;for(let i of e)if(t.test(i)){let o=parseInt(i,10);o>=this._nextObjectId&&(this._nextObjectId=o+1)}}clearShouldDebounceUndoRedo(){this._shouldDebounceUndoRedo=!1}markShouldDebounceUndoRedo(){this._shouldDebounceUndoRedo=!0}getShouldDebounceUndoRedo(){return this._shouldDebounceUndoRedo}clearCachedBrailleValues(){for(let e of this.getExpressionOrder())this.store.set(["expressions",e,"braille"],"")}getState(){return this.store.getState()}getPersistedState(){let{expressions:e,order:t,settings:i}=this.getState();return{expressions:{list:t.map(o=>{var n=e[o];return{id:n.id,latex:n.latex,displayAsFraction:n.displayAsFraction}})},settings:i}}setState(e){this.store.set(e),this._updateIndexes(),this.updateNextObjectId()}setStateFromAPI(e){let t=[],i={};e.expressions.list.forEach(o=>{t.push(o.id),i[o.id]={id:o.id,latex:o.latex,braille:"",type:"latex",displayAsFraction:!!o.displayAsFraction}}),this.setState({expressions:i,order:t,settings:e.settings,ui:{focus:void 0}})}canClear(){if(this.getNumberOfExpressions()>1)return!0;let e=this.getExpressionOrder()[0];return this.getExpressionLatex(e)!==""}clear(){this.setState({expressions:{1:{id:"1",type:"latex",latex:"",braille:"",displayAsFraction:!1}},ui:{focus:void 0},order:["1"],settings:this.getState().settings})}getExpressionOrder(){return this.store.getState().order}getNumberOfExpressions(){return this.getExpressionOrder().length}getExpressionById(e){return this.getState().expressions[e]}getExpressionIndex(e){return this._indexes[e]}_getExpressionByIndex(e){let t=this.getExpressionOrder()[e];return this.getExpressionById(t)}_updateIndexes(){this._indexes={};let e=0;for(let t of this.getExpressionOrder())this._indexes[t]=e,e+=1;this._evaluate()}_usesAnsById(e){return this.getExpressionById(e).latex.indexOf("\\operatorname{ans}")!==-1}_getPreviousExpById(e){let t=this.getExpressionIndex(e);return this._getExpressionByIndex(t-1)}createBlankAfterId(e){if(this.isSingleExpression()||!this.getExpressionById(e).latex)return;let t=this.getExpressionIndex(e),i=this.generateObjectId();this.store.shallowMutate("order",o=>{o.splice(t+1,0,i)}),this.store.shallowMutate("expressions",o=>{o[i]={id:i,latex:"",braille:"",type:"latex",displayAsFraction:!1}}),this._updateIndexes(),this.setFocusedById(i,!0)}conditionallyCopyPrevious(e){let t=this._getPreviousExpById(e),i=this.getExpressionById(e);t!=null&&i.latex===""&&this._usesAnsById(t.id)&&this.setLatexById(e,t.latex)}backspaceAtFrontOfId(e){if(this.getExpressionById(e).latex!==""||this.getNumberOfExpressions()===1)return;let i=this.getExpressionIndex(e);this.store.shallowMutate("order",o=>{o.splice(i,1)}),this.store.shallowMutate("expressions",o=>{delete o[e]}),this._updateIndexes(),this._setFocusedByIndex(Math.max(i-1,0),!0)}setLatexById(e,t){this.store.set(["expressions",e,"latex"],t),this.store.set(["expressions",e,"braille"],""),t===""&&this.setFractionEvaluation(e,!1),this._evaluate()}setLatexAndBrailleById(e,t,i){this.store.set(["expressions",e,"latex"],t),this.store.set(["expressions",e,"braille"],i),t===""&&this.setFractionEvaluation(e,!1),this._evaluate()}setFractionEvaluation(e,t){this.store.set(["expressions",e,"displayAsFraction"],t)}setLatexOfFocusedExpression(e){let t=this.getFocusedExpressionId();t&&this.setLatexById(t,e)}isExpressionFocused(e){return this.getFocusedExpressionId()===e}getExpressionLatex(e){return this.getExpressionById(e).latex}getExpressionError(e){let t=this._evaluations[e];return t?t.error:""}getExpressionValue(e){let t=this._evaluations[e];if(t)return t.value}getExpressionAns(e){let t=this._evaluations[e];if(t)return t.ans}getExpressionAnsId(e){let t=this._evaluations[e];if(t)return t.ansId}shouldShowEvaluationForExpression(e){let t=this._evaluations[e];return t?t.showEvaluation:!1}isRationalizableConstant(e){let t=this._evaluations[e];return t?t.isRationalizableConstant:!1}canDisplayEvaluationAsFraction(e){let t=this.getExpressionValue(e);return t?__dcg_shared_module_exports__['db'](t):!1}_setFocusedByIndex(e,t){let i=this._getExpressionByIndex(e),o=this.store.getState().ui.focus,n=t?{type:"latex-expression",id:i.id}:void 0;if(!__dcg_shared_module_exports__['P'](o,n)){if(o){let a=o.id;this.store.deepMutate("expressions",s=>{var l=s[a];l&&(l.braille="")})}!t&&this.getFocusedExpressionId()!==i.id||this.store.shallowMutate("ui",a=>{a.focus=n})}}setFocusedById(e,t){let i=this.getExpressionIndex(e);this._setFocusedByIndex(i,t)}focusPrevById(e){let t=this.getExpressionIndex(e)-1;t>=0&&this._setFocusedByIndex(t,!0)}focusNextById(e){let t=this.getExpressionIndex(e)+1;t<this.getNumberOfExpressions()?this._setFocusedByIndex(t,!0):this.createAtEnd()}getFocusedExpression(){let e=this.getFocusedExpressionId();if(e)return this.getExpressionById(e)}getFocusedExpressionId(){let e=this.getState().ui.focus;return e&&e.id}clearFocusedExpression(){let e=this.getFocusedExpression();e&&this.setLatexById(e.id,"")}shouldShowClear(){if(this.getNumberOfExpressions()===1)return!1;let e=this.getFocusedExpression();return!!e&&!!e.latex}getLastExpression(){return this._getExpressionByIndex(this.getNumberOfExpressions()-1)}isLastExpressionEmpty(){return!!this.getLastExpression().latex}createAtEnd(){this.createBlankAfterId(this.getLastExpression().id)}focusLastExpression(){this._setFocusedByIndex(this.getNumberOfExpressions()-1,!0)}focusFirstExpression(){this._setFocusedByIndex(0,!0)}getDegreeMode(){return this.getState().settings.degreeMode}setDegreeMode(e){this.store.set(["settings","degreeMode"],!!e),this._evaluate()}_cleanupLatex(e){return e=__dcg_shared_module_exports__['kb'](e),e.substr(e.length-1)==="="&&(e=e.substr(0,e.length-1)),e}_evaluate(){this._evaluator.clearStatementsAndStartCompleteState(),this.getExpressionOrder().forEach(e=>this._evaluator.addStatement({id:e,index:this.getExpressionIndex(e),latex:this._cleanupLatex(this.getExpressionLatex(e)),shouldGraph:!1,type:"statement"}))}_setupEvaluator(){this._evaluator=new kh(this.workerPool),this._evaluator.readEvaluatorConfig=()=>({degreeMode:this.getDegreeMode(),evaluationMode:this.evaluationMode,additionalFunctions:this.additionalFunctions,functionDefinition:this.functionDefinition,replaceRoundWithReciprocal:this.replaceRoundWithReciprocal,actions:!1}),this._evaluator.onEvaluatorResults=e=>{let t=e.evaluationStates;this._evaluations={};for(let n in t){let a=t[n];if(!this.getExpressionById(n))continue;let l=a.constant_value;l===void 0&&a.zero_values&&a.zero_values.length&&(l=a.zero_values[0].val);let c=a.hasOwnProperty("constant_value")&&__dcg_shared_module_exports__['db'](a.constant_value),p=!a.is_evaluable&&c,u=!!a.is_evaluable||p||Array.isArray(l);this._evaluations[n]={error:a.error,ans:void 0,ansId:void 0,value:l,showEvaluation:u,isRationalizableConstant:p}}let i,o;for(let n of this.getExpressionOrder()){let a=this._evaluations[n];if(i&&a){let s=i.value;typeof s=="number"?(a.ans=s,a.ansId=o):Array.isArray(s)&&(a.ans="[...]")}i=a,o=n}typeof this.onEvaluationUpdate=="function"&&this.onEvaluationUpdate()}}reloadState(){this.setState(this.getState())}getFunctionDefinition(){return!!this.functionDefinition}enableFunctionDefinition(){this.functionDefinition=!0,this.reloadState()}disableFunctionDefinition(){this.functionDefinition=!1,this.reloadState()}getReplaceRoundWithReciprocal(){return!!this.replaceRoundWithReciprocal}enableReplaceRoundWithReciprocal(){this.replaceRoundWithReciprocal=!0,this.reloadState()}disableReplaceRoundWithReciprocal(){this.replaceRoundWithReciprocal=!1,this.reloadState()}};yl();var uC=class{constructor(e,t){this.keyboardMode="main";this.fontSize=16;this.invertedColors=!1;this.backgroundColor="";this.textColor="";this.projectorMode=!1;this.capExpressionSize=!1;this.decimalToFraction=!0;this.settingsMenu=!0;this.settingsMenuOpen=!1;this.language="en";this.brailleMode="none";this.sixKeyInput=!1;this.brailleControls=!0;this.brailleExpressionDownload=!0;this.replaceCommaWith10Exp=!1;this.typingAsteriskWritesTimesSymbol=!1;this.stateStack=new tu;this.dispatcher=new Zd;this.s=jl(()=>this.language);this.dispatch=e=>{rg("dispatch",{type:e.type}),this.dispatcher.dispatch(e);let t;for(;t=this._queuedCallbacks.shift();)t()};this._queuedCallbacks=[];this.stateStack=new tu,this.dispatcher=new Zd,this.options=e,this.model=new pC({evaluationMode:this.options.evaluationMode,additionalFunctions:this.options.additionalFunctions,functionDefinition:this.options.functionDefinition,replaceRoundWithReciprocal:this.options.replaceRoundWithReciprocal,workerPool:t.workerPool}),this.model=this.model,this.model.setDegreeMode(e.degreeMode),this.setLanguage(e.language),this.setBrailleMode(e.brailleMode),this.setSixKeyInput(e.sixKeyInput),this.setBrailleControls(e.brailleControls),this.setBrailleExpressionDownload(e.brailleExpressionDownload),this.setReplaceCommaWith10Exp(e.replaceCommaWith10Exp),this.setReplaceRoundWithReciprocal(e.replaceRoundWithReciprocal),this.setTypingAsteriskWritesTimesSymbol(e.typingAsteriskWritesTimesSymbol),this.setProjectorMode(e.projectorMode),this.setCapExpressionSize(e.capExpressionSize),this.setDecimalToFraction(e.decimalToFraction),this.invertedColors=e.invertedColors,this.backgroundColor=e.backgroundColor,this.textColor=e.textColor,this.settingsMenu=e.settingsMenu,this.model.onEvaluationUpdate=()=>this.dispatch({type:"render"}),this.settingsProxy=t.settingsProxy,this.syncPublicSettings(),this.hookUpDispatcher(),this.containerSize={width:0,height:0}}runAfterDispatch(e){this._queuedCallbacks.push(e)}enqueueEvent(e){this.runAfterDispatch(()=>{this.onEventEmitted&&this.onEventEmitted(e)})}getFunctionDefinition(){return this.options.functionDefinition}getSettingsMenu(){return this.settingsMenu}getBrailleMode(){return this.brailleMode}renderAsBraille(){return this.brailleMode!=="none"}setBrailleMode(e){this.brailleMode=e}getSixKeyInput(){return this.sixKeyInput}setSixKeyInput(e){this.sixKeyInput=e}getBrailleControls(){return this.brailleControls}setBrailleControls(e){this.brailleControls=e}getBrailleExpressionDownload(){return this.brailleExpressionDownload}setBrailleExpressionDownload(e){this.brailleExpressionDownload=e}getRestrictedEditing(){return this.options.restrictedEditing}getKeyboardMode(){return this.keyboardMode}getFontSize(){return this.fontSize}getInvertedColors(){return this.invertedColors}hasBackgroundColor(){return this.getBackgroundColor()!=="#ffffff"}getBackgroundColor(){let e=__dcg_shared_module_exports__['k'](this.backgroundColor||"#fff");return this.getInvertedColors()&&e!=="#ffffff"?__dcg_shared_module_exports__['n'](e):e}getTextColor(){let e=__dcg_shared_module_exports__['k'](this.textColor||"#000");return this.getInvertedColors()&&e!=="#000000"?__dcg_shared_module_exports__['n'](e):e}getAdditionalFunctions(){return this.options.additionalFunctions}getTypingSlashWritesDivisionSymbol(){return this.options.typingSlashWritesDivisionSymbol}setTypingAsteriskWritesTimesSymbol(e){this.typingAsteriskWritesTimesSymbol=e}getTypingAsteriskWritesTimesSymbol(){return this.typingAsteriskWritesTimesSymbol}setProjectorMode(e){this.projectorMode=e}isProjectorMode(){return this.projectorMode}getReplaceCommaWith10Exp(){return this.replaceCommaWith10Exp}setReplaceCommaWith10Exp(e){this.replaceCommaWith10Exp=e}getReplaceRoundWithReciprocal(){return this.model.getReplaceRoundWithReciprocal()}setReplaceRoundWithReciprocal(e){e?this.model.enableReplaceRoundWithReciprocal():this.model.disableReplaceRoundWithReciprocal()}setCapExpressionSize(e){this.capExpressionSize=e}getCapExpressionSize(){return this.capExpressionSize}setDecimalToFraction(e){this.decimalToFraction=e}setLanguage(e){e!=="en"&&!iS(e)?__dcg_shared_module_exports__['rd'].warn(`Translation for '${e}' isn't currently available. Using '${this.language}' instead.`):this.language=e}getLanguage(){return this.language}getDecimalToFraction(){return this.decimalToFraction}isScientificCalc(){let e=this.options.evaluationMode;return e==="scientific"||e==="singleExpressionScientific"}isFourFunctionCalc(){return this.options.evaluationMode==="fourFunction"||this.options.evaluationMode==="singleExpressionFourFunction"}getAllowLinks(){return this.options.links}canUndo(){return this.stateStack.canUndo()}canRedo(){return this.stateStack.canRedo()}undo(e){if(!this.canUndo())return;this.stateStack.undo();let t=this.stateStack.getState();if(!e.restoreFocus){let i={focus:void 0};t=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{ui:i})}this.model.setState(t),this.enqueueEvent("change")}redo(e){if(!this.canRedo())return;this.stateStack.redo();let t=this.stateStack.getState();if(!e.restoreFocus){let i={focus:void 0};t=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{ui:i})}this.model.setState(t),this.enqueueEvent("change")}clearHistory(){this.stateStack.clear()}canBackspace(){let e=this.model.getFocusedExpression();return e&&(e.latex.length>0||this.model.getNumberOfExpressions()>1)}focusLastExpression(){this.model.focusLastExpression()}shouldRender(){return this.containerSize.width>0&&this.containerSize.height>0}canClear(){return this.model.canClear()}shouldShowClear(){return this.model.shouldShowClear()}enableSettingsMenu(){this.settingsMenu=!0}disableSettingsMenu(){this.closeSettingsMenu(),this.settingsMenu=!1}closeSettingsMenu(){this.settingsMenuOpen=!1}toggleSettingsMenu(){this.settingsMenuOpen=!this.settingsMenuOpen}isSettingsMenuOpen(){return this.settingsMenuOpen}isLastExpressionEmpty(){return this.model.isLastExpressionEmpty()}createAtEnd(){this.model.createAtEnd()}clearFocusedExpression(){this.model.clearFocusedExpression()}setLatexById(e,t){this.model.setLatexById(e,t)}setLatexAndBrailleById(e,t,i){this.model.setLatexAndBrailleById(e,t,i)}setLatexOfFocusedExpression(e){this.model.setLatexOfFocusedExpression(e)}toggleFractionEvaluationById(e){this.model.setFractionEvaluation(e,!this.model.getExpressionById(e).displayAsFraction)}conditionallyCopyPrevious(e){this.model.conditionallyCopyPrevious(e)}createBlankAfterId(e){this.model.createBlankAfterId(e)}backspaceAtFrontOfId(e){this.model.backspaceAtFrontOfId(e)}areStatesDifferentEnoughForUndoRedo(e,t){let i={focus:void 0};return __dcg_shared_module_exports__['P'](__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},e),{ui:i}),__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{ui:i}))}commitUndoRedoDebounced(){let e=this.model.getState(),t=this.stateStack.getState();if(this.areStatesDifferentEnoughForUndoRedo(e,t))return;let i=new Date().getTime();i-this._lastDebouncedTime<1e3?this.stateStack.replaceState(e):this.stateStack.addState(e),this._lastDebouncedTime=i,this.enqueueEvent("change")}commitUndoRedoSynchronously(){let e=this.model.getState(),t=this.stateStack.getState();this.areStatesDifferentEnoughForUndoRedo(e,t)||(this._lastDebouncedTime=0,this.stateStack.addState(e),this.enqueueEvent("change"))}updateKeyboardMode(e){this.keyboardMode=e}getFocusedMathquill(){if(this.model.getFocusedExpressionId())return _e.getFocusedMathquill()}ensureMathquillIsFocusedAndReturnFocusedMathquill(){let e=this.getFocusedMathquill();return e||(this.isLastExpressionEmpty()&&!this.model.isSingleExpression()?this.createAtEnd():this.focusLastExpression(),this.onEventEmitted&&this.onEventEmitted("render"),this.getFocusedMathquill())}typeIntoFocusedMathquill(e){e=e.replace(/\r|\n/g,"");let t=this.ensureMathquillIsFocusedAndReturnFocusedMathquill();t&&_e.canAcceptText(t,this.getCapExpressionSize(),e)&&(t.typedText(e),this.setLatexOfFocusedExpression(t.latex()),this.model.markShouldDebounceUndoRedo())}pressKeyInFocusedMathquill(e,t){if(this.getBrailleMode()!=="none")return;let i=this.ensureMathquillIsFocusedAndReturnFocusedMathquill();i&&(e==="Up"||e==="Down"||e==="Left"||e==="Right"?_e.applyArrowKeyAndReturnIfWasAtBounds(i,e,t)&&this.moveFocusInDirection(e):e==="Enter"?(t&&(t.preventDefault(),t.stopPropagation()),this.handleEnter()):e==="Backspace"?this.attemptToMoveFocusWithBackspace()||(i.keystroke(e,t),this.setLatexOfFocusedExpression(i.latex())):e==="Delete"?(i.keystroke(e,t),this.setLatexOfFocusedExpression(i.latex())):(i.keystroke(e,t),this.setLatexOfFocusedExpression(i.latex())))}moveFocusInDirection(e){let t=this.model.getFocusedExpressionId();t&&(e==="Up"?this.model.focusPrevById(t):e==="Down"&&this.model.focusNextById(t))}handleEnter(){if(this.model.isSingleExpression())return;let e=this.model.getFocusedExpressionId();e&&(this.conditionallyCopyPrevious(e),this.createBlankAfterId(e))}attemptToMoveFocusWithBackspace(){let e=this.model.getFocusedExpression();if(!e)return!1;let{latex:t,id:i}=e;return t===""?(this.backspaceAtFrontOfId(i),!0):!1}executeCommandInFocusedMathquill(e){let t=this.ensureMathquillIsFocusedAndReturnFocusedMathquill();t&&(wb(t,e,{capExpressionSize:this.getCapExpressionSize()}),this.setLatexOfFocusedExpression(t.latex()))}syncPublicSettings(){this.settingsProxy.setProperty("language",this.language),this.settingsProxy.setProperty("fontSize",this.fontSize),this.settingsProxy.setProperty("degreeMode",this.model.getDegreeMode()),this.settingsProxy.setProperty("invertedColors",this.invertedColors),this.settingsProxy.setProperty("backgroundColor",this.backgroundColor),this.settingsProxy.setProperty("textColor",this.textColor),this.settingsProxy.setProperty("brailleMode",this.brailleMode),this.settingsProxy.setProperty("sixKeyInput",this.sixKeyInput),this.settingsProxy.setProperty("brailleControls",this.brailleControls),this.settingsProxy.setProperty("brailleExpressionDownload",this.brailleExpressionDownload),this.settingsProxy.setProperty("projectorMode",this.projectorMode),this.settingsProxy.setProperty("capExpressionSize",this.capExpressionSize),this.settingsProxy.setProperty("decimalToFraction",this.decimalToFraction),this.settingsProxy.setProperty("qwertyKeyboard",this.options.qwertyKeyboard),this.settingsProxy.setProperty("links",this.options.links),this.settingsProxy.setProperty("settingsMenu",this.settingsMenu),this.settingsProxy.setProperty("functionDefinition",this.model.getFunctionDefinition()),this.settingsProxy.setProperty("replaceCommaWith10Exp",this.replaceCommaWith10Exp),this.settingsProxy.setProperty("replaceRoundWithReciprocal",this.model.getReplaceRoundWithReciprocal()),this.settingsProxy.setProperty("typingAsteriskWritesTimesSymbol",this.typingAsteriskWritesTimesSymbol)}hookUpDispatcher(){this.dispatcher.register(e=>{this.enqueueEvent("render");let t=!1,i=this.getRestrictedEditing();switch(e.type){case"update-options":{this.options=__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},this.options),e.options);break}case"keypad/shift":{let s;switch(this.keyboardMode){case"qwerty":s="capitalQwerty";break;case"capitalQwerty":s="qwerty";break;case"letters":s="capitalLetters";break;case"capitalLetters":s="letters";break;default:s="qwerty"}this.updateKeyboardMode(s)}break;case"undo":i||(this.undo({restoreFocus:e.source==="keyboard-shortcut"}),t=!0);break;case"redo":i||(this.redo({restoreFocus:e.source==="keyboard-shortcut"}),t=!0);break;case"clear-history":this.clearHistory();break;case"set-state-from-api":e.opts.allowUndo||this.clearHistory(),this.model.setStateFromAPI(e.state);break;case"main":this.updateKeyboardMode("main");break;case"ABC":this.options.qwertyKeyboard?this.updateKeyboardMode("qwerty"):this.updateKeyboardMode("letters");break;case"functions":this.updateKeyboardMode("functions");break;case"degrees":this.model.setDegreeMode(!this.model.getDegreeMode());break;case"update-degree-mode":this.model.setDegreeMode(!!e.mode);break;case"update-font-size":var o=e.size;if(typeof o!="number"&&(o=parseInt(o,10)),isNaN(o))return;this.fontSize=o;break;case"update-inverted-colors":this.invertedColors=!!e.mode;break;case"update-background-color":this.backgroundColor=e.color;break;case"update-text-color":this.textColor=e.color;break;case"update-projector-mode":this.setProjectorMode(!!e.mode);break;case"update-cap-expression-size":this.setCapExpressionSize(!!e.mode);break;case"update-decimal-to-fraction":this.setDecimalToFraction(!!e.mode);break;case"update-language":this.setLanguage(e.language);break;case"set-blank":e.opts.allowUndo||this.clearHistory(),this.model.clear(),this.focusLastExpression();break;case"clear":this.model.clearFocusedExpression();break;case"set-braille-mode":let n=e.mode;n!=="nemeth"&&n!=="ueb"&&n!=="none"?__dcg_shared_module_exports__['rd'].warn(`Valid Braille modes are 'nemeth', 'none', and 'ueb'. You passed '${n}'.`):(this.model.clearCachedBrailleValues(),this.setBrailleMode(e.mode));break;case"set-six-key-input":this.setSixKeyInput(!!e.mode);break;case"set-braille-controls":this.setBrailleControls(!!e.value);break;case"set-braille-expression-download":this.setBrailleExpressionDownload(!!e.mode);break;case"set-replace-comma-with-10-exp":this.setReplaceCommaWith10Exp(!!e.replace);break;case"set-replace-round-with-reciprocal":this.setReplaceRoundWithReciprocal(!!e.replace);break;case"set-typing-asterisk-writes-times-symbol":this.setTypingAsteriskWritesTimesSymbol(!!e.mode);break;case"update-latex":this.model.markShouldDebounceUndoRedo(),this.setLatexById(e.id,e.latex);break;case"update-latex-from-braille":this.model.markShouldDebounceUndoRedo(),this.setLatexAndBrailleById(e.id,e.latex,e.braille);break;case"focusin":this.model.setFocusedById(e.id,!0);break;case"focusout":this.model.setFocusedById(e.id,!1);break;case"focus-first-expression":this.model.focusFirstExpression();break;case"focus-prev-expression":this.moveFocusInDirection("Up");break;case"focus-next-expression":this.moveFocusInDirection("Down");break;case"focus-last-expression":this.model.focusLastExpression();break;case"insert-blank-expression":this.handleEnter();break;case"backspace-from-braille":this.attemptToMoveFocusWithBackspace();break;case"keypad/type-text":this.typeIntoFocusedMathquill(e.text);break;case"keypad/press-key":this.pressKeyInFocusedMathquill(e.key,e.evt);break;case"keypad/custom-command":this.executeCommandInFocusedMathquill(e.command);break;case"keypad/123":case"keypad/abc":case"keypad/audio-trace":break;case"enable-settings-menu":this.enableSettingsMenu();break;case"disable-settings-menu":this.disableSettingsMenu();break;case"toggle-settings-menu":this.toggleSettingsMenu();break;case"close-settings-menu":this.closeSettingsMenu();break;case"render":break;case"ui/container-resized":this.containerSize=e.size;break;case"toggle-fraction-evaluation":this.toggleFractionEvaluationById(e.id);break;default:return e}this.runAfterDispatch(()=>this.syncPublicSettings()),t||(this.model.getShouldDebounceUndoRedo()?(this.commitUndoRedoDebounced(),this.model.clearShouldDebounceUndoRedo()):this.commitUndoRedoSynchronously())})}getMathquillConfig(){let e=this.getAdditionalFunctions(),t=this.isFourFunctionCalc()&&(!e||e.indexOf("fraction")===-1);return{typingAsteriskWritesTimesSymbol:this.getTypingAsteriskWritesTimesSymbol(),typingSlashWritesDivisionSymbol:this.getTypingSlashWritesDivisionSymbol(),disableCopyPaste:this.getRestrictedEditing(),autoCommands:qd({disallowFrac:t}),autoOperatorNames:Ys()}}};var xr=__dcg_shared_module_exports__['h'](z());var jU=__dcg_shared_module_exports__['h'](z()),ur=class extends jU.Class{init(){this.controller=this.props.controller(),this.model=this.controller.model,this.dispatch=this.controller.dispatch,this.s=this.controller.s}};var mo=__dcg_shared_module_exports__['h'](z());var lm=__dcg_shared_module_exports__['h'](z());var Pl=class extends du{template(){return lm.createElement("div",{class:lm.const("dcg-keypad-control-bar dcg-do-not-blur"),role:lm.const("group"),"aria-label":()=>this.controller.s("shared-calculator-narration-keypad-controlbar")},lm.createElement("div",{class:lm.const("dcg-keypad-control-bar-contents")},this.children))}};var uy=__dcg_shared_module_exports__['h'](z()),ci=class extends uy.Class{template(){return uy.createElement("div",{class:()=>({"dcg-keypad-control-btn":!0,"dcg-disabled":this.isDisabled(),"dcg-selected":!this.isDisabled()&&this.isSelected(),"dcg-selectable-btn":!this.isDisabled()&&this.isSelectable(),"dcg-narrow-control-btn":this.props.narrowButton&&this.props.narrowButton()}),didMount:this.bindFn(this.didMount),role:uy.const("button"),"aria-disabled":()=>this.isDisabled()||void 0,"aria-label":()=>this.getAriaLabel(),"dcg-command":this.props.command,onTap:this.bindFn(this.handleTap),"aria-pressed":()=>!this.hasPopup()&&!this.isDisabled()&&this.isSelectable()?this.isSelected():void 0,"aria-expanded":()=>this.hasPopup()&&!this.isDisabled()?this.isSelected():void 0,tabindex:this.bindFn(this.getTabIndex)},this.children)}getTabIndex(){if(!this.isDisabled())return this.props.ignoreInTabOrder&&this.props.ignoreInTabOrder()?-1:0}handleTap(e){this.isDisabled()||this.props.onTap(e)}getAriaLabel(){return this.props.ariaLabel?this.props.ariaLabel():this.props.command()}hasPopup(){return this.props.ariaPopup?this.props.ariaPopup():!1}isDisabled(){return this.props.disabled?this.props.disabled():!1}isSelected(){return this.props.selected?this.props.selected():!1}isSelectable(){return this.props.selectable?this.props.selectable():!1}didMount(e){this.props.didMount&&this.props.didMount(e)}};var mc=__dcg_shared_module_exports__['h'](z());var Cr=__dcg_shared_module_exports__['h'](z());xt();var ap=__dcg_shared_module_exports__['h'](z());function uie(){if(!s_)return!1;let r=navigator.userAgent.match(/Version\/(\d+)/);return!r||!r[1]?!1:parseFloat(r[1])<11}function YU(){return!l_&&!uie()&&typeof document.createElement("a").download!="undefined"}function QT(){return YU()||navigator.msSaveBlob!==void 0}var mu=class extends ap.Class{init(){this.supportsDirectDownload=YU()}template(){return ap.createElement("a",{role:ap.const("button"),tabindex:()=>this.props.enabled()?0:-1,"aria-disabled":()=>!this.props.enabled(),class:()=>({"dcg-download-button":!0,"dcg-disabled":!this.props.enabled(),"dcg-braille-equations":this.props.isBraille,"dcg-svg-button":this.props.isSvg}),didMount:this.bindFn(this.didMountDownload),didUnmount:this.bindFn(this.didUnmountDownload),didUpdate:this.bindFn(this.didUpdate),download:()=>this.supportsDirectDownload?this.props.filename():void 0,onTap:e=>{if(this.supportsDirectDownload||!navigator.msSaveOrOpenBlob)return;let t=this.props.data();t&&(navigator.msSaveOrOpenBlob(t,this.props.filename()),e.preventDefault())}},ap.createElement("i",{class:ap.const("dcg-icon-download"),"aria-hidden":ap.const("true")}),ap.createElement("span",null,()=>this.props.text()))}didMountDownload(e){this.downloadLink=e,this.didUpdate()}didUnmountDownload(){this.revokeBlobURL()}didUpdate(){this.updateDownloadURL(),this.cachedObjectURL&&(this.downloadLink.href=this.cachedObjectURL)}updateDownloadURL(){if(this.revokeBlobURL(),!this.supportsDirectDownload)return;let e=this.props.data();e&&(this.cachedObjectURL=URL.createObjectURL(e))}revokeBlobURL(){this.cachedObjectURL&&URL.revokeObjectURL(this.cachedObjectURL)}};function Lo(r,e,t=!1){if(t&&(r=r.replace(/ /g,"\\ ")),e==="none")return r;let i=e==="nemeth"?Xp(r):Qp(r);return i.isError?"":Ba.toBrailleAscii(i.value)}function JU(r,e){if(e==="none")return"";let t=[];t.push(Lo("Expression List",e,!0)),t.push(""),t.push("");let i="",o=r.getItemCount();for(let n=0;n<o;n++){let a=r.getItemModelByIndex(n);if(a&&!a.secret){i!==""&&a.type!=="folder"&&i!==a.folderId&&(t.push(hC(Lo("End Folder",e,!0))),i="");let s="";switch(a.type){case"expression":if(!a.hidden){let c=QU(a.displayIndex,e);s=a.latex;let p=[],u=a.formula;if(u&&!Us(a)){if(r.shouldShowEvaluationForItem(a.id)){let m=u.zero_values&&u.zero_values.length?u.zero_values[0].val:u.constant_value;Array.isArray(m)?s+=`\\ ${m.length}\\ element\\ list`:s+=`=${m}`}else if(Pd(a))p.push(Lo(`Min=${_x(a)}`,e,!1)),p.push(Lo(`Max=${Fx(a)}`,e,!1)),Nx(a)&&Rx(a)&&p.push(Lo(`CDF=${BS(a)}`,e,!1));else if(OS(a)){let m=df(a);m&&(p.push(Lo(`<${__dcg_shared_module_exports__['tc'](m.lessThan,5)}`,e,!1)),p.push(Lo(`>${__dcg_shared_module_exports__['tc'](m.greaterThan,5)}`,e,!1)),p.push(Lo(`\\ne${__dcg_shared_module_exports__['tc'](m.notEqual,5)}`,e,!1)))}else if(u.is_regression&&u.regression){let m=u.regression,h=m.statistics,x=m.parameters;h.hasOwnProperty("Rsquared")&&p.push(Lo(`R^2=${Al(m,"Rsquared")}`,e,!1)),h.hasOwnProperty("rsquared")&&p.push(Lo(`r^2=${Al(m,"rsquared")}`,e,!1)),h.hasOwnProperty("r")&&p.push(Lo(`r=${Al(m,"r")}`,e,!1)),h.hasOwnProperty("RMSE")&&p.push(Lo(`\\operatorname{RMSE}=${Al(m,"RMSE")}`,e,!1));for(let C in x)p.push(Lo(`${C}=${v0(m,C)}`,e,!1))}}t.push(`${c}  ${Lo(s,e,!1)}`),t.push.apply(t,p)}break;case"text":t.push(Lo(a.text,e,!0));break;case"folder":a.collapsed?s=`Collapsed Folder ${a.title}`:(s=`Start Folder ${a.title}`,i=a.id),t.push(hC(Lo(s,e,!0)));break;case"image":t.push(Lo("Image",e,!1));break;case"table":t.push(hC(Lo("Start Table",e,!0)));for(let c=0;c<Sl(a);c++){let p=[],u;for(let h=0;h<Uf(a);h++)c===0?u=a.columnModels[h].latex||"":u=$x(a,c-1,h),p.push(Lo(u,e));let m=p.join("	");/^\t/.test(m)||t.push(m)}t.push(hC(Lo("End Table",e,!0)));break;default:return a}}}return i!==""&&t.push(hC(Lo("End Folder",e,!0))),t.join(`
`)}function XU(r,e){if(e==="none")return"";let t=[];t.push(Lo("Expression List",e,!0)),t.push(""),t.push("");for(let i of r.getExpressionOrder()){let o=QU(r.getExpressionIndex(i)+1,e),n=r.getExpressionLatex(i),a=r.getExpressionValue(i);a!==void 0&&(n+=`=${a}`),t.push(`${o}  ${Lo(n,e,!1)}`)}return t.join(`
`)}function hC(r){let e="--------------------";return`${e}
${r}
${e}`}function QU(r,e){let t=""+r;return e==="nemeth"?`${Lo(t,e,!1)}_4`:e==="ueb"?Lo(`${t}.`,e,!1):""}var{If:ZT}=Cr.Components,eI=class extends ur{template(){return Cr.createElement("div",{class:()=>({"dcg-settings-dropdown":!0,"dcg-popover":!0,"dcg-has-background-color":this.controller.hasBackgroundColor(),"dcg-point-left":this.controller.containerSize.height<=420}),role:Cr.const("region"),"aria-label":Cr.const("Settings Menu"),didMount:this.bindFn(this.didMountSettingsDropdown),didUnmount:this.bindFn(this.didUnmountSettingsDropdown)},Cr.createElement("div",{class:Cr.const("dcg-popover-interior"),style:()=>({background:this.controller.getBackgroundColor()})},Cr.createElement("div",{class:()=>({"dcg-settings-menu-option":!0,"dcg-displaysize-container":!0})},Cr.createElement(_r,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size"),staticConfig:this.bindFn(this.getProjectorModeOptions)})),Cr.createElement(st,{onChange:this.bindFn(this.onToggleInvertedColors),checked:()=>this.controller.getInvertedColors(),class:this.const("dcg-settings-menu-option dcg-do-not-blur dcg-reverse-contrast")},Cr.createElement("span",{class:Cr.const("dcg-checkbox-label")},()=>this.controller.s("basic-calculator-label-reverse-contrast"))),Cr.createElement(ZT,{predicate:()=>this.controller.getBrailleControls()},()=>Cr.createElement("div",null,Cr.createElement(st,{onChange:this.bindFn(this.onToggleBrailleMode),checked:()=>this.controller.renderAsBraille(),class:this.const("dcg-settings-menu-option dcg-do-not-blur dcg-braille-mode")},Cr.createElement("span",{class:Cr.const("dcg-checkbox-label")},()=>this.controller.s("shared-calculator-narration-braille-mode"))),Cr.createElement(ZT,{predicate:()=>this.controller.renderAsBraille()},()=>Cr.createElement("div",{class:()=>({"dcg-settings-menu-option":!0,"dcg-braille-container":!0})},Cr.createElement(_r,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-braille-mode"),staticConfig:this.bindFn(this.getBrailleOptions)}),Cr.createElement("div",{class:Cr.const("dcg-braille-options-container")},Cr.createElement(st,{onChange:()=>this.onToggleSixKeyInput(),checked:()=>this.controller.getSixKeyInput(),class:this.const("dcg-settings-menu-option dcg-do-not-blur dcg-six-key-checkbox")},Cr.createElement("span",{class:Cr.const("dcg-checkbox-label")},()=>this.controller.s("basic-calculator-label-six-key-input"))),Cr.createElement("a",{href:Cr.const("https://www.desmos.com/accessibility#braille"),class:Cr.const("dcg-six-key-info"),target:Cr.const("_blank")},Cr.createElement("i",{class:Cr.const("dcg-icon-question-sign"),"aria-hidden":Cr.const("true")})),Cr.createElement(ZT,{predicate:()=>!ul&&QT()&&this.controller.getBrailleExpressionDownload()},()=>Cr.createElement(mu,{data:()=>{let e=XU(this.model,this.controller.getBrailleMode());return new Blob([e],{type:"text/plain"})},enabled:this.const(!0),filename:this.const("desmos-equations.brl"),text:()=>this.controller.s("basic-calculator-link-download-braille-equations"),isBraille:this.const(!0)}))))))),Cr.createElement(ZT,{predicate:()=>!!this.getVersionNumber()},()=>Cr.createElement("div",{class:Cr.const("dcg-version-number")},Cr.const("Version: "),()=>this.getVersionNumber()))))}getBrailleOptions(){return[{key:"nemeth",label:()=>this.controller.s("shared-calculator-button-braille-mode-nemeth"),selected:()=>this.isNemeth(),onSelect:()=>this.setBrailleMode("nemeth")},{key:"ueb",label:()=>this.controller.s("shared-calculator-button-braille-mode-ueb"),selected:()=>!this.isNemeth(),onSelect:()=>this.setBrailleMode("ueb")}]}setBrailleMode(e){this.controller.dispatch({type:"set-braille-mode",mode:e})}getProjectorModeOptions(){return[{key:"default",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-default"),class:()=>"dcg-displaysize-default",selected:()=>!this.getProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!1)},{key:"large",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-large"),class:()=>"dcg-displaysize-large",selected:()=>this.getProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!0)}]}onSelectProjectorModeOption(e){this.controller.dispatch({type:"update-projector-mode",mode:e})}getVersionNumber(){let e=window;if(e&&e.AppBridge)return e.AppBridge.versionNumber}didUnmountSettingsDropdown(){H(document).off(".dcg-settings-view")}didMountSettingsDropdown(e){this.settingsGroupNode=e,H(document).on("dcg-tapstart.dcg-settings-view",t=>{t.target.closest(".dcg-basic-settings-container")||this.controller.dispatch({type:"close-settings-menu"})}),H(document).on("keydown.dcg-settings-view",t=>{if(Ee(t)==="Esc"&&(this.controller.dispatch({type:"close-settings-menu"}),this.controller.dispatch({type:"focus-last-expression"})),Ee(t)==="Tab"&&!t.altKey&&!t.metaKey&&!t.ctrlKey){let i=document.activeElement,o=this.props.settingsButtonNode(),n=[...this.settingsGroupNode.querySelectorAll(".dcg-settings-menu-option")].slice(-1)[0];!t.shiftKey&&i===n?(o.focus(),t.preventDefault(),t.stopPropagation()):t.shiftKey&&i===o&&(n.focus(),t.preventDefault(),t.stopPropagation())}})}onToggleBrailleMode(){this.controller.dispatch({type:"set-braille-mode",mode:this.controller.renderAsBraille()?"none":"nemeth"})}isNemeth(){return this.controller.getBrailleMode()==="nemeth"}isUEB(){return this.controller.getBrailleMode()==="ueb"}isLatex(){return this.controller.getBrailleMode()==="none"}onToggleSixKeyInput(){let e=!this.controller.getSixKeyInput();this.controller.dispatch({type:"set-six-key-input",mode:e})}onToggleInvertedColors(){let e=!this.controller.getInvertedColors();this.controller.dispatch({type:"update-inverted-colors",mode:e})}getProjectorMode(){return this.controller.isProjectorMode()}};var{If:hie}=mc.Components,hy=class extends ur{template(){let r=this.props.controller();return mc.createElement("div",{class:mc.const("dcg-basic-settings-container")},mc.createElement(ci,{didMount:e=>this.settingsButtonNode=e,command:this.const("settings"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-settings"),onTap:this.bindFn(this.onToggleSettingsMenu),selected:()=>this.controller.isSettingsMenuOpen(),ariaPopup:this.const(!0)},mc.createElement("i",{class:mc.const("dcg-icon-wrench"),"aria-hidden":mc.const("true")})),mc.createElement(hie,{predicate:()=>this.controller.isSettingsMenuOpen()},()=>mc.createElement(eI,{controller:this.props.controller,settingsButtonNode:()=>this.settingsButtonNode})))}onToggleSettingsMenu(){this.controller.dispatch({type:"toggle-settings-menu"})}};var{If:gC,IfElse:gie}=mo.Components,tI=class extends ur{template(){let r=this.props.controller();return mo.createElement(Pl,{controller:this.props.controller},mo.createElement(gC,{predicate:()=>!this.controller.getRestrictedEditing()},()=>mo.createElement(ci,{command:this.const("undo"),disabled:()=>!r.canUndo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-undo"),onTap:e=>r.dispatch({type:"undo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},mo.createElement("i",{class:mo.const("dcg-icon-undo"),"aria-hidden":mo.const("true")}))),mo.createElement(gC,{predicate:()=>!this.controller.getRestrictedEditing()},()=>mo.createElement(ci,{command:this.const("redo"),disabled:()=>!r.canRedo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-redo"),onTap:e=>r.dispatch({type:"redo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},mo.createElement("i",{class:mo.const("dcg-icon-redo"),"aria-hidden":mo.const("true")}))),gie(()=>r.shouldShowClear(),{true:()=>mo.createElement(ci,{command:this.const("clear"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-clear"),onTap:()=>r.dispatch({type:"clear"})},()=>r.s("basic-calculator-button-controlbar-clear")),false:()=>mo.createElement(ci,{command:this.const("clearall"),disabled:()=>!r.canClear(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-clear-all"),onTap:()=>r.dispatch({type:"set-blank",opts:{allowUndo:!0}})},()=>r.s("basic-calculator-button-controlbar-clear-all"))}),mo.createElement(gC,{predicate:()=>this.controller.getRestrictedEditing()},()=>mo.createElement("div",{class:mo.const("dcg-spacer-2")})),mo.createElement(gC,{predicate:()=>r.getBrailleMode()==="none"},()=>mo.createElement(ci,{command:this.const("backspace"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-backspace"),disabled:()=>!r.canBackspace(),onTap:()=>r.dispatch({type:"keypad/press-key",key:"Backspace"})},mo.createElement("i",{class:mo.const("dcg-icon-delete"),"aria-hidden":mo.const("true")}))),mo.createElement(gC,{predicate:()=>this.props.controller().getSettingsMenu()},()=>mo.createElement(hy,{controller:this.props.controller})))}onToggleSettingsMenu(){this.controller.dispatch({type:"toggle-settings-menu"})}};var $o=__dcg_shared_module_exports__['h'](z());var{If:rI}=$o.Components,iI=class extends ur{template(){let r=this.props.controller();return $o.createElement(Pl,{controller:this.props.controller},$o.createElement(rI,{predicate:()=>!this.controller.getRestrictedEditing()},()=>$o.createElement(ci,{command:this.const("undo"),disabled:()=>!r.canUndo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-undo"),onTap:e=>r.dispatch({type:"undo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},$o.createElement("i",{class:$o.const("dcg-icon-undo"),"aria-hidden":$o.const("true")}))),$o.createElement(rI,{predicate:()=>!this.controller.getRestrictedEditing()},()=>$o.createElement(ci,{command:this.const("redo"),disabled:()=>!r.canRedo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-redo"),onTap:e=>r.dispatch({type:"redo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},$o.createElement("i",{class:$o.const("dcg-icon-redo"),"aria-hidden":$o.const("true")}))),$o.createElement(ci,{command:this.const("clear"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-clear"),onTap:()=>r.dispatch({type:"clear"})},()=>r.s("basic-calculator-button-controlbar-clear")),$o.createElement(rI,{predicate:()=>this.controller.getRestrictedEditing()},()=>$o.createElement("div",{class:$o.const("dcg-spacer-2")})),$o.createElement(rI,{predicate:()=>r.getBrailleMode()==="none"},()=>$o.createElement(ci,{command:this.const("backspace"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-backspace"),disabled:()=>!r.canBackspace(),onTap:()=>r.dispatch({type:"keypad/press-key",key:"Backspace"})},$o.createElement("i",{class:$o.const("dcg-icon-delete"),"aria-hidden":$o.const("true")}))))}};var ln=__dcg_shared_module_exports__['h'](z());var sd=__dcg_shared_module_exports__['h'](z());var cm=class extends du{template(){return sd.createElement("div",{class:()=>({"dcg-keypad-control-toggle":!0,"dcg-toggled":this.props.toggled()}),role:sd.const("button"),tabindex:sd.const("0"),"aria-label":this.bindFn(this.getAriaLabel),onTap:this.bindFn(this.handleTap)},sd.createElement("div",{class:sd.const("dcg-ctrl-toggle-option")},this.props.defaultOption),sd.createElement("div",{class:sd.const("dcg-ctrl-toggle-option")},this.props.toggledOption),sd.createElement("div",{class:sd.const("dcg-ctrl-toggle-cover"),style:()=>({background:__dcg_shared_module_exports__['m'](this.controller.getBackgroundColor(),-.1)})}))}getAriaLabel(){let e={toggled:this.props.toggledAriaLabel(),default:this.props.defaultAriaLabel()};return this.props.toggled()?this.controller.s("shared-calculator-narration-control-toggle-switch-to-default",e):this.controller.s("shared-calculator-narration-control-toggle-switch-to-toggled",e)}handleTap(){this.props.toggled()?be(this.props.defaultAriaLabel()):be(this.props.toggledAriaLabel()),this.props.onTap(this.props.command())}};var{If:VO,IfElse:mie}=ln.Components,oI=class extends ur{template(){let r=this.props.controller();return ln.createElement(Pl,{controller:this.props.controller},ln.createElement(ci,{command:this.const("main"),selected:()=>r.getKeyboardMode()==="main",disabled:()=>this.controller.renderAsBraille(),ignoreInTabOrder:this.const(!0),selectable:this.const(!0),onTap:()=>r.dispatch({type:"main"}),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-main")},()=>r.s("basic-calculator-button-controlbar-main")),ln.createElement(ci,{command:this.const("ABC"),selected:()=>["qwerty","capitalQwerty","letters"].indexOf(r.getKeyboardMode())!==-1,disabled:()=>this.controller.renderAsBraille(),ignoreInTabOrder:this.const(!0),selectable:this.const(!0),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-abc"),onTap:()=>r.dispatch({type:"ABC"})},()=>r.s("basic-calculator-button-controlbar-abc")),ln.createElement(ci,{command:this.const("functions"),selected:()=>["functions","restrictedFunctions"].indexOf(r.getKeyboardMode())!==-1,ariaLabel:()=>r.s("basic-calculator-narration-controlbar-functions"),disabled:()=>this.controller.renderAsBraille(),ignoreInTabOrder:this.const(!0),selectable:this.const(!0),onTap:()=>r.dispatch({type:"functions"})},()=>r.s("basic-calculator-button-controlbar-func")),ln.createElement(cm,{command:this.const("degrees"),toggled:()=>this.model.getDegreeMode(),defaultOption:()=>r.s("basic-calculator-label-controlbar-rad"),toggledOption:()=>r.s("basic-calculator-label-controlbar-deg"),defaultAriaLabel:()=>r.s("basic-calculator-narration-controlbar-radians"),toggledAriaLabel:()=>r.s("basic-calculator-narration-controlbar-degrees"),onTap:()=>r.dispatch({type:"degrees"}),controller:this.props.controller}),ln.createElement(VO,{predicate:()=>!this.controller.getRestrictedEditing()},()=>ln.createElement(ci,{command:this.const("undo"),disabled:()=>!r.canUndo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-undo"),onTap:e=>r.dispatch({type:"undo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},ln.createElement("i",{class:ln.const("dcg-icon-undo"),"aria-hidden":ln.const("true")}))),ln.createElement(VO,{predicate:()=>!this.controller.getRestrictedEditing()},()=>ln.createElement(ci,{command:this.const("redo"),disabled:()=>!r.canRedo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-redo"),onTap:e=>r.dispatch({type:"redo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},ln.createElement("i",{class:ln.const("dcg-icon-redo"),"aria-hidden":ln.const("true")}))),mie(()=>r.shouldShowClear(),{true:()=>ln.createElement(ci,{command:this.const("clear"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-clear"),onTap:()=>r.dispatch({type:"clear"})},()=>r.s("basic-calculator-button-controlbar-clear")),false:()=>ln.createElement(ci,{command:this.const("clearall"),disabled:()=>!r.canClear(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-clear-all"),onTap:()=>r.dispatch({type:"set-blank",opts:{allowUndo:!0}})},()=>r.s("basic-calculator-button-controlbar-clear-all"))}),ln.createElement(VO,{predicate:()=>this.props.controller().getSettingsMenu()},()=>ln.createElement(hy,{controller:this.props.controller})))}};var Oo=__dcg_shared_module_exports__['h'](z());var{If:e6}=Oo.Components,nI=class extends ur{template(){let r=this.props.controller();return Oo.createElement(Pl,{controller:this.props.controller},Oo.createElement(cm,{command:this.const("degrees"),toggled:()=>this.model.getDegreeMode(),defaultOption:()=>r.s("basic-calculator-label-controlbar-rad"),toggledOption:()=>r.s("basic-calculator-label-controlbar-deg"),defaultAriaLabel:()=>r.s("basic-calculator-narration-controlbar-radians"),toggledAriaLabel:()=>r.s("basic-calculator-narration-controlbar-degrees"),onTap:()=>r.dispatch({type:"degrees"}),controller:this.props.controller}),Oo.createElement("div",{class:Oo.const("dcg-spacer")}),Oo.createElement(e6,{predicate:()=>!this.controller.getRestrictedEditing()},()=>Oo.createElement(ci,{command:this.const("undo"),disabled:()=>!r.canUndo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-undo"),onTap:e=>r.dispatch({type:"undo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},Oo.createElement("i",{class:Oo.const("dcg-icon-undo"),"aria-hidden":Oo.const("true")}))),Oo.createElement(e6,{predicate:()=>!this.controller.getRestrictedEditing()},()=>Oo.createElement(ci,{command:this.const("redo"),disabled:()=>!r.canRedo(),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-redo"),onTap:e=>r.dispatch({type:"redo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},Oo.createElement("i",{class:Oo.const("dcg-icon-redo"),"aria-hidden":Oo.const("true")}))),Oo.createElement("div",{class:Oo.const("dcg-spacer")}),Oo.createElement(ci,{narrowButton:this.const(!0),command:this.const("clear"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-clear"),onTap:()=>r.dispatch({type:"clear"})},()=>r.s("basic-calculator-button-controlbar-clear")),Oo.createElement(ci,{narrowButton:this.const(!0),command:this.const("backspace"),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-backspace"),onTap:()=>r.dispatch({type:"keypad/press-key",key:"Backspace"})},Oo.createElement("i",{class:Oo.const("dcg-icon-delete"),"aria-hidden":Oo.const("true")})))}};var sp=__dcg_shared_module_exports__['h'](z());var mC=class extends ur{template(){return sp.createElement("div",{role:sp.const("region"),"aria-label":()=>this.s("shared-calculator-narration-keypad")},sp.createElement(rr,{controller:this.props.controller},sp.createElement(Ve,null,w(this,"(",{colspan:this.parenColspan()}),w(this,")",{colspan:this.parenColspan()}),this.makeAdditionalFunctionKey(0),this.makeAdditionalFunctionKey(1),w(this,"division")),sp.createElement(Ve,null,w(this,"7",{style:"highlight"}),w(this,"8",{style:"highlight"}),w(this,"9",{style:"highlight"}),w(this,"multiplication")),sp.createElement(Ve,null,w(this,"4",{style:"highlight"}),w(this,"5",{style:"highlight"}),w(this,"6",{style:"highlight"}),w(this,"-")),sp.createElement(Ve,null,w(this,"1",{style:"highlight"}),w(this,"2",{style:"highlight"}),w(this,"3",{style:"highlight"}),w(this,"+")),sp.createElement(Ve,null,w(this,"0",{style:"highlight"}),w(this,".",{style:"highlight"}),w(this,"ans"),w(this,"enter",{style:"blue"}))))}parenColspan(){return this.controller.getAdditionalFunctions().length>1?.5:1}makeAdditionalFunctionKey(e){let t=this.controller.getAdditionalFunctions()[e];return t==="exponent"?w(this,"a^b"):t==="percent"?w(this,"%"):t==="sqrt"?w(this,"sqrt"):t==="fraction"?w(this,"a/b"):void 0}};var lp=__dcg_shared_module_exports__['h'](z());var fC=class extends ur{template(){return lp.createElement("div",{role:lp.const("region"),"aria-label":()=>this.s("shared-calculator-narration-keypad")},lp.createElement(rr,{controller:this.props.controller},lp.createElement(Ve,null,w(this,"(",{colspan:this.parenColspan()}),w(this,")",{colspan:this.parenColspan()}),this.makeAdditionalFunctionKey(1)),lp.createElement(Ve,null,w(this,"7",{style:"highlight"}),w(this,"8",{style:"highlight"}),w(this,"9",{style:"highlight"}),w(this,"division")),lp.createElement(Ve,null,w(this,"4",{style:"highlight"}),w(this,"5",{style:"highlight"}),w(this,"6",{style:"highlight"}),w(this,"multiplication")),lp.createElement(Ve,null,w(this,"1",{style:"highlight"}),w(this,"2",{style:"highlight"}),w(this,"3",{style:"highlight"}),w(this,"-")),lp.createElement(Ve,null,w(this,"0",{style:"highlight"}),w(this,".",{style:"highlight",colspan:this.dotColspan()}),this.makeAdditionalFunctionKey(0),w(this,"+"))))}parenColspan(){return this.controller.getAdditionalFunctions().length===2?1.5:2}dotColspan(){return this.controller.getAdditionalFunctions().length?1:2}makeAdditionalFunctionKey(e){let t=this.controller.getAdditionalFunctions()[e];return t==="exponent"?w(this,"a^b"):t==="percent"?w(this,"%"):t==="sqrt"?w(this,"sqrt"):void 0}};var Oa=__dcg_shared_module_exports__['h'](z());var bC=class extends ur{template(){return Oa.createElement(rr,{controller:this.props.controller},Oa.createElement(Ve,null,w(this,"("),w(this,")"),w(this,"x^2"),w(this,"sqrt"),Oa.createElement("div",{class:Oa.const("dcg-partition-placeholder")}),w(this,"x^3"),w(this,"x^y"),w(this,"ythroot")),Oa.createElement(Ve,null,w(this,"7",{style:"highlight"}),w(this,"8",{style:"highlight"}),w(this,"9",{style:"highlight"}),w(this,"division"),Oa.createElement("div",{class:Oa.const("dcg-partition-placeholder")}),w(this,"pi"),w(this,"e^x"),w(this,"!")),Oa.createElement(Ve,null,w(this,"4",{style:"highlight"}),w(this,"5",{style:"highlight"}),w(this,"6",{style:"highlight"}),w(this,"multiplication"),Oa.createElement("div",{class:Oa.const("dcg-partition-placeholder")}),w(this,"log"),w(this,"ln"),w(this,"|x|")),Oa.createElement(Ve,null,w(this,"1",{style:"highlight"}),w(this,"2",{style:"highlight"}),w(this,"3",{style:"highlight"}),w(this,"-"),Oa.createElement("div",{class:Oa.const("dcg-partition-placeholder")}),w(this,"sin"),w(this,"cos"),w(this,"tan")),Oa.createElement(Ve,null,w(this,"0",{style:"highlight"}),w(this,".",{style:"highlight"}),w(this,"x/y"),w(this,"+"),Oa.createElement("div",{class:Oa.const("dcg-partition-placeholder")}),w(this,"arcsin"),w(this,"arccos"),w(this,"arctan")))}};var fc=__dcg_shared_module_exports__['h'](z());var Po=__dcg_shared_module_exports__['h'](z());var{IfElse:fie}=Po.Components,yC=class extends ur{template(){return Po.createElement(rr,{controller:this.props.controller},Po.createElement(Ve,null,w(this,"a^2"),w(this,"a^b"),w(this,"|a|"),Po.createElement("div",{class:Po.const("dcg-partition-placeholder")}),w(this,"7",{style:"highlight"}),w(this,"8",{style:"highlight"}),w(this,"9",{style:"highlight"}),w(this,"division"),Po.createElement("div",{class:Po.const("dcg-partition-placeholder")}),w(this,"%"),w(this,"a/b")),Po.createElement(Ve,null,w(this,"sqrt"),w(this,"nthroot"),w(this,"pi"),Po.createElement("div",{class:Po.const("dcg-partition-placeholder")}),w(this,"4",{style:"highlight"}),w(this,"5",{style:"highlight"}),w(this,"6",{style:"highlight"}),w(this,"multiplication"),Po.createElement("div",{class:Po.const("dcg-partition-placeholder")}),w(this,"left",{style:"highlight"}),w(this,"right",{style:"highlight"})),Po.createElement(Ve,null,w(this,"sin"),w(this,"cos"),w(this,"tan"),Po.createElement("div",{class:Po.const("dcg-partition-placeholder")}),w(this,"1",{style:"highlight"}),w(this,"2",{style:"highlight"}),w(this,"3",{style:"highlight"}),w(this,"-"),Po.createElement("div",{class:Po.const("dcg-partition-placeholder")}),Gr(.5),w(this,"backspace",{style:"highlight",colspan:1.5})),Po.createElement(Ve,null,w(this,"("),w(this,")"),fie(()=>this.controller.getReplaceCommaWith10Exp(),{true:()=>w(this,"10^n"),false:()=>w(this,",")}),Po.createElement("div",{class:Po.const("dcg-partition-placeholder")}),w(this,"0",{style:"highlight"}),w(this,".",{style:"highlight"}),w(this,"ans"),w(this,"+"),Po.createElement("div",{class:Po.const("dcg-partition-placeholder")}),w(this,"enter",{style:"blue",colspan:2})))}};var ld=__dcg_shared_module_exports__['h'](z());var xC=class extends ur{template(){return ld.createElement(rr,{controller:this.props.controller},ld.createElement(Ve,null,w(this,"q"),w(this,"w"),w(this,"e"),w(this,"r"),w(this,"t"),w(this,"y"),w(this,"u"),w(this,"i"),w(this,"o"),w(this,"p")),ld.createElement(Ve,null,ld.createElement("div",{class:ld.const("dcg-half-width-placeholder")}),w(this,"a"),w(this,"s"),w(this,"d"),w(this,"f"),w(this,"g"),w(this,"h"),w(this,"j"),w(this,"k"),w(this,"l"),ld.createElement("div",{class:ld.const("dcg-half-width-placeholder")})),ld.createElement(Ve,null,w(this,"=",{style:"highlight"}),w(this,"z"),w(this,"x"),w(this,"c"),w(this,"v"),w(this,"b"),w(this,"n"),w(this,"m"),w(this,","),w(this,"backspace",{style:"highlight"})),ld.createElement(Ve,null,w(this,"shift",{style:"highlight",colspan:1.5}),w(this,"("),w(this,")"),w(this,"["),w(this,"]"),w(this,"!"),w(this,"'"),w(this,"pi"),w(this,"enter",{style:"blue",colspan:1.5})))}};var gy=__dcg_shared_module_exports__['h'](z());var wC=class extends ur{template(){return gy.createElement(rr,{controller:this.props.controller},gy.createElement(Ve,null,w(this,"a"),w(this,"b"),w(this,"c"),w(this,"d"),w(this,"e"),w(this,"f"),w(this,"g"),w(this,"h"),w(this,"i"),w(this,"j")),gy.createElement(Ve,null,w(this,"k"),w(this,"l"),w(this,"m"),w(this,"n"),w(this,"o"),w(this,"p"),w(this,"q"),w(this,"r"),w(this,"s"),w(this,"t")),gy.createElement(Ve,null,w(this,"=",{style:"highlight"}),w(this,","),w(this,"u"),w(this,"v"),w(this,"w"),w(this,"x"),w(this,"y"),w(this,"z"),w(this,"pi"),w(this,"backspace",{style:"highlight"})),gy.createElement(Ve,null,w(this,"shift",{style:"highlight",colspan:2}),w(this,"("),w(this,")"),w(this,"["),w(this,"]"),w(this,"!"),w(this,"'"),w(this,"enter",{style:"blue",colspan:2})))}};var cd=__dcg_shared_module_exports__['h'](z());var vC=class extends ur{template(){return cd.createElement(rr,{controller:this.props.controller},cd.createElement(Ve,null,w(this,"Q"),w(this,"W"),w(this,"E"),w(this,"R"),w(this,"T"),w(this,"Y"),w(this,"U"),w(this,"I"),w(this,"O"),w(this,"P")),cd.createElement(Ve,null,cd.createElement("div",{class:cd.const("dcg-half-width-placeholder")}),w(this,"A"),w(this,"S"),w(this,"D"),w(this,"F"),w(this,"G"),w(this,"H"),w(this,"J"),w(this,"K"),w(this,"L"),cd.createElement("div",{class:cd.const("dcg-half-width-placeholder")})),cd.createElement(Ve,null,w(this,"=",{style:"highlight"}),w(this,"Z"),w(this,"X"),w(this,"C"),w(this,"V"),w(this,"B"),w(this,"N"),w(this,"M"),w(this,","),w(this,"backspace",{style:"highlight"})),cd.createElement(Ve,null,w(this,"shift",{style:"highlight",colspan:1.5}),w(this,"("),w(this,")"),w(this,"["),w(this,"]"),w(this,"!"),w(this,"'"),w(this,"pi"),w(this,"enter",{style:"blue",colspan:1.5})))}};var my=__dcg_shared_module_exports__['h'](z());var CC=class extends ur{template(){return my.createElement(rr,{controller:this.props.controller},my.createElement(Ve,null,w(this,"A"),w(this,"B"),w(this,"C"),w(this,"D"),w(this,"E"),w(this,"F"),w(this,"G"),w(this,"H"),w(this,"I"),w(this,"J")),my.createElement(Ve,null,w(this,"K"),w(this,"L"),w(this,"M"),w(this,"N"),w(this,"O"),w(this,"P"),w(this,"Q"),w(this,"R"),w(this,"S"),w(this,"T")),my.createElement(Ve,null,w(this,"=",{style:"highlight"}),w(this,","),w(this,"U"),w(this,"V"),w(this,"W"),w(this,"X"),w(this,"Y"),w(this,"Z"),w(this,"pi"),w(this,"backspace",{style:"highlight"})),my.createElement(Ve,null,w(this,"shift",{style:"highlight",colspan:2}),w(this,"("),w(this,")"),w(this,"["),w(this,"]"),w(this,"!"),w(this,"'"),w(this,"enter",{style:"blue",colspan:2})))}};var ya=__dcg_shared_module_exports__['h'](z());var{IfElse:bie}=ya.Components,DC=class extends ur{template(){return ya.createElement("div",{class:ya.const("dcg-sci-func-keypad")},ya.createElement(rr,{controller:this.props.controller},ya.createElement(Ve,null,w(this,"sin"),w(this,"cos"),w(this,"tan"),ya.createElement("div",{class:ya.const("dcg-partition-placeholder")}),w(this,"a^b"),w(this,"sqrt"),w(this,"nthroot")),ya.createElement(Ve,null,w(this,"arcsin"),w(this,"arccos"),w(this,"arctan"),ya.createElement("div",{class:ya.const("dcg-partition-placeholder")}),w(this,"e^x"),w(this,"abs"),bie(()=>this.controller.getReplaceRoundWithReciprocal(),{true:()=>w(this,"a^{-1}"),false:()=>w(this,"round")})),ya.createElement(Ve,null,w(this,"mean"),w(this,"stdev"),w(this,"stdevp"),ya.createElement("div",{class:ya.const("dcg-partition-placeholder")}),w(this,"ln"),w(this,"log"),w(this,"backspace",{style:"highlight"})),ya.createElement(Ve,null,w(this,"nPr"),w(this,"nCr"),w(this,"!"),ya.createElement("div",{class:ya.const("dcg-partition-placeholder")}),w(this,"e"),w(this,"pi"),w(this,"enter",{style:"blue"}))))}};var{SwitchUnion:yie}=fc.Components,SC=class extends ur{template(){return fc.createElement("div",{role:fc.const("region"),"aria-label":()=>this.s("shared-calculator-narration-keypad")},yie(()=>this.controller.getKeyboardMode(),{qwerty:()=>fc.createElement(xC,{controller:this.props.controller}),letters:()=>fc.createElement(wC,{controller:this.props.controller}),capitalQwerty:()=>fc.createElement(vC,{controller:this.props.controller}),capitalLetters:()=>fc.createElement(CC,{controller:this.props.controller}),functions:()=>fc.createElement(DC,{controller:this.props.controller}),main:()=>fc.createElement(yC,{controller:this.props.controller})}))}};var Ri=__dcg_shared_module_exports__['h'](z());var _s=__dcg_shared_module_exports__['h'](z());var{For:xie}=_s.Components,fy=class extends _s.Class{template(){return _s.createElement("tr",null,_s.createElement(xie,{each:()=>this.getBrailleAscii(this.props.latex()),key:e=>e.key},_s.createElement("td",null,e=>_s.createElement("span",{class:_s.const("dcg-key-press")},()=>e.char))),_s.createElement("td",{class:_s.const("dcg-braille-font")},()=>this.getBrailleUnicode(this.props.latex())),_s.createElement("td",null,_s.createElement(ze,{config:this.const({}),latex:()=>this.props.latex()})))}getBrailleAscii(e){let t=Ba.toExpandedBrailleAscii(this.getBrailleUnicode(e)),i=[];for(let o=0;o<t.length;o++)i.push({char:t[o],key:o+")"+t[o]});return i}getBrailleUnicode(e){let t;return this.props.brailleMode()==="nemeth"?t=Xp(e):this.props.brailleMode()==="ueb"&&(t=Qp(e)),t&&t.value?t.value:""}};var dm=class extends ur{template(){return Ri.createElement("div",{class:()=>({"dcg-braille-io-keypad-container":!0,"dcg-has-background-color":this.controller.hasBackgroundColor()})},Ri.createElement("div",{class:Ri.const("dcg-braille-io-keypad")},Ri.createElement("div",{class:Ri.const("dcg-braille-description")},Ri.createElement("div",{class:Ri.const("dcg-braille-title")},()=>this.controller.s("basic-calculator-text-braille-mode-is-on",{mode:this.brailleType()})),Ri.createElement("div",{class:Ri.const("dcg-braille-info-text")},()=>this.controller.s("basic-calculator-text-how-to-type-braille")),Ri.createElement("div",{class:Ri.const("dcg-btn-primary"),role:Ri.const("button"),tabindex:Ri.const(0),onTap:()=>this.controller.dispatch({type:"set-braille-mode",mode:"none"})},()=>this.controller.s("basic-calculator-button-turn-braille-mode-off",{mode:this.brailleType()}))),Ri.createElement("div",{class:Ri.const("dcg-braille-examples-table-container")},Ri.createElement("table",{class:Ri.const("dcg-braille-examples-table")},Ri.createElement("tr",null,Ri.createElement("th",null,()=>this.controller.s("basic-calculator-heading-braille-table-type-this")),Ri.createElement("th",null,()=>this.brailleType()),Ri.createElement("th",null,()=>this.controller.s("basic-calculator-heading-braille-table-typeset"))),Ri.createElement(fy,{brailleMode:()=>this.controller.getBrailleMode(),latex:this.const("2+2")}),Ri.createElement(fy,{brailleMode:()=>this.controller.getBrailleMode(),latex:this.const("\\frac{1}{2}")}),Ri.createElement(fy,{brailleMode:()=>this.controller.getBrailleMode(),latex:this.const("\\sqrt{4}")})),Ri.createElement("div",{class:Ri.const("dcg-more-examples-link")},Ri.createElement("a",{href:()=>"https://www.desmos.com/braille-examples?"+this.controller.getBrailleMode(),target:Ri.const("_blank")},()=>this.controller.s("basic-calculator-link-view-braille-examples"))))))}brailleType(){return this.controller.getBrailleMode()==="nemeth"?"Nemeth":this.controller.getBrailleMode()==="ueb"?"UEB":""}};var $a=__dcg_shared_module_exports__['h'](z());var Lt=__dcg_shared_module_exports__['h'](z());var{If:fu,Input:wie,Textarea:vie}=Lt.Components,kC=class extends ur{constructor(){super(...arguments),this.lastBrailleModeDuringFocusChange="none"}getAriaLabel(){let e=this.getIndex()+1+"";return this.s("shared-calculator-narration-expression-index",{index:e})}didUpdate(){this.renderAnsValue()}didMountMQ(e){this.mq=e}getExp(){return this.model.getExpressionById(this.props.id())}getAns(){return this.model.getExpressionAns(this.props.id())}getAnsId(){return this.model.getExpressionAnsId(this.props.id())}getLatex(){return this.getExp().latex}getValue(){return this.model.getExpressionValue(this.props.id())}getBraille(){let e=this.getExp().braille;if(e!=="")return e;{let t=vb(this.getLatex(),this.controller.getBrailleMode());return t.isError?"":Ba.toExpandedBrailleAscii(t.value)}}getIndex(){return this.model.getExpressionIndex(this.props.id())}getShowEvaluation(){return this.model.shouldShowEvaluationForExpression(this.props.id())}isFractionEvaluation(){return this.getExp().displayAsFraction}canDisplayEvaluationAsFraction(){return this.controller.getDecimalToFraction()&&this.model.canDisplayEvaluationAsFraction(this.props.id())}shouldDisplayEvaluationAsFraction(){return this.canDisplayEvaluationAsFraction()&&this.getExp().displayAsFraction}toggleFractionEvaluation(){this.dispatch({type:"toggle-fraction-evaluation",id:this.props.id()})}getFractionDisplayAriaLabel(){return this.shouldDisplayEvaluationAsFraction()?this.controller.s("basic-calculator-narration-convert-to-decimal"):this.controller.s("basic-calculator-narration-convert-to-fraction")}getError(){let e=this.model.getExpressionError(this.props.id());return e&&this.getLatex().length>0?kd(e,this.controller.getLanguage()):""}showError(){return!!this.getError()}getFractionMessage(){return this.shouldDisplayEvaluationAsFraction()?this.s("basic-calculator-label-convert-to-decimal"):this.s("basic-calculator-label-convert-to-fraction")}getIsFocused(){return!this.controller.isSettingsMenuOpen()&&this.model.isExpressionFocused(this.props.id())}onFocusedChanged(e){let t=this.controller.getBrailleMode(),i=t!==this.lastBrailleModeDuringFocusChange;this.lastBrailleModeDuringFocusChange=t,!(!this.getExp()||i)&&(e?this.dispatch({type:"focusin",id:this.props.id()}):this.dispatch({type:"focusout",id:this.props.id()}))}onMQReflow(){this.renderedAnsData=void 0,this.renderAnsValue()}renderAnsValue(){if(!this.mq)return;let e=this.getAns(),t=!1,i=this.getAnsId();if(i){let o=this.model.getExpressionById(i);t=o&&o.displayAsFraction}this.renderedAnsData&&this.renderedAnsData.value==e&&this.renderedAnsData.displayAsFraction===t||(this.renderedAnsData={value:e,displayAsFraction:t},this.mq.querySelectorAll(".dcg-mq-ans").forEach(o=>{let n=o,a;typeof e=="number"?a=__dcg_shared_module_exports__['fb'](e,{digits:this.getEvaluationDigits(),bigCutoff:1e9,displayAsFraction:t}):typeof e=="string"&&(a=e),a?(n.classList.remove("dcg-invalid"),n.innerHTML=a):(n.classList.add("dcg-invalid"),n.innerHTML='<i class="dcg-icon-error" aria-hidden="true"></i>')}))}getEvaluationLatex(){let e=this.getValue();if(e===void 0&&(e=NaN),this.model.isRationalizableConstant(this.props.id())&&!this.shouldDisplayEvaluationAsFraction())return"";let t;if(Array.isArray(e))t=`\\mathrm{${e.length}\\ element\\ list}`;else{var i=__dcg_shared_module_exports__['gb'](e,{digits:this.getEvaluationDigits(),bigCutoff:1e9,displayAsFraction:this.shouldDisplayEvaluationAsFraction()});return i==="undefined"?"=\\mathrm{undefined}":"="+i}return t}getEvaluationBraille(){let e=this.getEvaluationLatex(),t=vb(e,this.controller.getBrailleMode());return t.isError?"":Ba.toExpandedBrailleAscii(t.value)}didMountBrailleInput(e){this.brailleInputNode=e}didUnmountBrailleInput(){this.brailleInputNode=void 0}handleBrailleFocus(e){let t=e.target;t&&setTimeout(()=>{t.setSelectionRange(0,0)})}handleBrailleKeydown(e){!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&(Ee(e)===gn?(this.forceModelFocus(),this.dispatch({type:"focus-prev-expression"}),e.preventDefault()):Ee(e)===mn?(this.forceModelFocus(),this.dispatch({type:"focus-next-expression"}),e.preventDefault()):Ee(e)===fs?(this.forceModelFocus(),this.dispatch({type:"insert-blank-expression"}),e.preventDefault()):Ee(e)===Hl&&document.activeElement===this.brailleInputNode&&this.getBraille()===""&&(this.dispatch({type:"backspace-from-braille"}),e.preventDefault()))}forceModelFocus(){document.activeElement!==this.brailleInputNode&&this.onFocusedChanged(!0)}focusBrailleInput(){this.brailleInputNode&&document.activeElement!==this.brailleInputNode&&this.brailleInputNode.focus()}getPostLabel(){if(this.showError())return this.getError();if(this.getShowEvaluation()){let e=this.getValue();return e===void 0&&(e=NaN),Array.isArray(e)?`${e.length} element list`:"equals "+ca(__dcg_shared_module_exports__['gb'](e,{digits:this.getEvaluationDigits(),bigCutoff:1e9,displayAsFraction:this.shouldDisplayEvaluationAsFraction()}))}return""}onBrailleInput(e){this.controller.isSettingsMenuOpen()&&this.controller.dispatch({type:"close-settings-menu"});let t=g0(Ba.coerceToSixDotCells(e),this.controller.getBrailleMode()),i=t.isError?"":t.value;(!this.controller.getCapExpressionSize()||tb(i)<=rb)&&this.controller.dispatch({type:"update-latex-from-braille",latex:i,braille:e,id:this.props.id()})}getIndexSubscript(){return`_{${this.getIndex()+1}}`}getEvaluationDigits(){return this.controller.isScientificCalc()?10:7}onMountContainer(e){this.containerNode=e}onTapContainer(e){e.target===this.containerNode&&!this.getShowEvaluation()&&!this.showError()&&this.forceModelFocus()}template(){return Lt.createElement("div",{class:()=>({"dcg-basic-expression":!0,"dcg-focused":this.getIsFocused(),"dcg-braille-io":this.controller.renderAsBraille()}),onTap:this.bindFn(this.onTapContainer),onMount:this.bindFn(this.onMountContainer)},Lt.createElement(fu,{predicate:()=>this.controller.renderAsBraille()},()=>Lt.createElement("div",{class:Lt.const("dcg-braille-input")},Lt.createElement(Ng,{ariaLabel:()=>{let e=vb(`eq${this.getIndexSubscript()}`,this.controller.getBrailleMode());return e.isError?"":Ba.toExpandedBrailleAscii(e.value)},didMount:this.bindFn(this.didMountBrailleInput),didUnmount:this.bindFn(this.didUnmountBrailleInput),onFocusedChanged:this.bindFn(this.onFocusedChanged),shouldFocus:this.bindFn(this.getIsFocused),onKeydown:this.bindFn(this.handleBrailleKeydown),onInput:this.bindFn(this.onBrailleInput),sixKeyInput:()=>this.controller.getSixKeyInput(),value:()=>this.getBraille(),isStatic:this.const(!1)}))),Lt.createElement(fu,{predicate:()=>this.controller.renderAsBraille()},()=>Lt.createElement("div",{class:Lt.const("dcg-braille-evaluation-container")},Lt.createElement(fu,{predicate:()=>this.getShowEvaluation()},()=>Lt.createElement("div",{class:Lt.const("dcg-braille-evaluation")},Lt.createElement(wie,{readonly:this.const("true"),class:this.const("dcg-braille-evaluation-inner"),value:()=>this.getEvaluationBraille(),onFocus:this.bindFn(this.handleBrailleFocus),onKeydown:this.bindFn(this.handleBrailleKeydown),onInput:()=>{}}))),Lt.createElement(fu,{predicate:()=>this.showError()},()=>Lt.createElement("div",{class:Lt.const("dcg-braille-error")},Lt.createElement("div",{class:Lt.const("dcg-basic-expression-error")},Lt.createElement("i",{class:Lt.const("dcg-icon-error"),"aria-hidden":Lt.const("true")})),Lt.createElement(vie,{readonly:this.const("true"),class:this.const("dcg-braille-error-inner"),value:()=>this.getError(),onFocus:this.bindFn(this.handleBrailleFocus),onKeydown:this.bindFn(this.handleBrailleKeydown),onInput:()=>{}}))))),Lt.createElement(fu,{predicate:()=>this.controller.renderAsBraille()},()=>Lt.createElement("div",{class:Lt.const("dcg-exp-mathquill-container"),didMount:this.bindFn(this.didMountMQ),onTap:this.bindFn(this.forceModelFocus)},Lt.createElement(ze,{latex:()=>this.getLatex(),config:this.const({}),onReflow:this.bindFn(this.onMQReflow)}))),Lt.createElement(fu,{predicate:()=>!this.controller.renderAsBraille()},()=>Lt.createElement("div",{class:Lt.const("dcg-exp-mathquill-container"),didMount:this.bindFn(this.didMountMQ)},Lt.createElement(_e,{latex:()=>this.getLatex(),onReflow:this.bindFn(this.onMQReflow),isFocused:this.bindFn(this.getIsFocused),capExpressionSize:()=>this.controller.getCapExpressionSize(),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel(),getAriaPostLabel:()=>this.getPostLabel(),hasError:()=>!1,onUserPressedKey:(e,t)=>{this.controller.isSettingsMenuOpen()&&this.controller.dispatch({type:"close-settings-menu"}),this.dispatch({type:"keypad/press-key",key:e,evt:t})},onUserTypedText:e=>this.dispatch({type:"keypad/type-text",text:e}),onUserChangedLatex:e=>{this.dispatch({type:"update-latex",id:this.props.id(),latex:e})},onFocusedChanged:this.bindFn(this.onFocusedChanged),disableSpace:()=>this.controller.getRestrictedEditing()}))),Lt.createElement("div",{class:Lt.const("dcg-exp-output-container")},Lt.createElement(fu,{predicate:()=>this.showError()&&!this.controller.renderAsBraille()},()=>Lt.createElement(Me,{tooltip:this.bindFn(this.getError),gravity:this.const("w"),sticky:this.const(!0)},Lt.createElement("div",{class:Lt.const("dcg-basic-expression-error")},Lt.createElement("i",{class:Lt.const("dcg-icon-error"),"aria-hidden":Lt.const("true")})))),Lt.createElement(fu,{predicate:()=>this.getShowEvaluation()},()=>Lt.createElement("div",{class:()=>({"dcg-basic-expression-value":!0,"dcg-basic-evaluation-gray":Array.isArray(this.getValue())})},Lt.createElement(ze,{config:this.const({}),latex:()=>this.getEvaluationLatex()}),Lt.createElement(fu,{predicate:this.bindFn(this.canDisplayEvaluationAsFraction)},()=>Lt.createElement(Me,{tooltip:this.bindFn(this.getFractionMessage),gravity:this.const("s")},Lt.createElement("span",{role:Lt.const("button"),tabindex:Lt.const("0"),"aria-label":this.bindFn(this.getFractionDisplayAriaLabel),class:()=>({"dcg-basic-fraction-toggle":!0,"dcg-selected":this.isFractionEvaluation()}),onTap:this.bindFn(this.toggleFractionEvaluation)},Lt.createElement("i",{class:Lt.const("dcg-icon-fraction"),"aria-hidden":Lt.const("true")}))))))))}getMQConfig(){return this.controller.getMathquillConfig()}};xt();var{For:Cie,If:Die}=$a.Components,EC=class extends ur{constructor(){super(...arguments),this.didShowAnswerHint=!1,this.didHideAnswerHint=!1}template(){return $a.createElement("div",{class:$a.const("dcg-basic-list-container"),role:$a.const("region"),"aria-label":()=>this.controller.s("shared-calculator-narration-expression-list"),didMount:this.bindFn(this.didMountContainer)},$a.createElement("div",{class:$a.const("dcg-basic-list-placeholder"),didMount:this.bindFn(this.didMountPlaceholder)},$a.createElement(Die,{predicate:this.bindFn(this.showAnswerHint)},()=>$a.createElement("div",{class:$a.const("dcg-answer-hint")},()=>this.controller.s("basic-calculator-label-answer-hint"),$a.createElement("i",{class:$a.const("dcg-icon-curved-arrow")})))),$a.createElement(Cie,{each:()=>this.model.getExpressionOrder()},$a.createElement("div",{class:()=>({"dcg-basic-list":!0,"dcg-projector-mode":this.controller.isProjectorMode()})},e=>$a.createElement(kC,{controller:this.props.controller,id:this.const(e)}))))}didMountPlaceholder(e){H(e).on("dcg-tap",Kr)}showAnswerHint(){if(this.didHideAnswerHint)return!1;let e=this.model.getExpressionOrder()[0];return this.model.shouldShowEvaluationForExpression(e)||this.didShowAnswerHint?(this.didShowAnswerHint=!0,this.model.getNumberOfExpressions()>1||this.model.getExpressionLatex(e)===""?(this.didHideAnswerHint=!0,!1):!0):!1}didUpdate(){if(!this.container)return;let e=this.container.querySelector(".dcg-focused");e&&kl(e,this.container,50)}didMountContainer(e){this.container=e}};var{If:GC,IfElse:aI}=xr.Components,TC=class extends ur{template(){return xr.createElement(GC,{predicate:()=>this.controller.shouldRender()},()=>xr.createElement("div",{class:xr.const("dcg-calculator-api-container"),style:xr.const("width: 100%; height: 100%; position: relative;")},xr.createElement("div",{class:()=>({"dcg-calc-basic-main-wrapper":!0,"dcg-narrow":this.controller.containerSize.width<570,"dcg-short":this.controller.containerSize.height<=540,"dcg-scientific-calculator":this.controller.isScientificCalc(),"dcg-four-function-calculator":this.controller.isFourFunctionCalc(),"dcg-container":!0}),onKeydown:this.bindFn(this.handleRootKeydown),didMount:this.bindFn(this.didMountRoot),"x-ms-format-detection":xr.const("none")},xr.createElement("div",{role:xr.const("application"),"aria-label":()=>this.controller.isScientificCalc()?this.controller.s("basic-calculator-narration-calc-description-scientific"):this.controller.isFourFunctionCalc()?this.controller.s("basic-calculator-narration-calc-description-fourfunction"):"",class:()=>({"dcg-calc-basic-main":!0,"dcg-inverted-colors":this.controller.getInvertedColors(),"dcg-projector-mode":this.controller.isProjectorMode(),"dcg-ipad":pl,"dcg-has-background-color":this.controller.hasBackgroundColor(),"dcg-no-hyperlinks":!this.controller.getAllowLinks()}),style:()=>({"font-size":`${this.controller.getFontSize()}px`,background:this.controller.getBackgroundColor(),color:this.controller.getTextColor(),filter:this.controller.getInvertedColors()?"invert(100%)":"none"})},xr.createElement(EC,{controller:this.props.controller}),xr.createElement(GC,{predicate:()=>this.controller.isScientificCalc()&&this.model.isSingleExpression()},()=>xr.createElement("div",null,xr.createElement(nI,{controller:this.props.controller}),xr.createElement("div",{class:xr.const("dcg-basic-keypad-container")},aI(()=>this.controller.renderAsBraille(),{true:()=>xr.createElement(dm,{controller:this.props.controller}),false:()=>xr.createElement(bC,{controller:this.props.controller})})))),xr.createElement(GC,{predicate:()=>this.controller.isScientificCalc()&&!this.model.isSingleExpression()},()=>xr.createElement("div",null,xr.createElement(oI,{controller:this.props.controller}),xr.createElement("div",{class:xr.const("dcg-basic-keypad-container")},aI(()=>this.controller.renderAsBraille(),{true:()=>xr.createElement(dm,{controller:this.props.controller}),false:()=>xr.createElement(SC,{controller:this.props.controller})})))),xr.createElement(GC,{predicate:()=>this.controller.isFourFunctionCalc()&&this.model.isSingleExpression()},()=>xr.createElement("div",null,xr.createElement(iI,{controller:this.props.controller}),xr.createElement("div",{class:xr.const("dcg-basic-keypad-container")},aI(()=>this.controller.renderAsBraille(),{true:()=>xr.createElement(dm,{controller:this.props.controller}),false:()=>xr.createElement(fC,{controller:this.props.controller})})))),xr.createElement(GC,{predicate:()=>this.controller.isFourFunctionCalc()&&!this.model.isSingleExpression()},()=>xr.createElement("div",null,xr.createElement(tI,{controller:this.props.controller}),xr.createElement("div",{class:xr.const("dcg-basic-keypad-container")},aI(()=>this.controller.renderAsBraille(),{true:()=>xr.createElement(dm,{controller:this.props.controller}),false:()=>xr.createElement(mC,{controller:this.props.controller})}))))))))}didMountRoot(e){Pu(e)}handleRootKeydown(e){let t=ki(e),i=this.controller.model;if(Qh(e))return this.dispatch({type:"undo",source:"keyboard-shortcut"}),!1;if(Zh(e))return this.dispatch({type:"redo",source:"keyboard-shortcut"}),!1;if(e.altKey!==oi&&e.metaKey===oi&&!e.ctrlKey&&e.shiftKey&&t==="A"&&this.controller.getDecimalToFraction()){let o=i.getFocusedExpression();o&&i.canDisplayEvaluationAsFraction(o.id)&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"toggle-fraction-evaluation",id:o.id}),this.controller.runAfterDispatch(()=>{i.getFocusedExpression().displayAsFraction?be(this.controller.s("shared-calculator-narration-show-as-fraction")):be(this.controller.s("shared-calculator-narration-show-as-decimal"))}))}else if(!e.metaKey&&!e.shiftKey){if(!e.ctrlKey&&!e.altKey&&Ee(e)===Hl){if(!document.activeElement||tg(document.activeElement))return!1}else if(e.ctrlKey===oi&&e.altKey===!oi){if(t==="N")return this.controller.getBrailleControls()?(this.dispatch({type:"set-braille-mode",mode:"nemeth"}),be(this.controller.s("shared-calculator-narration-hotkey-braille-mode-nemeth")),!1):void 0;if(t==="U")return this.controller.getBrailleControls()?(this.dispatch({type:"set-braille-mode",mode:"ueb"}),be(this.controller.s("shared-calculator-narration-hotkey-braille-mode-ueb")),!1):void 0;if(t==="Q"||t==="X")return this.controller.getBrailleControls()?(this.dispatch({type:"set-braille-mode",mode:"none"}),be(this.controller.s("shared-calculator-narration-hotkey-braille-mode-off")),!1):void 0;if(t==="6"){if(!this.controller.getBrailleControls())return;let o=!this.controller.getSixKeyInput();return this.dispatch({type:"set-six-key-input",mode:o}),be(o?this.controller.s("basic-calculator-narration-hotkey-six-key-input-on"):this.controller.s("basic-calculator-narration-hotkey-six-key-input-off")),!1}else if(t==="D")return this.controller.isScientificCalc()?(e.preventDefault(),this.controller.dispatch({type:"degrees"}),be(i.getDegreeMode()?this.controller.s("basic-calculator-narration-controlbar-degrees"):this.controller.s("basic-calculator-narration-controlbar-radians")),!1):void 0}}return!0}};var by=class extends sm{constructor(t){super(t)}init(t){t=__dcg_shared_module_exports__['j'](t),t.backgroundColor&&!__dcg_shared_module_exports__['l'](t.backgroundColor)&&(__dcg_shared_module_exports__['rd'].warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)"),delete t.backgroundColor),t.textColor&&!__dcg_shared_module_exports__['l'](t.textColor)&&(__dcg_shared_module_exports__['rd'].warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)"),delete t.textColor);let i=__dcg_shared_module_exports__['a']({language:"en",qwertyKeyboard:!0,links:!0,degreeMode:!1,settingsMenu:!0,invertedColors:!1,backgroundColor:"#fff",textColor:"#000",brailleMode:"none",sixKeyInput:!1,brailleControls:!0,brailleExpressionDownload:!0,projectorMode:!1,capExpressionSize:!1,functionDefinition:!0,autosize:!0,evaluationMode:"scientific",restrictedEditing:!1,additionalFunctions:["sqrt"],typingSlashWritesDivisionSymbol:!1,typingAsteriskWritesTimesSymbol:!1,decimalToFraction:!0,replaceCommaWith10Exp:!1,replaceRoundWithReciprocal:!1},t);this.settings=new kr;let o={workerPool:Qb,settingsProxy:this.settings};this.controller=new uC(i,o),this.controller.onEventEmitted=n=>{n==="render"&&this.updateView(),this.triggerEvent(n,void 0)},this.setupDomChangeDetector(i.autosize)}onCreateView(){return yy.mountToNode(TC,this.rootElt,{controller:yy.const(this.controller)})}setState(t,i){i||(i={}),this.controller.dispatch({type:"set-state-from-api",state:t,opts:{allowUndo:!!i.allowUndo}})}getState(){return __dcg_shared_module_exports__['j'](this.controller.model.getPersistedState())}undo(){this.controller.dispatch({type:"undo",source:"api"})}redo(){this.controller.dispatch({type:"redo",source:"api"})}clearHistory(){this.controller.dispatch({type:"clear-history"})}setBlank(t){t||(t={}),this.controller.dispatch({type:"set-blank",opts:{allowUndo:!!t.allowUndo}})}updateSettings(t){if(t!=null)for(let i in t)switch(i){case"fontSize":let o=t[i];if(o===void 0)continue;this.controller.dispatch({type:"update-font-size",size:o});break;case"invertedColors":let n=t[i];if(n===void 0)continue;this.controller.dispatch({type:"update-inverted-colors",mode:n});break;case"backgroundColor":let a=t[i];if(a===void 0||!__dcg_shared_module_exports__['l'](a)){__dcg_shared_module_exports__['rd'].warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)");continue}this.controller.dispatch({type:"update-background-color",color:a});break;case"textColor":let s=t[i];if(s===void 0||!__dcg_shared_module_exports__['l'](s)){__dcg_shared_module_exports__['rd'].warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)");continue}this.controller.dispatch({type:"update-text-color",color:s});break;case"degreeMode":let l=t[i];if(l===void 0)continue;this.controller.dispatch({type:"update-degree-mode",mode:l});break;case"brailleMode":let c=t[i];this.controller.dispatch({type:"set-braille-mode",mode:c});break;case"sixKeyInput":let p=t[i];if(p===void 0)continue;this.controller.dispatch({type:"set-six-key-input",mode:p});break;case"brailleControls":{let I=t[i];if(I===void 0)continue;this.controller.dispatch({type:"set-braille-controls",value:I});break}case"brailleExpressionDownload":let u=t[i];if(u===void 0)continue;this.controller.dispatch({type:"set-braille-expression-download",mode:u});break;case"projectorMode":let m=t[i];if(m===void 0)continue;this.controller.dispatch({type:"update-projector-mode",mode:m});break;case"capExpressionSize":let h=t[i];if(h===void 0)continue;this.controller.dispatch({type:"update-cap-expression-size",mode:h});break;case"language":let x=t[i];if(x===void 0)continue;this.controller.dispatch({type:"update-language",language:op(x)});break;case"settingsMenu":t.settingsMenu?this.controller.dispatch({type:"enable-settings-menu"}):this.controller.dispatch({type:"disable-settings-menu"});break;case"qwertyKeyboard":{this.controller.dispatch({type:"update-options",options:{qwertyKeyboard:!!t.qwertyKeyboard}});let I=this.controller.getKeyboardMode();(I==="qwerty"||I==="letters")&&this.controller.dispatch({type:"ABC"})}break;case"functionDefinition":t.functionDefinition?this.controller.model.enableFunctionDefinition():this.controller.model.disableFunctionDefinition();break;case"links":this.controller.dispatch({type:"update-options",options:{links:!!t.links}});break;case"decimalToFraction":let C=t[i];if(C===void 0)continue;this.controller.dispatch({type:"update-decimal-to-fraction",mode:C});break;case"replaceCommaWith10Exp":let D=t[i];if(D===void 0)continue;this.controller.dispatch({type:"set-replace-comma-with-10-exp",replace:D});break;case"replaceRoundWithReciprocal":let k=t[i];if(k===void 0)continue;this.controller.dispatch({type:"set-replace-round-with-reciprocal",replace:k});break;case"restrictedEditing":{this.controller.dispatch({type:"update-options",options:{restrictedEditing:!!t.restrictedEditing}});break}case"typingAsteriskWritesTimesSymbol":let M=t[i];if(M===void 0)continue;this.controller.dispatch({type:"set-typing-asterisk-writes-times-symbol",mode:M});break}}focusFirstExpression(){this.controller.dispatch({type:"focus-first-expression"})}onResizeView(t){this.controller.dispatch({type:"ui/container-resized",size:t})}onDestroyView(){yy.unmountFromNode(this.rootElt)}destroy(){this.controller.model.destroy(),super.destroy()}};var xy=class extends by{constructor(e,t){super(e),this.init(Sie(t||{}))}};function Sie(r){if(r=__dcg_shared_module_exports__['j'](r),r.hasOwnProperty("typingSlashWritesDivisionSymbol")||(r.typingSlashWritesDivisionSymbol=!0),r.hasOwnProperty("typingAsteriskWritesTimesSymbol")||(r.typingAsteriskWritesTimesSymbol=!0),r.exponentButtonForSquareRoot&&(__dcg_shared_module_exports__['rd'].warn(`As of API version 1.0, the 'exponentButtonForSquareRoot' option is deprecated.Use 'additionalFunctions: "exponent"' instead.`),r.additionalFunctions=["exponent"]),r.additionalFunctions){var e=r.additionalFunctions;typeof e=="string"&&(e=[e]),e.length>2&&(__dcg_shared_module_exports__['rd'].warn("additionalFunctions can only take up to 2 new functions. Using the first two."),e=e.slice(0,2));let i=!0;for(var t=0;t<e.length;t++)["sqrt","exponent","percent","fraction"].indexOf(e[t])===-1&&(__dcg_shared_module_exports__['rd'].warn("Unrecognized value: '"+e[t]+`' for 'additionalFunction'. Valid values are 'sqrt', 'percent', 'exponent', or 'fraction'. Using default ("sqrt")`),i=!1);r.additionalFunctions=i?e:["sqrt"]}return(!r.additionalFunctions||!r.additionalFunctions.length)&&(r.additionalFunctions=["sqrt"]),r.singleExpression?r.evaluationMode="singleExpressionFourFunction":r.evaluationMode="fourFunction",delete r.singleExpression,r.hasOwnProperty("decimalToFraction")||(r.decimalToFraction=!1),r.language&&(r.language=op(r.language)),r}var wy=class extends by{constructor(e,t){super(e),this.init(kie(t||{}))}};function kie(r){return r=__dcg_shared_module_exports__['j'](r),r.singleExpression?r.evaluationMode="singleExpressionScientific":r.evaluationMode="scientific",delete r.singleExpression,r.language&&(r.language=op(r.language)),r}var Cy=__dcg_shared_module_exports__['h'](z());var IC=class{constructor(e){this.keypadType="scientific";this.projectorMode="none";this.scientificKeyboardMode="main";this.dispatcher=new Zd;this.s=jl(()=>"en");this.dispatch=e=>{this.dispatcher.dispatch(e);let t;for(;t=this._queuedCallbacks.shift();)t()};this._queuedCallbacks=[];var t,i;this.keypadType=(t=e==null?void 0:e.keypadType)!=null?t:"scientific",this.projectorMode=(i=e==null?void 0:e.projectorMode)!=null?i:"none",this.dispatcher=new Zd,this.hookUpDispatcher()}getBackgroundColor(){return"does-not-matter"}runAfterDispatch(e){this._queuedCallbacks.push(e)}enqueueEvent(e){this.runAfterDispatch(()=>{this.onEventEmitted&&this.onEventEmitted(e)})}getKeypadType(){return this.keypadType}getProjectorMode(){return this.projectorMode}getScientificKeyboardMode(){return this.scientificKeyboardMode}updateKeyboardMode(e){this.scientificKeyboardMode=e}typeIntoFocusedMathquill(e){e=e.replace(/\r|\n/g,"");let t=this.activeMQ;t&&(t.typedText(e),_e.simulateUserChangedLatex(t))}pressKeyInFocusedMathquill(e,t){let i=this.activeMQ;if(i){if(e==="Enter"){t&&(t.preventDefault(),t.stopPropagation()),this.enqueueEvent("enter");return}i.keystroke(e,t)}}executeCommandInFocusedMathquill(e){let t=this.activeMQ;t&&wb(t,e,{capExpressionSize:!1})}hookUpDispatcher(){this.dispatcher.register(e=>{switch(this.enqueueEvent("render"),e.type){case"hide-keypad":this.enqueueEvent("hide-keypad");break;case"set-active-mq":this.activeMQ=e.mq;break;case"set-keypad-type":this.keypadType=e.keypadType;break;case"keypad/shift":this.updateKeyboardMode(this.scientificKeyboardMode==="capitalQwerty"?"qwerty":"capitalQwerty");break;case"main":this.updateKeyboardMode("main");break;case"ABC":this.updateKeyboardMode("qwerty");break;case"functions":this.updateKeyboardMode("functions");break;case"keypad/type-text":this.typeIntoFocusedMathquill(e.text);break;case"keypad/press-key":this.pressKeyInFocusedMathquill(e.key,e.evt);break;case"keypad/custom-command":this.executeCommandInFocusedMathquill(e.command);break;case"keypad/123":case"keypad/abc":case"keypad/audio-trace":break;default:return e}})}};var jo=__dcg_shared_module_exports__['h'](z());var t6=__dcg_shared_module_exports__['h'](z()),xa=class extends t6.Class{init(){this.controller=this.props.controller(),this.dispatch=this.controller.dispatch,this.s=this.controller.s}};var cn=__dcg_shared_module_exports__['h'](z());var sI=class extends xa{template(){return cn.createElement(rr,{controller:this.props.controller},cn.createElement(Ve,null,w(this,"a^2"),w(this,"a^b"),w(this,"|a|"),w(this,"a/b"),cn.createElement("div",{class:cn.const("dcg-partition-placeholder")}),w(this,"7",{style:"highlight"}),w(this,"8",{style:"highlight"}),w(this,"9",{style:"highlight"}),w(this,"/"),cn.createElement("div",{class:cn.const("dcg-partition-placeholder")}),w(this,"x"),w(this,"y")),cn.createElement(Ve,null,w(this,"("),w(this,")"),w(this,"<"),w(this,">"),cn.createElement("div",{class:cn.const("dcg-partition-placeholder")}),w(this,"4",{style:"highlight"}),w(this,"5",{style:"highlight"}),w(this,"6",{style:"highlight"}),w(this,"*"),cn.createElement("div",{class:cn.const("dcg-partition-placeholder")}),w(this,"left",{style:"highlight"}),w(this,"right",{style:"highlight"})),cn.createElement(Ve,null,w(this,"sqrt"),w(this,","),w(this,"<="),w(this,">="),cn.createElement("div",{class:cn.const("dcg-partition-placeholder")}),w(this,"1",{style:"highlight"}),w(this,"2",{style:"highlight"}),w(this,"3",{style:"highlight"}),w(this,"-"),cn.createElement("div",{class:cn.const("dcg-partition-placeholder")}),Gr(.5),w(this,"backspace",{style:"highlight",colspan:1.5})),cn.createElement(Ve,null,w(this,"nthroot"),w(this,"pi"),w(this,"%"),w(this,"a_b"),cn.createElement("div",{class:cn.const("dcg-partition-placeholder")}),w(this,"0",{style:"highlight"}),w(this,".",{style:"highlight"}),w(this,"="),w(this,"+"),cn.createElement("div",{class:cn.const("dcg-partition-placeholder")}),w(this,"enter",{colspan:2,style:"blue"})))}};var dd=__dcg_shared_module_exports__['h'](z());var lI=class extends xa{template(){return dd.createElement(rr,{controller:this.props.controller},dd.createElement(Ve,null,w(this,"q"),w(this,"w"),w(this,"e"),w(this,"r"),w(this,"t"),w(this,"y"),w(this,"u"),w(this,"i"),w(this,"o"),w(this,"p")),dd.createElement(Ve,null,dd.createElement("div",{class:dd.const("dcg-half-width-placeholder")}),w(this,"a"),w(this,"s"),w(this,"d"),w(this,"f"),w(this,"g"),w(this,"h"),w(this,"j"),w(this,"k"),w(this,"l"),dd.createElement("div",{class:dd.const("dcg-half-width-placeholder")})),dd.createElement(Ve,null,w(this,"shift",{style:"highlight"}),w(this,"z"),w(this,"x"),w(this,"c"),w(this,"v"),w(this,"b"),w(this,"n"),w(this,"m"),w(this,":"),w(this,"backspace",{style:"highlight"})),dd.createElement(Ve,null,w(this,"~"),w(this,"{"),w(this,"}"),w(this,"["),w(this,"]"),w(this,"\xB1"),w(this,"'"),w(this,"obelus"),w(this,"enter",{style:"blue"})))}};var pd=__dcg_shared_module_exports__['h'](z());var cI=class extends xa{template(){return pd.createElement(rr,{controller:this.props.controller},pd.createElement(Ve,null,w(this,"Q"),w(this,"W"),w(this,"E"),w(this,"R"),w(this,"T"),w(this,"Y"),w(this,"U"),w(this,"I"),w(this,"O"),w(this,"P")),pd.createElement(Ve,null,pd.createElement("div",{class:pd.const("dcg-half-width-placeholder")}),w(this,"A"),w(this,"S"),w(this,"D"),w(this,"F"),w(this,"G"),w(this,"H"),w(this,"J"),w(this,"K"),w(this,"L"),pd.createElement("div",{class:pd.const("dcg-half-width-placeholder")})),pd.createElement(Ve,null,w(this,"shift",{style:"highlight"}),w(this,"Z"),w(this,"X"),w(this,"C"),w(this,"V"),w(this,"B"),w(this,"N"),w(this,"M"),w(this,","),w(this,"backspace",{style:"highlight"})),pd.createElement(Ve,null,w(this,"="),w(this,"("),w(this,")"),w(this,"["),w(this,"]"),w(this,"\xB1"),w(this,"'"),w(this,"obelus"),w(this,"enter",{style:"blue"})))}};var Fs=__dcg_shared_module_exports__['h'](z());var dI=class extends xa{template(){return Fs.createElement(rr,{controller:this.props.controller},Fs.createElement(Ve,null,w(this,"sin"),w(this,"cos"),w(this,"tan"),Fs.createElement("div",{class:Fs.const("dcg-partition-placeholder")}),w(this,"ln"),w(this,"log"),w(this,"backspace",{style:"highlight"})),Fs.createElement(Ve,null,w(this,"arcsin"),w(this,"arccos"),w(this,"arctan"),Fs.createElement("div",{class:Fs.const("dcg-partition-placeholder")}),w(this,"e^x"),w(this,"abs"),w(this,"round")),Fs.createElement(Ve,null,w(this,"mean"),w(this,"stdev"),w(this,"stdevp"),Fs.createElement("div",{class:Fs.const("dcg-partition-placeholder")}),w(this,"a^b"),w(this,"sqrt"),w(this,"nthroot")),Fs.createElement(Ve,null,w(this,"nPr"),w(this,"nCr"),w(this,"!"),Fs.createElement("div",{class:Fs.const("dcg-partition-placeholder")}),w(this,"e"),w(this,"%"),w(this,"enter",{style:"blue"})))}};var hs=__dcg_shared_module_exports__['h'](z());var pI=class extends xa{template(){return hs.createElement(rr,{controller:this.props.controller},hs.createElement(Ve,null,w(this,"1",{style:"highlight"}),w(this,"2",{style:"highlight"}),w(this,"3",{style:"highlight"}),w(this,"4",{style:"highlight"}),w(this,"5",{style:"highlight"}),w(this,"6",{style:"highlight"}),w(this,"7",{style:"highlight"}),w(this,"8",{style:"highlight"}),w(this,"9",{style:"highlight"}),w(this,"0",{style:"highlight"}),hs.createElement("div",{class:hs.const("dcg-partition-placeholder")}),w(this,"left",{style:"highlight"}),w(this,"right",{style:"highlight"}),hs.createElement("div",{class:hs.const("dcg-inline-hide-keypad-button"),"dcg-command":hs.const("hide-keypad"),onTap:()=>this.props.controller().dispatch({type:"hide-keypad"})},hs.createElement("div",{class:hs.const("dcg-inline-hide-keypad-button-inner")},hs.createElement("i",{class:hs.const("dcg-icon-hide"),"aria-hidden":hs.const("true")})))),hs.createElement(Ve,null,Gr(2),w(this,"."),w(this,"="),w(this,"+"),w(this,"-"),w(this,"multiplication"),w(this,"obelus"),Gr(3),w(this,"backspace",{style:"highlight",colspan:1.5}),Gr(1)),hs.createElement(Ve,null,Gr(2),w(this,"a/b"),w(this,","),w(this,"("),w(this,")"),w(this,"<"),w(this,">"),Gr(2.5),w(this,"enter",{colspan:2,style:"blue"}),Gr(1)))}};var bc=__dcg_shared_module_exports__['h'](z());var uI=class extends xa{template(){let r=this.props.controller();return bc.createElement(Pl,{controller:this.props.controller},bc.createElement(ci,{command:this.const("main"),selected:()=>r.getScientificKeyboardMode()==="main",ignoreInTabOrder:this.const(!0),selectable:this.const(!0),onTap:()=>r.dispatch({type:"main"})},()=>r.s("basic-calculator-button-controlbar-main")),bc.createElement(ci,{command:this.const("ABC"),selected:()=>["qwerty","capitalQwerty"].indexOf(r.getScientificKeyboardMode())!==-1,ignoreInTabOrder:this.const(!0),selectable:this.const(!0),ariaLabel:()=>r.s("basic-calculator-narration-controlbar-abc"),onTap:()=>r.dispatch({type:"ABC"})},()=>r.s("basic-calculator-button-controlbar-abc")),bc.createElement(ci,{command:this.const("functions"),selected:()=>["functions","restrictedFunctions"].indexOf(r.getScientificKeyboardMode())!==-1,ariaLabel:()=>r.s("basic-calculator-narration-controlbar-functions"),ignoreInTabOrder:this.const(!0),selectable:this.const(!0),onTap:()=>r.dispatch({type:"functions"})},()=>r.s("shared-calculator-button-controlbar-functions")),bc.createElement("div",{class:bc.const("dcg-hide-keypad-button"),"dcg-command":bc.const("hide-keypad"),onTap:()=>r.dispatch({type:"hide-keypad"})},bc.createElement("i",{class:bc.const("dcg-icon-hide"),"aria-hidden":bc.const("true")})))}};var{Switch:Eie,SwitchUnion:Gie}=jo.Components,hI=class extends xa{template(){return jo.createElement("div",{class:jo.const("dcg-calculator-api-container"),style:()=>"width: 100%; height: 100%; position: relative;"},jo.createElement("div",{class:jo.const("dcg-do-not-blur dcg-container dcg-api-shared-keypad-root"),didMount:this.bindFn(this.didMountRoot)},this.children))}didMountRoot(e){Pu(e)}},MO=class extends xa{template(){return jo.createElement(hI,__dcg_shared_module_exports__['a']({},this.props),jo.createElement("div",{class:()=>({"dcg-fourfunction-keypad-container":!0,"dcg-projector-mode":this.props.controller().getProjectorMode()!=="none","dcg-classroom-large-projector-mode":this.props.controller().getProjectorMode()==="large"}),role:jo.const("region"),"aria-label":()=>this.s("shared-calculator-narration-keypad")},jo.createElement(pI,{controller:this.props.controller})))}},AO=class extends xa{template(){return jo.createElement(hI,__dcg_shared_module_exports__['a']({},this.props),jo.createElement("div",{class:()=>({"dcg-scientific-keypad-container":!0,"dcg-projector-mode":this.props.controller().getProjectorMode()!=="none","dcg-classroom-large-projector-mode":this.props.controller().getProjectorMode()==="large"})},jo.createElement(uI,{controller:this.props.controller}),jo.createElement("div",{role:jo.const("group"),"aria-label":()=>this.s("shared-calculator-narration-keypad")},jo.createElement(Eie,{key:()=>this.controller.getScientificKeyboardMode()},e=>{switch(e){case"qwerty":return jo.createElement(lI,{controller:this.props.controller});case"capitalQwerty":return jo.createElement(cI,{controller:this.props.controller});case"functions":return jo.createElement(dI,{controller:this.props.controller});default:return jo.createElement(sI,{controller:this.props.controller})}}))))}},gI=class extends xa{template(){return Gie(()=>this.controller.getKeypadType(),{fourfunction:()=>jo.createElement(MO,__dcg_shared_module_exports__['a']({},this.props)),scientific:()=>jo.createElement(AO,__dcg_shared_module_exports__['a']({},this.props))})}};var vy=class extends sm{constructor(t,i){super(t);this.init(i)}init(t){this.controller=new IC(t),this.controller.onEventEmitted=i=>{i==="render"&&this.updateView(),this.triggerEvent(i,void 0)},this.setupDomChangeDetector(!0)}setActiveMathquill(t){this.controller.dispatch({type:"set-active-mq",mq:t})}setKeypadType(t){this.controller.dispatch({type:"set-keypad-type",keypadType:t})}onCreateView(){return Cy.mountToNode(gI,this.rootElt,{controller:Cy.const(this.controller)})}onResizeView(t){}onDestroyView(){Cy.unmountFromNode(this.rootElt)}destroy(){super.destroy()}};var Tie=__dcg_shared_module_exports__['h'](z());Lp();var VC;typeof Desmos!="undefined"?VC=Desmos:(VC={},window.Desmos=VC);var Iie={SMALL:"0.85",MEDIUM:"1",LARGE:"1.35"};function LO(...r){return new Ah(...r)}LO.prototype=Ah.prototype;function r6(...r){return new Eh(...r)}r6.prototype=Eh.prototype;function OO(...r){return new py(...r)}OO.prototype=py.prototype;function i6(...r){return new xy(...r)}i6.prototype=xy.prototype;function o6(...r){return new wy(...r)}o6.prototype=wy.prototype;function n6(...r){return new vy(...r)}n6.prototype=vy.prototype;var pm={version:$U,Colors:{RED:mk,BLUE:fk,GREEN:bk,ORANGE:xk,PURPLE:yk,BLACK:wk},imageFileToDataURL:OG,supportedLanguages:["en"].concat(typeof desmosLocaleData=="object"?Object.keys(desmosLocaleData):[]),Styles:__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},NL),RL),ColumnModes:$v,DragModes:BL,AxisArrowModes:__dcg_shared_module_exports__['Zc'],FontSizes:AG,LabelSizes:Iie,LabelOrientations:qL,GraphingCalculator:LO,Calculator:LO,FourFunctionCalculator:i6,ScientificCalculator:o6,Abraham:Xd,Private:{Abraham:Xd,Mathtools:JM,Graphtools:{ScalePair:__dcg_shared_module_exports__['Dc'],getClippingGraphType:__dcg_shared_module_exports__['Pc'],mapSegmentToCanvas:__dcg_shared_module_exports__['Jc'],computeDrawingCommandsForDOMLabel:eE,drawCommandsToCtx:tE},MathquillConfig:{getAutoCommands:qd,getAutoOperators:Ys},Parser:__dcg_shared_module_exports__['qd'],extractSliderValueFromLatex:hx,__compareBranches:{getSliderMin:xl,getSliderMax:Pc,valueTypes:__dcg_shared_module_exports__['Ga'],migrateGeoStateToCalcState:Uc},GeometryBeta:r6,migrateGeoStateToCalcState:Uc,HeadlessGraphingCalculator:OO,maybeNotifyUserChangedLatex:_e.simulateUserChangedLatex,Fragile:{DCGView:Tie,PromptSliderView:td,Checkbox:st,SegmentedControl:_r,MathquillView:_e,InlineMathInputView:ir,StaticMathquillView:ze,Tooltip:Me,ExpressionOptionsMenuView:Fb,ExpressionView:Ug,ImageIconView:Hg,evaluateLatex:gi,Keys:Dr,getQueryParams:Da,getReconciledExpressionProps:__dcg_shared_module_exports__['pc'],List:{moveItemsTo:Xu,removeItemById:Nf},currentLanguage:nx}},TestInternal:{subscribeToSharedClockBus:r=>Ls(r),getCalcConfigAll:()=>YD(),fetchLanguage:r=>of(r)},MathQuill:Zl,PillowKeypad:n6,HeadlessGraphingCalculator:OO};function PO(r){var e=VC.enabledFeatures;return!e||e[r]}function fI(r){pm[r]=function(){throw new Error("The Desmos "+r+" is not enabled for this API key.")}}PO("GraphingCalculator")||(fI("GraphingCalculator"),fI("Calculator"));PO("FourFunctionCalculator")||fI("FourFunctionCalculator");PO("ScientificCalculator")||fI("ScientificCalculator");for(mI in pm)pm.hasOwnProperty(mI)&&(VC[mI]=pm[mI]);var mI;var Pe=__dcg_shared_module_exports__['h'](z());xt();function a6(r){let e=r.split(","),t=e[0].match(/:(.*?);/),i=t!==null?t[1]:"",o=e[1]!==null?atob(e[1]):"",n=o.length,a=new Uint8Array(n);for(;n--;)a[n]=o.charCodeAt(n);return new Blob([a],{type:i})}function s6(r){if(r.indexOf("xmlns=")===-1)throw new Error('Programming error: <svg> elements require the "xmlns" attribute to render properly');return new Blob([r],{type:"image/xml+svg;charset=utf-8"})}var Rr=__dcg_shared_module_exports__['h'](z());xt();var{If:Vie}=Rr.Components,ud=class extends Rr.Class{template(){return Rr.createElement("div",{role:Rr.const("button"),tabindex:Rr.const("0"),"aria-pressed":()=>this.isSelected(),class:()=>({"dcg-option":!0,"dcg-selected":this.isSelected()}),onTap:()=>this.selectSize()},()=>ol[this.props.size()].name(this.props.controller()))}isSelected(){this.props.selectedSize(),this.props.size()}selectSize(){this.props.onSelectSize(this.props.size())}},MC=class extends Rr.Class{init(){this.menuOpen=!1,this.unmounted=!1}template(){return Rr.createElement("div",{class:Rr.const("dcg-export-image-size-options")},Rr.createElement("div",{role:Rr.const("button"),tabindex:Rr.const("0"),"aria-haspopup":Rr.const("true"),"aria-expanded":()=>this.menuOpen,class:Rr.const("dcg-selected-option"),didMount:e=>{this.menuElement=e,this.props.controller().getModalDevice()==="keyboard"&&setTimeout(()=>{this.menuElement.focus()},0)},onTap:this.bindFn(this.toggleMenu)},()=>this.selected().name(this.props.controller()),Rr.createElement("i",{class:Rr.const("dcg-icon-caret-down"),"aria-hidden":Rr.const("true")})),Rr.createElement(Vie,{predicate:()=>this.menuOpen},()=>Rr.createElement("div",{class:Rr.const("dcg-options-positioning-container")},Rr.createElement("div",{class:Rr.const("dcg-options-container"),role:Rr.const("group"),"aria-label":()=>this.props.controller().s("account-shell-narration-size-options")},Rr.createElement(ud,{controller:this.props.controller,size:this.const("small_square"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)}),Rr.createElement(ud,{controller:this.props.controller,size:this.const("medium_square"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)}),Rr.createElement(ud,{controller:this.props.controller,size:this.const("large_square"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)}),Rr.createElement(ud,{controller:this.props.controller,size:this.const("medium_rectangle"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)}),Rr.createElement(ud,{controller:this.props.controller,size:this.const("large_rectangle"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)}),Rr.createElement("h3",{class:Rr.const("dcg-embosser-title")},()=>this.props.controller().s("account-shell-heading-embossers")),Rr.createElement(ud,{controller:this.props.controller,size:this.const("vpmax8"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)}),Rr.createElement(ud,{controller:this.props.controller,size:this.const("vpmax11"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)}),Rr.createElement(ud,{controller:this.props.controller,size:this.const("etc8"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)}),Rr.createElement(ud,{controller:this.props.controller,size:this.const("etc11"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)})))))}closeMenu(){H(document.documentElement).off(".export-image-size-options"),this.menuOpen=!1,this.unmounted||this.update()}didUnmount(){H(document.documentElement).off(".export-image-size-options"),this.unmounted=!0}toggleMenu(){if(this.menuOpen){this.closeMenu();return}this.menuOpen=!0,H(document.documentElement).on("dcg-tap.export-image-size-options",e=>{e.target.closest(".dcg-export-image-size-options")||this.closeMenu()}),this.unmounted||this.update()}selectSize(e){this.menuOpen=!1,this.props.selectSize(e),this.menuElement!==void 0&&this.props.controller().getModalDevice()==="keyboard"&&this.menuElement.focus()}selected(){return ol[this.props.selectedSize()]}};var{If:hd,IfElse:Mie}=Pe.Components,ol={},LC={left:0,top:0,right:0,bottom:0};ol.small_square={width:160,height:160,margins:LC,name:r=>r.s("account-shell-label-export-size-small-square")};ol.medium_square={width:400,height:400,margins:LC,name:r=>r.s("account-shell-label-export-size-medium-square")};ol.large_square={width:1e3,height:1e3,margins:LC,name:r=>r.s("account-shell-label-export-size-large-square")};ol.medium_rectangle={width:600,height:400,margins:LC,name:r=>r.s("account-shell-label-export-size-medium-rectangle")};ol.large_rectangle={width:1200,height:800,margins:LC,name:r=>r.s("account-shell-label-export-size-large-rectangle")};ol=__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['a']({},ol),mh);var AC=class extends Pe.Class{init(){this.controller=this.props.controller(),this.thickness="thin",this.size="medium_square";let e=this.controller.api.controller.getBrailleMode();this.brailleMode=e!=="none"?e:"nemeth",this.showDownloadButton=QT(),this.unmounted=!1,this.svgDropdownOpen=!1,this.markImagesDirty(),this.loaded=!1}template(){return Pe.createElement(gc,{controller:this.props.controller},Pe.createElement("div",{id:Pe.const("export-image-dialog")},Pe.createElement("h1",null,()=>this.controller.s("account-shell-heading-export-graph")),Pe.createElement("div",{class:Pe.const("dcg-offscreen-calculator"),didMount:this.bindFn(this.didMountOffscreenCalc),willUnmount:this.bindFn(this.willUnmountOffscreenCalc),"aria-hidden":Pe.const("true")}),Pe.createElement("div",{class:Pe.const("dcg-columns")},Pe.createElement("div",{class:Pe.const("dcg-left-column")},Pe.createElement("div",{class:()=>({"dcg-graph-preview":!0,"dcg-preview-loading":this.pngDirty})},Pe.createElement(hd,{predicate:()=>this.loaded},()=>Pe.createElement("img",{class:Pe.const("dcg-graph-image"),didMount:this.bindFn(this.didMountGraphPreview),src:()=>this.previewDataURL,alt:()=>this.controller.s("account-shell-narration-graph-preview")})),Pe.createElement(hd,{predicate:()=>this.pngDirty},()=>Pe.createElement("span",{class:Pe.const("dcg-loading-message")},Pe.createElement("span",{class:Pe.const("dcg-spinner")}),()=>this.controller.s("account-shell-label-loading"))),Pe.createElement(hd,{predicate:()=>!this.pngDirty&&!this.isExportingBraille()},()=>Pe.createElement("span",{class:Pe.const("dcg-zoom-percentage")},this.bindFn(this.getZoom))))),Pe.createElement("div",{class:Pe.const("dcg-right-column")},Pe.createElement("div",{role:Pe.const("heading"),"aria-level":Pe.const("2"),class:Pe.const("dcg-section-title")},()=>this.controller.s("account-shell-heading-export-size")),Pe.createElement(MC,{controller:this.props.controller,selectedSize:()=>this.size,selectSize:this.bindFn(this.selectSize)}),Pe.createElement(hd,{predicate:()=>!this.isExportingBraille()},()=>Pe.createElement(_r,{staticConfig:this.bindFn(this.getLineThicknessOptions),ariaGroupLabel:()=>this.controller.s("account-shell-heading-line-thickness")})),Pe.createElement(hd,{predicate:()=>this.isExportingBraille()},()=>Pe.createElement("div",{class:Pe.const("braille-container")},Pe.createElement("div",{role:Pe.const("heading"),"aria-level":Pe.const("2"),class:Pe.const("dcg-section-title")},()=>this.controller.s("shared-calculator-narration-braille-mode")),Pe.createElement(_r,{staticConfig:this.bindFn(this.getBrailleOptions),ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-braille-mode")}),Pe.createElement("div",{class:Pe.const("braille-instructions")},Pe.createElement("div",{role:Pe.const("heading"),"aria-level":Pe.const("2"),class:Pe.const("dcg-section-title")},()=>this.controller.s("account-shell-heading-embossing-instructions")),Pe.createElement(hd,{predicate:()=>this.size==="vpmax8"||this.size==="vpmax11"},()=>Pe.createElement("ul",null,Pe.createElement("li",null,()=>this.controller.s("account-shell-text-embossing-vpmax-save")),Pe.createElement("li",null,()=>this.controller.s("account-shell-text-embossing-vpmax-print",{size:l6(this.size)})))),Pe.createElement(hd,{predicate:()=>this.size==="etc8"||this.size==="etc11"},()=>Pe.createElement("ul",null,Pe.createElement("li",null,()=>this.controller.s("account-shell-text-embossing-etc-save")),Pe.createElement("li",null,()=>this.controller.s("account-shell-text-embossing-etc-print",{size:l6(this.size)})))),Pe.createElement("div",{class:Pe.const("dcg-feedback-link")},Pe.createElement(si,{i18n:this.const(this.controller),key:this.const("graphing-calculator-text-export-braille-email-accessibility")},Pe.const("Feedback? Email"),Pe.const(" "),Pe.createElement("a",{class:Pe.const("dcg-blue-link"),href:Pe.const("mailto:accessibility@desmos.com")},Pe.const("accessibility@desmos.com")),Pe.const(".")))))),Mie(this.const(this.showDownloadButton),{true:()=>Pe.createElement("div",null,Pe.createElement("div",{role:Pe.const("group"),"aria-label":()=>this.controller.s("account-shell-narration-image-download"),class:()=>({"dcg-download-button-group":!0,"dcg-download-button-group-singleton":this.isExportingBraille()})},Pe.createElement(mu,{data:()=>this.previewBlob,enabled:()=>!this.pngDirty,filename:this.const("desmos-graph.png"),text:()=>this.controller.s("account-shell-button-download-png")}),Pe.createElement(hd,{predicate:()=>!this.isExportingBraille()},()=>Pe.createElement("div",{role:Pe.const("button"),tabindex:()=>this.svgDirty?-1:0,"aria-disabled":()=>this.svgDirty,"aria-expanded":()=>this.svgDropdownOpen,"aria-label":()=>this.controller.s("account-shell-button-svg-options"),class:()=>({"dcg-svg-dropdown":!0,"dcg-button":!0,"dcg-disabled":this.svgDirty}),onTap:this.bindFn(this.toggleSvgDropdown)},Pe.createElement("i",{class:Pe.const("dcg-icon-caret-down"),"aria-hidden":Pe.const("true")})))),Pe.createElement(hd,{predicate:()=>this.isExportingBraille()&&!ul},()=>Pe.createElement(mu,{data:()=>this.brailleBlob,enabled:()=>!this.pngDirty,filename:this.const("desmos-equations.brl"),text:()=>this.controller.s("account-shell-button-download-braille"),isBraille:this.const(!0)})),Pe.createElement(hd,{predicate:()=>this.svgDropdownOpen},()=>Pe.createElement("div",{class:Pe.const("dcg-svg-popover dcg-popover dcg-top"),didMount:this.bindFn(this.didMountSvgDropdown),willUnmount:this.bindFn(this.willUnmountSvgDropdown)},Pe.createElement("div",{class:Pe.const("dcg-popover-interior")},Pe.createElement(mu,{data:()=>this.svgBlob,enabled:()=>!this.svgDirty,filename:this.const("desmos-graph.svg"),text:()=>this.controller.s("account-shell-button-download-svg"),isSvg:this.const(!0)}),Pe.createElement("div",{class:Pe.const("dcg-beta-tag")},()=>this.controller.s("account-shell-label-beta"))),Pe.createElement("div",{class:Pe.const("dcg-arrow")})))),false:()=>Pe.createElement(hd,{predicate:()=>!this.isExportingBraille()},()=>Pe.createElement("div",{class:Pe.const("dcg-download-not-enabled-notice")},Pe.createElement("div",{role:Pe.const("heading"),"aria-level":Pe.const("2"),class:Pe.const("dcg-title")},()=>this.controller.s("account-shell-heading-download-instructions")),()=>this.controller.s("account-shell-text-download-instructions")))})))))}getLineThicknessOptions(){return[{key:"thin",label:()=>this.controller.s("account-shell-button-line-thin"),selected:()=>this.thickness==="thin",onSelect:()=>this.selectThickness("thin")},{key:"medium",label:()=>this.controller.s("account-shell-button-line-medium"),selected:()=>this.thickness==="medium",onSelect:()=>this.selectThickness("medium")},{key:"thick",label:()=>this.controller.s("account-shell-button-line-thick"),selected:()=>this.thickness==="thick",onSelect:()=>this.selectThickness("thick")}]}getBrailleOptions(){return[{key:"nemeth",label:()=>this.controller.s("shared-calculator-button-braille-mode-nemeth"),selected:()=>this.brailleMode==="nemeth",onSelect:()=>this.selectBrailleMode("nemeth")},{key:"ueb",label:()=>this.controller.s("shared-calculator-button-braille-mode-ueb"),selected:()=>this.brailleMode==="ueb",onSelect:()=>this.selectBrailleMode("ueb")}]}didMountSvgDropdown(e){H(document).on("dcg-tap.svg-dropdown",({target:t})=>{let i=document.querySelector(".dcg-svg-dropdown");!e||!i||!i.contains(t)&&!e.contains(t)&&this.closeSvgDropdown()})}willUnmountSvgDropdown(){H(document).off(".svg-dropdown")}didMountOffscreenCalc(e){let i=this.controller.api.controller.isGeometry()?pm.Private.GeometryBeta:pm.GraphingCalculator;i&&(this.calculator=i(e,{expressions:!1,keypad:!1,branding:!1,border:!1,enableTabindex:!1}),this.calculator._calc.evaluator.notifyWhenSynced(()=>{this.markImagesDirty(),this.updateIfMounted()}),this.calculator.setState(this.controller.api.getState()))}willUnmountOffscreenCalc(){this.calculator&&this.calculator.destroy()}markImagesDirty(){this.pngDirty=!0,this.svgDirty=!0}selectSize(e){this.size=e,this.markImagesDirty(),this.updateIfMounted()}selectBrailleMode(e){this.brailleMode=e,this.markImagesDirty(),this.updateIfMounted()}getZoom(){return this.controller.s("account-shell-label-zoom",{value:Math.min(100,Math.round(100*400/this.getWidth()))})}selectThickness(e){this.thickness=e,this.markImagesDirty(),this.updateIfMounted()}didMountGraphPreview(e){this.previewImg=e}getGridOpacity(){switch(this.thickness){case"thick":return 1;case"medium":return .6;case"thin":return .4;default:return this.thickness}}getAxisWeight(){switch(this.thickness){case"thick":return 2;case"medium":return 2;case"thin":return 1.5;default:return this.thickness}}getGraphThickness(){switch(this.thickness){case"thick":return 5;case"medium":return 3.5;case"thin":return 2.5;default:return this.thickness}}getLabelSize(){if(this.size==="small_square")switch(this.thickness){case"thick":return 14;case"medium":return 12;case"thin":return 10;default:return this.thickness}else switch(this.thickness){case"thick":return 20;case"medium":return 17;case"thin":return 14;default:return this.thickness}}updateViewSettings(){if(this.calculator===void 0||this.calculator._calc===void 0||this.calculator._calc.grapher===void 0||this.calculator._calc.grapher.settings===void 0)return;let e=this.calculator._calc.grapher.settings;this.isExportingBraille()||(e.majorAxisOpacity=this.getGridOpacity(),e.minorAxisOpacity=this.getGridOpacity()/2,e.axisLineOffset=0,e.setProperty("axisLineWidth",this.getAxisWeight()),e.labelSize=this.getLabelSize(),e.graphLineWidth=this.getGraphThickness(),e.pointLineWidth=this.getGraphThickness()*3)}getBackgroundSize(){switch(this.size){case"medium_rectangle":case"large_rectangle":return"contain";case"small_square":return`${ol.small_square.width}px ${ol.small_square.height}px`;default:return"cover"}}getHeight(){return ol[this.size].height}getWidth(){return ol[this.size].width}didUnmount(){this.unmounted=!0}updateIfMounted(){this.unmounted||this.update()}updateGraphPreview(){if(!this.pngDirty&&!this.svgDirty||this.calculator===void 0||this.calculator._calc===void 0||this.calculator._calc.grapher===void 0||this.calculator._calc.grapher.settings===void 0)return;this.updateViewSettings();let e={width:this.getWidth(),height:this.getHeight(),preserveAxisNumbers:!0,showLabels:!0,targetPixelRatio:2},t={braille:{embosserModel:this.size,brailleMode:this.brailleMode}};if(this.pngDirty){let o=this.isExportingBraille()?t:e;this.calculator.asyncScreenshot(o,n=>{typeof n=="string"&&(this.previewDataURL=n,this.previewBlob=a6(this.previewDataURL),this.pngDirty=!1,this.loaded=!0,this.updateIfMounted(),this.resizePreviewImg())})}if(this.svgDirty){var i=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},e),{svg:!0});let o=Pr("worksheetSVG");o&&(i.targetPixelRatio=1),this.calculator.asyncScreenshot(i,n=>{typeof n=="string"&&(o&&(n=Lie(n)),n!==void 0&&(this.svgBlob=s6(n),this.svgDirty=!1,this.updateIfMounted(),this.resizePreviewImg()))})}}updateBrailleEquations(){if(this.isExportingBraille()){let e=JU(this.controller.api.controller,this.brailleMode);this.brailleBlob=new Blob([e],{type:"text/plain"})}}resizePreviewImg(){if(!this.previewImg)return;let e=1;(this.size==="etc8"||this.size==="etc11")&&(e=2),(this.size==="vpmax8"||this.size==="vpmax11")&&(e=1.5);let t=Math.min(this.getWidth(),400),o=this.getHeight()/this.getWidth()*t;this.previewImg.width=t*e,this.previewImg.height=o*e}willUpdate(){this.updateGraphPreview(),this.updateBrailleEquations()}isExportingBraille(){return Aie(this.size)}closeSvgDropdown(){this.svgDropdownOpen=!1,this.updateIfMounted()}toggleSvgDropdown(){this.svgDropdownOpen=!this.svgDropdownOpen,this.updateIfMounted()}};function Aie(r){return r==="vpmax8"||r==="vpmax11"||r==="etc8"||r==="etc11"}function l6(r){switch(r){case"etc8":return"8.5 x 11.0";case"etc11":return"11.5 x 11.0";case"vpmax8":return"8.5 x 11";case"vpmax11":return"11.5 x 11";default:return r}}function Lie(r){var e=new DOMParser,t=e.parseFromString(r,"text/xml");function i(o,n){t.querySelectorAll(o).forEach(n)}return i(".dcg-svg-region",function(o){o.setAttribute("fill","black")}),i(".dcg-svg-label *",function(o){o.setAttribute("stroke","none"),o.setAttribute("fill","black")}),i(".dcg-svg-axis-value text",function(o){o.getAttribute("stroke")!=="none"?o.parentElement&&o.parentElement.removeChild(o):(o.setAttribute("font-family","Helvetica Neue"),o.setAttribute("font-weight","bold"))}),i(".dcg-svg-offcenter-axis-value",function(o){o.parentElement&&o.parentElement.removeChild(o)}),i(".dcg-svg-curve",function(o){o.setAttribute("stroke","black"),o.setAttribute("stroke-width","5"),o.setAttribute("stroke-opacity","1")}),i(".dcg-svg-point",function(o){o.setAttribute("stroke","black"),o.setAttribute("stroke-width","10"),o.setAttribute("stroke-opacity","1")}),i(".dcg-svg-background",function(o){var n=parseFloat(o.getAttribute("width")),a=parseFloat(o.getAttribute("height")),s=3,l=t.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("d",`M${n-s},${s}v${a-2*s}H${s}V${s}H${n-s} M${n},0H0v${a}h${n}V0L${n},0z`),o.parentElement.appendChild(l)}),i(".dcg-svg-axis-line",function(o){o.setAttribute("stroke","black"),o.setAttribute("stroke-width","4"),o.setAttribute("stroke-opacity","1")}),i(".dcg-svg-minor-gridline, .dcg-svg-major-gridline",function(o){o.setAttribute("stroke","black"),o.setAttribute("stroke-width","1"),o.setAttribute("stroke-opacity","1")}),t.firstChild.outerHTML}var Zn=__dcg_shared_module_exports__['h'](z());var bI=class extends Zn.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.openTime=Date.now(),this.formErrors=[],this.controller.logJSON("shared-consent-modal",{action:"show-consent-modal"})}template(){return Zn.createElement(ko,{title:()=>this.i18n.s("shared-title-consent"),size:this.const("narrow"),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},Zn.createElement("div",{class:Zn.const("dcg-shared-consent-modal-container dcg-shared-account-dialog")},Zn.createElement("div",{class:Zn.const("dcg-shared-consent-contents")},()=>this.i18n.s("shared-message-consent-information")),Zn.createElement("div",{class:Zn.const("dcg-shared-consent-contents")},()=>this.i18n.s("shared-message-consent-delete-information")),Zn.createElement("div",{class:Zn.const("dcg-shared-modal-actions-container")},Zn.createElement("span",{role:Zn.const("button"),tabindex:Zn.const("0"),class:Zn.const("dcg-gray-link"),onTap:e=>this.openAccountSettings(e.device)},()=>this.i18n.s("shared-button-go-to-account-settings")),Zn.createElement("div",{role:Zn.const("button"),tabindex:()=>this.isConsentingToCollection()?-1:0,"aria-disabled":()=>this.isConsentingToCollection(),class:()=>({"dcg-btn-blue":!0,"dcg-disabled":this.isConsentingToCollection()}),onTap:this.bindFn(this.consentToCollection)},()=>this.i18n.s("shared-button-accept")),Zn.createElement(Qn,{controller:this.props.controller,errors:()=>this.formErrors}))))}willUpdate(){this.formErrors=[],this.controller.userController.didPrivacyConsentFail()&&(this.formErrors=[this.controller.getSomethingWentWrongText()])}isConsentingToCollection(){return this.controller.userController.isConsentingToPrivacy()}didPrivacyConsentFail(){return this.controller.userController.didPrivacyConsentFail()}openAccountSettings(e){this.controller.logJSON("shared-consent-modal",{action:"edit-account",ts:Date.now()-this.openTime}),this.controller.dispatch({type:"show-modal",modal:"account-settings",device:e})}consentToCollection(){this.controller.logJSON("shared-consent-modal",{action:"consent",ts:Date.now()-this.openTime}),this.controller.userController.setPrivacyConsent({lang:this.controller.getLanguage()}),this.controller.dispatch({type:"close-modal"})}};var c6=`[
  "Afganistan",
  "Albania",
  "Algeria",
  "American Samoa",
  "Andorra",
  "Angola",
  "Anguilla",
  "Antigua & Barbuda",
  "Argentina",
  "Armenia",
  "Aruba",
  "Australia",
  "Austria",
  "Azerbaijan",
  "Bahamas",
  "Bahrain",
  "Bangladesh",
  "Barbados",
  "Belarus",
  "Belgium",
  "Belize",
  "Benin",
  "Bermuda",
  "Bhutan",
  "Bolivia",
  "Bonaire",
  "Bosnia & Herzegovina",
  "Botswana",
  "Brazil",
  "British Indian Ocean Ter",
  "Brunei",
  "Bulgaria",
  "Burkina Faso",
  "Burundi",
  "Cambodia",
  "Cameroon",
  "Canada",
  "Canary Islands",
  "Cape Verde",
  "Cayman Islands",
  "Central African Republic",
  "Chad",
  "Channel Islands",
  "Chile",
  "China",
  "Christmas Island",
  "Cocos Island",
  "Colombia",
  "Comoros",
  "Congo",
  "Cook Islands",
  "Costa Rica",
  "Cote DIvoire",
  "Croatia",
  "Cuba",
  "Curaco",
  "Cyprus",
  "Czech Republic",
  "Denmark",
  "Djibouti",
  "Dominica",
  "Dominican Republic",
  "East Timor",
  "Ecuador",
  "Egypt",
  "El Salvador",
  "Equatorial Guinea",
  "Eritrea",
  "Estonia",
  "Ethiopia",
  "Falkland Islands",
  "Faroe Islands",
  "Fiji",
  "Finland",
  "France",
  "French Guiana",
  "French Polynesia",
  "French Southern Ter",
  "Gabon",
  "Gambia",
  "Georgia",
  "Germany",
  "Ghana",
  "Gibraltar",
  "Great Britain",
  "Greece",
  "Greenland",
  "Grenada",
  "Guadeloupe",
  "Guam",
  "Guatemala",
  "Guinea",
  "Guyana",
  "Haiti",
  "Hawaii",
  "Honduras",
  "Hong Kong",
  "Hungary",
  "Iceland",
  "Indonesia",
  "India",
  "Iran",
  "Iraq",
  "Ireland",
  "Isle of Man",
  "Israel",
  "Italy",
  "Jamaica",
  "Japan",
  "Jordan",
  "Kazakhstan",
  "Kenya",
  "Kiribati",
  "Korea North",
  "Korea Sout",
  "Kuwait",
  "Kyrgyzstan",
  "Laos",
  "Latvia",
  "Lebanon",
  "Lesotho",
  "Liberia",
  "Libya",
  "Liechtenstein",
  "Lithuania",
  "Luxembourg",
  "Macau",
  "Macedonia",
  "Madagascar",
  "Malaysia",
  "Malawi",
  "Maldives",
  "Mali",
  "Malta",
  "Marshall Islands",
  "Martinique",
  "Mauritania",
  "Mauritius",
  "Mayotte",
  "Mexico",
  "Midway Islands",
  "Moldova",
  "Monaco",
  "Mongolia",
  "Montserrat",
  "Morocco",
  "Mozambique",
  "Myanmar",
  "Nambia",
  "Nauru",
  "Nepal",
  "Netherland Antilles",
  "Netherlands",
  "Nevis",
  "New Caledonia",
  "New Zealand",
  "Nicaragua",
  "Niger",
  "Nigeria",
  "Niue",
  "Norfolk Island",
  "Norway",
  "Oman",
  "Pakistan",
  "Palau Island",
  "Palestine",
  "Panama",
  "Papua New Guinea",
  "Paraguay",
  "Peru",
  "Phillipines",
  "Pitcairn Island",
  "Poland",
  "Portugal",
  "Puerto Rico",
  "Qatar",
  "Republic of Montenegro",
  "Republic of Serbia",
  "Reunion",
  "Romania",
  "Russia",
  "Rwanda",
  "St Barthelemy",
  "St Eustatius",
  "St Helena",
  "St Kitts-Nevis",
  "St Lucia",
  "St Maarten",
  "St Pierre & Miquelon",
  "St Vincent & Grenadines",
  "Saipan",
  "Samoa",
  "Samoa American",
  "San Marino",
  "Sao Tome & Principe",
  "Saudi Arabia",
  "Senegal",
  "Seychelles",
  "Sierra Leone",
  "Singapore",
  "Slovakia",
  "Slovenia",
  "Solomon Islands",
  "Somalia",
  "South Africa",
  "Spain",
  "Sri Lanka",
  "Sudan",
  "Suriname",
  "Swaziland",
  "Sweden",
  "Switzerland",
  "Syria",
  "Tahiti",
  "Taiwan",
  "Tajikistan",
  "Tanzania",
  "Thailand",
  "Togo",
  "Tokelau",
  "Tonga",
  "Trinidad & Tobago",
  "Tunisia",
  "Turkey",
  "Turkmenistan",
  "Turks & Caicos Is",
  "Tuvalu",
  "Uganda",
  "United Kingdom",
  "Ukraine",
  "United Arab Erimates",
  "United States",
  "Uraguay",
  "Uzbekistan",
  "Vanuatu",
  "Vatican City State",
  "Venezuela",
  "Vietnam",
  "Virgin Islands (Brit)",
  "Virgin Islands (USA)",
  "Wake Island",
  "Wallis & Futana Is",
  "Yemen",
  "Zaire",
  "Zambia",
  "Zimbabwe"
]
`;var U=__dcg_shared_module_exports__['h'](z());var Ni=__dcg_shared_module_exports__['h'](z());var{If:yI,For:Pie,Input:_ie}=Ni.Components,OC=class extends Ni.Class{constructor(){super(...arguments),this.filter=void 0,this.focusLocation=void 0,this.lastResultCount=0}init(){this.controller=this.props.controller()}template(){return Ni.createElement("div",{class:Ni.const("dcg-search-container"),onKeydown:this.bindFn(this.onKeydown)},Ni.createElement(yI,{predicate:this.props.renderWithInput},()=>Ni.createElement("div",{role:Ni.const("search"),class:Ni.const("dcg-searchable-dropdown")},Ni.createElement(_ie,{class:()=>({"dcg-results-hidden":!this.showResults()}),didMount:this.bindFn(this.didMountInput),onInput:this.bindFn(this.onInputChange),value:this.bindFn(this.getFilterString),placeholder:()=>this.props.placeholder(),manageFocus:this.const({shouldBeFocused:this.bindFn(this.shouldFilterBeFocused),onFocusedChanged:this.bindFn(this.onFilterFocusChange)})}),Ni.createElement(yI,{predicate:()=>this.shouldShowDeleteX()},()=>Ni.createElement("i",{class:Ni.const("dcg-icon-remove dcg-remove-x dcg-do-not-blur"),role:Ni.const("button"),tabindex:Ni.const("0"),"aria-label":()=>this.controller.s("shared-calculator-button-clear"),onTap:this.bindFn(this.onDeleteXTapped)})))),Ni.createElement(yI,{predicate:()=>this.getFilteredOptions().length>0&&this.showResults()},()=>Ni.createElement("div",{class:()=>{var e,t;return{"dcg-searchable-dropdown-list-container":!0,"dcg-render-as-popover":(t=(e=this.props).popoverOptionsOnFocus)==null?void 0:t.call(e)}}},Ni.createElement(Pie,{each:()=>this.getFilteredOptions(),key:e=>e.id+"-"+e.label},Ni.createElement("div",{class:()=>({"dcg-searchable-dropdown-list":!0,"dcg-do-not-blur":!0,"dcg-no-input":!this.props.renderWithInput()}),role:Ni.const("listbox"),"aria-label":()=>this.controller.s("shared-calculator-label-search-results")},e=>Ni.createElement("div",{class:Ni.const("dcg-searchable-dropdown-option"),role:Ni.const("option"),onTap:t=>this.selectOption(e,t.device==="keyboard"),manageFocus:this.const({shouldBeFocused:()=>this.shouldOptionBeFocused(e),onFocusedChanged:t=>this.onOptionFocusChange(e,t)}),tabindex:Ni.const(0)},this.const(e.label)))))),Ni.createElement(yI,{predicate:()=>this.getFilteredOptions().length===0&&this.showResults()},()=>Ni.createElement("div",{class:()=>{var e,t;return{"dcg-searchable-dropdown-list-container":!0,"dcg-render-as-popover":(t=(e=this.props).popoverOptionsOnFocus)==null?void 0:t.call(e)}}},Ni.createElement("div",{class:()=>({"dcg-searchable-dropdown-list":!0,"dcg-no-search-results":!0})},()=>this.controller.s("shared-calculator-text-search-results",{count:new Vo(0)})))))}showResults(){var e,t;return(t=(e=this.props).popoverOptionsOnFocus)!=null&&t.call(e)?!!this.focusLocation:!0}didMountInput(){var e,t;(t=(e=this.props).popoverOptionsOnFocus)!=null&&t.call(e)||this.focusFilter()}shouldShowDeleteX(){return!!this.getFilterString()}onDeleteXTapped(e){this.onInputChange(""),this.props.externalControl?(this.props.externalControl().onClear(),e.device==="keyboard"&&this.focusFilter()):(this.focusFilter(),this.update())}shouldFilterBeFocused(){return this.focusLocation&&this.focusLocation.type==="filter"}onFilterFocusChange(e){e?this.focusFilter():(this.focusLocation=void 0,this.update())}shouldOptionBeFocused(e){return this.focusLocation&&this.focusLocation.type==="option"&&this.focusLocation.id===e.id}focusFilter(){this.focusLocation={type:"filter"},this.update()}focusOption(e){this.focusLocation={type:"option",id:e.id},this.update()}getFocusedOptionIndex(){if(!this.focusLocation||this.focusLocation.type!=="option")return-1;for(var e=this.focusLocation.id,t=this.getFilteredOptions(),i=0;i<t.length;i++){var o=t[i];if(o.id===e)return i}return-1}onOptionFocusChange(e,t){t?this.focusOption(e):(this.focusLocation=void 0,this.update())}onKeydown(e){switch(Ee(e)){case fs:if(this.shouldFilterBeFocused()){var t=this.getFilteredOptions();t.length===1&&this.selectOption(t[0],!0)}break;case gn:this.moveFocusInDirection(-1)&&e.preventDefault();break;case mn:this.moveFocusInDirection(1)&&e.preventDefault();break;case Lu:e.preventDefault(),this.focusFirstOption();break;case Au:e.preventDefault(),this.focusLastOption();break;case hn:this.props.onCancel();break;case hl:e.shiftKey?this.moveFocusInDirection(-1)&&e.preventDefault():this.moveFocusInDirection(1)&&e.preventDefault();break}}moveFocusInDirection(e){var t=this.getFilteredOptions(),i=this.getFocusedOptionIndex(),o=i+e;if(o==-1&&this.props.renderWithInput())return this.focusFilter(),!0;var n=t[o];return n?(this.focusOption(n),!0):!1}focusFirstOption(){var e=this.getFilteredOptions();e.length!==0&&this.focusOption(e[0])}focusLastOption(){var e=this.getFilteredOptions();e.length!==0&&this.focusOption(e[e.length-1])}onInputChange(e){this.props.externalControl?this.props.externalControl().onValueChange(e):this.filter=e,this.update()}getFilterString(){return this.props.externalControl?this.props.externalControl().getValue():this.filter||""}selectOption(e,t){var i,o;(o=(i=this.props).popoverOptionsOnFocus)!=null&&o.call(i)?this.onInputChange(e.label):this.onInputChange(""),this.focusLocation=void 0,this.update(),this.props.onChange({value:e.id,fromKeyboard:t})}getFilteredOptions(){var e=this.props.options(),t=this.getFilterString().toLowerCase().trim();return t&&(e=e.filter(function(i){return i.label.toLowerCase().indexOf(t)!==-1})),e}onUpdate(){let e=this.getFilteredOptions().length;this.focusLocation&&this.focusLocation.type==="filter"&&e!==this.lastResultCount&&be(this.controller.s("shared-calculator-text-search-results",{count:new Vo(e)})),this.lastResultCount=e}};var{If:Lh,IfElse:d6,Input:p6,SwitchUnion:Fie,Textarea:Rie}=U.Components,Nie=JSON.parse(c6).map(function(r){return{id:r,label:r}}),u6=[];for(PC=2020;PC>=1900;PC--)u6.push({id:PC+"",label:PC+""});var PC,Bie={China:14,"Hong Kong":18,India:18,Indonesia:18,Phillipines:18,Russia:18,Austria:14,Belgium:13,Bulgaria:14,Croatia:16,Cyprus:14,"Czech Republic":15,Denmark:13,Estonia:13,Finland:13,France:15,Germany:16,Greece:15,Hungary:16,Ireland:16,Italy:14,Latvia:13,Lithuania:14,Luxembourg:16,Malta:13,Netherlands:16,Norway:13,Poland:16,Portugal:13,Romania:16,Slovakia:16,Slovenia:15,Spain:14,Sweden:13,Switzerland:16,"United Kingdom":13,Canada:13,"United States":13},_C=class extends U.Class{didUnmount(){this.unmounted=!0}init(){this.controller=this.props.controller(),this.selectedData={},this.userOwnsGraph=!1,this.isSubmittingEntry=!1,this.isVerifyingEligility=!1,this.controller.state.artContestURLFromShareMenu&&(this.overwriteGraphURL=this.controller.state.artContestURLFromShareMenu,this.controller.state.artContestURLFromShareMenu=void 0),Qt("art-contest::open-modal",{from:this.overwriteGraphURL?"share":"top-bar"}),this.checkForExistingSubmission()}getScreen(){return this.isCheckingSubmission?"checking-submission":this.currentSubmission?"showing-submission":this.shouldShowSaveAnimation()?"saving":this.shouldShowSaveFailed()?"save-failed":this.didSubmissionFail?"submit-failed":this.isSubmittingEntry?"submitting":this.didSubmissionSucceed?"submitted":this.isVerifyingEligility?"form":!this.userOwnsGraph||!this.isLoggedIn()?"ask-intention":"form"}template(){return U.createElement(gc,{controller:this.props.controller},U.createElement("div",{class:U.const("dcg-contest-submission-dialog")},Fie(()=>this.getScreen(),{"checking-submission":()=>U.createElement("div",{class:U.const("dcg-save-animation-container dcg-contest-checking-submission-screen")},U.createElement("div",{class:U.const("dcg-saving")},U.createElement("div",{class:U.const("dcg-save-animation"),"aria-live":U.const("polite"),"aria-atomic":U.const("true")},U.createElement("span",{class:U.const("dcg-spinner")}),()=>"Checking submission"))),"check-failed":()=>U.createElement("div",{class:U.const("dcg-save-animation-container")},U.createElement("div",{class:U.const("dcg-saving")},U.createElement("div",{class:U.const("dcg-save-animation"),"aria-live":U.const("polite"),"aria-atomic":U.const("true")},()=>"Check failed"))),"showing-submission":()=>U.createElement("div",{class:U.const("dcg-art-contest-info-container")},U.createElement("div",{class:U.const("dcg-art-contest-world-image dcg-art-contest-submission-thumbnail")},U.createElement("img",{src:()=>{var e;return(e=this.currentSubmission)==null?void 0:e.thumbURL},alt:()=>this.controller.s("account-shell-label-submission-received")})),U.createElement("div",{class:U.const("dcg-contest-about")},U.createElement("div",{role:U.const("heading"),"aria-level":U.const("1"),class:U.const("dcg-contest-submission-title")},()=>this.controller.s("account-shell-label-submission-already-received")),U.createElement("div",{class:U.const("dcg-contest-text")},U.createElement(si,{i18n:this.const(this.controller),key:this.const("account-shell-text-art-contest-submission-already-received")},U.createElement("div",null,U.const("Your previous submission to the Global Math Art Contest was successfully received! You can click the link below to update your submission, any time before January 15th."))),U.createElement("div",{class:U.const("dcg-submission-section")},U.createElement("div",{class:U.const("dcg-submission-header")},()=>this.controller.s("account-shell-heading-name")),U.createElement("div",{class:U.const("dcg-submission-content")},()=>{var e;return(e=this.currentSubmission)==null?void 0:e.name})),U.createElement("div",{class:U.const("dcg-submission-section")},U.createElement("div",{class:U.const("dcg-submission-header")},()=>this.controller.s("account-shell-heading-email")),U.createElement("div",{class:U.const("dcg-submission-content")},()=>{var e;return(e=this.currentSubmission)==null?void 0:e.email})),U.createElement("div",{class:U.const("dcg-submission-section")},U.createElement("div",{class:U.const("dcg-submission-header")},()=>this.controller.s("account-shell-heading-artist-statement")),U.createElement("div",{class:U.const("dcg-submission-content")},()=>{var e;return(e=this.currentSubmission)==null?void 0:e.artistStatement}))),U.createElement("div",null,U.createElement("div",{class:U.const("dcg-resubmit-link"),onTap:this.bindFn(this.submitANewGraph),tabindex:U.const(0),role:U.const("button")},()=>this.controller.s("account-shell-button-update-graph"))))),saving:()=>U.createElement("div",{class:U.const("dcg-save-animation-container")},U.createElement("div",{class:U.const("dcg-saving")},U.createElement("div",{class:U.const("dcg-save-animation"),"aria-live":U.const("polite"),"aria-atomic":U.const("true")},U.createElement("span",{class:U.const("dcg-spinner")}),()=>this.controller.s("account-shell-label-saving-graph")))),"save-failed":()=>U.createElement("div",{class:U.const("dcg-save-animation-container")},U.createElement("div",{class:U.const("dcg-saving")},U.createElement("div",{class:U.const("dcg-save-animation"),"aria-live":U.const("polite"),"aria-atomic":U.const("true")},()=>this.controller.s("account-shell-error-save-art-contest")))),submitting:()=>U.createElement("div",{class:U.const("dcg-save-animation-container")},U.createElement("div",{class:U.const("dcg-saving")},U.createElement("div",{class:U.const("dcg-save-animation"),"aria-live":U.const("polite"),"aria-atomic":U.const("true")},U.createElement("span",{class:U.const("dcg-spinner")}),()=>this.controller.s("account-shell-label-submitting")))),"submit-failed":()=>U.createElement("div",{class:U.const("dcg-save-animation-container")},U.createElement("div",{class:U.const("dcg-saving")},U.createElement("div",{class:U.const("dcg-save-animation"),"aria-live":U.const("polite"),"aria-atomic":U.const("true")},()=>this.controller.s("account-shell-error-submitting")))),submitted:()=>U.createElement("div",{class:U.const("dcg-save-animation-container")},U.createElement("div",{class:U.const("dcg-art-contest-success-image")},U.createElement("img",{src:U.const("/assets/img/contest/submitted.jpg"),alt:()=>this.controller.s("account-shell-text-alt-text-success")})),U.createElement("div",{class:U.const("dcg-save-success"),"aria-live":U.const("polite"),"aria-atomic":U.const("true")},()=>this.controller.s("account-shell-label-submission-received"),U.createElement("div",{class:U.const("dcg-save-animation-content")},U.createElement("div",null,U.createElement("div",{class:U.const("dcg-congrats-message")},U.createElement(si,{i18n:this.const(this.controller),key:this.const("account-shell-text-art-contest-success-paragraph")},U.const("If you'd like to revise your submission, feel free to resubmit anytime before"),U.createElement("span",{class:U.const("bold-text")},U.const(" January 15th")),U.const(". We'll only look at the most recent submission."))),U.createElement("div",{class:U.const("dcg-congrats-message")},()=>this.controller.s("account-shell-text-art-contest-congratulations")))))),"ask-intention":()=>U.createElement("div",{class:U.const("dcg-art-contest-info-container")},U.createElement("div",{class:U.const("dcg-art-contest-world-image")},U.createElement("img",{src:U.const("/assets/img/contest/globe.png"),alt:()=>this.controller.s("account-shell-text-alt-text-art-contest")})),U.createElement("div",{class:U.const("dcg-contest-about")},U.createElement("div",{role:U.const("heading"),"aria-level":U.const("1"),class:U.const("dcg-contest-submission-title")},()=>this.controller.s("account-shell-heading-math-art-contest")),U.createElement("div",{class:U.const("dcg-contest-text")},U.createElement(si,{i18n:this.const(this.controller),key:this.const("account-shell-text-art-contest-about-paragraph")},U.const("Want to share your awesome graph with the world? Students ages 13+ can enter the Desmos Global Math Art Contest before"),U.createElement("span",{class:U.const("bold-text")},U.const(" January 15th ")),U.const("for a chance to be featured on our website and win other prizes!"),U.const(" "),U.createElement("a",{class:U.const("dcg-blue-link"),href:()=>this.getBlogPostURL(),target:U.const("_blank"),didMount:e=>e.focus()},U.const("Learn more")))),U.createElement("div",null,U.createElement(Lh,{predicate:()=>!this.getCannotSubmitReason()},()=>U.createElement("div",{class:()=>({"dcg-btn-blue":!0,"dcg-submit-this-graph-btn":!0,"dcg-disabled":this.shouldDisableSubmitThisGraph()}),onTap:this.bindFn(this.chooseSubmitThisGraph),tabindex:U.const(0),role:U.const("button")},()=>this.controller.s("account-shell-button-submit-graph"))),U.createElement(Lh,{predicate:()=>!!this.getCannotSubmitReason()},()=>U.createElement("div",{class:U.const("dcg-cannot-submit-reason")},()=>this.getCannotSubmitReason())),U.createElement("div",{class:U.const("age-check-container")},()=>this.controller.s("account-shell-text-contest-under-16"),U.const(" "),U.createElement("a",{class:U.const("dcg-blue-link"),onTap:this.bindFn(this.chooseVerifyEligibility)},()=>this.controller.s("account-shell-text-contest-verify-eligibility")))))),form:()=>U.createElement("div",null,U.createElement("div",{role:U.const("heading"),"aria-level":U.const("1"),class:U.const("dcg-contest-submission-title")},()=>this.controller.s("account-shell-heading-submit-graph")),U.createElement("div",{class:U.const("dcg-submission-form")},U.createElement("div",{class:U.const("dcg-country-and-year")},U.createElement("div",{class:U.const("dcg-form-section")},U.createElement("div",{class:U.const("dcg-section-title")},()=>this.controller.s("account-shell-heading-country")),U.createElement(Lh,{predicate:()=>!!this.getSelectedCountry()},()=>U.createElement("span",{class:U.const("dcg-blue-link dcg-clear-country"),onTap:()=>this.setSelectedCountry(void 0),tabindex:U.const(0),role:U.const("button"),"aria-label":()=>this.controller.s("account-shell-narration-clear-selected-country")},()=>this.controller.s("account-shell-button-clear"))),d6(()=>!!this.getSelectedCountry(),{true:()=>U.createElement("div",{class:U.const("dcg-your-country-name")},()=>this.getSelectedCountry()),false:()=>U.createElement(OC,{controller:this.const(this.controller),options:()=>this.getListOfCountries(),onChange:e=>this.setSelectedCountry(e.value),onCancel:()=>this.setSelectedCountry(void 0),renderWithInput:()=>!0,placeholder:()=>this.controller.s("account-shell-label-country-placeholder")})})),U.createElement(Lh,{predicate:()=>this.shouldShowAgeOptions()},()=>U.createElement("div",{class:U.const("dcg-form-section")},U.createElement("div",{class:U.const("dcg-section-title")},()=>this.controller.s("account-shell-heading-birth-year")),d6(()=>!!this.getSelectedYear(),{true:()=>U.createElement("div",{class:U.const("dcg-your-birth-year")},()=>this.getSelectedYear()),false:()=>U.createElement(OC,{controller:this.const(this.controller),options:()=>this.getListOfYears(),onChange:e=>this.setSelectedYear(e.value),onCancel:()=>this.setSelectedYear(void 0),renderWithInput:()=>!0,placeholder:()=>this.controller.s("account-shell-label-birth-year-placeholder")})})))),U.createElement(Lh,{predicate:()=>this.shouldShowEligible()&&!this.getCannotSubmitReason()},()=>U.createElement("div",{class:U.const("dcg-eligible-message dcg-teal-notice")},U.const("\u{1F389} "),()=>this.controller.s("account-shell-label-you-are-eligible"))),U.createElement(Lh,{predicate:()=>this.shouldShowConsentOptions()},()=>U.createElement("div",null,U.createElement("div",{class:U.const("dcg-form-section-flex")},U.createElement("div",{class:U.const("dcg-form-section")},U.createElement("div",{class:U.const("dcg-section-title")},()=>this.controller.s("account-shell-heading-name")),U.createElement("div",{class:U.const("dcg-section-subtitle")},()=>this.controller.s("account-shell-heading-name-details")),U.createElement(p6,{class:this.const("dcg-shared-input-blue-outline"),onInput:e=>this.setUserName(e),value:this.bindFn(this.getUserName),placeholder:()=>this.controller.s("account-shell-label-full-name"),disabled:()=>!1})),U.createElement("div",{class:U.const("dcg-form-section")},U.createElement("div",{class:U.const("dcg-section-title")},()=>this.controller.s("account-shell-heading-email")),U.createElement("div",{class:U.const("dcg-section-subtitle")},()=>this.controller.s("account-shell-heading-email-details")),U.createElement(p6,{class:this.const("dcg-shared-input-blue-outline"),onInput:e=>this.setUserEmail(e),value:this.bindFn(this.getUserEmail),placeholder:()=>this.controller.s("account-shell-label-email-address"),disabled:()=>!1}))),U.createElement("div",{class:U.const("dcg-form-section")},U.createElement("div",{class:U.const("dcg-section-title")},()=>this.controller.s("account-shell-heading-artist-statement")),U.createElement("div",{class:U.const("dcg-section-subtitle")},()=>this.controller.s("account-shell-label-artiist-statement-description")),U.createElement(Rie,{class:this.const("dcg-shared-input-blue-outline dcg-artist-statement-input"),onInput:e=>this.setArtistStatement(e),value:this.bindFn(this.getArtistStatement),maxlength:this.const(900),placeholder:()=>this.controller.s("account-shell-label-artist-statement-placeholder")})),U.createElement(st,{checked:this.bindFn(this.getConsentTicked),onChange:this.bindFn(this.toggleConsent)},()=>this.controller.s("account-shell-text-art-contest-copyright-agreement")),U.createElement("div",{class:()=>({"dcg-btn-blue":!0,"dcg-disabled":this.isSubmitButtonDisabled(),"dcg-submit-this-graph-btn":!0}),onTap:this.bindFn(this.submitEntry),tabindex:U.const(0)},()=>this.controller.s("account-shell-button-submit-graph")),U.createElement("div",{class:U.const("dcg-disclaimer")},()=>this.controller.s("account-shell-text-art-contest-legal-disclaimer")))),U.createElement(Lh,{predicate:()=>this.shouldShowEligible()&&!!this.getCannotSubmitReason()},()=>U.createElement("div",{class:U.const("dcg-login-notice dcg-teal-notice")},U.const("\u{1F389} "),()=>this.controller.s("account-shell-label-you-are-eligible"),U.const(" "),()=>this.getCannotSubmitReason())),U.createElement(Lh,{predicate:()=>this.shouldShowIneligible()},()=>U.createElement("div",{class:U.const("dcg-ineligible-container")},U.createElement("i",{class:U.const("dcg-icon-error"),"aria-hidden":U.const("true")}),U.createElement(si,{i18n:this.const(this.controller),key:this.const("account-shell-text-artcontest-ineligible")},U.createElement("div",{class:U.const("dcg-ineligible-text-container")},U.createElement("div",{class:U.const("dcg-ineligible-text")},U.const("Based on your age and location, we aren\u2019t able to accept a graph submission from you this year.")),U.createElement("div",{class:U.const("dcg-ineligible-text")},U.const("Keep up the awesome graphing! There will be new contests every year."))))))))})))}getABActivityURL(){return"https://teacher.desmos.com/activitybuilder/custom/618be410b284c40a2c7b9111"}getBlogPostURL(){return"https://blog.desmos.com/articles/art-contest-launch-2022/"}returnToOpeningScreen(){this.isVerifyingEligility=!1,this.userOwnsGraph=!1,this.selectedData={email:this.selectedData.email,name:this.selectedData.name},this.update()}getGraphURL(){if(this.overwriteGraphURL)return this.overwriteGraphURL;var e=this.controller.graphsController.currentGraph,t=e&&e.hash||"";return"https://www.desmos.com/calculator/"+t}overwriteEntry(){this.selectedData.overwrite=!0,this.submitEntry()}async checkForExistingSubmission(){if(this.isLoggedIn()){this.isCheckingSubmission=!0,this.currentSubmission=void 0,Qt("art-contest::checking-submission",{});try{let e=await Qz();e.thumbURL?(this.currentSubmission=e,Qt("art-contest::found-submission",{})):e.notFound?Qt("art-contest::found-no-submission",{}):(Qt("art-contest::check-failed",e),be(this.controller.s("account-shell-error-submitting")))}catch(e){be(this.controller.s("account-shell-error-submitting")),Qt("art-contest::check-failed",e)}finally{this.isCheckingSubmission=!1,this.unmounted||this.update()}}}async submitEntry(){if(this.isSubmitButtonDisabled())return;this.didSubmissionFail=!1,this.isSubmittingEntry=!0;let e={name:this.getUserName(),email:this.getUserEmail(),url:this.getGraphURL(),year:this.getSelectedYear(),ageGroup:this.getSelectedAgeGroup(),country:this.getSelectedCountry(),artistStatement:this.getArtistStatement(),overwrite:!0,lang:this.controller.getLanguage()};this.update(),Qt("art-contest::submit-sending",e);try{let t=await Xz(e);t.previousSubmissionURL||(t.success?(this.didSubmissionSucceed=!0,Qt("art-contest::submit-success",{})):(this.didSubmissionFail=!0,Qt("art-contest::submit-failed",{}),be(this.controller.s("account-shell-error-submitting"))))}catch(t){be(this.controller.s("account-shell-error-submitting")),this.didSubmissionFail=!0,Qt("art-contest::submit-failed",{})}finally{this.isSubmittingEntry=!1,this.unmounted||this.update()}}shouldShowSaveAnimation(){return!!this.saveInProgress}shouldShowSaveFailed(){return!!this.didSaveFail}chooseVerifyEligibility(){this.isVerifyingEligility=!0,this.update()}submitANewGraph(){this.currentSubmission=void 0,this.update()}async chooseSubmitThisGraph(){if(!this.shouldDisableSubmitThisGraph()){if(this.isVerifyingEligility=!1,this.overwriteGraphURL||!this.controller.graphsController.hasUnsavedChanges()){this.userOwnsGraph=!0,this.update(),Qt("art-contest::choose-form",{});return}this.saveInProgress=!0,Qt("art-contest::save-sending",{}),this.update();try{let e=await this.controller.graphsController.shareGraph();this.didSaveFail=!1,this.saveInProgress=!1,this.userOwnsGraph=!0,this.overwriteGraphURL="https://www.desmos.com/calculator/"+e.hash,Qt("art-contest::save-success",{url:this.overwriteGraphURL})}catch(e){this.didSaveFail=!0,Qt("art-contest::save-failed",{})}finally{this.saveInProgress=!1,this.unmounted||this.update()}}}isLoggedIn(){return this.controller.isLoggedIn()}getCannotSubmitReason(){return this.isLoggedIn()?this.controller.isGraphComplexEnoughForContest()?"":this.controller.s("account-shell-text-art-contest-notice-default"):this.controller.s("account-shell-text-art-contest-notice-login")}shouldDisableSubmitThisGraph(){return!!this.getCannotSubmitReason()}shouldShowSubmissionOptions(){return this.isVerifyingEligility?!1:!this.userOwnsGraph||!this.isLoggedIn()}shouldShowCountryOptions(){return!this.shouldShowSubmissionOptions()}shouldShowAgeOptions(){return!(!this.shouldShowCountryOptions()||!this.getSelectedCountry())}shouldShowIneligible(){return!this.getSelectedCountry()||!this.getSelectedYear()?!1:!this.isSubmissionEligible()}shouldShowEligible(){return this.isVerifyingEligility?this.isSubmissionEligible():!1}setArtistStatement(e){this.selectedData.artistStatement=e,this.update()}setSelectedYear(e){this.selectedData.year!==e&&(this.selectedData.year=e,this.update(),Qt("art-contest::select-year",{year:e}))}setSelectedCountry(e){this.selectedData={country:e,name:this.controller.userController.name,email:this.controller.userController.email},this.update(),Qt("art-contest::select-country",{country:e})}getArtistStatement(){return this.selectedData.artistStatement||""}getSelectedCountry(){return this.selectedData.country}getSelectedYear(){return this.selectedData.year}getUserAgeInYears(){return 2022-parseFloat(this.selectedData.year||"")}getSelectedAgeGroup(){var e=this.getUserAgeInYears();return e>=19?"19+":e>=17?"17-18":e>=15?"15-16":e>=13?"13-14":""}getUserName(){return this.selectedData.name||""}setUserName(e){this.selectedData.name=e,this.update()}getUserEmail(){return this.selectedData.email||""}setUserEmail(e){this.selectedData.email=e,this.update()}getConsentTicked(){return!!this.selectedData.consent}getOverwriteTicked(){return!!this.selectedData.overwrite}toggleConsent(){this.selectedData.consent=!this.selectedData.consent,this.update(),Qt("art-contest::toggle-consent",{consent:this.selectedData.consent})}isSubmitButtonDisabled(){return!!(this.isSubmittingEntry||!this.selectedData.country||!this.selectedData.year||!this.selectedData.email||!this.selectedData.artistStatement||!this.selectedData.name||!this.selectedData.consent)}isSubmissionEligible(){if(!this.selectedData.country||!this.selectedData.year)return!1;var e=Bie[this.selectedData.country]||16,t=this.getUserAgeInYears();return t>=e}shouldShowConsentOptions(){return this.isVerifyingEligility&&this.getCannotSubmitReason()?!1:this.isSubmissionEligible()}getListOfCountries(){return Nie}getListOfYears(){return u6}};var yc=__dcg_shared_module_exports__['h'](z());var xI=class extends yc.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller}template(){return yc.createElement(ko,{title:()=>this.i18n.s("shared-title-account-reactivated"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},yc.createElement("div",{class:yc.const("dcg-shared-recover-password-dialog dcg-shared-account-dialog")},yc.createElement("div",{class:yc.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-account-reactivated")),yc.createElement("div",{class:yc.const("dcg-shared-modal-actions-container")},yc.createElement("button",{class:()=>({"dcg-btn-blue":!0}),onTap:()=>this.controller.dispatch({type:"close-modal"})},()=>this.i18n.s("shared-button-continue-to-desmos")))))}};var Bi=__dcg_shared_module_exports__['h'](z());yl();var{IfDefined:qie,For:Kie}=Bi.Components,wI={"dcg-actions":{label:"account-shell-label-feature-flag-actions",description:"account-shell-text-feature-flag-actions-description",learnMoreLink:"https://help.desmos.com/hc/en-us/articles/4407725009165"}},vI=class extends Bi.Class{init(){this.formErrors=[]}template(){return Bi.createElement("div",{class:Bi.const("dcg-advanced-settings")},Bi.createElement("div",{class:Bi.const("dcg-shared-account-paragraph")},()=>this.props.controller().s("account-shell-text-advanced-preferences-instructions")),Bi.createElement(Kie,{each:()=>__dcg_shared_module_exports__['M'](wI)},Bi.createElement("div",{class:Bi.const("dcg-feature-flag-list")},e=>Bi.createElement("div",null,Bi.createElement(st,{checked:()=>this.isFeatureFlagEnabled(e),disabled:()=>!!this.updateInFlight,onChange:t=>this.toggleFeatureFlag(e,t)},Bi.createElement("span",{class:Bi.const("dcg-feature-flag-label")},()=>this.label(e))),Bi.createElement("div",{class:Bi.const("dcg-feature-flag-description")},()=>this.description(e),Bi.const(" "),Bi.createElement("a",{href:()=>this.learnMoreLink(e),class:Bi.const("dcg-blue-link"),target:Bi.const("_blank")},()=>this.props.controller().s("graphing-calculator-link-learn-more")))))),Bi.createElement(Qn,{controller:this.props.controller,errors:()=>this.formErrors}),qie(this.bindFn(this.getSaveProgress),e=>Bi.createElement("span",{"aria-live":Bi.const("assertive"),"aria-atomic":Bi.const("true"),class:Bi.const("dcg-shared-confirmation-message")},Bi.createElement("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0,"dcg-saving":e()==="saving"}),"aria-hidden":Bi.const("true")}),()=>e()==="saving"?this.props.controller().s("shared-calculator-label-saving"):this.props.controller().s("shared-message-information-saved"))))}getSaveProgress(){if(this.updateInFlight)return"saving";if(this.showSuccessConfirmation)return"saved"}isFeatureFlagEnabled(e){return this.updateInFlight&&e in this.updateInFlight?this.updateInFlight[e]:this.props.controller().userController.getFeatureFlags().indexOf(e)!==-1}async toggleFeatureFlag(e,t){this.updateInFlight={[e]:t},this.props.controller().dispatch({type:"render"});try{await this.props.controller().userController.updateFeatureFlags({featureFlagsUpdate:this.updateInFlight,lang:this.props.controller().getLanguage()}),this.showSuccessConfirmation=!0,setTimeout(()=>{this.showSuccessConfirmation=!1,this.props.controller().dispatch({type:"render"})},3e3)}catch(i){fn(i),this.formErrors=[this.props.controller().s("account-shell-error-unknown")]}finally{this.updateInFlight=void 0,this.props.controller().dispatch({type:"render"})}}learnMoreLink(e){return wI[e].learnMoreLink}label(e){return this.props.controller().s(wI[e].label)}description(e){return this.props.controller().s(wI[e].description)}};var Fn=__dcg_shared_module_exports__['h'](z());var{IfDefined:zie}=Fn.Components,CI=class extends Fn.Class{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController}template(){return Fn.createElement(ko,{size:this.const("narrow"),onClose:()=>{this.controller.dispatch({type:"close-modal"})},i18n:this.const(this.controller),title:()=>this.controller.s("account-shell-label-delete-graph-modal-title"),class:this.const("dcg-delete-modal")},Fn.createElement("div",{class:Fn.const("dcg-delete-modal-contents")},Fn.createElement("div",{class:Fn.const("dcg-delete-confirmation-message")},this.bindFn(this.getConfirmationMessage)),zie(()=>this.errorMessage,e=>Fn.createElement("div",{class:Fn.const("dcg-error-message")},e)),Fn.createElement("div",{class:Fn.const("dcg-action-buttons")},Fn.createElement("span",{class:Fn.const("dcg-gray-link"),role:Fn.const("button"),tabindex:Fn.const("0"),"aria-label":()=>this.controller.s("account-shell-button-cancel"),onTap:()=>this.controller.dispatch({type:"close-modal"})},()=>this.controller.s("account-shell-button-cancel")),Fn.createElement("div",{class:()=>({"dcg-btn-red dcg-action-delete":!0,"dcg-disabled":!!this.deleteInProgress}),role:Fn.const("button"),tabindex:()=>this.deleteInProgress?-1:0,"aria-label":this.bindFn(this.getButtonText),"aria-disabled":()=>!!this.deleteInProgress,onTap:this.bindFn(this.deleteGraph)},this.bindFn(this.getButtonText)))))}async deleteGraph(){this.deleteInProgress=!0;try{await this.graphsController._deleteGraph(this.graphsController.currentGraph),this.graphsController.clearGraphByUserAction(),this.controller.dispatch({type:"close-modal"})}catch(e){this.deleteInProgress=!1,this.errorMessage=this.controller.s("account-shell-error-deletion-error"),this.controller.dispatch({type:"render"})}}getConfirmationMessage(){return this.controller.s("account-shell-text-delete-graphs-confirmation",{count:this.getGraphCount(),title:this.getTitle()})}getButtonText(){return this.controller.s("account-shell-button-confirm-delete",{count:this.getGraphCount()})}getGraphCount(){return new Vo(1)}getTitle(){return this.graphsController.getCurrentGraphTitle()||this.graphsController.getUntitledString()}};var{If:Uie,SwitchUnion:Hie}=Et.Components,DI=class extends Et.Class{init(){this.controller=this.props.controller()}template(){return Hie("modal",()=>this.controller.getModalState())({save:()=>Et.createElement(Oh,{controller:this.props.controller},Et.createElement(cy,{controller:this.props.controller})),rename:()=>Et.createElement(Oh,{controller:this.props.controller},Et.createElement(cy,{controller:this.props.controller})),duplicate:()=>Et.createElement(Oh,{controller:this.props.controller},Et.createElement(cy,{controller:this.props.controller})),"export-image":()=>Et.createElement(Oh,{controller:this.props.controller},Et.createElement(AC,{controller:this.props.controller})),login:()=>Et.createElement(FT,{controller:this.props.controller}),signup:()=>Et.createElement(_T,{controller:this.props.controller}),"recover-password":()=>Et.createElement(NT,{controller:this.props.controller}),hotkeys:()=>Et.createElement(Oh,{controller:this.props.controller},Et.createElement(qT,{controller:this.props.controller}),Et.const(";")),"unsupported-browser":()=>Et.createElement(Oh,{controller:this.props.controller},Et.createElement(KT,{controller:this.props.controller})),"account-settings":e=>Et.createElement(YT,{controller:this.props.controller,extraTabs:this.bindFn(this.getAccountSettingsExtraTabs),initialTab:()=>e().initialTab}),"change-email":()=>Et.createElement(JT,{controller:this.props.controller}),"account-reenabled":()=>Et.createElement(xI,{controller:this.props.controller}),consent:()=>Et.createElement(bI,{controller:this.props.controller}),"contest-submission":()=>Et.createElement(ko,{title:()=>"",size:this.const("wide"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},Et.createElement(_C,{controller:this.props.controller})),delete:()=>Et.createElement(CI,{controller:this.props.controller}),none:()=>Et.createElement("div",null)})}getAccountSettingsExtraTabs(){return{tabs:[{key:"advanced",wideLabel:()=>this.props.controller().s("account-shell-label-advanced-preferences"),narrowLabel:()=>this.props.controller().s("account-shell-label-advanced-preferences"),class:"advanced"}],createView:e=>e?e=="advanced"?Et.createElement(vI,{controller:this.props.controller}):e:Et.createElement("span",null)}}},Oh=class extends Et.Class{init(){this.controller=this.props.controller()}template(){return Et.createElement("div",{role:Et.const("dialog"),class:()=>({"dcg-modal-container":!0,"dcg-wide-modal":this.controller.getOpenModal()==="hotkeys","dcg-fixed-width-height":this.shouldBeFixedWidthHeight(),"dcg-export-modal":this.controller.getOpenModal()==="export-image"})},Et.createElement("div",{class:Et.const("dcg-modal-background"),onTap:()=>this.controller.dispatch({type:"close-modal"})}),Et.createElement("div",{class:Et.const("modal dcg-state-modals")},Et.createElement(Uie,{predicate:()=>this.controller.getOpenModal()!=="consent"},()=>Et.createElement("span",{role:Et.const("link"),tabindex:Et.const(0),"aria-label":Et.const("Close Dialog"),class:Et.const("action-close-modal close-modal internal-close"),onTap:()=>this.controller.dispatch({type:"close-modal"}),didMount:e=>{if(this.controller.getOpenModal()==="hotkeys")return e.focus()}},Et.createElement("i",{class:Et.const("dcg-icon-remove"),"aria-hidden":Et.const("true")}))),this.children),Et.createElement("span",{role:Et.const("link"),tabindex:Et.const(0),onTap:()=>this.controller.dispatch({type:"close-modal"}),"aria-label":Et.const("Close Dialog"),class:Et.const("action-close-modal close-modal external-close")},Et.createElement("i",{class:Et.const("dcg-icon-remove"),"aria-hidden":Et.const("true")})))}shouldBeFixedWidthHeight(){var e=this.controller.getOpenModal();return e==="export-image"||e==="contest-submission"}};var xc=null,RC=null,FO=!1,NC={},h6=0;function Wie(){window.fetch=function(r,e){let t=new Request(r,e);var i=h6+"";h6+=1;let o=new Promise((n,a)=>{NC[i]={resolve:n,reject:a}});return t.text().then(n=>{xc.methods.proxyXHR(JSON.stringify({id:i,url:t.url,method:t.method,headers:t.headers,body:n}))},()=>{NC[i].reject(new TypeError("Could not decode request body")),delete NC[i]}),o}}function $ie(r){var i;var e=(i=r.target)==null?void 0:i.closest("a[href]");if(e&&e.protocol==="file:"){var t=e.getAttribute("href");t[0]!=="/"&&(t="/"+t),e.setAttribute("href",Gh()+t)}}Iu?(FC=[],SI=[],g6=function(r){var e=SI.length?SI.pop():FC.length;return FC[e]=r,e},m6=function(r){var e=FC[r];return FC[r]=null,SI.push(r),e},xc={loaded:!1,methods:{},queuedMethodCalls:[]},FD(function(){var r=[];window.ObjC_callback=function(t){xc.loaded=!0,t.split(" ").forEach(function(i){xc.methods[i]=function(o,n){var a=n?g6(n):-1;r.push("desmos:"+i+"/"+a+"/"+encodeURIComponent(o)),r.length===1&&e.setAttribute("src",r[0])}}),this.ObjC_callback=function(i,o){try{i!==-1&&m6(i)(o)}finally{r.shift(),r.length>0&&e.setAttribute("src",r[0])}},xc.methods.proxyXHR&&Wie(),xc.queuedMethodCalls.forEach(function(i){BC[i.methodName].apply(BC,i.args)})};var e=document.createElement("iframe");oa(e,{position:"absolute",left:"-1000px",zIndex:"-1"}),e.setAttribute("id","objc-bridge"),e.setAttribute("src","desmos:loaded"),document.body.append(e)})):Vu?RC=window.Android:FO=!0;var FC,SI,g6,m6,jie=["hideLoadingScreen","gaEvent","openGoogleLogin","openAppleLogin","logout","saveCookies","deleteCookies","startSingleAppMode","endSingleAppMode","setWWWSubdomain","sendSerializedAnalyticsEvent","sendStoredLogsToDesmos"],_O=class extends kr{constructor(){super();this.heartbeatTimeout=void 0,this.observeEvent("started resumed",t=>{this.gaEvent(t+":"+this.versionNumber),this.incrementHeartbeat(0)}),document.location.search.indexOf("simulateVersionNumber")!==-1&&(this.versionNumber="?.?.?");for(let t of jie)this[t]=function(){FO||(RC?RC[t]?RC[t].apply(RC,arguments):__dcg_shared_module_exports__['rd'].log("call to missing Android method",t,arguments):xc&&(xc.loaded?xc.methods[t]?xc.methods[t].apply(xc,arguments):__dcg_shared_module_exports__['rd'].log("call to missing ObjC method",t,arguments):xc.queuedMethodCalls.push({methodName:t,args:arguments})))}}heartbeat(t){clearTimeout(this.heartbeatTimeout),this.gaEvent("heartbeat-"+10*t),this.incrementHeartbeat(t)}incrementHeartbeat(t){clearTimeout(this.heartbeatTimeout),this.heartbeatTimeout=setTimeout(()=>{this.heartbeat(t+1)},600*1e3)}_started(t,i){this.appId=t,this.versionNumber=i,this.triggerEvent("started",void 0)}_resumed(){this.triggerEvent("resumed",void 0)}handleAndroidBackButtonAndReturnIfShouldMoveToBackground(){var t=window.Calc&&window.Calc.controller;return t&&t.isKeypadOpen()?(Kr(),"false"):(t=window.MainController,t&&t.handleAndroidBackButton()?"false":"true")}isInApp(){return window.platform&&window.platform!=="www"}onGoogleAuthResult(t){this.triggerEvent("onGoogleAuthResult",t)}onAppleAuthResult(t){this.triggerEvent("onAppleAuthResult",t)}onObjCXHRProxyResult(t){var i=t.id;let{resolve:o,reject:n}=NC[i];delete NC[i],t.status===0?n(new TypeError("Network error")):o(new Response(t.body,{status:t.status,headers:t.headers}))}sendAnalyticsEvent(t,i){this.sendSerializedAnalyticsEvent(JSON.stringify({type:t,payload:i}))}},BC=new _O;FO||(window.AppBridge=BC,document.addEventListener("click",$ie,!0));window.__dcgAppBridgeDefined=!0;var FI=__dcg_shared_module_exports__['h'](z());var ue=__dcg_shared_module_exports__['h'](z());xt();var kt=__dcg_shared_module_exports__['h'](z());xt();var{If:qC}=kt.Components,Dy=class extends kt.Class{template(){return kt.createElement("div",{role:kt.const("listitem"),class:()=>({"saved-graph":!0,"graph-link-container":!0,"dcg-selected":this.props.isSelected()}),onTap:e=>{e.wasHandled()||this.props.onTap(e)}},kt.createElement(qC,{predicate:()=>!this.props.isDeletingGraph()&&!this.props.didDeleteGraphFail()},()=>kt.createElement("div",{role:kt.const("link"),tabindex:kt.const(0),class:()=>({"graph-link":!0,"dcg-action-preview-graph":!0,"example-graph":this.props.isExample()}),didMount:this.bindFn(this.didMount)},kt.createElement("span",{class:kt.const("dcg-thumb"),style:this.const({"background-image":`url(${this.props.getThumbURL()})`})}),kt.createElement("div",{class:kt.const("dcg-graph-details")},kt.createElement("div",{class:kt.const("dcg-title")},this.props.getTitle),kt.createElement("div",{class:kt.const("dcg-subtitle dcg-graph-date")},()=>this.props.isExample()?this.props.s("account-shell-label-mygraphs-example"):this.props.getDisplayDate())))),kt.createElement(qC,{predicate:this.props.isDeletingGraph},()=>kt.createElement("div",{"aria-live":kt.const("assertive"),"aria-atomic":kt.const("true"),class:kt.const("deleting"),handleEvent:kt.const("true"),onTap:()=>{this.props.canCancelDelete()&&this.props.cancelDeleteGraph()}},()=>this.props.s("account-shell-text-mygraphs-deleting"),kt.createElement(qC,{predicate:this.props.canCancelDelete},()=>kt.createElement("div",{role:kt.const("button"),tabindex:kt.const(0),class:kt.const("cancel-delete")},()=>this.props.s("account-shell-button-mygraphs-cancel"))))),kt.createElement(qC,{predicate:this.props.didDeleteGraphFail},()=>kt.createElement("div",{"aria-live":kt.const("assertive"),"aria-atomic":kt.const("true"),class:kt.const("retry-delete"),handleEvent:kt.const("true")},()=>this.props.s("account-shell-error-mygraphs-error-deleting"),kt.createElement("a",{role:kt.const("button"),tabindex:kt.const(0),class:kt.const("dcg-action-removegraph"),onTap:this.props.requestDeleteGraph},()=>this.props.s("account-shell-button-mygraphs-try-again")),()=>this.props.s("account-shell-text-mygraphs-or"),kt.createElement("a",{role:kt.const("button"),tabindex:kt.const(0),class:kt.const("dcg-action-cancelremovegraph"),onTap:this.props.cancelDeleteGraph},()=>this.props.s("account-shell-button-mygraphs-cancel")))),kt.createElement(qC,{predicate:()=>!this.props.isExample()&&!this.props.isDeletingGraph()&&!this.props.didDeleteGraphFail()},()=>kt.createElement("span",{class:kt.const("actions"),handleEvent:kt.const("true")},kt.createElement("span",{role:kt.const("button"),tabindex:kt.const(0),"aria-label":()=>this.props.s("account-shell-button-mygraphs-delete-title",{graphTitle:this.props.getTitle()}),class:kt.const("dcg-action-removegraph"),onTap:this.props.requestDeleteGraph},kt.createElement(Me,{tooltip:()=>this.props.s("account-shell-button-mygraphs-delete-graph"),gravity:this.const("e")},kt.createElement("i",{class:kt.const("dcg-icon-remove"),"aria-hidden":kt.const("true")}))))))}didUpdate(){this.props.isSelected()&&H(this.node).trigger("focus")}didMount(e){this.node=e,H(this.node).on("focus",()=>{this.props.isSelected()||this.props.onFocus()})}};var Pa=__dcg_shared_module_exports__['h'](z());var ri=__dcg_shared_module_exports__['h'](z());var{If:kI,IfElse:Yie}=ri.Components,EI=class extends ri.Class{shouldShowSaveButton(){return!this.props.isSaving()&&!this.props.didSaveRecentlySucceed()&&!this.props.didSaveRecentlyFail()}template(){return ri.createElement("div",{class:ri.const("save-btn-container")},ri.createElement(kI,{predicate:()=>this.shouldShowSaveButton()},()=>ri.createElement("div",{role:ri.const("button"),onTap:this.props.onTap,class:()=>({"dcg-action-save":!0,"dcg-btn-primary":this.props.enabled(),"dcg-disabled":!this.props.enabled()}),"aria-disabled":()=>!this.props.enabled(),tabindex:()=>this.props.enabled()?0:-1},Yie(()=>!this.props.isSyncing()&&this.props.willSaveCopy(),{true:()=>ri.createElement("span",null,()=>this.props.s("account-shell-button-save-copy")),false:()=>ri.createElement("span",null,()=>this.props.s("account-shell-button-mygraphs-save"))}))),ri.createElement(kI,{predicate:this.props.isSaving},()=>ri.createElement("div",{class:ri.const("save-saving")},ri.createElement("span",{class:ri.const("dcg-spinner-dark")}))),ri.createElement(kI,{predicate:this.props.didSaveRecentlyFail},()=>ri.createElement("div",{class:ri.const("save-error"),"aria-live":ri.const("assertive"),"aria-atomic":ri.const("true")},ri.createElement("i",{class:ri.const("dcg-icon-remove"),"aria-hidden":ri.const("true")}),ri.const(" "),()=>this.props.s("account-shell-text-error"))),ri.createElement(kI,{predicate:this.props.didSaveRecentlySucceed},()=>ri.createElement("div",{class:ri.const("save-success")},ri.createElement("i",{class:ri.const("dcg-icon-check"),"aria-hidden":ri.const("true")}),ri.const(" "),()=>this.props.s("account-shell-text-saved"))))}};var GI=class extends Pa.Class{template(){return Pa.createElement("div",{class:Pa.const("graph-link-container graph-in-progress")},Pa.createElement("div",{role:Pa.const("link"),"aria-label":()=>this.props.s("account-shell-button-mygraphs-save"),class:Pa.const("graph-link dcg-action-preview-graph"),onTap:this.props.openSaveDialog},Pa.createElement("span",{class:Pa.const("dcg-thumb"),style:()=>({"background-image":`url(${this.props.getThumbnail()})`})}),Pa.createElement("div",{class:Pa.const("dcg-graph-details")},Pa.createElement("div",{class:Pa.const("dcg-title")},this.props.getTitle),Pa.createElement("div",{class:Pa.const("dcg-subtitle dcg-save-status")},()=>this.props.isSaveEnabled()?this.props.wasCurrentGraphEverSaved()?this.props.s("account-shell-label-mygraphs-last-saved",{date:this.props.getDisplayDate()}):this.props.s("account-shell-label-mygraphs-unsaved-graph"):this.props.s("account-shell-label-mygraphs-no-unsaved-changes"))),Pa.createElement(EI,{enabled:this.props.isSaveEnabled,isSaving:this.props.isSaving,didSaveRecentlySucceed:this.props.didSaveRecentlySucceed,didSaveRecentlyFail:this.props.didSaveRecentlyFail,isSyncing:this.props.isSyncing,willSaveCopy:this.props.willSaveCopy,onTap:()=>{},s:this.props.s})))}shouldUpdate(){return this.props.isOpen()}};var jt=__dcg_shared_module_exports__['h'](z());xt();var{Input:Jie,If:TI}=jt.Components,f6=4,II=class extends jt.Class{willUpdate(){this.props.isSearching()||this.setSearchValue("")}setSearchValue(e){this.searchValue!==e&&(this.searchValue=e,this.props.updateFilter(e))}init(){this.controller=this.props.controller(),this.searchValue=""}template(){return jt.createElement("div",{class:jt.const("dcg-user-bar")},jt.createElement(TI,{predicate:()=>!this.props.isSearching()},()=>jt.createElement("div",{class:jt.const("dcg-account-link-container")},jt.createElement("div",{class:jt.const("dcg-account-link"),"dcg-menu-button":jt.const("account"),role:jt.const("button"),tabindex:jt.const(0),"aria-haspopup":jt.const("true"),"aria-expanded":()=>this.controller.getOpenMenu()==="account","aria-label":jt.const("Account Information"),onTap:e=>{var t;if(this.measureAccountDropdownArrowOffset(),this.props.controller().dispatch({type:"toggle-menu",payload:"account"}),e.device=="keyboard"){let o=this.props.controller().getOpenMenu()==="account"?".dcg-action-accountsettings":".dcg-account-link";(t=document.querySelector(o))==null||t.focus()}}},jt.createElement("span",{class:jt.const("dcg-variable-name")},()=>this.controller.userController.getFirstName()),jt.createElement("i",{class:jt.const("dcg-icon-caret-down"),"aria-hidden":jt.const("true")})),jt.createElement(TI,{predicate:()=>this.controller.getOpenMenu()==="account"&&this.controller.mygraphsController.isMygraphsOpen()},()=>jt.createElement(sy,{controller:this.const(this.controller),left:()=>`${f6}px`,arrowLeft:()=>`${this.accountDropdownArrowOffset-f6}px`})))),jt.createElement(TI,{predicate:()=>!this.props.isSearching()},()=>jt.createElement("div",{role:jt.const("link"),tabindex:jt.const("0"),class:jt.const("dcg-search-btn"),onTap:e=>{var t;e.preventDefault(),this.props.openSearch(),(t=document.querySelector(".search-container input"))==null||t.focus()}},jt.createElement("i",{class:jt.const("dcg-icon-search search-icon"),"aria-hidden":jt.const("true")}),jt.createElement("span",{class:jt.const("dcg-menu-title")},()=>this.props.s("account-shell-heading-title-mygraphs-search")))),jt.createElement(TI,{predicate:()=>this.props.isSearching()},()=>jt.createElement("div",{role:jt.const("search"),class:jt.const("search-container search-open")},jt.createElement("i",{class:jt.const("dcg-icon-search search-icon"),"aria-hidden":jt.const("true")}),jt.createElement(Jie,{placeholder:()=>this.props.s("account-shell-text-mygraphs-search-by-title"),onInput:this.bindFn(this.setSearchValue),onFocus:this.props.openSearch,value:()=>this.searchValue,didMount:this.bindFn(this.didMountSearch)}),jt.createElement("span",{role:jt.const("button"),tabindex:jt.const(0),"aria-label":()=>this.props.s("account-shell-heading-title-mygraphs-search"),class:jt.const("dcg-icon-remove dcg-action-close-search"),onTap:e=>{e.preventDefault(),this.props.closeSearch()}}))))}didMountSearch(e){H(e).on("blur",()=>{e.value||this.props.closeSearch()})}measureAccountDropdownArrowOffset(){var a,s;let e=this.findRootNode().querySelector(".dcg-account-link i"),t=e&&ao(e),i=(a=t==null?void 0:t.left)!=null?a:0,o=(s=e==null?void 0:e.getBoundingClientRect().width)!=null?s:0,n=i+o/2;this.accountDropdownArrowOffset=n}};var di=__dcg_shared_module_exports__['h'](z());var Vr=__dcg_shared_module_exports__['h'](z());var{If:VI}=Vr.Components,Ph=class extends Vr.Class{template(){return Vr.createElement("div",{class:Vr.const("dcg-loading-container")},Vr.createElement(VI,{predicate:()=>!this.props.didDataLoadFail()},()=>Vr.createElement("div",{class:Vr.const("dcg-graph-loading")},Vr.createElement("div",{class:Vr.const("pulsing-message")},()=>this.props.s("account-shell-text-mygraphs-loading")),Vr.createElement("div",{role:Vr.const("link"),tabindex:Vr.const("0"),class:Vr.const("dcg-cancel-while-loading"),onTap:this.props.onCancel},()=>this.props.s("account-shell-button-mygraphs-cancel")))),Vr.createElement(VI,{predicate:()=>this.props.didDataLoadFail()},()=>Vr.createElement("div",{class:Vr.const("dcg-graph-loading-error"),"aria-live":Vr.const("assertive"),"aria-atomic":Vr.const("true")},Vr.createElement("div",{class:Vr.const("dcg-graph-loading-error-title")},()=>this.props.s("account-shell-error-mygraphs-error-loading")),Vr.createElement("div",{class:Vr.const("dcg-graph-loading-error-subtitle")},()=>this.props.s("account-shell-error-mygraphs-check-connection")),Vr.createElement("div",{class:Vr.const("dcg-graph-loading-error-options")},Vr.createElement("span",{role:Vr.const("button"),tabindex:Vr.const("0"),class:Vr.const("dcg-action-try-again dcg-btn-blue dcg-btn-medium"),onTap:this.props.requestLoadGraphData},()=>this.props.s("account-shell-button-mygraphs-try-again")),Vr.createElement(VI,{predicate:()=>!!this.props.onCancel},()=>Vr.createElement("span",null,()=>this.props.s("account-shell-text-mygraphs-or"))),Vr.createElement(VI,{predicate:()=>!!this.props.onCancel},()=>Vr.createElement("span",{role:Vr.const("button"),tabindex:Vr.const("0"),class:Vr.const("dcg-action-cancel dcg-btn-light-gray dcg-btn-medium"),onTap:this.props.onCancel},()=>this.props.s("account-shell-button-mygraphs-cancel")))))))}};var{If:Xie}=di.Components,MI=class extends di.Class{didMountGraphPreview(e){return this.graphPreview=e,this.updateGraphPreviewTop()}didMountArrow(e){return this.arrow=e,this.updateArrowTop()}didMountCalc(e){return this.previewCalc=this.props.makeAPI(e),this.updatePreviewCalc()}willUnmountCalc(){this.previewCalc&&this.previewCalc.destroy&&this.previewCalc.destroy()}didUpdate(){return this.updateGraphPreviewTop(),this.updateArrowTop(),this.updatePreviewCalc()}updateGraphPreviewTop(){this.graphPreview.style.top=this.getTopOffset()+"px"}updateArrowTop(){this.arrow.style.top=this.getArrowOffset()+"px"}updatePreviewCalc(){let e=this.props.getGraphData();e!==this.cachedGraphData&&(this.cachedGraphData=e,this.previewCalc.setState(e),this.previewCalc.resize())}getMaxTop(){return window.innerHeight-this.graphPreview.offsetHeight-10}getIdealTop(){let e=this.props.alignToNode();return e==null?null:ao(e).top+.5*e.offsetHeight-60}getTopOffset(){let e=this.getIdealTop();if(e==null)return 0;let t=this.getMaxTop();return Math.min(e,t)}getArrowOffset(){let e=this.getIdealTop();if(e==null)return 60;let t=this.getTopOffset();return 60+e-t}template(){return di.createElement("div",{class:di.const("graph-preview"),didMount:this.bindFn(this.didMountGraphPreview)},di.createElement("div",{class:di.const("dcg-graph-preview-info")},di.createElement("h4",{class:di.const("dcg-title")},this.props.getTitle),di.createElement("span",{role:di.const("button"),tabindex:di.const("0"),class:di.const("dcg-action-cancel"),onTap:this.props.onCancel},di.createElement("i",{class:di.const("dcg-icon-remove"),"aria-hidden":di.const("true")}))),di.createElement("div",{class:di.const("preview-graph-area")},di.createElement(Xie,{predicate:()=>!this.props.getGraphData()},()=>di.createElement(Ph,{didDataLoadFail:this.props.didDataLoadFail,onCancel:this.props.onCancel,requestLoadGraphData:this.props.requestLoadGraphData,s:this.props.s.bind(this.props)})),di.createElement("div",{didMount:this.bindFn(this.didMountCalc),willUnmount:this.bindFn(this.willUnmountCalc),class:()=>({"dcg-preview-calculator":!0,"dcg-visible":this.props.getGraphData()})}),di.createElement("div",{class:()=>({"screenshot-clickjack":!0,"dcg-action-open-graph":!0,"dcg-visible":this.props.getGraphData()})},di.createElement("span",{role:di.const("button"),tabindex:di.const("0"),class:di.const("dcg-action-open-graph dcg-open-graph-btn dcg-btn-primary"),onTap:this.props.onOpenGraph},this.props.getOpenText))),di.createElement("div",{class:di.const("active-arrow"),didMount:this.bindFn(this.didMountArrow)},di.createElement("div",{class:di.const("dcg-graphic")})))}};var kn=__dcg_shared_module_exports__['h'](z());var{If:RO}=kn.Components,AI=class extends kn.Class{template(){return kn.createElement("div",{class:()=>({"syncing-status-bar":!0,visible:this.props.isSyncingGraphs()||this.props.didSyncFail()})},kn.createElement(RO,{predicate:this.props.isSyncingGraphs},()=>kn.createElement("div",{class:kn.const("syncing-status-text")},kn.createElement("span",{class:kn.const("dcg-pulse")},()=>this.props.s("account-shell-text-mygraphs-updating-graphs")))),kn.createElement(RO,{predicate:()=>!this.props.isSyncingGraphs()&&!this.props.didSyncFail()},()=>kn.createElement("div",{class:kn.const("success-status-text")},kn.createElement("i",{class:kn.const("dcg-icon-check"),"aria-hidden":kn.const("true")}),kn.const(" "),()=>this.props.s("account-shell-text-mygraphs-synced"))),kn.createElement(RO,{predicate:this.props.didSyncFail},()=>kn.createElement("div",{class:kn.const("error-status-text"),onTap:this.props.requestSyncGraphs},()=>this.props.s("account-shell-button-mygraphs-offline-try-again"))))}};var ja=__dcg_shared_module_exports__['h'](z());var LI=class extends ja.Class{init(){this.controller=this.props.controller()}template(){return ja.createElement("div",{class:ja.const("dcg-account-reminder")},ja.createElement("span",{class:ja.const("dcg-login")},ja.createElement("a",{role:ja.const("link"),tabindex:ja.const(0),class:ja.const("dcg-sign-in dcg-action-login dcg-btn-white-outline"),onTap:this.props.onSignIn},()=>this.props.controller().s("account-shell-button-log-in")),()=>this.props.controller().s("account-shell-text-or"),ja.createElement("a",{role:ja.const("link"),tabindex:ja.const(0),class:ja.const("dcg-create-account dcg-btn dcg-btn-primary dcg-tool-color dcg-action-createaccount"),onTap:this.props.onCreateAccount},()=>this.props.controller().s("account-shell-button-sign-up"))),ja.createElement("div",null,()=>this.getToSaveYourText()))}getToSaveYourText(){return this.controller.product==="graphing"?this.controller.s("account-shell-text-mygraphs-to-save-graphs"):this.controller.product==="geometry"?this.controller.s("account-shell-text-mygraphs-to-save-constructions"):""}};var cp=__dcg_shared_module_exports__['h'](z()),um=class extends cp.Class{template(){return cp.createElement("div",{class:cp.const("dcg-mygraphs-section-title-container")},cp.createElement("span",{role:cp.const("heading"),"aria-level":cp.const("1"),class:cp.const("dcg-mygraphs-section-title")},()=>this.props.title()))}};var{If:wa,For:NO,IfElse:b6}=ue.Components,OI="default",_h="search",Qie=50,PI=class extends ue.Class{constructor(){super(...arguments),this.state="default"}didUpdate(){if(this.previewGraph){let e=this.getSelectedNode();e&&kl(e,this.scrollableNode,60)&&this.update()}}didMountScrollable(e){this.scrollableNode=e,H(this.scrollableNode).on("focusin",i=>{if(this.previewGraph&&!i.target.classList.contains("graph-link"))return this.previewItem(void 0)}),H(window).on("keydown",i=>{if(!this.props.isOpen())return!0;switch(Ee(i)){case gn:return this.selectUp(i);case mn:return this.selectDown(i)}});let t=__dcg_shared_module_exports__['K'](this.hidePreviewIfTooScrolled.bind(this),200);H(this.scrollableNode).on("scroll",t),this.debouncedFetchSelectedGraph=__dcg_shared_module_exports__['L'](this.fetchSelectedGraph.bind(this),200)}fetchSelectedGraph(){return this.props.graphsController().loadDataForGraph(this.previewGraph)}hidePreviewIfTooScrolled(){if(!this.previewGraph)return;let e=this.getSelectedNode();if(!e)return;let t=this.findRootNode().querySelector(".active-arrow")||void 0,i=ao(e),o=e.getBoundingClientRect().height,n=ao(t);if(i===void 0||o===void 0||n===void 0)return;let a=i.top+.5*o,s=n.top;Math.abs(a-s)>10&&this.previewItem(void 0)}openSearch(){this.state=_h,this.previewItem(void 0)}closeSearch(){this.state=OI,this.previewItem(void 0)}updateFilter(e){this.filter=e,this.update()}getMaxGraphs(){return this.maxGraphs||Qie}getCountRemaining(){return this.getSavedGraphs().length-this.getMaxGraphs()}showMoreGraphs(e){let t=this.getMaxGraphs();if(this.getCountRemaining()<2*t?this.maxGraphs=1/0:this.maxGraphs=2*t,this.update(),(e!=null?e.device:void 0)==="keyboard"){let i=this.getSavedAndExampleGraphs(),o=i?i[t]:void 0;o&&this.previewItem(o)}}getSelectedNode(){return document.querySelector(".dcg-mygraphs .graph-link-container.dcg-selected")}selectUp(e){if(!this.previewGraph)return;e.preventDefault();let t=this.getSavedAndExampleGraphs();if(!t.length)return;let i=this.previewGraph?this.previewGraph.hash:void 0,o=__dcg_shared_module_exports__['I'](__dcg_shared_module_exports__['x'](t,"hash"),i),n=t?t[o-1]:void 0;n?n&&this.previewItem(n):this.newGraph&&H(this.newGraph).trigger("focus")}selectDown(e){if(!this.previewGraph)return;let t=this.getSavedAndExampleGraphs();if(!t.length)return;e.preventDefault();let i=this.previewGraph?this.previewGraph.hash:void 0,o=__dcg_shared_module_exports__['I'](__dcg_shared_module_exports__['x'](t,"hash"),i),n=t?t[o+1]:void 0;n&&(!n.example&&o+1>=this.getMaxGraphs()&&this.showMoreGraphs(),this.previewItem(n))}getFilter(){return this.state===_h&&this.filter?this.filter:""}getRecoveryGraphs(){return this.props.graphsController().getRecoveryGraphs()}attemptRecovery(){this.logRecoveryClientEvent("ask"),this.controller.mygraphsController.recoveryAttempted=!0,this.controller.graphsController.fetchRecoveryGraphs(),this.update()}hasAttemptedRecovery(){return this.controller.mygraphsController.hasAttemptedRecovery()&&!this.isAttemptingRecovery()}isAttemptingRecovery(){return this.controller.graphsController.isLoadingRecoveryGraphs}shouldShowAttemptRecoveryText(){return this.graphsController.isRecoveryUIEnabledForProduct()?!this.hasAttemptedRecovery():!1}getSavedGraphs(){return this.props.graphsController().getSavedGraphs()}getExampleGraphs(){return this.props.graphsController().getExampleGraphs()}getSavedAndExampleGraphs(){return this.props.graphsController().getSavedAndExampleGraphs()}filterGraphs(e){let t=this.getFilter().toLowerCase();return t?e.filter(i=>this.sanitizeTitle(i).toLowerCase().indexOf(t)>=0):e}sliceGraphs(e){return e.slice(0,this.getMaxGraphs())}canShowMore(e){return e.length>this.getMaxGraphs()}onFocusGraph(e){this.skipPreview()||this.previewItem(e)}onTapGraph(e,t){this.skipPreview()||t.device==="keyboard"?this.openGraphWithCover(e):this.previewGraph!==e&&this.previewItem(e)}previewItem(e){this.previewGraph&&(this.previewGraph=void 0),e&&(this.previewGraph=e,this.debouncedFetchSelectedGraph()),this.update()}skipPreview(){let e=window.platform;return document.body.getBoundingClientRect().width<650||e==="ios"||e==="android"}onOpenPreviewGraph(){if(!this.previewGraph)return;let{previewGraph:e}=this;this.previewItem(void 0),this.props.onOpenGraph(e)}openGraphWithCover(e){if(this.graphWithCover=e,this.previewItem(void 0),e!==void 0)return setTimeout(async()=>{try{if(await this.props.graphsController().loadGraphImmediately(e),!this.graphWithCover)return;this.props.openGraphBehindCover(e).then(()=>{this.graphWithCover=void 0,this.update()})}catch(t){}this.update()},250)}cancelLoadGraphWithCover(){this.graphWithCover=void 0,this.update()}didDataLoadFail(e){return e?this.props.graphsController().didDataLoadFail(e):!1}willUpdate(){(!this.props.isOpen()||!this.controller.userController.isLoggedIn())&&(this.state=OI)}didMountNewGraph(e){return this.newGraph=e,H(this.newGraph).on("keydown",t=>{if(Ee(t)!==mn)return;let i=this.getSavedAndExampleGraphs();return this.previewItem(i[0]),t.preventDefault(),t.stopPropagation()})}sanitizeTitle(e){return e.i18nKey?this.controller.s(e.i18nKey):e.title||this.graphsController.getUntitledString()}init(){this.state=OI,this.controller=this.props.controller(),this.graphsController=this.controller.graphsController}template(){return ue.createElement("div",{class:()=>({"dcg-mygraphs":!0,"logged-in":this.controller.userController.isLoggedIn(),"preview-mode":!!this.props.previewMode(),"maintenance-mode":!!this.props.maintenanceMode()})},ue.createElement("div",{class:ue.const("dcg-resources-container")},ue.createElement(wa,{predicate:()=>this.props.accountsEnabled()&&!this.controller.userController.isLoggedIn()&&!this.props.previewMode()&&!this.props.maintenanceMode()},()=>ue.createElement(LI,{onCreateAccount:this.props.onCreateAccount,onSignIn:this.props.onSignIn,controller:this.props.controller})),ue.createElement(wa,{predicate:()=>this.controller.userController.isLoggedIn()},()=>ue.createElement("div",null,ue.createElement(wa,{predicate:()=>this.controller.userController.isLoggedIn()&&this.state===OI},()=>ue.createElement(AI,{isSyncingGraphs:()=>this.props.graphsController().isSyncing(),didSyncFail:()=>this.props.graphsController().didSyncFail(),requestSyncGraphs:this.props.refreshGraphs,s:this.controller.s})),ue.createElement(II,{controller:this.props.controller,openSearch:this.bindFn(this.openSearch),closeSearch:this.bindFn(this.closeSearch),updateFilter:this.bindFn(this.updateFilter),isSearching:()=>this.state===_h,s:this.controller.s}))),ue.createElement("div",{class:ue.const("dcg-scrollable"),didMount:this.bindFn(this.didMountScrollable)},ue.createElement("div",{class:ue.const("dcg-scrollable-interior")},ue.createElement(wa,{predicate:this.props.maintenanceMode},()=>ue.createElement("div",{class:ue.const("maintenance-mode")},()=>this.controller.s("account-shell-text-mygraphs-maintenance-mode"))),ue.createElement(wa,{predicate:this.props.previewMode},()=>ue.createElement("div",{class:ue.const("maintenance-mode")},()=>{var e;return(e=this.props.previewMode())==null?void 0:e.message},ue.createElement("br",null),ue.createElement("a",{tabindex:ue.const("0"),class:ue.const("dcg-btn-primary"),href:()=>{var e;return(e=this.props.previewMode())==null?void 0:e.url},target:ue.const("_blank")},()=>this.controller.s("account-shell-text-mygraphs-share-thoughts")))),ue.createElement(wa,{predicate:()=>this.state!==_h&&this.controller.shouldShowArtContestNudge()},()=>ue.createElement("div",{onTap:e=>{this.controller.dispatch({type:"show-modal",modal:"contest-submission",device:e.device})},class:ue.const("dcg-sidebar-contest-submit")},ue.createElement("span",{class:ue.const("dcg-trophy-icon")},ue.const("\u{1F3C6}")),ue.createElement(si,{i18n:this.const(this.controller),key:this.const("account-shell-text-mygraphs-submit-to-contest")},ue.createElement("span",{class:ue.const("dcg-contest-submit-message")},ue.const("Submit this graph to the"),ue.const(" "),ue.createElement("span",{class:ue.const("dcg-bold-text")},ue.const("Global Math Art Contest!")))))),ue.createElement(wa,{predicate:()=>this.state!==_h},()=>ue.createElement("div",{role:ue.const("link"),tabindex:ue.const("0"),class:ue.const("new-blank-graph dcg-action-newblankgraph"),onTap:()=>(this.previewItem(void 0),this.props.openBlankGraph()),didMount:this.bindFn(this.didMountNewGraph)},ue.createElement("div",{class:ue.const("new-blank-graph-inner")},ue.createElement("span",{class:ue.const("dcg-add-blank")},ue.createElement("i",{class:ue.const("dcg-icon-plus"),"aria-hidden":ue.const("true")})),ue.createElement("span",{class:ue.const("dcg-new-graph-title")},()=>this.props.controller().getProduct()==="geometry"?this.controller.s("account-shell-text-mygraphs-new-construction"):this.controller.s("account-shell-text-mygraphs-new-blank-graph"))))),ue.createElement(wa,{predicate:()=>!this.props.maintenanceMode()&&!this.props.previewMode()&&this.controller.userController.isLoggedIn()&&this.state!==_h},()=>ue.createElement("div",null,ue.createElement(um,{title:()=>this.props.controller().getProduct()==="geometry"?this.controller.s("account-shell-text-mygraphs-current-construction"):this.controller.s("account-shell-text-mygraphs-current-graph")}),ue.createElement(GI,{getTitle:()=>this.getPreviewTitle(),getDisplayDate:()=>this.controller.unpack(this.props.graphsController().getCurrentDisplayDate()),isOpen:this.props.isOpen,getThumbnail:this.props.getThumbnail,isSaveEnabled:this.props.isSaveEnabled,simpleSave:()=>(this.props.simpleSave(),this.previewItem(void 0)),openSaveDialog:()=>(this.props.openSaveDialog(),this.previewItem(void 0)),wasCurrentGraphEverSaved:()=>this.props.graphsController().wasCurrentGraphEverSaved(),isSaving:()=>this.props.graphsController().isSaving(),didSaveRecentlySucceed:()=>this.props.graphsController().didSaveSucceed(),didSaveRecentlyFail:()=>this.props.graphsController().didSaveFail(),isSyncing:()=>this.props.graphsController().isSyncing(),willSaveCopy:()=>this.props.graphsController().willSaveCopy(),s:this.controller.s}),ue.createElement(wa,{predicate:this.bindFn(this.shouldShowAttemptRecoveryText)},()=>ue.createElement("div",{class:ue.const("dcg-lost-work-link")},b6(()=>this.isAttemptingRecovery(),{true:()=>ue.createElement("span",null,ue.createElement("span",null,()=>this.controller.s("account-shell-text-mygraphs-attempting-recovery")),ue.createElement("span",{class:ue.const("dcg-spinner-dark")})),false:()=>ue.createElement("span",null,ue.createElement("span",null,()=>this.controller.s("account-shell-text-mygraphs-lost-work")+" "),ue.createElement("span",{tabIndex:ue.const("0"),role:ue.const("link"),class:ue.const("dcg-attempt-recovery"),onTap:this.bindFn(this.attemptRecovery)},()=>this.controller.s("account-shell-button-mygraphs-attempt-recovery")))}))))),ue.createElement(wa,{predicate:()=>!this.props.maintenanceMode()&&!this.props.previewMode()&&this.controller.userController.isLoggedIn()&&this.hasAttemptedRecovery()&&this.state!==_h},()=>ue.createElement("div",null,b6(()=>this.getRecoveryGraphs().length>0,{true:()=>ue.createElement("div",{class:ue.const("dcg-recovery-graphs-list")},ue.createElement(um,{title:()=>this.controller.s("account-shell-heading-mygraphs-recovered-work")}),ue.createElement(NO,{each:()=>this.getRecoveryGraphs(),key:e=>e.getCollectionKey()},ue.createElement("div",{role:ue.const("list")},e=>ue.createElement(Dy,{onTap:t=>this.onTapGraph(e,t),onFocus:()=>this.onFocusGraph(e),cancelDeleteGraph:()=>this.props.graphsController().cancelDeleteGraph(e),requestDeleteGraph:()=>(this.logRecoveryClientEvent("delete"),this.previewItem(void 0),this.props.graphsController().requestDeleteGraph(e)),isDeletingGraph:()=>this.props.graphsController().isDeletingGraph(e),canCancelDelete:()=>this.props.graphsController().canCancelDelete(e),didDeleteGraphFail:()=>this.props.graphsController().didDeleteGraphFail(e),isSelected:()=>e===this.previewGraph,isExample:ue.const(!1),getDisplayDate:()=>this.controller.unpack(e.displayDate()),getTitle:()=>this.sanitizeTitle(e),getThumbURL:()=>e.thumbURL,s:this.controller.s})))),false:()=>ue.createElement("div",{class:ue.const("dcg-no-recovery-graphs")},()=>this.controller.s("account-shell-text-mygraphs-no-unsaved-graphs"))}))),ue.createElement(wa,{predicate:()=>this.controller.userController.isLoggedIn()},()=>ue.createElement(um,{title:()=>this.props.controller().getProduct()==="geometry"?this.controller.s("account-shell-heading-mygraphs-saved-constructions"):this.controller.s("account-shell-heading-mygraphs-saved-graphs")})),ue.createElement(NO,{each:()=>this.sliceGraphs(this.filterGraphs(this.getSavedGraphs())),key:e=>e.getCollectionKey()},ue.createElement("div",{class:ue.const("dcg-saved-graphs-list"),role:ue.const("list")},e=>ue.createElement(Dy,{onTap:t=>this.onTapGraph(e,t),onFocus:()=>this.onFocusGraph(e),cancelDeleteGraph:()=>this.props.graphsController().cancelDeleteGraph(e),requestDeleteGraph:()=>(this.previewItem(void 0),this.props.graphsController().requestDeleteGraph(e)),isDeletingGraph:()=>this.props.graphsController().isDeletingGraph(e),canCancelDelete:()=>this.props.graphsController().canCancelDelete(e),didDeleteGraphFail:()=>this.props.graphsController().didDeleteGraphFail(e),isSelected:()=>e===this.previewGraph,isExample:ue.const(!1),getDisplayDate:()=>this.controller.unpack(e.displayDate()),getTitle:()=>this.sanitizeTitle(e),getThumbURL:()=>e.thumbURL,s:this.controller.s}))),ue.createElement(wa,{predicate:()=>this.controller.userController.isLoggedIn()&&this.filterGraphs(this.getSavedGraphs()).length===0},()=>ue.createElement("div",{"aria-live":ue.const("assertive"),"aria-atomic":ue.const("true"),class:ue.const("no-matches")},()=>this.state===_h?this.controller.s("account-shell-text-mygraphs-no-search-results"):this.controller.s("account-shell-text-mygraphs-no-saved-graphs"))),ue.createElement(wa,{predicate:()=>this.canShowMore(this.filterGraphs(this.getSavedGraphs()))},()=>ue.createElement("div",{class:ue.const("dcg-show-more-graphs"),onTap:this.bindFn(this.showMoreGraphs),role:ue.const("button"),tabindex:ue.const("0")},()=>this.controller.s("account-shell-text-mygraphs-count-more",{count:this.getCountRemaining()}))),ue.createElement(wa,{predicate:()=>this.getExampleGraphs().length>0},()=>ue.createElement(um,{title:()=>this.controller.s("account-shell-heading-mygraphs-examples")})),ue.createElement(NO,{each:()=>this.filterGraphs(this.getExampleGraphs()),key:e=>e.getCollectionKey()},ue.createElement("div",{role:ue.const("list")},e=>ue.createElement(Dy,{onTap:t=>this.onTapGraph(e,t),onFocus:()=>this.onFocusGraph(e),cancelDeleteGraph:()=>{},requestDeleteGraph:()=>{},isDeletingGraph:ue.const(!1),didDeleteGraphFail:ue.const(!1),canCancelDelete:ue.const(!1),isSelected:()=>e===this.previewGraph,isExample:ue.const(!0),getDisplayDate:()=>this.controller.unpack(e.displayDate()),getTitle:()=>this.sanitizeTitle(e),getThumbURL:()=>e.thumbURL,s:this.controller.s}))),ue.createElement(wa,{predicate:()=>this.getFilter()?this.filterGraphs(this.getExampleGraphs()).length===0:!1},()=>ue.createElement("div",{"aria-live":ue.const("assertive"),"aria-atomic":ue.const("true"),class:ue.const("no-matches")},()=>this.controller.s("account-shell-text-mygraphs-no-examples-match-search"))),ue.createElement("div",{class:ue.const("dcg-mygraphs-legal")},ue.createElement("a",{href:ue.const("/terms"),target:ue.const("_blank")},()=>this.controller.s("account-shell-link-terms")),ue.const("|"),ue.createElement("a",{href:ue.const("/privacy"),target:ue.const("_blank")},()=>this.controller.s("account-shell-link-privacy")),ue.createElement(wa,{predicate:()=>!!this.props.versionNumber()},()=>ue.createElement("div",{class:ue.const("dcg-version")},()=>this.controller.s("account-shell-text-mygraphs-version"),ue.const(" "),this.props.versionNumber))))),ue.createElement(wa,{predicate:()=>!!this.previewGraph},()=>ue.createElement(MI,{alignToNode:()=>this.getSelectedNode(),getTitle:()=>this.previewGraph?this.sanitizeTitle(this.previewGraph):"",getGraphData:()=>this.previewGraph?this.previewGraph.graphData:void 0,onCancel:()=>this.previewItem(void 0),didDataLoadFail:()=>this.didDataLoadFail(this.previewGraph),requestLoadGraphData:this.bindFn(this.fetchSelectedGraph),onOpenGraph:this.bindFn(this.onOpenPreviewGraph),s:this.controller.s,makeAPI:this.props.makeAPI,getOpenText:()=>this.controller.getOpenText()}))),ue.createElement(wa,{predicate:this.props.isOpen},()=>ue.createElement("div",{role:ue.const("link"),tabindex:ue.const("0"),class:ue.const("dcg-resources-cover dcg-action-close-resources"),style:()=>({opacity:this.previewGraph?.6:0}),onTap:()=>this.previewGraph?this.previewItem(void 0):this.props.closeDrawer(),"aria-label":()=>this.previewGraph?this.controller.s("account-shell-button-mygraphs-close-graph-preview"):this.controller.s("account-shell-button-mygraphs-close-graph-list")})),ue.createElement(wa,{predicate:()=>!!this.graphWithCover},()=>ue.createElement("div",{class:ue.const("dcg-fullscreen-loading-container")},ue.createElement(Ph,{didDataLoadFail:()=>this.didDataLoadFail(this.graphWithCover),onCancel:this.bindFn(this.cancelLoadGraphWithCover),requestLoadGraphData:()=>this.openGraphWithCover(this.graphWithCover),s:this.controller.s}))))}getPreviewTitle(){return this.graphsController.getCurrentGraphTitle()||this.graphsController.getUntitledString()}logRecoveryClientEvent(e){Qt("recovered-graph",{product:this.controller.graphsController.product,timeSincePageload:Date.now()-this.controller.mygraphsController.pageLoadTime,payloadJSON:{action:e}})}};var _I=class extends FI.Class{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController,this.mygraphsController=this.controller.mygraphsController}template(){return FI.createElement(PI,{isOpen:()=>this.mygraphsController.isMygraphsOpen(),graphsController:()=>this.graphsController,maintenanceMode:()=>this.controller.isInMaintenanceMode(),previewMode:()=>this.controller.getPreviewParams(),accountsEnabled:this.const(!0),controller:()=>this.controller,closeDrawer:()=>this.controller.dispatch({type:"close-mygraphs"}),openBlankGraph:()=>this.mygraphsController.openBlankGraph(),onOpenGraph:e=>this.mygraphsController.onOpenGraph(e),openGraphBehindCover:e=>this.mygraphsController.openGraphBehindCover(e),onLogout:()=>this.controller.userController.logout(),onEditAccount:()=>this.controller.dispatch({type:"show-modal",modal:"account-settings",device:"mouse"}),onCreateAccount:()=>this.controller.dispatch({type:"show-modal",modal:"signup",device:"mouse"}),onSignIn:()=>this.controller.dispatch({type:"show-modal",modal:"login",device:"mouse"}),refreshGraphs:()=>this.graphsController.refreshGraphs(),getThumbnail:()=>this.mygraphsController.getThumbnail(),simpleSave:()=>this.controller.simpleSave(),openSaveDialog:()=>this.controller.openSaveDialog({fromSaveInProgress:!0}),versionNumber:()=>BC.versionNumber,isSaveEnabled:()=>this.controller.isSaveEnabled(),makeAPI:this.props.makeAPI})}};yl();ig();var RI=class extends kr{constructor(){super();this.loggedIn=!1;this.logoutFailed=!1;this.loggingOut=!1;this.consentingToPrivacy=!1;this.privacyConsentFailed=!1;this.userId="";this.name="";this.email="";this.teacher=!1;this.featureFlags=[];this.verificationStatus="";this.subscriptions=[];this.privacyConsent=null;Oz(()=>this.logout())}desmosLogin(t){return Fz(t).then(this.completeLogin.bind(this))}googleLogin(t){this.triggerEvent("googleLogin",t)}appleLogin(t){this.triggerEvent("appleLogin",t)}askServerIfLoggedIn(){return Rz().then(this.completeLogin.bind(this),this.logout.bind(this))}driveCallback(){return this.askServerIfLoggedIn()}createAccount(t){let i=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},t),{name:t.userProvidedName.given});return i.teacher===!1&&delete i.teacher,Bz(i).then(this.completeLogin.bind(this))}checkPendingDeletion(t){return Nz(t)}isTeacher(){return!!this.teacher}setNameLegacy(t){return zz(t).then(i=>{this.name=i.name||"",this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)})}setNameDetail(t){return Uz(t).then(i=>{this.name=i.name||"",this.nameDetail=i.nameDetail,this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)})}recoverPassword(t){return Hz(t)}completeLogin(t){this.loggedIn=!0,this.userId=t.userId||"",this.name=t.name||"",this.nameDetail=t.nameDetail,this.email=t.email||"",this.featureFlags=t.featureFlags||[],this.subscriptions=t.subscriptions||[],this.verificationStatus=t.verificationStatus||"",this.privacyConsent=t.privacyConsent,this.teacher=!!t.isTeacher,this.triggerEvent("loginChanged",void 0),this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)}async logout(){this.loggingOut=!0,this.triggerEvent("logout",void 0),this.triggerEvent("triggerRender",void 0);try{await jL(),this.completeLogout()}catch(t){this._onLogoutFailure()}finally{this.loggingOut=!1,this.triggerEvent("triggerRender",void 0)}}completeLogout(){this.loggedIn=!1,this.logoutFailed=!1,this.userId="",this.email="",this.name="",this.subscriptions=[],this.featureFlags=[],this.verificationStatus="",this.privacyConsent=null,this.teacher=!1,this.triggerEvent("loginChanged",void 0),this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)}_onLogoutFailure(){this.logoutFailed=!0,this.triggerEvent("triggerRender",void 0),setTimeout(()=>{this.logoutFailed=!1,this.triggerEvent("triggerRender",void 0)},2e3)}initiateAccountDeletion(t){return Wz(t)}getEmailChangeToken(){return _p(location.search,"changeToken")}initiateEmailChange(t){return $z(t)}setEmail(t){return jz(t).then(()=>{this.email=t.newEmail||"",this.verificationStatus="VERIFYING",this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)})}async setPrivacyConsent(t){this.consentingToPrivacy=!0,this.triggerEvent("triggerRender",void 0);try{let i=await Jz(t);this.completePrivacyConsent(i)}catch(i){this.onPrivacyConsentFailure()}finally{this.consentingToPrivacy=!1,this.triggerEvent("triggerRender",void 0)}}completePrivacyConsent(t){this.privacyConsent=t.privacyConsent,this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)}onPrivacyConsentFailure(){this.privacyConsentFailed=!0,this.triggerEvent("triggerRender",void 0),setTimeout(()=>{this.privacyConsentFailed=!1,this.triggerEvent("triggerRender",void 0)},2e3)}updateFeatureFlags(t){return Yz(t).then(i=>{this.featureFlags=i.featureFlags,this.triggerEvent("userUpdated",void 0)})}getFeatureFlags(){return this.featureFlags}hasFeatureFlag(t){return this.featureFlags.some(i=>i===t)}didPrivacyConsentFail(){return!!this.privacyConsentFailed}isConsentingToPrivacy(){return!!this.consentingToPrivacy}isLoggedIn(){return!!this.loggedIn}isLoggingOut(){return!!this.loggingOut}didLogoutFail(){return!!this.logoutFailed}getEmail(){return this.email}getFirstName(){return Zie(this.name)}getFullName(){return this.name}getNameDetail(){return this.nameDetail||{given:this.name,source:"legacy"}}getUserId(){return this.userId}getSubscriptions(){return this.subscriptions}getVerificationStatus(){return this.verificationStatus}hasConsentedToCollection(){return!!this.privacyConsent}getUserAsJSON(){if(this.isLoggedIn())return{email:this.email,name:this.name,verificationStatus:this.verificationStatus,subscriptions:this.subscriptions,privacyConsent:this.privacyConsent}}};function Zie(r){if(!r)return"";if(r.match(/[\d@_&\.\']/))return r;var e=r.split(" ");return e[0].length>=3?e[0]:r}var zO={};__dcg_shared_module_exports__['g'](zO,{init:()=>aoe,next:()=>ooe,nextSeed:()=>noe});var BO=class{constructor(e){this.bauArc4=new qO(eoe(e))}g(e){for(var t=Array(e),i=0;i<e;i++)t[i]=this.bauArc4.g(1);return t}},KC=256;function dp(r){return r&KC-1}function eoe(r){var e=r+"",t=[],i=0,o;for(o=0;o<e.length;o++)t[dp(o)]=dp((i^=t[dp(o)]*19)+e.charCodeAt(o));return t}var qO=class{constructor(e){this.S=[];this.c=[];this.i=0;this.j=0;this.m=0;var t,i,o=e.length,n=0,a=0;for(o||(e=[o++]);n<KC;)this.S[n]=n++;for(n=0;n<KC;n++)t=this.S[n],a=dp(a+t+e[n%o]),i=this.S[a],this.S[n]=i,this.S[a]=t;this.g(KC)}g(e){var t=this.S,i=dp(this.i+1),o=t[i],n=dp(this.j+o),a=t[n];t[i]=a,t[n]=o;for(var s=t[dp(o+a)];--e;)i=dp(i+1),o=t[i],n=dp(n+o),a=t[n],t[i]=a,t[n]=o,s=s*KC+t[dp(o+a)];return this.i=i,this.j=n,s}},toe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",roe=toe.toLowerCase(),ioe=62,y6=10,KO=class{constructor(e){if(!e||!e.length||e.length<32)throw new Error("You must supply a seed to RandomHashFactory. It should have at least 128 bits of entropy, but was "+e);this.arc4=new BO(e)}next(){for(var e=Array(y6),t=0,i;t<y6;)i=this.arc4.g(1)[0]>>2,i<ioe&&(e[t]=roe[i],t++);return e.join("")}nextSeed(){for(var e=16,t=this.arc4.g(e),i=Array(e),o=0;o<e;o++)i[o]=t[o].toString(16),i[o].length===1&&(i[o]="0"+i[o]);return i.join("")}},zC;function ooe(){if(!zC)throw"Random Hash Factory not initialized";return zC.next()}function noe(){if(!zC)throw"Random Hash Factory not initialized";return zC.nextSeed()}function aoe(r){zC=new KO(r)}yl();function UO(r,e){if(!e.hasOwnProperty("myGraphs"))throw new Error("Argument Error: saveGraph options must specify myGraphs");if(!e.hasOwnProperty("isUpdate"))throw new Error("Argument Error: saveGraph options must specify isUpdate");var t={parent_hash:r.parentHash,thumb_data:r.thumbURL,graph_hash:r.hash,my_graphs:e.myGraphs,is_update:e.isUpdate,title:r.title||void 0};return t.state=r.graphData,sn("/api/v1/calculator_3d/save",t).then(function(i){return Dn.updateFromSync(r,i),r})}function x6(){return lc("/api/v1/calculator_3d/my_graphs")}function w6(r){return sn("/api/v1/calculator_3d/my_graphs/remove",{hash:r.hash})}function HO(r,e){if(!e.hasOwnProperty("myConstructions"))throw new Error("Argument Error: saveConstruction options must specify myConstructions");if(!e.hasOwnProperty("isUpdate"))throw new Error("Argument Error: saveConstruction options must specify isUpdate");var t={state:r.graphData,parent_hash:r.parentHash,thumb_data:r.thumbURL,hash:r.hash,my_constructions:e.myConstructions,is_update:e.isUpdate,title:r.title||void 0};return sn("/api/v1/geometry/save",t).then(function(i){return Dn.updateFromSync(r,i),r})}function WO(){return lc("/api/v1/geometry/my_constructions")}function v6(r){return sn("/api/v1/geometry/my_constructions/remove",{hash:r.hash})}var NI=class extends kr{constructor({api:t,s:i,getLanguage:o,examplesJSON:n,randomSeed:a,product:s}){super();this.product=s,this.api=t,this.s=i,this.getLanguage=o,this.previousGraph=void 0,this.recoveryParentHash=void 0,this.randomHash=zO,this._seedRandom(a),this.__savedGraphs=[],this.__recoveryGraphs=[];let l=n.map(Dn.fromAjax);this.__exampleGraphs=__dcg_shared_module_exports__['t'](l,c=>!c.easterEgg),this.__easterEggGraphs=__dcg_shared_module_exports__['t'](l,c=>!!c.easterEgg),this.__graphInfoCache={},this.__exampleGraphs.forEach(c=>{this._addGraphToCache(c)}),this.__easterEggGraphs.forEach(c=>{this._addGraphToCache(c)}),this.lastSync=void 0,this.lastSaveFailureMessage="",this.recentSaveFailure=!1,this.recentSaveSuccess=!1,this.saving=!1,this.syncError=!1,this.isLoadingGraphs=!1,this.currentGraph=new Dn,this._enableLoadingGraphStates(),this.pageLoadTime=Date.now()}_seedRandom(t){if(!t){alert(this.s("account-shell-error-something-went-wrong",{error_num:"77361"}));return}let i=new Date,o=""+t+i.getTime()+i.getMilliseconds();this.randomHash.init(o)}requestDeleteGraph(t){let i=this._getCachedGraphInfo(t);i.canCancelDelete=!0,i.deleteTimeout=setTimeout(this._deleteGraph.bind(this,t),3e3),i.isDeletingGraph=!0,i.didDeleteGraphFail=!1,this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0)}_removeSavedGraphByHash(t){this.__savedGraphs=__dcg_shared_module_exports__['t'](this.__savedGraphs,i=>i.hash!==t)}_removeRecoveryGraphByHash(t){this.__recoveryGraphs=__dcg_shared_module_exports__['t'](this.__recoveryGraphs,i=>i.hash!==t)}async _deleteGraph(t){let i=t.hash,o=this._getCachedGraphInfo(t);o.canCancelDelete=!1,this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0);let n;switch(this.product){case"graphing":case"geometry-calculator":{n=cU({hash:i,lang:this.getLanguage()});break}case"graphing-3d":{n=w6(t);break}case"geometry":{n=v6(t);break}}try{await n,this._removeSavedGraphByHash(i),this._removeRecoveryGraphByHash(i)}catch(a){o.didDeleteGraphFail=!0}finally{o.isDeletingGraph=!1,this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0)}}cancelDeleteGraph(t){let i=this._getCachedGraphInfo(t);clearTimeout(i.deleteTimeout),i.isDeletingGraph=!1,i.didDeleteGraphFail=!1,i.canCancelDelete=!1,this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0)}millisecondsSinceSync(){return this.lastSync?Date.now()-this.lastSync:1/0}clear(){this.lastSync=void 0,this.setSavedGraphsFromJSON([]),this.setRecoveryGraphsFromJSON([])}dismissSaveError(){this.recentSaveFailure=!1,this.triggerEvent("triggerRender",void 0)}_triggerSaveSuccess(){this.saving=!1,this.recentSaveSuccess=!0,this.lastSaveFailureMessage=void 0,this.triggerEvent("triggerRender",void 0),this.recentSaveTimeout=setTimeout(()=>{this.recentSaveSuccess=!1,this.triggerEvent("triggerRender",void 0)},3e3)}_triggerSaveError(t){let i=t.length&&t[0].message?t[0].message:this.s("account-shell-error-unexpected-error");this.saving=!1,this.recentSaveFailure=!0,this.lastSaveFailureMessage=i,this.triggerEvent("triggerRender",void 0),this.toast(i,{}),this.recentSaveTimeout=setTimeout(this.dismissSaveError.bind(this),3e3)}_updateGraphData(t){let i=JSON.stringify(this.api.getState());t.setProperty("graphData",i),t.setProperty("parentHash",t.hash),t.setProperty("recoveryParentHash",this.recoveryParentHash);let o=this.randomHash.next();t.setProperty("hash",o),this.recoveryParentHash=o;let n=this.api.screenshot({width:200,height:200,targetPixelRatio:2});t.setProperty("thumbURL",n)}_clearSaveTimeout(){this.recentSaveFailure=!1,this.recentSaveSuccess=!1,this.lastSaveFailureMessage=void 0,this.triggerEvent("triggerRender",void 0),clearTimeout(this.recentSaveTimeout)}async save(t){let i=t&&t.newTitle,o=!!(t&&t.saveCopy);i&&(this.currentGraph.title=i),this._clearSaveTimeout(),this.saving=!0,this.triggerEvent("triggerRender",void 0);let n=this.currentGraph.copy();n.recovery&&(n.recovery=!1,Qt("recovered-graph",{product:this.product,timeSincePageload:Date.now()-this.pageLoadTime,payloadJSON:{action:"save"}})),this._updateGraphData(n);let a=!o&&this.wasCurrentGraphEverSaved(),s;switch(this.product){case"graphing":case"geometry-calculator":{s=XG(n,{myGraphs:!0,isUpdate:a,product:this.product,lang:this.getLanguage()});break}case"graphing-3d":{s=UO(n,{myGraphs:!0,isUpdate:a});break}case"geometry":{s=HO(n,{myConstructions:!0,isUpdate:a});break}}try{let l=await s;this.currentGraph=l.copy(),this._onCurrentGraphChanged(),this.triggerEvent("clearUnsavedChanges",void 0),this.triggerEvent("triggerRender",void 0),a&&this._removeSavedGraphByHash(l.parentHash),l.draft&&this._removeRecoveryGraphByHash(l.parentHash),this.__savedGraphs.unshift(l),this._addGraphToCache(l),this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0),this._triggerSaveSuccess()}catch(l){let c=(l==null?void 0:l.status)===413?[{message:this.s("account-shell-error-graph-too-large")}]:rO(l);this._triggerSaveError(c)}}shareGraph(){let t=this.currentGraph.copy();this._updateGraphData(t);let i;switch(this.product){case"graphing":case"geometry-calculator":{i=XG(t,{myGraphs:!1,isUpdate:!1,product:this.product,lang:this.getLanguage()});break}case"graphing-3d":{i=UO(t,{myGraphs:!1,isUpdate:!1});break}case"geometry":{i=HO(t,{myConstructions:!1,isUpdate:!1});break}}return i}saveRecoveryGraph(){switch(this.product){case"graphing":case"geometry-calculator":{let t=this.currentGraph.copy(),i=JSON.stringify(this.api.getState());t.setProperty("graphData",i),t.setProperty("parentHash",t.hash),t.setProperty("recoveryParentHash",this.recoveryParentHash);let o=this.randomHash.next()+this.randomHash.next();t.setProperty("hash",o),this.recoveryParentHash=o;let n=this.api.screenshot({width:200,height:200,targetPixelRatio:2});return t.setProperty("thumbURL",n),XG(t,{myGraphs:!1,isUpdate:!1,recovery:!0,product:this.product,lang:this.getLanguage()})}case"geometry":case"graphing-3d":throw new Error(`Programming Error: ${this.product} cannot save recovery graphs`)}}isCurrentGraphTitled(){return!!this.currentGraph.title&&!this.currentGraph.questHash}isCurrentGraphARecoveryGraph(){let t=this.currentGraph;if(!t||!t.hash)return!1;let i=t.hash;return __dcg_shared_module_exports__['v'](this.__recoveryGraphs,o=>o.hash===i)}wasCurrentGraphEverSaved(){let t=this.currentGraph;if(!t||!t.hash)return!1;let i=t.hash;return __dcg_shared_module_exports__['v'](this.__savedGraphs,o=>o.hash===i)}willSaveCopy(){let t=this.currentGraph;return!!t.questHash||!!t.hash&&!this.wasCurrentGraphEverSaved()}isSaveEnabled(){var t;return this.hasUnsavedChanges()?!0:(t=this.currentGraph)!=null&&t.hash?!this.wasCurrentGraphEverSaved():!1}isRecoveryUIEnabledForProduct(){return this.product==="graphing"||this.product==="geometry-calculator"}async fetchRecoveryGraphs(){let i=Date.now(),o;switch(this.isLoadingRecoveryGraphs=!0,clearTimeout(this.fetchDurationTimeout),this.triggerEvent("triggerRender",void 0),this.product){case"graphing":case"geometry-calculator":{o=lU({product:this.product,lang:this.getLanguage()});break}case"graphing-3d":throw new Error("code error: should not fetchRecoveryGraphs for 3d");case"geometry":throw new Error("code error: should not fetchRecoveryGraphs for geometry")}try{let n=await o;this.setRecoveryGraphsFromJSON(n.recoveryGraphs||n.recoveryConstructions)}catch(n){this.triggerEvent("onRecoveryGraphsError",void 0)}finally{let a=2e3-(Date.now()-i);this.isLoadingRecoveryGraphs=!1,a>0?this.fetchDurationTimeout=setTimeout(()=>{this.triggerEvent("triggerRender",void 0)},a):this.triggerEvent("triggerRender",void 0)}}clearRecoveryGraphsForTests(){return dU()}async refreshGraphs(){this.isLoadingGraphs=!0,this.syncError=!1,this.triggerEvent("triggerRender",void 0);let t;switch(this.product){case"graphing":t=tO({product:this.product,lang:this.getLanguage()});break;case"geometry-calculator":{t=Promise.all([tO({product:this.product,lang:this.getLanguage()}),WO().catch(i=>{fn("Error loading constructions from legacy geometry backend: "+String(i))})]);break}case"graphing-3d":{t=x6();break}case"geometry":{t=WO();break}}try{let i=await t;Array.isArray(i)||(i=[i]);let o=i.reduce((n,a)=>n.concat((a==null?void 0:a.myGraphs)||(a==null?void 0:a.myConstructions)||[]),[]);this.lastSync=Date.now(),this.setSavedGraphsFromJSON(o)}catch(i){this.syncError=!0,this.triggerEvent("onSyncError",void 0)}finally{this.isLoadingGraphs=!1,this.triggerEvent("triggerRender",void 0),this.triggerEvent("graphsLoaded",void 0)}}getRecoveryGraphs(){return this.__recoveryGraphs.slice(0)}getSavedGraphs(){return this.__savedGraphs.slice(0)}getExampleGraphs(){return this.__exampleGraphs.slice(0)}getEasterEggGraphs(t){return __dcg_shared_module_exports__['t'](this.__easterEggGraphs,i=>i.easterEgg===t)}getSavedAndExampleGraphs(){return this.__savedGraphs.concat(this.__exampleGraphs)}setSavedGraphsFromJSON(t){t||(t=[]),t.sort((i,o)=>{let n=new Date(i.created);return new Date(o.created).valueOf()-n.valueOf()}),this.__savedGraphs=t.map(i=>{let o=Dn.fromAjax(i),n=this._getCachedGraphInfo(o);return n?n.graph:(this._addGraphToCache(o),o)}),this._lazyLoadGraphStates(),this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0)}setRecoveryGraphsFromJSON(t){t||(t=[]),this.__recoveryGraphs=t.map(i=>{let o=Dn.fromAjax(i);o.draft=!0,o.recovery=!0;let n=this._getCachedGraphInfo(o);return n?n.graph:(this._addGraphToCache(o),o)}),this._lazyLoadGraphStates(),this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0)}getSavedGraphsAsJSON(){return this.__savedGraphs.map(Dn.toAjax)}_enableLoadingGraphStates(){clearTimeout(this.__loadNextGraphStateTimeout);let t=()=>{this._loadNextGraphState(),this.__loadNextGraphStateTimeout=setTimeout(t,50)};t()}_disableLoadingGraphStates(){clearTimeout(this.__loadNextGraphStateTimeout)}async _loadNextGraphState(){if(this.__currentAjaxRequest)return;let t=this._dequeueGraphInfo();if(t){this.__currentAjaxRequest=this.loadGraphImmediately(t.graph);try{await this.__currentAjaxRequest}catch(i){}this.__currentAjaxRequest=void 0}}async loadGraphImmediately(t){if(t.graphData)return;let i=t.stateURL,o=this._getCachedGraphInfo(t);o.isDataLoading=!0;try{let n=await fetch(`${i}?${new URLSearchParams(Ed)}`),a=await n.json();if(!n.ok)throw a;return t.graphData=a,this.product==="geometry-calculator"&&i4(i)&&(t.graphData=Uc(t.graphData),t.isMigratedFromLegacyGeometry=!0),o.didDataLoadFail=!1,a}catch(n){throw o.didDataLoadFail=!0,n}finally{o.isDataLoading=!1,this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0)}}_getCachedGraphInfo(t){return t&&this.__graphInfoCache[t.getCollectionKey()]}_addGraphToCache(t){this.__graphInfoCache[t.getCollectionKey()]={graph:t}}_enqueueGraphInfo(t){this.__nextAjaxRequestPriority||(this.__nextAjaxRequestPriority=0),t.ajaxPriority=++this.__nextAjaxRequestPriority}_dequeueGraphInfo(){let t=-1/0,i;for(let o in this.__graphInfoCache){let n=this.__graphInfoCache[o],a=n.ajaxPriority;a!==void 0&&a>t&&(t=a,i=n)}return!__dcg_shared_module_exports__['S'](i)||i===void 0?null:(delete i.ajaxPriority,i)}loadDataForGraph(t){if(!t)return;let i=this._getCachedGraphInfo(t);if(!i)throw new Error('graphsController does not have a reference to graph with hash "'+t.hash+'"');i.graph.graphData||(i.isDataLoading=!0,i.didDataLoadFail=!1,this._enqueueGraphInfo(i),this.triggerEvent("triggerRender",void 0))}_lazyLoadGraphStates(){let i=this.getSavedAndExampleGraphs();for(let o=Math.min(20,i.length)-1;o>=0;o--)this.loadDataForGraph(i[o])}didDataLoadFail(t){let i=this._getCachedGraphInfo(t);return!!(i&&i.didDataLoadFail)}didDeleteGraphFail(t){let i=this._getCachedGraphInfo(t);return!!(i&&i.didDeleteGraphFail)}isDeletingGraph(t){let i=this._getCachedGraphInfo(t);return!!(i&&i.isDeletingGraph)}canCancelDelete(t){let i=this._getCachedGraphInfo(t);return!!(i&&i.canCancelDelete)}loadGraph(t,i){this.previousGraph=this.currentGraph?this.currentGraph.copy():new Dn,this.previousGraph.graphData=JSON.stringify(this.api.getState());let o=t.copy();delete o.example,this.api.setState(o.graphData,{forceExpressionsOpen:!0,forceUnsavedChanges:!!o.recovery,allowUndo:i&&i.allowUndo}),this.currentGraph=o,this._onCurrentGraphChanged(),this.recoveryParentHash=this.currentGraph.hash,(!i||!i.allowUndo)&&this.triggerEvent("clearUndoRedo",void 0),o.recovery||this.triggerEvent("clearUnsavedChanges",void 0),this.triggerEvent("triggerRender",void 0),this.triggerEvent("onLoadGraph",void 0)}restorePreviousGraph(){let t=this.previousGraph.copy()||new Dn;this.loadGraph(t),this.triggerEvent("restoredGraph",{graph:t})}clearGraph(t){this.loadGraph(new Dn,t),this.triggerEvent("onClearGraph",void 0)}defaultTitle(){switch(this.product){case"graphing":return this.s("account-shell-heading-graphingcalc-page-title");case"graphing-3d":return this.s("account-shell-heading-3dcalc-page-title");case"geometry-calculator":return this.s("account-shell-heading-geometry-page-title");case"geometry":return this.s("account-shell-heading-geometry-legacy-page-title")}}_onCurrentGraphChanged(){let t=this.currentGraph;t.title?document.title=this.s("account-shell-heading-named-graph",{title:t.title}):document.title=this.defaultTitle(),this._replaceState(t)}_replaceState(t){if(!(window.history&&history.replaceState))return;let i=t.getURL();i&&(window.location.search&&(i+=window.location.search),i!==window.location.href&&history.replaceState(t.hash,t.title,i))}toast(t,i){this.triggerEvent("toast",{message:t,opts:i})}clearGraphByUserAction(){let t;if(this.currentGraph.hash||this.currentGraph.questHash){this.clearGraph(),t=this.product==="geometry"?this.s("account-shell-text-new-construction-created"):this.s("account-shell-text-new-graph-created"),this.toast(t,{undoCallback:()=>{this.restorePreviousGraph(),this._replaceState(this.currentGraph)}});return}let i=this.api.getState();this.clearGraph({allowUndo:!0}),t=this.product==="geometry"?this.s("account-shell-text-construction-cleared"):this.s("account-shell-text-graph-cleared"),this.toast(t,{undoCallback:()=>{this.api.setState(i,{forceExpressionsOpen:!0,allowUndo:!0})}})}getSaveFailureMessage(){return this.lastSaveFailureMessage||""}isSaving(){return!!this.saving}didSaveFail(){return!!this.recentSaveFailure}didSaveSucceed(){return!!this.recentSaveSuccess}isSyncing(){return!!this.isLoadingGraphs}didSyncFail(){return!!this.syncError}getCurrentDisplayDate(){return this.currentGraph.displayDate()}getCurrentGraphTitle(){return this.currentGraph.title}getUntitledString(){return this.product==="geometry"?this.s("account-shell-text-untitled"):this.product==="graphing"?this.s("account-shell-text-untitled-graph"):this.product==="graphing-3d"?this.s("account-shell-text-untitled-graph"):this.product==="geometry-calculator"?this.s("account-shell-text-untitled"):(fn("Unknown product: "+this.product),"Untitled")}hasUnsavedChanges(){return this.api.hasUnsavedChanges()}};ig();var UC=class{constructor(e){this.s=jl(()=>this._language);this._language=sx(),this.Calc=e}raw(e,t){return Ks(e,t)}unpack(e){return kd(e,this._language)}getLanguage(){return this._language}updateUrl(e){if(!(window.history&&history.replaceState))return;let{origin:t,pathname:i,search:o,hash:n}=location,a=cS(o,"lang",e),s=`${t}${i}${a}${n}`;history.replaceState(null,"",s)}setHeaderController(e){this.headerController=e}fetchAndSetLanguage(e){of(e).then(()=>{this._language=e,this.Calc.updateSettings({language:e}),this.updateUrl(e),this.headerController&&this.headerController.triggerRender()})}};xt();yl();Lp();var C6=5*60*1e3;Da().fastAutoSave&&(C6=5*1e3);var BI=class{constructor(e){this.defaultModalDevice="mouse";this.userControllerState="uninitialized";this.lastIsShowingActionsUI=!1;if(e.graphsController.product!==e.product)throw new Error("Programming error: mismatched product between graphsController and calculator-shell controller");this.userController=e.userController,this.graphsController=e.graphsController,this.tourController=e.tourController,this.languageController=e.languageController,this.mygraphsController=e.mygraphsController,this.api=e.api,this.raw=e.raw,this.s=e.s,this.getLanguage=e.getLanguage,this.unpack=e.unpack,this.product=e.product,this.SOMETHING_WENT_WRONG=this.s("account-shell-error-unknown"),this._openMenu="none",this._requestedContactForm=!1,this._feedbackMessage="",this.state={},this.languageController&&this.languageController.setHeaderController(this),this.hookupControllers(),this.hookupHotkeys(),this.dispatcher=new Zd,this.dispatch=t=>(rg("dispatch::header-controller",{type:t.type}),this.dispatcher.dispatch(t)),this.dispatcher.register(t=>{switch(this.logDispatches(t),t.type){case"save-graph":this.saveGraph(t.device,t.payload);break;case"edit-title":this.launchEditTitle();break;case"close-modal":this.closeModal();break;case"toggle-menu":this.setOpenMenu(t.payload);break;case"open-mygraphs":this.mygraphsController.openMygraphs(t);break;case"close-mygraphs":this.mygraphsController.closeMygraphs();break;case"render":break;case"show-modal":this.showModal(t);break;case"show-contact-form":this._requestedContactForm=t.showForm;break;default:return t}return this.triggerRender()}),this.lastRecoveryState={},this.checkRecoveryState()}logDispatches(e){let t;switch(e.type){case"toggle-menu":e.payload==="help"?t="help::open":t="help::close";break;case"open-mygraphs":t="user-action::open-my-graphs";break;default:break}t&&this.logJSON(t,{product:this.graphsController.product})}triggerRender(){}hookupControllers(){this.mygraphsController.observeEvent("onOpenMygraphs",()=>{this.isLoggedIn()&&this.graphsController.millisecondsSinceSync()>2*60*1e3&&this.graphsController.refreshGraphs()}),this.mygraphsController.observeEvent("triggerRender",()=>{this.triggerRender()}),this.userController.observeEvent("loginChanged",()=>{this.userControllerState="initialized",this.mygraphsController.recoveryAttempted=!1,this.isLoggedIn()?this.graphsController.refreshGraphs():this.graphsController.clear(),this.mustConsentToCollection()&&this.showModal({modal:"consent",device:this.defaultModalDevice})}),this.graphsController.observeEvent("graphsLoaded",()=>{this._isSavingGraph&&this.simpleSave(this.getModalDevice())}),this.userController.observeEvent("userUpdated",()=>{this.getOpenModal()==="consent"&&this.closeModal(),Pr("actions")===void 0&&"_calc"in this.api&&this.api._calc.setOption("actions",this.isActionsFlagEnabled()?!0:"auto")}),this.userController.observeEvent("triggerRender",()=>{this.triggerRender()}),this.graphsController.observeEvent("triggerRender",()=>{this.triggerRender()}),"_calc"in this.api&&this.api._calc.controller.subscribeToChanges(()=>this.maybeShowAdvancedFeaturesToast())}hookupHotkeys(){H(document).on("keydown",e=>{let t,{altKey:i,ctrlKey:o,metaKey:n,shiftKey:a}=e;if(oi?t=!o&&n&&!i&&!a:t=o&&!n&&!i&&!a,t)switch(ki(e)){case"S":return this.simpleSave("keyboard"),!1;case"O":return this.dispatch({type:"open-mygraphs",device:"keyboard"}),!1}})}disablePrintAndExport(){this._disablePrintAndExport=!0}shouldDisablePrintAndExport(){return this.product==="graphing-3d"?!0:!!this._disablePrintAndExport}getOpenMenu(){return this._openMenu}getModalState(){return this._openModal||{modal:"none"}}getOpenModal(){var e,t;return(t=(e=this._openModal)==null?void 0:e.modal)!=null?t:"none"}hasOpenModal(){return!!this._openModal}getModalDevice(){var e;return(e=this._openModal)==null?void 0:e.device}getModalStartingError(){var e;return((e=this._openModal)==null?void 0:e.error)||""}closeModal(){var e,t;(((e=this._openModal)==null?void 0:e.modal)!=="login"&&((t=this._openModal)==null?void 0:t.modal)!=="signup"||!this.isLoggedIn())&&(this._isSavingGraph=!1),this._openModal=this.mustConsentToCollection()?{modal:"consent",device:this.defaultModalDevice}:void 0,this.triggerRender()}closeMenu(){this._openMenu="none",this.maybeResetContactForm()}showModal(e){this.closeMenu(),this._openModal=e,this.defaultModalDevice=e.device}setOpenMenu(e){let t=this.getOpenMenu();this._openMenu=e===t?"none":e,this.maybeResetContactForm()}getFeedbackMessage(){return this._feedbackMessage}setFeedbackMessage(e){this._feedbackMessage=e}maybeResetContactForm(){this.getOpenMenu()!=="help"&&(this.getFeedbackMessage().trim().length||(this.setFeedbackMessage(""),this._requestedContactForm=!1))}getProduct(){return this.product}saveRecoveryState(){let e=this.graphsController.api.getState();var t=this.graphsController.saveRecoveryGraph();return this.lastRecoveryState=e,t}shouldSaveRecoveryState(){if(!this.userController.isLoggedIn()||!this.graphsController.hasUnsavedChanges())return!1;let e=this.graphsController.api.getState();return!__dcg_shared_module_exports__['P'](e,this.lastRecoveryState)}checkRecoveryState(){this.graphsController.isRecoveryUIEnabledForProduct()&&setTimeout(()=>{this.checkRecoveryState(),this.shouldSaveRecoveryState()&&this.saveRecoveryState()},C6)}isLoggedIn(){return this.userController.isLoggedIn()}hasConsentedToCollection(){return this.userController.hasConsentedToCollection()}isInMaintenanceMode(){return!!Pr("maintenance")}getPreviewParams(){return Pr("previewMode")?{url:Pr("previewFeedbackUrl"),message:Pr("previewMessage")}:null}isDecimalToFractionEnabled(){return!!Pr("decimalToFraction")}isSaveEnabled(){return this.graphsController.isSaveEnabled()}saveGraph(e,t){this.isLoggedIn()?(this.graphsController.save({newTitle:t==null?void 0:t.title,saveCopy:!!(t!=null&&t.saveAs)}),this.closeModal(),this.closeMenu(),this._isSavingGraph=!1):this.showModal({modal:"login",device:e})}simpleSave(e=this.defaultModalDevice){this.userController.isLoggedIn()?this._isSavingGraph&&this.graphsController.wasCurrentGraphEverSaved()?this.dispatch({type:"show-modal",modal:"duplicate",device:e}):this.graphsController.isCurrentGraphTitled()?(this.saveGraph(e||"mouse"),this.dispatch({type:"render"})):this.openSaveDialog({device:e}):(this._isSavingGraph=!0,this.dispatch({type:"show-modal",modal:"login",device:e}))}openSaveDialog(e={}){this.showModal({modal:"save",device:e.device||this.defaultModalDevice,fromSaveInProgress:e.fromSaveInProgress}),this.dispatch({type:"render"})}launchEditTitle(){this.closeMenu(),!(this.getPreviewParams()!=null||this.isInMaintenanceMode())&&(this.isLoggedIn()?this.product==="geometry"?this.showModal({modal:"save",device:this.defaultModalDevice}):this.showModal({modal:"rename",device:this.defaultModalDevice}):this.showModal({modal:"signup",device:this.defaultModalDevice}))}getOpenText(){switch(this.product){case"graphing":case"geometry-calculator":case"graphing-3d":return this.s("account-shell-button-open-graph");case"geometry":return this.s("account-shell-button-open-construction")}}isConsentingToCollection(){return this.userController.isConsentingToPrivacy()}privacyConsentFailed(){return this.userController.didPrivacyConsentFail()}mustConsentToCollection(){return this.isLoggedIn()&&!this.hasConsentedToCollection()}isArtContestEnabled(){return!1}isGraphComplexEnoughForContest(){if(!(this.api instanceof Ah))return!1;let e=this.api.getState(),{list:t}=e.expressions;return!!(t.length!==1||t[0].type!=="expression"||t[0].latex)}shouldShowArtContestNudge(){return this.isArtContestEnabled()?this.isGraphComplexEnoughForContest()&&this.isLoggedIn():!1}getLimitedSignupRole(){return"student"}wasModalOpenedWithKeyboard(){var e;return((e=this._openModal)==null?void 0:e.device)==="keyboard"}allowSignInWithApple(){return!0}getSomethingWentWrongText(){return this.s("account-shell-error-unknown")}logJSON(e,t){Qt(e,t)}parseJSONErrors(e){return QG(e)}requestedContactForm(){return this.product==="geometry-calculator"?!0:this._requestedContactForm}isActionsFlagEnabled(){return this.userController.hasFeatureFlag("dcg-actions")}maybeShowAdvancedFeaturesToast(){let e=this.api;if(!("_calc"in e))return;let t=e._calc.controller.areActionsEnabled();if(t&&this.userControllerState==="uninitialized"){this.userControllerState="loading",this.userController.askServerIfLoggedIn().then(()=>{this.userControllerState="initialized",this.maybeShowAdvancedFeaturesToast()});return}else if(this.userControllerState==="loading")return;this.isActionsFlagEnabled()||(t&&!this.lastIsShowingActionsUI&&this.userController.isLoggedIn()&&e._calc.controller.runAfterDispatch(()=>{e._calc.controller.dispatch({type:"toast/show",toast:{message:wo("account-shell-text-graph-uses-advanced-features"),hideAfter:0,learnMoreCallback:()=>{this.dispatch({type:"show-modal",modal:"account-settings",initialTab:"advanced",device:this.defaultModalDevice})}}})}),this.lastIsShowingActionsUI=t)}};xt();var coe=0,HC=class{constructor(e,t,i){this.__id=coe++,this.controller=e,this.headerController=t,this.userController=t.userController,this.mygraphsController=t.mygraphsController,this.instanceHotkeys=i,this.startListening()}remove(){this.stopListening()}startListening(){this.isListening||(H(document).on("keydown.dcg-global-keyboard-listener-"+this.__id,e=>this.handleGlobalKeydown(e)),this.isListening=!0)}stopListening(){this.isListening&&(H(document).off("keydown.dcg-global-keyboard-listener-"+this.__id),this.isListening=!1)}handleGlobalKeydown(e){let t=!1;if(Qh(e)||Zh(e))(!this.controller.getRootElt()||document.activeElement&&document.activeElement!=document.body&&!document.activeElement.closest(".dcg-dom-change-wrapper"))&&(t=!0);else if(!e.ctrlKey&&!e.altKey&&!e.metaKey&&!e.shiftKey&&Ee(e)===hn)t=this.handleEscape(e);else if(vV(e))e.preventDefault(),e.stopPropagation(),t=!0,this.headerController.dispatch({type:"show-modal",modal:"hotkeys",device:"keyboard"});else if(e.ctrlKey&&(e.altKey||e.metaKey)&&!e.shiftKey)if(ki(e)==="A")if(e.preventDefault(),e.stopPropagation(),t=!0,this.userController.isLoggedIn())this.focusElement(document.querySelector(".dcg-header .dcg-account-link"),this.controller.s("graphing-calculator-narration-unable-to-activate-account-menu"));else{let i=document.querySelector(".dcg-sign-in");this.triggerKeyboardTapEvent(i)}else ki(e)==="L"?(e.preventDefault(),e.stopPropagation(),t=!0,this.focusElement(document.querySelector(".dcg-action-language"),this.controller.s("graphing-calculator-narration-unable-to-activate-language-menu"))):ki(e)==="H"?(e.preventDefault(),e.stopPropagation(),t=!0,this.focusElement(document.querySelector(".dcg-action-help"),this.controller.s("graphing-calculator-narration-unable-to-activate-help-menu"))):ki(e)==="S"&&(e.preventDefault(),e.stopPropagation(),t=!0,this.focusElement(document.querySelector(".dcg-action-share"),this.controller.s("graphing-calculator-narration-unable-to-activate-share-menu")));t||this.instanceHotkeys.handleKeydown(e)}handleEscape(e){let t=!1,i=this.headerController.getModalState().modal!=="none",o=this.headerController.getOpenMenu()!=="none",n=!!document.querySelector(".graph-preview"),a=this.mygraphsController.isMygraphsOpen(),s=!1;if(i)this.headerController.dispatch({type:"close-modal"}),s=!0;else if(o)this.headerController.dispatch({type:"toggle-menu",payload:"none"}),s=!0;else if(n){let l=document.querySelector(".dcg-action-close-resources");Vp(l)&&this.triggerKeyboardTapEvent(l),s=!0}else a&&(this.headerController.dispatch({type:"close-mygraphs"}),s=!0);if(s){if(!ul)if(!n&&!(i&&a)){let l=this.controller.getSelectedItem();if(l)this.controller.dispatch({type:"move-focus-to-item",id:l.id});else{let c=this.controller.getItemModelByIndex(0);c&&this.controller.dispatch({type:"move-focus-to-item",id:c.id})}}else i&&a&&document.querySelector(".new-blank-graph").focus();e.preventDefault(),e.stopPropagation(),t=!0}return t}triggerKeyboardTapEvent(e){if(!e)return;let t=H.Event("dcg-tap");t.device="keyboard",H(e).trigger(t)}focusElement(e,t){e?this.triggerKeyboardTapEvent(e):t&&be(t)}};ig();var $O={};function qI(r){let e=r.toString();e=e.replace(/=&/g,"&").replace(/=$/,"");let t=`${window.location.pathname}${e?"?"+e:""}`;window.location.href!==t&&history.replaceState({},"",t)}var KI=class{constructor(e,t,i){this.isUndoing=!1;this.currentValidationStatus="never-validated";this.CHECK_ANIMATION_DELAY=900;this.didCloseSuccessModal=!1;this.currentQuestIsClosing=!1;this.questWindowPos=void 0;this.controller=e,this.tourController=t,this.validator=new tC(this.controller),this.graphsController=i}isValidQuestId(e){return e in rl}removeQuestFromQueryParams(){let e=new URLSearchParams(window.location.search);e.delete("quest"),qI(e)}getUrlForQuest(e){let t=new URLSearchParams(window.location.search);return t.delete("quest"),t.append("quest",e),`/3d?${t.toString()}`}startQuest(e,t={}){var o,n,a,s,l;if(this.currentQuestIsClosing=!1,this.isValidatingStep=void 0,this.isUndoing=!1,this.didCloseSuccessModal=!1,this.setHintsVisible(!1),this.tourController.stopTour("exit"),this.currentValidationStatus="never-validated",!(e in rl))return;this.currentQuestId=e;let i=this.getCurrentQuest();if(i){if(this.graphsController.previousGraph=this.graphsController.currentGraph?this.graphsController.currentGraph.copy():new Dn,this.graphsController.previousGraph.graphData=JSON.stringify(this.controller.getState()),this.cachedOldCalcState=this.controller.getState(),i!=null&&i.startingState&&!t.isUndoing&&this.controller.setState(i.startingState),this.controller.getGraphSettings().setProperty("defaultState",i.startingState),this.controller.dispatch({type:"render"}),!t.isLoadingFromUrl){let c=this.getUrlForQuest(this.currentQuestId);this.cachedPreviousUrl=window.location.href,window.location.href!==c&&history.replaceState({},"",c)}this.graphsController.currentGraph=new Dn,this.graphsController.currentGraph.title=this.controller.s("graphing-calculator-heading-quest",{title:(n=(o=this.getCurrentQuest())==null?void 0:o.title)!=null?n:""}),this.graphsController.currentGraph.questHash=this.currentQuestId,this.graphsController._onCurrentGraphChanged(),Qt("quest::start",{questName:(a=this.getCurrentQuest())==null?void 0:a.title,questId:this.currentQuestId}),this.tourController.triggerEvent("startQuest",void 0),this.currentQuestStartTime=Date.now(),this.cancelChangeSubcription=this.controller.subscribeToChanges(()=>this.tourController.updateRootView()),!t.isUndoing&&!t.isLoadingFromUrl&&(this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-tours-narration-quest-started",{title:(l=(s=this.getCurrentQuest())==null?void 0:s.title)!=null?l:""}),undoCallback:()=>{this.isUndoing=!0,this.stopQuest(),this.graphsController.restorePreviousGraph()}}}),t.isLoadingFromUrl||this.controller.dispatch({type:"set-focus-location",location:{type:"quest",location:"quest-pane"}})),this.controller.runAfterDispatch(()=>this.tourController.updateRootView())}}getCurrentQuest(){if(this.currentQuestId)return rl[this.currentQuestId]}getQuestActive(){return!!this.currentQuestId}getQuestGoals(){var e,t;return(t=(e=this.getCurrentQuest())==null?void 0:e.goals)!=null?t:[]}getQuestValidationStatus(){return this.currentValidationStatus}stopQuest({doRedirect:e}={doRedirect:!0}){var o;if(!this.currentQuestId)return;this.currentQuestIsClosing=!0,this.isValidatingStep=void 0,this.tourController.updateRootView(),clearTimeout(this.validationTimeoutId),this.controller.getGraphSettings().setProperty("defaultState",void 0),this.cancelChangeSubcription&&this.cancelChangeSubcription(),this.removeQuestFromQueryParams(),Qt("quest::exit",{questName:(o=this.getCurrentQuest())==null?void 0:o.title,questId:this.currentQuestId,validationStatus:this.getQuestValidationStatus()});let{currentQuestId:t}=this;this.currentQuestStartTime=void 0;let i=setTimeout(()=>{this.currentQuestId=void 0,this.tourController.triggerEvent("stopQuest",void 0),this.tourController.updateRootView(),e&&this.removeQuestFromQueryParams()},300);this.isUndoing||this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-tours-narration-exiting-quest"),undoCallback:()=>{clearTimeout(i),this.startQuest(t,{isUndoing:!0})}}})}getGoalValidationStatus(e){switch(this.getQuestValidationStatus()){case"unvalidated":case"never-validated":return"unvalidated";case"complete":return"satisfied";case"incomplete":return e.satisfied?"satisfied":"unsatisfied";case"validating":if(this.isValidatingStep===void 0)return"unvalidated";let t=this.getQuestGoals().indexOf(e);return t===this.isValidatingStep?"validating":t>this.isValidatingStep?"unvalidated":e.satisfied?"satisfied":"unsatisfied"}}checkQuestGoals(){if(!this.currentQuestId)return;this.tourController.stopTour("exit");let e=this.getQuestGoals();if(this.didCloseSuccessModal=!1,Fm){e.forEach(t=>t.satisfied=this.validateGoal(t)),this.ariaAlertGoalStatus(),this.completeValidation();return}this.isValidatingStep=0,this.currentValidationStatus="validating",this.ariaAlertGoalStatus(),this.checkCurrentQuestGoal()}validateGoal(e){let t=!0;return e.expressionCriteria!==void 0&&(t=this.validator.hasMatchingExpression(e.expressionCriteria)),e.controllerCriteria!==void 0&&(t=t&&this.matchesControllerCriteria(e.controllerCriteria)),e.complexCriterion!==void 0?e.complexCriterion.call({},this.validator):t}startNextQuest(){let e=Object.keys(rl),t=0;if(this.currentQuestId){let i=e.findIndex(o=>o===this.currentQuestId);i<e.length-1&&(t=i+1)}this.stopQuest({doRedirect:!1}),setTimeout(()=>this.startQuest(e[t]),300)}getSuccessModalIsOpen(){return this.getQuestValidationStatus()==="complete"&&!this.didCloseSuccessModal}closeSuccessModal(){this.didCloseSuccessModal=!0,this.tourController.updateRootView()}setQuestWindowPos(e,t){this.questWindowPos={left:e,top:t}}getQuestWindowPos(){return this.questWindowPos}checkCurrentQuestGoal(){if(this.isValidatingStep===void 0)return;let e=this.isValidatingStep,t=this.getQuestGoals();if(e>=t.length)return this.completeValidation();t[e].satisfied=this.validateGoal(t[e]),this.tourController.updateRootView(),this.isValidatingStep++,this.validationTimeoutId=setTimeout(this.checkCurrentQuestGoal.bind(this),this.CHECK_ANIMATION_DELAY)}ariaAlertGoalStatus(){var t;let e=[];(t=this.getCurrentQuest())==null||t.goals.forEach(i=>{this.validateGoal(i)?e.push(this.controller.s("graphing-tours-narration-quest-goal-complete",{goal:i.text})):e.push(this.controller.s("graphing-tours-narration-quest-goal-incomplete",{goal:i.text}))}),e.length>0&&be(e.join(" "))}matchesControllerCriteria(e){return Array.isArray(e)?e.every(t=>t(this.controller)):e(this.controller)}completeValidation(){var t;let e=this.getQuestGoals();clearTimeout(this.validationTimeoutId),this.isValidatingStep=void 0,this.currentValidationStatus=e.every(i=>i.satisfied)?"complete":"incomplete",this.currentValidationStatus==="complete"&&Qt("quest::finish",{questName:(t=this.getCurrentQuest())==null?void 0:t.title,questId:this.currentQuestId,elapsedTime:this.currentQuestStartTime?Date.now()-this.currentQuestStartTime:void 0}),this.tourController.updateRootView()}setHintsVisible(e){var o,n,a;this.isValidatingStep&&this.completeValidation(),this.hintsVisible=e;let t=(n=(o=this.tourController.rootView)==null?void 0:o.findRootNode())==null?void 0:n.querySelector(".dcg-quest__body");if(t)if(e){let s=t.getBoundingClientRect();t.style.height=`${s.height}px`,t.style.width=`${s.width}px`}else t.style.height="unset",t.style.width="unset";this.tourController.updateRootView();let i={questName:(a=this.getCurrentQuest())==null?void 0:a.title,questId:this.currentQuestId};e?Qt("quest::hint-enter",i):(this.tourController.stopTour(),Qt("quest::hint-exit",i))}getHintsVisible(){return this.hintsVisible}};var UI=__dcg_shared_module_exports__['h'](z());var zI=class extends kr{constructor(t,i){super();this.questListModalIsOpen=!1;this.tourKeyDownListener=t=>{"key"in t&&t.key.startsWith("Esc")&&this.stopTour()};this.controller=t,this.questController=new KI(this.controller,this,i)}shouldPopupTour(t){if(this.controller.getItemCount()>3)return!0;let i=this.getTourClass(t);if(!i)return!1;let o=new i({id:()=>t,controller:()=>this.controller,tourController:()=>this},[]);return o&&o.shouldPopup?o.shouldPopup():!1}startTour(t,i=!1){this.mountedTour&&this.unmountTour(),t&&(this.buildTour(t),this.mountedTour&&(this.isMiniTour=i,Qt("tour::start",{tourId:t,isMiniTour:i}),setTimeout(()=>{this.mountedTour&&(this.mountedTour.update(),setTimeout(()=>{var o;return(o=this.tourContainerElt)==null?void 0:o.classList.add("dcg-tour-loaded")}))}),document.addEventListener("keydown",this.tourKeyDownListener)))}startMiniTour(t){this.activeMinitour=t,this.startTour(t,!0),this.updateRootView()}startTourFromUrl(){let t=new URLSearchParams(window.location.search),i=t.get("quest");if(i){this.controller.is3dProduct()&&this.questController.isValidQuestId(i)&&!this.controller.isNarrow()?this.questController.startQuest(i,{isLoadingFromUrl:!0}):this.questController.removeQuestFromQueryParams();return}else this.controller.is3dProduct()&&t.has("showQuestsList")&&(this.questListModalIsOpen=!0);if(document.querySelectorAll(".dcg-expressionitem").length<2){setTimeout(this.startTourFromUrl.bind(this),100);return}let o=_p(location.search,"tour");o&&this.startTour(o)}getTourClass(t){var i;if(t==="baseTour")return Vh;if(this.controller.is3dProduct()&&t in $O)return(i=$O[t])==null?void 0:i.tour;if(t in iC)return iC[t].tour;if(t in ly)return ly[t].tour}buildTour(t){t===this.tourId?this.stopTour("restart"):this.stopTour("exit"),this.tourId=t;let i=this.getTourClass(t);if(i)return this.mountTour(t,i)}mountTour(t,i){var o;return this.tourContainerElt||(this.tourContainerElt=document.createElement("div"),this.tourContainerElt.id="dcg-tour-container",(o=this.controller.getRootElt())==null||o.append(this.tourContainerElt)),this.mountedTour=UI.mountToNode(i,this.tourContainerElt,{controller:()=>this.controller,tourController:()=>this,id:()=>t}),this.mountedTour}unmountTour(){this.mountedTour&&this.tourContainerElt&&UI.unmountFromNode(this.tourContainerElt),this.mountedTour=void 0,this.tourId=void 0}getActiveMinitour(){return this.activeMinitour}stopTour(t="finish"){!this.mountedTour||!this.tourContainerElt||(this.activeMinitour=void 0,this.clearTimeouts(),document.removeEventListener("keydown",this.tourKeyDownListener),this.tourContainerElt.classList.remove("dcg-tour-loaded"),setTimeout(()=>{this.activeMinitour||this.unmountTour()},300),t==="finish"?Qt("tour::finish",{tourId:this.tourId,isMiniTour:this.isMiniTour}):Qt("tour::exit",{tourId:this.tourId,isMiniTour:this.isMiniTour,isRestart:t==="restart"}),this.updateRootView())}forceUpdate(){this.mountedTour&&this.mountedTour.update()}addInterval(t){this.intervalId!==void 0&&(clearInterval(this.intervalId),this.intervalId=void 0),this.intervalId=setInterval(()=>{this.mountedTour&&this.mountedTour.update()},t)}addUpdateTimeout(t){this.updateTimeoutId!==void 0&&(clearTimeout(this.updateTimeoutId),this.updateTimeoutId=void 0),this.updateTimeoutId=setTimeout(()=>{this.mountedTour&&this.mountedTour.update()},t)}clearTimeouts(){clearTimeout(this.updateTimeoutId),clearInterval(this.intervalId),this.intervalId=void 0,this.updateTimeoutId=void 0}setRootView(t){this.rootView=t}updateRootView(){var t;(t=this.rootView)==null||t.update()}setQuestsListModalVisibility(t){this.questListModalIsOpen=t;let i=new URLSearchParams(window.location.search);t?i.set("showQuestsList",""):i.delete("showQuestsList"),qI(i),this.updateRootView()}getQuestsListModalIsOpen(){return this.questListModalIsOpen}getSuccessModalIsOpen(){return this.questController.getSuccessModalIsOpen()}closeSuccessModal(){return this.questController.closeSuccessModal()}startQuest(t){return this.questController.startQuest(t)}startQuestFromUndo(t){return this.questController.startQuest(t,{isUndoing:!0})}startNextQuest(){return this.questController.startNextQuest()}getCurrentQuest(){return this.questController.getCurrentQuest()}getQuestActive(){return this.questController.getQuestActive()}getQuestGoals(){return this.questController.getQuestGoals()}getQuestValidationStatus(){return this.questController.getQuestValidationStatus()}stopQuest(){return this.questController.stopQuest()}getGoalValidationStatus(t){return this.questController.getGoalValidationStatus(t)}validateGoal(t){return this.questController.validateGoal(t)}getCurrentQuestIsClosing(){return this.questController.currentQuestIsClosing}setQuestWindowPos(t,i){return this.questController.setQuestWindowPos(t,i)}getQuestWindowPos(){return this.questController.getQuestWindowPos()}checkQuestGoals(){return this.setHintsVisible(!1),this.questController.checkQuestGoals()}getUrlForQuest(t){return this.questController.getUrlForQuest(t)}setHintsVisible(t){return this.questController.setHintsVisible(t)}getHintsVisible(){return this.questController.getHintsVisible()}};var HI=class extends kr{constructor(t,i,o,n){super();this.recoveryAttempted=!1;this.isOpen=!1;this.graphsController=t,this.userController=n,this.api=i,this.s=o,this.pageLoadTime=Date.now()}isMygraphsOpen(){return this.isOpen}hasAttemptedRecovery(){return this.recoveryAttempted}openMygraphs(t){var i;this.recoveryAttempted=!1,this.isOpen=!0,document.body.classList.add("resources-open"),be(this.s("account-shell-narration-mygraphs-open-graph")),Kr(),t&&t.device==="keyboard"&&((i=document.querySelector(".dcg-action-newblankgraph"))==null||i.focus()),this.triggerEvent("onOpenMygraphs",void 0)}closeMygraphs(){this.isOpen=!1,document.body.classList.remove("resources-open")}openBlankGraph(){this.triggerEvent("beforeChangeOpenedGraph",void 0),this.closeMygraphs(),this.graphsController.clearGraphByUserAction(),this.triggerEvent("triggerRender",void 0)}onOpenGraph(t){this.triggerEvent("beforeChangeOpenedGraph",void 0),t.example||(t.recovery?Qt("recovered-graph",{product:this.graphsController.product,timeSincePageload:Date.now()-this.pageLoadTime,payloadJSON:{action:"open"}}):Qt("user-action::open-saved",{product:this.graphsController.product,timeSincePageload:Date.now()-this.pageLoadTime}));let i=this.copyGraphWithTranslation(t);this.graphsController.loadGraph(i),this._concludeOpenGraph(i)}toast(t,i){this.triggerEvent("toast",{message:t,opts:i})}_concludeOpenGraph(t){if(t.isMigratedFromLegacyGeometry)this.showLegacyGeometryMigrationToast(t);else{let i=t.title||this.graphsController.getUntitledString();this.toast(this.s("account-shell-text-mygraphs-opened-graph",{graphTitle:i}),{undoCallback:()=>{this.graphsController.restorePreviousGraph()}})}this.closeMygraphs(),this.triggerEvent("triggerRender",void 0),RG({userId:this.userController.getUserId(),desmosLang:this.graphsController.getLanguage()})}showLegacyGeometryMigrationToast(t){this.toast(this.s("account-shell-text-graph-migrated-from-geometry",{title:t.title}),{link:{text:this.s("shared-calculator-label-toast-learn-more"),url:"https://help.desmos.com/hc/en-us/articles/17817122756877"}})}copyGraphWithTranslation(t){var i=t.copy();return t.i18nKey&&(i.title=this.s(t.i18nKey)),i}openGraphBehindCover(t){var i=this.copyGraphWithTranslation(t);return this.graphsController.loadGraph(i),new Promise(o=>{this.graphsController.product==="graphing"||this.graphsController.product==="graphing-3d"||this.graphsController.product==="geometry-calculator"?(this.api._calc.evaluator.notifyWhenSynced(function(){o()}),setTimeout(function(){o()},6e3)):this.graphsController.product==="geometry"&&o()}).then(()=>{this._concludeOpenGraph(i)})}getThumbnail(){return this.api.screenshot({width:200,height:200,targetPixelRatio:2})}};function D6(r){let e=JSON.parse(r.exampleGraphsRaw),t=r.api;t.hasUnsavedChanges=function(){return t._calc.controller.hasUnsavedChanges()};let i=new UC(t),o=new RI,n=i.s.bind(i),a=i.raw.bind(i),s=i.unpack.bind(i),l=new NI({api:t,s:n,getLanguage:i.getLanguage.bind(i),examplesJSON:e,randomSeed:r.seed,product:r.product}),c=new zI(t._calc.controller,l),p=new HI(l,t,n,o);l.observeEvent("onClearGraph",function(){t.focusFirstExpression()}),p.observeEvent("toast",function(x,C){if(!C)return;let D={message:C.message};for(let k in C.opts)C.opts.hasOwnProperty(k)&&(D[k]=C.opts[k]);t._calc.controller.dispatch({type:"toast/show",toast:D})}),l.observeEvent("toast",function(x,C){if(!C)return;let D={message:C.message};for(let k in C.opts)C.opts.hasOwnProperty(k)&&(D[k]=C.opts[k]);t._calc.controller.dispatch({type:"toast/show",toast:D})}),l.observeEvent("clearUnsavedChanges",function(){t._calc.controller.dispatch({type:"clear-unsaved-changes"})}),l.observeEvent("clearUndoRedo",function(){t._calc.controller.dispatch({type:"clear-undoredo-history"})});let u=!1;t._calc.controller.subscribeToChanges(function(){let x=t._calc.controller.hasUnsavedChanges();x!==u&&h.triggerRender(),u=x});let m;t._calc.controller.triggerEasterEgg=function(x){let C=x==="betchacant"?t._calc.controller.s("account-shell-label-betchacant-loading"):t._calc.controller.s("account-shell-label-loading"),D=l.getEasterEggGraphs(x);D.length!==0&&(m=Math.floor(Math.random()*D.length),t._calc.controller.dispatch({type:"toast/show",toast:{message:C,hideAfter:0,toastStyle:"cover"}}),l.loadGraphImmediately(D[m]).then(function(){p.openGraphBehindCover(D[m])}))},Pr("expressions")!==!1&&(t._calc.controller.triggerClearGraph=function(){l.clearGraphByUserAction()},t.observeEvent("openDrawer",function(){h.dispatch({type:"open-mygraphs"})}));let h=new BI({userController:o,graphsController:l,tourController:c,languageController:i,mygraphsController:p,api:t,s:n,raw:a,unpack:s,getLanguage:i.getLanguage.bind(i),product:r.product});return p.observeEvent("beforeChangeOpenedGraph",()=>{c.stopQuest()}),l.observeEvent("restoredGraph",(x,C)=>{C&&"graph"in C&&C.graph.questHash&&c.startQuestFromUndo(C.graph.questHash)}),c.observeEvent("startQuest",()=>h.triggerRender()),c.observeEvent("stopQuest",()=>h.triggerRender()),t._calc.controller.getQuestIsActive=()=>c.getQuestActive(),t._calc.controller.showQuestModal=()=>c.setQuestsListModalVisibility(!0),t._calc.globalHotkeys=new HC(t._calc.controller,h,t._calc.instanceHotkeys),t._calc.controller.setCanShowKeyboardShortcuts(!0),t.observeEvent("showHotkeysModal",function(){h.dispatch({type:"show-modal",modal:"hotkeys",device:"keyboard"})}),t._calc.controller.logJSON=Qt,window.userController=o,window.headerController=h,window.tourController=c,{userController:o,graphsController:l,tourController:c,headerController:h}}var S6=__dcg_shared_module_exports__['h'](z());function doe(r,e){var t=document.createElement("div");t.style.zIndex="999999",t.style.position="fixed",t.style.bottom="50px",t.style.left="0",t.style.right="0",document.body.append(t),S6.mountToNode(Ph,t,{s:e,didDataLoadFail:function(){return!0},requestLoadGraphData:function(){t.remove(),r()}})}function k6(r,e){return new Promise(t=>{if(r&&r.state)t(r);else if(r&&typeof r.stateUrl=="string"){var i=!1;let o=async()=>{if(!i){i=!0;try{let n=await fetch(`${r.stateUrl}?${new URLSearchParams(Ed)}`,{headers:{Accept:"application/json"}});if(!n.ok)throw void 0;let a=await n.json();r.state=a,t(r)}catch(n){doe(o,e)}finally{i=!1}}};o()}else t(void 0)})}var T6=__dcg_shared_module_exports__['h'](G6());Pr("testing")||pR(T6.default);async function I6({calcConstructor:r,exampleGraphsRaw:e,extraOptions:t,product:i,show3DNotice:o,showTermsUpdateNotice:n,graphJSON:a}){let s=sx(),l=await of(s).then(()=>s,()=>"en"),c=YD();c.disableScrollFix||c4(),c=__dcg_shared_module_exports__['a'](__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['a']({},c),{border:!1,disableScrollFix:!0,showHamburger:!0,pasteGraphLink:!0,onlyTraceSelected:!0}),t);let p=document.getElementById("graph-container"),u=new r(p,c),m=D6({api:u,seed:hu.seed,exampleGraphsRaw:e,product:i}),h=u._calc.controller;h.setBugsnagContext("main-controller"),o&&(h.show3DNotice=!0),u.updateSettings({language:l});let x=m.userController,C=m.graphsController,D=m.tourController,k=m.headerController,M=h.s.bind(h);uR(function(B){let R=h.stateStack;R&&R.serializeForBugsnag&&(B.metaData.states=R.serializeForBugsnag())});let I=new Yv({calcController:h,graphsController:C});I.trackFeatureUsage("graph-feature","hasSlider"),I.trackFeatureUsage("graph-feature","hasRegression"),I.trackFeatureUsage("graph-feature","hasAction"),I.trackFeatureUsage("graph-feature","expressionErrors"),I.trackFeatureUsage("graph-feature","expressionCount"),I.trackFeatureUsage("graph-feature","folderCount"),I.trackFeatureUsage("graph-feature","imageCount"),I.trackFeatureUsage("graph-feature","tableCount"),I.trackFeatureUsage("graph-feature","textCount"),I.start(),tU(x,M),Pr("no_navigation_warning")||H(window).on("beforeunload",function(){if(u.hasUnsavedChanges())return M("account-shell-text-confirm-leave")}),hu.user&&x.completeLogin(hu.user),hu.graph||(C.clearGraph(),hu.latex&&u.setExpression({latex:hu.latex})),RG({userId:x.getUserId(),desmosLang:l}),D.startTourFromUrl(),x.getEmailChangeToken()&&k.dispatch({type:"show-modal",modal:"change-email",device:"mouse"}),k.triggerRender=function(){S.update(),V.update(),P.update(),x.getEmailChangeToken()&&k.getOpenModal()!=="change-email"&&history.replaceState(null,"",document.location.pathname)};let S=Sy.mountToNode(MT,document.getElementById("dcg-header-container"),{controller:function(){return k}}),V=Sy.mountToNode(DI,document.getElementById("dcg-modal-container"),{controller:function(){return k}}),P=Sy.mountToNode(_I,document.getElementById("mygraphs-container"),{controller:Sy.const(k),makeAPI:function(B){return new r(B,{settingsMenu:!1,keypad:!1,zoomButtons:!1,branding:!1,border:!1,disableScrollFix:!0,expressions:!1,hideGeoUI:!0})}});Vu&&!c_&&!PD&&k.dispatch({type:"show-modal",modal:"unsupported-browser",device:"touch"}),document.location.search.match(/(\?|\&)create_account/)?(history.replaceState(null,"",document.location.pathname),x.isLoggedIn()?h.dispatch({type:"toast/show",toast:{message:M("account-shell-text-logged-in")}}):k.dispatch({type:"show-modal",modal:"signup",device:"mouse"})):document.location.search.match(/(\?|\&)login/)?(history.replaceState(null,"",document.location.pathname),x.isLoggedIn()?h.dispatch({type:"toast/show",toast:{message:M("account-shell-text-logged-in")}}):k.dispatch({type:"show-modal",modal:"login",device:"mouse"})):document.location.search.match(/(\?|\&)reset_password/)&&(history.replaceState(null,"",document.location.pathname),k.dispatch({type:"show-modal",modal:"recover-password",device:"mouse"})),window.matchMedia&&window.matchMedia("print").addListener(function(R){R.matches?h.dispatch({type:"enter-printmode"}):h.dispatch({type:"exit-printmode"})}),Bv(document);let L=await k6(a,M);return n&&(h.showTermsNotice=!0),{Calc:u,graphsController:C,calcController:h,headerController:k,fullGraph:L}}async function poe(){let{isLegacyConstruction:r,graph:e,construction:t}=hu,{Calc:i,graphsController:o,calcController:n,headerController:a,fullGraph:s}=await I6({calcConstructor:Eh,exampleGraphsRaw:D_,extraOptions:{},product:"geometry-calculator",graphJSON:r?t:e});return s&&s.state&&(r&&(s.state=Uc(s.state),s.isMigratedFromLegacyGeometry=!0),s.state.graph.product!=="geometry-calculator"?n.dispatch({type:"toast/show",toast:{message:n.s("account-shell-text-error-loading-geometry-state")}}):(o.loadGraph(Dn.fromAjax(s)),r&&a.mygraphsController.showLegacyGeometryMigrationToast(s))),i}var V6=poe();xt();typeof Desmos=="undefined"&&(Desmos={});function M6(){Desmos.$=H,Desmos.$.noConflict(!0)}Pu(document.body);M6();V6.then(function(r){document.querySelector(".dcg-loading-div-container").style.display="none",window.Calc=r,_2()});
/*!
 * jQuery JavaScript Library v3.6.0
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2021-03-02T17:08Z
 */
/*!!
 *  Canvas 2 Svg v1.0.19
 *  A low level canvas to SVG converter. Uses a mock canvas context to build an SVG document.
 *
 *  Licensed under the MIT license:
 *  http://www.opensource.org/licenses/mit-license.php
 *
 *  Author:
 *  Kerry Liu
 *
 *  Copyright (c) 2014 Gliffy Inc.
 *
 *  Modifications by Desmos:
 *  - wrapped in AMD pattern
 *  - added ctx.ellipse() method
 *  - fixed image opacity bug
 *  - added ability to add classNames to exported svg elements
 *  - added ability to add named groups
 *  - removed dominant-basline attribute. Editors appear to ignore it. Must solve baseline issues using transformations
 */
})()